/*! For license information please see main.866b3da9.js.LICENSE.txt */
(function(){var __webpack_modules__={7228:function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.__esModule=!0,e.exports.default=e.exports},2858:function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},1506:function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},4575:function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},3913:function(e){function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},9842:function(e,t,n){var r=n(9754),a=n(7067),i=n(8585);e.exports=function(e){var t=a();return function(){var n,a=r(e);if(t){var o=r(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return i(this,n)}},e.exports.__esModule=!0,e.exports.default=e.exports},9754:function(e){function t(n){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},2205:function(e,t,n){var r=n(9489);e.exports=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},7067:function(e){e.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}},e.exports.__esModule=!0,e.exports.default=e.exports},3884:function(e){e.exports=function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(u){s=!0,a=u}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}},e.exports.__esModule=!0,e.exports.default=e.exports},521:function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},8585:function(e,t,n){var r=n(8).default,a=n(1506);e.exports=function(e,t){if(t&&("object"===r(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return a(e)},e.exports.__esModule=!0,e.exports.default=e.exports},9489:function(e){function t(n,r){return e.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n,r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},3038:function(e,t,n){var r=n(2858),a=n(3884),i=n(379),o=n(521);e.exports=function(e,t){return r(e)||a(e,t)||i(e,t)||o()},e.exports.__esModule=!0,e.exports.default=e.exports},8:function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},379:function(e,t,n){var r=n(7228);e.exports=function(e,t){if(e){if("string"===typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},4309:function(e,t,n){"use strict";n.r(t),n.d(t,{userAgent:function(){return r}});var r=""},6075:function(e,t,n){"use strict";n.r(t),n.d(t,{now:function(){return a},timing:function(){return i}});var r=n.g.process.hrtime(),a=function(){var e=n.g.process.hrtime(r);return e[0]+e[1]/1e9},i={navigationStart:Date.now()}},5842:function(e,t,n){"use strict";var r=n(886),a=r.Reader,i=r.Writer,o=r.util,s=r.roots.default||(r.roots.default={});s.tensorflow=function(){var e={};return e.magenta=function(){var e={};return e.NoteSequence=function(){function e(e){if(this.timeSignatures=[],this.keySignatures=[],this.tempos=[],this.notes=[],this.pitchBends=[],this.controlChanges=[],this.partInfos=[],this.textAnnotations=[],this.sectionAnnotations=[],this.sectionGroups=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.id="",e.prototype.filename="",e.prototype.referenceNumber=o.Long?o.Long.fromBits(0,0,!1):0,e.prototype.collectionName="",e.prototype.ticksPerQuarter=0,e.prototype.timeSignatures=o.emptyArray,e.prototype.keySignatures=o.emptyArray,e.prototype.tempos=o.emptyArray,e.prototype.notes=o.emptyArray,e.prototype.totalTime=0,e.prototype.totalQuantizedSteps=o.Long?o.Long.fromBits(0,0,!1):0,e.prototype.pitchBends=o.emptyArray,e.prototype.controlChanges=o.emptyArray,e.prototype.partInfos=o.emptyArray,e.prototype.sourceInfo=null,e.prototype.textAnnotations=o.emptyArray,e.prototype.sectionAnnotations=o.emptyArray,e.prototype.sectionGroups=o.emptyArray,e.prototype.quantizationInfo=null,e.prototype.subsequenceInfo=null,e.prototype.sequenceMetadata=null,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=i.create()),null!=e.id&&e.hasOwnProperty("id")&&t.uint32(10).string(e.id),null!=e.filename&&e.hasOwnProperty("filename")&&t.uint32(18).string(e.filename),null!=e.collectionName&&e.hasOwnProperty("collectionName")&&t.uint32(26).string(e.collectionName),null!=e.ticksPerQuarter&&e.hasOwnProperty("ticksPerQuarter")&&t.uint32(32).int32(e.ticksPerQuarter),null!=e.timeSignatures&&e.timeSignatures.length)for(var n=0;n<e.timeSignatures.length;++n)s.tensorflow.magenta.NoteSequence.TimeSignature.encode(e.timeSignatures[n],t.uint32(42).fork()).ldelim();if(null!=e.keySignatures&&e.keySignatures.length)for(n=0;n<e.keySignatures.length;++n)s.tensorflow.magenta.NoteSequence.KeySignature.encode(e.keySignatures[n],t.uint32(50).fork()).ldelim();if(null!=e.tempos&&e.tempos.length)for(n=0;n<e.tempos.length;++n)s.tensorflow.magenta.NoteSequence.Tempo.encode(e.tempos[n],t.uint32(58).fork()).ldelim();if(null!=e.notes&&e.notes.length)for(n=0;n<e.notes.length;++n)s.tensorflow.magenta.NoteSequence.Note.encode(e.notes[n],t.uint32(66).fork()).ldelim();if(null!=e.totalTime&&e.hasOwnProperty("totalTime")&&t.uint32(73).double(e.totalTime),null!=e.pitchBends&&e.pitchBends.length)for(n=0;n<e.pitchBends.length;++n)s.tensorflow.magenta.NoteSequence.PitchBend.encode(e.pitchBends[n],t.uint32(82).fork()).ldelim();if(null!=e.controlChanges&&e.controlChanges.length)for(n=0;n<e.controlChanges.length;++n)s.tensorflow.magenta.NoteSequence.ControlChange.encode(e.controlChanges[n],t.uint32(90).fork()).ldelim();if(null!=e.partInfos&&e.partInfos.length)for(n=0;n<e.partInfos.length;++n)s.tensorflow.magenta.NoteSequence.PartInfo.encode(e.partInfos[n],t.uint32(98).fork()).ldelim();if(null!=e.sourceInfo&&e.hasOwnProperty("sourceInfo")&&s.tensorflow.magenta.NoteSequence.SourceInfo.encode(e.sourceInfo,t.uint32(106).fork()).ldelim(),null!=e.textAnnotations&&e.textAnnotations.length)for(n=0;n<e.textAnnotations.length;++n)s.tensorflow.magenta.NoteSequence.TextAnnotation.encode(e.textAnnotations[n],t.uint32(114).fork()).ldelim();if(null!=e.quantizationInfo&&e.hasOwnProperty("quantizationInfo")&&s.tensorflow.magenta.NoteSequence.QuantizationInfo.encode(e.quantizationInfo,t.uint32(122).fork()).ldelim(),null!=e.totalQuantizedSteps&&e.hasOwnProperty("totalQuantizedSteps")&&t.uint32(128).int64(e.totalQuantizedSteps),null!=e.subsequenceInfo&&e.hasOwnProperty("subsequenceInfo")&&s.tensorflow.magenta.NoteSequence.SubsequenceInfo.encode(e.subsequenceInfo,t.uint32(138).fork()).ldelim(),null!=e.referenceNumber&&e.hasOwnProperty("referenceNumber")&&t.uint32(144).int64(e.referenceNumber),null!=e.sequenceMetadata&&e.hasOwnProperty("sequenceMetadata")&&s.tensorflow.magenta.SequenceMetadata.encode(e.sequenceMetadata,t.uint32(154).fork()).ldelim(),null!=e.sectionAnnotations&&e.sectionAnnotations.length)for(n=0;n<e.sectionAnnotations.length;++n)s.tensorflow.magenta.NoteSequence.SectionAnnotation.encode(e.sectionAnnotations[n],t.uint32(162).fork()).ldelim();if(null!=e.sectionGroups&&e.sectionGroups.length)for(n=0;n<e.sectionGroups.length;++n)s.tensorflow.magenta.NoteSequence.SectionGroup.encode(e.sectionGroups[n],t.uint32(170).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new s.tensorflow.magenta.NoteSequence;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.id=e.string();break;case 2:r.filename=e.string();break;case 18:r.referenceNumber=o.Long?e.int64().toNumber():e.int64();break;case 3:r.collectionName=e.string();break;case 4:r.ticksPerQuarter=e.int32();break;case 5:r.timeSignatures&&r.timeSignatures.length||(r.timeSignatures=[]),r.timeSignatures.push(s.tensorflow.magenta.NoteSequence.TimeSignature.decode(e,e.uint32()));break;case 6:r.keySignatures&&r.keySignatures.length||(r.keySignatures=[]),r.keySignatures.push(s.tensorflow.magenta.NoteSequence.KeySignature.decode(e,e.uint32()));break;case 7:r.tempos&&r.tempos.length||(r.tempos=[]),r.tempos.push(s.tensorflow.magenta.NoteSequence.Tempo.decode(e,e.uint32()));break;case 8:r.notes&&r.notes.length||(r.notes=[]),r.notes.push(s.tensorflow.magenta.NoteSequence.Note.decode(e,e.uint32()));break;case 9:r.totalTime=e.double();break;case 16:r.totalQuantizedSteps=o.Long?e.int64().toNumber():e.int64();break;case 10:r.pitchBends&&r.pitchBends.length||(r.pitchBends=[]),r.pitchBends.push(s.tensorflow.magenta.NoteSequence.PitchBend.decode(e,e.uint32()));break;case 11:r.controlChanges&&r.controlChanges.length||(r.controlChanges=[]),r.controlChanges.push(s.tensorflow.magenta.NoteSequence.ControlChange.decode(e,e.uint32()));break;case 12:r.partInfos&&r.partInfos.length||(r.partInfos=[]),r.partInfos.push(s.tensorflow.magenta.NoteSequence.PartInfo.decode(e,e.uint32()));break;case 13:r.sourceInfo=s.tensorflow.magenta.NoteSequence.SourceInfo.decode(e,e.uint32());break;case 14:r.textAnnotations&&r.textAnnotations.length||(r.textAnnotations=[]),r.textAnnotations.push(s.tensorflow.magenta.NoteSequence.TextAnnotation.decode(e,e.uint32()));break;case 20:r.sectionAnnotations&&r.sectionAnnotations.length||(r.sectionAnnotations=[]),r.sectionAnnotations.push(s.tensorflow.magenta.NoteSequence.SectionAnnotation.decode(e,e.uint32()));break;case 21:r.sectionGroups&&r.sectionGroups.length||(r.sectionGroups=[]),r.sectionGroups.push(s.tensorflow.magenta.NoteSequence.SectionGroup.decode(e,e.uint32()));break;case 15:r.quantizationInfo=s.tensorflow.magenta.NoteSequence.QuantizationInfo.decode(e,e.uint32());break;case 17:r.subsequenceInfo=s.tensorflow.magenta.NoteSequence.SubsequenceInfo.decode(e,e.uint32());break;case 19:r.sequenceMetadata=s.tensorflow.magenta.SequenceMetadata.decode(e,e.uint32());break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.id&&e.hasOwnProperty("id")&&!o.isString(e.id))return"id: string expected";if(null!=e.filename&&e.hasOwnProperty("filename")&&!o.isString(e.filename))return"filename: string expected";if(null!=e.referenceNumber&&e.hasOwnProperty("referenceNumber")&&!o.isInteger(e.referenceNumber)&&!(e.referenceNumber&&o.isInteger(e.referenceNumber.low)&&o.isInteger(e.referenceNumber.high)))return"referenceNumber: integer|Long expected";if(null!=e.collectionName&&e.hasOwnProperty("collectionName")&&!o.isString(e.collectionName))return"collectionName: string expected";if(null!=e.ticksPerQuarter&&e.hasOwnProperty("ticksPerQuarter")&&!o.isInteger(e.ticksPerQuarter))return"ticksPerQuarter: integer expected";if(null!=e.timeSignatures&&e.hasOwnProperty("timeSignatures")){if(!Array.isArray(e.timeSignatures))return"timeSignatures: array expected";for(var t=0;t<e.timeSignatures.length;++t){if(n=s.tensorflow.magenta.NoteSequence.TimeSignature.verify(e.timeSignatures[t]))return"timeSignatures."+n}}if(null!=e.keySignatures&&e.hasOwnProperty("keySignatures")){if(!Array.isArray(e.keySignatures))return"keySignatures: array expected";for(t=0;t<e.keySignatures.length;++t){if(n=s.tensorflow.magenta.NoteSequence.KeySignature.verify(e.keySignatures[t]))return"keySignatures."+n}}if(null!=e.tempos&&e.hasOwnProperty("tempos")){if(!Array.isArray(e.tempos))return"tempos: array expected";for(t=0;t<e.tempos.length;++t){if(n=s.tensorflow.magenta.NoteSequence.Tempo.verify(e.tempos[t]))return"tempos."+n}}if(null!=e.notes&&e.hasOwnProperty("notes")){if(!Array.isArray(e.notes))return"notes: array expected";for(t=0;t<e.notes.length;++t){if(n=s.tensorflow.magenta.NoteSequence.Note.verify(e.notes[t]))return"notes."+n}}if(null!=e.totalTime&&e.hasOwnProperty("totalTime")&&"number"!==typeof e.totalTime)return"totalTime: number expected";if(null!=e.totalQuantizedSteps&&e.hasOwnProperty("totalQuantizedSteps")&&!o.isInteger(e.totalQuantizedSteps)&&!(e.totalQuantizedSteps&&o.isInteger(e.totalQuantizedSteps.low)&&o.isInteger(e.totalQuantizedSteps.high)))return"totalQuantizedSteps: integer|Long expected";if(null!=e.pitchBends&&e.hasOwnProperty("pitchBends")){if(!Array.isArray(e.pitchBends))return"pitchBends: array expected";for(t=0;t<e.pitchBends.length;++t){if(n=s.tensorflow.magenta.NoteSequence.PitchBend.verify(e.pitchBends[t]))return"pitchBends."+n}}if(null!=e.controlChanges&&e.hasOwnProperty("controlChanges")){if(!Array.isArray(e.controlChanges))return"controlChanges: array expected";for(t=0;t<e.controlChanges.length;++t){if(n=s.tensorflow.magenta.NoteSequence.ControlChange.verify(e.controlChanges[t]))return"controlChanges."+n}}if(null!=e.partInfos&&e.hasOwnProperty("partInfos")){if(!Array.isArray(e.partInfos))return"partInfos: array expected";for(t=0;t<e.partInfos.length;++t){if(n=s.tensorflow.magenta.NoteSequence.PartInfo.verify(e.partInfos[t]))return"partInfos."+n}}if(null!=e.sourceInfo&&e.hasOwnProperty("sourceInfo")&&(n=s.tensorflow.magenta.NoteSequence.SourceInfo.verify(e.sourceInfo)))return"sourceInfo."+n;if(null!=e.textAnnotations&&e.hasOwnProperty("textAnnotations")){if(!Array.isArray(e.textAnnotations))return"textAnnotations: array expected";for(t=0;t<e.textAnnotations.length;++t){if(n=s.tensorflow.magenta.NoteSequence.TextAnnotation.verify(e.textAnnotations[t]))return"textAnnotations."+n}}if(null!=e.sectionAnnotations&&e.hasOwnProperty("sectionAnnotations")){if(!Array.isArray(e.sectionAnnotations))return"sectionAnnotations: array expected";for(t=0;t<e.sectionAnnotations.length;++t){if(n=s.tensorflow.magenta.NoteSequence.SectionAnnotation.verify(e.sectionAnnotations[t]))return"sectionAnnotations."+n}}if(null!=e.sectionGroups&&e.hasOwnProperty("sectionGroups")){if(!Array.isArray(e.sectionGroups))return"sectionGroups: array expected";for(t=0;t<e.sectionGroups.length;++t){var n;if(n=s.tensorflow.magenta.NoteSequence.SectionGroup.verify(e.sectionGroups[t]))return"sectionGroups."+n}}if(null!=e.quantizationInfo&&e.hasOwnProperty("quantizationInfo")&&(n=s.tensorflow.magenta.NoteSequence.QuantizationInfo.verify(e.quantizationInfo)))return"quantizationInfo."+n;if(null!=e.subsequenceInfo&&e.hasOwnProperty("subsequenceInfo")&&(n=s.tensorflow.magenta.NoteSequence.SubsequenceInfo.verify(e.subsequenceInfo)))return"subsequenceInfo."+n;if(null!=e.sequenceMetadata&&e.hasOwnProperty("sequenceMetadata")&&(n=s.tensorflow.magenta.SequenceMetadata.verify(e.sequenceMetadata)))return"sequenceMetadata."+n;return null},e.fromObject=function(e){if(e instanceof s.tensorflow.magenta.NoteSequence)return e;var t=new s.tensorflow.magenta.NoteSequence;if(null!=e.id&&(t.id=String(e.id)),null!=e.filename&&(t.filename=String(e.filename)),null!=e.referenceNumber&&(o.Long?(t.referenceNumber=o.Long.fromValue(e.referenceNumber)).unsigned=!1:"string"===typeof e.referenceNumber?t.referenceNumber=parseInt(e.referenceNumber,10):"number"===typeof e.referenceNumber?t.referenceNumber=e.referenceNumber:"object"===typeof e.referenceNumber&&(t.referenceNumber=new o.LongBits(e.referenceNumber.low>>>0,e.referenceNumber.high>>>0).toNumber())),null!=e.collectionName&&(t.collectionName=String(e.collectionName)),null!=e.ticksPerQuarter&&(t.ticksPerQuarter=0|e.ticksPerQuarter),e.timeSignatures){if(!Array.isArray(e.timeSignatures))throw TypeError(".tensorflow.magenta.NoteSequence.timeSignatures: array expected");t.timeSignatures=[];for(var n=0;n<e.timeSignatures.length;++n){if("object"!==typeof e.timeSignatures[n])throw TypeError(".tensorflow.magenta.NoteSequence.timeSignatures: object expected");t.timeSignatures[n]=s.tensorflow.magenta.NoteSequence.TimeSignature.fromObject(e.timeSignatures[n])}}if(e.keySignatures){if(!Array.isArray(e.keySignatures))throw TypeError(".tensorflow.magenta.NoteSequence.keySignatures: array expected");t.keySignatures=[];for(n=0;n<e.keySignatures.length;++n){if("object"!==typeof e.keySignatures[n])throw TypeError(".tensorflow.magenta.NoteSequence.keySignatures: object expected");t.keySignatures[n]=s.tensorflow.magenta.NoteSequence.KeySignature.fromObject(e.keySignatures[n])}}if(e.tempos){if(!Array.isArray(e.tempos))throw TypeError(".tensorflow.magenta.NoteSequence.tempos: array expected");t.tempos=[];for(n=0;n<e.tempos.length;++n){if("object"!==typeof e.tempos[n])throw TypeError(".tensorflow.magenta.NoteSequence.tempos: object expected");t.tempos[n]=s.tensorflow.magenta.NoteSequence.Tempo.fromObject(e.tempos[n])}}if(e.notes){if(!Array.isArray(e.notes))throw TypeError(".tensorflow.magenta.NoteSequence.notes: array expected");t.notes=[];for(n=0;n<e.notes.length;++n){if("object"!==typeof e.notes[n])throw TypeError(".tensorflow.magenta.NoteSequence.notes: object expected");t.notes[n]=s.tensorflow.magenta.NoteSequence.Note.fromObject(e.notes[n])}}if(null!=e.totalTime&&(t.totalTime=Number(e.totalTime)),null!=e.totalQuantizedSteps&&(o.Long?(t.totalQuantizedSteps=o.Long.fromValue(e.totalQuantizedSteps)).unsigned=!1:"string"===typeof e.totalQuantizedSteps?t.totalQuantizedSteps=parseInt(e.totalQuantizedSteps,10):"number"===typeof e.totalQuantizedSteps?t.totalQuantizedSteps=e.totalQuantizedSteps:"object"===typeof e.totalQuantizedSteps&&(t.totalQuantizedSteps=new o.LongBits(e.totalQuantizedSteps.low>>>0,e.totalQuantizedSteps.high>>>0).toNumber())),e.pitchBends){if(!Array.isArray(e.pitchBends))throw TypeError(".tensorflow.magenta.NoteSequence.pitchBends: array expected");t.pitchBends=[];for(n=0;n<e.pitchBends.length;++n){if("object"!==typeof e.pitchBends[n])throw TypeError(".tensorflow.magenta.NoteSequence.pitchBends: object expected");t.pitchBends[n]=s.tensorflow.magenta.NoteSequence.PitchBend.fromObject(e.pitchBends[n])}}if(e.controlChanges){if(!Array.isArray(e.controlChanges))throw TypeError(".tensorflow.magenta.NoteSequence.controlChanges: array expected");t.controlChanges=[];for(n=0;n<e.controlChanges.length;++n){if("object"!==typeof e.controlChanges[n])throw TypeError(".tensorflow.magenta.NoteSequence.controlChanges: object expected");t.controlChanges[n]=s.tensorflow.magenta.NoteSequence.ControlChange.fromObject(e.controlChanges[n])}}if(e.partInfos){if(!Array.isArray(e.partInfos))throw TypeError(".tensorflow.magenta.NoteSequence.partInfos: array expected");t.partInfos=[];for(n=0;n<e.partInfos.length;++n){if("object"!==typeof e.partInfos[n])throw TypeError(".tensorflow.magenta.NoteSequence.partInfos: object expected");t.partInfos[n]=s.tensorflow.magenta.NoteSequence.PartInfo.fromObject(e.partInfos[n])}}if(null!=e.sourceInfo){if("object"!==typeof e.sourceInfo)throw TypeError(".tensorflow.magenta.NoteSequence.sourceInfo: object expected");t.sourceInfo=s.tensorflow.magenta.NoteSequence.SourceInfo.fromObject(e.sourceInfo)}if(e.textAnnotations){if(!Array.isArray(e.textAnnotations))throw TypeError(".tensorflow.magenta.NoteSequence.textAnnotations: array expected");t.textAnnotations=[];for(n=0;n<e.textAnnotations.length;++n){if("object"!==typeof e.textAnnotations[n])throw TypeError(".tensorflow.magenta.NoteSequence.textAnnotations: object expected");t.textAnnotations[n]=s.tensorflow.magenta.NoteSequence.TextAnnotation.fromObject(e.textAnnotations[n])}}if(e.sectionAnnotations){if(!Array.isArray(e.sectionAnnotations))throw TypeError(".tensorflow.magenta.NoteSequence.sectionAnnotations: array expected");t.sectionAnnotations=[];for(n=0;n<e.sectionAnnotations.length;++n){if("object"!==typeof e.sectionAnnotations[n])throw TypeError(".tensorflow.magenta.NoteSequence.sectionAnnotations: object expected");t.sectionAnnotations[n]=s.tensorflow.magenta.NoteSequence.SectionAnnotation.fromObject(e.sectionAnnotations[n])}}if(e.sectionGroups){if(!Array.isArray(e.sectionGroups))throw TypeError(".tensorflow.magenta.NoteSequence.sectionGroups: array expected");t.sectionGroups=[];for(n=0;n<e.sectionGroups.length;++n){if("object"!==typeof e.sectionGroups[n])throw TypeError(".tensorflow.magenta.NoteSequence.sectionGroups: object expected");t.sectionGroups[n]=s.tensorflow.magenta.NoteSequence.SectionGroup.fromObject(e.sectionGroups[n])}}if(null!=e.quantizationInfo){if("object"!==typeof e.quantizationInfo)throw TypeError(".tensorflow.magenta.NoteSequence.quantizationInfo: object expected");t.quantizationInfo=s.tensorflow.magenta.NoteSequence.QuantizationInfo.fromObject(e.quantizationInfo)}if(null!=e.subsequenceInfo){if("object"!==typeof e.subsequenceInfo)throw TypeError(".tensorflow.magenta.NoteSequence.subsequenceInfo: object expected");t.subsequenceInfo=s.tensorflow.magenta.NoteSequence.SubsequenceInfo.fromObject(e.subsequenceInfo)}if(null!=e.sequenceMetadata){if("object"!==typeof e.sequenceMetadata)throw TypeError(".tensorflow.magenta.NoteSequence.sequenceMetadata: object expected");t.sequenceMetadata=s.tensorflow.magenta.SequenceMetadata.fromObject(e.sequenceMetadata)}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.timeSignatures=[],n.keySignatures=[],n.tempos=[],n.notes=[],n.pitchBends=[],n.controlChanges=[],n.partInfos=[],n.textAnnotations=[],n.sectionAnnotations=[],n.sectionGroups=[]),t.defaults){if(n.id="",n.filename="",n.collectionName="",n.ticksPerQuarter=0,n.totalTime=0,n.sourceInfo=null,n.quantizationInfo=null,o.Long){var r=new o.Long(0,0,!1);n.totalQuantizedSteps=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.totalQuantizedSteps=t.longs===String?"0":0;if(n.subsequenceInfo=null,o.Long){r=new o.Long(0,0,!1);n.referenceNumber=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.referenceNumber=t.longs===String?"0":0;n.sequenceMetadata=null}if(null!=e.id&&e.hasOwnProperty("id")&&(n.id=e.id),null!=e.filename&&e.hasOwnProperty("filename")&&(n.filename=e.filename),null!=e.collectionName&&e.hasOwnProperty("collectionName")&&(n.collectionName=e.collectionName),null!=e.ticksPerQuarter&&e.hasOwnProperty("ticksPerQuarter")&&(n.ticksPerQuarter=e.ticksPerQuarter),e.timeSignatures&&e.timeSignatures.length){n.timeSignatures=[];for(var a=0;a<e.timeSignatures.length;++a)n.timeSignatures[a]=s.tensorflow.magenta.NoteSequence.TimeSignature.toObject(e.timeSignatures[a],t)}if(e.keySignatures&&e.keySignatures.length){n.keySignatures=[];for(a=0;a<e.keySignatures.length;++a)n.keySignatures[a]=s.tensorflow.magenta.NoteSequence.KeySignature.toObject(e.keySignatures[a],t)}if(e.tempos&&e.tempos.length){n.tempos=[];for(a=0;a<e.tempos.length;++a)n.tempos[a]=s.tensorflow.magenta.NoteSequence.Tempo.toObject(e.tempos[a],t)}if(e.notes&&e.notes.length){n.notes=[];for(a=0;a<e.notes.length;++a)n.notes[a]=s.tensorflow.magenta.NoteSequence.Note.toObject(e.notes[a],t)}if(null!=e.totalTime&&e.hasOwnProperty("totalTime")&&(n.totalTime=t.json&&!isFinite(e.totalTime)?String(e.totalTime):e.totalTime),e.pitchBends&&e.pitchBends.length){n.pitchBends=[];for(a=0;a<e.pitchBends.length;++a)n.pitchBends[a]=s.tensorflow.magenta.NoteSequence.PitchBend.toObject(e.pitchBends[a],t)}if(e.controlChanges&&e.controlChanges.length){n.controlChanges=[];for(a=0;a<e.controlChanges.length;++a)n.controlChanges[a]=s.tensorflow.magenta.NoteSequence.ControlChange.toObject(e.controlChanges[a],t)}if(e.partInfos&&e.partInfos.length){n.partInfos=[];for(a=0;a<e.partInfos.length;++a)n.partInfos[a]=s.tensorflow.magenta.NoteSequence.PartInfo.toObject(e.partInfos[a],t)}if(null!=e.sourceInfo&&e.hasOwnProperty("sourceInfo")&&(n.sourceInfo=s.tensorflow.magenta.NoteSequence.SourceInfo.toObject(e.sourceInfo,t)),e.textAnnotations&&e.textAnnotations.length){n.textAnnotations=[];for(a=0;a<e.textAnnotations.length;++a)n.textAnnotations[a]=s.tensorflow.magenta.NoteSequence.TextAnnotation.toObject(e.textAnnotations[a],t)}if(null!=e.quantizationInfo&&e.hasOwnProperty("quantizationInfo")&&(n.quantizationInfo=s.tensorflow.magenta.NoteSequence.QuantizationInfo.toObject(e.quantizationInfo,t)),null!=e.totalQuantizedSteps&&e.hasOwnProperty("totalQuantizedSteps")&&("number"===typeof e.totalQuantizedSteps?n.totalQuantizedSteps=t.longs===String?String(e.totalQuantizedSteps):e.totalQuantizedSteps:n.totalQuantizedSteps=t.longs===String?o.Long.prototype.toString.call(e.totalQuantizedSteps):t.longs===Number?new o.LongBits(e.totalQuantizedSteps.low>>>0,e.totalQuantizedSteps.high>>>0).toNumber():e.totalQuantizedSteps),null!=e.subsequenceInfo&&e.hasOwnProperty("subsequenceInfo")&&(n.subsequenceInfo=s.tensorflow.magenta.NoteSequence.SubsequenceInfo.toObject(e.subsequenceInfo,t)),null!=e.referenceNumber&&e.hasOwnProperty("referenceNumber")&&("number"===typeof e.referenceNumber?n.referenceNumber=t.longs===String?String(e.referenceNumber):e.referenceNumber:n.referenceNumber=t.longs===String?o.Long.prototype.toString.call(e.referenceNumber):t.longs===Number?new o.LongBits(e.referenceNumber.low>>>0,e.referenceNumber.high>>>0).toNumber():e.referenceNumber),null!=e.sequenceMetadata&&e.hasOwnProperty("sequenceMetadata")&&(n.sequenceMetadata=s.tensorflow.magenta.SequenceMetadata.toObject(e.sequenceMetadata,t)),e.sectionAnnotations&&e.sectionAnnotations.length){n.sectionAnnotations=[];for(a=0;a<e.sectionAnnotations.length;++a)n.sectionAnnotations[a]=s.tensorflow.magenta.NoteSequence.SectionAnnotation.toObject(e.sectionAnnotations[a],t)}if(e.sectionGroups&&e.sectionGroups.length){n.sectionGroups=[];for(a=0;a<e.sectionGroups.length;++a)n.sectionGroups[a]=s.tensorflow.magenta.NoteSequence.SectionGroup.toObject(e.sectionGroups[a],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.Note=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.pitch=0,e.prototype.pitchName=0,e.prototype.velocity=0,e.prototype.startTime=0,e.prototype.quantizedStartStep=o.Long?o.Long.fromBits(0,0,!1):0,e.prototype.endTime=0,e.prototype.quantizedEndStep=o.Long?o.Long.fromBits(0,0,!1):0,e.prototype.numerator=0,e.prototype.denominator=0,e.prototype.instrument=0,e.prototype.program=0,e.prototype.isDrum=!1,e.prototype.part=0,e.prototype.voice=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.pitch&&e.hasOwnProperty("pitch")&&t.uint32(8).int32(e.pitch),null!=e.velocity&&e.hasOwnProperty("velocity")&&t.uint32(16).int32(e.velocity),null!=e.startTime&&e.hasOwnProperty("startTime")&&t.uint32(25).double(e.startTime),null!=e.endTime&&e.hasOwnProperty("endTime")&&t.uint32(33).double(e.endTime),null!=e.numerator&&e.hasOwnProperty("numerator")&&t.uint32(40).int32(e.numerator),null!=e.denominator&&e.hasOwnProperty("denominator")&&t.uint32(48).int32(e.denominator),null!=e.instrument&&e.hasOwnProperty("instrument")&&t.uint32(56).int32(e.instrument),null!=e.program&&e.hasOwnProperty("program")&&t.uint32(64).int32(e.program),null!=e.isDrum&&e.hasOwnProperty("isDrum")&&t.uint32(72).bool(e.isDrum),null!=e.part&&e.hasOwnProperty("part")&&t.uint32(80).int32(e.part),null!=e.pitchName&&e.hasOwnProperty("pitchName")&&t.uint32(88).int32(e.pitchName),null!=e.voice&&e.hasOwnProperty("voice")&&t.uint32(96).int32(e.voice),null!=e.quantizedStartStep&&e.hasOwnProperty("quantizedStartStep")&&t.uint32(104).int64(e.quantizedStartStep),null!=e.quantizedEndStep&&e.hasOwnProperty("quantizedEndStep")&&t.uint32(112).int64(e.quantizedEndStep),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new s.tensorflow.magenta.NoteSequence.Note;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.pitch=e.int32();break;case 11:r.pitchName=e.int32();break;case 2:r.velocity=e.int32();break;case 3:r.startTime=e.double();break;case 13:r.quantizedStartStep=o.Long?e.int64().toNumber():e.int64();break;case 4:r.endTime=e.double();break;case 14:r.quantizedEndStep=o.Long?e.int64().toNumber():e.int64();break;case 5:r.numerator=e.int32();break;case 6:r.denominator=e.int32();break;case 7:r.instrument=e.int32();break;case 8:r.program=e.int32();break;case 9:r.isDrum=e.bool();break;case 10:r.part=e.int32();break;case 12:r.voice=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.pitch&&e.hasOwnProperty("pitch")&&!o.isInteger(e.pitch))return"pitch: integer expected";if(null!=e.pitchName&&e.hasOwnProperty("pitchName"))switch(e.pitchName){default:return"pitchName: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 30:case 31:case 32:case 33:case 34:case 35:}return null!=e.velocity&&e.hasOwnProperty("velocity")&&!o.isInteger(e.velocity)?"velocity: integer expected":null!=e.startTime&&e.hasOwnProperty("startTime")&&"number"!==typeof e.startTime?"startTime: number expected":null==e.quantizedStartStep||!e.hasOwnProperty("quantizedStartStep")||o.isInteger(e.quantizedStartStep)||e.quantizedStartStep&&o.isInteger(e.quantizedStartStep.low)&&o.isInteger(e.quantizedStartStep.high)?null!=e.endTime&&e.hasOwnProperty("endTime")&&"number"!==typeof e.endTime?"endTime: number expected":null==e.quantizedEndStep||!e.hasOwnProperty("quantizedEndStep")||o.isInteger(e.quantizedEndStep)||e.quantizedEndStep&&o.isInteger(e.quantizedEndStep.low)&&o.isInteger(e.quantizedEndStep.high)?null!=e.numerator&&e.hasOwnProperty("numerator")&&!o.isInteger(e.numerator)?"numerator: integer expected":null!=e.denominator&&e.hasOwnProperty("denominator")&&!o.isInteger(e.denominator)?"denominator: integer expected":null!=e.instrument&&e.hasOwnProperty("instrument")&&!o.isInteger(e.instrument)?"instrument: integer expected":null!=e.program&&e.hasOwnProperty("program")&&!o.isInteger(e.program)?"program: integer expected":null!=e.isDrum&&e.hasOwnProperty("isDrum")&&"boolean"!==typeof e.isDrum?"isDrum: boolean expected":null!=e.part&&e.hasOwnProperty("part")&&!o.isInteger(e.part)?"part: integer expected":null!=e.voice&&e.hasOwnProperty("voice")&&!o.isInteger(e.voice)?"voice: integer expected":null:"quantizedEndStep: integer|Long expected":"quantizedStartStep: integer|Long expected"},e.fromObject=function(e){if(e instanceof s.tensorflow.magenta.NoteSequence.Note)return e;var t=new s.tensorflow.magenta.NoteSequence.Note;switch(null!=e.pitch&&(t.pitch=0|e.pitch),e.pitchName){case"UNKNOWN_PITCH_NAME":case 0:t.pitchName=0;break;case"F_FLAT_FLAT":case 1:t.pitchName=1;break;case"C_FLAT_FLAT":case 2:t.pitchName=2;break;case"G_FLAT_FLAT":case 3:t.pitchName=3;break;case"D_FLAT_FLAT":case 4:t.pitchName=4;break;case"A_FLAT_FLAT":case 5:t.pitchName=5;break;case"E_FLAT_FLAT":case 6:t.pitchName=6;break;case"B_FLAT_FLAT":case 7:t.pitchName=7;break;case"F_FLAT":case 8:t.pitchName=8;break;case"C_FLAT":case 9:t.pitchName=9;break;case"G_FLAT":case 10:t.pitchName=10;break;case"D_FLAT":case 11:t.pitchName=11;break;case"A_FLAT":case 12:t.pitchName=12;break;case"E_FLAT":case 13:t.pitchName=13;break;case"B_FLAT":case 14:t.pitchName=14;break;case"F":case 15:t.pitchName=15;break;case"C":case 16:t.pitchName=16;break;case"G":case 17:t.pitchName=17;break;case"D":case 18:t.pitchName=18;break;case"A":case 19:t.pitchName=19;break;case"E":case 20:t.pitchName=20;break;case"B":case 21:t.pitchName=21;break;case"F_SHARP":case 22:t.pitchName=22;break;case"C_SHARP":case 23:t.pitchName=23;break;case"G_SHARP":case 24:t.pitchName=24;break;case"D_SHARP":case 25:t.pitchName=25;break;case"A_SHARP":case 26:t.pitchName=26;break;case"E_SHARP":case 27:t.pitchName=27;break;case"B_SHARP":case 28:t.pitchName=28;break;case"F_SHARP_SHARP":case 29:t.pitchName=29;break;case"C_SHARP_SHARP":case 30:t.pitchName=30;break;case"G_SHARP_SHARP":case 31:t.pitchName=31;break;case"D_SHARP_SHARP":case 32:t.pitchName=32;break;case"A_SHARP_SHARP":case 33:t.pitchName=33;break;case"E_SHARP_SHARP":case 34:t.pitchName=34;break;case"B_SHARP_SHARP":case 35:t.pitchName=35}return null!=e.velocity&&(t.velocity=0|e.velocity),null!=e.startTime&&(t.startTime=Number(e.startTime)),null!=e.quantizedStartStep&&(o.Long?(t.quantizedStartStep=o.Long.fromValue(e.quantizedStartStep)).unsigned=!1:"string"===typeof e.quantizedStartStep?t.quantizedStartStep=parseInt(e.quantizedStartStep,10):"number"===typeof e.quantizedStartStep?t.quantizedStartStep=e.quantizedStartStep:"object"===typeof e.quantizedStartStep&&(t.quantizedStartStep=new o.LongBits(e.quantizedStartStep.low>>>0,e.quantizedStartStep.high>>>0).toNumber())),null!=e.endTime&&(t.endTime=Number(e.endTime)),null!=e.quantizedEndStep&&(o.Long?(t.quantizedEndStep=o.Long.fromValue(e.quantizedEndStep)).unsigned=!1:"string"===typeof e.quantizedEndStep?t.quantizedEndStep=parseInt(e.quantizedEndStep,10):"number"===typeof e.quantizedEndStep?t.quantizedEndStep=e.quantizedEndStep:"object"===typeof e.quantizedEndStep&&(t.quantizedEndStep=new o.LongBits(e.quantizedEndStep.low>>>0,e.quantizedEndStep.high>>>0).toNumber())),null!=e.numerator&&(t.numerator=0|e.numerator),null!=e.denominator&&(t.denominator=0|e.denominator),null!=e.instrument&&(t.instrument=0|e.instrument),null!=e.program&&(t.program=0|e.program),null!=e.isDrum&&(t.isDrum=Boolean(e.isDrum)),null!=e.part&&(t.part=0|e.part),null!=e.voice&&(t.voice=0|e.voice),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(n.pitch=0,n.velocity=0,n.startTime=0,n.endTime=0,n.numerator=0,n.denominator=0,n.instrument=0,n.program=0,n.isDrum=!1,n.part=0,n.pitchName=t.enums===String?"UNKNOWN_PITCH_NAME":0,n.voice=0,o.Long){var r=new o.Long(0,0,!1);n.quantizedStartStep=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.quantizedStartStep=t.longs===String?"0":0;if(o.Long){r=new o.Long(0,0,!1);n.quantizedEndStep=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.quantizedEndStep=t.longs===String?"0":0}return null!=e.pitch&&e.hasOwnProperty("pitch")&&(n.pitch=e.pitch),null!=e.velocity&&e.hasOwnProperty("velocity")&&(n.velocity=e.velocity),null!=e.startTime&&e.hasOwnProperty("startTime")&&(n.startTime=t.json&&!isFinite(e.startTime)?String(e.startTime):e.startTime),null!=e.endTime&&e.hasOwnProperty("endTime")&&(n.endTime=t.json&&!isFinite(e.endTime)?String(e.endTime):e.endTime),null!=e.numerator&&e.hasOwnProperty("numerator")&&(n.numerator=e.numerator),null!=e.denominator&&e.hasOwnProperty("denominator")&&(n.denominator=e.denominator),null!=e.instrument&&e.hasOwnProperty("instrument")&&(n.instrument=e.instrument),null!=e.program&&e.hasOwnProperty("program")&&(n.program=e.program),null!=e.isDrum&&e.hasOwnProperty("isDrum")&&(n.isDrum=e.isDrum),null!=e.part&&e.hasOwnProperty("part")&&(n.part=e.part),null!=e.pitchName&&e.hasOwnProperty("pitchName")&&(n.pitchName=t.enums===String?s.tensorflow.magenta.NoteSequence.PitchName[e.pitchName]:e.pitchName),null!=e.voice&&e.hasOwnProperty("voice")&&(n.voice=e.voice),null!=e.quantizedStartStep&&e.hasOwnProperty("quantizedStartStep")&&("number"===typeof e.quantizedStartStep?n.quantizedStartStep=t.longs===String?String(e.quantizedStartStep):e.quantizedStartStep:n.quantizedStartStep=t.longs===String?o.Long.prototype.toString.call(e.quantizedStartStep):t.longs===Number?new o.LongBits(e.quantizedStartStep.low>>>0,e.quantizedStartStep.high>>>0).toNumber():e.quantizedStartStep),null!=e.quantizedEndStep&&e.hasOwnProperty("quantizedEndStep")&&("number"===typeof e.quantizedEndStep?n.quantizedEndStep=t.longs===String?String(e.quantizedEndStep):e.quantizedEndStep:n.quantizedEndStep=t.longs===String?o.Long.prototype.toString.call(e.quantizedEndStep):t.longs===Number?new o.LongBits(e.quantizedEndStep.low>>>0,e.quantizedEndStep.high>>>0).toNumber():e.quantizedEndStep),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.PitchName=function(){var e={},t=Object.create(e);return t[e[0]="UNKNOWN_PITCH_NAME"]=0,t[e[1]="F_FLAT_FLAT"]=1,t[e[2]="C_FLAT_FLAT"]=2,t[e[3]="G_FLAT_FLAT"]=3,t[e[4]="D_FLAT_FLAT"]=4,t[e[5]="A_FLAT_FLAT"]=5,t[e[6]="E_FLAT_FLAT"]=6,t[e[7]="B_FLAT_FLAT"]=7,t[e[8]="F_FLAT"]=8,t[e[9]="C_FLAT"]=9,t[e[10]="G_FLAT"]=10,t[e[11]="D_FLAT"]=11,t[e[12]="A_FLAT"]=12,t[e[13]="E_FLAT"]=13,t[e[14]="B_FLAT"]=14,t[e[15]="F"]=15,t[e[16]="C"]=16,t[e[17]="G"]=17,t[e[18]="D"]=18,t[e[19]="A"]=19,t[e[20]="E"]=20,t[e[21]="B"]=21,t[e[22]="F_SHARP"]=22,t[e[23]="C_SHARP"]=23,t[e[24]="G_SHARP"]=24,t[e[25]="D_SHARP"]=25,t[e[26]="A_SHARP"]=26,t[e[27]="E_SHARP"]=27,t[e[28]="B_SHARP"]=28,t[e[29]="F_SHARP_SHARP"]=29,t[e[30]="C_SHARP_SHARP"]=30,t[e[31]="G_SHARP_SHARP"]=31,t[e[32]="D_SHARP_SHARP"]=32,t[e[33]="A_SHARP_SHARP"]=33,t[e[34]="E_SHARP_SHARP"]=34,t[e[35]="B_SHARP_SHARP"]=35,t}(),e.TimeSignature=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.time=0,e.prototype.numerator=0,e.prototype.denominator=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.time&&e.hasOwnProperty("time")&&t.uint32(9).double(e.time),null!=e.numerator&&e.hasOwnProperty("numerator")&&t.uint32(16).int32(e.numerator),null!=e.denominator&&e.hasOwnProperty("denominator")&&t.uint32(24).int32(e.denominator),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new s.tensorflow.magenta.NoteSequence.TimeSignature;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.time=e.double();break;case 2:r.numerator=e.int32();break;case 3:r.denominator=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.time&&e.hasOwnProperty("time")&&"number"!==typeof e.time?"time: number expected":null!=e.numerator&&e.hasOwnProperty("numerator")&&!o.isInteger(e.numerator)?"numerator: integer expected":null!=e.denominator&&e.hasOwnProperty("denominator")&&!o.isInteger(e.denominator)?"denominator: integer expected":null},e.fromObject=function(e){if(e instanceof s.tensorflow.magenta.NoteSequence.TimeSignature)return e;var t=new s.tensorflow.magenta.NoteSequence.TimeSignature;return null!=e.time&&(t.time=Number(e.time)),null!=e.numerator&&(t.numerator=0|e.numerator),null!=e.denominator&&(t.denominator=0|e.denominator),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.time=0,n.numerator=0,n.denominator=0),null!=e.time&&e.hasOwnProperty("time")&&(n.time=t.json&&!isFinite(e.time)?String(e.time):e.time),null!=e.numerator&&e.hasOwnProperty("numerator")&&(n.numerator=e.numerator),null!=e.denominator&&e.hasOwnProperty("denominator")&&(n.denominator=e.denominator),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.KeySignature=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.time=0,e.prototype.key=0,e.prototype.mode=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.time&&e.hasOwnProperty("time")&&t.uint32(9).double(e.time),null!=e.key&&e.hasOwnProperty("key")&&t.uint32(16).int32(e.key),null!=e.mode&&e.hasOwnProperty("mode")&&t.uint32(24).int32(e.mode),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new s.tensorflow.magenta.NoteSequence.KeySignature;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.time=e.double();break;case 2:r.key=e.int32();break;case 3:r.mode=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.time&&e.hasOwnProperty("time")&&"number"!==typeof e.time)return"time: number expected";if(null!=e.key&&e.hasOwnProperty("key"))switch(e.key){default:return"key: enum value expected";case 0:case 1:case 1:case 2:case 3:case 3:case 4:case 5:case 6:case 6:case 7:case 8:case 8:case 9:case 10:case 10:case 11:}if(null!=e.mode&&e.hasOwnProperty("mode"))switch(e.mode){default:return"mode: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:}return null},e.fromObject=function(e){if(e instanceof s.tensorflow.magenta.NoteSequence.KeySignature)return e;var t=new s.tensorflow.magenta.NoteSequence.KeySignature;switch(null!=e.time&&(t.time=Number(e.time)),e.key){case"C":case 0:t.key=0;break;case"C_SHARP":case 1:case"D_FLAT":case 1:t.key=1;break;case"D":case 2:t.key=2;break;case"D_SHARP":case 3:case"E_FLAT":case 3:t.key=3;break;case"E":case 4:t.key=4;break;case"F":case 5:t.key=5;break;case"F_SHARP":case 6:case"G_FLAT":case 6:t.key=6;break;case"G":case 7:t.key=7;break;case"G_SHARP":case 8:case"A_FLAT":case 8:t.key=8;break;case"A":case 9:t.key=9;break;case"A_SHARP":case 10:case"B_FLAT":case 10:t.key=10;break;case"B":case 11:t.key=11}switch(e.mode){case"MAJOR":case 0:t.mode=0;break;case"MINOR":case 1:t.mode=1;break;case"NOT_SPECIFIED":case 2:t.mode=2;break;case"MIXOLYDIAN":case 3:t.mode=3;break;case"DORIAN":case 4:t.mode=4;break;case"PHRYGIAN":case 5:t.mode=5;break;case"LYDIAN":case 6:t.mode=6;break;case"LOCRIAN":case 7:t.mode=7}return t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.time=0,n.key=t.enums===String?"C":0,n.mode=t.enums===String?"MAJOR":0),null!=e.time&&e.hasOwnProperty("time")&&(n.time=t.json&&!isFinite(e.time)?String(e.time):e.time),null!=e.key&&e.hasOwnProperty("key")&&(n.key=t.enums===String?s.tensorflow.magenta.NoteSequence.KeySignature.Key[e.key]:e.key),null!=e.mode&&e.hasOwnProperty("mode")&&(n.mode=t.enums===String?s.tensorflow.magenta.NoteSequence.KeySignature.Mode[e.mode]:e.mode),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.Key=function(){var e={},t=Object.create(e);return t[e[0]="C"]=0,t[e[1]="C_SHARP"]=1,t.D_FLAT=1,t[e[2]="D"]=2,t[e[3]="D_SHARP"]=3,t.E_FLAT=3,t[e[4]="E"]=4,t[e[5]="F"]=5,t[e[6]="F_SHARP"]=6,t.G_FLAT=6,t[e[7]="G"]=7,t[e[8]="G_SHARP"]=8,t.A_FLAT=8,t[e[9]="A"]=9,t[e[10]="A_SHARP"]=10,t.B_FLAT=10,t[e[11]="B"]=11,t}(),e.Mode=function(){var e={},t=Object.create(e);return t[e[0]="MAJOR"]=0,t[e[1]="MINOR"]=1,t[e[2]="NOT_SPECIFIED"]=2,t[e[3]="MIXOLYDIAN"]=3,t[e[4]="DORIAN"]=4,t[e[5]="PHRYGIAN"]=5,t[e[6]="LYDIAN"]=6,t[e[7]="LOCRIAN"]=7,t}(),e}(),e.Tempo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.time=0,e.prototype.qpm=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.time&&e.hasOwnProperty("time")&&t.uint32(9).double(e.time),null!=e.qpm&&e.hasOwnProperty("qpm")&&t.uint32(17).double(e.qpm),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new s.tensorflow.magenta.NoteSequence.Tempo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.time=e.double();break;case 2:r.qpm=e.double();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.time&&e.hasOwnProperty("time")&&"number"!==typeof e.time?"time: number expected":null!=e.qpm&&e.hasOwnProperty("qpm")&&"number"!==typeof e.qpm?"qpm: number expected":null},e.fromObject=function(e){if(e instanceof s.tensorflow.magenta.NoteSequence.Tempo)return e;var t=new s.tensorflow.magenta.NoteSequence.Tempo;return null!=e.time&&(t.time=Number(e.time)),null!=e.qpm&&(t.qpm=Number(e.qpm)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.time=0,n.qpm=0),null!=e.time&&e.hasOwnProperty("time")&&(n.time=t.json&&!isFinite(e.time)?String(e.time):e.time),null!=e.qpm&&e.hasOwnProperty("qpm")&&(n.qpm=t.json&&!isFinite(e.qpm)?String(e.qpm):e.qpm),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.PitchBend=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.time=0,e.prototype.bend=0,e.prototype.instrument=0,e.prototype.program=0,e.prototype.isDrum=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.time&&e.hasOwnProperty("time")&&t.uint32(9).double(e.time),null!=e.bend&&e.hasOwnProperty("bend")&&t.uint32(16).int32(e.bend),null!=e.instrument&&e.hasOwnProperty("instrument")&&t.uint32(24).int32(e.instrument),null!=e.program&&e.hasOwnProperty("program")&&t.uint32(32).int32(e.program),null!=e.isDrum&&e.hasOwnProperty("isDrum")&&t.uint32(40).bool(e.isDrum),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new s.tensorflow.magenta.NoteSequence.PitchBend;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.time=e.double();break;case 2:r.bend=e.int32();break;case 3:r.instrument=e.int32();break;case 4:r.program=e.int32();break;case 5:r.isDrum=e.bool();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.time&&e.hasOwnProperty("time")&&"number"!==typeof e.time?"time: number expected":null!=e.bend&&e.hasOwnProperty("bend")&&!o.isInteger(e.bend)?"bend: integer expected":null!=e.instrument&&e.hasOwnProperty("instrument")&&!o.isInteger(e.instrument)?"instrument: integer expected":null!=e.program&&e.hasOwnProperty("program")&&!o.isInteger(e.program)?"program: integer expected":null!=e.isDrum&&e.hasOwnProperty("isDrum")&&"boolean"!==typeof e.isDrum?"isDrum: boolean expected":null},e.fromObject=function(e){if(e instanceof s.tensorflow.magenta.NoteSequence.PitchBend)return e;var t=new s.tensorflow.magenta.NoteSequence.PitchBend;return null!=e.time&&(t.time=Number(e.time)),null!=e.bend&&(t.bend=0|e.bend),null!=e.instrument&&(t.instrument=0|e.instrument),null!=e.program&&(t.program=0|e.program),null!=e.isDrum&&(t.isDrum=Boolean(e.isDrum)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.time=0,n.bend=0,n.instrument=0,n.program=0,n.isDrum=!1),null!=e.time&&e.hasOwnProperty("time")&&(n.time=t.json&&!isFinite(e.time)?String(e.time):e.time),null!=e.bend&&e.hasOwnProperty("bend")&&(n.bend=e.bend),null!=e.instrument&&e.hasOwnProperty("instrument")&&(n.instrument=e.instrument),null!=e.program&&e.hasOwnProperty("program")&&(n.program=e.program),null!=e.isDrum&&e.hasOwnProperty("isDrum")&&(n.isDrum=e.isDrum),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.ControlChange=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.time=0,e.prototype.quantizedStep=o.Long?o.Long.fromBits(0,0,!1):0,e.prototype.controlNumber=0,e.prototype.controlValue=0,e.prototype.instrument=0,e.prototype.program=0,e.prototype.isDrum=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.time&&e.hasOwnProperty("time")&&t.uint32(9).double(e.time),null!=e.controlNumber&&e.hasOwnProperty("controlNumber")&&t.uint32(16).int32(e.controlNumber),null!=e.controlValue&&e.hasOwnProperty("controlValue")&&t.uint32(24).int32(e.controlValue),null!=e.instrument&&e.hasOwnProperty("instrument")&&t.uint32(32).int32(e.instrument),null!=e.program&&e.hasOwnProperty("program")&&t.uint32(40).int32(e.program),null!=e.isDrum&&e.hasOwnProperty("isDrum")&&t.uint32(48).bool(e.isDrum),null!=e.quantizedStep&&e.hasOwnProperty("quantizedStep")&&t.uint32(56).int64(e.quantizedStep),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new s.tensorflow.magenta.NoteSequence.ControlChange;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.time=e.double();break;case 7:r.quantizedStep=o.Long?e.int64().toNumber():e.int64();break;case 2:r.controlNumber=e.int32();break;case 3:r.controlValue=e.int32();break;case 4:r.instrument=e.int32();break;case 5:r.program=e.int32();break;case 6:r.isDrum=e.bool();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.time&&e.hasOwnProperty("time")&&"number"!==typeof e.time?"time: number expected":null==e.quantizedStep||!e.hasOwnProperty("quantizedStep")||o.isInteger(e.quantizedStep)||e.quantizedStep&&o.isInteger(e.quantizedStep.low)&&o.isInteger(e.quantizedStep.high)?null!=e.controlNumber&&e.hasOwnProperty("controlNumber")&&!o.isInteger(e.controlNumber)?"controlNumber: integer expected":null!=e.controlValue&&e.hasOwnProperty("controlValue")&&!o.isInteger(e.controlValue)?"controlValue: integer expected":null!=e.instrument&&e.hasOwnProperty("instrument")&&!o.isInteger(e.instrument)?"instrument: integer expected":null!=e.program&&e.hasOwnProperty("program")&&!o.isInteger(e.program)?"program: integer expected":null!=e.isDrum&&e.hasOwnProperty("isDrum")&&"boolean"!==typeof e.isDrum?"isDrum: boolean expected":null:"quantizedStep: integer|Long expected"},e.fromObject=function(e){if(e instanceof s.tensorflow.magenta.NoteSequence.ControlChange)return e;var t=new s.tensorflow.magenta.NoteSequence.ControlChange;return null!=e.time&&(t.time=Number(e.time)),null!=e.quantizedStep&&(o.Long?(t.quantizedStep=o.Long.fromValue(e.quantizedStep)).unsigned=!1:"string"===typeof e.quantizedStep?t.quantizedStep=parseInt(e.quantizedStep,10):"number"===typeof e.quantizedStep?t.quantizedStep=e.quantizedStep:"object"===typeof e.quantizedStep&&(t.quantizedStep=new o.LongBits(e.quantizedStep.low>>>0,e.quantizedStep.high>>>0).toNumber())),null!=e.controlNumber&&(t.controlNumber=0|e.controlNumber),null!=e.controlValue&&(t.controlValue=0|e.controlValue),null!=e.instrument&&(t.instrument=0|e.instrument),null!=e.program&&(t.program=0|e.program),null!=e.isDrum&&(t.isDrum=Boolean(e.isDrum)),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults)if(n.time=0,n.controlNumber=0,n.controlValue=0,n.instrument=0,n.program=0,n.isDrum=!1,o.Long){var r=new o.Long(0,0,!1);n.quantizedStep=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.quantizedStep=t.longs===String?"0":0;return null!=e.time&&e.hasOwnProperty("time")&&(n.time=t.json&&!isFinite(e.time)?String(e.time):e.time),null!=e.controlNumber&&e.hasOwnProperty("controlNumber")&&(n.controlNumber=e.controlNumber),null!=e.controlValue&&e.hasOwnProperty("controlValue")&&(n.controlValue=e.controlValue),null!=e.instrument&&e.hasOwnProperty("instrument")&&(n.instrument=e.instrument),null!=e.program&&e.hasOwnProperty("program")&&(n.program=e.program),null!=e.isDrum&&e.hasOwnProperty("isDrum")&&(n.isDrum=e.isDrum),null!=e.quantizedStep&&e.hasOwnProperty("quantizedStep")&&("number"===typeof e.quantizedStep?n.quantizedStep=t.longs===String?String(e.quantizedStep):e.quantizedStep:n.quantizedStep=t.longs===String?o.Long.prototype.toString.call(e.quantizedStep):t.longs===Number?new o.LongBits(e.quantizedStep.low>>>0,e.quantizedStep.high>>>0).toNumber():e.quantizedStep),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.PartInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.part=0,e.prototype.name="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.part&&e.hasOwnProperty("part")&&t.uint32(8).int32(e.part),null!=e.name&&e.hasOwnProperty("name")&&t.uint32(18).string(e.name),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new s.tensorflow.magenta.NoteSequence.PartInfo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.part=e.int32();break;case 2:r.name=e.string();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.part&&e.hasOwnProperty("part")&&!o.isInteger(e.part)?"part: integer expected":null!=e.name&&e.hasOwnProperty("name")&&!o.isString(e.name)?"name: string expected":null},e.fromObject=function(e){if(e instanceof s.tensorflow.magenta.NoteSequence.PartInfo)return e;var t=new s.tensorflow.magenta.NoteSequence.PartInfo;return null!=e.part&&(t.part=0|e.part),null!=e.name&&(t.name=String(e.name)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.part=0,n.name=""),null!=e.part&&e.hasOwnProperty("part")&&(n.part=e.part),null!=e.name&&e.hasOwnProperty("name")&&(n.name=e.name),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.SourceInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sourceType=0,e.prototype.encodingType=0,e.prototype.parser=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.sourceType&&e.hasOwnProperty("sourceType")&&t.uint32(8).int32(e.sourceType),null!=e.encodingType&&e.hasOwnProperty("encodingType")&&t.uint32(16).int32(e.encodingType),null!=e.parser&&e.hasOwnProperty("parser")&&t.uint32(24).int32(e.parser),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new s.tensorflow.magenta.NoteSequence.SourceInfo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sourceType=e.int32();break;case 2:r.encodingType=e.int32();break;case 3:r.parser=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.sourceType&&e.hasOwnProperty("sourceType"))switch(e.sourceType){default:return"sourceType: enum value expected";case 0:case 1:case 2:}if(null!=e.encodingType&&e.hasOwnProperty("encodingType"))switch(e.encodingType){default:return"encodingType: enum value expected";case 0:case 1:case 2:case 3:case 4:}if(null!=e.parser&&e.hasOwnProperty("parser"))switch(e.parser){default:return"parser: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:}return null},e.fromObject=function(e){if(e instanceof s.tensorflow.magenta.NoteSequence.SourceInfo)return e;var t=new s.tensorflow.magenta.NoteSequence.SourceInfo;switch(e.sourceType){case"UNKNOWN_SOURCE_TYPE":case 0:t.sourceType=0;break;case"SCORE_BASED":case 1:t.sourceType=1;break;case"PERFORMANCE_BASED":case 2:t.sourceType=2}switch(e.encodingType){case"UNKNOWN_ENCODING_TYPE":case 0:t.encodingType=0;break;case"MUSIC_XML":case 1:t.encodingType=1;break;case"ABC":case 2:t.encodingType=2;break;case"MIDI":case 3:t.encodingType=3;break;case"MUSICNET":case 4:t.encodingType=4}switch(e.parser){case"UNKNOWN_PARSER":case 0:t.parser=0;break;case"MUSIC21":case 1:t.parser=1;break;case"PRETTY_MIDI":case 2:t.parser=2;break;case"MAGENTA_MUSIC_XML":case 3:t.parser=3;break;case"MAGENTA_MUSICNET":case 4:t.parser=4;break;case"MAGENTA_ABC":case 5:t.parser=5;break;case"TONEJS_MIDI_CONVERT":case 6:t.parser=6}return t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.sourceType=t.enums===String?"UNKNOWN_SOURCE_TYPE":0,n.encodingType=t.enums===String?"UNKNOWN_ENCODING_TYPE":0,n.parser=t.enums===String?"UNKNOWN_PARSER":0),null!=e.sourceType&&e.hasOwnProperty("sourceType")&&(n.sourceType=t.enums===String?s.tensorflow.magenta.NoteSequence.SourceInfo.SourceType[e.sourceType]:e.sourceType),null!=e.encodingType&&e.hasOwnProperty("encodingType")&&(n.encodingType=t.enums===String?s.tensorflow.magenta.NoteSequence.SourceInfo.EncodingType[e.encodingType]:e.encodingType),null!=e.parser&&e.hasOwnProperty("parser")&&(n.parser=t.enums===String?s.tensorflow.magenta.NoteSequence.SourceInfo.Parser[e.parser]:e.parser),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.SourceType=function(){var e={},t=Object.create(e);return t[e[0]="UNKNOWN_SOURCE_TYPE"]=0,t[e[1]="SCORE_BASED"]=1,t[e[2]="PERFORMANCE_BASED"]=2,t}(),e.EncodingType=function(){var e={},t=Object.create(e);return t[e[0]="UNKNOWN_ENCODING_TYPE"]=0,t[e[1]="MUSIC_XML"]=1,t[e[2]="ABC"]=2,t[e[3]="MIDI"]=3,t[e[4]="MUSICNET"]=4,t}(),e.Parser=function(){var e={},t=Object.create(e);return t[e[0]="UNKNOWN_PARSER"]=0,t[e[1]="MUSIC21"]=1,t[e[2]="PRETTY_MIDI"]=2,t[e[3]="MAGENTA_MUSIC_XML"]=3,t[e[4]="MAGENTA_MUSICNET"]=4,t[e[5]="MAGENTA_ABC"]=5,t[e[6]="TONEJS_MIDI_CONVERT"]=6,t}(),e}(),e.TextAnnotation=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.time=0,e.prototype.quantizedStep=o.Long?o.Long.fromBits(0,0,!1):0,e.prototype.text="",e.prototype.annotationType=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.time&&e.hasOwnProperty("time")&&t.uint32(9).double(e.time),null!=e.text&&e.hasOwnProperty("text")&&t.uint32(18).string(e.text),null!=e.annotationType&&e.hasOwnProperty("annotationType")&&t.uint32(24).int32(e.annotationType),null!=e.quantizedStep&&e.hasOwnProperty("quantizedStep")&&t.uint32(32).int64(e.quantizedStep),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new s.tensorflow.magenta.NoteSequence.TextAnnotation;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.time=e.double();break;case 4:r.quantizedStep=o.Long?e.int64().toNumber():e.int64();break;case 2:r.text=e.string();break;case 3:r.annotationType=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.time&&e.hasOwnProperty("time")&&"number"!==typeof e.time)return"time: number expected";if(null!=e.quantizedStep&&e.hasOwnProperty("quantizedStep")&&!o.isInteger(e.quantizedStep)&&!(e.quantizedStep&&o.isInteger(e.quantizedStep.low)&&o.isInteger(e.quantizedStep.high)))return"quantizedStep: integer|Long expected";if(null!=e.text&&e.hasOwnProperty("text")&&!o.isString(e.text))return"text: string expected";if(null!=e.annotationType&&e.hasOwnProperty("annotationType"))switch(e.annotationType){default:return"annotationType: enum value expected";case 0:case 1:case 2:}return null},e.fromObject=function(e){if(e instanceof s.tensorflow.magenta.NoteSequence.TextAnnotation)return e;var t=new s.tensorflow.magenta.NoteSequence.TextAnnotation;switch(null!=e.time&&(t.time=Number(e.time)),null!=e.quantizedStep&&(o.Long?(t.quantizedStep=o.Long.fromValue(e.quantizedStep)).unsigned=!1:"string"===typeof e.quantizedStep?t.quantizedStep=parseInt(e.quantizedStep,10):"number"===typeof e.quantizedStep?t.quantizedStep=e.quantizedStep:"object"===typeof e.quantizedStep&&(t.quantizedStep=new o.LongBits(e.quantizedStep.low>>>0,e.quantizedStep.high>>>0).toNumber())),null!=e.text&&(t.text=String(e.text)),e.annotationType){case"UNKNOWN":case 0:t.annotationType=0;break;case"CHORD_SYMBOL":case 1:t.annotationType=1;break;case"BEAT":case 2:t.annotationType=2}return t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults)if(n.time=0,n.text="",n.annotationType=t.enums===String?"UNKNOWN":0,o.Long){var r=new o.Long(0,0,!1);n.quantizedStep=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.quantizedStep=t.longs===String?"0":0;return null!=e.time&&e.hasOwnProperty("time")&&(n.time=t.json&&!isFinite(e.time)?String(e.time):e.time),null!=e.text&&e.hasOwnProperty("text")&&(n.text=e.text),null!=e.annotationType&&e.hasOwnProperty("annotationType")&&(n.annotationType=t.enums===String?s.tensorflow.magenta.NoteSequence.TextAnnotation.TextAnnotationType[e.annotationType]:e.annotationType),null!=e.quantizedStep&&e.hasOwnProperty("quantizedStep")&&("number"===typeof e.quantizedStep?n.quantizedStep=t.longs===String?String(e.quantizedStep):e.quantizedStep:n.quantizedStep=t.longs===String?o.Long.prototype.toString.call(e.quantizedStep):t.longs===Number?new o.LongBits(e.quantizedStep.low>>>0,e.quantizedStep.high>>>0).toNumber():e.quantizedStep),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e.TextAnnotationType=function(){var e={},t=Object.create(e);return t[e[0]="UNKNOWN"]=0,t[e[1]="CHORD_SYMBOL"]=1,t[e[2]="BEAT"]=2,t}(),e}(),e.QuantizationInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}var t;return e.prototype.stepsPerQuarter=0,e.prototype.stepsPerSecond=0,Object.defineProperty(e.prototype,"resolution",{get:o.oneOfGetter(t=["stepsPerQuarter","stepsPerSecond"]),set:o.oneOfSetter(t)}),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.stepsPerQuarter&&e.hasOwnProperty("stepsPerQuarter")&&t.uint32(8).int32(e.stepsPerQuarter),null!=e.stepsPerSecond&&e.hasOwnProperty("stepsPerSecond")&&t.uint32(16).int32(e.stepsPerSecond),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new s.tensorflow.magenta.NoteSequence.QuantizationInfo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.stepsPerQuarter=e.int32();break;case 2:r.stepsPerSecond=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";var t={};if(null!=e.stepsPerQuarter&&e.hasOwnProperty("stepsPerQuarter")&&(t.resolution=1,!o.isInteger(e.stepsPerQuarter)))return"stepsPerQuarter: integer expected";if(null!=e.stepsPerSecond&&e.hasOwnProperty("stepsPerSecond")){if(1===t.resolution)return"resolution: multiple values";if(t.resolution=1,!o.isInteger(e.stepsPerSecond))return"stepsPerSecond: integer expected"}return null},e.fromObject=function(e){if(e instanceof s.tensorflow.magenta.NoteSequence.QuantizationInfo)return e;var t=new s.tensorflow.magenta.NoteSequence.QuantizationInfo;return null!=e.stepsPerQuarter&&(t.stepsPerQuarter=0|e.stepsPerQuarter),null!=e.stepsPerSecond&&(t.stepsPerSecond=0|e.stepsPerSecond),t},e.toObject=function(e,t){t||(t={});var n={};return null!=e.stepsPerQuarter&&e.hasOwnProperty("stepsPerQuarter")&&(n.stepsPerQuarter=e.stepsPerQuarter,t.oneofs&&(n.resolution="stepsPerQuarter")),null!=e.stepsPerSecond&&e.hasOwnProperty("stepsPerSecond")&&(n.stepsPerSecond=e.stepsPerSecond,t.oneofs&&(n.resolution="stepsPerSecond")),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.SubsequenceInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.startTimeOffset=0,e.prototype.endTimeOffset=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.startTimeOffset&&e.hasOwnProperty("startTimeOffset")&&t.uint32(9).double(e.startTimeOffset),null!=e.endTimeOffset&&e.hasOwnProperty("endTimeOffset")&&t.uint32(17).double(e.endTimeOffset),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new s.tensorflow.magenta.NoteSequence.SubsequenceInfo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.startTimeOffset=e.double();break;case 2:r.endTimeOffset=e.double();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.startTimeOffset&&e.hasOwnProperty("startTimeOffset")&&"number"!==typeof e.startTimeOffset?"startTimeOffset: number expected":null!=e.endTimeOffset&&e.hasOwnProperty("endTimeOffset")&&"number"!==typeof e.endTimeOffset?"endTimeOffset: number expected":null},e.fromObject=function(e){if(e instanceof s.tensorflow.magenta.NoteSequence.SubsequenceInfo)return e;var t=new s.tensorflow.magenta.NoteSequence.SubsequenceInfo;return null!=e.startTimeOffset&&(t.startTimeOffset=Number(e.startTimeOffset)),null!=e.endTimeOffset&&(t.endTimeOffset=Number(e.endTimeOffset)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.startTimeOffset=0,n.endTimeOffset=0),null!=e.startTimeOffset&&e.hasOwnProperty("startTimeOffset")&&(n.startTimeOffset=t.json&&!isFinite(e.startTimeOffset)?String(e.startTimeOffset):e.startTimeOffset),null!=e.endTimeOffset&&e.hasOwnProperty("endTimeOffset")&&(n.endTimeOffset=t.json&&!isFinite(e.endTimeOffset)?String(e.endTimeOffset):e.endTimeOffset),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.SectionAnnotation=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.time=0,e.prototype.sectionId=o.Long?o.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.time&&e.hasOwnProperty("time")&&t.uint32(9).double(e.time),null!=e.sectionId&&e.hasOwnProperty("sectionId")&&t.uint32(32).int64(e.sectionId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new s.tensorflow.magenta.NoteSequence.SectionAnnotation;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.time=e.double();break;case 4:r.sectionId=o.Long?e.int64().toNumber():e.int64();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.time&&e.hasOwnProperty("time")&&"number"!==typeof e.time?"time: number expected":null==e.sectionId||!e.hasOwnProperty("sectionId")||o.isInteger(e.sectionId)||e.sectionId&&o.isInteger(e.sectionId.low)&&o.isInteger(e.sectionId.high)?null:"sectionId: integer|Long expected"},e.fromObject=function(e){if(e instanceof s.tensorflow.magenta.NoteSequence.SectionAnnotation)return e;var t=new s.tensorflow.magenta.NoteSequence.SectionAnnotation;return null!=e.time&&(t.time=Number(e.time)),null!=e.sectionId&&(o.Long?(t.sectionId=o.Long.fromValue(e.sectionId)).unsigned=!1:"string"===typeof e.sectionId?t.sectionId=parseInt(e.sectionId,10):"number"===typeof e.sectionId?t.sectionId=e.sectionId:"object"===typeof e.sectionId&&(t.sectionId=new o.LongBits(e.sectionId.low>>>0,e.sectionId.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults)if(n.time=0,o.Long){var r=new o.Long(0,0,!1);n.sectionId=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.sectionId=t.longs===String?"0":0;return null!=e.time&&e.hasOwnProperty("time")&&(n.time=t.json&&!isFinite(e.time)?String(e.time):e.time),null!=e.sectionId&&e.hasOwnProperty("sectionId")&&("number"===typeof e.sectionId?n.sectionId=t.longs===String?String(e.sectionId):e.sectionId:n.sectionId=t.longs===String?o.Long.prototype.toString.call(e.sectionId):t.longs===Number?new o.LongBits(e.sectionId.low>>>0,e.sectionId.high>>>0).toNumber():e.sectionId),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.Section=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}var t;return e.prototype.sectionId=o.Long?o.Long.fromBits(0,0,!1):0,e.prototype.sectionGroup=null,Object.defineProperty(e.prototype,"sectionType",{get:o.oneOfGetter(t=["sectionId","sectionGroup"]),set:o.oneOfSetter(t)}),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.sectionId&&e.hasOwnProperty("sectionId")&&t.uint32(8).int64(e.sectionId),null!=e.sectionGroup&&e.hasOwnProperty("sectionGroup")&&s.tensorflow.magenta.NoteSequence.SectionGroup.encode(e.sectionGroup,t.uint32(18).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new s.tensorflow.magenta.NoteSequence.Section;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sectionId=o.Long?e.int64().toNumber():e.int64();break;case 2:r.sectionGroup=s.tensorflow.magenta.NoteSequence.SectionGroup.decode(e,e.uint32());break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";var t={};if(null!=e.sectionId&&e.hasOwnProperty("sectionId")&&(t.sectionType=1,!o.isInteger(e.sectionId)&&!(e.sectionId&&o.isInteger(e.sectionId.low)&&o.isInteger(e.sectionId.high))))return"sectionId: integer|Long expected";if(null!=e.sectionGroup&&e.hasOwnProperty("sectionGroup")){if(1===t.sectionType)return"sectionType: multiple values";t.sectionType=1;var n=s.tensorflow.magenta.NoteSequence.SectionGroup.verify(e.sectionGroup);if(n)return"sectionGroup."+n}return null},e.fromObject=function(e){if(e instanceof s.tensorflow.magenta.NoteSequence.Section)return e;var t=new s.tensorflow.magenta.NoteSequence.Section;if(null!=e.sectionId&&(o.Long?(t.sectionId=o.Long.fromValue(e.sectionId)).unsigned=!1:"string"===typeof e.sectionId?t.sectionId=parseInt(e.sectionId,10):"number"===typeof e.sectionId?t.sectionId=e.sectionId:"object"===typeof e.sectionId&&(t.sectionId=new o.LongBits(e.sectionId.low>>>0,e.sectionId.high>>>0).toNumber())),null!=e.sectionGroup){if("object"!==typeof e.sectionGroup)throw TypeError(".tensorflow.magenta.NoteSequence.Section.sectionGroup: object expected");t.sectionGroup=s.tensorflow.magenta.NoteSequence.SectionGroup.fromObject(e.sectionGroup)}return t},e.toObject=function(e,t){t||(t={});var n={};return null!=e.sectionId&&e.hasOwnProperty("sectionId")&&("number"===typeof e.sectionId?n.sectionId=t.longs===String?String(e.sectionId):e.sectionId:n.sectionId=t.longs===String?o.Long.prototype.toString.call(e.sectionId):t.longs===Number?new o.LongBits(e.sectionId.low>>>0,e.sectionId.high>>>0).toNumber():e.sectionId,t.oneofs&&(n.sectionType="sectionId")),null!=e.sectionGroup&&e.hasOwnProperty("sectionGroup")&&(n.sectionGroup=s.tensorflow.magenta.NoteSequence.SectionGroup.toObject(e.sectionGroup,t),t.oneofs&&(n.sectionType="sectionGroup")),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.SectionGroup=function(){function e(e){if(this.sections=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sections=o.emptyArray,e.prototype.numTimes=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=i.create()),null!=e.sections&&e.sections.length)for(var n=0;n<e.sections.length;++n)s.tensorflow.magenta.NoteSequence.Section.encode(e.sections[n],t.uint32(10).fork()).ldelim();return null!=e.numTimes&&e.hasOwnProperty("numTimes")&&t.uint32(16).int32(e.numTimes),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new s.tensorflow.magenta.NoteSequence.SectionGroup;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sections&&r.sections.length||(r.sections=[]),r.sections.push(s.tensorflow.magenta.NoteSequence.Section.decode(e,e.uint32()));break;case 2:r.numTimes=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.sections&&e.hasOwnProperty("sections")){if(!Array.isArray(e.sections))return"sections: array expected";for(var t=0;t<e.sections.length;++t){var n=s.tensorflow.magenta.NoteSequence.Section.verify(e.sections[t]);if(n)return"sections."+n}}return null!=e.numTimes&&e.hasOwnProperty("numTimes")&&!o.isInteger(e.numTimes)?"numTimes: integer expected":null},e.fromObject=function(e){if(e instanceof s.tensorflow.magenta.NoteSequence.SectionGroup)return e;var t=new s.tensorflow.magenta.NoteSequence.SectionGroup;if(e.sections){if(!Array.isArray(e.sections))throw TypeError(".tensorflow.magenta.NoteSequence.SectionGroup.sections: array expected");t.sections=[];for(var n=0;n<e.sections.length;++n){if("object"!==typeof e.sections[n])throw TypeError(".tensorflow.magenta.NoteSequence.SectionGroup.sections: object expected");t.sections[n]=s.tensorflow.magenta.NoteSequence.Section.fromObject(e.sections[n])}}return null!=e.numTimes&&(t.numTimes=0|e.numTimes),t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.sections=[]),t.defaults&&(n.numTimes=0),e.sections&&e.sections.length){n.sections=[];for(var r=0;r<e.sections.length;++r)n.sections[r]=s.tensorflow.magenta.NoteSequence.Section.toObject(e.sections[r],t)}return null!=e.numTimes&&e.hasOwnProperty("numTimes")&&(n.numTimes=e.numTimes),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e}(),e.SequenceMetadata=function(){function e(e){if(this.genre=[],this.composers=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.title="",e.prototype.artist="",e.prototype.genre=o.emptyArray,e.prototype.composers=o.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=i.create()),null!=e.title&&e.hasOwnProperty("title")&&t.uint32(10).string(e.title),null!=e.artist&&e.hasOwnProperty("artist")&&t.uint32(18).string(e.artist),null!=e.genre&&e.genre.length)for(var n=0;n<e.genre.length;++n)t.uint32(26).string(e.genre[n]);if(null!=e.composers&&e.composers.length)for(n=0;n<e.composers.length;++n)t.uint32(34).string(e.composers[n]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new s.tensorflow.magenta.SequenceMetadata;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.title=e.string();break;case 2:r.artist=e.string();break;case 3:r.genre&&r.genre.length||(r.genre=[]),r.genre.push(e.string());break;case 4:r.composers&&r.composers.length||(r.composers=[]),r.composers.push(e.string());break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.title&&e.hasOwnProperty("title")&&!o.isString(e.title))return"title: string expected";if(null!=e.artist&&e.hasOwnProperty("artist")&&!o.isString(e.artist))return"artist: string expected";if(null!=e.genre&&e.hasOwnProperty("genre")){if(!Array.isArray(e.genre))return"genre: array expected";for(var t=0;t<e.genre.length;++t)if(!o.isString(e.genre[t]))return"genre: string[] expected"}if(null!=e.composers&&e.hasOwnProperty("composers")){if(!Array.isArray(e.composers))return"composers: array expected";for(t=0;t<e.composers.length;++t)if(!o.isString(e.composers[t]))return"composers: string[] expected"}return null},e.fromObject=function(e){if(e instanceof s.tensorflow.magenta.SequenceMetadata)return e;var t=new s.tensorflow.magenta.SequenceMetadata;if(null!=e.title&&(t.title=String(e.title)),null!=e.artist&&(t.artist=String(e.artist)),e.genre){if(!Array.isArray(e.genre))throw TypeError(".tensorflow.magenta.SequenceMetadata.genre: array expected");t.genre=[];for(var n=0;n<e.genre.length;++n)t.genre[n]=String(e.genre[n])}if(e.composers){if(!Array.isArray(e.composers))throw TypeError(".tensorflow.magenta.SequenceMetadata.composers: array expected");t.composers=[];for(n=0;n<e.composers.length;++n)t.composers[n]=String(e.composers[n])}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.genre=[],n.composers=[]),t.defaults&&(n.title="",n.artist=""),null!=e.title&&e.hasOwnProperty("title")&&(n.title=e.title),null!=e.artist&&e.hasOwnProperty("artist")&&(n.artist=e.artist),e.genre&&e.genre.length){n.genre=[];for(var r=0;r<e.genre.length;++r)n.genre[r]=e.genre[r]}if(e.composers&&e.composers.length){n.composers=[];for(r=0;r<e.composers.length;++r)n.composers[r]=e.composers[r]}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e.VelocityRange=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.min=0,e.prototype.max=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=i.create()),null!=e.min&&e.hasOwnProperty("min")&&t.uint32(8).int32(e.min),null!=e.max&&e.hasOwnProperty("max")&&t.uint32(16).int32(e.max),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new s.tensorflow.magenta.VelocityRange;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.min=e.int32();break;case 2:r.max=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.min&&e.hasOwnProperty("min")&&!o.isInteger(e.min)?"min: integer expected":null!=e.max&&e.hasOwnProperty("max")&&!o.isInteger(e.max)?"max: integer expected":null},e.fromObject=function(e){if(e instanceof s.tensorflow.magenta.VelocityRange)return e;var t=new s.tensorflow.magenta.VelocityRange;return null!=e.min&&(t.min=0|e.min),null!=e.max&&(t.max=0|e.max),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.min=0,n.max=0),null!=e.min&&e.hasOwnProperty("min")&&(n.min=e.min),null!=e.max&&e.hasOwnProperty("max")&&(n.max=e.max),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},e}(),e}(),e}(),e.exports=s},7206:function(e){"use strict";e.exports=function(e,t){var n=new Array(arguments.length-1),r=0,a=2,i=!0;for(;a<arguments.length;)n[r++]=arguments[a++];return new Promise((function(a,o){n[r]=function(e){if(i)if(i=!1,e)o(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];a.apply(null,t)}};try{e.apply(t||null,n)}catch(s){i&&(i=!1,o(s))}}))}},1:function(e,t){"use strict";var n=t;n.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var r=new Array(64),a=new Array(123),i=0;i<64;)a[r[i]=i<26?i+65:i<52?i+71:i<62?i-4:i-59|43]=i++;n.encode=function(e,t,n){for(var a,i=null,o=[],s=0,u=0;t<n;){var c=e[t++];switch(u){case 0:o[s++]=r[c>>2],a=(3&c)<<4,u=1;break;case 1:o[s++]=r[a|c>>4],a=(15&c)<<2,u=2;break;case 2:o[s++]=r[a|c>>6],o[s++]=r[63&c],u=0}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0)}return u&&(o[s++]=r[a],o[s++]=61,1===u&&(o[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))};var o="invalid encoding";n.decode=function(e,t,n){for(var r,i=n,s=0,u=0;u<e.length;){var c=e.charCodeAt(u++);if(61===c&&s>1)break;if(void 0===(c=a[c]))throw Error(o);switch(s){case 0:r=c,s=1;break;case 1:t[n++]=r<<2|(48&c)>>4,r=c,s=2;break;case 2:t[n++]=(15&r)<<4|(60&c)>>2,r=c,s=3;break;case 3:t[n++]=(3&r)<<6|c,s=0}}if(1===s)throw Error(o);return n-i},n.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},7111:function(e){"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],r=0;r<n.length;)n[r].fn===t?n.splice(r,1):++r;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this}},802:function(e){"use strict";function t(e){return"undefined"!==typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),r=128===n[3];function a(e,r,a){t[0]=e,r[a]=n[0],r[a+1]=n[1],r[a+2]=n[2],r[a+3]=n[3]}function i(e,r,a){t[0]=e,r[a]=n[3],r[a+1]=n[2],r[a+2]=n[1],r[a+3]=n[0]}function o(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],t[0]}function s(e,r){return n[3]=e[r],n[2]=e[r+1],n[1]=e[r+2],n[0]=e[r+3],t[0]}e.writeFloatLE=r?a:i,e.writeFloatBE=r?i:a,e.readFloatLE=r?o:s,e.readFloatBE=r?s:o}():function(){function t(e,t,n,r){var a=t<0?1:0;if(a&&(t=-t),0===t)e(1/t>0?0:2147483648,n,r);else if(isNaN(t))e(2143289344,n,r);else if(t>34028234663852886e22)e((a<<31|2139095040)>>>0,n,r);else if(t<11754943508222875e-54)e((a<<31|Math.round(t/1401298464324817e-60))>>>0,n,r);else{var i=Math.floor(Math.log(t)/Math.LN2);e((a<<31|i+127<<23|8388607&Math.round(t*Math.pow(2,-i)*8388608))>>>0,n,r)}}function o(e,t,n){var r=e(t,n),a=2*(r>>31)+1,i=r>>>23&255,o=8388607&r;return 255===i?o?NaN:a*(1/0):0===i?1401298464324817e-60*a*o:a*Math.pow(2,i-150)*(o+8388608)}e.writeFloatLE=t.bind(null,n),e.writeFloatBE=t.bind(null,r),e.readFloatLE=o.bind(null,a),e.readFloatBE=o.bind(null,i)}(),"undefined"!==typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),r=128===n[7];function a(e,r,a){t[0]=e,r[a]=n[0],r[a+1]=n[1],r[a+2]=n[2],r[a+3]=n[3],r[a+4]=n[4],r[a+5]=n[5],r[a+6]=n[6],r[a+7]=n[7]}function i(e,r,a){t[0]=e,r[a]=n[7],r[a+1]=n[6],r[a+2]=n[5],r[a+3]=n[4],r[a+4]=n[3],r[a+5]=n[2],r[a+6]=n[1],r[a+7]=n[0]}function o(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],n[4]=e[r+4],n[5]=e[r+5],n[6]=e[r+6],n[7]=e[r+7],t[0]}function s(e,r){return n[7]=e[r],n[6]=e[r+1],n[5]=e[r+2],n[4]=e[r+3],n[3]=e[r+4],n[2]=e[r+5],n[1]=e[r+6],n[0]=e[r+7],t[0]}e.writeDoubleLE=r?a:i,e.writeDoubleBE=r?i:a,e.readDoubleLE=r?o:s,e.readDoubleBE=r?s:o}():function(){function t(e,t,n,r,a,i){var o=r<0?1:0;if(o&&(r=-r),0===r)e(0,a,i+t),e(1/r>0?0:2147483648,a,i+n);else if(isNaN(r))e(0,a,i+t),e(2146959360,a,i+n);else if(r>17976931348623157e292)e(0,a,i+t),e((o<<31|2146435072)>>>0,a,i+n);else{var s;if(r<22250738585072014e-324)e((s=r/5e-324)>>>0,a,i+t),e((o<<31|s/4294967296)>>>0,a,i+n);else{var u=Math.floor(Math.log(r)/Math.LN2);1024===u&&(u=1023),e(4503599627370496*(s=r*Math.pow(2,-u))>>>0,a,i+t),e((o<<31|u+1023<<20|1048576*s&1048575)>>>0,a,i+n)}}}function o(e,t,n,r,a){var i=e(r,a+t),o=e(r,a+n),s=2*(o>>31)+1,u=o>>>20&2047,c=4294967296*(1048575&o)+i;return 2047===u?c?NaN:s*(1/0):0===u?5e-324*s*c:s*Math.pow(2,u-1075)*(c+4503599627370496)}e.writeDoubleLE=t.bind(null,n,0,4),e.writeDoubleBE=t.bind(null,r,4,0),e.readDoubleLE=o.bind(null,a,0,4),e.readDoubleBE=o.bind(null,i,4,0)}(),e}function n(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function r(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function a(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function i(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},7172:function(module){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},8236:function(e){"use strict";e.exports=function(e,t,n){var r=n||8192,a=r>>>1,i=null,o=r;return function(n){if(n<1||n>a)return e(n);o+n>r&&(i=e(r),o=0);var s=t.call(i,o,o+=n);return 7&o&&(o=1+(7|o)),s}}},3861:function(e,t){"use strict";var n=t;n.length=function(e){for(var t=0,n=0,r=0;r<e.length;++r)(n=e.charCodeAt(r))<128?t+=1:n<2048?t+=2:55296===(64512&n)&&56320===(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t},n.read=function(e,t,n){if(n-t<1)return"";for(var r,a=null,i=[],o=0;t<n;)(r=e[t++])<128?i[o++]=r:r>191&&r<224?i[o++]=(31&r)<<6|63&e[t++]:r>239&&r<365?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,i[o++]=55296+(r>>10),i[o++]=56320+(1023&r)):i[o++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],o>8191&&((a||(a=[])).push(String.fromCharCode.apply(String,i)),o=0);return a?(o&&a.push(String.fromCharCode.apply(String,i.slice(0,o))),a.join("")):String.fromCharCode.apply(String,i.slice(0,o))},n.write=function(e,t,n){for(var r,a,i=n,o=0;o<e.length;++o)(r=e.charCodeAt(o))<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296===(64512&r)&&56320===(64512&(a=e.charCodeAt(o+1)))?(r=65536+((1023&r)<<10)+(1023&a),++o,t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128);return n-i}},8598:function(e,t,n){var r=n(7401),a=n(3627),i=n(7320),o=n(7220),s=n(4972),u=n(2584),c=n(9638);c.alea=r,c.xor128=a,c.xorwow=i,c.xorshift7=o,c.xor4096=s,c.tychei=u,e.exports=c},7401:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n=function(){var e=4022871197;return function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)}}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function s(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function u(e,t){var n=new o(e),r=t&&t.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.alea=u}(0,e=n.nmd(e),n.amdD)},2584:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.tychei=u}(0,e=n.nmd(e),n.amdD)},3627:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xor128=u}(0,e=n.nmd(e),n.amdD)},4972:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,i=t.i;return t.w=r=r+1640531527|0,n=a[i+34&127],e=a[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=a[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,a,i,o,s=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),a=0,i=-32;i<u;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,a=0==(n=s[127&i]^=r+o)?a+1:0);for(a>=128&&(s[127&(t&&t.length||0)]=-1),a=127,i=512;i>0;--i)r=s[a+34&127],n=s[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[a]=r^n;e.w=o,e.X=s,e.i=a}(t,e)}function s(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.X&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xor4096=u}(0,e=n.nmd(e),n.amdD)},7220:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],n=(e^=e>>>7)^e<<24,n^=(e=r[a+1&7])^e>>>10,n^=(e=r[a+3&7])^e>>>3,n^=(e=r[a+4&7])^e<<7,e=r[a+7&7],n^=(e^=e<<13)^e<<9,r[a]=n,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function s(e,t){return t.x=e.x.slice(),t.i=e.i,t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.x&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xorshift7=u}(0,e=n.nmd(e),n.amdD)},7320:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xorwow=u}(0,e=n.nmd(e),n.amdD)},9638:function(e,t,n){var r;!function(a,i){var o,s=this,u=256,c=i.pow(u,6),l=i.pow(2,52),h=2*l,f=255;function p(e,t,n){var r=[],f=g(v((t=1==t?{entropy:!0}:t||{}).entropy?[e,y(a)]:null==e?function(){try{var e;return o&&(e=o.randomBytes)?e=e(u):(e=new Uint8Array(u),(s.crypto||s.msCrypto).getRandomValues(e)),y(e)}catch(r){var t=s.navigator,n=t&&t.plugins;return[+new Date,s,n,s.screen,y(a)]}}():e,3),r),p=new d(r),b=function(){for(var e=p.g(6),t=c,n=0;e<l;)e=(e+n)*u,t*=u,n=p.g(1);for(;e>=h;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return 0|p.g(4)},b.quick=function(){return p.g(4)/4294967296},b.double=b,g(y(p.S),a),(t.pass||n||function(e,t,n,r){return r&&(r.S&&m(r,p),e.state=function(){return m(p,{})}),n?(i.random=e,t):e})(b,f,"global"in t?t.global:this==i,t.state)}function d(e){var t,n=e.length,r=this,a=0,i=r.i=r.j=0,o=r.S=[];for(n||(e=[n++]);a<u;)o[a]=a++;for(a=0;a<u;a++)o[a]=o[i=f&i+e[a%n]+(t=o[a])],o[i]=t;(r.g=function(e){for(var t,n=0,a=r.i,i=r.j,o=r.S;e--;)t=o[a=f&a+1],n=n*u+o[f&(o[a]=o[i=f&i+t])+(o[i]=t)];return r.i=a,r.j=i,n})(u)}function m(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function v(e,t){var n,r=[],a=typeof e;if(t&&"object"==a)for(n in e)try{r.push(v(e[n],t-1))}catch(i){}return r.length?r:"string"==a?e:e+"\0"}function g(e,t){for(var n,r=e+"",a=0;a<r.length;)t[f&a]=f&(n^=19*t[f&a])+r.charCodeAt(a++);return y(t)}function y(e){return String.fromCharCode.apply(0,e)}if(i.seedrandom=p,g(i.random(),a),e.exports){e.exports=p;try{o=n(914)}catch(b){}}else void 0===(r=function(){return p}.call(t,n,t,e))||(e.exports=r)}([],Math)},282:function(e,t,n){var r=n(5141),a=n(9619),i=n(6422),o=n(6304),s=n(3410),u=n(5463),c=n(5274);c.alea=r,c.xor128=a,c.xorwow=i,c.xorshift7=o,c.xor4096=s,c.tychei=u,e.exports=c},5141:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n=function(){var e=4022871197;return function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)}}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function s(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function u(e,t){var n=new o(e),r=t&&t.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.alea=u}(0,e=n.nmd(e),n.amdD)},5463:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.tychei=u}(0,e=n.nmd(e),n.amdD)},9619:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xor128=u}(0,e=n.nmd(e),n.amdD)},3410:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,i=t.i;return t.w=r=r+1640531527|0,n=a[i+34&127],e=a[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=a[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,a,i,o,s=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),a=0,i=-32;i<u;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,a=0==(n=s[127&i]^=r+o)?a+1:0);for(a>=128&&(s[127&(t&&t.length||0)]=-1),a=127,i=512;i>0;--i)r=s[a+34&127],n=s[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[a]=r^n;e.w=o,e.X=s,e.i=a}(t,e)}function s(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.X&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xor4096=u}(0,e=n.nmd(e),n.amdD)},6304:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],n=(e^=e>>>7)^e<<24,n^=(e=r[a+1&7])^e>>>10,n^=(e=r[a+3&7])^e>>>3,n^=(e=r[a+4&7])^e<<7,e=r[a+7&7],n^=(e^=e<<13)^e<<9,r[a]=n,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function s(e,t){return t.x=e.x.slice(),t.i=e.i,t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.x&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xorshift7=u}(0,e=n.nmd(e),n.amdD)},6422:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xorwow=u}(0,e=n.nmd(e),n.amdD)},5274:function(e,t,n){var r;!function(a,i){var o,s=this,u=256,c=i.pow(u,6),l=i.pow(2,52),h=2*l,f=255;function p(e,t,n){var r=[],f=g(v((t=1==t?{entropy:!0}:t||{}).entropy?[e,y(a)]:null==e?function(){try{var e;return o&&(e=o.randomBytes)?e=e(u):(e=new Uint8Array(u),(s.crypto||s.msCrypto).getRandomValues(e)),y(e)}catch(r){var t=s.navigator,n=t&&t.plugins;return[+new Date,s,n,s.screen,y(a)]}}():e,3),r),p=new d(r),b=function(){for(var e=p.g(6),t=c,n=0;e<l;)e=(e+n)*u,t*=u,n=p.g(1);for(;e>=h;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return 0|p.g(4)},b.quick=function(){return p.g(4)/4294967296},b.double=b,g(y(p.S),a),(t.pass||n||function(e,t,n,r){return r&&(r.S&&m(r,p),e.state=function(){return m(p,{})}),n?(i.random=e,t):e})(b,f,"global"in t?t.global:this==i,t.state)}function d(e){var t,n=e.length,r=this,a=0,i=r.i=r.j=0,o=r.S=[];for(n||(e=[n++]);a<u;)o[a]=a++;for(a=0;a<u;a++)o[a]=o[i=f&i+e[a%n]+(t=o[a])],o[i]=t;(r.g=function(e){for(var t,n=0,a=r.i,i=r.j,o=r.S;e--;)t=o[a=f&a+1],n=n*u+o[f&(o[a]=o[i=f&i+t])+(o[i]=t)];return r.i=a,r.j=i,n})(u)}function m(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function v(e,t){var n,r=[],a=typeof e;if(t&&"object"==a)for(n in e)try{r.push(v(e[n],t-1))}catch(i){}return r.length?r:"string"==a?e:e+"\0"}function g(e,t){for(var n,r=e+"",a=0;a<r.length;)t[f&a]=f&(n^=19*t[f&a])+r.charCodeAt(a++);return y(t)}function y(e){return String.fromCharCode.apply(0,e)}if(i.seedrandom=p,g(i.random(),a),e.exports){e.exports=p;try{o=n(5778)}catch(b){}}else void 0===(r=function(){return p}.call(t,n,t,e))||(e.exports=r)}([],Math)},1146:function(e,t){"use strict";function n(e,t,n){void 0===n&&(n="ticks");var r=0,a=e.length,i=a;if(a>0&&e[a-1][n]<=t)return a-1;for(;r<i;){var o=Math.floor(r+(i-r)/2),s=e[o],u=e[o+1];if(s[n]===t){for(var c=o;c<e.length;c++){e[c][n]===t&&(o=c)}return o}if(s[n]<t&&u[n]>t)return o;s[n]>t?i=o:s[n]<t&&(r=o+1)}return-1}Object.defineProperty(t,"__esModule",{value:!0}),t.insert=t.search=void 0,t.search=n,t.insert=function(e,t,r){if(void 0===r&&(r="ticks"),e.length){var a=n(e,t[r],r);e.splice(a+1,0,t)}else e.push(t)}},7182:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ControlChange=t.controlChangeIds=t.controlChangeNames=void 0,t.controlChangeNames={1:"modulationWheel",2:"breath",4:"footController",5:"portamentoTime",7:"volume",8:"balance",10:"pan",64:"sustain",65:"portamentoTime",66:"sostenuto",67:"softPedal",68:"legatoFootswitch",84:"portamentoControl"},t.controlChangeIds=Object.keys(t.controlChangeNames).reduce((function(e,n){return e[t.controlChangeNames[n]]=n,e}),{});var n=new WeakMap,r=new WeakMap,a=function(){function e(e,t){n.set(this,t),r.set(this,e.controllerType),this.ticks=e.absoluteTime,this.value=e.value}return Object.defineProperty(e.prototype,"number",{get:function(){return r.get(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return t.controlChangeNames[this.number]?t.controlChangeNames[this.number]:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"time",{get:function(){return n.get(this).ticksToSeconds(this.ticks)},set:function(e){var t=n.get(this);this.ticks=t.secondsToTicks(e)},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){return{number:this.number,ticks:this.ticks,time:this.time,value:this.value}},e}();t.ControlChange=a},6966:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createControlChanges=void 0;var r=n(7182);t.createControlChanges=function(){return new Proxy({},{get:function(e,t){return e[t]?e[t]:r.controlChangeIds.hasOwnProperty(t)?e[r.controlChangeIds[t]]:void 0},set:function(e,t,n){return r.controlChangeIds.hasOwnProperty(t)?e[r.controlChangeIds[t]]=n:e[t]=n,!0}})}},8573:function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.encode=void 0;var a=n(8191),i=n(4809),o=n(8346);function s(e){return(0,o.flatten)(e.notes.map((function(t){return function(e,t){return[{absoluteTime:e.ticks,channel:t,deltaTime:0,noteNumber:e.midi,type:"noteOn",velocity:Math.floor(127*e.velocity)},{absoluteTime:e.ticks+e.durationTicks,channel:t,deltaTime:0,noteNumber:e.midi,type:"noteOff",velocity:Math.floor(127*e.noteOffVelocity)}]}(t,e.channel)})))}function u(e,t){return{absoluteTime:e.ticks,channel:t,controllerType:e.number,deltaTime:0,type:"controller",value:Math.floor(127*e.value)}}function c(e){return{absoluteTime:0,channel:e.channel,deltaTime:0,programNumber:e.instrument.number,type:"programChange"}}function l(e){return{absoluteTime:0,deltaTime:0,meta:!0,text:e,type:"trackName"}}t.encode=function(e){var t={header:{format:1,numTracks:e.tracks.length+1,ticksPerBeat:e.header.ppq},tracks:r([r(r(r(r([{absoluteTime:0,deltaTime:0,meta:!0,text:e.header.name,type:"trackName"}],e.header.keySignatures.map((function(e){return function(e){var t=i.keySignatureKeys.indexOf(e.key);return{absoluteTime:e.ticks,deltaTime:0,key:t+7,meta:!0,scale:"major"===e.scale?0:1,type:"keySignature"}}(e)})),!0),e.header.meta.map((function(e){return{absoluteTime:(t=e).ticks,deltaTime:0,meta:!0,text:t.text,type:t.type};var t})),!0),e.header.tempos.map((function(e){return function(e){return{absoluteTime:e.ticks,deltaTime:0,meta:!0,microsecondsPerBeat:Math.floor(6e7/e.bpm),type:"setTempo"}}(e)})),!0),e.header.timeSignatures.map((function(e){return function(e){return{absoluteTime:e.ticks,deltaTime:0,denominator:e.timeSignature[1],meta:!0,metronome:24,numerator:e.timeSignature[0],thirtyseconds:8,type:"timeSignature"}}(e)})),!0)],e.tracks.map((function(e){return r(r(r([l(e.name),c(e)],s(e),!0),function(e){for(var t=[],n=0;n<127;n++)e.controlChanges.hasOwnProperty(n)&&e.controlChanges[n].forEach((function(n){t.push(u(n,e.channel))}));return t}(e),!0),function(e){var t=[];return e.pitchBends.forEach((function(n){t.push(function(e,t){return{absoluteTime:e.ticks,channel:t,deltaTime:0,type:"pitchBend",value:e.value}}(n,e.channel))})),t}(e),!0)})),!0)};return t.tracks=t.tracks.map((function(e){e=e.sort((function(e,t){return e.absoluteTime-t.absoluteTime}));var t=0;return e.forEach((function(e){e.deltaTime=e.absoluteTime-t,t=e.absoluteTime,delete e.absoluteTime})),e.push({deltaTime:0,meta:!0,type:"endOfTrack"}),e})),new Uint8Array((0,a.writeMidi)(t))}},4809:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Header=t.keySignatureKeys=void 0;var r=n(1146),a=new WeakMap;t.keySignatureKeys=["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#"];var i=function(){function e(e){var n=this;if(this.tempos=[],this.timeSignatures=[],this.keySignatures=[],this.meta=[],this.name="",a.set(this,480),e){a.set(this,e.header.ticksPerBeat),e.tracks.forEach((function(e){e.forEach((function(e){e.meta&&("timeSignature"===e.type?n.timeSignatures.push({ticks:e.absoluteTime,timeSignature:[e.numerator,e.denominator]}):"setTempo"===e.type?n.tempos.push({bpm:6e7/e.microsecondsPerBeat,ticks:e.absoluteTime}):"keySignature"===e.type&&n.keySignatures.push({key:t.keySignatureKeys[e.key+7],scale:0===e.scale?"major":"minor",ticks:e.absoluteTime}))}))}));var r=0;e.tracks[0].forEach((function(e){r+=e.deltaTime,e.meta&&("trackName"===e.type?n.name=e.text:"text"!==e.type&&"cuePoint"!==e.type&&"marker"!==e.type&&"lyrics"!==e.type||n.meta.push({text:e.text,ticks:r,type:e.type}))})),this.update()}}return e.prototype.update=function(){var e=this,t=0,n=0;this.tempos.sort((function(e,t){return e.ticks-t.ticks})),this.tempos.forEach((function(r,a){var i=a>0?e.tempos[a-1].bpm:e.tempos[0].bpm,o=r.ticks/e.ppq-n,s=60/i*o;r.time=s+t,t=r.time,n+=o})),this.timeSignatures.sort((function(e,t){return e.ticks-t.ticks})),this.timeSignatures.forEach((function(t,n){var r=n>0?e.timeSignatures[n-1]:e.timeSignatures[0],a=(t.ticks-r.ticks)/e.ppq/r.timeSignature[0]/(r.timeSignature[1]/4);r.measures=r.measures||0,t.measures=a+r.measures}))},e.prototype.ticksToSeconds=function(e){var t=(0,r.search)(this.tempos,e);if(-1!==t){var n=this.tempos[t],a=n.time,i=(e-n.ticks)/this.ppq;return a+60/n.bpm*i}return.5*(e/this.ppq)},e.prototype.ticksToMeasures=function(e){var t=(0,r.search)(this.timeSignatures,e);if(-1!==t){var n=this.timeSignatures[t],a=(e-n.ticks)/this.ppq;return n.measures+a/(n.timeSignature[0]/n.timeSignature[1])/4}return e/this.ppq/4},Object.defineProperty(e.prototype,"ppq",{get:function(){return a.get(this)},enumerable:!1,configurable:!0}),e.prototype.secondsToTicks=function(e){var t=(0,r.search)(this.tempos,e,"time");if(-1!==t){var n=this.tempos[t],a=(e-n.time)/(60/n.bpm);return Math.round(n.ticks+a*this.ppq)}var i=e/.5;return Math.round(i*this.ppq)},e.prototype.toJSON=function(){return{keySignatures:this.keySignatures,meta:this.meta,name:this.name,ppq:this.ppq,tempos:this.tempos.map((function(e){return{bpm:e.bpm,ticks:e.ticks}})),timeSignatures:this.timeSignatures}},e.prototype.fromJSON=function(e){this.name=e.name,this.tempos=e.tempos.map((function(e){return Object.assign({},e)})),this.timeSignatures=e.timeSignatures.map((function(e){return Object.assign({},e)})),this.keySignatures=e.keySignatures.map((function(e){return Object.assign({},e)})),this.meta=e.meta.map((function(e){return Object.assign({},e)})),a.set(this,e.ppq),this.update()},e.prototype.setTempo=function(e){this.tempos=[{bpm:e,ticks:0}],this.update()},e}();t.Header=i},9950:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Instrument=void 0;var r=n(5910),a=new WeakMap,i=function(){function e(e,t){if(this.number=0,a.set(this,t),this.number=0,e){var n=e.find((function(e){return"programChange"===e.type}));n&&(this.number=n.programNumber)}}return Object.defineProperty(e.prototype,"name",{get:function(){return this.percussion?r.DrumKitByPatchID[this.number]:r.instrumentByPatchID[this.number]},set:function(e){var t=r.instrumentByPatchID.indexOf(e);-1!==t&&(this.number=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"family",{get:function(){return this.percussion?"drums":r.InstrumentFamilyByID[Math.floor(this.number/8)]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"percussion",{get:function(){return 9===a.get(this).channel},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){return{family:this.family,number:this.number,name:this.name}},e.prototype.fromJSON=function(e){this.number=e.number},e}();t.Instrument=i},5910:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DrumKitByPatchID=t.InstrumentFamilyByID=t.instrumentByPatchID=void 0,t.instrumentByPatchID=["acoustic grand piano","bright acoustic piano","electric grand piano","honky-tonk piano","electric piano 1","electric piano 2","harpsichord","clavi","celesta","glockenspiel","music box","vibraphone","marimba","xylophone","tubular bells","dulcimer","drawbar organ","percussive organ","rock organ","church organ","reed organ","accordion","harmonica","tango accordion","acoustic guitar (nylon)","acoustic guitar (steel)","electric guitar (jazz)","electric guitar (clean)","electric guitar (muted)","overdriven guitar","distortion guitar","guitar harmonics","acoustic bass","electric bass (finger)","electric bass (pick)","fretless bass","slap bass 1","slap bass 2","synth bass 1","synth bass 2","violin","viola","cello","contrabass","tremolo strings","pizzicato strings","orchestral harp","timpani","string ensemble 1","string ensemble 2","synthstrings 1","synthstrings 2","choir aahs","voice oohs","synth voice","orchestra hit","trumpet","trombone","tuba","muted trumpet","french horn","brass section","synthbrass 1","synthbrass 2","soprano sax","alto sax","tenor sax","baritone sax","oboe","english horn","bassoon","clarinet","piccolo","flute","recorder","pan flute","blown bottle","shakuhachi","whistle","ocarina","lead 1 (square)","lead 2 (sawtooth)","lead 3 (calliope)","lead 4 (chiff)","lead 5 (charang)","lead 6 (voice)","lead 7 (fifths)","lead 8 (bass + lead)","pad 1 (new age)","pad 2 (warm)","pad 3 (polysynth)","pad 4 (choir)","pad 5 (bowed)","pad 6 (metallic)","pad 7 (halo)","pad 8 (sweep)","fx 1 (rain)","fx 2 (soundtrack)","fx 3 (crystal)","fx 4 (atmosphere)","fx 5 (brightness)","fx 6 (goblins)","fx 7 (echoes)","fx 8 (sci-fi)","sitar","banjo","shamisen","koto","kalimba","bag pipe","fiddle","shanai","tinkle bell","agogo","steel drums","woodblock","taiko drum","melodic tom","synth drum","reverse cymbal","guitar fret noise","breath noise","seashore","bird tweet","telephone ring","helicopter","applause","gunshot"],t.InstrumentFamilyByID=["piano","chromatic percussion","organ","guitar","bass","strings","ensemble","brass","reed","pipe","synth lead","synth pad","synth effects","world","percussive","sound effects"],t.DrumKitByPatchID={0:"standard kit",8:"room kit",16:"power kit",24:"electronic kit",25:"tr-808 kit",32:"jazz kit",40:"brush kit",48:"orchestra kit",56:"sound fx kit"}},1493:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(t){i(t)}}function s(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(s){i=[6,s],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Header=t.Track=t.Midi=void 0;var i=n(8191),o=n(4809),s=n(3868),u=n(8573),c=function(){function e(e){var t=this,n=null;if(e){var r=e instanceof ArrayBuffer?new Uint8Array(e):e;(n=(0,i.parseMidi)(r)).tracks.forEach((function(e){var t=0;e.forEach((function(e){t+=e.deltaTime,e.absoluteTime=t}))})),n.tracks=function(e){for(var t=[],n=0;n<e.length;n++)for(var r=t.length,a=new Map,i=Array(16).fill(0),o=0,s=e[n];o<s.length;o++){var u=s[o],c=r,l=u.channel;if(void 0!==l){"programChange"===u.type&&(i[l]=u.programNumber);var h=i[l],f="".concat(h," ").concat(l);a.has(f)?c=a.get(f):(c=r+a.size,a.set(f,c))}t[c]||t.push([]),t[c].push(u)}return t}(n.tracks)}this.header=new o.Header(n),this.tracks=[],e&&(this.tracks=n.tracks.map((function(e){return new s.Track(e,t.header)})),1===n.header.format&&0===this.tracks[0].duration&&this.tracks.shift())}return e.fromUrl=function(t){return r(this,void 0,void 0,(function(){var n;return a(this,(function(r){switch(r.label){case 0:return[4,fetch(t)];case 1:return(n=r.sent()).ok?[4,n.arrayBuffer()]:[3,3];case 2:return[2,new e(r.sent())];case 3:throw new Error("Could not load '".concat(t,"'"))}}))}))},Object.defineProperty(e.prototype,"name",{get:function(){return this.header.name},set:function(e){this.header.name=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){var e=this.tracks.map((function(e){return e.duration}));return Math.max.apply(Math,e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"durationTicks",{get:function(){var e=this.tracks.map((function(e){return e.durationTicks}));return Math.max.apply(Math,e)},enumerable:!1,configurable:!0}),e.prototype.addTrack=function(){var e=new s.Track(void 0,this.header);return this.tracks.push(e),e},e.prototype.toArray=function(){return(0,u.encode)(this)},e.prototype.toJSON=function(){return{header:this.header.toJSON(),tracks:this.tracks.map((function(e){return e.toJSON()}))}},e.prototype.fromJSON=function(e){var t=this;this.header=new o.Header,this.header.fromJSON(e.header),this.tracks=e.tracks.map((function(e){var n=new s.Track(void 0,t.header);return n.fromJSON(e),n}))},e.prototype.clone=function(){var t=new e;return t.fromJSON(this.toJSON()),t},e}();t.Midi=c;var l=n(3868);Object.defineProperty(t,"Track",{enumerable:!0,get:function(){return l.Track}});var h=n(4809);Object.defineProperty(t,"Header",{enumerable:!0,get:function(){return h.Header}})},4477:function(e,t){"use strict";function n(e){return["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"][e%12]}Object.defineProperty(t,"__esModule",{value:!0}),t.Note=void 0;var r=function(){var e=/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,t={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13};return function(n){var r=e.exec(n),a=r[1],i=r[2];return t[a.toLowerCase()]+12*(parseInt(i,10)+1)}}(),a=new WeakMap,i=function(){function e(e,t,n){a.set(this,n),this.midi=e.midi,this.velocity=e.velocity,this.noteOffVelocity=t.velocity,this.ticks=e.ticks,this.durationTicks=t.ticks-e.ticks}return Object.defineProperty(e.prototype,"name",{get:function(){return function(e){var t=Math.floor(e/12)-1;return n(e)+t.toString()}(this.midi)},set:function(e){this.midi=r(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"octave",{get:function(){return Math.floor(this.midi/12)-1},set:function(e){var t=e-this.octave;this.midi+=12*t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pitch",{get:function(){return n(this.midi)},set:function(e){this.midi=12*(this.octave+1)+["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"].indexOf(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){var e=a.get(this);return e.ticksToSeconds(this.ticks+this.durationTicks)-e.ticksToSeconds(this.ticks)},set:function(e){var t=a.get(this).secondsToTicks(this.time+e);this.durationTicks=t-this.ticks},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"time",{get:function(){return a.get(this).ticksToSeconds(this.ticks)},set:function(e){var t=a.get(this);this.ticks=t.secondsToTicks(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bars",{get:function(){return a.get(this).ticksToMeasures(this.ticks)},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){return{duration:this.duration,durationTicks:this.durationTicks,midi:this.midi,name:this.name,ticks:this.ticks,time:this.time,velocity:this.velocity}},e}();t.Note=i},3106:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PitchBend=void 0;var n=new WeakMap,r=function(){function e(e,t){n.set(this,t),this.ticks=e.absoluteTime,this.value=e.value}return Object.defineProperty(e.prototype,"time",{get:function(){return n.get(this).ticksToSeconds(this.ticks)},set:function(e){var t=n.get(this);this.ticks=t.secondsToTicks(e)},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){return{ticks:this.ticks,time:this.time,value:this.value}},e}();t.PitchBend=r},3868:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Track=void 0;var r=n(1146),a=n(7182),i=n(6966),o=n(3106),s=n(9950),u=n(4477),c=new WeakMap,l=function(){function e(e,t){var n=this;if(this.name="",this.notes=[],this.controlChanges=(0,i.createControlChanges)(),this.pitchBends=[],c.set(this,t),e){var r=e.find((function(e){return"trackName"===e.type}));this.name=r?r.text:""}if(this.instrument=new s.Instrument(e,this),this.channel=0,e){for(var a=e.filter((function(e){return"noteOn"===e.type})),o=e.filter((function(e){return"noteOff"===e.type})),u=function(){var e=a.shift();l.channel=e.channel;var t=o.findIndex((function(t){return t.noteNumber===e.noteNumber&&t.absoluteTime>=e.absoluteTime}));if(-1!==t){var n=o.splice(t,1)[0];l.addNote({durationTicks:n.absoluteTime-e.absoluteTime,midi:e.noteNumber,noteOffVelocity:n.velocity/127,ticks:e.absoluteTime,velocity:e.velocity/127})}},l=this;a.length;)u();e.filter((function(e){return"controller"===e.type})).forEach((function(e){n.addCC({number:e.controllerType,ticks:e.absoluteTime,value:e.value/127})})),e.filter((function(e){return"pitchBend"===e.type})).forEach((function(e){n.addPitchBend({ticks:e.absoluteTime,value:e.value/Math.pow(2,13)})}));var h=e.find((function(e){return"endOfTrack"===e.type}));this.endOfTrackTicks=void 0!==h?h.absoluteTime:void 0}}return e.prototype.addNote=function(e){var t=c.get(this),n=new u.Note({midi:0,ticks:0,velocity:1},{ticks:0,velocity:0},t);return Object.assign(n,e),(0,r.insert)(this.notes,n,"ticks"),this},e.prototype.addCC=function(e){var t=c.get(this),n=new a.ControlChange({controllerType:e.number},t);return delete e.number,Object.assign(n,e),Array.isArray(this.controlChanges[n.number])||(this.controlChanges[n.number]=[]),(0,r.insert)(this.controlChanges[n.number],n,"ticks"),this},e.prototype.addPitchBend=function(e){var t=c.get(this),n=new o.PitchBend({},t);return Object.assign(n,e),(0,r.insert)(this.pitchBends,n,"ticks"),this},Object.defineProperty(e.prototype,"duration",{get:function(){if(!this.notes.length)return 0;for(var e=this.notes[this.notes.length-1].time+this.notes[this.notes.length-1].duration,t=0;t<this.notes.length-1;t++){var n=this.notes[t].time+this.notes[t].duration;e<n&&(e=n)}return e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"durationTicks",{get:function(){if(!this.notes.length)return 0;for(var e=this.notes[this.notes.length-1].ticks+this.notes[this.notes.length-1].durationTicks,t=0;t<this.notes.length-1;t++){var n=this.notes[t].ticks+this.notes[t].durationTicks;e<n&&(e=n)}return e},enumerable:!1,configurable:!0}),e.prototype.fromJSON=function(e){var t=this;for(var n in this.name=e.name,this.channel=e.channel,this.instrument=new s.Instrument(void 0,this),this.instrument.fromJSON(e.instrument),void 0!==e.endOfTrackTicks&&(this.endOfTrackTicks=e.endOfTrackTicks),e.controlChanges)e.controlChanges[n]&&e.controlChanges[n].forEach((function(e){t.addCC({number:e.number,ticks:e.ticks,value:e.value})}));e.notes.forEach((function(e){t.addNote({durationTicks:e.durationTicks,midi:e.midi,ticks:e.ticks,velocity:e.velocity})}))},e.prototype.toJSON=function(){for(var e={},t=0;t<127;t++)this.controlChanges.hasOwnProperty(t)&&(e[t]=this.controlChanges[t].map((function(e){return e.toJSON()})));var n={channel:this.channel,controlChanges:e,pitchBends:this.pitchBends.map((function(e){return e.toJSON()})),instrument:this.instrument.toJSON(),name:this.name,notes:this.notes.map((function(e){return e.toJSON()}))};return void 0!==this.endOfTrackTicks&&(n.endOfTrackTicks=this.endOfTrackTicks),n},e}();t.Track=l},8346:function(e,t,n){"use strict";function r(e){var t=[];return a(e,t),t}function a(e,t){for(var n=0;n<e.length;n++){var r=e[n];Array.isArray(r)?a(r,t):t.push(r)}}n.r(t),n.d(t,{flatten:function(){return r}})},8667:function(e,t,n){!function(e,t,n,r){"use strict";function a(e){return e&&"object"===typeof e&&"default"in e?e:{default:e}}var i=a(t),o=a(n),s=a(r),u=function(e,t,n){return{endTime:t,insertTime:n,type:"exponentialRampToValue",value:e}},c=function(e,t,n){return{endTime:t,insertTime:n,type:"linearRampToValue",value:e}},l=function(e,t){return{startTime:t,type:"setValue",value:e}},h=function(e,t,n){return{duration:n,startTime:t,type:"setValueCurve",values:e}},f=function(e,t,n){var r=n.startTime,a=n.target,i=n.timeConstant;return a+(t-a)*Math.exp((r-e)/i)},p=function(e){return"exponentialRampToValue"===e.type},d=function(e){return"linearRampToValue"===e.type},m=function(e){return p(e)||d(e)},v=function(e){return"setValue"===e.type},g=function(e){return"setValueCurve"===e.type},y=function e(t,n,r,a){var i=t[n];return void 0===i?a:m(i)||v(i)?i.value:g(i)?i.values[i.values.length-1]:f(r,e(t,n-1,i.startTime,a),i)},b=function(e,t,n,r,a){return void 0===n?[r.insertTime,a]:m(n)?[n.endTime,n.value]:v(n)?[n.startTime,n.value]:g(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,y(e,t-1,n.startTime,a)]},k=function(e){return"cancelAndHold"===e.type},x=function(e){return"cancelScheduledValues"===e.type},w=function(e){return k(e)||x(e)?e.cancelTime:p(e)||d(e)?e.endTime:e.startTime},_=function(e,t,n,r){var a=r.endTime,i=r.value;return n===i?i:0<n&&0<i||n<0&&i<0?n*Math.pow(i/n,(e-t)/(a-t)):0},S=function(e,t,n,r){return n+(e-t)/(r.endTime-t)*(r.value-n)},C=function(e,t){var n=Math.floor(t),r=Math.ceil(t);return n===r?e[n]:(1-(t-n))*e[n]+(1-(r-t))*e[r]},T=function(e,t){var n=t.duration,r=t.startTime,a=t.values,i=(e-r)/n*(a.length-1);return C(a,i)},E=function(e){return"setTarget"===e.type},I=function(e){function t(e){o.default(this,t),this._automationEvents=[],this._currenTime=0,this._defaultValue=e}return s.default(t,[{key:e,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(e){var t=w(e);if(k(e)||x(e)){var n=this._automationEvents.findIndex((function(n){return x(e)&&g(n)?n.startTime+n.duration>=t:w(n)>=t})),r=this._automationEvents[n];if(-1!==n&&(this._automationEvents=this._automationEvents.slice(0,n)),k(e)){var a=this._automationEvents[this._automationEvents.length-1];if(void 0!==r&&m(r)){if(E(a))throw new Error("The internal list is malformed.");var i=g(a)?a.startTime+a.duration:w(a),o=g(a)?a.values[a.values.length-1]:a.value,s=p(r)?_(t,i,o,r):S(t,i,o,r),f=p(r)?u(s,t,this._currenTime):c(s,t,this._currenTime);this._automationEvents.push(f)}void 0!==a&&E(a)&&this._automationEvents.push(l(this.getValue(t),t)),void 0!==a&&g(a)&&a.startTime+a.duration>t&&(this._automationEvents[this._automationEvents.length-1]=h(new Float32Array([6,7]),a.startTime,t-a.startTime))}}else{var v=this._automationEvents.findIndex((function(e){return w(e)>t})),y=-1===v?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[v-1];if(void 0!==y&&g(y)&&w(y)+y.duration>t)return!1;var b=p(e)?u(e.value,e.endTime,this._currenTime):d(e)?c(e.value,t,this._currenTime):e;if(-1===v)this._automationEvents.push(b);else{if(g(e)&&t+e.duration>w(this._automationEvents[v]))return!1;this._automationEvents.splice(v,0,b)}}return!0}},{key:"flush",value:function(e){var t=this._automationEvents.findIndex((function(t){return w(t)>e}));if(t>1){var n=this._automationEvents.slice(t-1),r=n[0];E(r)&&n.unshift(l(y(this._automationEvents,t-2,r.startTime,this._defaultValue),r.startTime)),this._automationEvents=n}}},{key:"getValue",value:function(e){if(0===this._automationEvents.length)return this._defaultValue;var t=this._automationEvents.findIndex((function(t){return w(t)>e})),n=this._automationEvents[t],r=(-1===t?this._automationEvents.length:t)-1,a=this._automationEvents[r];if(void 0!==a&&E(a)&&(void 0===n||!m(n)||n.insertTime>e))return f(e,y(this._automationEvents,r-1,a.startTime,this._defaultValue),a);if(void 0!==a&&v(a)&&(void 0===n||!m(n)))return a.value;if(void 0!==a&&g(a)&&(void 0===n||!m(n)||a.startTime+a.duration>e))return e<a.startTime+a.duration?T(e,a):a.values[a.values.length-1];if(void 0!==a&&m(a)&&(void 0===n||!m(n)))return a.value;if(void 0!==n&&p(n)){var o=b(this._automationEvents,r,a,n,this._defaultValue),s=i.default(o,2),u=s[0],c=s[1];return _(e,u,c,n)}if(void 0!==n&&d(n)){var l=b(this._automationEvents,r,a,n,this._defaultValue),h=i.default(l,2),k=h[0],x=h[1];return S(e,k,x,n)}return this._defaultValue}}]),t}(Symbol.iterator),A=function(e){return{cancelTime:e,type:"cancelAndHold"}},N=function(e){return{cancelTime:e,type:"cancelScheduledValues"}},P=function(e,t){return{endTime:t,type:"exponentialRampToValue",value:e}},M=function(e,t){return{endTime:t,type:"linearRampToValue",value:e}},D=function(e,t,n){return{startTime:t,target:e,timeConstant:n,type:"setTarget"}};e.AutomationEventList=I,e.createCancelAndHoldAutomationEvent=A,e.createCancelScheduledValuesAutomationEvent=N,e.createExponentialRampToValueAutomationEvent=P,e.createLinearRampToValueAutomationEvent=M,e.createSetTargetAutomationEvent=D,e.createSetValueAutomationEvent=l,e.createSetValueCurveAutomationEvent=h,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(3038),n(4575),n(3913))},2461:function(e,t,n){e.exports={default:n(1721),__esModule:!0}},2275:function(e,t,n){e.exports={default:n(7039),__esModule:!0}},8660:function(e,t,n){e.exports={default:n(5907),__esModule:!0}},3415:function(e,t,n){e.exports={default:n(968),__esModule:!0}},2828:function(e,t,n){e.exports={default:n(7550),__esModule:!0}},2399:function(e,t,n){e.exports={default:n(4049),__esModule:!0}},6972:function(e,t,n){e.exports={default:n(1748),__esModule:!0}},5053:function(e,t){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},2749:function(e,t,n){"use strict";t.__esModule=!0;var r,a=n(8660),i=(r=a)&&r.__esModule?r:{default:r};t.default=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,i.default)(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}()},2836:function(e,t,n){"use strict";t.__esModule=!0;var r,a=n(2461),i=(r=a)&&r.__esModule?r:{default:r};t.default=i.default||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}},2455:function(e,t,n){"use strict";t.__esModule=!0;var r=o(n(2828)),a=o(n(2275)),i=o(n(8129));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"===typeof t?"undefined":(0,i.default)(t)));e.prototype=(0,a.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(r.default?(0,r.default)(e,t):e.__proto__=t)}},4976:function(e,t,n){"use strict";t.__esModule=!0;var r,a=n(8129),i=(r=a)&&r.__esModule?r:{default:r};t.default=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"===typeof t?"undefined":(0,i.default)(t))&&"function"!==typeof t?e:t}},8129:function(e,t,n){"use strict";t.__esModule=!0;var r=o(n(6972)),a=o(n(2399)),i="function"===typeof a.default&&"symbol"===typeof r.default?function(e){return typeof e}:function(e){return e&&"function"===typeof a.default&&e.constructor===a.default&&e!==a.default.prototype?"symbol":typeof e};function o(e){return e&&e.__esModule?e:{default:e}}t.default="function"===typeof a.default&&"symbol"===i(r.default)?function(e){return"undefined"===typeof e?"undefined":i(e)}:function(e){return e&&"function"===typeof a.default&&e.constructor===a.default&&e!==a.default.prototype?"symbol":"undefined"===typeof e?"undefined":i(e)}},1721:function(e,t,n){n(7232),e.exports=n(640).Object.assign},7039:function(e,t,n){n(4664);var r=n(640).Object;e.exports=function(e,t){return r.create(e,t)}},5907:function(e,t,n){n(4830);var r=n(640).Object;e.exports=function(e,t,n){return r.defineProperty(e,t,n)}},968:function(e,t,n){n(5894),e.exports=n(640).Object.getPrototypeOf},7550:function(e,t,n){n(4938),e.exports=n(640).Object.setPrototypeOf},4049:function(e,t,n){n(1663),n(1504),n(226),n(7604),e.exports=n(640).Symbol},1748:function(e,t,n){n(9366),n(5690),e.exports=n(7236).f("iterator")},7281:function(e){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},2642:function(e){e.exports=function(){}},9478:function(e,t,n){var r=n(5682);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},1437:function(e,t,n){var r=n(4969),a=n(9839),i=n(2137);e.exports=function(e){return function(t,n,o){var s,u=r(t),c=a(u.length),l=i(o,c);if(e&&n!=n){for(;c>l;)if((s=u[l++])!=s)return!0}else for(;c>l;l++)if((e||l in u)&&u[l]===n)return e||l||0;return!e&&-1}}},3760:function(e){var t={}.toString;e.exports=function(e){return t.call(e).slice(8,-1)}},640:function(e){var t=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=t)},9882:function(e,t,n){var r=n(7281);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,a){return e.call(t,n,r,a)}}return function(){return e.apply(t,arguments)}}},6101:function(e){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},3457:function(e,t,n){e.exports=!n(1718)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},244:function(e,t,n){var r=n(5682),a=n(9765).document,i=r(a)&&r(a.createElement);e.exports=function(e){return i?a.createElement(e):{}}},2158:function(e){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},7594:function(e,t,n){var r=n(5059),a=n(7141),i=n(2553);e.exports=function(e){var t=r(e),n=a.f;if(n)for(var o,s=n(e),u=i.f,c=0;s.length>c;)u.call(e,o=s[c++])&&t.push(o);return t}},8430:function(e,t,n){var r=n(9765),a=n(640),i=n(9882),o=n(1086),s=n(9820),u=function e(t,n,u){var c,l,h,f=t&e.F,p=t&e.G,d=t&e.S,m=t&e.P,v=t&e.B,g=t&e.W,y=p?a:a[n]||(a[n]={}),b=y.prototype,k=p?r:d?r[n]:(r[n]||{}).prototype;for(c in p&&(u=n),u)(l=!f&&k&&void 0!==k[c])&&s(y,c)||(h=l?k[c]:u[c],y[c]=p&&"function"!=typeof k[c]?u[c]:v&&l?i(h,r):g&&k[c]==h?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(h):m&&"function"==typeof h?i(Function.call,h):h,m&&((y.virtual||(y.virtual={}))[c]=h,t&e.R&&b&&!b[c]&&o(b,c,h)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,e.exports=u},1718:function(e){e.exports=function(e){try{return!!e()}catch(t){return!0}}},9765:function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)},9820:function(e){var t={}.hasOwnProperty;e.exports=function(e,n){return t.call(e,n)}},1086:function(e,t,n){var r=n(1272),a=n(6117);e.exports=n(3457)?function(e,t,n){return r.f(e,t,a(1,n))}:function(e,t,n){return e[t]=n,e}},5942:function(e,t,n){var r=n(9765).document;e.exports=r&&r.documentElement},3952:function(e,t,n){e.exports=!n(3457)&&!n(1718)((function(){return 7!=Object.defineProperty(n(244)("div"),"a",{get:function(){return 7}}).a}))},1922:function(e,t,n){var r=n(3760);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},8249:function(e,t,n){var r=n(3760);e.exports=Array.isArray||function(e){return"Array"==r(e)}},5682:function(e){e.exports=function(e){return"object"===typeof e?null!==e:"function"===typeof e}},9136:function(e,t,n){"use strict";var r=n(1760),a=n(6117),i=n(825),o={};n(1086)(o,n(6505)("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=r(o,{next:a(1,n)}),i(e,t+" Iterator")}},5387:function(e,t,n){"use strict";var r=n(3845),a=n(8430),i=n(4368),o=n(1086),s=n(1700),u=n(9136),c=n(825),l=n(4794),h=n(6505)("iterator"),f=!([].keys&&"next"in[].keys()),p="keys",d="values",m=function(){return this};e.exports=function(e,t,n,v,g,y,b){u(n,t,v);var k,x,w,_=function(e){if(!f&&e in E)return E[e];switch(e){case p:case d:return function(){return new n(this,e)}}return function(){return new n(this,e)}},S=t+" Iterator",C=g==d,T=!1,E=e.prototype,I=E[h]||E["@@iterator"]||g&&E[g],A=I||_(g),N=g?C?_("entries"):A:void 0,P="Array"==t&&E.entries||I;if(P&&(w=l(P.call(new e)))!==Object.prototype&&w.next&&(c(w,S,!0),r||"function"==typeof w[h]||o(w,h,m)),C&&I&&I.name!==d&&(T=!0,A=function(){return I.call(this)}),r&&!b||!f&&!T&&E[h]||o(E,h,A),s[t]=A,s[S]=m,g)if(k={values:C?A:_(d),keys:y?A:_(p),entries:N},b)for(x in k)x in E||i(E,x,k[x]);else a(a.P+a.F*(f||T),t,k);return k}},2217:function(e){e.exports=function(e,t){return{value:t,done:!!e}}},1700:function(e){e.exports={}},3845:function(e){e.exports=!0},5619:function(e,t,n){var r=n(7898)("meta"),a=n(5682),i=n(9820),o=n(1272).f,s=0,u=Object.isExtensible||function(){return!0},c=!n(1718)((function(){return u(Object.preventExtensions({}))})),l=function(e){o(e,r,{value:{i:"O"+ ++s,w:{}}})},h=e.exports={KEY:r,NEED:!1,fastKey:function(e,t){if(!a(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!i(e,r)){if(!u(e))return"F";if(!t)return"E";l(e)}return e[r].i},getWeak:function(e,t){if(!i(e,r)){if(!u(e))return!0;if(!t)return!1;l(e)}return e[r].w},onFreeze:function(e){return c&&h.NEED&&u(e)&&!i(e,r)&&l(e),e}}},1586:function(e,t,n){"use strict";var r=n(3457),a=n(5059),i=n(7141),o=n(2553),s=n(6663),u=n(1922),c=Object.assign;e.exports=!c||n(1718)((function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=c({},e)[n]||Object.keys(c({},t)).join("")!=r}))?function(e,t){for(var n=s(e),c=arguments.length,l=1,h=i.f,f=o.f;c>l;)for(var p,d=u(arguments[l++]),m=h?a(d).concat(h(d)):a(d),v=m.length,g=0;v>g;)p=m[g++],r&&!f.call(d,p)||(n[p]=d[p]);return n}:c},1760:function(e,t,n){var r=n(9478),a=n(5475),i=n(2158),o=n(1383)("IE_PROTO"),s=function(){},u=function(){var e,t=n(244)("iframe"),r=i.length;for(t.style.display="none",n(5942).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),u=e.F;r--;)delete u.prototype[i[r]];return u()};e.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=r(e),n=new s,s.prototype=null,n[o]=e):n=u(),void 0===t?n:a(n,t)}},1272:function(e,t,n){var r=n(9478),a=n(3952),i=n(4212),o=Object.defineProperty;t.f=n(3457)?Object.defineProperty:function(e,t,n){if(r(e),t=i(t,!0),r(n),a)try{return o(e,t,n)}catch(s){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},5475:function(e,t,n){var r=n(1272),a=n(9478),i=n(5059);e.exports=n(3457)?Object.defineProperties:function(e,t){a(e);for(var n,o=i(t),s=o.length,u=0;s>u;)r.f(e,n=o[u++],t[n]);return e}},3386:function(e,t,n){var r=n(2553),a=n(6117),i=n(4969),o=n(4212),s=n(9820),u=n(3952),c=Object.getOwnPropertyDescriptor;t.f=n(3457)?c:function(e,t){if(e=i(e),t=o(t,!0),u)try{return c(e,t)}catch(n){}if(s(e,t))return a(!r.f.call(e,t),e[t])}},1415:function(e,t,n){var r=n(4969),a=n(2712).f,i={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return o&&"[object Window]"==i.call(e)?function(e){try{return a(e)}catch(t){return o.slice()}}(e):a(r(e))}},2712:function(e,t,n){var r=n(7356),a=n(2158).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,a)}},7141:function(e,t){t.f=Object.getOwnPropertySymbols},4794:function(e,t,n){var r=n(9820),a=n(6663),i=n(1383)("IE_PROTO"),o=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=a(e),r(e,i)?e[i]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?o:null}},7356:function(e,t,n){var r=n(9820),a=n(4969),i=n(1437)(!1),o=n(1383)("IE_PROTO");e.exports=function(e,t){var n,s=a(e),u=0,c=[];for(n in s)n!=o&&r(s,n)&&c.push(n);for(;t.length>u;)r(s,n=t[u++])&&(~i(c,n)||c.push(n));return c}},5059:function(e,t,n){var r=n(7356),a=n(2158);e.exports=Object.keys||function(e){return r(e,a)}},2553:function(e,t){t.f={}.propertyIsEnumerable},6917:function(e,t,n){var r=n(8430),a=n(640),i=n(1718);e.exports=function(e,t){var n=(a.Object||{})[e]||Object[e],o={};o[e]=t(n),r(r.S+r.F*i((function(){n(1)})),"Object",o)}},6117:function(e){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},4368:function(e,t,n){e.exports=n(1086)},2315:function(e,t,n){var r=n(5682),a=n(9478),i=function(e,t){if(a(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=n(9882)(Function.call,n(3386).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(a){t=!0}return function(e,n){return i(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:i}},825:function(e,t,n){var r=n(1272).f,a=n(9820),i=n(6505)("toStringTag");e.exports=function(e,t,n){e&&!a(e=n?e:e.prototype,i)&&r(e,i,{configurable:!0,value:t})}},1383:function(e,t,n){var r=n(7943)("keys"),a=n(7898);e.exports=function(e){return r[e]||(r[e]=a(e))}},7943:function(e,t,n){var r=n(640),a=n(9765),i="__core-js_shared__",o=a[i]||(a[i]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(3845)?"pure":"global",copyright:"\xa9 2020 Denis Pushkarev (zloirock.ru)"})},4649:function(e,t,n){var r=n(6889),a=n(6101);e.exports=function(e){return function(t,n){var i,o,s=String(a(t)),u=r(n),c=s.length;return u<0||u>=c?e?"":void 0:(i=s.charCodeAt(u))<55296||i>56319||u+1===c||(o=s.charCodeAt(u+1))<56320||o>57343?e?s.charAt(u):i:e?s.slice(u,u+2):o-56320+(i-55296<<10)+65536}}},2137:function(e,t,n){var r=n(6889),a=Math.max,i=Math.min;e.exports=function(e,t){return(e=r(e))<0?a(e+t,0):i(e,t)}},6889:function(e){var t=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:t)(e)}},4969:function(e,t,n){var r=n(1922),a=n(6101);e.exports=function(e){return r(a(e))}},9839:function(e,t,n){var r=n(6889),a=Math.min;e.exports=function(e){return e>0?a(r(e),9007199254740991):0}},6663:function(e,t,n){var r=n(6101);e.exports=function(e){return Object(r(e))}},4212:function(e,t,n){var r=n(5682);e.exports=function(e,t){if(!r(e))return e;var n,a;if(t&&"function"==typeof(n=e.toString)&&!r(a=n.call(e)))return a;if("function"==typeof(n=e.valueOf)&&!r(a=n.call(e)))return a;if(!t&&"function"==typeof(n=e.toString)&&!r(a=n.call(e)))return a;throw TypeError("Can't convert object to primitive value")}},7898:function(e){var t=0,n=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++t+n).toString(36))}},5809:function(e,t,n){var r=n(9765),a=n(640),i=n(3845),o=n(7236),s=n(1272).f;e.exports=function(e){var t=a.Symbol||(a.Symbol=i?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:o.f(e)})}},7236:function(e,t,n){t.f=n(6505)},6505:function(e,t,n){var r=n(7943)("wks"),a=n(7898),i=n(9765).Symbol,o="function"==typeof i;(e.exports=function(e){return r[e]||(r[e]=o&&i[e]||(o?i:a)("Symbol."+e))}).store=r},7572:function(e,t,n){"use strict";var r=n(2642),a=n(2217),i=n(1700),o=n(4969);e.exports=n(5387)(Array,"Array",(function(e,t){this._t=o(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,a(1)):a(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values"),i.Arguments=i.Array,r("keys"),r("values"),r("entries")},7232:function(e,t,n){var r=n(8430);r(r.S+r.F,"Object",{assign:n(1586)})},4664:function(e,t,n){var r=n(8430);r(r.S,"Object",{create:n(1760)})},4830:function(e,t,n){var r=n(8430);r(r.S+r.F*!n(3457),"Object",{defineProperty:n(1272).f})},5894:function(e,t,n){var r=n(6663),a=n(4794);n(6917)("getPrototypeOf",(function(){return function(e){return a(r(e))}}))},4938:function(e,t,n){var r=n(8430);r(r.S,"Object",{setPrototypeOf:n(2315).set})},1504:function(){},9366:function(e,t,n){"use strict";var r=n(4649)(!0);n(5387)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})}))},1663:function(e,t,n){"use strict";var r=n(9765),a=n(9820),i=n(3457),o=n(8430),s=n(4368),u=n(5619).KEY,c=n(1718),l=n(7943),h=n(825),f=n(7898),p=n(6505),d=n(7236),m=n(5809),v=n(7594),g=n(8249),y=n(9478),b=n(5682),k=n(6663),x=n(4969),w=n(4212),_=n(6117),S=n(1760),C=n(1415),T=n(3386),E=n(7141),I=n(1272),A=n(5059),N=T.f,P=I.f,M=C.f,D=r.Symbol,R=r.JSON,O=R&&R.stringify,F=p("_hidden"),L=p("toPrimitive"),z={}.propertyIsEnumerable,B=l("symbol-registry"),V=l("symbols"),j=l("op-symbols"),q=Object.prototype,G="function"==typeof D&&!!E.f,W=r.QObject,U=!W||!W.prototype||!W.prototype.findChild,H=i&&c((function(){return 7!=S(P({},"a",{get:function(){return P(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=N(q,t);r&&delete q[t],P(e,t,n),r&&e!==q&&P(q,t,r)}:P,K=function(e){var t=V[e]=S(D.prototype);return t._k=e,t},X=G&&"symbol"==typeof D.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof D},Y=function(e,t,n){return e===q&&Y(j,t,n),y(e),t=w(t,!0),y(n),a(V,t)?(n.enumerable?(a(e,F)&&e[F][t]&&(e[F][t]=!1),n=S(n,{enumerable:_(0,!1)})):(a(e,F)||P(e,F,_(1,{})),e[F][t]=!0),H(e,t,n)):P(e,t,n)},Q=function(e,t){y(e);for(var n,r=v(t=x(t)),a=0,i=r.length;i>a;)Y(e,n=r[a++],t[n]);return e},$=function(e){var t=z.call(this,e=w(e,!0));return!(this===q&&a(V,e)&&!a(j,e))&&(!(t||!a(this,e)||!a(V,e)||a(this,F)&&this[F][e])||t)},J=function(e,t){if(e=x(e),t=w(t,!0),e!==q||!a(V,t)||a(j,t)){var n=N(e,t);return!n||!a(V,t)||a(e,F)&&e[F][t]||(n.enumerable=!0),n}},Z=function(e){for(var t,n=M(x(e)),r=[],i=0;n.length>i;)a(V,t=n[i++])||t==F||t==u||r.push(t);return r},ee=function(e){for(var t,n=e===q,r=M(n?j:x(e)),i=[],o=0;r.length>o;)!a(V,t=r[o++])||n&&!a(q,t)||i.push(V[t]);return i};G||(D=function(){if(this instanceof D)throw TypeError("Symbol is not a constructor!");var e=f(arguments.length>0?arguments[0]:void 0),t=function t(n){this===q&&t.call(j,n),a(this,F)&&a(this[F],e)&&(this[F][e]=!1),H(this,e,_(1,n))};return i&&U&&H(q,e,{configurable:!0,set:t}),K(e)},s(D.prototype,"toString",(function(){return this._k})),T.f=J,I.f=Y,n(2712).f=C.f=Z,n(2553).f=$,E.f=ee,i&&!n(3845)&&s(q,"propertyIsEnumerable",$,!0),d.f=function(e){return K(p(e))}),o(o.G+o.W+o.F*!G,{Symbol:D});for(var te="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;te.length>ne;)p(te[ne++]);for(var re=A(p.store),ae=0;re.length>ae;)m(re[ae++]);o(o.S+o.F*!G,"Symbol",{for:function(e){return a(B,e+="")?B[e]:B[e]=D(e)},keyFor:function(e){if(!X(e))throw TypeError(e+" is not a symbol!");for(var t in B)if(B[t]===e)return t},useSetter:function(){U=!0},useSimple:function(){U=!1}}),o(o.S+o.F*!G,"Object",{create:function(e,t){return void 0===t?S(e):Q(S(e),t)},defineProperty:Y,defineProperties:Q,getOwnPropertyDescriptor:J,getOwnPropertyNames:Z,getOwnPropertySymbols:ee});var ie=c((function(){E.f(1)}));o(o.S+o.F*ie,"Object",{getOwnPropertySymbols:function(e){return E.f(k(e))}}),R&&o(o.S+o.F*(!G||c((function(){var e=D();return"[null]"!=O([e])||"{}"!=O({a:e})||"{}"!=O(Object(e))}))),"JSON",{stringify:function(e){for(var t,n,r=[e],a=1;arguments.length>a;)r.push(arguments[a++]);if(n=t=r[1],(b(t)||void 0!==e)&&!X(e))return g(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!X(t))return t}),r[1]=t,O.apply(R,r)}}),D.prototype[L]||n(1086)(D.prototype,L,D.prototype.valueOf),h(D,"Symbol"),h(Math,"Math",!0),h(r.JSON,"JSON",!0)},226:function(e,t,n){n(5809)("asyncIterator")},7604:function(e,t,n){n(5809)("observable")},5690:function(e,t,n){n(7572);for(var r=n(9765),a=n(1086),i=n(1700),o=n(6505)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<s.length;u++){var c=s[u],l=r[c],h=l&&l.prototype;h&&!h[o]&&a(h,o,c),i[c]=i.Array}},2009:function(e,t){"use strict";t.byteLength=function(e){var t=u(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,i=u(e),o=i[0],s=i[1],c=new a(function(e,t,n){return 3*(t+n)/4-n}(0,o,s)),l=0,h=s>0?o-4:o;for(n=0;n<h;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],c[l++]=t>>16&255,c[l++]=t>>8&255,c[l++]=255&t;2===s&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,c[l++]=255&t);1===s&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,c[l++]=t>>8&255,c[l++]=255&t);return c},t.fromByteArray=function(e){for(var t,r=e.length,a=r%3,i=[],o=16383,s=0,u=r-a;s<u;s+=o)i.push(c(e,s,s+o>u?u:s+o));1===a?(t=e[r-1],i.push(n[t>>2]+n[t<<4&63]+"==")):2===a&&(t=(e[r-2]<<8)+e[r-1],i.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return i.join("")};for(var n=[],r=[],a="undefined"!==typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,s=i.length;o<s;++o)n[o]=i[o],r[i.charCodeAt(o)]=o;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,r){for(var a,i,o=[],s=t;s<r;s+=3)a=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(n[(i=a)>>18&63]+n[i>>12&63]+n[i>>6&63]+n[63&i]);return o.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},5844:function(e,t){"use strict";function n(e){var t=32;return(e&=-e)&&t--,65535&e&&(t-=16),16711935&e&&(t-=8),252645135&e&&(t-=4),858993459&e&&(t-=2),1431655765&e&&(t-=1),t}t.INT_BITS=32,t.INT_MAX=2147483647,t.INT_MIN=-1<<31,t.sign=function(e){return(e>0)-(e<0)},t.abs=function(e){var t=e>>31;return(e^t)-t},t.min=function(e,t){return t^(e^t)&-(e<t)},t.max=function(e,t){return e^(e^t)&-(e<t)},t.isPow2=function(e){return!(e&e-1)&&!!e},t.log2=function(e){var t,n;return t=(e>65535)<<4,t|=n=((e>>>=t)>255)<<3,t|=n=((e>>>=n)>15)<<2,(t|=n=((e>>>=n)>3)<<1)|(e>>>=n)>>1},t.log10=function(e){return e>=1e9?9:e>=1e8?8:e>=1e7?7:e>=1e6?6:e>=1e5?5:e>=1e4?4:e>=1e3?3:e>=100?2:e>=10?1:0},t.popCount=function(e){return 16843009*((e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135)>>>24},t.countTrailingZeros=n,t.nextPow2=function(e){return e+=0===e,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)+1},t.prevPow2=function(e){return e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)-(e>>>1)},t.parity=function(e){return e^=e>>>16,e^=e>>>8,e^=e>>>4,27030>>>(e&=15)&1};var r=new Array(256);!function(e){for(var t=0;t<256;++t){var n=t,r=t,a=7;for(n>>>=1;n;n>>>=1)r<<=1,r|=1&n,--a;e[t]=r<<a&255}}(r),t.reverse=function(e){return r[255&e]<<24|r[e>>>8&255]<<16|r[e>>>16&255]<<8|r[e>>>24&255]},t.interleave2=function(e,t){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e&=65535)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t&=65535)|t<<8))|t<<4))|t<<2))|t<<1))<<1},t.deinterleave2=function(e,t){return(e=65535&((e=16711935&((e=252645135&((e=858993459&((e=e>>>t&1431655765)|e>>>1))|e>>>2))|e>>>4))|e>>>16))<<16>>16},t.interleave3=function(e,t,n){return e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2),(e|=(t=1227133513&((t=3272356035&((t=251719695&((t=4278190335&((t&=1023)|t<<16))|t<<8))|t<<4))|t<<2))<<1)|(n=1227133513&((n=3272356035&((n=251719695&((n=4278190335&((n&=1023)|n<<16))|n<<8))|n<<4))|n<<2))<<2},t.deinterleave3=function(e,t){return(e=1023&((e=4278190335&((e=251719695&((e=3272356035&((e=e>>>t&1227133513)|e>>>2))|e>>>4))|e>>>8))|e>>>16))<<22>>22},t.nextCombination=function(e){var t=e|e-1;return t+1|(~t&-~t)-1>>>n(e)+1}},9778:function(e,t,n){"use strict";var r=n(4575).default,a=n(3913).default,i=n(1506).default,o=n(2205).default,s=n(9842).default,u=n(2009),c=n(4038),l="function"===typeof Symbol&&"function"===typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.lW=p,t.h2=50;var h=2147483647;function f(e){if(e>h)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,p.prototype),t}function p(e,t,n){if("number"===typeof e){if("string"===typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return v(e)}return d(e,t,n)}function d(e,t,n){if("string"===typeof e)return function(e,t){"string"===typeof t&&""!==t||(t="utf8");if(!p.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var n=0|k(e,t),r=f(n),a=r.write(e,t);a!==n&&(r=r.slice(0,a));return r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(ee(e,Uint8Array)){var t=new Uint8Array(e);return y(t.buffer,t.byteOffset,t.byteLength)}return g(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(ee(e,ArrayBuffer)||e&&ee(e.buffer,ArrayBuffer))return y(e,t,n);if("undefined"!==typeof SharedArrayBuffer&&(ee(e,SharedArrayBuffer)||e&&ee(e.buffer,SharedArrayBuffer)))return y(e,t,n);if("number"===typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return p.from(r,t,n);var a=function(e){if(p.isBuffer(e)){var t=0|b(e.length),n=f(t);return 0===n.length||e.copy(n,0,0,t),n}if(void 0!==e.length)return"number"!==typeof e.length||te(e.length)?f(0):g(e);if("Buffer"===e.type&&Array.isArray(e.data))return g(e.data)}(e);if(a)return a;if("undefined"!==typeof Symbol&&null!=Symbol.toPrimitive&&"function"===typeof e[Symbol.toPrimitive])return p.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function m(e){if("number"!==typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function v(e){return m(e),f(e<0?0:0|b(e))}function g(e){for(var t=e.length<0?0:0|b(e.length),n=f(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}function y(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,p.prototype),r}function b(e){if(e>=h)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+h.toString(16)+" bytes");return 0|e}function k(e,t){if(p.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||ee(e,ArrayBuffer))return e.byteLength;if("string"!==typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var a=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return $(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return J(e).length;default:if(a)return r?-1:$(e).length;t=(""+t).toLowerCase(),a=!0}}function x(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return O(this,t,n);case"utf8":case"utf-8":return P(this,t,n);case"ascii":return D(this,t,n);case"latin1":case"binary":return R(this,t,n);case"base64":return N(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function w(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function _(e,t,n,r,a){if(0===e.length)return-1;if("string"===typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),te(n=+n)&&(n=a?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(a)return-1;n=e.length-1}else if(n<0){if(!a)return-1;n=0}if("string"===typeof t&&(t=p.from(t,r)),p.isBuffer(t))return 0===t.length?-1:S(e,t,n,r,a);if("number"===typeof t)return t&=255,"function"===typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):S(e,[t],n,r,a);throw new TypeError("val must be string, number or Buffer")}function S(e,t,n,r,a){var i,o=1,s=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,s/=2,u/=2,n/=2}function c(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(a){var l=-1;for(i=n;i<s;i++)if(c(e,i)===c(t,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===u)return l*o}else-1!==l&&(i-=i-l),l=-1}else for(n+u>s&&(n=s-u),i=n;i>=0;i--){for(var h=!0,f=0;f<u;f++)if(c(e,i+f)!==c(t,f)){h=!1;break}if(h)return i}return-1}function C(e,t,n,r){n=Number(n)||0;var a=e.length-n;r?(r=Number(r))>a&&(r=a):r=a;var i,o=t.length;for(r>o/2&&(r=o/2),i=0;i<r;++i){var s=parseInt(t.substr(2*i,2),16);if(te(s))return i;e[n+i]=s}return i}function T(e,t,n,r){return Z($(t,e.length-n),e,n,r)}function E(e,t,n,r){return Z(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function I(e,t,n,r){return Z(J(t),e,n,r)}function A(e,t,n,r){return Z(function(e,t){for(var n,r,a,i=[],o=0;o<e.length&&!((t-=2)<0);++o)r=(n=e.charCodeAt(o))>>8,a=n%256,i.push(a),i.push(r);return i}(t,e.length-n),e,n,r)}function N(e,t,n){return 0===t&&n===e.length?u.fromByteArray(e):u.fromByteArray(e.slice(t,n))}function P(e,t,n){n=Math.min(e.length,n);for(var r=[],a=t;a<n;){var i=e[a],o=null,s=i>239?4:i>223?3:i>191?2:1;if(a+s<=n){var u=void 0,c=void 0,l=void 0,h=void 0;switch(s){case 1:i<128&&(o=i);break;case 2:128===(192&(u=e[a+1]))&&(h=(31&i)<<6|63&u)>127&&(o=h);break;case 3:u=e[a+1],c=e[a+2],128===(192&u)&&128===(192&c)&&(h=(15&i)<<12|(63&u)<<6|63&c)>2047&&(h<55296||h>57343)&&(o=h);break;case 4:u=e[a+1],c=e[a+2],l=e[a+3],128===(192&u)&&128===(192&c)&&128===(192&l)&&(h=(15&i)<<18|(63&u)<<12|(63&c)<<6|63&l)>65535&&h<1114112&&(o=h)}}null===o?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),a+=s}return function(e){var t=e.length;if(t<=M)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=M));return n}(r)}p.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(n){return!1}}(),p.TYPED_ARRAY_SUPPORT||"undefined"===typeof console||"function"!==typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(p.prototype,"parent",{enumerable:!0,get:function(){if(p.isBuffer(this))return this.buffer}}),Object.defineProperty(p.prototype,"offset",{enumerable:!0,get:function(){if(p.isBuffer(this))return this.byteOffset}}),p.poolSize=8192,p.from=function(e,t,n){return d(e,t,n)},Object.setPrototypeOf(p.prototype,Uint8Array.prototype),Object.setPrototypeOf(p,Uint8Array),p.alloc=function(e,t,n){return function(e,t,n){return m(e),e<=0?f(e):void 0!==t?"string"===typeof n?f(e).fill(t,n):f(e).fill(t):f(e)}(e,t,n)},p.allocUnsafe=function(e){return v(e)},p.allocUnsafeSlow=function(e){return v(e)},p.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==p.prototype},p.compare=function(e,t){if(ee(e,Uint8Array)&&(e=p.from(e,e.offset,e.byteLength)),ee(t,Uint8Array)&&(t=p.from(t,t.offset,t.byteLength)),!p.isBuffer(e)||!p.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,r=t.length,a=0,i=Math.min(n,r);a<i;++a)if(e[a]!==t[a]){n=e[a],r=t[a];break}return n<r?-1:r<n?1:0},p.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},p.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return p.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=p.allocUnsafe(t),a=0;for(n=0;n<e.length;++n){var i=e[n];if(ee(i,Uint8Array))a+i.length>r.length?(p.isBuffer(i)||(i=p.from(i)),i.copy(r,a)):Uint8Array.prototype.set.call(r,i,a);else{if(!p.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(r,a)}a+=i.length}return r},p.byteLength=k,p.prototype._isBuffer=!0,p.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)w(this,t,t+1);return this},p.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)w(this,t,t+3),w(this,t+1,t+2);return this},p.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)w(this,t,t+7),w(this,t+1,t+6),w(this,t+2,t+5),w(this,t+3,t+4);return this},p.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?P(this,0,e):x.apply(this,arguments)},p.prototype.toLocaleString=p.prototype.toString,p.prototype.equals=function(e){if(!p.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===p.compare(this,e)},p.prototype.inspect=function(){var e="",n=t.h2;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},l&&(p.prototype[l]=p.prototype.inspect),p.prototype.compare=function(e,t,n,r,a){if(ee(e,Uint8Array)&&(e=p.from(e,e.offset,e.byteLength)),!p.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===a&&(a=this.length),t<0||n>e.length||r<0||a>this.length)throw new RangeError("out of range index");if(r>=a&&t>=n)return 0;if(r>=a)return-1;if(t>=n)return 1;if(this===e)return 0;for(var i=(a>>>=0)-(r>>>=0),o=(n>>>=0)-(t>>>=0),s=Math.min(i,o),u=this.slice(r,a),c=e.slice(t,n),l=0;l<s;++l)if(u[l]!==c[l]){i=u[l],o=c[l];break}return i<o?-1:o<i?1:0},p.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},p.prototype.indexOf=function(e,t,n){return _(this,e,t,n,!0)},p.prototype.lastIndexOf=function(e,t,n){return _(this,e,t,n,!1)},p.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"===typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var a=this.length-t;if((void 0===n||n>a)&&(n=a),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return C(this,e,t,n);case"utf8":case"utf-8":return T(this,e,t,n);case"ascii":case"latin1":case"binary":return E(this,e,t,n);case"base64":return I(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},p.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var M=4096;function D(e,t,n){var r="";n=Math.min(e.length,n);for(var a=t;a<n;++a)r+=String.fromCharCode(127&e[a]);return r}function R(e,t,n){var r="";n=Math.min(e.length,n);for(var a=t;a<n;++a)r+=String.fromCharCode(e[a]);return r}function O(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var a="",i=t;i<n;++i)a+=ne[e[i]];return a}function F(e,t,n){for(var r=e.slice(t,n),a="",i=0;i<r.length-1;i+=2)a+=String.fromCharCode(r[i]+256*r[i+1]);return a}function L(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function z(e,t,n,r,a,i){if(!p.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function B(e,t,n,r,a){K(t,r,a,e,n,7);var i=Number(t&BigInt(4294967295));e[n++]=i,i>>=8,e[n++]=i,i>>=8,e[n++]=i,i>>=8,e[n++]=i;var o=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,n}function V(e,t,n,r,a){K(t,r,a,e,n,7);var i=Number(t&BigInt(4294967295));e[n+7]=i,i>>=8,e[n+6]=i,i>>=8,e[n+5]=i,i>>=8,e[n+4]=i;var o=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=o,o>>=8,e[n+2]=o,o>>=8,e[n+1]=o,o>>=8,e[n]=o,n+8}function j(e,t,n,r,a,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function q(e,t,n,r,a){return t=+t,n>>>=0,a||j(e,0,n,4),c.write(e,t,n,r,23,4),n+4}function G(e,t,n,r,a){return t=+t,n>>>=0,a||j(e,0,n,8),c.write(e,t,n,r,52,8),n+8}p.prototype.slice=function(e,t){var n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r=this.subarray(e,t);return Object.setPrototypeOf(r,p.prototype),r},p.prototype.readUintLE=p.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||L(e,t,this.length);for(var r=this[e],a=1,i=0;++i<t&&(a*=256);)r+=this[e+i]*a;return r},p.prototype.readUintBE=p.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||L(e,t,this.length);for(var r=this[e+--t],a=1;t>0&&(a*=256);)r+=this[e+--t]*a;return r},p.prototype.readUint8=p.prototype.readUInt8=function(e,t){return e>>>=0,t||L(e,1,this.length),this[e]},p.prototype.readUint16LE=p.prototype.readUInt16LE=function(e,t){return e>>>=0,t||L(e,2,this.length),this[e]|this[e+1]<<8},p.prototype.readUint16BE=p.prototype.readUInt16BE=function(e,t){return e>>>=0,t||L(e,2,this.length),this[e]<<8|this[e+1]},p.prototype.readUint32LE=p.prototype.readUInt32LE=function(e,t){return e>>>=0,t||L(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},p.prototype.readUint32BE=p.prototype.readUInt32BE=function(e,t){return e>>>=0,t||L(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},p.prototype.readBigUInt64LE=re((function(e){X(e>>>=0,"offset");var t=this[e],n=this[e+7];void 0!==t&&void 0!==n||Y(e,this.length-8);var r=t+this[++e]*Math.pow(2,8)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,24),a=this[++e]+this[++e]*Math.pow(2,8)+this[++e]*Math.pow(2,16)+n*Math.pow(2,24);return BigInt(r)+(BigInt(a)<<BigInt(32))})),p.prototype.readBigUInt64BE=re((function(e){X(e>>>=0,"offset");var t=this[e],n=this[e+7];void 0!==t&&void 0!==n||Y(e,this.length-8);var r=t*Math.pow(2,24)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,8)+this[++e],a=this[++e]*Math.pow(2,24)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,8)+n;return(BigInt(r)<<BigInt(32))+BigInt(a)})),p.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||L(e,t,this.length);for(var r=this[e],a=1,i=0;++i<t&&(a*=256);)r+=this[e+i]*a;return r>=(a*=128)&&(r-=Math.pow(2,8*t)),r},p.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||L(e,t,this.length);for(var r=t,a=1,i=this[e+--r];r>0&&(a*=256);)i+=this[e+--r]*a;return i>=(a*=128)&&(i-=Math.pow(2,8*t)),i},p.prototype.readInt8=function(e,t){return e>>>=0,t||L(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},p.prototype.readInt16LE=function(e,t){e>>>=0,t||L(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},p.prototype.readInt16BE=function(e,t){e>>>=0,t||L(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},p.prototype.readInt32LE=function(e,t){return e>>>=0,t||L(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},p.prototype.readInt32BE=function(e,t){return e>>>=0,t||L(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},p.prototype.readBigInt64LE=re((function(e){X(e>>>=0,"offset");var t=this[e],n=this[e+7];void 0!==t&&void 0!==n||Y(e,this.length-8);var r=this[e+4]+this[e+5]*Math.pow(2,8)+this[e+6]*Math.pow(2,16)+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+this[++e]*Math.pow(2,8)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,24))})),p.prototype.readBigInt64BE=re((function(e){X(e>>>=0,"offset");var t=this[e],n=this[e+7];void 0!==t&&void 0!==n||Y(e,this.length-8);var r=(t<<24)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,8)+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*Math.pow(2,24)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,8)+n)})),p.prototype.readFloatLE=function(e,t){return e>>>=0,t||L(e,4,this.length),c.read(this,e,!0,23,4)},p.prototype.readFloatBE=function(e,t){return e>>>=0,t||L(e,4,this.length),c.read(this,e,!1,23,4)},p.prototype.readDoubleLE=function(e,t){return e>>>=0,t||L(e,8,this.length),c.read(this,e,!0,52,8)},p.prototype.readDoubleBE=function(e,t){return e>>>=0,t||L(e,8,this.length),c.read(this,e,!1,52,8)},p.prototype.writeUintLE=p.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t>>>=0,n>>>=0,r)||z(this,e,t,n,Math.pow(2,8*n)-1,0);var a=1,i=0;for(this[t]=255&e;++i<n&&(a*=256);)this[t+i]=e/a&255;return t+n},p.prototype.writeUintBE=p.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t>>>=0,n>>>=0,r)||z(this,e,t,n,Math.pow(2,8*n)-1,0);var a=n-1,i=1;for(this[t+a]=255&e;--a>=0&&(i*=256);)this[t+a]=e/i&255;return t+n},p.prototype.writeUint8=p.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||z(this,e,t,1,255,0),this[t]=255&e,t+1},p.prototype.writeUint16LE=p.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||z(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},p.prototype.writeUint16BE=p.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||z(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},p.prototype.writeUint32LE=p.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||z(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},p.prototype.writeUint32BE=p.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||z(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},p.prototype.writeBigUInt64LE=re((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return B(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),p.prototype.writeBigUInt64BE=re((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return V(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),p.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var a=Math.pow(2,8*n-1);z(this,e,t,n,a-1,-a)}var i=0,o=1,s=0;for(this[t]=255&e;++i<n&&(o*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+n},p.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var a=Math.pow(2,8*n-1);z(this,e,t,n,a-1,-a)}var i=n-1,o=1,s=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+n},p.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||z(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},p.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||z(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},p.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||z(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},p.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||z(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},p.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||z(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},p.prototype.writeBigInt64LE=re((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return B(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),p.prototype.writeBigInt64BE=re((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return V(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),p.prototype.writeFloatLE=function(e,t,n){return q(this,e,t,!0,n)},p.prototype.writeFloatBE=function(e,t,n){return q(this,e,t,!1,n)},p.prototype.writeDoubleLE=function(e,t,n){return G(this,e,t,!0,n)},p.prototype.writeDoubleBE=function(e,t,n){return G(this,e,t,!1,n)},p.prototype.copy=function(e,t,n,r){if(!p.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var a=r-n;return this===e&&"function"===typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),a},p.prototype.fill=function(e,t,n,r){if("string"===typeof e){if("string"===typeof t?(r=t,t=0,n=this.length):"string"===typeof n&&(r=n,n=this.length),void 0!==r&&"string"!==typeof r)throw new TypeError("encoding must be a string");if("string"===typeof r&&!p.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){var a=e.charCodeAt(0);("utf8"===r&&a<128||"latin1"===r)&&(e=a)}}else"number"===typeof e?e&=255:"boolean"===typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"===typeof e)for(i=t;i<n;++i)this[i]=e;else{var o=p.isBuffer(e)?e:p.from(e,r),s=o.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=o[i%s]}return this};var W={};function U(e,t,n){W[e]=function(n){o(c,n);var u=s(c);function c(){var n;return r(this,c),n=u.call(this),Object.defineProperty(i(n),"message",{value:t.apply(i(n),arguments),writable:!0,configurable:!0}),n.name="".concat(n.name," [").concat(e,"]"),n.stack,delete n.name,n}return a(c,[{key:"code",get:function(){return e},set:function(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}},{key:"toString",value:function(){return"".concat(this.name," [").concat(e,"]: ").concat(this.message)}}]),c}(n)}function H(e){for(var t="",n=e.length,r="-"===e[0]?1:0;n>=r+4;n-=3)t="_".concat(e.slice(n-3,n)).concat(t);return"".concat(e.slice(0,n)).concat(t)}function K(e,t,n,r,a,i){if(e>n||e<t){var o,s="bigint"===typeof t?"n":"";throw o=i>3?0===t||t===BigInt(0)?">= 0".concat(s," and < 2").concat(s," ** ").concat(8*(i+1)).concat(s):">= -(2".concat(s," ** ").concat(8*(i+1)-1).concat(s,") and < 2 ** ")+"".concat(8*(i+1)-1).concat(s):">= ".concat(t).concat(s," and <= ").concat(n).concat(s),new W.ERR_OUT_OF_RANGE("value",o,e)}!function(e,t,n){X(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||Y(t,e.length-(n+1))}(r,a,i)}function X(e,t){if("number"!==typeof e)throw new W.ERR_INVALID_ARG_TYPE(t,"number",e)}function Y(e,t,n){if(Math.floor(e)!==e)throw X(e,n),new W.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new W.ERR_BUFFER_OUT_OF_BOUNDS;throw new W.ERR_OUT_OF_RANGE(n||"offset",">= ".concat(n?1:0," and <= ").concat(t),e)}U("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?"".concat(e," is outside of buffer bounds"):"Attempt to access memory outside buffer bounds"}),RangeError),U("ERR_INVALID_ARG_TYPE",(function(e,t){return'The "'.concat(e,'" argument must be of type number. Received type ').concat(typeof t)}),TypeError),U("ERR_OUT_OF_RANGE",(function(e,t,n){var r='The value of "'.concat(e,'" is out of range.'),a=n;return Number.isInteger(n)&&Math.abs(n)>Math.pow(2,32)?a=H(String(n)):"bigint"===typeof n&&(a=String(n),(n>Math.pow(BigInt(2),BigInt(32))||n<-Math.pow(BigInt(2),BigInt(32)))&&(a=H(a)),a+="n"),r+=" It must be ".concat(t,". Received ").concat(a)}),RangeError);var Q=/[^+/0-9A-Za-z-_]/g;function $(e,t){var n;t=t||1/0;for(var r=e.length,a=null,i=[],o=0;o<r;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!a){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&i.push(239,191,189);continue}a=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),a=n;continue}n=65536+(a-55296<<10|n-56320)}else a&&(t-=3)>-1&&i.push(239,191,189);if(a=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function J(e){return u.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(Q,"")).length<2)return"";for(;e.length%4!==0;)e+="=";return e}(e))}function Z(e,t,n,r){var a;for(a=0;a<r&&!(a+n>=t.length||a>=e.length);++a)t[a+n]=e[a];return a}function ee(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function te(e){return e!==e}var ne=function(){for(var e="0123456789abcdef",t=new Array(256),n=0;n<16;++n)for(var r=16*n,a=0;a<16;++a)t[r+a]=e[n]+e[a];return t}();function re(e){return"undefined"===typeof BigInt?ae:e}function ae(){throw new Error("BigInt not supported")}},7549:function(e,t,n){"use strict";var r=n(6747);function a(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}e.exports=function(e){var t=new a;t.pre=e.pre,t.body=e.body,t.post=e.post;var n=e.args.slice(0);t.argTypes=n;for(var i=0;i<n.length;++i){var o=n[i];if("array"===o||"object"===typeof o&&o.blockIndices){if(t.argTypes[i]="array",t.arrayArgs.push(i),t.arrayBlockIndices.push(o.blockIndices?o.blockIndices:0),t.shimArgs.push("array"+i),i<t.pre.args.length&&t.pre.args[i].count>0)throw new Error("cwise: pre() block may not reference array args");if(i<t.post.args.length&&t.post.args[i].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===o)t.scalarArgs.push(i),t.shimArgs.push("scalar"+i);else if("index"===o){if(t.indexArgs.push(i),i<t.pre.args.length&&t.pre.args[i].count>0)throw new Error("cwise: pre() block may not reference array index");if(i<t.body.args.length&&t.body.args[i].lvalue)throw new Error("cwise: body() block may not write to array index");if(i<t.post.args.length&&t.post.args[i].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===o){if(t.shapeArgs.push(i),i<t.pre.args.length&&t.pre.args[i].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(i<t.body.args.length&&t.body.args[i].lvalue)throw new Error("cwise: body() block may not write to array shape");if(i<t.post.args.length&&t.post.args[i].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!==typeof o||!o.offset)throw new Error("cwise: Unknown argument type "+n[i]);t.argTypes[i]="offset",t.offsetArgs.push({array:o.array,offset:o.offset}),t.offsetArgIndex.push(i)}}if(t.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(t.pre.args.length>n.length)throw new Error("cwise: Too many arguments in pre() block");if(t.body.args.length>n.length)throw new Error("cwise: Too many arguments in body() block");if(t.post.args.length>n.length)throw new Error("cwise: Too many arguments in post() block");return t.debug=!!e.printCode||!!e.debug,t.funcName=e.funcName||"cwise",t.blockSize=e.blockSize||64,r(t)}},5154:function(e,t,n){"use strict";var r=n(8871);function a(e,t,n){var r,a,i=e.length,o=t.arrayArgs.length,s=t.indexArgs.length>0,u=[],c=[],l=0,h=0;for(r=0;r<i;++r)c.push(["i",r,"=0"].join(""));for(a=0;a<o;++a)for(r=0;r<i;++r)h=l,l=e[r],0===r?c.push(["d",a,"s",r,"=t",a,"p",l].join("")):c.push(["d",a,"s",r,"=(t",a,"p",l,"-s",h,"*t",a,"p",h,")"].join(""));for(c.length>0&&u.push("var "+c.join(",")),r=i-1;r>=0;--r)l=e[r],u.push(["for(i",r,"=0;i",r,"<s",l,";++i",r,"){"].join(""));for(u.push(n),r=0;r<i;++r){for(h=l,l=e[r],a=0;a<o;++a)u.push(["p",a,"+=d",a,"s",r].join(""));s&&(r>0&&u.push(["index[",h,"]-=s",h].join("")),u.push(["++index[",l,"]"].join(""))),u.push("}")}return u.join("\n")}function i(e,t,n){for(var r=e.body,a=[],i=[],o=0;o<e.args.length;++o){var s=e.args[o];if(!(s.count<=0)){var u=new RegExp(s.name,"g"),c="",l=t.arrayArgs.indexOf(o);switch(t.argTypes[o]){case"offset":var h=t.offsetArgIndex.indexOf(o);l=t.offsetArgs[h].array,c="+q"+h;case"array":c="p"+l+c;var f="l"+o,p="a"+l;if(0===t.arrayBlockIndices[l])1===s.count?"generic"===n[l]?s.lvalue?(a.push(["var ",f,"=",p,".get(",c,")"].join("")),r=r.replace(u,f),i.push([p,".set(",c,",",f,")"].join(""))):r=r.replace(u,[p,".get(",c,")"].join("")):r=r.replace(u,[p,"[",c,"]"].join("")):"generic"===n[l]?(a.push(["var ",f,"=",p,".get(",c,")"].join("")),r=r.replace(u,f),s.lvalue&&i.push([p,".set(",c,",",f,")"].join(""))):(a.push(["var ",f,"=",p,"[",c,"]"].join("")),r=r.replace(u,f),s.lvalue&&i.push([p,"[",c,"]=",f].join("")));else{for(var d=[s.name],m=[c],v=0;v<Math.abs(t.arrayBlockIndices[l]);v++)d.push("\\s*\\[([^\\]]+)\\]"),m.push("$"+(v+1)+"*t"+l+"b"+v);if(u=new RegExp(d.join(""),"g"),c=m.join("+"),"generic"===n[l])throw new Error("cwise: Generic arrays not supported in combination with blocks!");r=r.replace(u,[p,"[",c,"]"].join(""))}break;case"scalar":r=r.replace(u,"Y"+t.scalarArgs.indexOf(o));break;case"index":r=r.replace(u,"index");break;case"shape":r=r.replace(u,"shape")}}}return[a.join("\n"),r,i.join("\n")].join("\n").trim()}function o(e){for(var t=new Array(e.length),n=!0,r=0;r<e.length;++r){var a=e[r],i=a.match(/\d+/);i=i?i[0]:"",0===a.charAt(0)?t[r]="u"+a.charAt(1)+i:t[r]=a.charAt(0)+i,r>0&&(n=n&&t[r]===t[r-1])}return n?t[0]:t.join("")}e.exports=function(e,t){for(var n=t[1].length-Math.abs(e.arrayBlockIndices[0])|0,s=new Array(e.arrayArgs.length),u=new Array(e.arrayArgs.length),c=0;c<e.arrayArgs.length;++c)u[c]=t[2*c],s[c]=t[2*c+1];var l=[],h=[],f=[],p=[],d=[];for(c=0;c<e.arrayArgs.length;++c){e.arrayBlockIndices[c]<0?(f.push(0),p.push(n),l.push(n),h.push(n+e.arrayBlockIndices[c])):(f.push(e.arrayBlockIndices[c]),p.push(e.arrayBlockIndices[c]+n),l.push(0),h.push(e.arrayBlockIndices[c]));for(var m=[],v=0;v<s[c].length;v++)f[c]<=s[c][v]&&s[c][v]<p[c]&&m.push(s[c][v]-f[c]);d.push(m)}var g=["SS"],y=["'use strict'"],b=[];for(v=0;v<n;++v)b.push(["s",v,"=SS[",v,"]"].join(""));for(c=0;c<e.arrayArgs.length;++c){g.push("a"+c),g.push("t"+c),g.push("p"+c);for(v=0;v<n;++v)b.push(["t",c,"p",v,"=t",c,"[",f[c]+v,"]"].join(""));for(v=0;v<Math.abs(e.arrayBlockIndices[c]);++v)b.push(["t",c,"b",v,"=t",c,"[",l[c]+v,"]"].join(""))}for(c=0;c<e.scalarArgs.length;++c)g.push("Y"+c);if(e.shapeArgs.length>0&&b.push("shape=SS.slice(0)"),e.indexArgs.length>0){var k=new Array(n);for(c=0;c<n;++c)k[c]="0";b.push(["index=[",k.join(","),"]"].join(""))}for(c=0;c<e.offsetArgs.length;++c){var x=e.offsetArgs[c],w=[];for(v=0;v<x.offset.length;++v)0!==x.offset[v]&&(1===x.offset[v]?w.push(["t",x.array,"p",v].join("")):w.push([x.offset[v],"*t",x.array,"p",v].join("")));0===w.length?b.push("q"+c+"=0"):b.push(["q",c,"=",w.join("+")].join(""))}var _=r([].concat(e.pre.thisVars).concat(e.body.thisVars).concat(e.post.thisVars));for((b=b.concat(_)).length>0&&y.push("var "+b.join(",")),c=0;c<e.arrayArgs.length;++c)y.push("p"+c+"|=0");e.pre.body.length>3&&y.push(i(e.pre,e,u));var S=i(e.body,e,u),C=function(e){for(var t=0,n=e[0].length;t<n;){for(var r=1;r<e.length;++r)if(e[r][t]!==e[0][t])return t;++t}return t}(d);C<n?y.push(function(e,t,n,r){for(var i=t.length,o=n.arrayArgs.length,s=n.blockSize,u=n.indexArgs.length>0,c=[],l=0;l<o;++l)c.push(["var offset",l,"=p",l].join(""));for(l=e;l<i;++l)c.push(["for(var j"+l+"=SS[",t[l],"]|0;j",l,">0;){"].join("")),c.push(["if(j",l,"<",s,"){"].join("")),c.push(["s",t[l],"=j",l].join("")),c.push(["j",l,"=0"].join("")),c.push(["}else{s",t[l],"=",s].join("")),c.push(["j",l,"-=",s,"}"].join("")),u&&c.push(["index[",t[l],"]=j",l].join(""));for(l=0;l<o;++l){for(var h=["offset"+l],f=e;f<i;++f)h.push(["j",f,"*t",l,"p",t[f]].join(""));c.push(["p",l,"=(",h.join("+"),")"].join(""))}for(c.push(a(t,n,r)),l=e;l<i;++l)c.push("}");return c.join("\n")}(C,d[0],e,S)):y.push(a(d[0],e,S)),e.post.body.length>3&&y.push(i(e.post,e,u)),e.debug&&console.log("-----Generated cwise routine for ",t,":\n"+y.join("\n")+"\n----------");var T=[e.funcName||"unnamed","_cwise_loop_",s[0].join("s"),"m",C,o(u)].join("");return new Function(["function ",T,"(",g.join(","),"){",y.join("\n"),"} return ",T].join(""))()}},6747:function(e,t,n){"use strict";var r=n(5154);e.exports=function(e){var t=["'use strict'","var CACHED={}"],n=[],a=e.funcName+"_cwise_thunk";t.push(["return function ",a,"(",e.shimArgs.join(","),"){"].join(""));for(var i=[],o=[],s=[["array",e.arrayArgs[0],".shape.slice(",Math.max(0,e.arrayBlockIndices[0]),e.arrayBlockIndices[0]<0?","+e.arrayBlockIndices[0]+")":")"].join("")],u=[],c=[],l=0;l<e.arrayArgs.length;++l){var h=e.arrayArgs[l];n.push(["t",h,"=array",h,".dtype,","r",h,"=array",h,".order"].join("")),i.push("t"+h),i.push("r"+h),o.push("t"+h),o.push("r"+h+".join()"),s.push("array"+h+".data"),s.push("array"+h+".stride"),s.push("array"+h+".offset|0"),l>0&&(u.push("array"+e.arrayArgs[0]+".shape.length===array"+h+".shape.length+"+(Math.abs(e.arrayBlockIndices[0])-Math.abs(e.arrayBlockIndices[l]))),c.push("array"+e.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[0])+"]===array"+h+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[l])+"]"))}for(e.arrayArgs.length>1&&(t.push("if (!("+u.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),t.push("for(var shapeIndex=array"+e.arrayArgs[0]+".shape.length-"+Math.abs(e.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {"),t.push("if (!("+c.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),t.push("}")),l=0;l<e.scalarArgs.length;++l)s.push("scalar"+e.scalarArgs[l]);return n.push(["type=[",o.join(","),"].join()"].join("")),n.push("proc=CACHED[type]"),t.push("var "+n.join(",")),t.push(["if(!proc){","CACHED[type]=proc=compile([",i.join(","),"])}","return proc(",s.join(","),")}"].join("")),e.debug&&console.log("-----Generated thunk:\n"+t.join("\n")+"\n----------"),new Function("compile",t.join("\n"))(r.bind(void 0,e))}},3546:function(e,t,n){"use strict";var r=n(1977),a=n(8871),i=0;function o(e,t,n){this.name=e,this.lvalue=t,this.rvalue=n,this.count=0}function s(e,t,n,r){this.body=e,this.args=t,this.thisVars=n,this.localVars=r}e.exports=function(e){for(var t=["(",e,")()"].join(""),u=r.parse(t,{range:!0}),c="_inline_"+i+++"_",l=function(e){for(var t=e.body[0].expression.callee.params,n=new Array(t.length),r=0;r<t.length;++r)n[r]=t[r].name;return n}(u),h=new Array(l.length),f=0;f<l.length;++f)h[f]=new o([c,"arg",f,"_"].join(""),!1,!1);for(var p=new Array(t.length),d=(f=0,t.length);f<d;++f)p[f]=t.charAt(f);var m,v=[],g=[];function y(e,t){for(var n=e.range[0],r=e.range[1],a=n+1;a<r;++a)p[a]="";p[n]=t}return function e(t,r){if(t.parent=r,"MemberExpression"===t.type)t.computed?(e(t.object,t),e(t.property,t)):"ThisExpression"===t.object.type?y(t,function(e){var t="this_"+e.replace(/\_/g,"__");return g.push(t),t}(t.property.name)):e(t.object,t);else{if("ThisExpression"===t.type)throw new Error("cwise-parser: Computed this is not allowed");if("Identifier"===t.type){var a=t.name,i=l.indexOf(a);if(i>=0){var o=h[i],s=function(e){return"AssignmentExpression"===e.parent.type&&e.parent.left===e?"="===e.parent.operator?1:3:"UpdateExpression"===e.parent.type?3:2}(t);1&s&&(o.lvalue=!0),2&s&&(o.rvalue=!0),++o.count,y(t,o.name)}else(function(e){if("eval"===e)throw new Error("cwise-parser: eval() not allowed");return"undefined"!==typeof window?e in window:"undefined"!==typeof n.g?e in n.g:"undefined"!==typeof self&&e in self})(a)||y(t,function(e){var t=c+e.replace(/\_/g,"__");return v.push(t),t}(a))}else if("Literal"===t.type)"string"===typeof t.value&&y(t,"'"+t.value.replace(/\_/g,"\\_").replace(/\'/g,"'")+"'");else{if("WithStatement"===t.type)throw new Error("cwise-parser: with() statements not allowed");for(var u=Object.keys(t),f=0,p=u.length;f<p;++f)if("parent"!==u[f]){var d=t[u[f]];if(d)if(d instanceof Array)for(var m=0;m<d.length;++m)d[m]&&"string"===typeof d[m].type&&e(d[m],t);else"string"===typeof d.type&&e(d,t)}}}}(u.body[0].expression.callee.body,void 0),a(v),a(g),new s((m=u.body[0].expression.callee.body,p.slice(m.range[0],m.range[1]).join("")),h,g,v)}},1977:function(e,t){var n,r,a;!function(i,o){"use strict";r=[t],n=function(e){var t,n,r,a,i,o,s,u,c,l,h,f,p,d,m,v,g,y;function b(e,t){if(!e)throw new Error("ASSERT: "+t)}function k(e){return e>=48&&e<=57}function x(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function w(e){return"01234567".indexOf(e)>=0}function _(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function S(e){return 10===e||13===e||8232===e||8233===e}function C(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&s.NonAsciiIdentifierStart.test(String.fromCharCode(e))}function T(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&s.NonAsciiIdentifierPart.test(String.fromCharCode(e))}function E(e){switch(e){case"class":case"enum":case"export":case"extends":case"import":case"super":return!0;default:return!1}}function I(e){switch(e){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"yield":case"let":return!0;default:return!1}}function A(e){return"eval"===e||"arguments"===e}function N(e){if(l&&I(e))return!0;switch(e.length){case 2:return"if"===e||"in"===e||"do"===e;case 3:return"var"===e||"for"===e||"new"===e||"try"===e||"let"===e;case 4:return"this"===e||"else"===e||"case"===e||"void"===e||"with"===e||"enum"===e;case 5:return"while"===e||"break"===e||"catch"===e||"throw"===e||"const"===e||"yield"===e||"class"===e||"super"===e;case 6:return"return"===e||"typeof"===e||"delete"===e||"switch"===e||"export"===e||"import"===e;case 7:return"default"===e||"finally"===e||"extends"===e;case 8:return"function"===e||"continue"===e||"debugger"===e;case 10:return"instanceof"===e;default:return!1}}function P(e,t,n,r,a){var i;b("number"===typeof n,"Comment must have valid position"),g.lastCommentStart>=n||(g.lastCommentStart=n,i={type:e,value:t},y.range&&(i.range=[n,r]),y.loc&&(i.loc=a),y.comments.push(i),y.attachComment&&(y.leadingComments.push(i),y.trailingComments.push(i)))}function M(e){var t,n,r,a;for(t=h-e,n={start:{line:f,column:h-p-e}};h<d;)if(r=c.charCodeAt(h),++h,S(r))return y.comments&&(a=c.slice(t+e,h-1),n.end={line:f,column:h-p-1},P("Line",a,t,h-1,n)),13===r&&10===c.charCodeAt(h)&&++h,++f,void(p=h);y.comments&&(a=c.slice(t+e,h),n.end={line:f,column:h-p},P("Line",a,t,h,n))}function D(){var e,t,n,r;for(y.comments&&(e=h-2,t={start:{line:f,column:h-p-2}});h<d;)if(S(n=c.charCodeAt(h)))13===n&&10===c.charCodeAt(h+1)&&++h,++f,++h,p=h,h>=d&&ie({},o.UnexpectedToken,"ILLEGAL");else if(42===n){if(47===c.charCodeAt(h+1))return++h,++h,void(y.comments&&(r=c.slice(e+2,h-2),t.end={line:f,column:h-p},P("Block",r,e,h,t)));++h}else++h;ie({},o.UnexpectedToken,"ILLEGAL")}function R(){var e,t;for(t=0===h;h<d;)if(_(e=c.charCodeAt(h)))++h;else if(S(e))++h,13===e&&10===c.charCodeAt(h)&&++h,++f,p=h,t=!0;else if(47===e)if(47===(e=c.charCodeAt(h+1)))++h,++h,M(2),t=!0;else{if(42!==e)break;++h,++h,D()}else if(t&&45===e){if(45!==c.charCodeAt(h+1)||62!==c.charCodeAt(h+2))break;h+=3,M(3)}else{if(60!==e)break;if("!--"!==c.slice(h+1,h+4))break;++h,++h,++h,++h,M(4)}}function O(e){var t,n,r,a=0;for(n="u"===e?4:2,t=0;t<n;++t){if(!(h<d&&x(c[h])))return"";r=c[h++],a=16*a+"0123456789abcdef".indexOf(r.toLowerCase())}return String.fromCharCode(a)}function F(){var e,t;for(e=c.charCodeAt(h++),t=String.fromCharCode(e),92===e&&(117!==c.charCodeAt(h)&&ie({},o.UnexpectedToken,"ILLEGAL"),++h,(e=O("u"))&&"\\"!==e&&C(e.charCodeAt(0))||ie({},o.UnexpectedToken,"ILLEGAL"),t=e);h<d&&T(e=c.charCodeAt(h));)++h,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==c.charCodeAt(h)&&ie({},o.UnexpectedToken,"ILLEGAL"),++h,(e=O("u"))&&"\\"!==e&&T(e.charCodeAt(0))||ie({},o.UnexpectedToken,"ILLEGAL"),t+=e);return t}function L(){var e,t;for(e=h++;h<d;){if(92===(t=c.charCodeAt(h)))return h=e,F();if(!T(t))break;++h}return c.slice(e,h)}function z(){var e,n;return e=h,{type:1===(n=92===c.charCodeAt(h)?F():L()).length?t.Identifier:N(n)?t.Keyword:"null"===n?t.NullLiteral:"true"===n||"false"===n?t.BooleanLiteral:t.Identifier,value:n,lineNumber:f,lineStart:p,start:e,end:h}}function B(){var e,n,r,a,i=h,s=c.charCodeAt(h),u=c[h];switch(s){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++h,y.tokenize&&(40===s?y.openParenToken=y.tokens.length:123===s&&(y.openCurlyToken=y.tokens.length)),{type:t.Punctuator,value:String.fromCharCode(s),lineNumber:f,lineStart:p,start:i,end:h};default:if(61===(e=c.charCodeAt(h+1)))switch(s){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return h+=2,{type:t.Punctuator,value:String.fromCharCode(s)+String.fromCharCode(e),lineNumber:f,lineStart:p,start:i,end:h};case 33:case 61:return h+=2,61===c.charCodeAt(h)&&++h,{type:t.Punctuator,value:c.slice(i,h),lineNumber:f,lineStart:p,start:i,end:h}}}return">>>="===(a=c.substr(h,4))?(h+=4,{type:t.Punctuator,value:a,lineNumber:f,lineStart:p,start:i,end:h}):">>>"===(r=a.substr(0,3))||"<<="===r||">>="===r?(h+=3,{type:t.Punctuator,value:r,lineNumber:f,lineStart:p,start:i,end:h}):u===(n=r.substr(0,2))[1]&&"+-<>&|".indexOf(u)>=0||"=>"===n?(h+=2,{type:t.Punctuator,value:n,lineNumber:f,lineStart:p,start:i,end:h}):"<>=!+-*%&|^/".indexOf(u)>=0?(++h,{type:t.Punctuator,value:u,lineNumber:f,lineStart:p,start:i,end:h}):void ie({},o.UnexpectedToken,"ILLEGAL")}function V(e){for(var n="";h<d&&x(c[h]);)n+=c[h++];return 0===n.length&&ie({},o.UnexpectedToken,"ILLEGAL"),C(c.charCodeAt(h))&&ie({},o.UnexpectedToken,"ILLEGAL"),{type:t.NumericLiteral,value:parseInt("0x"+n,16),lineNumber:f,lineStart:p,start:e,end:h}}function j(e){for(var n="0"+c[h++];h<d&&w(c[h]);)n+=c[h++];return(C(c.charCodeAt(h))||k(c.charCodeAt(h)))&&ie({},o.UnexpectedToken,"ILLEGAL"),{type:t.NumericLiteral,value:parseInt(n,8),octal:!0,lineNumber:f,lineStart:p,start:e,end:h}}function q(){var e,t;for(e=h+1;e<d;++e){if("8"===(t=c[e])||"9"===t)return!1;if(!w(t))return!0}return!0}function G(){var e,n,r;if(b(k((r=c[h]).charCodeAt(0))||"."===r,"Numeric literal must start with a decimal digit or a decimal point"),n=h,e="","."!==r){if(e=c[h++],r=c[h],"0"===e){if("x"===r||"X"===r)return++h,V(n);if(w(r)&&q())return j(n)}for(;k(c.charCodeAt(h));)e+=c[h++];r=c[h]}if("."===r){for(e+=c[h++];k(c.charCodeAt(h));)e+=c[h++];r=c[h]}if("e"===r||"E"===r)if(e+=c[h++],"+"!==(r=c[h])&&"-"!==r||(e+=c[h++]),k(c.charCodeAt(h)))for(;k(c.charCodeAt(h));)e+=c[h++];else ie({},o.UnexpectedToken,"ILLEGAL");return C(c.charCodeAt(h))&&ie({},o.UnexpectedToken,"ILLEGAL"),{type:t.NumericLiteral,value:parseFloat(e),lineNumber:f,lineStart:p,start:n,end:h}}function W(){var e,n,r,a,i,s,u,l,m="",v=!1;for(u=f,l=p,b("'"===(e=c[h])||'"'===e,"String literal must starts with a quote"),n=h,++h;h<d;){if((r=c[h++])===e){e="";break}if("\\"===r)if((r=c[h++])&&S(r.charCodeAt(0)))++f,"\r"===r&&"\n"===c[h]&&++h,p=h;else switch(r){case"u":case"x":s=h,(i=O(r))?m+=i:(h=s,m+=r);break;case"n":m+="\n";break;case"r":m+="\r";break;case"t":m+="\t";break;case"b":m+="\b";break;case"f":m+="\f";break;case"v":m+="\v";break;default:w(r)?(0!==(a="01234567".indexOf(r))&&(v=!0),h<d&&w(c[h])&&(v=!0,a=8*a+"01234567".indexOf(c[h++]),"0123".indexOf(r)>=0&&h<d&&w(c[h])&&(a=8*a+"01234567".indexOf(c[h++]))),m+=String.fromCharCode(a)):m+=r}else{if(S(r.charCodeAt(0)))break;m+=r}}return""!==e&&ie({},o.UnexpectedToken,"ILLEGAL"),{type:t.StringLiteral,value:m,octal:v,startLineNumber:u,startLineStart:l,lineNumber:f,lineStart:p,start:n,end:h}}function U(e,t){var n;try{n=new RegExp(e,t)}catch(r){ie({},o.InvalidRegExp)}return n}function H(){var e,t,n,r;for(b("/"===(e=c[h]),"Regular expression literal must start with a slash"),t=c[h++],n=!1,r=!1;h<d;)if(t+=e=c[h++],"\\"===e)S((e=c[h++]).charCodeAt(0))&&ie({},o.UnterminatedRegExp),t+=e;else if(S(e.charCodeAt(0)))ie({},o.UnterminatedRegExp);else if(n)"]"===e&&(n=!1);else{if("/"===e){r=!0;break}"["===e&&(n=!0)}return r||ie({},o.UnterminatedRegExp),{value:t.substr(1,t.length-2),literal:t}}function K(){var e,t,n,r;for(t="",n="";h<d&&T((e=c[h]).charCodeAt(0));)if(++h,"\\"===e&&h<d)if("u"===(e=c[h])){if(r=++h,e=O("u"))for(n+=e,t+="\\u";r<h;++r)t+=c[r];else h=r,n+="u",t+="\\u";oe({},o.UnexpectedToken,"ILLEGAL")}else t+="\\",oe({},o.UnexpectedToken,"ILLEGAL");else n+=e,t+=e;return{value:n,literal:t}}function X(){var e,n,r,a;return v=null,R(),e=h,n=H(),r=K(),a=U(n.value,r.value),y.tokenize?{type:t.RegularExpression,value:a,lineNumber:f,lineStart:p,start:e,end:h}:{literal:n.literal+r.literal,value:a,start:e,end:h}}function Y(){var e,t,n,r;return R(),e=h,t={start:{line:f,column:h-p}},n=X(),t.end={line:f,column:h-p},y.tokenize||(y.tokens.length>0&&(r=y.tokens[y.tokens.length-1]).range[0]===e&&"Punctuator"===r.type&&("/"!==r.value&&"/="!==r.value||y.tokens.pop()),y.tokens.push({type:"RegularExpression",value:n.literal,range:[e,h],loc:t})),n}function Q(e){return e.type===t.Identifier||e.type===t.Keyword||e.type===t.BooleanLiteral||e.type===t.NullLiteral}function $(){var e,t;if(!(e=y.tokens[y.tokens.length-1]))return Y();if("Punctuator"===e.type){if("]"===e.value)return B();if(")"===e.value)return!(t=y.tokens[y.openParenToken-1])||"Keyword"!==t.type||"if"!==t.value&&"while"!==t.value&&"for"!==t.value&&"with"!==t.value?B():Y();if("}"===e.value){if(y.tokens[y.openCurlyToken-3]&&"Keyword"===y.tokens[y.openCurlyToken-3].type){if(!(t=y.tokens[y.openCurlyToken-4]))return B()}else{if(!y.tokens[y.openCurlyToken-4]||"Keyword"!==y.tokens[y.openCurlyToken-4].type)return B();if(!(t=y.tokens[y.openCurlyToken-5]))return Y()}return r.indexOf(t.value)>=0?B():Y()}return Y()}return"Keyword"===e.type&&"this"!==e.value?Y():B()}function J(){var e;return R(),h>=d?{type:t.EOF,lineNumber:f,lineStart:p,start:h,end:h}:C(e=c.charCodeAt(h))?z():40===e||41===e||59===e?B():39===e||34===e?W():46===e?k(c.charCodeAt(h+1))?G():B():k(e)?G():y.tokenize&&47===e?$():B()}function Z(){var e,r,a;return R(),e={start:{line:f,column:h-p}},r=J(),e.end={line:f,column:h-p},r.type!==t.EOF&&(a=c.slice(r.start,r.end),y.tokens.push({type:n[r.type],value:a,range:[r.start,r.end],loc:e})),r}function ee(){var e;return h=(e=v).end,f=e.lineNumber,p=e.lineStart,v="undefined"!==typeof y.tokens?Z():J(),h=e.end,f=e.lineNumber,p=e.lineStart,e}function te(){var e,t,n;e=h,t=f,n=p,v="undefined"!==typeof y.tokens?Z():J(),h=e,f=t,p=n}function ne(e,t){this.line=e,this.column=t}function re(e,t,n,r){this.start=new ne(e,t),this.end=new ne(n,r)}function ae(){var e,t,n,r;return e=h,t=f,n=p,R(),r=f!==t,h=e,f=t,p=n,r}function ie(e,t){var n,r=Array.prototype.slice.call(arguments,2),a=t.replace(/%(\d)/g,(function(e,t){return b(t<r.length,"Message reference must be in range"),r[t]}));throw"number"===typeof e.lineNumber?((n=new Error("Line "+e.lineNumber+": "+a)).index=e.start,n.lineNumber=e.lineNumber,n.column=e.start-p+1):((n=new Error("Line "+f+": "+a)).index=h,n.lineNumber=f,n.column=h-p+1),n.description=a,n}function oe(){try{ie.apply(null,arguments)}catch(e){if(!y.errors)throw e;y.errors.push(e)}}function se(e){if(e.type===t.EOF&&ie(e,o.UnexpectedEOS),e.type===t.NumericLiteral&&ie(e,o.UnexpectedNumber),e.type===t.StringLiteral&&ie(e,o.UnexpectedString),e.type===t.Identifier&&ie(e,o.UnexpectedIdentifier),e.type===t.Keyword){if(E(e.value))ie(e,o.UnexpectedReserved);else if(l&&I(e.value))return void oe(e,o.StrictReservedWord);ie(e,o.UnexpectedToken,e.value)}ie(e,o.UnexpectedToken,e.value)}function ue(e){var n=ee();n.type===t.Punctuator&&n.value===e||se(n)}function ce(e){var n=ee();n.type===t.Keyword&&n.value===e||se(n)}function le(e){return v.type===t.Punctuator&&v.value===e}function he(e){return v.type===t.Keyword&&v.value===e}function fe(){var e;return v.type===t.Punctuator&&("="===(e=v.value)||"*="===e||"/="===e||"%="===e||"+="===e||"-="===e||"<<="===e||">>="===e||">>>="===e||"&="===e||"^="===e||"|="===e)}function pe(){var e,n=h,r=f,a=p,i=v;if(59===c.charCodeAt(h)||le(";"))ee();else{if(e=f,R(),f!==e)return h=n,f=r,p=a,void(v=i);v.type===t.EOF||le("}")||se(v)}}function de(e){return e.type===a.Identifier||e.type===a.MemberExpression}function me(){var e,t=[];for(e=v,ue("[");!le("]");)le(",")?(ee(),t.push(null)):(t.push(Re()),le("]")||ue(","));return ee(),m.markEnd(m.createArrayExpression(t),e)}function ve(e,t){var n,r,a;return n=l,a=v,r=st(),t&&l&&A(e[0].name)&&oe(t,o.StrictParamName),l=n,m.markEnd(m.createFunctionExpression(null,e,[],r),a)}function ge(){var e,n;return n=v,(e=ee()).type===t.StringLiteral||e.type===t.NumericLiteral?(l&&e.octal&&oe(e,o.StrictOctalLiteral),m.markEnd(m.createLiteral(e),n)):m.markEnd(m.createIdentifier(e.value),n)}function ye(){var e,n,r,a,i,s;return s=v,(e=v).type===t.Identifier?(r=ge(),"get"!==e.value||le(":")?"set"!==e.value||le(":")?(ue(":"),a=Re(),m.markEnd(m.createProperty("init",r,a),s)):(n=ge(),ue("("),(e=v).type!==t.Identifier?(ue(")"),oe(e,o.UnexpectedToken,e.value),a=ve([])):(i=[ze()],ue(")"),a=ve(i,e)),m.markEnd(m.createProperty("set",n,a),s)):(n=ge(),ue("("),ue(")"),a=ve([]),m.markEnd(m.createProperty("get",n,a),s))):e.type!==t.EOF&&e.type!==t.Punctuator?(n=ge(),ue(":"),a=Re(),m.markEnd(m.createProperty("init",n,a),s)):void se(e)}function be(){var e,t,n,r,s,u=[],c={},h=String;for(s=v,ue("{");!le("}");)t=(e=ye()).key.type===a.Identifier?e.key.name:h(e.key.value),r="init"===e.kind?i.Data:"get"===e.kind?i.Get:i.Set,n="$"+t,Object.prototype.hasOwnProperty.call(c,n)?(c[n]===i.Data?l&&r===i.Data?oe({},o.StrictDuplicateProperty):r!==i.Data&&oe({},o.AccessorDataProperty):r===i.Data?oe({},o.AccessorDataProperty):c[n]&r&&oe({},o.AccessorGetSet),c[n]|=r):c[n]=r,u.push(e),le("}")||ue(",");return ue("}"),m.markEnd(m.createObjectExpression(u),s)}function ke(){var e;return ue("("),e=Oe(),ue(")"),e}function xe(){var e,n,r,a;if(le("("))return ke();if(le("["))return me();if(le("{"))return be();if(e=v.type,a=v,e===t.Identifier)r=m.createIdentifier(ee().value);else if(e===t.StringLiteral||e===t.NumericLiteral)l&&v.octal&&oe(v,o.StrictOctalLiteral),r=m.createLiteral(ee());else if(e===t.Keyword){if(he("function"))return lt();he("this")?(ee(),r=m.createThisExpression()):se(ee())}else e===t.BooleanLiteral?((n=ee()).value="true"===n.value,r=m.createLiteral(n)):e===t.NullLiteral?((n=ee()).value=null,r=m.createLiteral(n)):le("/")||le("/=")?(r="undefined"!==typeof y.tokens?m.createLiteral(Y()):m.createLiteral(X()),te()):se(ee());return m.markEnd(r,a)}function we(){var e=[];if(ue("("),!le(")"))for(;h<d&&(e.push(Re()),!le(")"));)ue(",");return ue(")"),e}function _e(){var e,t;return t=v,Q(e=ee())||se(e),m.markEnd(m.createIdentifier(e.value),t)}function Se(){return ue("."),_e()}function Ce(){var e;return ue("["),e=Oe(),ue("]"),e}function Te(){var e,t,n;return n=v,ce("new"),e=Ie(),t=le("(")?we():[],m.markEnd(m.createNewExpression(e,t),n)}function Ee(){var e,t,n,r,a=g.allowIn;for(r=v,g.allowIn=!0,e=he("new")?Te():xe();;){if(le("."))n=Se(),e=m.createMemberExpression(".",e,n);else if(le("("))t=we(),e=m.createCallExpression(e,t);else{if(!le("["))break;n=Ce(),e=m.createMemberExpression("[",e,n)}m.markEnd(e,r)}return g.allowIn=a,e}function Ie(){var e,t,n;for(b(g.allowIn,"callee of new expression always allow in keyword."),n=v,e=he("new")?Te():xe();le(".")||le("[");)le("[")?(t=Ce(),e=m.createMemberExpression("[",e,t)):(t=Se(),e=m.createMemberExpression(".",e,t)),m.markEnd(e,n);return e}function Ae(){var e,n,r=v;return e=Ee(),v.type===t.Punctuator&&(!le("++")&&!le("--")||ae()||(l&&e.type===a.Identifier&&A(e.name)&&oe({},o.StrictLHSPostfix),de(e)||oe({},o.InvalidLHSInAssignment),n=ee(),e=m.markEnd(m.createPostfixExpression(n.value,e),r))),e}function Ne(){var e,n,r;return v.type!==t.Punctuator&&v.type!==t.Keyword?n=Ae():le("++")||le("--")?(r=v,e=ee(),n=Ne(),l&&n.type===a.Identifier&&A(n.name)&&oe({},o.StrictLHSPrefix),de(n)||oe({},o.InvalidLHSInAssignment),n=m.createUnaryExpression(e.value,n),n=m.markEnd(n,r)):le("+")||le("-")||le("~")||le("!")?(r=v,e=ee(),n=Ne(),n=m.createUnaryExpression(e.value,n),n=m.markEnd(n,r)):he("delete")||he("void")||he("typeof")?(r=v,e=ee(),n=Ne(),n=m.createUnaryExpression(e.value,n),n=m.markEnd(n,r),l&&"delete"===n.operator&&n.argument.type===a.Identifier&&oe({},o.StrictDelete)):n=Ae(),n}function Pe(e,n){var r=0;if(e.type!==t.Punctuator&&e.type!==t.Keyword)return 0;switch(e.value){case"||":r=1;break;case"&&":r=2;break;case"|":r=3;break;case"^":r=4;break;case"&":r=5;break;case"==":case"!=":case"===":case"!==":r=6;break;case"<":case">":case"<=":case">=":case"instanceof":r=7;break;case"in":r=n?7:0;break;case"<<":case">>":case">>>":r=8;break;case"+":case"-":r=9;break;case"*":case"/":case"%":r=11}return r}function Me(){var e,t,n,r,a,i,o,s,u,c;if(e=v,u=Ne(),0===(a=Pe(r=v,g.allowIn)))return u;for(r.prec=a,ee(),t=[e,v],i=[u,r,o=Ne()];(a=Pe(v,g.allowIn))>0;){for(;i.length>2&&a<=i[i.length-2].prec;)o=i.pop(),s=i.pop().value,u=i.pop(),n=m.createBinaryExpression(s,u,o),t.pop(),e=t[t.length-1],m.markEnd(n,e),i.push(n);(r=ee()).prec=a,i.push(r),t.push(v),n=Ne(),i.push(n)}for(n=i[c=i.length-1],t.pop();c>1;)n=m.createBinaryExpression(i[c-1].value,i[c-2],n),c-=2,e=t.pop(),m.markEnd(n,e);return n}function De(){var e,t,n,r,a;return a=v,e=Me(),le("?")&&(ee(),t=g.allowIn,g.allowIn=!0,n=Re(),g.allowIn=t,ue(":"),r=Re(),e=m.createConditionalExpression(e,n,r),m.markEnd(e,a)),e}function Re(){var e,t,n,r,i;return e=v,i=v,r=t=De(),fe()&&(de(t)||oe({},o.InvalidLHSInAssignment),l&&t.type===a.Identifier&&A(t.name)&&oe(e,o.StrictLHSAssignment),e=ee(),n=Re(),r=m.markEnd(m.createAssignmentExpression(e.value,t,n),i)),r}function Oe(){var e,t=v;if(e=Re(),le(",")){for(e=m.createSequenceExpression([e]);h<d&&le(",");)ee(),e.expressions.push(Re());m.markEnd(e,t)}return e}function Fe(){for(var e,t=[];h<d&&!le("}")&&"undefined"!==typeof(e=ht());)t.push(e);return t}function Le(){var e,t;return t=v,ue("{"),e=Fe(),ue("}"),m.markEnd(m.createBlockStatement(e),t)}function ze(){var e,n;return n=v,(e=ee()).type!==t.Identifier&&se(e),m.markEnd(m.createIdentifier(e.value),n)}function Be(e){var t,n,r=null;return n=v,t=ze(),l&&A(t.name)&&oe({},o.StrictVarName),"const"===e?(ue("="),r=Re()):le("=")&&(ee(),r=Re()),m.markEnd(m.createVariableDeclarator(t,r),n)}function Ve(e){var t=[];do{if(t.push(Be(e)),!le(","))break;ee()}while(h<d);return t}function je(){var e;return ce("var"),e=Ve(),pe(),m.createVariableDeclaration(e,"var")}function qe(e){var t,n;return n=v,ce(e),t=Ve(e),pe(),m.markEnd(m.createVariableDeclaration(t,e),n)}function Ge(){return ue(";"),m.createEmptyStatement()}function We(){var e=Oe();return pe(),m.createExpressionStatement(e)}function Ue(){var e,t,n;return ce("if"),ue("("),e=Oe(),ue(")"),t=ot(),he("else")?(ee(),n=ot()):n=null,m.createIfStatement(e,t,n)}function He(){var e,t,n;return ce("do"),n=g.inIteration,g.inIteration=!0,e=ot(),g.inIteration=n,ce("while"),ue("("),t=Oe(),ue(")"),le(";")&&ee(),m.createDoWhileStatement(e,t)}function Ke(){var e,t,n;return ce("while"),ue("("),e=Oe(),ue(")"),n=g.inIteration,g.inIteration=!0,t=ot(),g.inIteration=n,m.createWhileStatement(e,t)}function Xe(){var e,t,n;return n=v,e=ee(),t=Ve(),m.markEnd(m.createVariableDeclaration(t,e.value),n)}function Ye(){var e,t,n,r,a,i,s,u=g.allowIn;return e=t=n=null,ce("for"),ue("("),le(";")?ee():(he("var")||he("let")?(g.allowIn=!1,e=Xe(),g.allowIn=u,1===e.declarations.length&&he("in")&&(ee(),r=e,a=Oe(),e=null)):(g.allowIn=!1,e=Oe(),g.allowIn=u,he("in")&&(de(e)||oe({},o.InvalidLHSInForIn),ee(),r=e,a=Oe(),e=null)),"undefined"===typeof r&&ue(";")),"undefined"===typeof r&&(le(";")||(t=Oe()),ue(";"),le(")")||(n=Oe())),ue(")"),s=g.inIteration,g.inIteration=!0,i=ot(),g.inIteration=s,"undefined"===typeof r?m.createForStatement(e,t,n,i):m.createForInStatement(r,a,i)}function Qe(){var e,n=null;return ce("continue"),59===c.charCodeAt(h)?(ee(),g.inIteration||ie({},o.IllegalContinue),m.createContinueStatement(null)):ae()?(g.inIteration||ie({},o.IllegalContinue),m.createContinueStatement(null)):(v.type===t.Identifier&&(e="$"+(n=ze()).name,Object.prototype.hasOwnProperty.call(g.labelSet,e)||ie({},o.UnknownLabel,n.name)),pe(),null!==n||g.inIteration||ie({},o.IllegalContinue),m.createContinueStatement(n))}function $e(){var e,n=null;return ce("break"),59===c.charCodeAt(h)?(ee(),g.inIteration||g.inSwitch||ie({},o.IllegalBreak),m.createBreakStatement(null)):ae()?(g.inIteration||g.inSwitch||ie({},o.IllegalBreak),m.createBreakStatement(null)):(v.type===t.Identifier&&(e="$"+(n=ze()).name,Object.prototype.hasOwnProperty.call(g.labelSet,e)||ie({},o.UnknownLabel,n.name)),pe(),null!==n||g.inIteration||g.inSwitch||ie({},o.IllegalBreak),m.createBreakStatement(n))}function Je(){var e=null;return ce("return"),g.inFunctionBody||oe({},o.IllegalReturn),32===c.charCodeAt(h)&&C(c.charCodeAt(h+1))?(e=Oe(),pe(),m.createReturnStatement(e)):ae()?m.createReturnStatement(null):(le(";")||le("}")||v.type===t.EOF||(e=Oe()),pe(),m.createReturnStatement(e))}function Ze(){var e,t;return l&&(R(),oe({},o.StrictModeWith)),ce("with"),ue("("),e=Oe(),ue(")"),t=ot(),m.createWithStatement(e,t)}function et(){var e,t,n,r=[];for(n=v,he("default")?(ee(),e=null):(ce("case"),e=Oe()),ue(":");h<d&&!(le("}")||he("default")||he("case"));)t=ot(),r.push(t);return m.markEnd(m.createSwitchCase(e,r),n)}function tt(){var e,t,n,r,a;if(ce("switch"),ue("("),e=Oe(),ue(")"),ue("{"),t=[],le("}"))return ee(),m.createSwitchStatement(e,t);for(r=g.inSwitch,g.inSwitch=!0,a=!1;h<d&&!le("}");)null===(n=et()).test&&(a&&ie({},o.MultipleDefaultsInSwitch),a=!0),t.push(n);return g.inSwitch=r,ue("}"),m.createSwitchStatement(e,t)}function nt(){var e;return ce("throw"),ae()&&ie({},o.NewlineAfterThrow),e=Oe(),pe(),m.createThrowStatement(e)}function rt(){var e,t,n;return n=v,ce("catch"),ue("("),le(")")&&se(v),e=ze(),l&&A(e.name)&&oe({},o.StrictCatchVariable),ue(")"),t=Le(),m.markEnd(m.createCatchClause(e,t),n)}function at(){var e,t=[],n=null;return ce("try"),e=Le(),he("catch")&&t.push(rt()),he("finally")&&(ee(),n=Le()),0!==t.length||n||ie({},o.NoCatchOrFinally),m.createTryStatement(e,[],t,n)}function it(){return ce("debugger"),pe(),m.createDebuggerStatement()}function ot(){var e,n,r,i,s=v.type;if(s===t.EOF&&se(v),s===t.Punctuator&&"{"===v.value)return Le();if(i=v,s===t.Punctuator)switch(v.value){case";":return m.markEnd(Ge(),i);case"(":return m.markEnd(We(),i)}if(s===t.Keyword)switch(v.value){case"break":return m.markEnd($e(),i);case"continue":return m.markEnd(Qe(),i);case"debugger":return m.markEnd(it(),i);case"do":return m.markEnd(He(),i);case"for":return m.markEnd(Ye(),i);case"function":return m.markEnd(ct(),i);case"if":return m.markEnd(Ue(),i);case"return":return m.markEnd(Je(),i);case"switch":return m.markEnd(tt(),i);case"throw":return m.markEnd(nt(),i);case"try":return m.markEnd(at(),i);case"var":return m.markEnd(je(),i);case"while":return m.markEnd(Ke(),i);case"with":return m.markEnd(Ze(),i)}return(e=Oe()).type===a.Identifier&&le(":")?(ee(),r="$"+e.name,Object.prototype.hasOwnProperty.call(g.labelSet,r)&&ie({},o.Redeclaration,"Label",e.name),g.labelSet[r]=!0,n=ot(),delete g.labelSet[r],m.markEnd(m.createLabeledStatement(e,n),i)):(pe(),m.markEnd(m.createExpressionStatement(e),i))}function st(){var e,n,r,i,s,u,f,p,y=[];for(p=v,ue("{");h<d&&v.type===t.StringLiteral&&(n=v,e=ht(),y.push(e),e.expression.type===a.Literal);)"use strict"===c.slice(n.start+1,n.end-1)?(l=!0,r&&oe(r,o.StrictOctalLiteral)):!r&&n.octal&&(r=n);for(i=g.labelSet,s=g.inIteration,u=g.inSwitch,f=g.inFunctionBody,g.labelSet={},g.inIteration=!1,g.inSwitch=!1,g.inFunctionBody=!0;h<d&&!le("}")&&"undefined"!==typeof(e=ht());)y.push(e);return ue("}"),g.labelSet=i,g.inIteration=s,g.inSwitch=u,g.inFunctionBody=f,m.markEnd(m.createBlockStatement(y),p)}function ut(e){var t,n,r,a,i,s,u=[];if(ue("("),!le(")"))for(a={};h<d&&(n=v,t=ze(),i="$"+n.value,l?(A(n.value)&&(r=n,s=o.StrictParamName),Object.prototype.hasOwnProperty.call(a,i)&&(r=n,s=o.StrictParamDupe)):e||(A(n.value)?(e=n,s=o.StrictParamName):I(n.value)?(e=n,s=o.StrictReservedWord):Object.prototype.hasOwnProperty.call(a,i)&&(e=n,s=o.StrictParamDupe)),u.push(t),a[i]=!0,!le(")"));)ue(",");return ue(")"),{params:u,stricted:r,firstRestricted:e,message:s}}function ct(){var e,t,n,r,a,i,s,u,c,h=[];return c=v,ce("function"),n=v,e=ze(),l?A(n.value)&&oe(n,o.StrictFunctionName):A(n.value)?(i=n,s=o.StrictFunctionName):I(n.value)&&(i=n,s=o.StrictReservedWord),h=(a=ut(i)).params,r=a.stricted,i=a.firstRestricted,a.message&&(s=a.message),u=l,t=st(),l&&i&&ie(i,s),l&&r&&oe(r,s),l=u,m.markEnd(m.createFunctionDeclaration(e,h,[],t),c)}function lt(){var e,t,n,r,a,i,s,u,c=null,h=[];return u=v,ce("function"),le("(")||(e=v,c=ze(),l?A(e.value)&&oe(e,o.StrictFunctionName):A(e.value)?(n=e,r=o.StrictFunctionName):I(e.value)&&(n=e,r=o.StrictReservedWord)),h=(a=ut(n)).params,t=a.stricted,n=a.firstRestricted,a.message&&(r=a.message),s=l,i=st(),l&&n&&ie(n,r),l&&t&&oe(t,r),l=s,m.markEnd(m.createFunctionExpression(c,h,[],i),u)}function ht(){if(v.type===t.Keyword)switch(v.value){case"const":case"let":return qe(v.value);case"function":return ct();default:return ot()}if(v.type!==t.EOF)return ot()}function ft(){for(var e,n,r,i=[];h<d&&(n=v).type===t.StringLiteral&&(e=ht(),i.push(e),e.expression.type===a.Literal);)"use strict"===c.slice(n.start+1,n.end-1)?(l=!0,r&&oe(r,o.StrictOctalLiteral)):!r&&n.octal&&(r=n);for(;h<d&&"undefined"!==typeof(e=ht());)i.push(e);return i}function pt(){var e,t;return R(),te(),t=v,l=!1,e=ft(),m.markEnd(m.createProgram(e),t)}function dt(){var e,t,n,r=[];for(e=0;e<y.tokens.length;++e)n={type:(t=y.tokens[e]).type,value:t.value},y.range&&(n.range=t.range),y.loc&&(n.loc=t.loc),r.push(n);y.tokens=r}function mt(e,n){var r;"string"===typeof e||e instanceof String||(e=String(e)),m=u,h=0,f=(c=e).length>0?1:0,p=0,d=c.length,v=null,g={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},y={},(n=n||{}).tokens=!0,y.tokens=[],y.tokenize=!0,y.openParenToken=-1,y.openCurlyToken=-1,y.range="boolean"===typeof n.range&&n.range,y.loc="boolean"===typeof n.loc&&n.loc,"boolean"===typeof n.comment&&n.comment&&(y.comments=[]),"boolean"===typeof n.tolerant&&n.tolerant&&(y.errors=[]);try{if(te(),v.type===t.EOF)return y.tokens;for(ee();v.type!==t.EOF;)try{ee()}catch(a){if(v,y.errors){y.errors.push(a);break}throw a}dt(),r=y.tokens,"undefined"!==typeof y.comments&&(r.comments=y.comments),"undefined"!==typeof y.errors&&(r.errors=y.errors)}catch(i){throw i}finally{y={}}return r}function vt(e,t){var n,r;r=String,"string"===typeof e||e instanceof String||(e=r(e)),m=u,h=0,f=(c=e).length>0?1:0,p=0,d=c.length,v=null,g={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},y={},"undefined"!==typeof t&&(y.range="boolean"===typeof t.range&&t.range,y.loc="boolean"===typeof t.loc&&t.loc,y.attachComment="boolean"===typeof t.attachComment&&t.attachComment,y.loc&&null!==t.source&&void 0!==t.source&&(y.source=r(t.source)),"boolean"===typeof t.tokens&&t.tokens&&(y.tokens=[]),"boolean"===typeof t.comment&&t.comment&&(y.comments=[]),"boolean"===typeof t.tolerant&&t.tolerant&&(y.errors=[]),y.attachComment&&(y.range=!0,y.comments=[],y.bottomRightStack=[],y.trailingComments=[],y.leadingComments=[]));try{n=pt(),"undefined"!==typeof y.comments&&(n.comments=y.comments),"undefined"!==typeof y.tokens&&(dt(),n.tokens=y.tokens),"undefined"!==typeof y.errors&&(n.errors=y.errors)}catch(a){throw a}finally{y={}}return n}(n={})[(t={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9}).BooleanLiteral]="Boolean",n[t.EOF]="<end>",n[t.Identifier]="Identifier",n[t.Keyword]="Keyword",n[t.NullLiteral]="Null",n[t.NumericLiteral]="Numeric",n[t.Punctuator]="Punctuator",n[t.StringLiteral]="String",n[t.RegularExpression]="RegularExpression",r=["(","{","[","in","typeof","instanceof","new","return","case","delete","throw","void","=","+=","-=","*=","/=","%=","<<=",">>=",">>>=","&=","|=","^=",",","+","-","*","/","%","++","--","<<",">>",">>>","&","|","^","!","~","&&","||","?",":","===","==",">=","<=","<",">","!=","!=="],a={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement"},i={Data:1,Get:2,Set:4},o={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode"},s={NonAsciiIdentifierStart:new RegExp("[\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0\u08a2-\u08ac\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f0\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191c\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua697\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua793\ua7a0-\ua7aa\ua7f8-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa80-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]"),NonAsciiIdentifierPart:new RegExp("[\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0300-\u0374\u0376\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u0483-\u0487\u048a-\u0527\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u05d0-\u05ea\u05f0-\u05f2\u0610-\u061a\u0620-\u0669\u066e-\u06d3\u06d5-\u06dc\u06df-\u06e8\u06ea-\u06fc\u06ff\u0710-\u074a\u074d-\u07b1\u07c0-\u07f5\u07fa\u0800-\u082d\u0840-\u085b\u08a0\u08a2-\u08ac\u08e4-\u08fe\u0900-\u0963\u0966-\u096f\u0971-\u0977\u0979-\u097f\u0981-\u0983\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bc-\u09c4\u09c7\u09c8\u09cb-\u09ce\u09d7\u09dc\u09dd\u09df-\u09e3\u09e6-\u09f1\u0a01-\u0a03\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a59-\u0a5c\u0a5e\u0a66-\u0a75\u0a81-\u0a83\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abc-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ad0\u0ae0-\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3c-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b5c\u0b5d\u0b5f-\u0b63\u0b66-\u0b6f\u0b71\u0b82\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd0\u0bd7\u0be6-\u0bef\u0c01-\u0c03\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c58\u0c59\u0c60-\u0c63\u0c66-\u0c6f\u0c82\u0c83\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbc-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0cde\u0ce0-\u0ce3\u0ce6-\u0cef\u0cf1\u0cf2\u0d02\u0d03\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d-\u0d44\u0d46-\u0d48\u0d4a-\u0d4e\u0d57\u0d60-\u0d63\u0d66-\u0d6f\u0d7a-\u0d7f\u0d82\u0d83\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0df2\u0df3\u0e01-\u0e3a\u0e40-\u0e4e\u0e50-\u0e59\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb9\u0ebb-\u0ebd\u0ec0-\u0ec4\u0ec6\u0ec8-\u0ecd\u0ed0-\u0ed9\u0edc-\u0edf\u0f00\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e-\u0f47\u0f49-\u0f6c\u0f71-\u0f84\u0f86-\u0f97\u0f99-\u0fbc\u0fc6\u1000-\u1049\u1050-\u109d\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u135d-\u135f\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f0\u1700-\u170c\u170e-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176c\u176e-\u1770\u1772\u1773\u1780-\u17d3\u17d7\u17dc\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u1820-\u1877\u1880-\u18aa\u18b0-\u18f5\u1900-\u191c\u1920-\u192b\u1930-\u193b\u1946-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c9\u19d0-\u19d9\u1a00-\u1a1b\u1a20-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1aa7\u1b00-\u1b4b\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1bf3\u1c00-\u1c37\u1c40-\u1c49\u1c4d-\u1c7d\u1cd0-\u1cd2\u1cd4-\u1cf6\u1d00-\u1de6\u1dfc-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u200c\u200d\u203f\u2040\u2054\u2071\u207f\u2090-\u209c\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d7f-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2de0-\u2dff\u2e2f\u3005-\u3007\u3021-\u302f\u3031-\u3035\u3038-\u303c\u3041-\u3096\u3099\u309a\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua62b\ua640-\ua66f\ua674-\ua67d\ua67f-\ua697\ua69f-\ua6f1\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua793\ua7a0-\ua7aa\ua7f8-\ua827\ua840-\ua873\ua880-\ua8c4\ua8d0-\ua8d9\ua8e0-\ua8f7\ua8fb\ua900-\ua92d\ua930-\ua953\ua960-\ua97c\ua980-\ua9c0\ua9cf-\ua9d9\uaa00-\uaa36\uaa40-\uaa4d\uaa50-\uaa59\uaa60-\uaa76\uaa7a\uaa7b\uaa80-\uaac2\uaadb-\uaadd\uaae0-\uaaef\uaaf2-\uaaf6\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uabc0-\uabea\uabec\uabed\uabf0-\uabf9\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe00-\ufe0f\ufe20-\ufe26\ufe33\ufe34\ufe4d-\ufe4f\ufe70-\ufe74\ufe76-\ufefc\uff10-\uff19\uff21-\uff3a\uff3f\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]")},u={name:"SyntaxTree",processComment:function(e){var t,n;if(!(e.type===a.Program&&e.body.length>0)){for(y.trailingComments.length>0?y.trailingComments[0].range[0]>=e.range[1]?(n=y.trailingComments,y.trailingComments=[]):y.trailingComments.length=0:y.bottomRightStack.length>0&&y.bottomRightStack[y.bottomRightStack.length-1].trailingComments&&y.bottomRightStack[y.bottomRightStack.length-1].trailingComments[0].range[0]>=e.range[1]&&(n=y.bottomRightStack[y.bottomRightStack.length-1].trailingComments,delete y.bottomRightStack[y.bottomRightStack.length-1].trailingComments);y.bottomRightStack.length>0&&y.bottomRightStack[y.bottomRightStack.length-1].range[0]>=e.range[0];)t=y.bottomRightStack.pop();t?t.leadingComments&&t.leadingComments[t.leadingComments.length-1].range[1]<=e.range[0]&&(e.leadingComments=t.leadingComments,delete t.leadingComments):y.leadingComments.length>0&&y.leadingComments[y.leadingComments.length-1].range[1]<=e.range[0]&&(e.leadingComments=y.leadingComments,y.leadingComments=[]),n&&(e.trailingComments=n),y.bottomRightStack.push(e)}},markEnd:function(e,t){return y.range&&(e.range=[t.start,h]),y.loc&&(e.loc=new re(void 0===t.startLineNumber?t.lineNumber:t.startLineNumber,t.start-(void 0===t.startLineStart?t.lineStart:t.startLineStart),f,h-p),this.postProcess(e)),y.attachComment&&this.processComment(e),e},postProcess:function(e){return y.source&&(e.loc.source=y.source),e},createArrayExpression:function(e){return{type:a.ArrayExpression,elements:e}},createAssignmentExpression:function(e,t,n){return{type:a.AssignmentExpression,operator:e,left:t,right:n}},createBinaryExpression:function(e,t,n){return{type:"||"===e||"&&"===e?a.LogicalExpression:a.BinaryExpression,operator:e,left:t,right:n}},createBlockStatement:function(e){return{type:a.BlockStatement,body:e}},createBreakStatement:function(e){return{type:a.BreakStatement,label:e}},createCallExpression:function(e,t){return{type:a.CallExpression,callee:e,arguments:t}},createCatchClause:function(e,t){return{type:a.CatchClause,param:e,body:t}},createConditionalExpression:function(e,t,n){return{type:a.ConditionalExpression,test:e,consequent:t,alternate:n}},createContinueStatement:function(e){return{type:a.ContinueStatement,label:e}},createDebuggerStatement:function(){return{type:a.DebuggerStatement}},createDoWhileStatement:function(e,t){return{type:a.DoWhileStatement,body:e,test:t}},createEmptyStatement:function(){return{type:a.EmptyStatement}},createExpressionStatement:function(e){return{type:a.ExpressionStatement,expression:e}},createForStatement:function(e,t,n,r){return{type:a.ForStatement,init:e,test:t,update:n,body:r}},createForInStatement:function(e,t,n){return{type:a.ForInStatement,left:e,right:t,body:n,each:!1}},createFunctionDeclaration:function(e,t,n,r){return{type:a.FunctionDeclaration,id:e,params:t,defaults:n,body:r,rest:null,generator:!1,expression:!1}},createFunctionExpression:function(e,t,n,r){return{type:a.FunctionExpression,id:e,params:t,defaults:n,body:r,rest:null,generator:!1,expression:!1}},createIdentifier:function(e){return{type:a.Identifier,name:e}},createIfStatement:function(e,t,n){return{type:a.IfStatement,test:e,consequent:t,alternate:n}},createLabeledStatement:function(e,t){return{type:a.LabeledStatement,label:e,body:t}},createLiteral:function(e){return{type:a.Literal,value:e.value,raw:c.slice(e.start,e.end)}},createMemberExpression:function(e,t,n){return{type:a.MemberExpression,computed:"["===e,object:t,property:n}},createNewExpression:function(e,t){return{type:a.NewExpression,callee:e,arguments:t}},createObjectExpression:function(e){return{type:a.ObjectExpression,properties:e}},createPostfixExpression:function(e,t){return{type:a.UpdateExpression,operator:e,argument:t,prefix:!1}},createProgram:function(e){return{type:a.Program,body:e}},createProperty:function(e,t,n){return{type:a.Property,key:t,value:n,kind:e}},createReturnStatement:function(e){return{type:a.ReturnStatement,argument:e}},createSequenceExpression:function(e){return{type:a.SequenceExpression,expressions:e}},createSwitchCase:function(e,t){return{type:a.SwitchCase,test:e,consequent:t}},createSwitchStatement:function(e,t){return{type:a.SwitchStatement,discriminant:e,cases:t}},createThisExpression:function(){return{type:a.ThisExpression}},createThrowStatement:function(e){return{type:a.ThrowStatement,argument:e}},createTryStatement:function(e,t,n,r){return{type:a.TryStatement,block:e,guardedHandlers:t,handlers:n,finalizer:r}},createUnaryExpression:function(e,t){return"++"===e||"--"===e?{type:a.UpdateExpression,operator:e,argument:t,prefix:!0}:{type:a.UnaryExpression,operator:e,argument:t,prefix:!0}},createVariableDeclaration:function(e,t){return{type:a.VariableDeclaration,declarations:e,kind:t}},createVariableDeclarator:function(e,t){return{type:a.VariableDeclarator,id:e,init:t}},createWhileStatement:function(e,t){return{type:a.WhileStatement,test:e,body:t}},createWithStatement:function(e,t){return{type:a.WithStatement,object:e,body:t}}},e.version="1.2.5",e.tokenize=mt,e.parse=vt,e.Syntax=function(){var e,t={};for(e in"function"===typeof Object.create&&(t=Object.create(null)),a)a.hasOwnProperty(e)&&(t[e]=a[e]);return"function"===typeof Object.freeze&&Object.freeze(t),t}()},void 0===(a="function"===typeof n?n.apply(t,r):n)||(e.exports=a)}()},3675:function(e,t,n){"use strict";var r=n(3546),a=n(7549),i=["args","body"],o=["pre","post","printCode","funcName","blockSize"];e.exports=function(e){for(var t in e)i.indexOf(t)<0&&o.indexOf(t)<0&&console.warn("cwise: Unknown argument '"+t+"' passed to expression compiler");for(var n=0;n<i.length;++n)if(!e[i[n]])throw new Error("cwise: Missing argument: "+i[n]);return a({args:e.args,pre:r(e.pre||function(){}),body:r(e.body),post:r(e.post||function(){}),debug:!!e.printCode,funcName:e.funcName||e.body.name||"cwise",blockSize:e.blockSize||64})}},8287:function(e){"use strict";function t(e,n,r){var a=0|e[r];if(a<=0)return[];var i,o=new Array(a);if(r===e.length-1)for(i=0;i<a;++i)o[i]=n;else for(i=0;i<a;++i)o[i]=t(e,n,r+1);return o}e.exports=function(e,n){switch("undefined"===typeof n&&(n=0),typeof e){case"number":if(e>0)return function(e,t){var n,r;for(n=new Array(e),r=0;r<e;++r)n[r]=t;return n}(0|e,n);break;case"object":if("number"===typeof e.length)return t(e,n,0)}return[]}},567:function(e){"use strict";function t(e){if(this.size=0|e,this.size<=1||0!==(this.size&this.size-1))throw new Error("FFT size must be a power of two and bigger than 1");this._csize=e<<1;for(var t=new Array(2*this.size),n=0;n<t.length;n+=2){var r=Math.PI*n/this.size;t[n]=Math.cos(r),t[n+1]=-Math.sin(r)}this.table=t;for(var a=0,i=1;this.size>i;i<<=1)a++;this._width=a%2===0?a-1:a,this._bitrev=new Array(1<<this._width);for(var o=0;o<this._bitrev.length;o++){this._bitrev[o]=0;for(var s=0;s<this._width;s+=2){var u=this._width-s-2;this._bitrev[o]|=(o>>>s&3)<<u}}this._out=null,this._data=null,this._inv=0}e.exports=t,t.prototype.fromComplexArray=function(e,t){for(var n=t||new Array(e.length>>>1),r=0;r<e.length;r+=2)n[r>>>1]=e[r];return n},t.prototype.createComplexArray=function(){for(var e=new Array(this._csize),t=0;t<e.length;t++)e[t]=0;return e},t.prototype.toComplexArray=function(e,t){for(var n=t||this.createComplexArray(),r=0;r<n.length;r+=2)n[r]=e[r>>>1],n[r+1]=0;return n},t.prototype.completeSpectrum=function(e){for(var t=this._csize,n=t>>>1,r=2;r<n;r+=2)e[t-r]=e[r],e[t-r+1]=-e[r+1]},t.prototype.transform=function(e,t){if(e===t)throw new Error("Input and output buffers must be different");this._out=e,this._data=t,this._inv=0,this._transform4(),this._out=null,this._data=null},t.prototype.realTransform=function(e,t){if(e===t)throw new Error("Input and output buffers must be different");this._out=e,this._data=t,this._inv=0,this._realTransform4(),this._out=null,this._data=null},t.prototype.inverseTransform=function(e,t){if(e===t)throw new Error("Input and output buffers must be different");this._out=e,this._data=t,this._inv=1,this._transform4();for(var n=0;n<e.length;n++)e[n]/=this.size;this._out=null,this._data=null},t.prototype._transform4=function(){var e,t,n=this._out,r=this._csize,a=1<<this._width,i=r/a<<1,o=this._bitrev;if(4===i)for(e=0,t=0;e<r;e+=i,t++){var s=o[t];this._singleTransform2(e,s,a)}else for(e=0,t=0;e<r;e+=i,t++){var u=o[t];this._singleTransform4(e,u,a)}var c=this._inv?-1:1,l=this.table;for(a>>=2;a>=2;a>>=2){var h=(i=r/a<<1)>>>2;for(e=0;e<r;e+=i)for(var f=e+h,p=e,d=0;p<f;p+=2,d+=a){var m=p,v=m+h,g=v+h,y=g+h,b=n[m],k=n[m+1],x=n[v],w=n[v+1],_=n[g],S=n[g+1],C=n[y],T=n[y+1],E=b,I=k,A=l[d],N=c*l[d+1],P=x*A-w*N,M=x*N+w*A,D=l[2*d],R=c*l[2*d+1],O=_*D-S*R,F=_*R+S*D,L=l[3*d],z=c*l[3*d+1],B=C*L-T*z,V=C*z+T*L,j=E+O,q=I+F,G=E-O,W=I-F,U=P+B,H=M+V,K=c*(P-B),X=c*(M-V),Y=j+U,Q=q+H,$=j-U,J=q-H,Z=G+X,ee=W-K,te=G-X,ne=W+K;n[m]=Y,n[m+1]=Q,n[v]=Z,n[v+1]=ee,n[g]=$,n[g+1]=J,n[y]=te,n[y+1]=ne}}},t.prototype._singleTransform2=function(e,t,n){var r=this._out,a=this._data,i=a[t],o=a[t+1],s=a[t+n],u=a[t+n+1],c=i+s,l=o+u,h=i-s,f=o-u;r[e]=c,r[e+1]=l,r[e+2]=h,r[e+3]=f},t.prototype._singleTransform4=function(e,t,n){var r=this._out,a=this._data,i=this._inv?-1:1,o=2*n,s=3*n,u=a[t],c=a[t+1],l=a[t+n],h=a[t+n+1],f=a[t+o],p=a[t+o+1],d=a[t+s],m=a[t+s+1],v=u+f,g=c+p,y=u-f,b=c-p,k=l+d,x=h+m,w=i*(l-d),_=i*(h-m),S=v+k,C=g+x,T=y+_,E=b-w,I=v-k,A=g-x,N=y-_,P=b+w;r[e]=S,r[e+1]=C,r[e+2]=T,r[e+3]=E,r[e+4]=I,r[e+5]=A,r[e+6]=N,r[e+7]=P},t.prototype._realTransform4=function(){var e,t,n=this._out,r=this._csize,a=1<<this._width,i=r/a<<1,o=this._bitrev;if(4===i)for(e=0,t=0;e<r;e+=i,t++){var s=o[t];this._singleRealTransform2(e,s>>>1,a>>>1)}else for(e=0,t=0;e<r;e+=i,t++){var u=o[t];this._singleRealTransform4(e,u>>>1,a>>>1)}var c=this._inv?-1:1,l=this.table;for(a>>=2;a>=2;a>>=2){var h=(i=r/a<<1)>>>1,f=h>>>1,p=f>>>1;for(e=0;e<r;e+=i)for(var d=0,m=0;d<=p;d+=2,m+=a){var v=e+d,g=v+f,y=g+f,b=y+f,k=n[v],x=n[v+1],w=n[g],_=n[g+1],S=n[y],C=n[y+1],T=n[b],E=n[b+1],I=k,A=x,N=l[m],P=c*l[m+1],M=w*N-_*P,D=w*P+_*N,R=l[2*m],O=c*l[2*m+1],F=S*R-C*O,L=S*O+C*R,z=l[3*m],B=c*l[3*m+1],V=T*z-E*B,j=T*B+E*z,q=I+F,G=A+L,W=I-F,U=A-L,H=M+V,K=D+j,X=c*(M-V),Y=c*(D-j),Q=q+H,$=G+K,J=W+Y,Z=U-X;if(n[v]=Q,n[v+1]=$,n[g]=J,n[g+1]=Z,0!==d){if(d!==p){var ee=W+-c*Y,te=-U+-c*X,ne=q+-c*H,re=-G- -c*K,ae=e+f-d,ie=e+h-d;n[ae]=ee,n[ae+1]=te,n[ie]=ne,n[ie+1]=re}}else{var oe=q-H,se=G-K;n[y]=oe,n[y+1]=se}}}},t.prototype._singleRealTransform2=function(e,t,n){var r=this._out,a=this._data,i=a[t],o=a[t+n],s=i+o,u=i-o;r[e]=s,r[e+1]=0,r[e+2]=u,r[e+3]=0},t.prototype._singleRealTransform4=function(e,t,n){var r=this._out,a=this._data,i=this._inv?-1:1,o=2*n,s=3*n,u=a[t],c=a[t+n],l=a[t+o],h=a[t+s],f=u+l,p=u-l,d=c+h,m=i*(c-h),v=f+d,g=p,y=-m,b=f-d,k=p,x=m;r[e]=v,r[e+1]=0,r[e+2]=g,r[e+3]=y,r[e+4]=b,r[e+5]=0,r[e+6]=k,r[e+7]=x}},6380:function(e,t,n){var r,a=a||function(e){"use strict";if(!("undefined"===typeof e||"undefined"!==typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var t=e.document,n=function(){return e.URL||e.webkitURL||e},r=t.createElementNS("http://www.w3.org/1999/xhtml","a"),a="download"in r,i=/constructor/i.test(e.HTMLElement),o=/CriOS\/[\d]+/.test(navigator.userAgent),s=function(t){(e.setImmediate||e.setTimeout)((function(){throw t}),0)},u=function(e){setTimeout((function(){"string"===typeof e?n().revokeObjectURL(e):e.remove()}),4e4)},c=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},l=function(t,l,h){h||(t=c(t));var f,p=this,d="application/octet-stream"===t.type,m=function(){!function(e,t,n){for(var r=(t=[].concat(t)).length;r--;){var a=e["on"+t[r]];if("function"===typeof a)try{a.call(e,n||e)}catch(i){s(i)}}}(p,"writestart progress write writeend".split(" "))};if(p.readyState=p.INIT,a)return f=n().createObjectURL(t),void setTimeout((function(){r.href=f,r.download=l,function(e){var t=new MouseEvent("click");e.dispatchEvent(t)}(r),m(),u(f),p.readyState=p.DONE}));!function(){if((o||d&&i)&&e.FileReader){var r=new FileReader;return r.onloadend=function(){var t=o?r.result:r.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(t,"_blank")||(e.location.href=t),t=void 0,p.readyState=p.DONE,m()},r.readAsDataURL(t),void(p.readyState=p.INIT)}(f||(f=n().createObjectURL(t)),d)?e.location.href=f:e.open(f,"_blank")||(e.location.href=f);p.readyState=p.DONE,m(),u(f)}()},h=l.prototype;return"undefined"!==typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,n){return t=t||e.name||"download",n||(e=c(e)),navigator.msSaveOrOpenBlob(e,t)}:(h.abort=function(){},h.readyState=h.INIT=0,h.WRITING=1,h.DONE=2,h.error=h.onwritestart=h.onprogress=h.onwrite=h.onabort=h.onerror=h.onwriteend=null,function(e,t,n){return new l(e,t||e.name||"download",n)})}}("undefined"!==typeof self&&self||"undefined"!==typeof window&&window||this.content);e.exports?e.exports.saveAs=a:null!==n.amdD&&null!==n.amdO&&(void 0===(r=function(){return a}.apply(t,[]))||(e.exports=r))},2110:function(e,t,n){"use strict";var r=n(8309),a={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function u(e){return r.isMemo(e)?o:s[e.$$typeof]||a}s[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[r.Memo]=o;var c=Object.defineProperty,l=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,f=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,d=Object.prototype;e.exports=function e(t,n,r){if("string"!==typeof n){if(d){var a=p(n);a&&a!==d&&e(t,a,r)}var o=l(n);h&&(o=o.concat(h(n)));for(var s=u(t),m=u(n),v=0;v<o.length;++v){var g=o[v];if(!i[g]&&(!r||!r[g])&&(!m||!m[g])&&(!s||!s[g])){var y=f(n,g);try{c(t,g,y)}catch(b){}}}}return t}},746:function(e,t){"use strict";var n="function"===typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,a=n?Symbol.for("react.portal"):60106,i=n?Symbol.for("react.fragment"):60107,o=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,u=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,l=n?Symbol.for("react.async_mode"):60111,h=n?Symbol.for("react.concurrent_mode"):60111,f=n?Symbol.for("react.forward_ref"):60112,p=n?Symbol.for("react.suspense"):60113,d=n?Symbol.for("react.suspense_list"):60120,m=n?Symbol.for("react.memo"):60115,v=n?Symbol.for("react.lazy"):60116,g=n?Symbol.for("react.block"):60121,y=n?Symbol.for("react.fundamental"):60117,b=n?Symbol.for("react.responder"):60118,k=n?Symbol.for("react.scope"):60119;function x(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case l:case h:case i:case s:case o:case p:return e;default:switch(e=e&&e.$$typeof){case c:case f:case v:case m:case u:return e;default:return t}}case a:return t}}}function w(e){return x(e)===h}t.AsyncMode=l,t.ConcurrentMode=h,t.ContextConsumer=c,t.ContextProvider=u,t.Element=r,t.ForwardRef=f,t.Fragment=i,t.Lazy=v,t.Memo=m,t.Portal=a,t.Profiler=s,t.StrictMode=o,t.Suspense=p,t.isAsyncMode=function(e){return w(e)||x(e)===l},t.isConcurrentMode=w,t.isContextConsumer=function(e){return x(e)===c},t.isContextProvider=function(e){return x(e)===u},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return x(e)===f},t.isFragment=function(e){return x(e)===i},t.isLazy=function(e){return x(e)===v},t.isMemo=function(e){return x(e)===m},t.isPortal=function(e){return x(e)===a},t.isProfiler=function(e){return x(e)===s},t.isStrictMode=function(e){return x(e)===o},t.isSuspense=function(e){return x(e)===p},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===i||e===h||e===s||e===o||e===p||e===d||"object"===typeof e&&null!==e&&(e.$$typeof===v||e.$$typeof===m||e.$$typeof===u||e.$$typeof===c||e.$$typeof===f||e.$$typeof===y||e.$$typeof===b||e.$$typeof===k||e.$$typeof===g)},t.typeOf=x},8309:function(e,t,n){"use strict";e.exports=n(746)},4038:function(e,t){t.read=function(e,t,n,r,a){var i,o,s=8*a-r-1,u=(1<<s)-1,c=u>>1,l=-7,h=n?a-1:0,f=n?-1:1,p=e[t+h];for(h+=f,i=p&(1<<-l)-1,p>>=-l,l+=s;l>0;i=256*i+e[t+h],h+=f,l-=8);for(o=i&(1<<-l)-1,i>>=-l,l+=r;l>0;o=256*o+e[t+h],h+=f,l-=8);if(0===i)i=1-c;else{if(i===u)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,r),i-=c}return(p?-1:1)*o*Math.pow(2,i-r)},t.write=function(e,t,n,r,a,i){var o,s,u,c=8*i-a-1,l=(1<<c)-1,h=l>>1,f=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,d=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=l):(o=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-o))<1&&(o--,u*=2),(t+=o+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(o++,u/=2),o+h>=l?(s=0,o=l):o+h>=1?(s=(t*u-1)*Math.pow(2,a),o+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,a),o=0));a>=8;e[n+p]=255&s,p+=d,s/=256,a-=8);for(o=o<<a|s,c+=a;c>0;e[n+p]=255&o,p+=d,o/=256,c-=8);e[n+p-d]|=128*m}},9897:function(e){"use strict";e.exports=function(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=n;return t}},5586:function(e){function t(e){return!!e.constructor&&"function"===typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}e.exports=function(e){return null!=e&&(t(e)||function(e){return"function"===typeof e.readFloatLE&&"function"===typeof e.slice&&t(e.slice(0,0))}(e)||!!e._isBuffer)}},7625:function(module,exports,__webpack_require__){var factory;"undefined"!==typeof navigator&&(factory=function(){"use strict";var svgNS="http://www.w3.org/2000/svg",locationHref="",_useWebWorker=!1,initialDefaultFrame=-999999,setWebWorker=function(e){_useWebWorker=!!e},getWebWorker=function(){return _useWebWorker},setLocationHref=function(e){locationHref=e},getLocationHref=function(){return locationHref};function createTag(e){return document.createElement(e)}function extendPrototype(e,t){var n,r,a=e.length;for(n=0;n<a;n+=1)for(var i in r=e[n].prototype)Object.prototype.hasOwnProperty.call(r,i)&&(t.prototype[i]=r[i])}function getDescriptor(e,t){return Object.getOwnPropertyDescriptor(e,t)}function createProxyFunction(e){function t(){}return t.prototype=e,t}var audioControllerFactory=function(){function e(e){this.audios=[],this.audioFactory=e,this._volume=1,this._isMuted=!1}return e.prototype={addAudio:function(e){this.audios.push(e)},pause:function(){var e,t=this.audios.length;for(e=0;e<t;e+=1)this.audios[e].pause()},resume:function(){var e,t=this.audios.length;for(e=0;e<t;e+=1)this.audios[e].resume()},setRate:function(e){var t,n=this.audios.length;for(t=0;t<n;t+=1)this.audios[t].setRate(e)},createAudio:function(e){return this.audioFactory?this.audioFactory(e):window.Howl?new window.Howl({src:[e]}):{isPlaying:!1,play:function(){this.isPlaying=!0},seek:function(){this.isPlaying=!1},playing:function(){},rate:function(){},setVolume:function(){}}},setAudioFactory:function(e){this.audioFactory=e},setVolume:function(e){this._volume=e,this._updateVolume()},mute:function(){this._isMuted=!0,this._updateVolume()},unmute:function(){this._isMuted=!1,this._updateVolume()},getVolume:function(){return this._volume},_updateVolume:function(){var e,t=this.audios.length;for(e=0;e<t;e+=1)this.audios[e].volume(this._volume*(this._isMuted?0:1))}},function(){return new e}}(),createTypedArray=function(){function e(e,t){var n,r=0,a=[];switch(e){case"int16":case"uint8c":n=1;break;default:n=1.1}for(r=0;r<t;r+=1)a.push(n);return a}return"function"===typeof Uint8ClampedArray&&"function"===typeof Float32Array?function(t,n){return"float32"===t?new Float32Array(n):"int16"===t?new Int16Array(n):"uint8c"===t?new Uint8ClampedArray(n):e(t,n)}:e}();function createSizedArray(e){return Array.apply(null,{length:e})}function _typeof$6(e){return _typeof$6="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof$6(e)}var subframeEnabled=!0,expressionsPlugin=null,idPrefix$1="",isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),_shouldRoundValues=!1,bmPow=Math.pow,bmSqrt=Math.sqrt,bmFloor=Math.floor,bmMax=Math.max,bmMin=Math.min,BMMath={};function ProjectInterface$1(){return{}}!function(){var e,t=["abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","cbrt","expm1","clz32","cos","cosh","exp","floor","fround","hypot","imul","log","log1p","log2","log10","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh","trunc","E","LN10","LN2","LOG10E","LOG2E","PI","SQRT1_2","SQRT2"],n=t.length;for(e=0;e<n;e+=1)BMMath[t[e]]=Math[t[e]]}(),BMMath.random=Math.random,BMMath.abs=function(e){if("object"===_typeof$6(e)&&e.length){var t,n=createSizedArray(e.length),r=e.length;for(t=0;t<r;t+=1)n[t]=Math.abs(e[t]);return n}return Math.abs(e)};var defaultCurveSegments=150,degToRads=Math.PI/180,roundCorner=.5519;function roundValues(e){_shouldRoundValues=!!e}function bmRnd(e){return _shouldRoundValues?Math.round(e):e}function styleDiv(e){e.style.position="absolute",e.style.top=0,e.style.left=0,e.style.display="block",e.style.transformOrigin="0 0",e.style.webkitTransformOrigin="0 0",e.style.backfaceVisibility="visible",e.style.webkitBackfaceVisibility="visible",e.style.transformStyle="preserve-3d",e.style.webkitTransformStyle="preserve-3d",e.style.mozTransformStyle="preserve-3d"}function BMEnterFrameEvent(e,t,n,r){this.type=e,this.currentTime=t,this.totalTime=n,this.direction=r<0?-1:1}function BMCompleteEvent(e,t){this.type=e,this.direction=t<0?-1:1}function BMCompleteLoopEvent(e,t,n,r){this.type=e,this.currentLoop=n,this.totalLoops=t,this.direction=r<0?-1:1}function BMSegmentStartEvent(e,t,n){this.type=e,this.firstFrame=t,this.totalFrames=n}function BMDestroyEvent(e,t){this.type=e,this.target=t}function BMRenderFrameErrorEvent(e,t){this.type="renderFrameError",this.nativeError=e,this.currentTime=t}function BMConfigErrorEvent(e){this.type="configError",this.nativeError=e}function BMAnimationConfigErrorEvent(e,t){this.type=e,this.nativeError=t}var createElementID=function(){var e=0;return function(){return idPrefix$1+"__lottie_element_"+(e+=1)}}();function HSVtoRGB(e,t,n){var r,a,i,o,s,u,c,l;switch(u=n*(1-t),c=n*(1-(s=6*e-(o=Math.floor(6*e)))*t),l=n*(1-(1-s)*t),o%6){case 0:r=n,a=l,i=u;break;case 1:r=c,a=n,i=u;break;case 2:r=u,a=n,i=l;break;case 3:r=u,a=c,i=n;break;case 4:r=l,a=u,i=n;break;case 5:r=n,a=u,i=c}return[r,a,i]}function RGBtoHSV(e,t,n){var r,a=Math.max(e,t,n),i=Math.min(e,t,n),o=a-i,s=0===a?0:o/a,u=a/255;switch(a){case i:r=0;break;case e:r=t-n+o*(t<n?6:0),r/=6*o;break;case t:r=n-e+2*o,r/=6*o;break;case n:r=e-t+4*o,r/=6*o}return[r,s,u]}function addSaturationToRGB(e,t){var n=RGBtoHSV(255*e[0],255*e[1],255*e[2]);return n[1]+=t,n[1]>1?n[1]=1:n[1]<=0&&(n[1]=0),HSVtoRGB(n[0],n[1],n[2])}function addBrightnessToRGB(e,t){var n=RGBtoHSV(255*e[0],255*e[1],255*e[2]);return n[2]+=t,n[2]>1?n[2]=1:n[2]<0&&(n[2]=0),HSVtoRGB(n[0],n[1],n[2])}function addHueToRGB(e,t){var n=RGBtoHSV(255*e[0],255*e[1],255*e[2]);return n[0]+=t/360,n[0]>1?n[0]-=1:n[0]<0&&(n[0]+=1),HSVtoRGB(n[0],n[1],n[2])}var rgbToHex=function(){var e,t,n=[];for(e=0;e<256;e+=1)t=e.toString(16),n[e]=1===t.length?"0"+t:t;return function(e,t,r){return e<0&&(e=0),t<0&&(t=0),r<0&&(r=0),"#"+n[e]+n[t]+n[r]}}(),setSubframeEnabled=function(e){subframeEnabled=!!e},getSubframeEnabled=function(){return subframeEnabled},setExpressionsPlugin=function(e){expressionsPlugin=e},getExpressionsPlugin=function(){return expressionsPlugin},setDefaultCurveSegments=function(e){defaultCurveSegments=e},getDefaultCurveSegments=function(){return defaultCurveSegments},setIdPrefix=function(e){idPrefix$1=e},getIdPrefix=function(){return idPrefix$1};function createNS(e){return document.createElementNS(svgNS,e)}function _typeof$5(e){return _typeof$5="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof$5(e)}var dataManager=function(){var e,t,n=1,r=[],a={onmessage:function(){},postMessage:function(t){e({data:t})}},i={postMessage:function(e){a.onmessage({data:e})}};function o(){t||(t=function(t){if(window.Worker&&window.Blob&&getWebWorker()){var n=new Blob(["var _workerSelf = self; self.onmessage = ",t.toString()],{type:"text/javascript"}),r=URL.createObjectURL(n);return new Worker(r)}return e=t,a}((function(e){if(i.dataManager||(i.dataManager=function(){function e(a,i){var o,s,u,c,h,f,p=a.length;for(s=0;s<p;s+=1)if("ks"in(o=a[s])&&!o.completed){if(o.completed=!0,o.tt&&(a[s-1].td=o.tt),o.hasMask){var d=o.masksProperties;for(c=d.length,u=0;u<c;u+=1)if(d[u].pt.k.i)r(d[u].pt.k);else for(f=d[u].pt.k.length,h=0;h<f;h+=1)d[u].pt.k[h].s&&r(d[u].pt.k[h].s[0]),d[u].pt.k[h].e&&r(d[u].pt.k[h].e[0])}0===o.ty?(o.layers=t(o.refId,i),e(o.layers,i)):4===o.ty?n(o.shapes):5===o.ty&&l(o)}}function t(e,t){var n=function(e,t){for(var n=0,r=t.length;n<r;){if(t[n].id===e)return t[n];n+=1}return null}(e,t);return n?n.layers.__used?JSON.parse(JSON.stringify(n.layers)):(n.layers.__used=!0,n.layers):null}function n(e){var t,a,i;for(t=e.length-1;t>=0;t-=1)if("sh"===e[t].ty)if(e[t].ks.k.i)r(e[t].ks.k);else for(i=e[t].ks.k.length,a=0;a<i;a+=1)e[t].ks.k[a].s&&r(e[t].ks.k[a].s[0]),e[t].ks.k[a].e&&r(e[t].ks.k[a].e[0]);else"gr"===e[t].ty&&n(e[t].it)}function r(e){var t,n=e.i.length;for(t=0;t<n;t+=1)e.i[t][0]+=e.v[t][0],e.i[t][1]+=e.v[t][1],e.o[t][0]+=e.v[t][0],e.o[t][1]+=e.v[t][1]}function a(e,t){var n=t?t.split("."):[100,100,100];return e[0]>n[0]||!(n[0]>e[0])&&(e[1]>n[1]||!(n[1]>e[1])&&(e[2]>n[2]||!(n[2]>e[2])&&null))}var i=function(){var e=[4,4,14];function t(e){var t=e.t.d;e.t.d={k:[{s:t,t:0}]}}function n(e){var n,r=e.length;for(n=0;n<r;n+=1)5===e[n].ty&&t(e[n])}return function(t){if(a(e,t.v)&&(n(t.layers),t.assets)){var r,i=t.assets.length;for(r=0;r<i;r+=1)t.assets[r].layers&&n(t.assets[r].layers)}}}(),o=function(){var e=[4,7,99];return function(t){if(t.chars&&!a(e,t.v)){var r,i=t.chars.length;for(r=0;r<i;r+=1){var o=t.chars[r];o.data&&o.data.shapes&&(n(o.data.shapes),o.data.ip=0,o.data.op=99999,o.data.st=0,o.data.sr=1,o.data.ks={p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0}},t.chars[r].t||(o.data.shapes.push({ty:"no"}),o.data.shapes[0].it.push({p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0},sk:{k:0,a:0},sa:{k:0,a:0},ty:"tr"})))}}}}(),s=function(){var e=[5,7,15];function t(e){var t=e.t.p;"number"===typeof t.a&&(t.a={a:0,k:t.a}),"number"===typeof t.p&&(t.p={a:0,k:t.p}),"number"===typeof t.r&&(t.r={a:0,k:t.r})}function n(e){var n,r=e.length;for(n=0;n<r;n+=1)5===e[n].ty&&t(e[n])}return function(t){if(a(e,t.v)&&(n(t.layers),t.assets)){var r,i=t.assets.length;for(r=0;r<i;r+=1)t.assets[r].layers&&n(t.assets[r].layers)}}}(),u=function(){var e=[4,1,9];function t(e){var n,r,a,i=e.length;for(n=0;n<i;n+=1)if("gr"===e[n].ty)t(e[n].it);else if("fl"===e[n].ty||"st"===e[n].ty)if(e[n].c.k&&e[n].c.k[0].i)for(a=e[n].c.k.length,r=0;r<a;r+=1)e[n].c.k[r].s&&(e[n].c.k[r].s[0]/=255,e[n].c.k[r].s[1]/=255,e[n].c.k[r].s[2]/=255,e[n].c.k[r].s[3]/=255),e[n].c.k[r].e&&(e[n].c.k[r].e[0]/=255,e[n].c.k[r].e[1]/=255,e[n].c.k[r].e[2]/=255,e[n].c.k[r].e[3]/=255);else e[n].c.k[0]/=255,e[n].c.k[1]/=255,e[n].c.k[2]/=255,e[n].c.k[3]/=255}function n(e){var n,r=e.length;for(n=0;n<r;n+=1)4===e[n].ty&&t(e[n].shapes)}return function(t){if(a(e,t.v)&&(n(t.layers),t.assets)){var r,i=t.assets.length;for(r=0;r<i;r+=1)t.assets[r].layers&&n(t.assets[r].layers)}}}(),c=function(){var e=[4,4,18];function t(e){var n,r,a;for(n=e.length-1;n>=0;n-=1)if("sh"===e[n].ty)if(e[n].ks.k.i)e[n].ks.k.c=e[n].closed;else for(a=e[n].ks.k.length,r=0;r<a;r+=1)e[n].ks.k[r].s&&(e[n].ks.k[r].s[0].c=e[n].closed),e[n].ks.k[r].e&&(e[n].ks.k[r].e[0].c=e[n].closed);else"gr"===e[n].ty&&t(e[n].it)}function n(e){var n,r,a,i,o,s,u=e.length;for(r=0;r<u;r+=1){if((n=e[r]).hasMask){var c=n.masksProperties;for(i=c.length,a=0;a<i;a+=1)if(c[a].pt.k.i)c[a].pt.k.c=c[a].cl;else for(s=c[a].pt.k.length,o=0;o<s;o+=1)c[a].pt.k[o].s&&(c[a].pt.k[o].s[0].c=c[a].cl),c[a].pt.k[o].e&&(c[a].pt.k[o].e[0].c=c[a].cl)}4===n.ty&&t(n.shapes)}}return function(t){if(a(e,t.v)&&(n(t.layers),t.assets)){var r,i=t.assets.length;for(r=0;r<i;r+=1)t.assets[r].layers&&n(t.assets[r].layers)}}}();function l(e){0===e.t.a.length&&e.t.p}var h={completeData:function(n){n.__complete||(u(n),i(n),o(n),s(n),c(n),e(n.layers,n.assets),function(n,r){if(n){var a=0,i=n.length;for(a=0;a<i;a+=1)1===n[a].t&&(n[a].data.layers=t(n[a].data.refId,r),e(n[a].data.layers,r))}}(n.chars,n.assets),n.__complete=!0)}};return h.checkColors=u,h.checkChars=o,h.checkPathProperties=s,h.checkShapes=c,h.completeLayers=e,h}()),i.assetLoader||(i.assetLoader=function(){function e(e){var t=e.getResponseHeader("content-type");return t&&"json"===e.responseType&&-1!==t.indexOf("json")||e.response&&"object"===_typeof$5(e.response)?e.response:e.response&&"string"===typeof e.response?JSON.parse(e.response):e.responseText?JSON.parse(e.responseText):null}return{load:function(t,n,r,a){var i,o=new XMLHttpRequest;try{o.responseType="json"}catch(s){}o.onreadystatechange=function(){if(4===o.readyState)if(200===o.status)i=e(o),r(i);else try{i=e(o),r(i)}catch(s){a&&a(s)}};try{o.open("GET",t,!0)}catch(u){o.open("GET",n+"/"+t,!0)}o.send()}}}()),"loadAnimation"===e.data.type)i.assetLoader.load(e.data.path,e.data.fullPath,(function(t){i.dataManager.completeData(t),i.postMessage({id:e.data.id,payload:t,status:"success"})}),(function(){i.postMessage({id:e.data.id,status:"error"})}));else if("complete"===e.data.type){var t=e.data.animation;i.dataManager.completeData(t),i.postMessage({id:e.data.id,payload:t,status:"success"})}else"loadData"===e.data.type&&i.assetLoader.load(e.data.path,e.data.fullPath,(function(t){i.postMessage({id:e.data.id,payload:t,status:"success"})}),(function(){i.postMessage({id:e.data.id,status:"error"})}))})),t.onmessage=function(e){var t=e.data,n=t.id,a=r[n];r[n]=null,"success"===t.status?a.onComplete(t.payload):a.onError&&a.onError()})}function s(e,t){var a="processId_"+(n+=1);return r[a]={onComplete:e,onError:t},a}return{loadAnimation:function(e,n,r){o();var a=s(n,r);t.postMessage({type:"loadAnimation",path:e,fullPath:window.location.origin+window.location.pathname,id:a})},loadData:function(e,n,r){o();var a=s(n,r);t.postMessage({type:"loadData",path:e,fullPath:window.location.origin+window.location.pathname,id:a})},completeAnimation:function(e,n,r){o();var a=s(n,r);t.postMessage({type:"complete",animation:e,id:a})}}}(),ImagePreloader=function(){var e=function(){var e=createTag("canvas");e.width=1,e.height=1;var t=e.getContext("2d");return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),e}();function t(){this.loadedAssets+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function n(){this.loadedFootagesCount+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function r(e,t,n){var r="";if(e.e)r=e.p;else if(t){var a=e.p;-1!==a.indexOf("images/")&&(a=a.split("/")[1]),r=t+a}else r=n,r+=e.u?e.u:"",r+=e.p;return r}function a(e){var t=0,n=setInterval(function(){(e.getBBox().width||t>500)&&(this._imageLoaded(),clearInterval(n)),t+=1}.bind(this),50)}function i(e){var t={assetData:e},n=r(e,this.assetsPath,this.path);return dataManager.loadData(n,function(e){t.img=e,this._footageLoaded()}.bind(this),function(){t.img={},this._footageLoaded()}.bind(this)),t}function o(){this._imageLoaded=t.bind(this),this._footageLoaded=n.bind(this),this.testImageLoaded=a.bind(this),this.createFootageData=i.bind(this),this.assetsPath="",this.path="",this.totalImages=0,this.totalFootages=0,this.loadedAssets=0,this.loadedFootagesCount=0,this.imagesLoadedCb=null,this.images=[]}return o.prototype={loadAssets:function(e,t){var n;this.imagesLoadedCb=t;var r=e.length;for(n=0;n<r;n+=1)e[n].layers||(e[n].t&&"seq"!==e[n].t?3===e[n].t&&(this.totalFootages+=1,this.images.push(this.createFootageData(e[n]))):(this.totalImages+=1,this.images.push(this._createImageData(e[n]))))},setAssetsPath:function(e){this.assetsPath=e||""},setPath:function(e){this.path=e||""},loadedImages:function(){return this.totalImages===this.loadedAssets},loadedFootages:function(){return this.totalFootages===this.loadedFootagesCount},destroy:function(){this.imagesLoadedCb=null,this.images.length=0},getAsset:function(e){for(var t=0,n=this.images.length;t<n;){if(this.images[t].assetData===e)return this.images[t].img;t+=1}return null},createImgData:function(t){var n=r(t,this.assetsPath,this.path),a=createTag("img");a.crossOrigin="anonymous",a.addEventListener("load",this._imageLoaded,!1),a.addEventListener("error",function(){i.img=e,this._imageLoaded()}.bind(this),!1),a.src=n;var i={img:a,assetData:t};return i},createImageData:function(t){var n=r(t,this.assetsPath,this.path),a=createNS("image");isSafari?this.testImageLoaded(a):a.addEventListener("load",this._imageLoaded,!1),a.addEventListener("error",function(){i.img=e,this._imageLoaded()}.bind(this),!1),a.setAttributeNS("http://www.w3.org/1999/xlink","href",n),this._elementHelper.append?this._elementHelper.append(a):this._elementHelper.appendChild(a);var i={img:a,assetData:t};return i},imageLoaded:t,footageLoaded:n,setCacheType:function(e,t){"svg"===e?(this._elementHelper=t,this._createImageData=this.createImageData.bind(this)):this._createImageData=this.createImgData.bind(this)}},o}();function BaseEvent(){}BaseEvent.prototype={triggerEvent:function(e,t){if(this._cbs[e])for(var n=this._cbs[e],r=0;r<n.length;r+=1)n[r](t)},addEventListener:function(e,t){return this._cbs[e]||(this._cbs[e]=[]),this._cbs[e].push(t),function(){this.removeEventListener(e,t)}.bind(this)},removeEventListener:function(e,t){if(t){if(this._cbs[e]){for(var n=0,r=this._cbs[e].length;n<r;)this._cbs[e][n]===t&&(this._cbs[e].splice(n,1),n-=1,r-=1),n+=1;this._cbs[e].length||(this._cbs[e]=null)}}else this._cbs[e]=null}};var markerParser=function(){function e(e){for(var t,n=e.split("\r\n"),r={},a=0,i=0;i<n.length;i+=1)2===(t=n[i].split(":")).length&&(r[t[0]]=t[1].trim(),a+=1);if(0===a)throw new Error;return r}return function(t){for(var n=[],r=0;r<t.length;r+=1){var a=t[r],i={time:a.tm,duration:a.dr};try{i.payload=JSON.parse(t[r].cm)}catch(o){try{i.payload=e(t[r].cm)}catch(s){i.payload={name:t[r].cm}}}n.push(i)}return n}}(),ProjectInterface=function(){function e(e){this.compositions.push(e)}return function(){function t(e){for(var t=0,n=this.compositions.length;t<n;){if(this.compositions[t].data&&this.compositions[t].data.nm===e)return this.compositions[t].prepareFrame&&this.compositions[t].data.xt&&this.compositions[t].prepareFrame(this.currentFrame),this.compositions[t].compInterface;t+=1}return null}return t.compositions=[],t.currentFrame=0,t.registerComposition=e,t}}(),renderers={},registerRenderer=function(e,t){renderers[e]=t};function getRenderer(e){return renderers[e]}function _typeof$4(e){return _typeof$4="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof$4(e)}var AnimationItem=function(){this._cbs=[],this.name="",this.path="",this.isLoaded=!1,this.currentFrame=0,this.currentRawFrame=0,this.firstFrame=0,this.totalFrames=0,this.frameRate=0,this.frameMult=0,this.playSpeed=1,this.playDirection=1,this.playCount=0,this.animationData={},this.assets=[],this.isPaused=!0,this.autoplay=!1,this.loop=!0,this.renderer=null,this.animationID=createElementID(),this.assetsPath="",this.timeCompleted=0,this.segmentPos=0,this.isSubframeEnabled=getSubframeEnabled(),this.segments=[],this._idle=!0,this._completedLoop=!1,this.projectInterface=ProjectInterface(),this.imagePreloader=new ImagePreloader,this.audioController=audioControllerFactory(),this.markers=[],this.configAnimation=this.configAnimation.bind(this),this.onSetupError=this.onSetupError.bind(this),this.onSegmentComplete=this.onSegmentComplete.bind(this),this.drawnFrameEvent=new BMEnterFrameEvent("drawnFrame",0,0,0)};extendPrototype([BaseEvent],AnimationItem),AnimationItem.prototype.setParams=function(e){(e.wrapper||e.container)&&(this.wrapper=e.wrapper||e.container);var t="svg";e.animType?t=e.animType:e.renderer&&(t=e.renderer);var n=getRenderer(t);this.renderer=new n(this,e.rendererSettings),this.imagePreloader.setCacheType(t,this.renderer.globalData.defs),this.renderer.setProjectInterface(this.projectInterface),this.animType=t,""===e.loop||null===e.loop||void 0===e.loop||!0===e.loop?this.loop=!0:!1===e.loop?this.loop=!1:this.loop=parseInt(e.loop,10),this.autoplay=!("autoplay"in e)||e.autoplay,this.name=e.name?e.name:"",this.autoloadSegments=!Object.prototype.hasOwnProperty.call(e,"autoloadSegments")||e.autoloadSegments,this.assetsPath=e.assetsPath,this.initialSegment=e.initialSegment,e.audioFactory&&this.audioController.setAudioFactory(e.audioFactory),e.animationData?this.setupAnimation(e.animationData):e.path&&(-1!==e.path.lastIndexOf("\\")?this.path=e.path.substr(0,e.path.lastIndexOf("\\")+1):this.path=e.path.substr(0,e.path.lastIndexOf("/")+1),this.fileName=e.path.substr(e.path.lastIndexOf("/")+1),this.fileName=this.fileName.substr(0,this.fileName.lastIndexOf(".json")),dataManager.loadAnimation(e.path,this.configAnimation,this.onSetupError))},AnimationItem.prototype.onSetupError=function(){this.trigger("data_failed")},AnimationItem.prototype.setupAnimation=function(e){dataManager.completeAnimation(e,this.configAnimation)},AnimationItem.prototype.setData=function(e,t){t&&"object"!==_typeof$4(t)&&(t=JSON.parse(t));var n={wrapper:e,animationData:t},r=e.attributes;n.path=r.getNamedItem("data-animation-path")?r.getNamedItem("data-animation-path").value:r.getNamedItem("data-bm-path")?r.getNamedItem("data-bm-path").value:r.getNamedItem("bm-path")?r.getNamedItem("bm-path").value:"",n.animType=r.getNamedItem("data-anim-type")?r.getNamedItem("data-anim-type").value:r.getNamedItem("data-bm-type")?r.getNamedItem("data-bm-type").value:r.getNamedItem("bm-type")?r.getNamedItem("bm-type").value:r.getNamedItem("data-bm-renderer")?r.getNamedItem("data-bm-renderer").value:r.getNamedItem("bm-renderer")?r.getNamedItem("bm-renderer").value:"canvas";var a=r.getNamedItem("data-anim-loop")?r.getNamedItem("data-anim-loop").value:r.getNamedItem("data-bm-loop")?r.getNamedItem("data-bm-loop").value:r.getNamedItem("bm-loop")?r.getNamedItem("bm-loop").value:"";"false"===a?n.loop=!1:"true"===a?n.loop=!0:""!==a&&(n.loop=parseInt(a,10));var i=r.getNamedItem("data-anim-autoplay")?r.getNamedItem("data-anim-autoplay").value:r.getNamedItem("data-bm-autoplay")?r.getNamedItem("data-bm-autoplay").value:!r.getNamedItem("bm-autoplay")||r.getNamedItem("bm-autoplay").value;n.autoplay="false"!==i,n.name=r.getNamedItem("data-name")?r.getNamedItem("data-name").value:r.getNamedItem("data-bm-name")?r.getNamedItem("data-bm-name").value:r.getNamedItem("bm-name")?r.getNamedItem("bm-name").value:"","false"===(r.getNamedItem("data-anim-prerender")?r.getNamedItem("data-anim-prerender").value:r.getNamedItem("data-bm-prerender")?r.getNamedItem("data-bm-prerender").value:r.getNamedItem("bm-prerender")?r.getNamedItem("bm-prerender").value:"")&&(n.prerender=!1),this.setParams(n)},AnimationItem.prototype.includeLayers=function(e){e.op>this.animationData.op&&(this.animationData.op=e.op,this.totalFrames=Math.floor(e.op-this.animationData.ip));var t,n,r=this.animationData.layers,a=r.length,i=e.layers,o=i.length;for(n=0;n<o;n+=1)for(t=0;t<a;){if(r[t].id===i[n].id){r[t]=i[n];break}t+=1}if((e.chars||e.fonts)&&(this.renderer.globalData.fontManager.addChars(e.chars),this.renderer.globalData.fontManager.addFonts(e.fonts,this.renderer.globalData.defs)),e.assets)for(a=e.assets.length,t=0;t<a;t+=1)this.animationData.assets.push(e.assets[t]);this.animationData.__complete=!1,dataManager.completeAnimation(this.animationData,this.onSegmentComplete)},AnimationItem.prototype.onSegmentComplete=function(e){this.animationData=e;var t=getExpressionsPlugin();t&&t.initExpressions(this),this.loadNextSegment()},AnimationItem.prototype.loadNextSegment=function(){var e=this.animationData.segments;if(!e||0===e.length||!this.autoloadSegments)return this.trigger("data_ready"),void(this.timeCompleted=this.totalFrames);var t=e.shift();this.timeCompleted=t.time*this.frameRate;var n=this.path+this.fileName+"_"+this.segmentPos+".json";this.segmentPos+=1,dataManager.loadData(n,this.includeLayers.bind(this),function(){this.trigger("data_failed")}.bind(this))},AnimationItem.prototype.loadSegments=function(){this.animationData.segments||(this.timeCompleted=this.totalFrames),this.loadNextSegment()},AnimationItem.prototype.imagesLoaded=function(){this.trigger("loaded_images"),this.checkLoaded()},AnimationItem.prototype.preloadImages=function(){this.imagePreloader.setAssetsPath(this.assetsPath),this.imagePreloader.setPath(this.path),this.imagePreloader.loadAssets(this.animationData.assets,this.imagesLoaded.bind(this))},AnimationItem.prototype.configAnimation=function(e){if(this.renderer)try{this.animationData=e,this.initialSegment?(this.totalFrames=Math.floor(this.initialSegment[1]-this.initialSegment[0]),this.firstFrame=Math.round(this.initialSegment[0])):(this.totalFrames=Math.floor(this.animationData.op-this.animationData.ip),this.firstFrame=Math.round(this.animationData.ip)),this.renderer.configAnimation(e),e.assets||(e.assets=[]),this.assets=this.animationData.assets,this.frameRate=this.animationData.fr,this.frameMult=this.animationData.fr/1e3,this.renderer.searchExtraCompositions(e.assets),this.markers=markerParser(e.markers||[]),this.trigger("config_ready"),this.preloadImages(),this.loadSegments(),this.updaFrameModifier(),this.waitForFontsLoaded(),this.isPaused&&this.audioController.pause()}catch(t){this.triggerConfigError(t)}},AnimationItem.prototype.waitForFontsLoaded=function(){this.renderer&&(this.renderer.globalData.fontManager.isLoaded?this.checkLoaded():setTimeout(this.waitForFontsLoaded.bind(this),20))},AnimationItem.prototype.checkLoaded=function(){if(!this.isLoaded&&this.renderer.globalData.fontManager.isLoaded&&(this.imagePreloader.loadedImages()||"canvas"!==this.renderer.rendererType)&&this.imagePreloader.loadedFootages()){this.isLoaded=!0;var e=getExpressionsPlugin();e&&e.initExpressions(this),this.renderer.initItems(),setTimeout(function(){this.trigger("DOMLoaded")}.bind(this),0),this.gotoFrame(),this.autoplay&&this.play()}},AnimationItem.prototype.resize=function(){this.renderer.updateContainerSize()},AnimationItem.prototype.setSubframe=function(e){this.isSubframeEnabled=!!e},AnimationItem.prototype.gotoFrame=function(){this.currentFrame=this.isSubframeEnabled?this.currentRawFrame:~~this.currentRawFrame,this.timeCompleted!==this.totalFrames&&this.currentFrame>this.timeCompleted&&(this.currentFrame=this.timeCompleted),this.trigger("enterFrame"),this.renderFrame(),this.trigger("drawnFrame")},AnimationItem.prototype.renderFrame=function(){if(!1!==this.isLoaded&&this.renderer)try{this.renderer.renderFrame(this.currentFrame+this.firstFrame)}catch(e){this.triggerRenderFrameError(e)}},AnimationItem.prototype.play=function(e){e&&this.name!==e||!0===this.isPaused&&(this.isPaused=!1,this.trigger("_pause"),this.audioController.resume(),this._idle&&(this._idle=!1,this.trigger("_active")))},AnimationItem.prototype.pause=function(e){e&&this.name!==e||!1===this.isPaused&&(this.isPaused=!0,this.trigger("_play"),this._idle=!0,this.trigger("_idle"),this.audioController.pause())},AnimationItem.prototype.togglePause=function(e){e&&this.name!==e||(!0===this.isPaused?this.play():this.pause())},AnimationItem.prototype.stop=function(e){e&&this.name!==e||(this.pause(),this.playCount=0,this._completedLoop=!1,this.setCurrentRawFrameValue(0))},AnimationItem.prototype.getMarkerData=function(e){for(var t,n=0;n<this.markers.length;n+=1)if((t=this.markers[n]).payload&&t.payload.name===e)return t;return null},AnimationItem.prototype.goToAndStop=function(e,t,n){if(!n||this.name===n){var r=Number(e);if(isNaN(r)){var a=this.getMarkerData(e);a&&this.goToAndStop(a.time,!0)}else t?this.setCurrentRawFrameValue(e):this.setCurrentRawFrameValue(e*this.frameModifier);this.pause()}},AnimationItem.prototype.goToAndPlay=function(e,t,n){if(!n||this.name===n){var r=Number(e);if(isNaN(r)){var a=this.getMarkerData(e);a&&(a.duration?this.playSegments([a.time,a.time+a.duration],!0):this.goToAndStop(a.time,!0))}else this.goToAndStop(r,t,n);this.play()}},AnimationItem.prototype.advanceTime=function(e){if(!0!==this.isPaused&&!1!==this.isLoaded){var t=this.currentRawFrame+e*this.frameModifier,n=!1;t>=this.totalFrames-1&&this.frameModifier>0?this.loop&&this.playCount!==this.loop?t>=this.totalFrames?(this.playCount+=1,this.checkSegments(t%this.totalFrames)||(this.setCurrentRawFrameValue(t%this.totalFrames),this._completedLoop=!0,this.trigger("loopComplete"))):this.setCurrentRawFrameValue(t):this.checkSegments(t>this.totalFrames?t%this.totalFrames:0)||(n=!0,t=this.totalFrames-1):t<0?this.checkSegments(t%this.totalFrames)||(!this.loop||this.playCount--<=0&&!0!==this.loop?(n=!0,t=0):(this.setCurrentRawFrameValue(this.totalFrames+t%this.totalFrames),this._completedLoop?this.trigger("loopComplete"):this._completedLoop=!0)):this.setCurrentRawFrameValue(t),n&&(this.setCurrentRawFrameValue(t),this.pause(),this.trigger("complete"))}},AnimationItem.prototype.adjustSegment=function(e,t){this.playCount=0,e[1]<e[0]?(this.frameModifier>0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(-1)),this.totalFrames=e[0]-e[1],this.timeCompleted=this.totalFrames,this.firstFrame=e[1],this.setCurrentRawFrameValue(this.totalFrames-.001-t)):e[1]>e[0]&&(this.frameModifier<0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(1)),this.totalFrames=e[1]-e[0],this.timeCompleted=this.totalFrames,this.firstFrame=e[0],this.setCurrentRawFrameValue(.001+t)),this.trigger("segmentStart")},AnimationItem.prototype.setSegment=function(e,t){var n=-1;this.isPaused&&(this.currentRawFrame+this.firstFrame<e?n=e:this.currentRawFrame+this.firstFrame>t&&(n=t-e)),this.firstFrame=e,this.totalFrames=t-e,this.timeCompleted=this.totalFrames,-1!==n&&this.goToAndStop(n,!0)},AnimationItem.prototype.playSegments=function(e,t){if(t&&(this.segments.length=0),"object"===_typeof$4(e[0])){var n,r=e.length;for(n=0;n<r;n+=1)this.segments.push(e[n])}else this.segments.push(e);this.segments.length&&t&&this.adjustSegment(this.segments.shift(),0),this.isPaused&&this.play()},AnimationItem.prototype.resetSegments=function(e){this.segments.length=0,this.segments.push([this.animationData.ip,this.animationData.op]),e&&this.checkSegments(0)},AnimationItem.prototype.checkSegments=function(e){return!!this.segments.length&&(this.adjustSegment(this.segments.shift(),e),!0)},AnimationItem.prototype.destroy=function(e){e&&this.name!==e||!this.renderer||(this.renderer.destroy(),this.imagePreloader.destroy(),this.trigger("destroy"),this._cbs=null,this.onEnterFrame=null,this.onLoopComplete=null,this.onComplete=null,this.onSegmentStart=null,this.onDestroy=null,this.renderer=null,this.renderer=null,this.imagePreloader=null,this.projectInterface=null)},AnimationItem.prototype.setCurrentRawFrameValue=function(e){this.currentRawFrame=e,this.gotoFrame()},AnimationItem.prototype.setSpeed=function(e){this.playSpeed=e,this.updaFrameModifier()},AnimationItem.prototype.setDirection=function(e){this.playDirection=e<0?-1:1,this.updaFrameModifier()},AnimationItem.prototype.setVolume=function(e,t){t&&this.name!==t||this.audioController.setVolume(e)},AnimationItem.prototype.getVolume=function(){return this.audioController.getVolume()},AnimationItem.prototype.mute=function(e){e&&this.name!==e||this.audioController.mute()},AnimationItem.prototype.unmute=function(e){e&&this.name!==e||this.audioController.unmute()},AnimationItem.prototype.updaFrameModifier=function(){this.frameModifier=this.frameMult*this.playSpeed*this.playDirection,this.audioController.setRate(this.playSpeed*this.playDirection)},AnimationItem.prototype.getPath=function(){return this.path},AnimationItem.prototype.getAssetsPath=function(e){var t="";if(e.e)t=e.p;else if(this.assetsPath){var n=e.p;-1!==n.indexOf("images/")&&(n=n.split("/")[1]),t=this.assetsPath+n}else t=this.path,t+=e.u?e.u:"",t+=e.p;return t},AnimationItem.prototype.getAssetData=function(e){for(var t=0,n=this.assets.length;t<n;){if(e===this.assets[t].id)return this.assets[t];t+=1}return null},AnimationItem.prototype.hide=function(){this.renderer.hide()},AnimationItem.prototype.show=function(){this.renderer.show()},AnimationItem.prototype.getDuration=function(e){return e?this.totalFrames:this.totalFrames/this.frameRate},AnimationItem.prototype.updateDocumentData=function(e,t,n){try{this.renderer.getElementByPath(e).updateDocumentData(t,n)}catch(r){}},AnimationItem.prototype.trigger=function(e){if(this._cbs&&this._cbs[e])switch(e){case"enterFrame":this.triggerEvent(e,new BMEnterFrameEvent(e,this.currentFrame,this.totalFrames,this.frameModifier));break;case"drawnFrame":this.drawnFrameEvent.currentTime=this.currentFrame,this.drawnFrameEvent.totalTime=this.totalFrames,this.drawnFrameEvent.direction=this.frameModifier,this.triggerEvent(e,this.drawnFrameEvent);break;case"loopComplete":this.triggerEvent(e,new BMCompleteLoopEvent(e,this.loop,this.playCount,this.frameMult));break;case"complete":this.triggerEvent(e,new BMCompleteEvent(e,this.frameMult));break;case"segmentStart":this.triggerEvent(e,new BMSegmentStartEvent(e,this.firstFrame,this.totalFrames));break;case"destroy":this.triggerEvent(e,new BMDestroyEvent(e,this));break;default:this.triggerEvent(e)}"enterFrame"===e&&this.onEnterFrame&&this.onEnterFrame.call(this,new BMEnterFrameEvent(e,this.currentFrame,this.totalFrames,this.frameMult)),"loopComplete"===e&&this.onLoopComplete&&this.onLoopComplete.call(this,new BMCompleteLoopEvent(e,this.loop,this.playCount,this.frameMult)),"complete"===e&&this.onComplete&&this.onComplete.call(this,new BMCompleteEvent(e,this.frameMult)),"segmentStart"===e&&this.onSegmentStart&&this.onSegmentStart.call(this,new BMSegmentStartEvent(e,this.firstFrame,this.totalFrames)),"destroy"===e&&this.onDestroy&&this.onDestroy.call(this,new BMDestroyEvent(e,this))},AnimationItem.prototype.triggerRenderFrameError=function(e){var t=new BMRenderFrameErrorEvent(e,this.currentFrame);this.triggerEvent("error",t),this.onError&&this.onError.call(this,t)},AnimationItem.prototype.triggerConfigError=function(e){var t=new BMConfigErrorEvent(e,this.currentFrame);this.triggerEvent("error",t),this.onError&&this.onError.call(this,t)};var animationManager=function(){var e={},t=[],n=0,r=0,a=0,i=!0,o=!1;function s(e){for(var n=0,a=e.target;n<r;)t[n].animation===a&&(t.splice(n,1),n-=1,r-=1,a.isPaused||l()),n+=1}function u(e,n){if(!e)return null;for(var a=0;a<r;){if(t[a].elem===e&&null!==t[a].elem)return t[a].animation;a+=1}var i=new AnimationItem;return h(i,e),i.setData(e,n),i}function c(){a+=1,d()}function l(){a-=1}function h(e,n){e.addEventListener("destroy",s),e.addEventListener("_active",c),e.addEventListener("_idle",l),t.push({elem:n,animation:e}),r+=1}function f(e){var s,u=e-n;for(s=0;s<r;s+=1)t[s].animation.advanceTime(u);n=e,a&&!o?window.requestAnimationFrame(f):i=!0}function p(e){n=e,window.requestAnimationFrame(f)}function d(){!o&&a&&i&&(window.requestAnimationFrame(p),i=!1)}return e.registerAnimation=u,e.loadAnimation=function(e){var t=new AnimationItem;return h(t,null),t.setParams(e),t},e.setSpeed=function(e,n){var a;for(a=0;a<r;a+=1)t[a].animation.setSpeed(e,n)},e.setDirection=function(e,n){var a;for(a=0;a<r;a+=1)t[a].animation.setDirection(e,n)},e.play=function(e){var n;for(n=0;n<r;n+=1)t[n].animation.play(e)},e.pause=function(e){var n;for(n=0;n<r;n+=1)t[n].animation.pause(e)},e.stop=function(e){var n;for(n=0;n<r;n+=1)t[n].animation.stop(e)},e.togglePause=function(e){var n;for(n=0;n<r;n+=1)t[n].animation.togglePause(e)},e.searchAnimations=function(e,t,n){var r,a=[].concat([].slice.call(document.getElementsByClassName("lottie")),[].slice.call(document.getElementsByClassName("bodymovin"))),i=a.length;for(r=0;r<i;r+=1)n&&a[r].setAttribute("data-bm-type",n),u(a[r],e);if(t&&0===i){n||(n="svg");var o=document.getElementsByTagName("body")[0];o.innerText="";var s=createTag("div");s.style.width="100%",s.style.height="100%",s.setAttribute("data-bm-type",n),o.appendChild(s),u(s,e)}},e.resize=function(){var e;for(e=0;e<r;e+=1)t[e].animation.resize()},e.goToAndStop=function(e,n,a){var i;for(i=0;i<r;i+=1)t[i].animation.goToAndStop(e,n,a)},e.destroy=function(e){var n;for(n=r-1;n>=0;n-=1)t[n].animation.destroy(e)},e.freeze=function(){o=!0},e.unfreeze=function(){o=!1,d()},e.setVolume=function(e,n){var a;for(a=0;a<r;a+=1)t[a].animation.setVolume(e,n)},e.mute=function(e){var n;for(n=0;n<r;n+=1)t[n].animation.mute(e)},e.unmute=function(e){var n;for(n=0;n<r;n+=1)t[n].animation.unmute(e)},e.getRegisteredAnimations=function(){var e,n=t.length,r=[];for(e=0;e<n;e+=1)r.push(t[e].animation);return r},e}(),BezierFactory=function(){var e={getBezierEasing:function(e,n,r,a,i){var o=i||("bez_"+e+"_"+n+"_"+r+"_"+a).replace(/\./g,"p");if(t[o])return t[o];var s=new c([e,n,r,a]);return t[o]=s,s}},t={},n=.1,r="function"===typeof Float32Array;function a(e,t){return 1-3*t+3*e}function i(e,t){return 3*t-6*e}function o(e){return 3*e}function s(e,t,n){return((a(t,n)*e+i(t,n))*e+o(t))*e}function u(e,t,n){return 3*a(t,n)*e*e+2*i(t,n)*e+o(t)}function c(e){this._p=e,this._mSampleValues=r?new Float32Array(11):new Array(11),this._precomputed=!1,this.get=this.get.bind(this)}return c.prototype={get:function(e){var t=this._p[0],n=this._p[1],r=this._p[2],a=this._p[3];return this._precomputed||this._precompute(),t===n&&r===a?e:0===e?0:1===e?1:s(this._getTForX(e),n,a)},_precompute:function(){var e=this._p[0],t=this._p[1],n=this._p[2],r=this._p[3];this._precomputed=!0,e===t&&n===r||this._calcSampleValues()},_calcSampleValues:function(){for(var e=this._p[0],t=this._p[2],r=0;r<11;++r)this._mSampleValues[r]=s(r*n,e,t)},_getTForX:function(e){for(var t=this._p[0],r=this._p[2],a=this._mSampleValues,i=0,o=1;10!==o&&a[o]<=e;++o)i+=n;var c=i+(e-a[--o])/(a[o+1]-a[o])*n,l=u(c,t,r);return l>=.001?function(e,t,n,r){for(var a=0;a<4;++a){var i=u(t,n,r);if(0===i)return t;t-=(s(t,n,r)-e)/i}return t}(e,c,t,r):0===l?c:function(e,t,n,r,a){var i,o,u=0;do{(i=s(o=t+(n-t)/2,r,a)-e)>0?n=o:t=o}while(Math.abs(i)>1e-7&&++u<10);return o}(e,i,i+n,t,r)}},e}(),pooling={double:function(e){return e.concat(createSizedArray(e.length))}},poolFactory=function(e,t,n){var r=0,a=e,i=createSizedArray(a);return{newElement:function(){return r?i[r-=1]:t()},release:function(e){r===a&&(i=pooling.double(i),a*=2),n&&n(e),i[r]=e,r+=1}}},bezierLengthPool=poolFactory(8,(function(){return{addedLength:0,percents:createTypedArray("float32",getDefaultCurveSegments()),lengths:createTypedArray("float32",getDefaultCurveSegments())}})),segmentsLengthPool=poolFactory(8,(function(){return{lengths:[],totalLength:0}}),(function(e){var t,n=e.lengths.length;for(t=0;t<n;t+=1)bezierLengthPool.release(e.lengths[t]);e.lengths.length=0}));function bezFunction(){var e=Math;function t(e,t,n,r,a,i){var o=e*r+t*a+n*i-a*r-i*e-n*t;return o>-.001&&o<.001}var n=function(e,t,n,r){var a,i,o,s,u,c,l=getDefaultCurveSegments(),h=0,f=[],p=[],d=bezierLengthPool.newElement();for(o=n.length,a=0;a<l;a+=1){for(u=a/(l-1),c=0,i=0;i<o;i+=1)s=bmPow(1-u,3)*e[i]+3*bmPow(1-u,2)*u*n[i]+3*(1-u)*bmPow(u,2)*r[i]+bmPow(u,3)*t[i],f[i]=s,null!==p[i]&&(c+=bmPow(f[i]-p[i],2)),p[i]=f[i];c&&(h+=c=bmSqrt(c)),d.percents[a]=u,d.lengths[a]=h}return d.addedLength=h,d};function r(e){this.segmentLength=0,this.points=new Array(e)}function a(e,t){this.partialLength=e,this.point=t}var i=function(){var e={};return function(n,i,o,s){var u=(n[0]+"_"+n[1]+"_"+i[0]+"_"+i[1]+"_"+o[0]+"_"+o[1]+"_"+s[0]+"_"+s[1]).replace(/\./g,"p");if(!e[u]){var c,l,h,f,p,d,m,v=getDefaultCurveSegments(),g=0,y=null;2===n.length&&(n[0]!==i[0]||n[1]!==i[1])&&t(n[0],n[1],i[0],i[1],n[0]+o[0],n[1]+o[1])&&t(n[0],n[1],i[0],i[1],i[0]+s[0],i[1]+s[1])&&(v=2);var b=new r(v);for(h=o.length,c=0;c<v;c+=1){for(m=createSizedArray(h),p=c/(v-1),d=0,l=0;l<h;l+=1)f=bmPow(1-p,3)*n[l]+3*bmPow(1-p,2)*p*(n[l]+o[l])+3*(1-p)*bmPow(p,2)*(i[l]+s[l])+bmPow(p,3)*i[l],m[l]=f,null!==y&&(d+=bmPow(m[l]-y[l],2));g+=d=bmSqrt(d),b.points[c]=new a(d,m),y=m}b.segmentLength=g,e[u]=b}return e[u]}}();function o(e,t){var n=t.percents,r=t.lengths,a=n.length,i=bmFloor((a-1)*e),o=e*t.addedLength,s=0;if(i===a-1||0===i||o===r[i])return n[i];for(var u=r[i]>o?-1:1,c=!0;c;)if(r[i]<=o&&r[i+1]>o?(s=(o-r[i])/(r[i+1]-r[i]),c=!1):i+=u,i<0||i>=a-1){if(i===a-1)return n[i];c=!1}return n[i]+(n[i+1]-n[i])*s}var s=createTypedArray("float32",8);return{getSegmentsLength:function(e){var t,r=segmentsLengthPool.newElement(),a=e.c,i=e.v,o=e.o,s=e.i,u=e._length,c=r.lengths,l=0;for(t=0;t<u-1;t+=1)c[t]=n(i[t],i[t+1],o[t],s[t+1]),l+=c[t].addedLength;return a&&u&&(c[t]=n(i[t],i[0],o[t],s[0]),l+=c[t].addedLength),r.totalLength=l,r},getNewSegment:function(t,n,r,a,i,u,c){i<0?i=0:i>1&&(i=1);var l,h=o(i,c),f=o(u=u>1?1:u,c),p=t.length,d=1-h,m=1-f,v=d*d*d,g=h*d*d*3,y=h*h*d*3,b=h*h*h,k=d*d*m,x=h*d*m+d*h*m+d*d*f,w=h*h*m+d*h*f+h*d*f,_=h*h*f,S=d*m*m,C=h*m*m+d*f*m+d*m*f,T=h*f*m+d*f*f+h*m*f,E=h*f*f,I=m*m*m,A=f*m*m+m*f*m+m*m*f,N=f*f*m+m*f*f+f*m*f,P=f*f*f;for(l=0;l<p;l+=1)s[4*l]=e.round(1e3*(v*t[l]+g*r[l]+y*a[l]+b*n[l]))/1e3,s[4*l+1]=e.round(1e3*(k*t[l]+x*r[l]+w*a[l]+_*n[l]))/1e3,s[4*l+2]=e.round(1e3*(S*t[l]+C*r[l]+T*a[l]+E*n[l]))/1e3,s[4*l+3]=e.round(1e3*(I*t[l]+A*r[l]+N*a[l]+P*n[l]))/1e3;return s},getPointInSegment:function(t,n,r,a,i,s){var u=o(i,s),c=1-u;return[e.round(1e3*(c*c*c*t[0]+(u*c*c+c*u*c+c*c*u)*r[0]+(u*u*c+c*u*u+u*c*u)*a[0]+u*u*u*n[0]))/1e3,e.round(1e3*(c*c*c*t[1]+(u*c*c+c*u*c+c*c*u)*r[1]+(u*u*c+c*u*u+u*c*u)*a[1]+u*u*u*n[1]))/1e3]},buildBezierData:i,pointOnLine2D:t,pointOnLine3D:function(n,r,a,i,o,s,u,c,l){if(0===a&&0===s&&0===l)return t(n,r,i,o,u,c);var h,f=e.sqrt(e.pow(i-n,2)+e.pow(o-r,2)+e.pow(s-a,2)),p=e.sqrt(e.pow(u-n,2)+e.pow(c-r,2)+e.pow(l-a,2)),d=e.sqrt(e.pow(u-i,2)+e.pow(c-o,2)+e.pow(l-s,2));return(h=f>p?f>d?f-p-d:d-p-f:d>p?d-p-f:p-f-d)>-1e-4&&h<1e-4}}}var bez=bezFunction(),PropertyFactory=function(){var e=initialDefaultFrame,t=Math.abs;function n(e,t){var n,a=this.offsetTime;"multidimensional"===this.propType&&(n=createTypedArray("float32",this.pv.length));for(var i,o,s,u,c,l,h,f,p,d=t.lastIndex,m=d,v=this.keyframes.length-1,g=!0;g;){if(i=this.keyframes[m],o=this.keyframes[m+1],m===v-1&&e>=o.t-a){i.h&&(i=o),d=0;break}if(o.t-a>e){d=m;break}m<v-1?m+=1:(d=0,g=!1)}s=this.keyframesMetadata[m]||{};var y,b=o.t-a,k=i.t-a;if(i.to){s.bezierData||(s.bezierData=bez.buildBezierData(i.s,o.s||i.e,i.to,i.ti));var x=s.bezierData;if(e>=b||e<k){var w=e>=b?x.points.length-1:0;for(c=x.points[w].point.length,u=0;u<c;u+=1)n[u]=x.points[w].point[u]}else{s.__fnct?p=s.__fnct:(p=BezierFactory.getBezierEasing(i.o.x,i.o.y,i.i.x,i.i.y,i.n).get,s.__fnct=p),l=p((e-k)/(b-k));var _,S=x.segmentLength*l,C=t.lastFrame<e&&t._lastKeyframeIndex===m?t._lastAddedLength:0;for(f=t.lastFrame<e&&t._lastKeyframeIndex===m?t._lastPoint:0,g=!0,h=x.points.length;g;){if(C+=x.points[f].partialLength,0===S||0===l||f===x.points.length-1){for(c=x.points[f].point.length,u=0;u<c;u+=1)n[u]=x.points[f].point[u];break}if(S>=C&&S<C+x.points[f+1].partialLength){for(_=(S-C)/x.points[f+1].partialLength,c=x.points[f].point.length,u=0;u<c;u+=1)n[u]=x.points[f].point[u]+(x.points[f+1].point[u]-x.points[f].point[u])*_;break}f<h-1?f+=1:g=!1}t._lastPoint=f,t._lastAddedLength=C-x.points[f].partialLength,t._lastKeyframeIndex=m}}else{var T,E,I,A,N;if(v=i.s.length,y=o.s||i.e,this.sh&&1!==i.h)e>=b?(n[0]=y[0],n[1]=y[1],n[2]=y[2]):e<=k?(n[0]=i.s[0],n[1]=i.s[1],n[2]=i.s[2]):function(e,t){var n=t[0],r=t[1],a=t[2],i=t[3],o=Math.atan2(2*r*i-2*n*a,1-2*r*r-2*a*a),s=Math.asin(2*n*r+2*a*i),u=Math.atan2(2*n*i-2*r*a,1-2*n*n-2*a*a);e[0]=o/degToRads,e[1]=s/degToRads,e[2]=u/degToRads}(n,function(e,t,n){var r,a,i,o,s,u=[],c=e[0],l=e[1],h=e[2],f=e[3],p=t[0],d=t[1],m=t[2],v=t[3];return(a=c*p+l*d+h*m+f*v)<0&&(a=-a,p=-p,d=-d,m=-m,v=-v),1-a>1e-6?(r=Math.acos(a),i=Math.sin(r),o=Math.sin((1-n)*r)/i,s=Math.sin(n*r)/i):(o=1-n,s=n),u[0]=o*c+s*p,u[1]=o*l+s*d,u[2]=o*h+s*m,u[3]=o*f+s*v,u}(r(i.s),r(y),(e-k)/(b-k)));else for(m=0;m<v;m+=1)1!==i.h&&(e>=b?l=1:e<k?l=0:(i.o.x.constructor===Array?(s.__fnct||(s.__fnct=[]),s.__fnct[m]?p=s.__fnct[m]:(T=void 0===i.o.x[m]?i.o.x[0]:i.o.x[m],E=void 0===i.o.y[m]?i.o.y[0]:i.o.y[m],I=void 0===i.i.x[m]?i.i.x[0]:i.i.x[m],A=void 0===i.i.y[m]?i.i.y[0]:i.i.y[m],p=BezierFactory.getBezierEasing(T,E,I,A).get,s.__fnct[m]=p)):s.__fnct?p=s.__fnct:(T=i.o.x,E=i.o.y,I=i.i.x,A=i.i.y,p=BezierFactory.getBezierEasing(T,E,I,A).get,i.keyframeMetadata=p),l=p((e-k)/(b-k)))),y=o.s||i.e,N=1===i.h?i.s[m]:i.s[m]+(y[m]-i.s[m])*l,"multidimensional"===this.propType?n[m]=N:n=N}return t.lastIndex=d,n}function r(e){var t=e[0]*degToRads,n=e[1]*degToRads,r=e[2]*degToRads,a=Math.cos(t/2),i=Math.cos(n/2),o=Math.cos(r/2),s=Math.sin(t/2),u=Math.sin(n/2),c=Math.sin(r/2);return[s*u*o+a*i*c,s*i*o+a*u*c,a*u*o-s*i*c,a*i*o-s*u*c]}function a(){var t=this.comp.renderedFrame-this.offsetTime,n=this.keyframes[0].t-this.offsetTime,r=this.keyframes[this.keyframes.length-1].t-this.offsetTime;if(!(t===this._caching.lastFrame||this._caching.lastFrame!==e&&(this._caching.lastFrame>=r&&t>=r||this._caching.lastFrame<n&&t<n))){this._caching.lastFrame>=t&&(this._caching._lastKeyframeIndex=-1,this._caching.lastIndex=0);var a=this.interpolateValue(t,this._caching);this.pv=a}return this._caching.lastFrame=t,this.pv}function i(e){var n;if("unidimensional"===this.propType)n=e*this.mult,t(this.v-n)>1e-5&&(this.v=n,this._mdf=!0);else for(var r=0,a=this.v.length;r<a;)n=e[r]*this.mult,t(this.v[r]-n)>1e-5&&(this.v[r]=n,this._mdf=!0),r+=1}function o(){if(this.elem.globalData.frameId!==this.frameId&&this.effectsSequence.length)if(this.lock)this.setVValue(this.pv);else{var e;this.lock=!0,this._mdf=this._isFirstFrame;var t=this.effectsSequence.length,n=this.kf?this.pv:this.data.k;for(e=0;e<t;e+=1)n=this.effectsSequence[e](n);this.setVValue(n),this._isFirstFrame=!1,this.lock=!1,this.frameId=this.elem.globalData.frameId}}function s(e){this.effectsSequence.push(e),this.container.addDynamicProperty(this)}function u(e,t,n,r){this.propType="unidimensional",this.mult=n||1,this.data=t,this.v=n?t.k*n:t.k,this.pv=t.k,this._mdf=!1,this.elem=e,this.container=r,this.comp=e.comp,this.k=!1,this.kf=!1,this.vel=0,this.effectsSequence=[],this._isFirstFrame=!0,this.getValue=o,this.setVValue=i,this.addEffect=s}function c(e,t,n,r){var a;this.propType="multidimensional",this.mult=n||1,this.data=t,this._mdf=!1,this.elem=e,this.container=r,this.comp=e.comp,this.k=!1,this.kf=!1,this.frameId=-1;var u=t.k.length;for(this.v=createTypedArray("float32",u),this.pv=createTypedArray("float32",u),this.vel=createTypedArray("float32",u),a=0;a<u;a+=1)this.v[a]=t.k[a]*this.mult,this.pv[a]=t.k[a];this._isFirstFrame=!0,this.effectsSequence=[],this.getValue=o,this.setVValue=i,this.addEffect=s}function l(t,r,u,c){this.propType="unidimensional",this.keyframes=r.k,this.keyframesMetadata=[],this.offsetTime=t.data.st,this.frameId=-1,this._caching={lastFrame:e,lastIndex:0,value:0,_lastKeyframeIndex:-1},this.k=!0,this.kf=!0,this.data=r,this.mult=u||1,this.elem=t,this.container=c,this.comp=t.comp,this.v=e,this.pv=e,this._isFirstFrame=!0,this.getValue=o,this.setVValue=i,this.interpolateValue=n,this.effectsSequence=[a.bind(this)],this.addEffect=s}function h(t,r,u,c){var l;this.propType="multidimensional";var h,f,p,d,m=r.k.length;for(l=0;l<m-1;l+=1)r.k[l].to&&r.k[l].s&&r.k[l+1]&&r.k[l+1].s&&(h=r.k[l].s,f=r.k[l+1].s,p=r.k[l].to,d=r.k[l].ti,(2===h.length&&(h[0]!==f[0]||h[1]!==f[1])&&bez.pointOnLine2D(h[0],h[1],f[0],f[1],h[0]+p[0],h[1]+p[1])&&bez.pointOnLine2D(h[0],h[1],f[0],f[1],f[0]+d[0],f[1]+d[1])||3===h.length&&(h[0]!==f[0]||h[1]!==f[1]||h[2]!==f[2])&&bez.pointOnLine3D(h[0],h[1],h[2],f[0],f[1],f[2],h[0]+p[0],h[1]+p[1],h[2]+p[2])&&bez.pointOnLine3D(h[0],h[1],h[2],f[0],f[1],f[2],f[0]+d[0],f[1]+d[1],f[2]+d[2]))&&(r.k[l].to=null,r.k[l].ti=null),h[0]===f[0]&&h[1]===f[1]&&0===p[0]&&0===p[1]&&0===d[0]&&0===d[1]&&(2===h.length||h[2]===f[2]&&0===p[2]&&0===d[2])&&(r.k[l].to=null,r.k[l].ti=null));this.effectsSequence=[a.bind(this)],this.data=r,this.keyframes=r.k,this.keyframesMetadata=[],this.offsetTime=t.data.st,this.k=!0,this.kf=!0,this._isFirstFrame=!0,this.mult=u||1,this.elem=t,this.container=c,this.comp=t.comp,this.getValue=o,this.setVValue=i,this.interpolateValue=n,this.frameId=-1;var v=r.k[0].s.length;for(this.v=createTypedArray("float32",v),this.pv=createTypedArray("float32",v),l=0;l<v;l+=1)this.v[l]=e,this.pv[l]=e;this._caching={lastFrame:e,lastIndex:0,value:createTypedArray("float32",v)},this.addEffect=s}return{getProp:function(e,t,n,r,a){var i;if(t.k.length)if("number"===typeof t.k[0])i=new c(e,t,r,a);else switch(n){case 0:i=new l(e,t,r,a);break;case 1:i=new h(e,t,r,a)}else i=new u(e,t,r,a);return i.effectsSequence.length&&a.addDynamicProperty(i),i}}}();function DynamicPropertyContainer(){}DynamicPropertyContainer.prototype={addDynamicProperty:function(e){-1===this.dynamicProperties.indexOf(e)&&(this.dynamicProperties.push(e),this.container.addDynamicProperty(this),this._isAnimated=!0)},iterateDynamicProperties:function(){var e;this._mdf=!1;var t=this.dynamicProperties.length;for(e=0;e<t;e+=1)this.dynamicProperties[e].getValue(),this.dynamicProperties[e]._mdf&&(this._mdf=!0)},initDynamicPropertyContainer:function(e){this.container=e,this.dynamicProperties=[],this._mdf=!1,this._isAnimated=!1}};var pointPool=poolFactory(8,(function(){return createTypedArray("float32",2)}));function ShapePath(){this.c=!1,this._length=0,this._maxLength=8,this.v=createSizedArray(this._maxLength),this.o=createSizedArray(this._maxLength),this.i=createSizedArray(this._maxLength)}ShapePath.prototype.setPathData=function(e,t){this.c=e,this.setLength(t);for(var n=0;n<t;)this.v[n]=pointPool.newElement(),this.o[n]=pointPool.newElement(),this.i[n]=pointPool.newElement(),n+=1},ShapePath.prototype.setLength=function(e){for(;this._maxLength<e;)this.doubleArrayLength();this._length=e},ShapePath.prototype.doubleArrayLength=function(){this.v=this.v.concat(createSizedArray(this._maxLength)),this.i=this.i.concat(createSizedArray(this._maxLength)),this.o=this.o.concat(createSizedArray(this._maxLength)),this._maxLength*=2},ShapePath.prototype.setXYAt=function(e,t,n,r,a){var i;switch(this._length=Math.max(this._length,r+1),this._length>=this._maxLength&&this.doubleArrayLength(),n){case"v":i=this.v;break;case"i":i=this.i;break;case"o":i=this.o;break;default:i=[]}(!i[r]||i[r]&&!a)&&(i[r]=pointPool.newElement()),i[r][0]=e,i[r][1]=t},ShapePath.prototype.setTripleAt=function(e,t,n,r,a,i,o,s){this.setXYAt(e,t,"v",o,s),this.setXYAt(n,r,"o",o,s),this.setXYAt(a,i,"i",o,s)},ShapePath.prototype.reverse=function(){var e=new ShapePath;e.setPathData(this.c,this._length);var t=this.v,n=this.o,r=this.i,a=0;this.c&&(e.setTripleAt(t[0][0],t[0][1],r[0][0],r[0][1],n[0][0],n[0][1],0,!1),a=1);var i,o=this._length-1,s=this._length;for(i=a;i<s;i+=1)e.setTripleAt(t[o][0],t[o][1],r[o][0],r[o][1],n[o][0],n[o][1],i,!1),o-=1;return e};var shapePool=function(){var e=poolFactory(4,(function(){return new ShapePath}),(function(e){var t,n=e._length;for(t=0;t<n;t+=1)pointPool.release(e.v[t]),pointPool.release(e.i[t]),pointPool.release(e.o[t]),e.v[t]=null,e.i[t]=null,e.o[t]=null;e._length=0,e.c=!1}));return e.clone=function(t){var n,r=e.newElement(),a=void 0===t._length?t.v.length:t._length;for(r.setLength(a),r.c=t.c,n=0;n<a;n+=1)r.setTripleAt(t.v[n][0],t.v[n][1],t.o[n][0],t.o[n][1],t.i[n][0],t.i[n][1],n);return r},e}();function ShapeCollection(){this._length=0,this._maxLength=4,this.shapes=createSizedArray(this._maxLength)}ShapeCollection.prototype.addShape=function(e){this._length===this._maxLength&&(this.shapes=this.shapes.concat(createSizedArray(this._maxLength)),this._maxLength*=2),this.shapes[this._length]=e,this._length+=1},ShapeCollection.prototype.releaseShapes=function(){var e;for(e=0;e<this._length;e+=1)shapePool.release(this.shapes[e]);this._length=0};var shapeCollectionPool=function(){var e={newShapeCollection:function(){return t?r[t-=1]:new ShapeCollection},release:function(e){var a,i=e._length;for(a=0;a<i;a+=1)shapePool.release(e.shapes[a]);e._length=0,t===n&&(r=pooling.double(r),n*=2),r[t]=e,t+=1}},t=0,n=4,r=createSizedArray(n);return e}(),ShapePropertyFactory=function(){var e=-999999;function t(e,t,n){var r,a,i,o,s,u,c,l,h,f=n.lastIndex,p=this.keyframes;if(e<p[0].t-this.offsetTime)r=p[0].s[0],i=!0,f=0;else if(e>=p[p.length-1].t-this.offsetTime)r=p[p.length-1].s?p[p.length-1].s[0]:p[p.length-2].e[0],i=!0;else{for(var d,m,v,g=f,y=p.length-1,b=!0;b&&(d=p[g],!((m=p[g+1]).t-this.offsetTime>e));)g<y-1?g+=1:b=!1;if(v=this.keyframesMetadata[g]||{},f=g,!(i=1===d.h)){if(e>=m.t-this.offsetTime)l=1;else if(e<d.t-this.offsetTime)l=0;else{var k;v.__fnct?k=v.__fnct:(k=BezierFactory.getBezierEasing(d.o.x,d.o.y,d.i.x,d.i.y).get,v.__fnct=k),l=k((e-(d.t-this.offsetTime))/(m.t-this.offsetTime-(d.t-this.offsetTime)))}a=m.s?m.s[0]:d.e[0]}r=d.s[0]}for(u=t._length,c=r.i[0].length,n.lastIndex=f,o=0;o<u;o+=1)for(s=0;s<c;s+=1)h=i?r.i[o][s]:r.i[o][s]+(a.i[o][s]-r.i[o][s])*l,t.i[o][s]=h,h=i?r.o[o][s]:r.o[o][s]+(a.o[o][s]-r.o[o][s])*l,t.o[o][s]=h,h=i?r.v[o][s]:r.v[o][s]+(a.v[o][s]-r.v[o][s])*l,t.v[o][s]=h}function n(){var t=this.comp.renderedFrame-this.offsetTime,n=this.keyframes[0].t-this.offsetTime,r=this.keyframes[this.keyframes.length-1].t-this.offsetTime,a=this._caching.lastFrame;return a!==e&&(a<n&&t<n||a>r&&t>r)||(this._caching.lastIndex=a<t?this._caching.lastIndex:0,this.interpolateShape(t,this.pv,this._caching)),this._caching.lastFrame=t,this.pv}function r(){this.paths=this.localShapeCollection}function a(e){(function(e,t){if(e._length!==t._length||e.c!==t.c)return!1;var n,r=e._length;for(n=0;n<r;n+=1)if(e.v[n][0]!==t.v[n][0]||e.v[n][1]!==t.v[n][1]||e.o[n][0]!==t.o[n][0]||e.o[n][1]!==t.o[n][1]||e.i[n][0]!==t.i[n][0]||e.i[n][1]!==t.i[n][1])return!1;return!0})(this.v,e)||(this.v=shapePool.clone(e),this.localShapeCollection.releaseShapes(),this.localShapeCollection.addShape(this.v),this._mdf=!0,this.paths=this.localShapeCollection)}function i(){if(this.elem.globalData.frameId!==this.frameId)if(this.effectsSequence.length)if(this.lock)this.setVValue(this.pv);else{var e,t;this.lock=!0,this._mdf=!1,e=this.kf?this.pv:this.data.ks?this.data.ks.k:this.data.pt.k;var n=this.effectsSequence.length;for(t=0;t<n;t+=1)e=this.effectsSequence[t](e);this.setVValue(e),this.lock=!1,this.frameId=this.elem.globalData.frameId}else this._mdf=!1}function o(e,t,n){this.propType="shape",this.comp=e.comp,this.container=e,this.elem=e,this.data=t,this.k=!1,this.kf=!1,this._mdf=!1;var a=3===n?t.pt.k:t.ks.k;this.v=shapePool.clone(a),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.reset=r,this.effectsSequence=[]}function s(e){this.effectsSequence.push(e),this.container.addDynamicProperty(this)}function u(t,a,i){this.propType="shape",this.comp=t.comp,this.elem=t,this.container=t,this.offsetTime=t.data.st,this.keyframes=3===i?a.pt.k:a.ks.k,this.keyframesMetadata=[],this.k=!0,this.kf=!0;var o=this.keyframes[0].s[0].i.length;this.v=shapePool.newElement(),this.v.setPathData(this.keyframes[0].s[0].c,o),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.lastFrame=e,this.reset=r,this._caching={lastFrame:e,lastIndex:0},this.effectsSequence=[n.bind(this)]}o.prototype.interpolateShape=t,o.prototype.getValue=i,o.prototype.setVValue=a,o.prototype.addEffect=s,u.prototype.getValue=i,u.prototype.interpolateShape=t,u.prototype.setVValue=a,u.prototype.addEffect=s;var c=function(){var e=roundCorner;function t(e,t){this.v=shapePool.newElement(),this.v.setPathData(!0,4),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.localShapeCollection.addShape(this.v),this.d=t.d,this.elem=e,this.comp=e.comp,this.frameId=-1,this.initDynamicPropertyContainer(e),this.p=PropertyFactory.getProp(e,t.p,1,0,this),this.s=PropertyFactory.getProp(e,t.s,1,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertEllToPath())}return t.prototype={reset:r,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertEllToPath())},convertEllToPath:function(){var t=this.p.v[0],n=this.p.v[1],r=this.s.v[0]/2,a=this.s.v[1]/2,i=3!==this.d,o=this.v;o.v[0][0]=t,o.v[0][1]=n-a,o.v[1][0]=i?t+r:t-r,o.v[1][1]=n,o.v[2][0]=t,o.v[2][1]=n+a,o.v[3][0]=i?t-r:t+r,o.v[3][1]=n,o.i[0][0]=i?t-r*e:t+r*e,o.i[0][1]=n-a,o.i[1][0]=i?t+r:t-r,o.i[1][1]=n-a*e,o.i[2][0]=i?t+r*e:t-r*e,o.i[2][1]=n+a,o.i[3][0]=i?t-r:t+r,o.i[3][1]=n+a*e,o.o[0][0]=i?t+r*e:t-r*e,o.o[0][1]=n-a,o.o[1][0]=i?t+r:t-r,o.o[1][1]=n+a*e,o.o[2][0]=i?t-r*e:t+r*e,o.o[2][1]=n+a,o.o[3][0]=i?t-r:t+r,o.o[3][1]=n-a*e}},extendPrototype([DynamicPropertyContainer],t),t}(),l=function(){function e(e,t){this.v=shapePool.newElement(),this.v.setPathData(!0,0),this.elem=e,this.comp=e.comp,this.data=t,this.frameId=-1,this.d=t.d,this.initDynamicPropertyContainer(e),1===t.sy?(this.ir=PropertyFactory.getProp(e,t.ir,0,0,this),this.is=PropertyFactory.getProp(e,t.is,0,.01,this),this.convertToPath=this.convertStarToPath):this.convertToPath=this.convertPolygonToPath,this.pt=PropertyFactory.getProp(e,t.pt,0,0,this),this.p=PropertyFactory.getProp(e,t.p,1,0,this),this.r=PropertyFactory.getProp(e,t.r,0,degToRads,this),this.or=PropertyFactory.getProp(e,t.or,0,0,this),this.os=PropertyFactory.getProp(e,t.os,0,.01,this),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertToPath())}return e.prototype={reset:r,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertToPath())},convertStarToPath:function(){var e,t,n,r,a=2*Math.floor(this.pt.v),i=2*Math.PI/a,o=!0,s=this.or.v,u=this.ir.v,c=this.os.v,l=this.is.v,h=2*Math.PI*s/(2*a),f=2*Math.PI*u/(2*a),p=-Math.PI/2;p+=this.r.v;var d=3===this.data.d?-1:1;for(this.v._length=0,e=0;e<a;e+=1){n=o?c:l,r=o?h:f;var m=(t=o?s:u)*Math.cos(p),v=t*Math.sin(p),g=0===m&&0===v?0:v/Math.sqrt(m*m+v*v),y=0===m&&0===v?0:-m/Math.sqrt(m*m+v*v);m+=+this.p.v[0],v+=+this.p.v[1],this.v.setTripleAt(m,v,m-g*r*n*d,v-y*r*n*d,m+g*r*n*d,v+y*r*n*d,e,!0),o=!o,p+=i*d}},convertPolygonToPath:function(){var e,t=Math.floor(this.pt.v),n=2*Math.PI/t,r=this.or.v,a=this.os.v,i=2*Math.PI*r/(4*t),o=.5*-Math.PI,s=3===this.data.d?-1:1;for(o+=this.r.v,this.v._length=0,e=0;e<t;e+=1){var u=r*Math.cos(o),c=r*Math.sin(o),l=0===u&&0===c?0:c/Math.sqrt(u*u+c*c),h=0===u&&0===c?0:-u/Math.sqrt(u*u+c*c);u+=+this.p.v[0],c+=+this.p.v[1],this.v.setTripleAt(u,c,u-l*i*a*s,c-h*i*a*s,u+l*i*a*s,c+h*i*a*s,e,!0),o+=n*s}this.paths.length=0,this.paths[0]=this.v}},extendPrototype([DynamicPropertyContainer],e),e}(),h=function(){function e(e,t){this.v=shapePool.newElement(),this.v.c=!0,this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.elem=e,this.comp=e.comp,this.frameId=-1,this.d=t.d,this.initDynamicPropertyContainer(e),this.p=PropertyFactory.getProp(e,t.p,1,0,this),this.s=PropertyFactory.getProp(e,t.s,1,0,this),this.r=PropertyFactory.getProp(e,t.r,0,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertRectToPath())}return e.prototype={convertRectToPath:function(){var e=this.p.v[0],t=this.p.v[1],n=this.s.v[0]/2,r=this.s.v[1]/2,a=bmMin(n,r,this.r.v),i=a*(1-roundCorner);this.v._length=0,2===this.d||1===this.d?(this.v.setTripleAt(e+n,t-r+a,e+n,t-r+a,e+n,t-r+i,0,!0),this.v.setTripleAt(e+n,t+r-a,e+n,t+r-i,e+n,t+r-a,1,!0),0!==a?(this.v.setTripleAt(e+n-a,t+r,e+n-a,t+r,e+n-i,t+r,2,!0),this.v.setTripleAt(e-n+a,t+r,e-n+i,t+r,e-n+a,t+r,3,!0),this.v.setTripleAt(e-n,t+r-a,e-n,t+r-a,e-n,t+r-i,4,!0),this.v.setTripleAt(e-n,t-r+a,e-n,t-r+i,e-n,t-r+a,5,!0),this.v.setTripleAt(e-n+a,t-r,e-n+a,t-r,e-n+i,t-r,6,!0),this.v.setTripleAt(e+n-a,t-r,e+n-i,t-r,e+n-a,t-r,7,!0)):(this.v.setTripleAt(e-n,t+r,e-n+i,t+r,e-n,t+r,2),this.v.setTripleAt(e-n,t-r,e-n,t-r+i,e-n,t-r,3))):(this.v.setTripleAt(e+n,t-r+a,e+n,t-r+i,e+n,t-r+a,0,!0),0!==a?(this.v.setTripleAt(e+n-a,t-r,e+n-a,t-r,e+n-i,t-r,1,!0),this.v.setTripleAt(e-n+a,t-r,e-n+i,t-r,e-n+a,t-r,2,!0),this.v.setTripleAt(e-n,t-r+a,e-n,t-r+a,e-n,t-r+i,3,!0),this.v.setTripleAt(e-n,t+r-a,e-n,t+r-i,e-n,t+r-a,4,!0),this.v.setTripleAt(e-n+a,t+r,e-n+a,t+r,e-n+i,t+r,5,!0),this.v.setTripleAt(e+n-a,t+r,e+n-i,t+r,e+n-a,t+r,6,!0),this.v.setTripleAt(e+n,t+r-a,e+n,t+r-a,e+n,t+r-i,7,!0)):(this.v.setTripleAt(e-n,t-r,e-n+i,t-r,e-n,t-r,1,!0),this.v.setTripleAt(e-n,t+r,e-n,t+r-i,e-n,t+r,2,!0),this.v.setTripleAt(e+n,t+r,e+n-i,t+r,e+n,t+r,3,!0)))},getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertRectToPath())},reset:r},extendPrototype([DynamicPropertyContainer],e),e}(),f={getShapeProp:function(e,t,n){var r;return 3===n||4===n?r=(3===n?t.pt:t.ks).k.length?new u(e,t,n):new o(e,t,n):5===n?r=new h(e,t):6===n?r=new c(e,t):7===n&&(r=new l(e,t)),r.k&&e.addDynamicProperty(r),r},getConstructorFunction:function(){return o},getKeyframedConstructorFunction:function(){return u}};return f}(),Matrix=function(){var e=Math.cos,t=Math.sin,n=Math.tan,r=Math.round;function a(){return this.props[0]=1,this.props[1]=0,this.props[2]=0,this.props[3]=0,this.props[4]=0,this.props[5]=1,this.props[6]=0,this.props[7]=0,this.props[8]=0,this.props[9]=0,this.props[10]=1,this.props[11]=0,this.props[12]=0,this.props[13]=0,this.props[14]=0,this.props[15]=1,this}function i(n){if(0===n)return this;var r=e(n),a=t(n);return this._t(r,-a,0,0,a,r,0,0,0,0,1,0,0,0,0,1)}function o(n){if(0===n)return this;var r=e(n),a=t(n);return this._t(1,0,0,0,0,r,-a,0,0,a,r,0,0,0,0,1)}function s(n){if(0===n)return this;var r=e(n),a=t(n);return this._t(r,0,a,0,0,1,0,0,-a,0,r,0,0,0,0,1)}function u(n){if(0===n)return this;var r=e(n),a=t(n);return this._t(r,-a,0,0,a,r,0,0,0,0,1,0,0,0,0,1)}function c(e,t){return this._t(1,t,e,1,0,0)}function l(e,t){return this.shear(n(e),n(t))}function h(r,a){var i=e(a),o=t(a);return this._t(i,o,0,0,-o,i,0,0,0,0,1,0,0,0,0,1)._t(1,0,0,0,n(r),1,0,0,0,0,1,0,0,0,0,1)._t(i,-o,0,0,o,i,0,0,0,0,1,0,0,0,0,1)}function f(e,t,n){return n||0===n||(n=1),1===e&&1===t&&1===n?this:this._t(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1)}function p(e,t,n,r,a,i,o,s,u,c,l,h,f,p,d,m){return this.props[0]=e,this.props[1]=t,this.props[2]=n,this.props[3]=r,this.props[4]=a,this.props[5]=i,this.props[6]=o,this.props[7]=s,this.props[8]=u,this.props[9]=c,this.props[10]=l,this.props[11]=h,this.props[12]=f,this.props[13]=p,this.props[14]=d,this.props[15]=m,this}function d(e,t,n){return n=n||0,0!==e||0!==t||0!==n?this._t(1,0,0,0,0,1,0,0,0,0,1,0,e,t,n,1):this}function m(e,t,n,r,a,i,o,s,u,c,l,h,f,p,d,m){var v=this.props;if(1===e&&0===t&&0===n&&0===r&&0===a&&1===i&&0===o&&0===s&&0===u&&0===c&&1===l&&0===h)return v[12]=v[12]*e+v[15]*f,v[13]=v[13]*i+v[15]*p,v[14]=v[14]*l+v[15]*d,v[15]*=m,this._identityCalculated=!1,this;var g=v[0],y=v[1],b=v[2],k=v[3],x=v[4],w=v[5],_=v[6],S=v[7],C=v[8],T=v[9],E=v[10],I=v[11],A=v[12],N=v[13],P=v[14],M=v[15];return v[0]=g*e+y*a+b*u+k*f,v[1]=g*t+y*i+b*c+k*p,v[2]=g*n+y*o+b*l+k*d,v[3]=g*r+y*s+b*h+k*m,v[4]=x*e+w*a+_*u+S*f,v[5]=x*t+w*i+_*c+S*p,v[6]=x*n+w*o+_*l+S*d,v[7]=x*r+w*s+_*h+S*m,v[8]=C*e+T*a+E*u+I*f,v[9]=C*t+T*i+E*c+I*p,v[10]=C*n+T*o+E*l+I*d,v[11]=C*r+T*s+E*h+I*m,v[12]=A*e+N*a+P*u+M*f,v[13]=A*t+N*i+P*c+M*p,v[14]=A*n+N*o+P*l+M*d,v[15]=A*r+N*s+P*h+M*m,this._identityCalculated=!1,this}function v(){return this._identityCalculated||(this._identity=!(1!==this.props[0]||0!==this.props[1]||0!==this.props[2]||0!==this.props[3]||0!==this.props[4]||1!==this.props[5]||0!==this.props[6]||0!==this.props[7]||0!==this.props[8]||0!==this.props[9]||1!==this.props[10]||0!==this.props[11]||0!==this.props[12]||0!==this.props[13]||0!==this.props[14]||1!==this.props[15]),this._identityCalculated=!0),this._identity}function g(e){for(var t=0;t<16;){if(e.props[t]!==this.props[t])return!1;t+=1}return!0}function y(e){var t;for(t=0;t<16;t+=1)e.props[t]=this.props[t];return e}function b(e){var t;for(t=0;t<16;t+=1)this.props[t]=e[t]}function k(e,t,n){return{x:e*this.props[0]+t*this.props[4]+n*this.props[8]+this.props[12],y:e*this.props[1]+t*this.props[5]+n*this.props[9]+this.props[13],z:e*this.props[2]+t*this.props[6]+n*this.props[10]+this.props[14]}}function x(e,t,n){return e*this.props[0]+t*this.props[4]+n*this.props[8]+this.props[12]}function w(e,t,n){return e*this.props[1]+t*this.props[5]+n*this.props[9]+this.props[13]}function _(e,t,n){return e*this.props[2]+t*this.props[6]+n*this.props[10]+this.props[14]}function S(){var e=this.props[0]*this.props[5]-this.props[1]*this.props[4],t=this.props[5]/e,n=-this.props[1]/e,r=-this.props[4]/e,a=this.props[0]/e,i=(this.props[4]*this.props[13]-this.props[5]*this.props[12])/e,o=-(this.props[0]*this.props[13]-this.props[1]*this.props[12])/e,s=new Matrix;return s.props[0]=t,s.props[1]=n,s.props[4]=r,s.props[5]=a,s.props[12]=i,s.props[13]=o,s}function C(e){return this.getInverseMatrix().applyToPointArray(e[0],e[1],e[2]||0)}function T(e){var t,n=e.length,r=[];for(t=0;t<n;t+=1)r[t]=C(e[t]);return r}function E(e,t,n){var r=createTypedArray("float32",6);if(this.isIdentity())r[0]=e[0],r[1]=e[1],r[2]=t[0],r[3]=t[1],r[4]=n[0],r[5]=n[1];else{var a=this.props[0],i=this.props[1],o=this.props[4],s=this.props[5],u=this.props[12],c=this.props[13];r[0]=e[0]*a+e[1]*o+u,r[1]=e[0]*i+e[1]*s+c,r[2]=t[0]*a+t[1]*o+u,r[3]=t[0]*i+t[1]*s+c,r[4]=n[0]*a+n[1]*o+u,r[5]=n[0]*i+n[1]*s+c}return r}function I(e,t,n){return this.isIdentity()?[e,t,n]:[e*this.props[0]+t*this.props[4]+n*this.props[8]+this.props[12],e*this.props[1]+t*this.props[5]+n*this.props[9]+this.props[13],e*this.props[2]+t*this.props[6]+n*this.props[10]+this.props[14]]}function A(e,t){if(this.isIdentity())return e+","+t;var n=this.props;return Math.round(100*(e*n[0]+t*n[4]+n[12]))/100+","+Math.round(100*(e*n[1]+t*n[5]+n[13]))/100}function N(){for(var e=0,t=this.props,n="matrix3d(";e<16;)n+=r(1e4*t[e])/1e4,n+=15===e?")":",",e+=1;return n}function P(e){return e<1e-6&&e>0||e>-1e-6&&e<0?r(1e4*e)/1e4:e}function M(){var e=this.props;return"matrix("+P(e[0])+","+P(e[1])+","+P(e[4])+","+P(e[5])+","+P(e[12])+","+P(e[13])+")"}return function(){this.reset=a,this.rotate=i,this.rotateX=o,this.rotateY=s,this.rotateZ=u,this.skew=l,this.skewFromAxis=h,this.shear=c,this.scale=f,this.setTransform=p,this.translate=d,this.transform=m,this.applyToPoint=k,this.applyToX=x,this.applyToY=w,this.applyToZ=_,this.applyToPointArray=I,this.applyToTriplePoints=E,this.applyToPointStringified=A,this.toCSS=N,this.to2dCSS=M,this.clone=y,this.cloneFromProps=b,this.equals=g,this.inversePoints=T,this.inversePoint=C,this.getInverseMatrix=S,this._t=this.transform,this.isIdentity=v,this._identity=!0,this._identityCalculated=!1,this.props=createTypedArray("float32",16),this.reset()}}();function _typeof$3(e){return _typeof$3="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof$3(e)}var lottie={},standalone="__[STANDALONE]__",animationData="__[ANIMATIONDATA]__",renderer="";function setLocation(e){setLocationHref(e)}function searchAnimations(){!0===standalone?animationManager.searchAnimations(animationData,standalone,renderer):animationManager.searchAnimations()}function setSubframeRendering(e){setSubframeEnabled(e)}function setPrefix(e){setIdPrefix(e)}function loadAnimation(e){return!0===standalone&&(e.animationData=JSON.parse(animationData)),animationManager.loadAnimation(e)}function setQuality(e){if("string"===typeof e)switch(e){case"high":setDefaultCurveSegments(200);break;default:case"medium":setDefaultCurveSegments(50);break;case"low":setDefaultCurveSegments(10)}else!isNaN(e)&&e>1&&setDefaultCurveSegments(e);getDefaultCurveSegments()>=50?roundValues(!1):roundValues(!0)}function inBrowser(){return"undefined"!==typeof navigator}function installPlugin(e,t){"expressions"===e&&setExpressionsPlugin(t)}function getFactory(e){switch(e){case"propertyFactory":return PropertyFactory;case"shapePropertyFactory":return ShapePropertyFactory;case"matrix":return Matrix;default:return null}}function checkReady(){"complete"===document.readyState&&(clearInterval(readyStateCheckInterval),searchAnimations())}function getQueryVariable(e){for(var t=queryString.split("&"),n=0;n<t.length;n+=1){var r=t[n].split("=");if(decodeURIComponent(r[0])==e)return decodeURIComponent(r[1])}return null}lottie.play=animationManager.play,lottie.pause=animationManager.pause,lottie.setLocationHref=setLocation,lottie.togglePause=animationManager.togglePause,lottie.setSpeed=animationManager.setSpeed,lottie.setDirection=animationManager.setDirection,lottie.stop=animationManager.stop,lottie.searchAnimations=searchAnimations,lottie.registerAnimation=animationManager.registerAnimation,lottie.loadAnimation=loadAnimation,lottie.setSubframeRendering=setSubframeRendering,lottie.resize=animationManager.resize,lottie.goToAndStop=animationManager.goToAndStop,lottie.destroy=animationManager.destroy,lottie.setQuality=setQuality,lottie.inBrowser=inBrowser,lottie.installPlugin=installPlugin,lottie.freeze=animationManager.freeze,lottie.unfreeze=animationManager.unfreeze,lottie.setVolume=animationManager.setVolume,lottie.mute=animationManager.mute,lottie.unmute=animationManager.unmute,lottie.getRegisteredAnimations=animationManager.getRegisteredAnimations,lottie.useWebWorker=setWebWorker,lottie.setIDPrefix=setPrefix,lottie.__getFactory=getFactory,lottie.version="5.9.4";var queryString="";if(standalone){var scripts=document.getElementsByTagName("script"),index=scripts.length-1,myScript=scripts[index]||{src:""};queryString=myScript.src?myScript.src.replace(/^[^\?]+\??/,""):"",renderer=getQueryVariable("renderer")}var readyStateCheckInterval=setInterval(checkReady,100);try{"object"!==_typeof$3(exports)&&__webpack_require__.amdO}catch(err){}var ShapeModifiers=function(){var e={},t={};return e.registerModifier=function(e,n){t[e]||(t[e]=n)},e.getModifier=function(e,n,r){return new t[e](n,r)},e}();function ShapeModifier(){}function TrimModifier(){}function PuckerAndBloatModifier(){}ShapeModifier.prototype.initModifierProperties=function(){},ShapeModifier.prototype.addShapeToModifier=function(){},ShapeModifier.prototype.addShape=function(e){if(!this.closed){e.sh.container.addDynamicProperty(e.sh);var t={shape:e.sh,data:e,localShapeCollection:shapeCollectionPool.newShapeCollection()};this.shapes.push(t),this.addShapeToModifier(t),this._isAnimated&&e.setAsAnimated()}},ShapeModifier.prototype.init=function(e,t){this.shapes=[],this.elem=e,this.initDynamicPropertyContainer(e),this.initModifierProperties(e,t),this.frameId=initialDefaultFrame,this.closed=!1,this.k=!1,this.dynamicProperties.length?this.k=!0:this.getValue(!0)},ShapeModifier.prototype.processKeys=function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties())},extendPrototype([DynamicPropertyContainer],ShapeModifier),extendPrototype([ShapeModifier],TrimModifier),TrimModifier.prototype.initModifierProperties=function(e,t){this.s=PropertyFactory.getProp(e,t.s,0,.01,this),this.e=PropertyFactory.getProp(e,t.e,0,.01,this),this.o=PropertyFactory.getProp(e,t.o,0,0,this),this.sValue=0,this.eValue=0,this.getValue=this.processKeys,this.m=t.m,this._isAnimated=!!this.s.effectsSequence.length||!!this.e.effectsSequence.length||!!this.o.effectsSequence.length},TrimModifier.prototype.addShapeToModifier=function(e){e.pathsData=[]},TrimModifier.prototype.calculateShapeEdges=function(e,t,n,r,a){var i=[];t<=1?i.push({s:e,e:t}):e>=1?i.push({s:e-1,e:t-1}):(i.push({s:e,e:1}),i.push({s:0,e:t-1}));var o,s,u=[],c=i.length;for(o=0;o<c;o+=1){var l,h;(s=i[o]).e*a<r||s.s*a>r+n||(l=s.s*a<=r?0:(s.s*a-r)/n,h=s.e*a>=r+n?1:(s.e*a-r)/n,u.push([l,h]))}return u.length||u.push([0,0]),u},TrimModifier.prototype.releasePathsData=function(e){var t,n=e.length;for(t=0;t<n;t+=1)segmentsLengthPool.release(e[t]);return e.length=0,e},TrimModifier.prototype.processShapes=function(e){var t,n,r,a;if(this._mdf||e){var i=this.o.v%360/360;if(i<0&&(i+=1),(t=this.s.v>1?1+i:this.s.v<0?0+i:this.s.v+i)>(n=this.e.v>1?1+i:this.e.v<0?0+i:this.e.v+i)){var o=t;t=n,n=o}t=1e-4*Math.round(1e4*t),n=1e-4*Math.round(1e4*n),this.sValue=t,this.eValue=n}else t=this.sValue,n=this.eValue;var s,u,c,l,h,f=this.shapes.length,p=0;if(n===t)for(a=0;a<f;a+=1)this.shapes[a].localShapeCollection.releaseShapes(),this.shapes[a].shape._mdf=!0,this.shapes[a].shape.paths=this.shapes[a].localShapeCollection,this._mdf&&(this.shapes[a].pathsData.length=0);else if(1===n&&0===t||0===n&&1===t){if(this._mdf)for(a=0;a<f;a+=1)this.shapes[a].pathsData.length=0,this.shapes[a].shape._mdf=!0}else{var d,m,v=[];for(a=0;a<f;a+=1)if((d=this.shapes[a]).shape._mdf||this._mdf||e||2===this.m){if(u=(r=d.shape.paths)._length,h=0,!d.shape._mdf&&d.pathsData.length)h=d.totalShapeLength;else{for(c=this.releasePathsData(d.pathsData),s=0;s<u;s+=1)l=bez.getSegmentsLength(r.shapes[s]),c.push(l),h+=l.totalLength;d.totalShapeLength=h,d.pathsData=c}p+=h,d.shape._mdf=!0}else d.shape.paths=d.localShapeCollection;var g,y=t,b=n,k=0;for(a=f-1;a>=0;a-=1)if((d=this.shapes[a]).shape._mdf){for((m=d.localShapeCollection).releaseShapes(),2===this.m&&f>1?(g=this.calculateShapeEdges(t,n,d.totalShapeLength,k,p),k+=d.totalShapeLength):g=[[y,b]],u=g.length,s=0;s<u;s+=1){y=g[s][0],b=g[s][1],v.length=0,b<=1?v.push({s:d.totalShapeLength*y,e:d.totalShapeLength*b}):y>=1?v.push({s:d.totalShapeLength*(y-1),e:d.totalShapeLength*(b-1)}):(v.push({s:d.totalShapeLength*y,e:d.totalShapeLength}),v.push({s:0,e:d.totalShapeLength*(b-1)}));var x=this.addShapes(d,v[0]);if(v[0].s!==v[0].e){if(v.length>1)if(d.shape.paths.shapes[d.shape.paths._length-1].c){var w=x.pop();this.addPaths(x,m),x=this.addShapes(d,v[1],w)}else this.addPaths(x,m),x=this.addShapes(d,v[1]);this.addPaths(x,m)}}d.shape.paths=m}}},TrimModifier.prototype.addPaths=function(e,t){var n,r=e.length;for(n=0;n<r;n+=1)t.addShape(e[n])},TrimModifier.prototype.addSegment=function(e,t,n,r,a,i,o){a.setXYAt(t[0],t[1],"o",i),a.setXYAt(n[0],n[1],"i",i+1),o&&a.setXYAt(e[0],e[1],"v",i),a.setXYAt(r[0],r[1],"v",i+1)},TrimModifier.prototype.addSegmentFromArray=function(e,t,n,r){t.setXYAt(e[1],e[5],"o",n),t.setXYAt(e[2],e[6],"i",n+1),r&&t.setXYAt(e[0],e[4],"v",n),t.setXYAt(e[3],e[7],"v",n+1)},TrimModifier.prototype.addShapes=function(e,t,n){var r,a,i,o,s,u,c,l,h=e.pathsData,f=e.shape.paths.shapes,p=e.shape.paths._length,d=0,m=[],v=!0;for(n?(s=n._length,l=n._length):(n=shapePool.newElement(),s=0,l=0),m.push(n),r=0;r<p;r+=1){for(u=h[r].lengths,n.c=f[r].c,i=f[r].c?u.length:u.length+1,a=1;a<i;a+=1)if(d+(o=u[a-1]).addedLength<t.s)d+=o.addedLength,n.c=!1;else{if(d>t.e){n.c=!1;break}t.s<=d&&t.e>=d+o.addedLength?(this.addSegment(f[r].v[a-1],f[r].o[a-1],f[r].i[a],f[r].v[a],n,s,v),v=!1):(c=bez.getNewSegment(f[r].v[a-1],f[r].v[a],f[r].o[a-1],f[r].i[a],(t.s-d)/o.addedLength,(t.e-d)/o.addedLength,u[a-1]),this.addSegmentFromArray(c,n,s,v),v=!1,n.c=!1),d+=o.addedLength,s+=1}if(f[r].c&&u.length){if(o=u[a-1],d<=t.e){var g=u[a-1].addedLength;t.s<=d&&t.e>=d+g?(this.addSegment(f[r].v[a-1],f[r].o[a-1],f[r].i[0],f[r].v[0],n,s,v),v=!1):(c=bez.getNewSegment(f[r].v[a-1],f[r].v[0],f[r].o[a-1],f[r].i[0],(t.s-d)/g,(t.e-d)/g,u[a-1]),this.addSegmentFromArray(c,n,s,v),v=!1,n.c=!1)}else n.c=!1;d+=o.addedLength,s+=1}if(n._length&&(n.setXYAt(n.v[l][0],n.v[l][1],"i",l),n.setXYAt(n.v[n._length-1][0],n.v[n._length-1][1],"o",n._length-1)),d>t.e)break;r<p-1&&(n=shapePool.newElement(),v=!0,m.push(n),s=0)}return m},extendPrototype([ShapeModifier],PuckerAndBloatModifier),PuckerAndBloatModifier.prototype.initModifierProperties=function(e,t){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(e,t.a,0,null,this),this._isAnimated=!!this.amount.effectsSequence.length},PuckerAndBloatModifier.prototype.processPath=function(e,t){var n=t/100,r=[0,0],a=e._length,i=0;for(i=0;i<a;i+=1)r[0]+=e.v[i][0],r[1]+=e.v[i][1];r[0]/=a,r[1]/=a;var o,s,u,c,l,h,f=shapePool.newElement();for(f.c=e.c,i=0;i<a;i+=1)o=e.v[i][0]+(r[0]-e.v[i][0])*n,s=e.v[i][1]+(r[1]-e.v[i][1])*n,u=e.o[i][0]+(r[0]-e.o[i][0])*-n,c=e.o[i][1]+(r[1]-e.o[i][1])*-n,l=e.i[i][0]+(r[0]-e.i[i][0])*-n,h=e.i[i][1]+(r[1]-e.i[i][1])*-n,f.setTripleAt(o,s,u,c,l,h,i);return f},PuckerAndBloatModifier.prototype.processShapes=function(e){var t,n,r,a,i,o,s=this.shapes.length,u=this.amount.v;if(0!==u)for(n=0;n<s;n+=1){if(o=(i=this.shapes[n]).localShapeCollection,i.shape._mdf||this._mdf||e)for(o.releaseShapes(),i.shape._mdf=!0,t=i.shape.paths.shapes,a=i.shape.paths._length,r=0;r<a;r+=1)o.addShape(this.processPath(t[r],u));i.shape.paths=i.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)};var TransformPropertyFactory=function(){var e=[0,0];function t(e,t,n){if(this.elem=e,this.frameId=-1,this.propType="transform",this.data=t,this.v=new Matrix,this.pre=new Matrix,this.appliedTransformations=0,this.initDynamicPropertyContainer(n||e),t.p&&t.p.s?(this.px=PropertyFactory.getProp(e,t.p.x,0,0,this),this.py=PropertyFactory.getProp(e,t.p.y,0,0,this),t.p.z&&(this.pz=PropertyFactory.getProp(e,t.p.z,0,0,this))):this.p=PropertyFactory.getProp(e,t.p||{k:[0,0,0]},1,0,this),t.rx){if(this.rx=PropertyFactory.getProp(e,t.rx,0,degToRads,this),this.ry=PropertyFactory.getProp(e,t.ry,0,degToRads,this),this.rz=PropertyFactory.getProp(e,t.rz,0,degToRads,this),t.or.k[0].ti){var r,a=t.or.k.length;for(r=0;r<a;r+=1)t.or.k[r].to=null,t.or.k[r].ti=null}this.or=PropertyFactory.getProp(e,t.or,1,degToRads,this),this.or.sh=!0}else this.r=PropertyFactory.getProp(e,t.r||{k:0},0,degToRads,this);t.sk&&(this.sk=PropertyFactory.getProp(e,t.sk,0,degToRads,this),this.sa=PropertyFactory.getProp(e,t.sa,0,degToRads,this)),this.a=PropertyFactory.getProp(e,t.a||{k:[0,0,0]},1,0,this),this.s=PropertyFactory.getProp(e,t.s||{k:[100,100,100]},1,.01,this),t.o?this.o=PropertyFactory.getProp(e,t.o,0,.01,e):this.o={_mdf:!1,v:1},this._isDirty=!0,this.dynamicProperties.length||this.getValue(!0)}return t.prototype={applyToMatrix:function(e){var t=this._mdf;this.iterateDynamicProperties(),this._mdf=this._mdf||t,this.a&&e.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.s&&e.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&e.skewFromAxis(-this.sk.v,this.sa.v),this.r?e.rotate(-this.r.v):e.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.data.p.s?this.data.p.z?e.translate(this.px.v,this.py.v,-this.pz.v):e.translate(this.px.v,this.py.v,0):e.translate(this.p.v[0],this.p.v[1],-this.p.v[2])},getValue:function(t){if(this.elem.globalData.frameId!==this.frameId){if(this._isDirty&&(this.precalculateMatrix(),this._isDirty=!1),this.iterateDynamicProperties(),this._mdf||t){var n;if(this.v.cloneFromProps(this.pre.props),this.appliedTransformations<1&&this.v.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations<2&&this.v.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&this.appliedTransformations<3&&this.v.skewFromAxis(-this.sk.v,this.sa.v),this.r&&this.appliedTransformations<4?this.v.rotate(-this.r.v):!this.r&&this.appliedTransformations<4&&this.v.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.autoOriented){var r,a;if(n=this.elem.globalData.frameRate,this.p&&this.p.keyframes&&this.p.getValueAtTime)this.p._caching.lastFrame+this.p.offsetTime<=this.p.keyframes[0].t?(r=this.p.getValueAtTime((this.p.keyframes[0].t+.01)/n,0),a=this.p.getValueAtTime(this.p.keyframes[0].t/n,0)):this.p._caching.lastFrame+this.p.offsetTime>=this.p.keyframes[this.p.keyframes.length-1].t?(r=this.p.getValueAtTime(this.p.keyframes[this.p.keyframes.length-1].t/n,0),a=this.p.getValueAtTime((this.p.keyframes[this.p.keyframes.length-1].t-.05)/n,0)):(r=this.p.pv,a=this.p.getValueAtTime((this.p._caching.lastFrame+this.p.offsetTime-.01)/n,this.p.offsetTime));else if(this.px&&this.px.keyframes&&this.py.keyframes&&this.px.getValueAtTime&&this.py.getValueAtTime){r=[],a=[];var i=this.px,o=this.py;i._caching.lastFrame+i.offsetTime<=i.keyframes[0].t?(r[0]=i.getValueAtTime((i.keyframes[0].t+.01)/n,0),r[1]=o.getValueAtTime((o.keyframes[0].t+.01)/n,0),a[0]=i.getValueAtTime(i.keyframes[0].t/n,0),a[1]=o.getValueAtTime(o.keyframes[0].t/n,0)):i._caching.lastFrame+i.offsetTime>=i.keyframes[i.keyframes.length-1].t?(r[0]=i.getValueAtTime(i.keyframes[i.keyframes.length-1].t/n,0),r[1]=o.getValueAtTime(o.keyframes[o.keyframes.length-1].t/n,0),a[0]=i.getValueAtTime((i.keyframes[i.keyframes.length-1].t-.01)/n,0),a[1]=o.getValueAtTime((o.keyframes[o.keyframes.length-1].t-.01)/n,0)):(r=[i.pv,o.pv],a[0]=i.getValueAtTime((i._caching.lastFrame+i.offsetTime-.01)/n,i.offsetTime),a[1]=o.getValueAtTime((o._caching.lastFrame+o.offsetTime-.01)/n,o.offsetTime))}else r=a=e;this.v.rotate(-Math.atan2(r[1]-a[1],r[0]-a[0]))}this.data.p&&this.data.p.s?this.data.p.z?this.v.translate(this.px.v,this.py.v,-this.pz.v):this.v.translate(this.px.v,this.py.v,0):this.v.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}this.frameId=this.elem.globalData.frameId}},precalculateMatrix:function(){if(!this.a.k&&(this.pre.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations=1,!this.s.effectsSequence.length)){if(this.pre.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.appliedTransformations=2,this.sk){if(this.sk.effectsSequence.length||this.sa.effectsSequence.length)return;this.pre.skewFromAxis(-this.sk.v,this.sa.v),this.appliedTransformations=3}this.r?this.r.effectsSequence.length||(this.pre.rotate(-this.r.v),this.appliedTransformations=4):this.rz.effectsSequence.length||this.ry.effectsSequence.length||this.rx.effectsSequence.length||this.or.effectsSequence.length||(this.pre.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.appliedTransformations=4)}},autoOrient:function(){}},extendPrototype([DynamicPropertyContainer],t),t.prototype.addDynamicProperty=function(e){this._addDynamicProperty(e),this.elem.addDynamicProperty(e),this._isDirty=!0},t.prototype._addDynamicProperty=DynamicPropertyContainer.prototype.addDynamicProperty,{getTransformProperty:function(e,n,r){return new t(e,n,r)}}}();function RepeaterModifier(){}function RoundCornersModifier(){}function getFontProperties(e){for(var t=e.fStyle?e.fStyle.split(" "):[],n="normal",r="normal",a=t.length,i=0;i<a;i+=1)switch(t[i].toLowerCase()){case"italic":r="italic";break;case"bold":n="700";break;case"black":n="900";break;case"medium":n="500";break;case"regular":case"normal":n="400";break;case"light":case"thin":n="200"}return{style:r,weight:e.fWeight||n}}extendPrototype([ShapeModifier],RepeaterModifier),RepeaterModifier.prototype.initModifierProperties=function(e,t){this.getValue=this.processKeys,this.c=PropertyFactory.getProp(e,t.c,0,null,this),this.o=PropertyFactory.getProp(e,t.o,0,null,this),this.tr=TransformPropertyFactory.getTransformProperty(e,t.tr,this),this.so=PropertyFactory.getProp(e,t.tr.so,0,.01,this),this.eo=PropertyFactory.getProp(e,t.tr.eo,0,.01,this),this.data=t,this.dynamicProperties.length||this.getValue(!0),this._isAnimated=!!this.dynamicProperties.length,this.pMatrix=new Matrix,this.rMatrix=new Matrix,this.sMatrix=new Matrix,this.tMatrix=new Matrix,this.matrix=new Matrix},RepeaterModifier.prototype.applyTransforms=function(e,t,n,r,a,i){var o=i?-1:1,s=r.s.v[0]+(1-r.s.v[0])*(1-a),u=r.s.v[1]+(1-r.s.v[1])*(1-a);e.translate(r.p.v[0]*o*a,r.p.v[1]*o*a,r.p.v[2]),t.translate(-r.a.v[0],-r.a.v[1],r.a.v[2]),t.rotate(-r.r.v*o*a),t.translate(r.a.v[0],r.a.v[1],r.a.v[2]),n.translate(-r.a.v[0],-r.a.v[1],r.a.v[2]),n.scale(i?1/s:s,i?1/u:u),n.translate(r.a.v[0],r.a.v[1],r.a.v[2])},RepeaterModifier.prototype.init=function(e,t,n,r){for(this.elem=e,this.arr=t,this.pos=n,this.elemsData=r,this._currentCopies=0,this._elements=[],this._groups=[],this.frameId=-1,this.initDynamicPropertyContainer(e),this.initModifierProperties(e,t[n]);n>0;)n-=1,this._elements.unshift(t[n]);this.dynamicProperties.length?this.k=!0:this.getValue(!0)},RepeaterModifier.prototype.resetElements=function(e){var t,n=e.length;for(t=0;t<n;t+=1)e[t]._processed=!1,"gr"===e[t].ty&&this.resetElements(e[t].it)},RepeaterModifier.prototype.cloneElements=function(e){var t=JSON.parse(JSON.stringify(e));return this.resetElements(t),t},RepeaterModifier.prototype.changeGroupRender=function(e,t){var n,r=e.length;for(n=0;n<r;n+=1)e[n]._render=t,"gr"===e[n].ty&&this.changeGroupRender(e[n].it,t)},RepeaterModifier.prototype.processShapes=function(e){var t,n,r,a,i,o=!1;if(this._mdf||e){var s,u=Math.ceil(this.c.v);if(this._groups.length<u){for(;this._groups.length<u;){var c={it:this.cloneElements(this._elements),ty:"gr"};c.it.push({a:{a:0,ix:1,k:[0,0]},nm:"Transform",o:{a:0,ix:7,k:100},p:{a:0,ix:2,k:[0,0]},r:{a:1,ix:6,k:[{s:0,e:0,t:0},{s:0,e:0,t:1}]},s:{a:0,ix:3,k:[100,100]},sa:{a:0,ix:5,k:0},sk:{a:0,ix:4,k:0},ty:"tr"}),this.arr.splice(0,0,c),this._groups.splice(0,0,c),this._currentCopies+=1}this.elem.reloadShapes(),o=!0}for(i=0,r=0;r<=this._groups.length-1;r+=1){if(s=i<u,this._groups[r]._render=s,this.changeGroupRender(this._groups[r].it,s),!s){var l=this.elemsData[r].it,h=l[l.length-1];0!==h.transform.op.v?(h.transform.op._mdf=!0,h.transform.op.v=0):h.transform.op._mdf=!1}i+=1}this._currentCopies=u;var f=this.o.v,p=f%1,d=f>0?Math.floor(f):Math.ceil(f),m=this.pMatrix.props,v=this.rMatrix.props,g=this.sMatrix.props;this.pMatrix.reset(),this.rMatrix.reset(),this.sMatrix.reset(),this.tMatrix.reset(),this.matrix.reset();var y,b,k=0;if(f>0){for(;k<d;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),k+=1;p&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,p,!1),k+=p)}else if(f<0){for(;k>d;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!0),k-=1;p&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,-p,!0),k-=p)}for(r=1===this.data.m?0:this._currentCopies-1,a=1===this.data.m?1:-1,i=this._currentCopies;i;){if(b=(n=(t=this.elemsData[r].it)[t.length-1].transform.mProps.v.props).length,t[t.length-1].transform.mProps._mdf=!0,t[t.length-1].transform.op._mdf=!0,t[t.length-1].transform.op.v=1===this._currentCopies?this.so.v:this.so.v+(this.eo.v-this.so.v)*(r/(this._currentCopies-1)),0!==k){for((0!==r&&1===a||r!==this._currentCopies-1&&-1===a)&&this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),this.matrix.transform(v[0],v[1],v[2],v[3],v[4],v[5],v[6],v[7],v[8],v[9],v[10],v[11],v[12],v[13],v[14],v[15]),this.matrix.transform(g[0],g[1],g[2],g[3],g[4],g[5],g[6],g[7],g[8],g[9],g[10],g[11],g[12],g[13],g[14],g[15]),this.matrix.transform(m[0],m[1],m[2],m[3],m[4],m[5],m[6],m[7],m[8],m[9],m[10],m[11],m[12],m[13],m[14],m[15]),y=0;y<b;y+=1)n[y]=this.matrix.props[y];this.matrix.reset()}else for(this.matrix.reset(),y=0;y<b;y+=1)n[y]=this.matrix.props[y];k+=1,i-=1,r+=a}}else for(i=this._currentCopies,r=0,a=1;i;)n=(t=this.elemsData[r].it)[t.length-1].transform.mProps.v.props,t[t.length-1].transform.mProps._mdf=!1,t[t.length-1].transform.op._mdf=!1,i-=1,r+=a;return o},RepeaterModifier.prototype.addShape=function(){},extendPrototype([ShapeModifier],RoundCornersModifier),RoundCornersModifier.prototype.initModifierProperties=function(e,t){this.getValue=this.processKeys,this.rd=PropertyFactory.getProp(e,t.r,0,null,this),this._isAnimated=!!this.rd.effectsSequence.length},RoundCornersModifier.prototype.processPath=function(e,t){var n,r=shapePool.newElement();r.c=e.c;var a,i,o,s,u,c,l,h,f,p,d,m,v=e._length,g=0;for(n=0;n<v;n+=1)a=e.v[n],o=e.o[n],i=e.i[n],a[0]===o[0]&&a[1]===o[1]&&a[0]===i[0]&&a[1]===i[1]?0!==n&&n!==v-1||e.c?(s=0===n?e.v[v-1]:e.v[n-1],c=(u=Math.sqrt(Math.pow(a[0]-s[0],2)+Math.pow(a[1]-s[1],2)))?Math.min(u/2,t)/u:0,l=d=a[0]+(s[0]-a[0])*c,h=m=a[1]-(a[1]-s[1])*c,f=l-(l-a[0])*roundCorner,p=h-(h-a[1])*roundCorner,r.setTripleAt(l,h,f,p,d,m,g),g+=1,s=n===v-1?e.v[0]:e.v[n+1],c=(u=Math.sqrt(Math.pow(a[0]-s[0],2)+Math.pow(a[1]-s[1],2)))?Math.min(u/2,t)/u:0,l=f=a[0]+(s[0]-a[0])*c,h=p=a[1]+(s[1]-a[1])*c,d=l-(l-a[0])*roundCorner,m=h-(h-a[1])*roundCorner,r.setTripleAt(l,h,f,p,d,m,g),g+=1):(r.setTripleAt(a[0],a[1],o[0],o[1],i[0],i[1],g),g+=1):(r.setTripleAt(e.v[n][0],e.v[n][1],e.o[n][0],e.o[n][1],e.i[n][0],e.i[n][1],g),g+=1);return r},RoundCornersModifier.prototype.processShapes=function(e){var t,n,r,a,i,o,s=this.shapes.length,u=this.rd.v;if(0!==u)for(n=0;n<s;n+=1){if(o=(i=this.shapes[n]).localShapeCollection,i.shape._mdf||this._mdf||e)for(o.releaseShapes(),i.shape._mdf=!0,t=i.shape.paths.shapes,a=i.shape.paths._length,r=0;r<a;r+=1)o.addShape(this.processPath(t[r],u));i.shape.paths=i.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)};var FontManager=function(){var e={w:0,size:0,shapes:[],data:{shapes:[]}},t=[];t=t.concat([2304,2305,2306,2307,2362,2363,2364,2364,2366,2367,2368,2369,2370,2371,2372,2373,2374,2375,2376,2377,2378,2379,2380,2381,2382,2383,2387,2388,2389,2390,2391,2402,2403]);var n=["d83cdffb","d83cdffc","d83cdffd","d83cdffe","d83cdfff"],r=[65039,8205];function a(e,t){var n=createTag("span");n.setAttribute("aria-hidden",!0),n.style.fontFamily=t;var r=createTag("span");r.innerText="giItT1WQy@!-/#",n.style.position="absolute",n.style.left="-10000px",n.style.top="-10000px",n.style.fontSize="300px",n.style.fontVariant="normal",n.style.fontStyle="normal",n.style.fontWeight="normal",n.style.letterSpacing="0",n.appendChild(r),document.body.appendChild(n);var a=r.offsetWidth;return r.style.fontFamily=function(e){var t,n=e.split(","),r=n.length,a=[];for(t=0;t<r;t+=1)"sans-serif"!==n[t]&&"monospace"!==n[t]&&a.push(n[t]);return a.join(",")}(e)+", "+t,{node:r,w:a,parent:n}}function i(e,t){var n,r=document.body&&t?"svg":"canvas",a=getFontProperties(e);if("svg"===r){var i=createNS("text");i.style.fontSize="100px",i.setAttribute("font-family",e.fFamily),i.setAttribute("font-style",a.style),i.setAttribute("font-weight",a.weight),i.textContent="1",e.fClass?(i.style.fontFamily="inherit",i.setAttribute("class",e.fClass)):i.style.fontFamily=e.fFamily,t.appendChild(i),n=i}else{var o=new OffscreenCanvas(500,500).getContext("2d");o.font=a.style+" "+a.weight+" 100px "+e.fFamily,n=o}return{measureText:function(e){return"svg"===r?(n.textContent=e,n.getComputedTextLength()):n.measureText(e).width}}}var o=function(){this.fonts=[],this.chars=null,this.typekitLoaded=0,this.isLoaded=!1,this._warned=!1,this.initTime=Date.now(),this.setIsLoadedBinded=this.setIsLoaded.bind(this),this.checkLoadedFontsBinded=this.checkLoadedFonts.bind(this)};o.isModifier=function(e,t){var r=e.toString(16)+t.toString(16);return-1!==n.indexOf(r)},o.isZeroWidthJoiner=function(e,t){return t?e===r[0]&&t===r[1]:e===r[1]},o.isCombinedCharacter=function(e){return-1!==t.indexOf(e)};var s={addChars:function(e){if(e){var t;this.chars||(this.chars=[]);var n,r,a=e.length,i=this.chars.length;for(t=0;t<a;t+=1){for(n=0,r=!1;n<i;)this.chars[n].style===e[t].style&&this.chars[n].fFamily===e[t].fFamily&&this.chars[n].ch===e[t].ch&&(r=!0),n+=1;r||(this.chars.push(e[t]),i+=1)}}},addFonts:function(e,t){if(e){if(this.chars)return this.isLoaded=!0,void(this.fonts=e.list);if(!document.body)return this.isLoaded=!0,e.list.forEach((function(e){e.helper=i(e),e.cache={}})),void(this.fonts=e.list);var n,r=e.list,o=r.length,s=o;for(n=0;n<o;n+=1){var u,c,l=!0;if(r[n].loaded=!1,r[n].monoCase=a(r[n].fFamily,"monospace"),r[n].sansCase=a(r[n].fFamily,"sans-serif"),r[n].fPath){if("p"===r[n].fOrigin||3===r[n].origin){if((u=document.querySelectorAll('style[f-forigin="p"][f-family="'+r[n].fFamily+'"], style[f-origin="3"][f-family="'+r[n].fFamily+'"]')).length>0&&(l=!1),l){var h=createTag("style");h.setAttribute("f-forigin",r[n].fOrigin),h.setAttribute("f-origin",r[n].origin),h.setAttribute("f-family",r[n].fFamily),h.type="text/css",h.innerText="@font-face {font-family: "+r[n].fFamily+"; font-style: normal; src: url('"+r[n].fPath+"');}",t.appendChild(h)}}else if("g"===r[n].fOrigin||1===r[n].origin){for(u=document.querySelectorAll('link[f-forigin="g"], link[f-origin="1"]'),c=0;c<u.length;c+=1)-1!==u[c].href.indexOf(r[n].fPath)&&(l=!1);if(l){var f=createTag("link");f.setAttribute("f-forigin",r[n].fOrigin),f.setAttribute("f-origin",r[n].origin),f.type="text/css",f.rel="stylesheet",f.href=r[n].fPath,document.body.appendChild(f)}}else if("t"===r[n].fOrigin||2===r[n].origin){for(u=document.querySelectorAll('script[f-forigin="t"], script[f-origin="2"]'),c=0;c<u.length;c+=1)r[n].fPath===u[c].src&&(l=!1);if(l){var p=createTag("link");p.setAttribute("f-forigin",r[n].fOrigin),p.setAttribute("f-origin",r[n].origin),p.setAttribute("rel","stylesheet"),p.setAttribute("href",r[n].fPath),t.appendChild(p)}}}else r[n].loaded=!0,s-=1;r[n].helper=i(r[n],t),r[n].cache={},this.fonts.push(r[n])}0===s?this.isLoaded=!0:setTimeout(this.checkLoadedFonts.bind(this),100)}else this.isLoaded=!0},getCharData:function(t,n,r){for(var a=0,i=this.chars.length;a<i;){if(this.chars[a].ch===t&&this.chars[a].style===n&&this.chars[a].fFamily===r)return this.chars[a];a+=1}return("string"===typeof t&&13!==t.charCodeAt(0)||!t)&&console&&console.warn&&!this._warned&&(this._warned=!0,console.warn("Missing character from exported characters list: ",t,n,r)),e},getFontByName:function(e){for(var t=0,n=this.fonts.length;t<n;){if(this.fonts[t].fName===e)return this.fonts[t];t+=1}return this.fonts[0]},measureText:function(e,t,n){var r=this.getFontByName(t),a=e.charCodeAt(0);if(!r.cache[a+1]){var i=r.helper;if(" "===e){var o=i.measureText("|"+e+"|"),s=i.measureText("||");r.cache[a+1]=(o-s)/100}else r.cache[a+1]=i.measureText(e)/100}return r.cache[a+1]*n},checkLoadedFonts:function(){var e,t,n,r=this.fonts.length,a=r;for(e=0;e<r;e+=1)this.fonts[e].loaded?a-=1:"n"===this.fonts[e].fOrigin||0===this.fonts[e].origin?this.fonts[e].loaded=!0:(t=this.fonts[e].monoCase.node,n=this.fonts[e].monoCase.w,t.offsetWidth!==n?(a-=1,this.fonts[e].loaded=!0):(t=this.fonts[e].sansCase.node,n=this.fonts[e].sansCase.w,t.offsetWidth!==n&&(a-=1,this.fonts[e].loaded=!0)),this.fonts[e].loaded&&(this.fonts[e].sansCase.parent.parentNode.removeChild(this.fonts[e].sansCase.parent),this.fonts[e].monoCase.parent.parentNode.removeChild(this.fonts[e].monoCase.parent)));0!==a&&Date.now()-this.initTime<5e3?setTimeout(this.checkLoadedFontsBinded,20):setTimeout(this.setIsLoadedBinded,10)},setIsLoaded:function(){this.isLoaded=!0}};return o.prototype=s,o}();function RenderableElement(){}RenderableElement.prototype={initRenderable:function(){this.isInRange=!1,this.hidden=!1,this.isTransparent=!1,this.renderableComponents=[]},addRenderableComponent:function(e){-1===this.renderableComponents.indexOf(e)&&this.renderableComponents.push(e)},removeRenderableComponent:function(e){-1!==this.renderableComponents.indexOf(e)&&this.renderableComponents.splice(this.renderableComponents.indexOf(e),1)},prepareRenderableFrame:function(e){this.checkLayerLimits(e)},checkTransparency:function(){this.finalTransform.mProp.o.v<=0?!this.isTransparent&&this.globalData.renderConfig.hideOnTransparent&&(this.isTransparent=!0,this.hide()):this.isTransparent&&(this.isTransparent=!1,this.show())},checkLayerLimits:function(e){this.data.ip-this.data.st<=e&&this.data.op-this.data.st>e?!0!==this.isInRange&&(this.globalData._mdf=!0,this._mdf=!0,this.isInRange=!0,this.show()):!1!==this.isInRange&&(this.globalData._mdf=!0,this.isInRange=!1,this.hide())},renderRenderable:function(){var e,t=this.renderableComponents.length;for(e=0;e<t;e+=1)this.renderableComponents[e].renderFrame(this._isFirstFrame)},sourceRectAtTime:function(){return{top:0,left:0,width:100,height:100}},getLayerSize:function(){return 5===this.data.ty?{w:this.data.textData.width,h:this.data.textData.height}:{w:this.data.width,h:this.data.height}}};var MaskManagerInterface=function(){function e(e,t){this._mask=e,this._data=t}return Object.defineProperty(e.prototype,"maskPath",{get:function(){return this._mask.prop.k&&this._mask.prop.getValue(),this._mask.prop}}),Object.defineProperty(e.prototype,"maskOpacity",{get:function(){return this._mask.op.k&&this._mask.op.getValue(),100*this._mask.op.v}}),function(t){var n,r=createSizedArray(t.viewData.length),a=t.viewData.length;for(n=0;n<a;n+=1)r[n]=new e(t.viewData[n],t.masksProperties[n]);return function(e){for(n=0;n<a;){if(t.masksProperties[n].nm===e)return r[n];n+=1}return null}}}(),ExpressionPropertyInterface=function(){var e={pv:0,v:0,mult:1},t={pv:[0,0,0],v:[0,0,0],mult:1};function n(e,t,n){Object.defineProperty(e,"velocity",{get:function(){return t.getVelocityAtTime(t.comp.currentFrame)}}),e.numKeys=t.keyframes?t.keyframes.length:0,e.key=function(r){if(!e.numKeys)return 0;var a="";a="s"in t.keyframes[r-1]?t.keyframes[r-1].s:"e"in t.keyframes[r-2]?t.keyframes[r-2].e:t.keyframes[r-2].s;var i="unidimensional"===n?new Number(a):Object.assign({},a);return i.time=t.keyframes[r-1].t/t.elem.comp.globalData.frameRate,i.value="unidimensional"===n?a[0]:a,i},e.valueAtTime=t.getValueAtTime,e.speedAtTime=t.getSpeedAtTime,e.velocityAtTime=t.getVelocityAtTime,e.propertyGroup=t.propertyGroup}function r(){return e}return function(a){return a?"unidimensional"===a.propType?function(t){t&&"pv"in t||(t=e);var r=1/t.mult,a=t.pv*r,i=new Number(a);return i.value=a,n(i,t,"unidimensional"),function(){return t.k&&t.getValue(),a=t.v*r,i.value!==a&&((i=new Number(a)).value=a,n(i,t,"unidimensional")),i}}(a):function(e){e&&"pv"in e||(e=t);var r=1/e.mult,a=e.data&&e.data.l||e.pv.length,i=createTypedArray("float32",a),o=createTypedArray("float32",a);return i.value=o,n(i,e,"multidimensional"),function(){e.k&&e.getValue();for(var t=0;t<a;t+=1)o[t]=e.v[t]*r,i[t]=o[t];return i}}(a):r}}(),TransformExpressionInterface=function(e){function t(e){switch(e){case"scale":case"Scale":case"ADBE Scale":case 6:return t.scale;case"rotation":case"Rotation":case"ADBE Rotation":case"ADBE Rotate Z":case 10:return t.rotation;case"ADBE Rotate X":return t.xRotation;case"ADBE Rotate Y":return t.yRotation;case"position":case"Position":case"ADBE Position":case 2:return t.position;case"ADBE Position_0":return t.xPosition;case"ADBE Position_1":return t.yPosition;case"ADBE Position_2":return t.zPosition;case"anchorPoint":case"AnchorPoint":case"Anchor Point":case"ADBE AnchorPoint":case 1:return t.anchorPoint;case"opacity":case"Opacity":case 11:return t.opacity;default:return null}}var n,r,a,i;return Object.defineProperty(t,"rotation",{get:ExpressionPropertyInterface(e.r||e.rz)}),Object.defineProperty(t,"zRotation",{get:ExpressionPropertyInterface(e.rz||e.r)}),Object.defineProperty(t,"xRotation",{get:ExpressionPropertyInterface(e.rx)}),Object.defineProperty(t,"yRotation",{get:ExpressionPropertyInterface(e.ry)}),Object.defineProperty(t,"scale",{get:ExpressionPropertyInterface(e.s)}),e.p?i=ExpressionPropertyInterface(e.p):(n=ExpressionPropertyInterface(e.px),r=ExpressionPropertyInterface(e.py),e.pz&&(a=ExpressionPropertyInterface(e.pz))),Object.defineProperty(t,"position",{get:function(){return e.p?i():[n(),r(),a?a():0]}}),Object.defineProperty(t,"xPosition",{get:ExpressionPropertyInterface(e.px)}),Object.defineProperty(t,"yPosition",{get:ExpressionPropertyInterface(e.py)}),Object.defineProperty(t,"zPosition",{get:ExpressionPropertyInterface(e.pz)}),Object.defineProperty(t,"anchorPoint",{get:ExpressionPropertyInterface(e.a)}),Object.defineProperty(t,"opacity",{get:ExpressionPropertyInterface(e.o)}),Object.defineProperty(t,"skew",{get:ExpressionPropertyInterface(e.sk)}),Object.defineProperty(t,"skewAxis",{get:ExpressionPropertyInterface(e.sa)}),Object.defineProperty(t,"orientation",{get:ExpressionPropertyInterface(e.or)}),t},LayerExpressionInterface=function(){function e(e){var t=new Matrix;return void 0!==e?this._elem.finalTransform.mProp.getValueAtTime(e).clone(t):this._elem.finalTransform.mProp.applyToMatrix(t),t}function t(e,t){var n=this.getMatrix(t);return n.props[12]=0,n.props[13]=0,n.props[14]=0,this.applyPoint(n,e)}function n(e,t){var n=this.getMatrix(t);return this.applyPoint(n,e)}function r(e,t){var n=this.getMatrix(t);return n.props[12]=0,n.props[13]=0,n.props[14]=0,this.invertPoint(n,e)}function a(e,t){var n=this.getMatrix(t);return this.invertPoint(n,e)}function i(e,t){if(this._elem.hierarchy&&this._elem.hierarchy.length){var n,r=this._elem.hierarchy.length;for(n=0;n<r;n+=1)this._elem.hierarchy[n].finalTransform.mProp.applyToMatrix(e)}return e.applyToPointArray(t[0],t[1],t[2]||0)}function o(e,t){if(this._elem.hierarchy&&this._elem.hierarchy.length){var n,r=this._elem.hierarchy.length;for(n=0;n<r;n+=1)this._elem.hierarchy[n].finalTransform.mProp.applyToMatrix(e)}return e.inversePoint(t)}function s(e){var t=new Matrix;if(t.reset(),this._elem.finalTransform.mProp.applyToMatrix(t),this._elem.hierarchy&&this._elem.hierarchy.length){var n,r=this._elem.hierarchy.length;for(n=0;n<r;n+=1)this._elem.hierarchy[n].finalTransform.mProp.applyToMatrix(t);return t.inversePoint(e)}return t.inversePoint(e)}function u(){return[1,1,1,1]}return function(c){var l;function h(e){switch(e){case"ADBE Root Vectors Group":case"Contents":case 2:return h.shapeInterface;case 1:case 6:case"Transform":case"transform":case"ADBE Transform Group":return l;case 4:case"ADBE Effect Parade":case"effects":case"Effects":return h.effect;case"ADBE Text Properties":return h.textInterface;default:return null}}h.getMatrix=e,h.invertPoint=o,h.applyPoint=i,h.toWorld=n,h.toWorldVec=t,h.fromWorld=a,h.fromWorldVec=r,h.toComp=n,h.fromComp=s,h.sampleImage=u,h.sourceRectAtTime=c.sourceRectAtTime.bind(c),h._elem=c;var f=getDescriptor(l=TransformExpressionInterface(c.finalTransform.mProp),"anchorPoint");return Object.defineProperties(h,{hasParent:{get:function(){return c.hierarchy.length}},parent:{get:function(){return c.hierarchy[0].layerInterface}},rotation:getDescriptor(l,"rotation"),scale:getDescriptor(l,"scale"),position:getDescriptor(l,"position"),opacity:getDescriptor(l,"opacity"),anchorPoint:f,anchor_point:f,transform:{get:function(){return l}},active:{get:function(){return c.isInRange}}}),h.startTime=c.data.st,h.index=c.data.ind,h.source=c.data.refId,h.height=0===c.data.ty?c.data.h:100,h.width=0===c.data.ty?c.data.w:100,h.inPoint=c.data.ip/c.comp.globalData.frameRate,h.outPoint=c.data.op/c.comp.globalData.frameRate,h._name=c.data.nm,h.registerMaskInterface=function(e){h.mask=new MaskManagerInterface(e,c)},h.registerEffectsInterface=function(e){h.effect=e},h}}(),propertyGroupFactory=function(e,t){return function(n){return(n=void 0===n?1:n)<=0?e:t(n-1)}},PropertyInterface=function(e,t){var n={_name:e};return function(e){return(e=void 0===e?1:e)<=0?n:t(e-1)}},EffectsExpressionInterface=function(){function e(n,r,a,i){function o(e){for(var t=n.ef,r=0,a=t.length;r<a;){if(e===t[r].nm||e===t[r].mn||e===t[r].ix)return 5===t[r].ty?c[r]:c[r]();r+=1}throw new Error}var s,u=propertyGroupFactory(o,a),c=[],l=n.ef.length;for(s=0;s<l;s+=1)5===n.ef[s].ty?c.push(e(n.ef[s],r.effectElements[s],r.effectElements[s].propertyGroup,i)):c.push(t(r.effectElements[s],n.ef[s].ty,i,u));return"ADBE Color Control"===n.mn&&Object.defineProperty(o,"color",{get:function(){return c[0]()}}),Object.defineProperties(o,{numProperties:{get:function(){return n.np}},_name:{value:n.nm},propertyGroup:{value:u}}),o.enabled=0!==n.en,o.active=o.enabled,o}function t(e,t,n,r){var a=ExpressionPropertyInterface(e.p);return e.p.setGroupProperty&&e.p.setGroupProperty(PropertyInterface("",r)),function(){return 10===t?n.comp.compInterface(e.p.v):a()}}return{createEffectsInterface:function(t,n){if(t.effectsManager){var r,a=[],i=t.data.ef,o=t.effectsManager.effectElements.length;for(r=0;r<o;r+=1)a.push(e(i[r],t.effectsManager.effectElements[r],n,t));var s=t.data.ef||[],u=function(e){for(r=0,o=s.length;r<o;){if(e===s[r].nm||e===s[r].mn||e===s[r].ix)return a[r];r+=1}return null};return Object.defineProperty(u,"numProperties",{get:function(){return s.length}}),u}return null}}}(),CompExpressionInterface=function(e){function t(t){for(var n=0,r=e.layers.length;n<r;){if(e.layers[n].nm===t||e.layers[n].ind===t)return e.elements[n].layerInterface;n+=1}return null}return Object.defineProperty(t,"_name",{value:e.data.nm}),t.layer=t,t.pixelAspect=1,t.height=e.data.h||e.globalData.compSize.h,t.width=e.data.w||e.globalData.compSize.w,t.pixelAspect=1,t.frameDuration=1/e.globalData.frameRate,t.displayStartTime=0,t.numLayers=e.layers.length,t},ShapePathInterface=function(e,t,n){var r=t.sh;function a(e){return"Shape"===e||"shape"===e||"Path"===e||"path"===e||"ADBE Vector Shape"===e||2===e?a.path:null}var i=propertyGroupFactory(a,n);return r.setGroupProperty(PropertyInterface("Path",i)),Object.defineProperties(a,{path:{get:function(){return r.k&&r.getValue(),r}},shape:{get:function(){return r.k&&r.getValue(),r}},_name:{value:e.nm},ix:{value:e.ix},propertyIndex:{value:e.ix},mn:{value:e.mn},propertyGroup:{value:n}}),a},ShapeExpressionInterface=function(){function e(e,o,f){var p,d=[],m=e?e.length:0;for(p=0;p<m;p+=1)"gr"===e[p].ty?d.push(t(e[p],o[p],f)):"fl"===e[p].ty?d.push(n(e[p],o[p],f)):"st"===e[p].ty?d.push(a(e[p],o[p],f)):"tm"===e[p].ty?d.push(i(e[p],o[p],f)):"tr"===e[p].ty||("el"===e[p].ty?d.push(s(e[p],o[p],f)):"sr"===e[p].ty?d.push(u(e[p],o[p],f)):"sh"===e[p].ty?d.push(ShapePathInterface(e[p],o[p],f)):"rc"===e[p].ty?d.push(c(e[p],o[p],f)):"rd"===e[p].ty?d.push(l(e[p],o[p],f)):"rp"===e[p].ty?d.push(h(e[p],o[p],f)):"gf"===e[p].ty?d.push(r(e[p],o[p],f)):d.push((e[p],o[p],function(){return null})));return d}function t(t,n,r){var a=function(e){switch(e){case"ADBE Vectors Group":case"Contents":case 2:return a.content;default:return a.transform}};a.propertyGroup=propertyGroupFactory(a,r);var i=function(t,n,r){var a,i=function(e){for(var t=0,n=a.length;t<n;){if(a[t]._name===e||a[t].mn===e||a[t].propertyIndex===e||a[t].ix===e||a[t].ind===e)return a[t];t+=1}return"number"===typeof e?a[e-1]:null};i.propertyGroup=propertyGroupFactory(i,r),a=e(t.it,n.it,i.propertyGroup),i.numProperties=a.length;var s=o(t.it[t.it.length-1],n.it[n.it.length-1],i.propertyGroup);return i.transform=s,i.propertyIndex=t.cix,i._name=t.nm,i}(t,n,a.propertyGroup),s=o(t.it[t.it.length-1],n.it[n.it.length-1],a.propertyGroup);return a.content=i,a.transform=s,Object.defineProperty(a,"_name",{get:function(){return t.nm}}),a.numProperties=t.np,a.propertyIndex=t.ix,a.nm=t.nm,a.mn=t.mn,a}function n(e,t,n){function r(e){return"Color"===e||"color"===e?r.color:"Opacity"===e||"opacity"===e?r.opacity:null}return Object.defineProperties(r,{color:{get:ExpressionPropertyInterface(t.c)},opacity:{get:ExpressionPropertyInterface(t.o)},_name:{value:e.nm},mn:{value:e.mn}}),t.c.setGroupProperty(PropertyInterface("Color",n)),t.o.setGroupProperty(PropertyInterface("Opacity",n)),r}function r(e,t,n){function r(e){return"Start Point"===e||"start point"===e?r.startPoint:"End Point"===e||"end point"===e?r.endPoint:"Opacity"===e||"opacity"===e?r.opacity:null}return Object.defineProperties(r,{startPoint:{get:ExpressionPropertyInterface(t.s)},endPoint:{get:ExpressionPropertyInterface(t.e)},opacity:{get:ExpressionPropertyInterface(t.o)},type:{get:function(){return"a"}},_name:{value:e.nm},mn:{value:e.mn}}),t.s.setGroupProperty(PropertyInterface("Start Point",n)),t.e.setGroupProperty(PropertyInterface("End Point",n)),t.o.setGroupProperty(PropertyInterface("Opacity",n)),r}function a(e,t,n){var r,a=propertyGroupFactory(c,n),i=propertyGroupFactory(u,a);function o(n){Object.defineProperty(u,e.d[n].nm,{get:ExpressionPropertyInterface(t.d.dataProps[n].p)})}var s=e.d?e.d.length:0,u={};for(r=0;r<s;r+=1)o(r),t.d.dataProps[r].p.setGroupProperty(i);function c(e){return"Color"===e||"color"===e?c.color:"Opacity"===e||"opacity"===e?c.opacity:"Stroke Width"===e||"stroke width"===e?c.strokeWidth:null}return Object.defineProperties(c,{color:{get:ExpressionPropertyInterface(t.c)},opacity:{get:ExpressionPropertyInterface(t.o)},strokeWidth:{get:ExpressionPropertyInterface(t.w)},dash:{get:function(){return u}},_name:{value:e.nm},mn:{value:e.mn}}),t.c.setGroupProperty(PropertyInterface("Color",a)),t.o.setGroupProperty(PropertyInterface("Opacity",a)),t.w.setGroupProperty(PropertyInterface("Stroke Width",a)),c}function i(e,t,n){function r(t){return t===e.e.ix||"End"===t||"end"===t?r.end:t===e.s.ix?r.start:t===e.o.ix?r.offset:null}var a=propertyGroupFactory(r,n);return r.propertyIndex=e.ix,t.s.setGroupProperty(PropertyInterface("Start",a)),t.e.setGroupProperty(PropertyInterface("End",a)),t.o.setGroupProperty(PropertyInterface("Offset",a)),r.propertyIndex=e.ix,r.propertyGroup=n,Object.defineProperties(r,{start:{get:ExpressionPropertyInterface(t.s)},end:{get:ExpressionPropertyInterface(t.e)},offset:{get:ExpressionPropertyInterface(t.o)},_name:{value:e.nm}}),r.mn=e.mn,r}function o(e,t,n){function r(t){return e.a.ix===t||"Anchor Point"===t?r.anchorPoint:e.o.ix===t||"Opacity"===t?r.opacity:e.p.ix===t||"Position"===t?r.position:e.r.ix===t||"Rotation"===t||"ADBE Vector Rotation"===t?r.rotation:e.s.ix===t||"Scale"===t?r.scale:e.sk&&e.sk.ix===t||"Skew"===t?r.skew:e.sa&&e.sa.ix===t||"Skew Axis"===t?r.skewAxis:null}var a=propertyGroupFactory(r,n);return t.transform.mProps.o.setGroupProperty(PropertyInterface("Opacity",a)),t.transform.mProps.p.setGroupProperty(PropertyInterface("Position",a)),t.transform.mProps.a.setGroupProperty(PropertyInterface("Anchor Point",a)),t.transform.mProps.s.setGroupProperty(PropertyInterface("Scale",a)),t.transform.mProps.r.setGroupProperty(PropertyInterface("Rotation",a)),t.transform.mProps.sk&&(t.transform.mProps.sk.setGroupProperty(PropertyInterface("Skew",a)),t.transform.mProps.sa.setGroupProperty(PropertyInterface("Skew Angle",a))),t.transform.op.setGroupProperty(PropertyInterface("Opacity",a)),Object.defineProperties(r,{opacity:{get:ExpressionPropertyInterface(t.transform.mProps.o)},position:{get:ExpressionPropertyInterface(t.transform.mProps.p)},anchorPoint:{get:ExpressionPropertyInterface(t.transform.mProps.a)},scale:{get:ExpressionPropertyInterface(t.transform.mProps.s)},rotation:{get:ExpressionPropertyInterface(t.transform.mProps.r)},skew:{get:ExpressionPropertyInterface(t.transform.mProps.sk)},skewAxis:{get:ExpressionPropertyInterface(t.transform.mProps.sa)},_name:{value:e.nm}}),r.ty="tr",r.mn=e.mn,r.propertyGroup=n,r}function s(e,t,n){function r(t){return e.p.ix===t?r.position:e.s.ix===t?r.size:null}var a=propertyGroupFactory(r,n);r.propertyIndex=e.ix;var i="tm"===t.sh.ty?t.sh.prop:t.sh;return i.s.setGroupProperty(PropertyInterface("Size",a)),i.p.setGroupProperty(PropertyInterface("Position",a)),Object.defineProperties(r,{size:{get:ExpressionPropertyInterface(i.s)},position:{get:ExpressionPropertyInterface(i.p)},_name:{value:e.nm}}),r.mn=e.mn,r}function u(e,t,n){function r(t){return e.p.ix===t?r.position:e.r.ix===t?r.rotation:e.pt.ix===t?r.points:e.or.ix===t||"ADBE Vector Star Outer Radius"===t?r.outerRadius:e.os.ix===t?r.outerRoundness:!e.ir||e.ir.ix!==t&&"ADBE Vector Star Inner Radius"!==t?e.is&&e.is.ix===t?r.innerRoundness:null:r.innerRadius}var a=propertyGroupFactory(r,n),i="tm"===t.sh.ty?t.sh.prop:t.sh;return r.propertyIndex=e.ix,i.or.setGroupProperty(PropertyInterface("Outer Radius",a)),i.os.setGroupProperty(PropertyInterface("Outer Roundness",a)),i.pt.setGroupProperty(PropertyInterface("Points",a)),i.p.setGroupProperty(PropertyInterface("Position",a)),i.r.setGroupProperty(PropertyInterface("Rotation",a)),e.ir&&(i.ir.setGroupProperty(PropertyInterface("Inner Radius",a)),i.is.setGroupProperty(PropertyInterface("Inner Roundness",a))),Object.defineProperties(r,{position:{get:ExpressionPropertyInterface(i.p)},rotation:{get:ExpressionPropertyInterface(i.r)},points:{get:ExpressionPropertyInterface(i.pt)},outerRadius:{get:ExpressionPropertyInterface(i.or)},outerRoundness:{get:ExpressionPropertyInterface(i.os)},innerRadius:{get:ExpressionPropertyInterface(i.ir)},innerRoundness:{get:ExpressionPropertyInterface(i.is)},_name:{value:e.nm}}),r.mn=e.mn,r}function c(e,t,n){function r(t){return e.p.ix===t?r.position:e.r.ix===t?r.roundness:e.s.ix===t||"Size"===t||"ADBE Vector Rect Size"===t?r.size:null}var a=propertyGroupFactory(r,n),i="tm"===t.sh.ty?t.sh.prop:t.sh;return r.propertyIndex=e.ix,i.p.setGroupProperty(PropertyInterface("Position",a)),i.s.setGroupProperty(PropertyInterface("Size",a)),i.r.setGroupProperty(PropertyInterface("Rotation",a)),Object.defineProperties(r,{position:{get:ExpressionPropertyInterface(i.p)},roundness:{get:ExpressionPropertyInterface(i.r)},size:{get:ExpressionPropertyInterface(i.s)},_name:{value:e.nm}}),r.mn=e.mn,r}function l(e,t,n){function r(t){return e.r.ix===t||"Round Corners 1"===t?r.radius:null}var a=propertyGroupFactory(r,n),i=t;return r.propertyIndex=e.ix,i.rd.setGroupProperty(PropertyInterface("Radius",a)),Object.defineProperties(r,{radius:{get:ExpressionPropertyInterface(i.rd)},_name:{value:e.nm}}),r.mn=e.mn,r}function h(e,t,n){function r(t){return e.c.ix===t||"Copies"===t?r.copies:e.o.ix===t||"Offset"===t?r.offset:null}var a=propertyGroupFactory(r,n),i=t;return r.propertyIndex=e.ix,i.c.setGroupProperty(PropertyInterface("Copies",a)),i.o.setGroupProperty(PropertyInterface("Offset",a)),Object.defineProperties(r,{copies:{get:ExpressionPropertyInterface(i.c)},offset:{get:ExpressionPropertyInterface(i.o)},_name:{value:e.nm}}),r.mn=e.mn,r}return function(t,n,r){var a;function i(e){if("number"===typeof e)return 0===(e=void 0===e?1:e)?r:a[e-1];for(var t=0,n=a.length;t<n;){if(a[t]._name===e)return a[t];t+=1}return null}return i.propertyGroup=propertyGroupFactory(i,(function(){return r})),a=e(t,n,i.propertyGroup),i.numProperties=a.length,i._name="Contents",i}}(),TextExpressionInterface=function(e){var t,n;function r(e){return"ADBE Text Document"===e?r.sourceText:null}return Object.defineProperty(r,"sourceText",{get:function(){e.textProperty.getValue();var r=e.textProperty.currentData.t;return r!==t&&(e.textProperty.currentData.t=t,(n=new String(r)).value=r||new String(r)),n}}),r},getBlendMode=function(){var e={0:"source-over",1:"multiply",2:"screen",3:"overlay",4:"darken",5:"lighten",6:"color-dodge",7:"color-burn",8:"hard-light",9:"soft-light",10:"difference",11:"exclusion",12:"hue",13:"saturation",14:"color",15:"luminosity"};return function(t){return e[t]||""}}();function SliderEffect(e,t,n){this.p=PropertyFactory.getProp(t,e.v,0,0,n)}function AngleEffect(e,t,n){this.p=PropertyFactory.getProp(t,e.v,0,0,n)}function ColorEffect(e,t,n){this.p=PropertyFactory.getProp(t,e.v,1,0,n)}function PointEffect(e,t,n){this.p=PropertyFactory.getProp(t,e.v,1,0,n)}function LayerIndexEffect(e,t,n){this.p=PropertyFactory.getProp(t,e.v,0,0,n)}function MaskIndexEffect(e,t,n){this.p=PropertyFactory.getProp(t,e.v,0,0,n)}function CheckboxEffect(e,t,n){this.p=PropertyFactory.getProp(t,e.v,0,0,n)}function NoValueEffect(){this.p={}}function EffectsManager(e,t){var n,r=e.ef||[];this.effectElements=[];var a,i=r.length;for(n=0;n<i;n+=1)a=new GroupEffect(r[n],t),this.effectElements.push(a)}function GroupEffect(e,t){this.init(e,t)}function BaseElement(){}function FrameElement(){}function _typeof$2(e){return _typeof$2="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof$2(e)}extendPrototype([DynamicPropertyContainer],GroupEffect),GroupEffect.prototype.getValue=GroupEffect.prototype.iterateDynamicProperties,GroupEffect.prototype.init=function(e,t){var n;this.data=e,this.effectElements=[],this.initDynamicPropertyContainer(t);var r,a=this.data.ef.length,i=this.data.ef;for(n=0;n<a;n+=1){switch(r=null,i[n].ty){case 0:r=new SliderEffect(i[n],t,this);break;case 1:r=new AngleEffect(i[n],t,this);break;case 2:r=new ColorEffect(i[n],t,this);break;case 3:r=new PointEffect(i[n],t,this);break;case 4:case 7:r=new CheckboxEffect(i[n],t,this);break;case 10:r=new LayerIndexEffect(i[n],t,this);break;case 11:r=new MaskIndexEffect(i[n],t,this);break;case 5:r=new EffectsManager(i[n],t,this);break;default:r=new NoValueEffect(i[n],t,this)}r&&this.effectElements.push(r)}},BaseElement.prototype={checkMasks:function(){if(!this.data.hasMask)return!1;for(var e=0,t=this.data.masksProperties.length;e<t;){if("n"!==this.data.masksProperties[e].mode&&!1!==this.data.masksProperties[e].cl)return!0;e+=1}return!1},initExpressions:function(){this.layerInterface=LayerExpressionInterface(this),this.data.hasMask&&this.maskManager&&this.layerInterface.registerMaskInterface(this.maskManager);var e=EffectsExpressionInterface.createEffectsInterface(this,this.layerInterface);this.layerInterface.registerEffectsInterface(e),0===this.data.ty||this.data.xt?this.compInterface=CompExpressionInterface(this):4===this.data.ty?(this.layerInterface.shapeInterface=ShapeExpressionInterface(this.shapesData,this.itemsData,this.layerInterface),this.layerInterface.content=this.layerInterface.shapeInterface):5===this.data.ty&&(this.layerInterface.textInterface=TextExpressionInterface(this),this.layerInterface.text=this.layerInterface.textInterface)},setBlendMode:function(){var e=getBlendMode(this.data.bm);(this.baseElement||this.layerElement).style["mix-blend-mode"]=e},initBaseData:function(e,t,n){this.globalData=t,this.comp=n,this.data=e,this.layerId=createElementID(),this.data.sr||(this.data.sr=1),this.effectsManager=new EffectsManager(this.data,this,this.dynamicProperties)},getType:function(){return this.type},sourceRectAtTime:function(){}},FrameElement.prototype={initFrame:function(){this._isFirstFrame=!1,this.dynamicProperties=[],this._mdf=!1},prepareProperties:function(e,t){var n,r=this.dynamicProperties.length;for(n=0;n<r;n+=1)(t||this._isParent&&"transform"===this.dynamicProperties[n].propType)&&(this.dynamicProperties[n].getValue(),this.dynamicProperties[n]._mdf&&(this.globalData._mdf=!0,this._mdf=!0))},addDynamicProperty:function(e){-1===this.dynamicProperties.indexOf(e)&&this.dynamicProperties.push(e)}};var FootageInterface=function(){var e=function(e){function t(e){return"Outline"===e?t.outlineInterface():null}return t._name="Outline",t.outlineInterface=function(e){var t="",n=e.getFootageData();function r(e){if(n[e])return t=e,"object"===_typeof$2(n=n[e])?r:n;var a=e.indexOf(t);if(-1!==a){var i=parseInt(e.substr(a+t.length),10);return"object"===_typeof$2(n=n[i])?r:n}return""}return function(){return t="",n=e.getFootageData(),r}}(e),t};return function(t){function n(e){return"Data"===e?n.dataInterface:null}return n._name="Data",n.dataInterface=e(t),n}}();function FootageElement(e,t,n){this.initFrame(),this.initRenderable(),this.assetData=t.getAssetData(e.refId),this.footageData=t.imageLoader.getAsset(this.assetData),this.initBaseData(e,t,n)}function AudioElement(e,t,n){this.initFrame(),this.initRenderable(),this.assetData=t.getAssetData(e.refId),this.initBaseData(e,t,n),this._isPlaying=!1,this._canPlay=!1;var r=this.globalData.getAssetsPath(this.assetData);this.audio=this.globalData.audioController.createAudio(r),this._currentTime=0,this.globalData.audioController.addAudio(this),this._volumeMultiplier=1,this._volume=1,this._previousVolume=null,this.tm=e.tm?PropertyFactory.getProp(this,e.tm,0,t.frameRate,this):{_placeholder:!0},this.lv=PropertyFactory.getProp(this,e.au&&e.au.lv?e.au.lv:{k:[100]},1,.01,this)}function BaseRenderer(){}function TransformElement(){}function MaskElement(e,t,n){this.data=e,this.element=t,this.globalData=n,this.storedData=[],this.masksProperties=this.data.masksProperties||[],this.maskElement=null;var r,a,i=this.globalData.defs,o=this.masksProperties?this.masksProperties.length:0;this.viewData=createSizedArray(o),this.solidPath="";var s,u,c,l,h,f,p=this.masksProperties,d=0,m=[],v=createElementID(),g="clipPath",y="clip-path";for(r=0;r<o;r+=1)if(("a"!==p[r].mode&&"n"!==p[r].mode||p[r].inv||100!==p[r].o.k||p[r].o.x)&&(g="mask",y="mask"),"s"!==p[r].mode&&"i"!==p[r].mode||0!==d?c=null:((c=createNS("rect")).setAttribute("fill","#ffffff"),c.setAttribute("width",this.element.comp.data.w||0),c.setAttribute("height",this.element.comp.data.h||0),m.push(c)),a=createNS("path"),"n"===p[r].mode)this.viewData[r]={op:PropertyFactory.getProp(this.element,p[r].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,p[r],3),elem:a,lastPath:""},i.appendChild(a);else{var b;if(d+=1,a.setAttribute("fill","s"===p[r].mode?"#000000":"#ffffff"),a.setAttribute("clip-rule","nonzero"),0!==p[r].x.k?(g="mask",y="mask",f=PropertyFactory.getProp(this.element,p[r].x,0,null,this.element),b=createElementID(),(l=createNS("filter")).setAttribute("id",b),(h=createNS("feMorphology")).setAttribute("operator","erode"),h.setAttribute("in","SourceGraphic"),h.setAttribute("radius","0"),l.appendChild(h),i.appendChild(l),a.setAttribute("stroke","s"===p[r].mode?"#000000":"#ffffff")):(h=null,f=null),this.storedData[r]={elem:a,x:f,expan:h,lastPath:"",lastOperator:"",filterId:b,lastRadius:0},"i"===p[r].mode){u=m.length;var k=createNS("g");for(s=0;s<u;s+=1)k.appendChild(m[s]);var x=createNS("mask");x.setAttribute("mask-type","alpha"),x.setAttribute("id",v+"_"+d),x.appendChild(a),i.appendChild(x),k.setAttribute("mask","url("+getLocationHref()+"#"+v+"_"+d+")"),m.length=0,m.push(k)}else m.push(a);p[r].inv&&!this.solidPath&&(this.solidPath=this.createLayerSolidPath()),this.viewData[r]={elem:a,lastPath:"",op:PropertyFactory.getProp(this.element,p[r].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,p[r],3),invRect:c},this.viewData[r].prop.k||this.drawPath(p[r],this.viewData[r].prop.v,this.viewData[r])}for(this.maskElement=createNS(g),o=m.length,r=0;r<o;r+=1)this.maskElement.appendChild(m[r]);d>0&&(this.maskElement.setAttribute("id",v),this.element.maskedElement.setAttribute(y,"url("+getLocationHref()+"#"+v+")"),i.appendChild(this.maskElement)),this.viewData.length&&this.element.addRenderableComponent(this)}FootageElement.prototype.prepareFrame=function(){},extendPrototype([RenderableElement,BaseElement,FrameElement],FootageElement),FootageElement.prototype.getBaseElement=function(){return null},FootageElement.prototype.renderFrame=function(){},FootageElement.prototype.destroy=function(){},FootageElement.prototype.initExpressions=function(){this.layerInterface=FootageInterface(this)},FootageElement.prototype.getFootageData=function(){return this.footageData},AudioElement.prototype.prepareFrame=function(e){if(this.prepareRenderableFrame(e,!0),this.prepareProperties(e,!0),this.tm._placeholder)this._currentTime=e/this.data.sr;else{var t=this.tm.v;this._currentTime=t}this._volume=this.lv.v[0];var n=this._volume*this._volumeMultiplier;this._previousVolume!==n&&(this._previousVolume=n,this.audio.volume(n))},extendPrototype([RenderableElement,BaseElement,FrameElement],AudioElement),AudioElement.prototype.renderFrame=function(){this.isInRange&&this._canPlay&&(this._isPlaying?(!this.audio.playing()||Math.abs(this._currentTime/this.globalData.frameRate-this.audio.seek())>.1)&&this.audio.seek(this._currentTime/this.globalData.frameRate):(this.audio.play(),this.audio.seek(this._currentTime/this.globalData.frameRate),this._isPlaying=!0))},AudioElement.prototype.show=function(){},AudioElement.prototype.hide=function(){this.audio.pause(),this._isPlaying=!1},AudioElement.prototype.pause=function(){this.audio.pause(),this._isPlaying=!1,this._canPlay=!1},AudioElement.prototype.resume=function(){this._canPlay=!0},AudioElement.prototype.setRate=function(e){this.audio.rate(e)},AudioElement.prototype.volume=function(e){this._volumeMultiplier=e,this._previousVolume=e*this._volume,this.audio.volume(this._previousVolume)},AudioElement.prototype.getBaseElement=function(){return null},AudioElement.prototype.destroy=function(){},AudioElement.prototype.sourceRectAtTime=function(){},AudioElement.prototype.initExpressions=function(){},BaseRenderer.prototype.checkLayers=function(e){var t,n,r=this.layers.length;for(this.completeLayers=!0,t=r-1;t>=0;t-=1)this.elements[t]||(n=this.layers[t]).ip-n.st<=e-this.layers[t].st&&n.op-n.st>e-this.layers[t].st&&this.buildItem(t),this.completeLayers=!!this.elements[t]&&this.completeLayers;this.checkPendingElements()},BaseRenderer.prototype.createItem=function(e){switch(e.ty){case 2:return this.createImage(e);case 0:return this.createComp(e);case 1:return this.createSolid(e);case 3:default:return this.createNull(e);case 4:return this.createShape(e);case 5:return this.createText(e);case 6:return this.createAudio(e);case 13:return this.createCamera(e);case 15:return this.createFootage(e)}},BaseRenderer.prototype.createCamera=function(){throw new Error("You're using a 3d camera. Try the html renderer.")},BaseRenderer.prototype.createAudio=function(e){return new AudioElement(e,this.globalData,this)},BaseRenderer.prototype.createFootage=function(e){return new FootageElement(e,this.globalData,this)},BaseRenderer.prototype.buildAllItems=function(){var e,t=this.layers.length;for(e=0;e<t;e+=1)this.buildItem(e);this.checkPendingElements()},BaseRenderer.prototype.includeLayers=function(e){var t;this.completeLayers=!1;var n,r=e.length,a=this.layers.length;for(t=0;t<r;t+=1)for(n=0;n<a;){if(this.layers[n].id===e[t].id){this.layers[n]=e[t];break}n+=1}},BaseRenderer.prototype.setProjectInterface=function(e){this.globalData.projectInterface=e},BaseRenderer.prototype.initItems=function(){this.globalData.progressiveLoad||this.buildAllItems()},BaseRenderer.prototype.buildElementParenting=function(e,t,n){for(var r=this.elements,a=this.layers,i=0,o=a.length;i<o;)a[i].ind==t&&(r[i]&&!0!==r[i]?(n.push(r[i]),r[i].setAsParent(),void 0!==a[i].parent?this.buildElementParenting(e,a[i].parent,n):e.setHierarchy(n)):(this.buildItem(i),this.addPendingElement(e))),i+=1},BaseRenderer.prototype.addPendingElement=function(e){this.pendingElements.push(e)},BaseRenderer.prototype.searchExtraCompositions=function(e){var t,n=e.length;for(t=0;t<n;t+=1)if(e[t].xt){var r=this.createComp(e[t]);r.initExpressions(),this.globalData.projectInterface.registerComposition(r)}},BaseRenderer.prototype.getElementByPath=function(e){var t,n=e.shift();if("number"===typeof n)t=this.elements[n];else{var r,a=this.elements.length;for(r=0;r<a;r+=1)if(this.elements[r].data.nm===n){t=this.elements[r];break}}return 0===e.length?t:t.getElementByPath(e)},BaseRenderer.prototype.setupGlobalData=function(e,t){this.globalData.fontManager=new FontManager,this.globalData.fontManager.addChars(e.chars),this.globalData.fontManager.addFonts(e.fonts,t),this.globalData.getAssetData=this.animationItem.getAssetData.bind(this.animationItem),this.globalData.getAssetsPath=this.animationItem.getAssetsPath.bind(this.animationItem),this.globalData.imageLoader=this.animationItem.imagePreloader,this.globalData.audioController=this.animationItem.audioController,this.globalData.frameId=0,this.globalData.frameRate=e.fr,this.globalData.nm=e.nm,this.globalData.compSize={w:e.w,h:e.h}},TransformElement.prototype={initTransform:function(){this.finalTransform={mProp:this.data.ks?TransformPropertyFactory.getTransformProperty(this,this.data.ks,this):{o:0},_matMdf:!1,_opMdf:!1,mat:new Matrix},this.data.ao&&(this.finalTransform.mProp.autoOriented=!0),this.data.ty},renderTransform:function(){if(this.finalTransform._opMdf=this.finalTransform.mProp.o._mdf||this._isFirstFrame,this.finalTransform._matMdf=this.finalTransform.mProp._mdf||this._isFirstFrame,this.hierarchy){var e,t=this.finalTransform.mat,n=0,r=this.hierarchy.length;if(!this.finalTransform._matMdf)for(;n<r;){if(this.hierarchy[n].finalTransform.mProp._mdf){this.finalTransform._matMdf=!0;break}n+=1}if(this.finalTransform._matMdf)for(e=this.finalTransform.mProp.v.props,t.cloneFromProps(e),n=0;n<r;n+=1)e=this.hierarchy[n].finalTransform.mProp.v.props,t.transform(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}},globalToLocal:function(e){var t=[];t.push(this.finalTransform);for(var n,r=!0,a=this.comp;r;)a.finalTransform?(a.data.hasMask&&t.splice(0,0,a.finalTransform),a=a.comp):r=!1;var i,o=t.length;for(n=0;n<o;n+=1)i=t[n].mat.applyToPointArray(0,0,0),e=[e[0]-i[0],e[1]-i[1],0];return e},mHelper:new Matrix},MaskElement.prototype.getMaskProperty=function(e){return this.viewData[e].prop},MaskElement.prototype.renderFrame=function(e){var t,n=this.element.finalTransform.mat,r=this.masksProperties.length;for(t=0;t<r;t+=1)if((this.viewData[t].prop._mdf||e)&&this.drawPath(this.masksProperties[t],this.viewData[t].prop.v,this.viewData[t]),(this.viewData[t].op._mdf||e)&&this.viewData[t].elem.setAttribute("fill-opacity",this.viewData[t].op.v),"n"!==this.masksProperties[t].mode&&(this.viewData[t].invRect&&(this.element.finalTransform.mProp._mdf||e)&&this.viewData[t].invRect.setAttribute("transform",n.getInverseMatrix().to2dCSS()),this.storedData[t].x&&(this.storedData[t].x._mdf||e))){var a=this.storedData[t].expan;this.storedData[t].x.v<0?("erode"!==this.storedData[t].lastOperator&&(this.storedData[t].lastOperator="erode",this.storedData[t].elem.setAttribute("filter","url("+getLocationHref()+"#"+this.storedData[t].filterId+")")),a.setAttribute("radius",-this.storedData[t].x.v)):("dilate"!==this.storedData[t].lastOperator&&(this.storedData[t].lastOperator="dilate",this.storedData[t].elem.setAttribute("filter",null)),this.storedData[t].elem.setAttribute("stroke-width",2*this.storedData[t].x.v))}},MaskElement.prototype.getMaskelement=function(){return this.maskElement},MaskElement.prototype.createLayerSolidPath=function(){var e="M0,0 ";return e+=" h"+this.globalData.compSize.w,e+=" v"+this.globalData.compSize.h,e+=" h-"+this.globalData.compSize.w,e+=" v-"+this.globalData.compSize.h+" "},MaskElement.prototype.drawPath=function(e,t,n){var r,a,i=" M"+t.v[0][0]+","+t.v[0][1];for(a=t._length,r=1;r<a;r+=1)i+=" C"+t.o[r-1][0]+","+t.o[r-1][1]+" "+t.i[r][0]+","+t.i[r][1]+" "+t.v[r][0]+","+t.v[r][1];if(t.c&&a>1&&(i+=" C"+t.o[r-1][0]+","+t.o[r-1][1]+" "+t.i[0][0]+","+t.i[0][1]+" "+t.v[0][0]+","+t.v[0][1]),n.lastPath!==i){var o="";n.elem&&(t.c&&(o=e.inv?this.solidPath+i:i),n.elem.setAttribute("d",o)),n.lastPath=i}},MaskElement.prototype.destroy=function(){this.element=null,this.globalData=null,this.maskElement=null,this.data=null,this.masksProperties=null};var filtersFactory=function(){var e={createFilter:function(e,t){var n=createNS("filter");return n.setAttribute("id",e),!0!==t&&(n.setAttribute("filterUnits","objectBoundingBox"),n.setAttribute("x","0%"),n.setAttribute("y","0%"),n.setAttribute("width","100%"),n.setAttribute("height","100%")),n},createAlphaToLuminanceFilter:function(){var e=createNS("feColorMatrix");return e.setAttribute("type","matrix"),e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("values","0 0 0 1 0  0 0 0 1 0  0 0 0 1 0  0 0 0 1 1"),e}};return e}(),featureSupport=function(){var e={maskType:!0};return(/MSIE 10/i.test(navigator.userAgent)||/MSIE 9/i.test(navigator.userAgent)||/rv:11.0/i.test(navigator.userAgent)||/Edge\/\d./i.test(navigator.userAgent))&&(e.maskType=!1),e}(),registeredEffects={},idPrefix="filter_result_";function SVGEffects(e){var t,n,r="SourceGraphic",a=e.data.ef?e.data.ef.length:0,i=createElementID(),o=filtersFactory.createFilter(i,!0),s=0;for(this.filters=[],t=0;t<a;t+=1){n=null;var u=e.data.ef[t].ty;registeredEffects[u]&&(n=new(0,registeredEffects[u].effect)(o,e.effectsManager.effectElements[t],e,idPrefix+s,r),r=idPrefix+s,registeredEffects[u].countsAsEffect&&(s+=1)),n&&this.filters.push(n)}s&&(e.globalData.defs.appendChild(o),e.layerElement.setAttribute("filter","url("+getLocationHref()+"#"+i+")")),this.filters.length&&e.addRenderableComponent(this)}function registerEffect(e,t,n){registeredEffects[e]={effect:t,countsAsEffect:n}}function SVGBaseElement(){}function HierarchyElement(){}function RenderableDOMElement(){}function IImageElement(e,t,n){this.assetData=t.getAssetData(e.refId),this.initElement(e,t,n),this.sourceRect={top:0,left:0,width:this.assetData.w,height:this.assetData.h}}function ProcessedElement(e,t){this.elem=e,this.pos=t}function IShapeElement(){}SVGEffects.prototype.renderFrame=function(e){var t,n=this.filters.length;for(t=0;t<n;t+=1)this.filters[t].renderFrame(e)},SVGBaseElement.prototype={initRendererElement:function(){this.layerElement=createNS("g")},createContainerElements:function(){this.matteElement=createNS("g"),this.transformedElement=this.layerElement,this.maskedElement=this.layerElement,this._sizeChanged=!1;var e,t,n,r=null;if(this.data.td){if(3==this.data.td||1==this.data.td){var a=createNS("mask");a.setAttribute("id",this.layerId),a.setAttribute("mask-type",3==this.data.td?"luminance":"alpha"),a.appendChild(this.layerElement),r=a,this.globalData.defs.appendChild(a),featureSupport.maskType||1!=this.data.td||(a.setAttribute("mask-type","luminance"),e=createElementID(),t=filtersFactory.createFilter(e),this.globalData.defs.appendChild(t),t.appendChild(filtersFactory.createAlphaToLuminanceFilter()),(n=createNS("g")).appendChild(this.layerElement),r=n,a.appendChild(n),n.setAttribute("filter","url("+getLocationHref()+"#"+e+")"))}else if(2==this.data.td){var i=createNS("mask");i.setAttribute("id",this.layerId),i.setAttribute("mask-type","alpha");var o=createNS("g");i.appendChild(o),e=createElementID(),t=filtersFactory.createFilter(e);var s=createNS("feComponentTransfer");s.setAttribute("in","SourceGraphic"),t.appendChild(s);var u=createNS("feFuncA");u.setAttribute("type","table"),u.setAttribute("tableValues","1.0 0.0"),s.appendChild(u),this.globalData.defs.appendChild(t);var c=createNS("rect");c.setAttribute("width",this.comp.data.w),c.setAttribute("height",this.comp.data.h),c.setAttribute("x","0"),c.setAttribute("y","0"),c.setAttribute("fill","#ffffff"),c.setAttribute("opacity","0"),o.setAttribute("filter","url("+getLocationHref()+"#"+e+")"),o.appendChild(c),o.appendChild(this.layerElement),r=o,featureSupport.maskType||(i.setAttribute("mask-type","luminance"),t.appendChild(filtersFactory.createAlphaToLuminanceFilter()),n=createNS("g"),o.appendChild(c),n.appendChild(this.layerElement),r=n,o.appendChild(n)),this.globalData.defs.appendChild(i)}}else this.data.tt?(this.matteElement.appendChild(this.layerElement),r=this.matteElement,this.baseElement=this.matteElement):this.baseElement=this.layerElement;if(this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),0===this.data.ty&&!this.data.hd){var l=createNS("clipPath"),h=createNS("path");h.setAttribute("d","M0,0 L"+this.data.w+",0 L"+this.data.w+","+this.data.h+" L0,"+this.data.h+"z");var f=createElementID();if(l.setAttribute("id",f),l.appendChild(h),this.globalData.defs.appendChild(l),this.checkMasks()){var p=createNS("g");p.setAttribute("clip-path","url("+getLocationHref()+"#"+f+")"),p.appendChild(this.layerElement),this.transformedElement=p,r?r.appendChild(this.transformedElement):this.baseElement=this.transformedElement}else this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+f+")")}0!==this.data.bm&&this.setBlendMode()},renderElement:function(){this.finalTransform._matMdf&&this.transformedElement.setAttribute("transform",this.finalTransform.mat.to2dCSS()),this.finalTransform._opMdf&&this.transformedElement.setAttribute("opacity",this.finalTransform.mProp.o.v)},destroyBaseElement:function(){this.layerElement=null,this.matteElement=null,this.maskManager.destroy()},getBaseElement:function(){return this.data.hd?null:this.baseElement},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData),this.renderableEffectsManager=new SVGEffects(this)},setMatte:function(e){this.matteElement&&this.matteElement.setAttribute("mask","url("+getLocationHref()+"#"+e+")")}},HierarchyElement.prototype={initHierarchy:function(){this.hierarchy=[],this._isParent=!1,this.checkParenting()},setHierarchy:function(e){this.hierarchy=e},setAsParent:function(){this._isParent=!0},checkParenting:function(){void 0!==this.data.parent&&this.comp.buildElementParenting(this,this.data.parent,[])}},extendPrototype([RenderableElement,createProxyFunction({initElement:function(e,t,n){this.initFrame(),this.initBaseData(e,t,n),this.initTransform(e,t,n),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide()},hide:function(){this.hidden||this.isInRange&&!this.isTransparent||((this.baseElement||this.layerElement).style.display="none",this.hidden=!0)},show:function(){this.isInRange&&!this.isTransparent&&(this.data.hd||((this.baseElement||this.layerElement).style.display="block"),this.hidden=!1,this._isFirstFrame=!0)},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},renderInnerContent:function(){},prepareFrame:function(e){this._mdf=!1,this.prepareRenderableFrame(e),this.prepareProperties(e,this.isInRange),this.checkTransparency()},destroy:function(){this.innerElem=null,this.destroyBaseElement()}})],RenderableDOMElement),extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],IImageElement),IImageElement.prototype.createContent=function(){var e=this.globalData.getAssetsPath(this.assetData);this.innerElem=createNS("image"),this.innerElem.setAttribute("width",this.assetData.w+"px"),this.innerElem.setAttribute("height",this.assetData.h+"px"),this.innerElem.setAttribute("preserveAspectRatio",this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio),this.innerElem.setAttributeNS("http://www.w3.org/1999/xlink","href",e),this.layerElement.appendChild(this.innerElem)},IImageElement.prototype.sourceRectAtTime=function(){return this.sourceRect},IShapeElement.prototype={addShapeToModifiers:function(e){var t,n=this.shapeModifiers.length;for(t=0;t<n;t+=1)this.shapeModifiers[t].addShape(e)},isShapeInAnimatedModifiers:function(e){for(var t=this.shapeModifiers.length;0<t;)if(this.shapeModifiers[0].isAnimatedWithShape(e))return!0;return!1},renderModifiers:function(){if(this.shapeModifiers.length){var e,t=this.shapes.length;for(e=0;e<t;e+=1)this.shapes[e].sh.reset();for(e=(t=this.shapeModifiers.length)-1;e>=0&&!this.shapeModifiers[e].processShapes(this._isFirstFrame);e-=1);}},searchProcessedElement:function(e){for(var t=this.processedElements,n=0,r=t.length;n<r;){if(t[n].elem===e)return t[n].pos;n+=1}return 0},addProcessedElement:function(e,t){for(var n=this.processedElements,r=n.length;r;)if(n[r-=1].elem===e)return void(n[r].pos=t);n.push(new ProcessedElement(e,t))},prepareFrame:function(e){this.prepareRenderableFrame(e),this.prepareProperties(e,this.isInRange)}};var lineCapEnum={1:"butt",2:"round",3:"square"},lineJoinEnum={1:"miter",2:"round",3:"bevel"};function SVGShapeData(e,t,n){this.caches=[],this.styles=[],this.transformers=e,this.lStr="",this.sh=n,this.lvl=t,this._isAnimated=!!n.k;for(var r=0,a=e.length;r<a;){if(e[r].mProps.dynamicProperties.length){this._isAnimated=!0;break}r+=1}}function SVGStyleData(e,t){this.data=e,this.type=e.ty,this.d="",this.lvl=t,this._mdf=!1,this.closed=!0===e.hd,this.pElem=createNS("path"),this.msElem=null}function DashProperty(e,t,n,r){var a;this.elem=e,this.frameId=-1,this.dataProps=createSizedArray(t.length),this.renderer=n,this.k=!1,this.dashStr="",this.dashArray=createTypedArray("float32",t.length?t.length-1:0),this.dashoffset=createTypedArray("float32",1),this.initDynamicPropertyContainer(r);var i,o=t.length||0;for(a=0;a<o;a+=1)i=PropertyFactory.getProp(e,t[a].v,0,0,this),this.k=i.k||this.k,this.dataProps[a]={n:t[a].n,p:i};this.k||this.getValue(!0),this._isAnimated=this.k}function SVGStrokeStyleData(e,t,n){this.initDynamicPropertyContainer(e),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(e,t.o,0,.01,this),this.w=PropertyFactory.getProp(e,t.w,0,null,this),this.d=new DashProperty(e,t.d||{},"svg",this),this.c=PropertyFactory.getProp(e,t.c,1,255,this),this.style=n,this._isAnimated=!!this._isAnimated}function SVGFillStyleData(e,t,n){this.initDynamicPropertyContainer(e),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(e,t.o,0,.01,this),this.c=PropertyFactory.getProp(e,t.c,1,255,this),this.style=n}function SVGNoStyleData(e,t,n){this.initDynamicPropertyContainer(e),this.getValue=this.iterateDynamicProperties,this.style=n}function GradientProperty(e,t,n){this.data=t,this.c=createTypedArray("uint8c",4*t.p);var r=t.k.k[0].s?t.k.k[0].s.length-4*t.p:t.k.k.length-4*t.p;this.o=createTypedArray("float32",r),this._cmdf=!1,this._omdf=!1,this._collapsable=this.checkCollapsable(),this._hasOpacity=r,this.initDynamicPropertyContainer(n),this.prop=PropertyFactory.getProp(e,t.k,1,null,this),this.k=this.prop.k,this.getValue(!0)}function SVGGradientFillStyleData(e,t,n){this.initDynamicPropertyContainer(e),this.getValue=this.iterateDynamicProperties,this.initGradientData(e,t,n)}function SVGGradientStrokeStyleData(e,t,n){this.initDynamicPropertyContainer(e),this.getValue=this.iterateDynamicProperties,this.w=PropertyFactory.getProp(e,t.w,0,null,this),this.d=new DashProperty(e,t.d||{},"svg",this),this.initGradientData(e,t,n),this._isAnimated=!!this._isAnimated}function ShapeGroupData(){this.it=[],this.prevViewData=[],this.gr=createNS("g")}function SVGTransformData(e,t,n){this.transform={mProps:e,op:t,container:n},this.elements=[],this._isAnimated=this.transform.mProps.dynamicProperties.length||this.transform.op.effectsSequence.length}SVGShapeData.prototype.setAsAnimated=function(){this._isAnimated=!0},SVGStyleData.prototype.reset=function(){this.d="",this._mdf=!1},DashProperty.prototype.getValue=function(e){if((this.elem.globalData.frameId!==this.frameId||e)&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf=this._mdf||e,this._mdf)){var t=0,n=this.dataProps.length;for("svg"===this.renderer&&(this.dashStr=""),t=0;t<n;t+=1)"o"!==this.dataProps[t].n?"svg"===this.renderer?this.dashStr+=" "+this.dataProps[t].p.v:this.dashArray[t]=this.dataProps[t].p.v:this.dashoffset[0]=this.dataProps[t].p.v}},extendPrototype([DynamicPropertyContainer],DashProperty),extendPrototype([DynamicPropertyContainer],SVGStrokeStyleData),extendPrototype([DynamicPropertyContainer],SVGFillStyleData),extendPrototype([DynamicPropertyContainer],SVGNoStyleData),GradientProperty.prototype.comparePoints=function(e,t){for(var n=0,r=this.o.length/2;n<r;){if(Math.abs(e[4*n]-e[4*t+2*n])>.01)return!1;n+=1}return!0},GradientProperty.prototype.checkCollapsable=function(){if(this.o.length/2!==this.c.length/4)return!1;if(this.data.k.k[0].s)for(var e=0,t=this.data.k.k.length;e<t;){if(!this.comparePoints(this.data.k.k[e].s,this.data.p))return!1;e+=1}else if(!this.comparePoints(this.data.k.k,this.data.p))return!1;return!0},GradientProperty.prototype.getValue=function(e){if(this.prop.getValue(),this._mdf=!1,this._cmdf=!1,this._omdf=!1,this.prop._mdf||e){var t,n,r,a=4*this.data.p;for(t=0;t<a;t+=1)n=t%4===0?100:255,r=Math.round(this.prop.v[t]*n),this.c[t]!==r&&(this.c[t]=r,this._cmdf=!e);if(this.o.length)for(a=this.prop.v.length,t=4*this.data.p;t<a;t+=1)n=t%2===0?100:1,r=t%2===0?Math.round(100*this.prop.v[t]):this.prop.v[t],this.o[t-4*this.data.p]!==r&&(this.o[t-4*this.data.p]=r,this._omdf=!e);this._mdf=!e}},extendPrototype([DynamicPropertyContainer],GradientProperty),SVGGradientFillStyleData.prototype.initGradientData=function(e,t,n){this.o=PropertyFactory.getProp(e,t.o,0,.01,this),this.s=PropertyFactory.getProp(e,t.s,1,null,this),this.e=PropertyFactory.getProp(e,t.e,1,null,this),this.h=PropertyFactory.getProp(e,t.h||{k:0},0,.01,this),this.a=PropertyFactory.getProp(e,t.a||{k:0},0,degToRads,this),this.g=new GradientProperty(e,t.g,this),this.style=n,this.stops=[],this.setGradientData(n.pElem,t),this.setGradientOpacity(t,n),this._isAnimated=!!this._isAnimated},SVGGradientFillStyleData.prototype.setGradientData=function(e,t){var n=createElementID(),r=createNS(1===t.t?"linearGradient":"radialGradient");r.setAttribute("id",n),r.setAttribute("spreadMethod","pad"),r.setAttribute("gradientUnits","userSpaceOnUse");var a,i,o,s=[];for(o=4*t.g.p,i=0;i<o;i+=4)a=createNS("stop"),r.appendChild(a),s.push(a);e.setAttribute("gf"===t.ty?"fill":"stroke","url("+getLocationHref()+"#"+n+")"),this.gf=r,this.cst=s},SVGGradientFillStyleData.prototype.setGradientOpacity=function(e,t){if(this.g._hasOpacity&&!this.g._collapsable){var n,r,a,i=createNS("mask"),o=createNS("path");i.appendChild(o);var s=createElementID(),u=createElementID();i.setAttribute("id",u);var c=createNS(1===e.t?"linearGradient":"radialGradient");c.setAttribute("id",s),c.setAttribute("spreadMethod","pad"),c.setAttribute("gradientUnits","userSpaceOnUse"),a=e.g.k.k[0].s?e.g.k.k[0].s.length:e.g.k.k.length;var l=this.stops;for(r=4*e.g.p;r<a;r+=2)(n=createNS("stop")).setAttribute("stop-color","rgb(255,255,255)"),c.appendChild(n),l.push(n);o.setAttribute("gf"===e.ty?"fill":"stroke","url("+getLocationHref()+"#"+s+")"),"gs"===e.ty&&(o.setAttribute("stroke-linecap",lineCapEnum[e.lc||2]),o.setAttribute("stroke-linejoin",lineJoinEnum[e.lj||2]),1===e.lj&&o.setAttribute("stroke-miterlimit",e.ml)),this.of=c,this.ms=i,this.ost=l,this.maskId=u,t.msElem=o}},extendPrototype([DynamicPropertyContainer],SVGGradientFillStyleData),extendPrototype([SVGGradientFillStyleData,DynamicPropertyContainer],SVGGradientStrokeStyleData);var buildShapeString=function(e,t,n,r){if(0===t)return"";var a,i=e.o,o=e.i,s=e.v,u=" M"+r.applyToPointStringified(s[0][0],s[0][1]);for(a=1;a<t;a+=1)u+=" C"+r.applyToPointStringified(i[a-1][0],i[a-1][1])+" "+r.applyToPointStringified(o[a][0],o[a][1])+" "+r.applyToPointStringified(s[a][0],s[a][1]);return n&&t&&(u+=" C"+r.applyToPointStringified(i[a-1][0],i[a-1][1])+" "+r.applyToPointStringified(o[0][0],o[0][1])+" "+r.applyToPointStringified(s[0][0],s[0][1]),u+="z"),u},SVGElementsRenderer=function(){var e=new Matrix,t=new Matrix;function n(e,t,n){(n||t.transform.op._mdf)&&t.transform.container.setAttribute("opacity",t.transform.op.v),(n||t.transform.mProps._mdf)&&t.transform.container.setAttribute("transform",t.transform.mProps.v.to2dCSS())}function r(){}function a(n,r,a){var i,o,s,u,c,l,h,f,p,d,m,v=r.styles.length,g=r.lvl;for(l=0;l<v;l+=1){if(u=r.sh._mdf||a,r.styles[l].lvl<g){for(f=t.reset(),d=g-r.styles[l].lvl,m=r.transformers.length-1;!u&&d>0;)u=r.transformers[m].mProps._mdf||u,d-=1,m-=1;if(u)for(d=g-r.styles[l].lvl,m=r.transformers.length-1;d>0;)p=r.transformers[m].mProps.v.props,f.transform(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7],p[8],p[9],p[10],p[11],p[12],p[13],p[14],p[15]),d-=1,m-=1}else f=e;if(o=(h=r.sh.paths)._length,u){for(s="",i=0;i<o;i+=1)(c=h.shapes[i])&&c._length&&(s+=buildShapeString(c,c._length,c.c,f));r.caches[l]=s}else s=r.caches[l];r.styles[l].d+=!0===n.hd?"":s,r.styles[l]._mdf=u||r.styles[l]._mdf}}function i(e,t,n){var r=t.style;(t.c._mdf||n)&&r.pElem.setAttribute("fill","rgb("+bmFloor(t.c.v[0])+","+bmFloor(t.c.v[1])+","+bmFloor(t.c.v[2])+")"),(t.o._mdf||n)&&r.pElem.setAttribute("fill-opacity",t.o.v)}function o(e,t,n){s(e,t,n),u(0,t,n)}function s(e,t,n){var r,a,i,o,s,u=t.gf,c=t.g._hasOpacity,l=t.s.v,h=t.e.v;if(t.o._mdf||n){var f="gf"===e.ty?"fill-opacity":"stroke-opacity";t.style.pElem.setAttribute(f,t.o.v)}if(t.s._mdf||n){var p=1===e.t?"x1":"cx",d="x1"===p?"y1":"cy";u.setAttribute(p,l[0]),u.setAttribute(d,l[1]),c&&!t.g._collapsable&&(t.of.setAttribute(p,l[0]),t.of.setAttribute(d,l[1]))}if(t.g._cmdf||n){r=t.cst;var m=t.g.c;for(i=r.length,a=0;a<i;a+=1)(o=r[a]).setAttribute("offset",m[4*a]+"%"),o.setAttribute("stop-color","rgb("+m[4*a+1]+","+m[4*a+2]+","+m[4*a+3]+")")}if(c&&(t.g._omdf||n)){var v=t.g.o;for(i=(r=t.g._collapsable?t.cst:t.ost).length,a=0;a<i;a+=1)o=r[a],t.g._collapsable||o.setAttribute("offset",v[2*a]+"%"),o.setAttribute("stop-opacity",v[2*a+1])}if(1===e.t)(t.e._mdf||n)&&(u.setAttribute("x2",h[0]),u.setAttribute("y2",h[1]),c&&!t.g._collapsable&&(t.of.setAttribute("x2",h[0]),t.of.setAttribute("y2",h[1])));else if((t.s._mdf||t.e._mdf||n)&&(s=Math.sqrt(Math.pow(l[0]-h[0],2)+Math.pow(l[1]-h[1],2)),u.setAttribute("r",s),c&&!t.g._collapsable&&t.of.setAttribute("r",s)),t.e._mdf||t.h._mdf||t.a._mdf||n){s||(s=Math.sqrt(Math.pow(l[0]-h[0],2)+Math.pow(l[1]-h[1],2)));var g=Math.atan2(h[1]-l[1],h[0]-l[0]),y=t.h.v;y>=1?y=.99:y<=-1&&(y=-.99);var b=s*y,k=Math.cos(g+t.a.v)*b+l[0],x=Math.sin(g+t.a.v)*b+l[1];u.setAttribute("fx",k),u.setAttribute("fy",x),c&&!t.g._collapsable&&(t.of.setAttribute("fx",k),t.of.setAttribute("fy",x))}}function u(e,t,n){var r=t.style,a=t.d;a&&(a._mdf||n)&&a.dashStr&&(r.pElem.setAttribute("stroke-dasharray",a.dashStr),r.pElem.setAttribute("stroke-dashoffset",a.dashoffset[0])),t.c&&(t.c._mdf||n)&&r.pElem.setAttribute("stroke","rgb("+bmFloor(t.c.v[0])+","+bmFloor(t.c.v[1])+","+bmFloor(t.c.v[2])+")"),(t.o._mdf||n)&&r.pElem.setAttribute("stroke-opacity",t.o.v),(t.w._mdf||n)&&(r.pElem.setAttribute("stroke-width",t.w.v),r.msElem&&r.msElem.setAttribute("stroke-width",t.w.v))}return{createRenderFunction:function(e){switch(e.ty){case"fl":return i;case"gf":return s;case"gs":return o;case"st":return u;case"sh":case"el":case"rc":case"sr":return a;case"tr":return n;case"no":return r;default:return null}}}}();function SVGShapeElement(e,t,n){this.shapes=[],this.shapesData=e.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.initElement(e,t,n),this.prevViewData=[]}function LetterProps(e,t,n,r,a,i){this.o=e,this.sw=t,this.sc=n,this.fc=r,this.m=a,this.p=i,this._mdf={o:!0,sw:!!t,sc:!!n,fc:!!r,m:!0,p:!0}}function TextProperty(e,t){this._frameId=initialDefaultFrame,this.pv="",this.v="",this.kf=!1,this._isFirstFrame=!0,this._mdf=!1,this.data=t,this.elem=e,this.comp=this.elem.comp,this.keysIndex=0,this.canResize=!1,this.minimumFontSize=1,this.effectsSequence=[],this.currentData={ascent:0,boxWidth:this.defaultBoxWidth,f:"",fStyle:"",fWeight:"",fc:"",j:"",justifyOffset:"",l:[],lh:0,lineWidths:[],ls:"",of:"",s:"",sc:"",sw:0,t:0,tr:0,sz:0,ps:null,fillColorAnim:!1,strokeColorAnim:!1,strokeWidthAnim:!1,yOffset:0,finalSize:0,finalText:[],finalLineHeight:0,__complete:!1},this.copyData(this.currentData,this.data.d.k[0].s),this.searchProperty()||this.completeTextData(this.currentData)}extendPrototype([BaseElement,TransformElement,SVGBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableDOMElement],SVGShapeElement),SVGShapeElement.prototype.initSecondaryElement=function(){},SVGShapeElement.prototype.identityMatrix=new Matrix,SVGShapeElement.prototype.buildExpressionInterface=function(){},SVGShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes()},SVGShapeElement.prototype.filterUniqueShapes=function(){var e,t,n,r,a=this.shapes.length,i=this.stylesList.length,o=[],s=!1;for(n=0;n<i;n+=1){for(r=this.stylesList[n],s=!1,o.length=0,e=0;e<a;e+=1)-1!==(t=this.shapes[e]).styles.indexOf(r)&&(o.push(t),s=t._isAnimated||s);o.length>1&&s&&this.setShapesAsAnimated(o)}},SVGShapeElement.prototype.setShapesAsAnimated=function(e){var t,n=e.length;for(t=0;t<n;t+=1)e[t].setAsAnimated()},SVGShapeElement.prototype.createStyleElement=function(e,t){var n,r=new SVGStyleData(e,t),a=r.pElem;return"st"===e.ty?n=new SVGStrokeStyleData(this,e,r):"fl"===e.ty?n=new SVGFillStyleData(this,e,r):"gf"===e.ty||"gs"===e.ty?(n=new("gf"===e.ty?SVGGradientFillStyleData:SVGGradientStrokeStyleData)(this,e,r),this.globalData.defs.appendChild(n.gf),n.maskId&&(this.globalData.defs.appendChild(n.ms),this.globalData.defs.appendChild(n.of),a.setAttribute("mask","url("+getLocationHref()+"#"+n.maskId+")"))):"no"===e.ty&&(n=new SVGNoStyleData(this,e,r)),"st"!==e.ty&&"gs"!==e.ty||(a.setAttribute("stroke-linecap",lineCapEnum[e.lc||2]),a.setAttribute("stroke-linejoin",lineJoinEnum[e.lj||2]),a.setAttribute("fill-opacity","0"),1===e.lj&&a.setAttribute("stroke-miterlimit",e.ml)),2===e.r&&a.setAttribute("fill-rule","evenodd"),e.ln&&a.setAttribute("id",e.ln),e.cl&&a.setAttribute("class",e.cl),e.bm&&(a.style["mix-blend-mode"]=getBlendMode(e.bm)),this.stylesList.push(r),this.addToAnimatedContents(e,n),n},SVGShapeElement.prototype.createGroupElement=function(e){var t=new ShapeGroupData;return e.ln&&t.gr.setAttribute("id",e.ln),e.cl&&t.gr.setAttribute("class",e.cl),e.bm&&(t.gr.style["mix-blend-mode"]=getBlendMode(e.bm)),t},SVGShapeElement.prototype.createTransformElement=function(e,t){var n=TransformPropertyFactory.getTransformProperty(this,e,this),r=new SVGTransformData(n,n.o,t);return this.addToAnimatedContents(e,r),r},SVGShapeElement.prototype.createShapeElement=function(e,t,n){var r=4;"rc"===e.ty?r=5:"el"===e.ty?r=6:"sr"===e.ty&&(r=7);var a=new SVGShapeData(t,n,ShapePropertyFactory.getShapeProp(this,e,r,this));return this.shapes.push(a),this.addShapeToModifiers(a),this.addToAnimatedContents(e,a),a},SVGShapeElement.prototype.addToAnimatedContents=function(e,t){for(var n=0,r=this.animatedContents.length;n<r;){if(this.animatedContents[n].element===t)return;n+=1}this.animatedContents.push({fn:SVGElementsRenderer.createRenderFunction(e),element:t,data:e})},SVGShapeElement.prototype.setElementStyles=function(e){var t,n=e.styles,r=this.stylesList.length;for(t=0;t<r;t+=1)this.stylesList[t].closed||n.push(this.stylesList[t])},SVGShapeElement.prototype.reloadShapes=function(){var e;this._isFirstFrame=!0;var t=this.itemsData.length;for(e=0;e<t;e+=1)this.prevViewData[e]=this.itemsData[e];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes(),t=this.dynamicProperties.length,e=0;e<t;e+=1)this.dynamicProperties[e].getValue();this.renderModifiers()},SVGShapeElement.prototype.searchShapes=function(e,t,n,r,a,i,o){var s,u,c,l,h,f,p=[].concat(i),d=e.length-1,m=[],v=[];for(s=d;s>=0;s-=1){if((f=this.searchProcessedElement(e[s]))?t[s]=n[f-1]:e[s]._render=o,"fl"===e[s].ty||"st"===e[s].ty||"gf"===e[s].ty||"gs"===e[s].ty||"no"===e[s].ty)f?t[s].style.closed=!1:t[s]=this.createStyleElement(e[s],a),e[s]._render&&t[s].style.pElem.parentNode!==r&&r.appendChild(t[s].style.pElem),m.push(t[s].style);else if("gr"===e[s].ty){if(f)for(c=t[s].it.length,u=0;u<c;u+=1)t[s].prevViewData[u]=t[s].it[u];else t[s]=this.createGroupElement(e[s]);this.searchShapes(e[s].it,t[s].it,t[s].prevViewData,t[s].gr,a+1,p,o),e[s]._render&&t[s].gr.parentNode!==r&&r.appendChild(t[s].gr)}else"tr"===e[s].ty?(f||(t[s]=this.createTransformElement(e[s],r)),l=t[s].transform,p.push(l)):"sh"===e[s].ty||"rc"===e[s].ty||"el"===e[s].ty||"sr"===e[s].ty?(f||(t[s]=this.createShapeElement(e[s],p,a)),this.setElementStyles(t[s])):"tm"===e[s].ty||"rd"===e[s].ty||"ms"===e[s].ty||"pb"===e[s].ty?(f?(h=t[s]).closed=!1:((h=ShapeModifiers.getModifier(e[s].ty)).init(this,e[s]),t[s]=h,this.shapeModifiers.push(h)),v.push(h)):"rp"===e[s].ty&&(f?(h=t[s]).closed=!0:(h=ShapeModifiers.getModifier(e[s].ty),t[s]=h,h.init(this,e,s,t),this.shapeModifiers.push(h),o=!1),v.push(h));this.addProcessedElement(e[s],s+1)}for(d=m.length,s=0;s<d;s+=1)m[s].closed=!0;for(d=v.length,s=0;s<d;s+=1)v[s].closed=!0},SVGShapeElement.prototype.renderInnerContent=function(){var e;this.renderModifiers();var t=this.stylesList.length;for(e=0;e<t;e+=1)this.stylesList[e].reset();for(this.renderShape(),e=0;e<t;e+=1)(this.stylesList[e]._mdf||this._isFirstFrame)&&(this.stylesList[e].msElem&&(this.stylesList[e].msElem.setAttribute("d",this.stylesList[e].d),this.stylesList[e].d="M0 0"+this.stylesList[e].d),this.stylesList[e].pElem.setAttribute("d",this.stylesList[e].d||"M0 0"))},SVGShapeElement.prototype.renderShape=function(){var e,t,n=this.animatedContents.length;for(e=0;e<n;e+=1)t=this.animatedContents[e],(this._isFirstFrame||t.element._isAnimated)&&!0!==t.data&&t.fn(t.data,t.element,this._isFirstFrame)},SVGShapeElement.prototype.destroy=function(){this.destroyBaseElement(),this.shapesData=null,this.itemsData=null},LetterProps.prototype.update=function(e,t,n,r,a,i){this._mdf.o=!1,this._mdf.sw=!1,this._mdf.sc=!1,this._mdf.fc=!1,this._mdf.m=!1,this._mdf.p=!1;var o=!1;return this.o!==e&&(this.o=e,this._mdf.o=!0,o=!0),this.sw!==t&&(this.sw=t,this._mdf.sw=!0,o=!0),this.sc!==n&&(this.sc=n,this._mdf.sc=!0,o=!0),this.fc!==r&&(this.fc=r,this._mdf.fc=!0,o=!0),this.m!==a&&(this.m=a,this._mdf.m=!0,o=!0),!i.length||this.p[0]===i[0]&&this.p[1]===i[1]&&this.p[4]===i[4]&&this.p[5]===i[5]&&this.p[12]===i[12]&&this.p[13]===i[13]||(this.p=i,this._mdf.p=!0,o=!0),o},TextProperty.prototype.defaultBoxWidth=[0,0],TextProperty.prototype.copyData=function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},TextProperty.prototype.setCurrentData=function(e){e.__complete||this.completeTextData(e),this.currentData=e,this.currentData.boxWidth=this.currentData.boxWidth||this.defaultBoxWidth,this._mdf=!0},TextProperty.prototype.searchProperty=function(){return this.searchKeyframes()},TextProperty.prototype.searchKeyframes=function(){return this.kf=this.data.d.k.length>1,this.kf&&this.addEffect(this.getKeyframeValue.bind(this)),this.kf},TextProperty.prototype.addEffect=function(e){this.effectsSequence.push(e),this.elem.addDynamicProperty(this)},TextProperty.prototype.getValue=function(e){if(this.elem.globalData.frameId!==this.frameId&&this.effectsSequence.length||e){this.currentData.t=this.data.d.k[this.keysIndex].s.t;var t=this.currentData,n=this.keysIndex;if(this.lock)this.setCurrentData(this.currentData);else{var r;this.lock=!0,this._mdf=!1;var a=this.effectsSequence.length,i=e||this.data.d.k[this.keysIndex].s;for(r=0;r<a;r+=1)i=n!==this.keysIndex?this.effectsSequence[r](i,i.t):this.effectsSequence[r](this.currentData,i.t);t!==i&&this.setCurrentData(i),this.v=this.currentData,this.pv=this.v,this.lock=!1,this.frameId=this.elem.globalData.frameId}}},TextProperty.prototype.getKeyframeValue=function(){for(var e=this.data.d.k,t=this.elem.comp.renderedFrame,n=0,r=e.length;n<=r-1&&!(n===r-1||e[n+1].t>t);)n+=1;return this.keysIndex!==n&&(this.keysIndex=n),this.data.d.k[this.keysIndex].s},TextProperty.prototype.buildFinalText=function(e){for(var t,n,r=[],a=0,i=e.length,o=!1;a<i;)t=e.charCodeAt(a),FontManager.isCombinedCharacter(t)?r[r.length-1]+=e.charAt(a):t>=55296&&t<=56319?(n=e.charCodeAt(a+1))>=56320&&n<=57343?(o||FontManager.isModifier(t,n)?(r[r.length-1]+=e.substr(a,2),o=!1):r.push(e.substr(a,2)),a+=1):r.push(e.charAt(a)):t>56319?(n=e.charCodeAt(a+1),FontManager.isZeroWidthJoiner(t,n)?(o=!0,r[r.length-1]+=e.substr(a,2),a+=1):r.push(e.charAt(a))):FontManager.isZeroWidthJoiner(t)?(r[r.length-1]+=e.charAt(a),o=!0):r.push(e.charAt(a)),a+=1;return r},TextProperty.prototype.completeTextData=function(e){e.__complete=!0;var t,n,r,a,i,o,s,u=this.elem.globalData.fontManager,c=this.data,l=[],h=0,f=c.m.g,p=0,d=0,m=0,v=[],g=0,y=0,b=u.getFontByName(e.f),k=0,x=getFontProperties(b);e.fWeight=x.weight,e.fStyle=x.style,e.finalSize=e.s,e.finalText=this.buildFinalText(e.t),n=e.finalText.length,e.finalLineHeight=e.lh;var w,_=e.tr/1e3*e.finalSize;if(e.sz)for(var S,C,T=!0,E=e.sz[0],I=e.sz[1];T;){S=0,g=0,n=(C=this.buildFinalText(e.t)).length,_=e.tr/1e3*e.finalSize;var A=-1;for(t=0;t<n;t+=1)w=C[t].charCodeAt(0),r=!1," "===C[t]?A=t:13!==w&&3!==w||(g=0,r=!0,S+=e.finalLineHeight||1.2*e.finalSize),u.chars?(s=u.getCharData(C[t],b.fStyle,b.fFamily),k=r?0:s.w*e.finalSize/100):k=u.measureText(C[t],e.f,e.finalSize),g+k>E&&" "!==C[t]?(-1===A?n+=1:t=A,S+=e.finalLineHeight||1.2*e.finalSize,C.splice(t,A===t?1:0,"\r"),A=-1,g=0):(g+=k,g+=_);S+=b.ascent*e.finalSize/100,this.canResize&&e.finalSize>this.minimumFontSize&&I<S?(e.finalSize-=1,e.finalLineHeight=e.finalSize*e.lh/e.s):(e.finalText=C,n=e.finalText.length,T=!1)}g=-_,k=0;var N,P=0;for(t=0;t<n;t+=1)if(r=!1,13===(w=(N=e.finalText[t]).charCodeAt(0))||3===w?(P=0,v.push(g),y=g>y?g:y,g=-2*_,a="",r=!0,m+=1):a=N,u.chars?(s=u.getCharData(N,b.fStyle,u.getFontByName(e.f).fFamily),k=r?0:s.w*e.finalSize/100):k=u.measureText(a,e.f,e.finalSize)," "===N?P+=k+_:(g+=k+_+P,P=0),l.push({l:k,an:k,add:p,n:r,anIndexes:[],val:a,line:m,animatorJustifyOffset:0}),2==f){if(p+=k,""===a||" "===a||t===n-1){for(""!==a&&" "!==a||(p-=k);d<=t;)l[d].an=p,l[d].ind=h,l[d].extra=k,d+=1;h+=1,p=0}}else if(3==f){if(p+=k,""===a||t===n-1){for(""===a&&(p-=k);d<=t;)l[d].an=p,l[d].ind=h,l[d].extra=k,d+=1;p=0,h+=1}}else l[h].ind=h,l[h].extra=0,h+=1;if(e.l=l,y=g>y?g:y,v.push(g),e.sz)e.boxWidth=e.sz[0],e.justifyOffset=0;else switch(e.boxWidth=y,e.j){case 1:e.justifyOffset=-e.boxWidth;break;case 2:e.justifyOffset=-e.boxWidth/2;break;default:e.justifyOffset=0}e.lineWidths=v;var M,D,R,O,F=c.a;o=F.length;var L=[];for(i=0;i<o;i+=1){for((M=F[i]).a.sc&&(e.strokeColorAnim=!0),M.a.sw&&(e.strokeWidthAnim=!0),(M.a.fc||M.a.fh||M.a.fs||M.a.fb)&&(e.fillColorAnim=!0),O=0,R=M.s.b,t=0;t<n;t+=1)(D=l[t]).anIndexes[i]=O,(1==R&&""!==D.val||2==R&&""!==D.val&&" "!==D.val||3==R&&(D.n||" "==D.val||t==n-1)||4==R&&(D.n||t==n-1))&&(1===M.s.rn&&L.push(O),O+=1);c.a[i].s.totalChars=O;var z,B=-1;if(1===M.s.rn)for(t=0;t<n;t+=1)B!=(D=l[t]).anIndexes[i]&&(B=D.anIndexes[i],z=L.splice(Math.floor(Math.random()*L.length),1)[0]),D.anIndexes[i]=z}e.yOffset=e.finalLineHeight||1.2*e.finalSize,e.ls=e.ls||0,e.ascent=b.ascent*e.finalSize/100},TextProperty.prototype.updateDocumentData=function(e,t){t=void 0===t?this.keysIndex:t;var n=this.copyData({},this.data.d.k[t].s);n=this.copyData(n,e),this.data.d.k[t].s=n,this.recalculate(t),this.elem.addDynamicProperty(this)},TextProperty.prototype.recalculate=function(e){var t=this.data.d.k[e].s;t.__complete=!1,this.keysIndex=0,this._isFirstFrame=!0,this.getValue(t)},TextProperty.prototype.canResizeFont=function(e){this.canResize=e,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)},TextProperty.prototype.setMinimumFontSize=function(e){this.minimumFontSize=Math.floor(e)||1,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)};var TextSelectorProp=function(){var e=Math.max,t=Math.min,n=Math.floor;function r(e,t){this._currentTextLength=-1,this.k=!1,this.data=t,this.elem=e,this.comp=e.comp,this.finalS=0,this.finalE=0,this.initDynamicPropertyContainer(e),this.s=PropertyFactory.getProp(e,t.s||{k:0},0,0,this),this.e="e"in t?PropertyFactory.getProp(e,t.e,0,0,this):{v:100},this.o=PropertyFactory.getProp(e,t.o||{k:0},0,0,this),this.xe=PropertyFactory.getProp(e,t.xe||{k:0},0,0,this),this.ne=PropertyFactory.getProp(e,t.ne||{k:0},0,0,this),this.sm=PropertyFactory.getProp(e,t.sm||{k:100},0,0,this),this.a=PropertyFactory.getProp(e,t.a,0,.01,this),this.dynamicProperties.length||this.getValue()}return r.prototype={getMult:function(r){this._currentTextLength!==this.elem.textProperty.currentData.l.length&&this.getValue();var a=0,i=0,o=1,s=1;this.ne.v>0?a=this.ne.v/100:i=-this.ne.v/100,this.xe.v>0?o=1-this.xe.v/100:s=1+this.xe.v/100;var u=BezierFactory.getBezierEasing(a,i,o,s).get,c=0,l=this.finalS,h=this.finalE,f=this.data.sh;if(2===f)c=u(c=h===l?r>=h?1:0:e(0,t(.5/(h-l)+(r-l)/(h-l),1)));else if(3===f)c=u(c=h===l?r>=h?0:1:1-e(0,t(.5/(h-l)+(r-l)/(h-l),1)));else if(4===f)h===l?c=0:(c=e(0,t(.5/(h-l)+(r-l)/(h-l),1)))<.5?c*=2:c=1-2*(c-.5),c=u(c);else if(5===f){if(h===l)c=0;else{var p=h-l,d=-p/2+(r=t(e(0,r+.5-l),h-l)),m=p/2;c=Math.sqrt(1-d*d/(m*m))}c=u(c)}else 6===f?(h===l?c=0:(r=t(e(0,r+.5-l),h-l),c=(1+Math.cos(Math.PI+2*Math.PI*r/(h-l)))/2),c=u(c)):(r>=n(l)&&(c=e(0,t(r-l<0?t(h,1)-(l-r):h-r,1))),c=u(c));if(100!==this.sm.v){var v=.01*this.sm.v;0===v&&(v=1e-8);var g=.5-.5*v;c<g?c=0:(c=(c-g)/v)>1&&(c=1)}return c*this.a.v},getValue:function(e){this.iterateDynamicProperties(),this._mdf=e||this._mdf,this._currentTextLength=this.elem.textProperty.currentData.l.length||0,e&&2===this.data.r&&(this.e.v=this._currentTextLength);var t=2===this.data.r?1:100/this.data.totalChars,n=this.o.v/t,r=this.s.v/t+n,a=this.e.v/t+n;if(r>a){var i=r;r=a,a=i}this.finalS=r,this.finalE=a}},extendPrototype([DynamicPropertyContainer],r),{getTextSelectorProp:function(e,t,n){return new r(e,t,n)}}}();function TextAnimatorDataProperty(e,t,n){var r={propType:!1},a=PropertyFactory.getProp,i=t.a;this.a={r:i.r?a(e,i.r,0,degToRads,n):r,rx:i.rx?a(e,i.rx,0,degToRads,n):r,ry:i.ry?a(e,i.ry,0,degToRads,n):r,sk:i.sk?a(e,i.sk,0,degToRads,n):r,sa:i.sa?a(e,i.sa,0,degToRads,n):r,s:i.s?a(e,i.s,1,.01,n):r,a:i.a?a(e,i.a,1,0,n):r,o:i.o?a(e,i.o,0,.01,n):r,p:i.p?a(e,i.p,1,0,n):r,sw:i.sw?a(e,i.sw,0,0,n):r,sc:i.sc?a(e,i.sc,1,0,n):r,fc:i.fc?a(e,i.fc,1,0,n):r,fh:i.fh?a(e,i.fh,0,0,n):r,fs:i.fs?a(e,i.fs,0,.01,n):r,fb:i.fb?a(e,i.fb,0,.01,n):r,t:i.t?a(e,i.t,0,0,n):r},this.s=TextSelectorProp.getTextSelectorProp(e,t.s,n),this.s.t=t.s.t}function TextAnimatorProperty(e,t,n){this._isFirstFrame=!0,this._hasMaskedPath=!1,this._frameId=-1,this._textData=e,this._renderType=t,this._elem=n,this._animatorsData=createSizedArray(this._textData.a.length),this._pathData={},this._moreOptions={alignment:{}},this.renderedLetters=[],this.lettersChangedFlag=!1,this.initDynamicPropertyContainer(n)}function ITextElement(){}TextAnimatorProperty.prototype.searchProperties=function(){var e,t,n=this._textData.a.length,r=PropertyFactory.getProp;for(e=0;e<n;e+=1)t=this._textData.a[e],this._animatorsData[e]=new TextAnimatorDataProperty(this._elem,t,this);this._textData.p&&"m"in this._textData.p?(this._pathData={a:r(this._elem,this._textData.p.a,0,0,this),f:r(this._elem,this._textData.p.f,0,0,this),l:r(this._elem,this._textData.p.l,0,0,this),r:r(this._elem,this._textData.p.r,0,0,this),p:r(this._elem,this._textData.p.p,0,0,this),m:this._elem.maskManager.getMaskProperty(this._textData.p.m)},this._hasMaskedPath=!0):this._hasMaskedPath=!1,this._moreOptions.alignment=r(this._elem,this._textData.m.a,1,0,this)},TextAnimatorProperty.prototype.getMeasures=function(e,t){if(this.lettersChangedFlag=t,this._mdf||this._isFirstFrame||t||this._hasMaskedPath&&this._pathData.m._mdf){this._isFirstFrame=!1;var n,r,a,i,o,s,u,c,l,h,f,p,d,m,v,g,y,b,k,x=this._moreOptions.alignment.v,w=this._animatorsData,_=this._textData,S=this.mHelper,C=this._renderType,T=this.renderedLetters.length,E=e.l;if(this._hasMaskedPath){if(k=this._pathData.m,!this._pathData.n||this._pathData._mdf){var I,A=k.v;for(this._pathData.r.v&&(A=A.reverse()),o={tLength:0,segments:[]},i=A._length-1,g=0,a=0;a<i;a+=1)I=bez.buildBezierData(A.v[a],A.v[a+1],[A.o[a][0]-A.v[a][0],A.o[a][1]-A.v[a][1]],[A.i[a+1][0]-A.v[a+1][0],A.i[a+1][1]-A.v[a+1][1]]),o.tLength+=I.segmentLength,o.segments.push(I),g+=I.segmentLength;a=i,k.v.c&&(I=bez.buildBezierData(A.v[a],A.v[0],[A.o[a][0]-A.v[a][0],A.o[a][1]-A.v[a][1]],[A.i[0][0]-A.v[0][0],A.i[0][1]-A.v[0][1]]),o.tLength+=I.segmentLength,o.segments.push(I),g+=I.segmentLength),this._pathData.pi=o}if(o=this._pathData.pi,s=this._pathData.f.v,f=0,h=1,c=0,l=!0,m=o.segments,s<0&&k.v.c)for(o.tLength<Math.abs(s)&&(s=-Math.abs(s)%o.tLength),h=(d=m[f=m.length-1].points).length-1;s<0;)s+=d[h].partialLength,(h-=1)<0&&(h=(d=m[f-=1].points).length-1);p=(d=m[f].points)[h-1],v=(u=d[h]).partialLength}i=E.length,n=0,r=0;var N,P,M,D,R,O=1.2*e.finalSize*.714,F=!0;M=w.length;var L,z,B,V,j,q,G,W,U,H,K,X,Y=-1,Q=s,$=f,J=h,Z=-1,ee="",te=this.defaultPropsArray;if(2===e.j||1===e.j){var ne=0,re=0,ae=2===e.j?-.5:-1,ie=0,oe=!0;for(a=0;a<i;a+=1)if(E[a].n){for(ne&&(ne+=re);ie<a;)E[ie].animatorJustifyOffset=ne,ie+=1;ne=0,oe=!0}else{for(P=0;P<M;P+=1)(N=w[P].a).t.propType&&(oe&&2===e.j&&(re+=N.t.v*ae),(R=w[P].s.getMult(E[a].anIndexes[P],_.a[P].s.totalChars)).length?ne+=N.t.v*R[0]*ae:ne+=N.t.v*R*ae);oe=!1}for(ne&&(ne+=re);ie<a;)E[ie].animatorJustifyOffset=ne,ie+=1}for(a=0;a<i;a+=1){if(S.reset(),V=1,E[a].n)n=0,r+=e.yOffset,r+=F?1:0,s=Q,F=!1,this._hasMaskedPath&&(h=J,p=(d=m[f=$].points)[h-1],v=(u=d[h]).partialLength,c=0),ee="",K="",U="",X="",te=this.defaultPropsArray;else{if(this._hasMaskedPath){if(Z!==E[a].line){switch(e.j){case 1:s+=g-e.lineWidths[E[a].line];break;case 2:s+=(g-e.lineWidths[E[a].line])/2}Z=E[a].line}Y!==E[a].ind&&(E[Y]&&(s+=E[Y].extra),s+=E[a].an/2,Y=E[a].ind),s+=x[0]*E[a].an*.005;var se=0;for(P=0;P<M;P+=1)(N=w[P].a).p.propType&&((R=w[P].s.getMult(E[a].anIndexes[P],_.a[P].s.totalChars)).length?se+=N.p.v[0]*R[0]:se+=N.p.v[0]*R),N.a.propType&&((R=w[P].s.getMult(E[a].anIndexes[P],_.a[P].s.totalChars)).length?se+=N.a.v[0]*R[0]:se+=N.a.v[0]*R);for(l=!0,this._pathData.a.v&&(s=.5*E[0].an+(g-this._pathData.f.v-.5*E[0].an-.5*E[E.length-1].an)*Y/(i-1),s+=this._pathData.f.v);l;)c+v>=s+se||!d?(y=(s+se-c)/u.partialLength,z=p.point[0]+(u.point[0]-p.point[0])*y,B=p.point[1]+(u.point[1]-p.point[1])*y,S.translate(-x[0]*E[a].an*.005,-x[1]*O*.01),l=!1):d&&(c+=u.partialLength,(h+=1)>=d.length&&(h=0,m[f+=1]?d=m[f].points:k.v.c?(h=0,d=m[f=0].points):(c-=u.partialLength,d=null)),d&&(p=u,v=(u=d[h]).partialLength));L=E[a].an/2-E[a].add,S.translate(-L,0,0)}else L=E[a].an/2-E[a].add,S.translate(-L,0,0),S.translate(-x[0]*E[a].an*.005,-x[1]*O*.01,0);for(P=0;P<M;P+=1)(N=w[P].a).t.propType&&(R=w[P].s.getMult(E[a].anIndexes[P],_.a[P].s.totalChars),0===n&&0===e.j||(this._hasMaskedPath?R.length?s+=N.t.v*R[0]:s+=N.t.v*R:R.length?n+=N.t.v*R[0]:n+=N.t.v*R));for(e.strokeWidthAnim&&(q=e.sw||0),e.strokeColorAnim&&(j=e.sc?[e.sc[0],e.sc[1],e.sc[2]]:[0,0,0]),e.fillColorAnim&&e.fc&&(G=[e.fc[0],e.fc[1],e.fc[2]]),P=0;P<M;P+=1)(N=w[P].a).a.propType&&((R=w[P].s.getMult(E[a].anIndexes[P],_.a[P].s.totalChars)).length?S.translate(-N.a.v[0]*R[0],-N.a.v[1]*R[1],N.a.v[2]*R[2]):S.translate(-N.a.v[0]*R,-N.a.v[1]*R,N.a.v[2]*R));for(P=0;P<M;P+=1)(N=w[P].a).s.propType&&((R=w[P].s.getMult(E[a].anIndexes[P],_.a[P].s.totalChars)).length?S.scale(1+(N.s.v[0]-1)*R[0],1+(N.s.v[1]-1)*R[1],1):S.scale(1+(N.s.v[0]-1)*R,1+(N.s.v[1]-1)*R,1));for(P=0;P<M;P+=1){if(N=w[P].a,R=w[P].s.getMult(E[a].anIndexes[P],_.a[P].s.totalChars),N.sk.propType&&(R.length?S.skewFromAxis(-N.sk.v*R[0],N.sa.v*R[1]):S.skewFromAxis(-N.sk.v*R,N.sa.v*R)),N.r.propType&&(R.length?S.rotateZ(-N.r.v*R[2]):S.rotateZ(-N.r.v*R)),N.ry.propType&&(R.length?S.rotateY(N.ry.v*R[1]):S.rotateY(N.ry.v*R)),N.rx.propType&&(R.length?S.rotateX(N.rx.v*R[0]):S.rotateX(N.rx.v*R)),N.o.propType&&(R.length?V+=(N.o.v*R[0]-V)*R[0]:V+=(N.o.v*R-V)*R),e.strokeWidthAnim&&N.sw.propType&&(R.length?q+=N.sw.v*R[0]:q+=N.sw.v*R),e.strokeColorAnim&&N.sc.propType)for(W=0;W<3;W+=1)R.length?j[W]+=(N.sc.v[W]-j[W])*R[0]:j[W]+=(N.sc.v[W]-j[W])*R;if(e.fillColorAnim&&e.fc){if(N.fc.propType)for(W=0;W<3;W+=1)R.length?G[W]+=(N.fc.v[W]-G[W])*R[0]:G[W]+=(N.fc.v[W]-G[W])*R;N.fh.propType&&(G=R.length?addHueToRGB(G,N.fh.v*R[0]):addHueToRGB(G,N.fh.v*R)),N.fs.propType&&(G=R.length?addSaturationToRGB(G,N.fs.v*R[0]):addSaturationToRGB(G,N.fs.v*R)),N.fb.propType&&(G=R.length?addBrightnessToRGB(G,N.fb.v*R[0]):addBrightnessToRGB(G,N.fb.v*R))}}for(P=0;P<M;P+=1)(N=w[P].a).p.propType&&(R=w[P].s.getMult(E[a].anIndexes[P],_.a[P].s.totalChars),this._hasMaskedPath?R.length?S.translate(0,N.p.v[1]*R[0],-N.p.v[2]*R[1]):S.translate(0,N.p.v[1]*R,-N.p.v[2]*R):R.length?S.translate(N.p.v[0]*R[0],N.p.v[1]*R[1],-N.p.v[2]*R[2]):S.translate(N.p.v[0]*R,N.p.v[1]*R,-N.p.v[2]*R));if(e.strokeWidthAnim&&(U=q<0?0:q),e.strokeColorAnim&&(H="rgb("+Math.round(255*j[0])+","+Math.round(255*j[1])+","+Math.round(255*j[2])+")"),e.fillColorAnim&&e.fc&&(K="rgb("+Math.round(255*G[0])+","+Math.round(255*G[1])+","+Math.round(255*G[2])+")"),this._hasMaskedPath){if(S.translate(0,-e.ls),S.translate(0,x[1]*O*.01+r,0),this._pathData.p.v){b=(u.point[1]-p.point[1])/(u.point[0]-p.point[0]);var ue=180*Math.atan(b)/Math.PI;u.point[0]<p.point[0]&&(ue+=180),S.rotate(-ue*Math.PI/180)}S.translate(z,B,0),s-=x[0]*E[a].an*.005,E[a+1]&&Y!==E[a+1].ind&&(s+=E[a].an/2,s+=.001*e.tr*e.finalSize)}else{switch(S.translate(n,r,0),e.ps&&S.translate(e.ps[0],e.ps[1]+e.ascent,0),e.j){case 1:S.translate(E[a].animatorJustifyOffset+e.justifyOffset+(e.boxWidth-e.lineWidths[E[a].line]),0,0);break;case 2:S.translate(E[a].animatorJustifyOffset+e.justifyOffset+(e.boxWidth-e.lineWidths[E[a].line])/2,0,0)}S.translate(0,-e.ls),S.translate(L,0,0),S.translate(x[0]*E[a].an*.005,x[1]*O*.01,0),n+=E[a].l+.001*e.tr*e.finalSize}"html"===C?ee=S.toCSS():"svg"===C?ee=S.to2dCSS():te=[S.props[0],S.props[1],S.props[2],S.props[3],S.props[4],S.props[5],S.props[6],S.props[7],S.props[8],S.props[9],S.props[10],S.props[11],S.props[12],S.props[13],S.props[14],S.props[15]],X=V}T<=a?(D=new LetterProps(X,U,H,K,ee,te),this.renderedLetters.push(D),T+=1,this.lettersChangedFlag=!0):(D=this.renderedLetters[a],this.lettersChangedFlag=D.update(X,U,H,K,ee,te)||this.lettersChangedFlag)}}},TextAnimatorProperty.prototype.getValue=function(){this._elem.globalData.frameId!==this._frameId&&(this._frameId=this._elem.globalData.frameId,this.iterateDynamicProperties())},TextAnimatorProperty.prototype.mHelper=new Matrix,TextAnimatorProperty.prototype.defaultPropsArray=[],extendPrototype([DynamicPropertyContainer],TextAnimatorProperty),ITextElement.prototype.initElement=function(e,t,n){this.lettersChangedFlag=!0,this.initFrame(),this.initBaseData(e,t,n),this.textProperty=new TextProperty(this,e.t,this.dynamicProperties),this.textAnimator=new TextAnimatorProperty(e.t,this.renderType,this),this.initTransform(e,t,n),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide(),this.textAnimator.searchProperties(this.dynamicProperties)},ITextElement.prototype.prepareFrame=function(e){this._mdf=!1,this.prepareRenderableFrame(e),this.prepareProperties(e,this.isInRange),(this.textProperty._mdf||this.textProperty._isFirstFrame)&&(this.buildNewText(),this.textProperty._isFirstFrame=!1,this.textProperty._mdf=!1)},ITextElement.prototype.createPathShape=function(e,t){var n,r,a=t.length,i="";for(n=0;n<a;n+=1)"sh"===t[n].ty&&(r=t[n].ks.k,i+=buildShapeString(r,r.i.length,!0,e));return i},ITextElement.prototype.updateDocumentData=function(e,t){this.textProperty.updateDocumentData(e,t)},ITextElement.prototype.canResizeFont=function(e){this.textProperty.canResizeFont(e)},ITextElement.prototype.setMinimumFontSize=function(e){this.textProperty.setMinimumFontSize(e)},ITextElement.prototype.applyTextPropertiesToMatrix=function(e,t,n,r,a){switch(e.ps&&t.translate(e.ps[0],e.ps[1]+e.ascent,0),t.translate(0,-e.ls,0),e.j){case 1:t.translate(e.justifyOffset+(e.boxWidth-e.lineWidths[n]),0,0);break;case 2:t.translate(e.justifyOffset+(e.boxWidth-e.lineWidths[n])/2,0,0)}t.translate(r,a,0)},ITextElement.prototype.buildColor=function(e){return"rgb("+Math.round(255*e[0])+","+Math.round(255*e[1])+","+Math.round(255*e[2])+")"},ITextElement.prototype.emptyProp=new LetterProps,ITextElement.prototype.destroy=function(){};var emptyShapeData={shapes:[]};function SVGTextLottieElement(e,t,n){this.textSpans=[],this.renderType="svg",this.initElement(e,t,n)}function ISolidElement(e,t,n){this.initElement(e,t,n)}function NullElement(e,t,n){this.initFrame(),this.initBaseData(e,t,n),this.initFrame(),this.initTransform(e,t,n),this.initHierarchy()}function SVGRendererBase(){}function ICompElement(){}function SVGCompElement(e,t,n){this.layers=e.layers,this.supports3d=!0,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(e,t,n),this.tm=e.tm?PropertyFactory.getProp(this,e.tm,0,t.frameRate,this):{_placeholder:!0}}function SVGRenderer(e,t){this.animationItem=e,this.layers=null,this.renderedFrame=-1,this.svgElement=createNS("svg");var n="";if(t&&t.title){var r=createNS("title"),a=createElementID();r.setAttribute("id",a),r.textContent=t.title,this.svgElement.appendChild(r),n+=a}if(t&&t.description){var i=createNS("desc"),o=createElementID();i.setAttribute("id",o),i.textContent=t.description,this.svgElement.appendChild(i),n+=" "+o}n&&this.svgElement.setAttribute("aria-labelledby",n);var s=createNS("defs");this.svgElement.appendChild(s);var u=createNS("g");this.svgElement.appendChild(u),this.layerElement=u,this.renderConfig={preserveAspectRatio:t&&t.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:t&&t.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:t&&t.contentVisibility||"visible",progressiveLoad:t&&t.progressiveLoad||!1,hideOnTransparent:!(t&&!1===t.hideOnTransparent),viewBoxOnly:t&&t.viewBoxOnly||!1,viewBoxSize:t&&t.viewBoxSize||!1,className:t&&t.className||"",id:t&&t.id||"",focusable:t&&t.focusable,filterSize:{width:t&&t.filterSize&&t.filterSize.width||"100%",height:t&&t.filterSize&&t.filterSize.height||"100%",x:t&&t.filterSize&&t.filterSize.x||"0%",y:t&&t.filterSize&&t.filterSize.y||"0%"},width:t&&t.width,height:t&&t.height},this.globalData={_mdf:!1,frameNum:-1,defs:s,renderConfig:this.renderConfig},this.elements=[],this.pendingElements=[],this.destroyed=!1,this.rendererType="svg"}function CVContextData(){var e;for(this.saved=[],this.cArrPos=0,this.cTr=new Matrix,this.cO=1,this.savedOp=createTypedArray("float32",15),e=0;e<15;e+=1)this.saved[e]=createTypedArray("float32",16);this._length=15}function ShapeTransformManager(){this.sequences={},this.sequenceList=[],this.transform_key_count=0}function CVEffects(){}function CVMaskElement(e,t){var n;this.data=e,this.element=t,this.masksProperties=this.data.masksProperties||[],this.viewData=createSizedArray(this.masksProperties.length);var r=this.masksProperties.length,a=!1;for(n=0;n<r;n+=1)"n"!==this.masksProperties[n].mode&&(a=!0),this.viewData[n]=ShapePropertyFactory.getShapeProp(this.element,this.masksProperties[n],3);this.hasMasks=a,a&&this.element.addRenderableComponent(this)}function CVBaseElement(){}function CVShapeData(e,t,n,r){this.styledShapes=[],this.tr=[0,0,0,0,0,0];var a,i=4;"rc"===t.ty?i=5:"el"===t.ty?i=6:"sr"===t.ty&&(i=7),this.sh=ShapePropertyFactory.getShapeProp(e,t,i,e);var o,s=n.length;for(a=0;a<s;a+=1)n[a].closed||(o={transforms:r.addTransformSequence(n[a].transforms),trNodes:[]},this.styledShapes.push(o),n[a].elements.push(o))}function CVShapeElement(e,t,n){this.shapes=[],this.shapesData=e.shapes,this.stylesList=[],this.itemsData=[],this.prevViewData=[],this.shapeModifiers=[],this.processedElements=[],this.transformsManager=new ShapeTransformManager,this.initElement(e,t,n)}function CVTextElement(e,t,n){this.textSpans=[],this.yOffset=0,this.fillColorAnim=!1,this.strokeColorAnim=!1,this.strokeWidthAnim=!1,this.stroke=!1,this.fill=!1,this.justifyOffset=0,this.currentRender=null,this.renderType="canvas",this.values={fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,0)",sWidth:0,fValue:""},this.initElement(e,t,n)}function CVImageElement(e,t,n){this.assetData=t.getAssetData(e.refId),this.img=t.imageLoader.getAsset(this.assetData),this.initElement(e,t,n)}function CVSolidElement(e,t,n){this.initElement(e,t,n)}function CanvasRendererBase(e,t){this.animationItem=e,this.renderConfig={clearCanvas:!t||void 0===t.clearCanvas||t.clearCanvas,context:t&&t.context||null,progressiveLoad:t&&t.progressiveLoad||!1,preserveAspectRatio:t&&t.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:t&&t.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:t&&t.contentVisibility||"visible",className:t&&t.className||"",id:t&&t.id||""},this.renderConfig.dpr=t&&t.dpr||1,this.animationItem.wrapper&&(this.renderConfig.dpr=t&&t.dpr||window.devicePixelRatio||1),this.renderedFrame=-1,this.globalData={frameNum:-1,_mdf:!1,renderConfig:this.renderConfig,currentGlobalAlpha:-1},this.contextData=new CVContextData,this.elements=[],this.pendingElements=[],this.transformMat=new Matrix,this.completeLayers=!1,this.rendererType="canvas"}function CVCompElement(e,t,n){this.completeLayers=!1,this.layers=e.layers,this.pendingElements=[],this.elements=createSizedArray(this.layers.length),this.initElement(e,t,n),this.tm=e.tm?PropertyFactory.getProp(this,e.tm,0,t.frameRate,this):{_placeholder:!0}}function CanvasRenderer(e,t){this.animationItem=e,this.renderConfig={clearCanvas:!t||void 0===t.clearCanvas||t.clearCanvas,context:t&&t.context||null,progressiveLoad:t&&t.progressiveLoad||!1,preserveAspectRatio:t&&t.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:t&&t.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:t&&t.contentVisibility||"visible",className:t&&t.className||"",id:t&&t.id||""},this.renderConfig.dpr=t&&t.dpr||1,this.animationItem.wrapper&&(this.renderConfig.dpr=t&&t.dpr||window.devicePixelRatio||1),this.renderedFrame=-1,this.globalData={frameNum:-1,_mdf:!1,renderConfig:this.renderConfig,currentGlobalAlpha:-1},this.contextData=new CVContextData,this.elements=[],this.pendingElements=[],this.transformMat=new Matrix,this.completeLayers=!1,this.rendererType="canvas"}function HBaseElement(){}function HSolidElement(e,t,n){this.initElement(e,t,n)}function HShapeElement(e,t,n){this.shapes=[],this.shapesData=e.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.shapesContainer=createNS("g"),this.initElement(e,t,n),this.prevViewData=[],this.currentBBox={x:999999,y:-999999,h:0,w:0}}function HTextElement(e,t,n){this.textSpans=[],this.textPaths=[],this.currentBBox={x:999999,y:-999999,h:0,w:0},this.renderType="svg",this.isMasked=!1,this.initElement(e,t,n)}function HCameraElement(e,t,n){this.initFrame(),this.initBaseData(e,t,n),this.initHierarchy();var r=PropertyFactory.getProp;if(this.pe=r(this,e.pe,0,0,this),e.ks.p.s?(this.px=r(this,e.ks.p.x,1,0,this),this.py=r(this,e.ks.p.y,1,0,this),this.pz=r(this,e.ks.p.z,1,0,this)):this.p=r(this,e.ks.p,1,0,this),e.ks.a&&(this.a=r(this,e.ks.a,1,0,this)),e.ks.or.k.length&&e.ks.or.k[0].to){var a,i=e.ks.or.k.length;for(a=0;a<i;a+=1)e.ks.or.k[a].to=null,e.ks.or.k[a].ti=null}this.or=r(this,e.ks.or,1,degToRads,this),this.or.sh=!0,this.rx=r(this,e.ks.rx,0,degToRads,this),this.ry=r(this,e.ks.ry,0,degToRads,this),this.rz=r(this,e.ks.rz,0,degToRads,this),this.mat=new Matrix,this._prevMat=new Matrix,this._isFirstFrame=!0,this.finalTransform={mProp:this}}function HImageElement(e,t,n){this.assetData=t.getAssetData(e.refId),this.initElement(e,t,n)}function HybridRendererBase(e,t){this.animationItem=e,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:t&&t.className||"",imagePreserveAspectRatio:t&&t.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(t&&!1===t.hideOnTransparent),filterSize:{width:t&&t.filterSize&&t.filterSize.width||"400%",height:t&&t.filterSize&&t.filterSize.height||"400%",x:t&&t.filterSize&&t.filterSize.x||"-100%",y:t&&t.filterSize&&t.filterSize.y||"-100%"}},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}function HCompElement(e,t,n){this.layers=e.layers,this.supports3d=!e.hasMask,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(e,t,n),this.tm=e.tm?PropertyFactory.getProp(this,e.tm,0,t.frameRate,this):{_placeholder:!0}}function HybridRenderer(e,t){this.animationItem=e,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:t&&t.className||"",imagePreserveAspectRatio:t&&t.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(t&&!1===t.hideOnTransparent),filterSize:{width:t&&t.filterSize&&t.filterSize.width||"400%",height:t&&t.filterSize&&t.filterSize.height||"400%",x:t&&t.filterSize&&t.filterSize.x||"-100%",y:t&&t.filterSize&&t.filterSize.y||"-100%"}},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],SVGTextLottieElement),SVGTextLottieElement.prototype.createContent=function(){this.data.singleShape&&!this.globalData.fontManager.chars&&(this.textContainer=createNS("text"))},SVGTextLottieElement.prototype.buildTextContents=function(e){for(var t=0,n=e.length,r=[],a="";t<n;)e[t]===String.fromCharCode(13)||e[t]===String.fromCharCode(3)?(r.push(a),a=""):a+=e[t],t+=1;return r.push(a),r},SVGTextLottieElement.prototype.buildShapeData=function(e,t){if(e.shapes&&e.shapes.length){var n=e.shapes[0];if(n.it){var r=n.it[n.it.length-1];r.s&&(r.s.k[0]=t,r.s.k[1]=t)}}return e},SVGTextLottieElement.prototype.buildNewText=function(){var e,t;this.addDynamicProperty(this);var n=this.textProperty.currentData;this.renderedLetters=createSizedArray(n?n.l.length:0),n.fc?this.layerElement.setAttribute("fill",this.buildColor(n.fc)):this.layerElement.setAttribute("fill","rgba(0,0,0,0)"),n.sc&&(this.layerElement.setAttribute("stroke",this.buildColor(n.sc)),this.layerElement.setAttribute("stroke-width",n.sw)),this.layerElement.setAttribute("font-size",n.finalSize);var r=this.globalData.fontManager.getFontByName(n.f);if(r.fClass)this.layerElement.setAttribute("class",r.fClass);else{this.layerElement.setAttribute("font-family",r.fFamily);var a=n.fWeight,i=n.fStyle;this.layerElement.setAttribute("font-style",i),this.layerElement.setAttribute("font-weight",a)}this.layerElement.setAttribute("aria-label",n.t);var o,s=n.l||[],u=!!this.globalData.fontManager.chars;t=s.length;var c=this.mHelper,l=this.data.singleShape,h=0,f=0,p=!0,d=.001*n.tr*n.finalSize;if(!l||u||n.sz){var m,v=this.textSpans.length;for(e=0;e<t;e+=1){if(this.textSpans[e]||(this.textSpans[e]={span:null,childSpan:null,glyph:null}),!u||!l||0===e){if(o=v>e?this.textSpans[e].span:createNS(u?"g":"text"),v<=e){if(o.setAttribute("stroke-linecap","butt"),o.setAttribute("stroke-linejoin","round"),o.setAttribute("stroke-miterlimit","4"),this.textSpans[e].span=o,u){var g=createNS("g");o.appendChild(g),this.textSpans[e].childSpan=g}this.textSpans[e].span=o,this.layerElement.appendChild(o)}o.style.display="inherit"}if(c.reset(),l&&(s[e].n&&(h=-d,f+=n.yOffset,f+=p?1:0,p=!1),this.applyTextPropertiesToMatrix(n,c,s[e].line,h,f),h+=s[e].l||0,h+=d),u){var y;if(1===(m=this.globalData.fontManager.getCharData(n.finalText[e],r.fStyle,this.globalData.fontManager.getFontByName(n.f).fFamily)).t)y=new SVGCompElement(m.data,this.globalData,this);else{var b=emptyShapeData;m.data&&m.data.shapes&&(b=this.buildShapeData(m.data,n.finalSize)),y=new SVGShapeElement(b,this.globalData,this)}if(this.textSpans[e].glyph){var k=this.textSpans[e].glyph;this.textSpans[e].childSpan.removeChild(k.layerElement),k.destroy()}this.textSpans[e].glyph=y,y._debug=!0,y.prepareFrame(0),y.renderFrame(),this.textSpans[e].childSpan.appendChild(y.layerElement),1===m.t&&this.textSpans[e].childSpan.setAttribute("transform","scale("+n.finalSize/100+","+n.finalSize/100+")")}else l&&o.setAttribute("transform","translate("+c.props[12]+","+c.props[13]+")"),o.textContent=s[e].val,o.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve")}l&&o&&o.setAttribute("d","")}else{var x=this.textContainer,w="start";switch(n.j){case 1:w="end";break;case 2:w="middle";break;default:w="start"}x.setAttribute("text-anchor",w),x.setAttribute("letter-spacing",d);var _=this.buildTextContents(n.finalText);for(t=_.length,f=n.ps?n.ps[1]+n.ascent:0,e=0;e<t;e+=1)(o=this.textSpans[e].span||createNS("tspan")).textContent=_[e],o.setAttribute("x",0),o.setAttribute("y",f),o.style.display="inherit",x.appendChild(o),this.textSpans[e]||(this.textSpans[e]={span:null,glyph:null}),this.textSpans[e].span=o,f+=n.finalLineHeight;this.layerElement.appendChild(x)}for(;e<this.textSpans.length;)this.textSpans[e].span.style.display="none",e+=1;this._sizeChanged=!0},SVGTextLottieElement.prototype.sourceRectAtTime=function(){if(this.prepareFrame(this.comp.renderedFrame-this.data.st),this.renderInnerContent(),this._sizeChanged){this._sizeChanged=!1;var e=this.layerElement.getBBox();this.bbox={top:e.y,left:e.x,width:e.width,height:e.height}}return this.bbox},SVGTextLottieElement.prototype.getValue=function(){var e,t,n=this.textSpans.length;for(this.renderedFrame=this.comp.renderedFrame,e=0;e<n;e+=1)(t=this.textSpans[e].glyph)&&(t.prepareFrame(this.comp.renderedFrame-this.data.st),t._mdf&&(this._mdf=!0))},SVGTextLottieElement.prototype.renderInnerContent=function(){if((!this.data.singleShape||this._mdf)&&(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag)){var e,t;this._sizeChanged=!0;var n,r,a,i=this.textAnimator.renderedLetters,o=this.textProperty.currentData.l;for(t=o.length,e=0;e<t;e+=1)o[e].n||(n=i[e],r=this.textSpans[e].span,(a=this.textSpans[e].glyph)&&a.renderFrame(),n._mdf.m&&r.setAttribute("transform",n.m),n._mdf.o&&r.setAttribute("opacity",n.o),n._mdf.sw&&r.setAttribute("stroke-width",n.sw),n._mdf.sc&&r.setAttribute("stroke",n.sc),n._mdf.fc&&r.setAttribute("fill",n.fc))}},extendPrototype([IImageElement],ISolidElement),ISolidElement.prototype.createContent=function(){var e=createNS("rect");e.setAttribute("width",this.data.sw),e.setAttribute("height",this.data.sh),e.setAttribute("fill",this.data.sc),this.layerElement.appendChild(e)},NullElement.prototype.prepareFrame=function(e){this.prepareProperties(e,!0)},NullElement.prototype.renderFrame=function(){},NullElement.prototype.getBaseElement=function(){return null},NullElement.prototype.destroy=function(){},NullElement.prototype.sourceRectAtTime=function(){},NullElement.prototype.hide=function(){},extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement],NullElement),extendPrototype([BaseRenderer],SVGRendererBase),SVGRendererBase.prototype.createNull=function(e){return new NullElement(e,this.globalData,this)},SVGRendererBase.prototype.createShape=function(e){return new SVGShapeElement(e,this.globalData,this)},SVGRendererBase.prototype.createText=function(e){return new SVGTextLottieElement(e,this.globalData,this)},SVGRendererBase.prototype.createImage=function(e){return new IImageElement(e,this.globalData,this)},SVGRendererBase.prototype.createSolid=function(e){return new ISolidElement(e,this.globalData,this)},SVGRendererBase.prototype.configAnimation=function(e){this.svgElement.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.renderConfig.viewBoxSize?this.svgElement.setAttribute("viewBox",this.renderConfig.viewBoxSize):this.svgElement.setAttribute("viewBox","0 0 "+e.w+" "+e.h),this.renderConfig.viewBoxOnly||(this.svgElement.setAttribute("width",e.w),this.svgElement.setAttribute("height",e.h),this.svgElement.style.width="100%",this.svgElement.style.height="100%",this.svgElement.style.transform="translate3d(0,0,0)",this.svgElement.style.contentVisibility=this.renderConfig.contentVisibility),this.renderConfig.width&&this.svgElement.setAttribute("width",this.renderConfig.width),this.renderConfig.height&&this.svgElement.setAttribute("height",this.renderConfig.height),this.renderConfig.className&&this.svgElement.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.svgElement.setAttribute("id",this.renderConfig.id),void 0!==this.renderConfig.focusable&&this.svgElement.setAttribute("focusable",this.renderConfig.focusable),this.svgElement.setAttribute("preserveAspectRatio",this.renderConfig.preserveAspectRatio),this.animationItem.wrapper.appendChild(this.svgElement);var t=this.globalData.defs;this.setupGlobalData(e,t),this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.data=e;var n=createNS("clipPath"),r=createNS("rect");r.setAttribute("width",e.w),r.setAttribute("height",e.h),r.setAttribute("x",0),r.setAttribute("y",0);var a=createElementID();n.setAttribute("id",a),n.appendChild(r),this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+a+")"),t.appendChild(n),this.layers=e.layers,this.elements=createSizedArray(e.layers.length)},SVGRendererBase.prototype.destroy=function(){var e;this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.layerElement=null,this.globalData.defs=null;var t=this.layers?this.layers.length:0;for(e=0;e<t;e+=1)this.elements[e]&&this.elements[e].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},SVGRendererBase.prototype.updateContainerSize=function(){},SVGRendererBase.prototype.buildItem=function(e){var t=this.elements;if(!t[e]&&99!==this.layers[e].ty){t[e]=!0;var n=this.createItem(this.layers[e]);t[e]=n,getExpressionsPlugin()&&(0===this.layers[e].ty&&this.globalData.projectInterface.registerComposition(n),n.initExpressions()),this.appendElementInPos(n,e),this.layers[e].tt&&(this.elements[e-1]&&!0!==this.elements[e-1]?n.setMatte(t[e-1].layerId):(this.buildItem(e-1),this.addPendingElement(n)))}},SVGRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var e=this.pendingElements.pop();if(e.checkParenting(),e.data.tt)for(var t=0,n=this.elements.length;t<n;){if(this.elements[t]===e){e.setMatte(this.elements[t-1].layerId);break}t+=1}}},SVGRendererBase.prototype.renderFrame=function(e){if(this.renderedFrame!==e&&!this.destroyed){var t;null===e?e=this.renderedFrame:this.renderedFrame=e,this.globalData.frameNum=e,this.globalData.frameId+=1,this.globalData.projectInterface.currentFrame=e,this.globalData._mdf=!1;var n=this.layers.length;for(this.completeLayers||this.checkLayers(e),t=n-1;t>=0;t-=1)(this.completeLayers||this.elements[t])&&this.elements[t].prepareFrame(e-this.layers[t].st);if(this.globalData._mdf)for(t=0;t<n;t+=1)(this.completeLayers||this.elements[t])&&this.elements[t].renderFrame()}},SVGRendererBase.prototype.appendElementInPos=function(e,t){var n=e.getBaseElement();if(n){for(var r,a=0;a<t;)this.elements[a]&&!0!==this.elements[a]&&this.elements[a].getBaseElement()&&(r=this.elements[a].getBaseElement()),a+=1;r?this.layerElement.insertBefore(n,r):this.layerElement.appendChild(n)}},SVGRendererBase.prototype.hide=function(){this.layerElement.style.display="none"},SVGRendererBase.prototype.show=function(){this.layerElement.style.display="block"},extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement,RenderableDOMElement],ICompElement),ICompElement.prototype.initElement=function(e,t,n){this.initFrame(),this.initBaseData(e,t,n),this.initTransform(e,t,n),this.initRenderable(),this.initHierarchy(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),!this.data.xt&&t.progressiveLoad||this.buildAllItems(),this.hide()},ICompElement.prototype.prepareFrame=function(e){if(this._mdf=!1,this.prepareRenderableFrame(e),this.prepareProperties(e,this.isInRange),this.isInRange||this.data.xt){if(this.tm._placeholder)this.renderedFrame=e/this.data.sr;else{var t=this.tm.v;t===this.data.op&&(t=this.data.op-1),this.renderedFrame=t}var n,r=this.elements.length;for(this.completeLayers||this.checkLayers(this.renderedFrame),n=r-1;n>=0;n-=1)(this.completeLayers||this.elements[n])&&(this.elements[n].prepareFrame(this.renderedFrame-this.layers[n].st),this.elements[n]._mdf&&(this._mdf=!0))}},ICompElement.prototype.renderInnerContent=function(){var e,t=this.layers.length;for(e=0;e<t;e+=1)(this.completeLayers||this.elements[e])&&this.elements[e].renderFrame()},ICompElement.prototype.setElements=function(e){this.elements=e},ICompElement.prototype.getElements=function(){return this.elements},ICompElement.prototype.destroyElements=function(){var e,t=this.layers.length;for(e=0;e<t;e+=1)this.elements[e]&&this.elements[e].destroy()},ICompElement.prototype.destroy=function(){this.destroyElements(),this.destroyBaseElement()},extendPrototype([SVGRendererBase,ICompElement,SVGBaseElement],SVGCompElement),SVGCompElement.prototype.createComp=function(e){return new SVGCompElement(e,this.globalData,this)},extendPrototype([SVGRendererBase],SVGRenderer),SVGRenderer.prototype.createComp=function(e){return new SVGCompElement(e,this.globalData,this)},CVContextData.prototype.duplicate=function(){var e=2*this._length,t=this.savedOp;this.savedOp=createTypedArray("float32",e),this.savedOp.set(t);var n=0;for(n=this._length;n<e;n+=1)this.saved[n]=createTypedArray("float32",16);this._length=e},CVContextData.prototype.reset=function(){this.cArrPos=0,this.cTr.reset(),this.cO=1},ShapeTransformManager.prototype={addTransformSequence:function(e){var t,n=e.length,r="_";for(t=0;t<n;t+=1)r+=e[t].transform.key+"_";var a=this.sequences[r];return a||(a={transforms:[].concat(e),finalTransform:new Matrix,_mdf:!1},this.sequences[r]=a,this.sequenceList.push(a)),a},processSequence:function(e,t){for(var n,r=0,a=e.transforms.length,i=t;r<a&&!t;){if(e.transforms[r].transform.mProps._mdf){i=!0;break}r+=1}if(i)for(e.finalTransform.reset(),r=a-1;r>=0;r-=1)n=e.transforms[r].transform.mProps.v.props,e.finalTransform.transform(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15]);e._mdf=i},processSequences:function(e){var t,n=this.sequenceList.length;for(t=0;t<n;t+=1)this.processSequence(this.sequenceList[t],e)},getNewKey:function(){return this.transform_key_count+=1,"_"+this.transform_key_count}},CVEffects.prototype.renderFrame=function(){},CVMaskElement.prototype.renderFrame=function(){if(this.hasMasks){var e,t,n,r,a=this.element.finalTransform.mat,i=this.element.canvasContext,o=this.masksProperties.length;for(i.beginPath(),e=0;e<o;e+=1)if("n"!==this.masksProperties[e].mode){var s;this.masksProperties[e].inv&&(i.moveTo(0,0),i.lineTo(this.element.globalData.compSize.w,0),i.lineTo(this.element.globalData.compSize.w,this.element.globalData.compSize.h),i.lineTo(0,this.element.globalData.compSize.h),i.lineTo(0,0)),r=this.viewData[e].v,t=a.applyToPointArray(r.v[0][0],r.v[0][1],0),i.moveTo(t[0],t[1]);var u=r._length;for(s=1;s<u;s+=1)n=a.applyToTriplePoints(r.o[s-1],r.i[s],r.v[s]),i.bezierCurveTo(n[0],n[1],n[2],n[3],n[4],n[5]);n=a.applyToTriplePoints(r.o[s-1],r.i[0],r.v[0]),i.bezierCurveTo(n[0],n[1],n[2],n[3],n[4],n[5])}this.element.globalData.renderer.save(!0),i.clip()}},CVMaskElement.prototype.getMaskProperty=MaskElement.prototype.getMaskProperty,CVMaskElement.prototype.destroy=function(){this.element=null},CVBaseElement.prototype={createElements:function(){},initRendererElement:function(){},createContainerElements:function(){this.canvasContext=this.globalData.canvasContext,this.renderableEffectsManager=new CVEffects(this)},createContent:function(){},setBlendMode:function(){var e=this.globalData;if(e.blendMode!==this.data.bm){e.blendMode=this.data.bm;var t=getBlendMode(this.data.bm);e.canvasContext.globalCompositeOperation=t}},createRenderableComponents:function(){this.maskManager=new CVMaskElement(this.data,this)},hideElement:function(){this.hidden||this.isInRange&&!this.isTransparent||(this.hidden=!0)},showElement:function(){this.isInRange&&!this.isTransparent&&(this.hidden=!1,this._isFirstFrame=!0,this.maskManager._isFirstFrame=!0)},renderFrame:function(){if(!this.hidden&&!this.data.hd){this.renderTransform(),this.renderRenderable(),this.setBlendMode();var e=0===this.data.ty;this.globalData.renderer.save(e),this.globalData.renderer.ctxTransform(this.finalTransform.mat.props),this.globalData.renderer.ctxOpacity(this.finalTransform.mProp.o.v),this.renderInnerContent(),this.globalData.renderer.restore(e),this.maskManager.hasMasks&&this.globalData.renderer.restore(!0),this._isFirstFrame&&(this._isFirstFrame=!1)}},destroy:function(){this.canvasContext=null,this.data=null,this.globalData=null,this.maskManager.destroy()},mHelper:new Matrix},CVBaseElement.prototype.hide=CVBaseElement.prototype.hideElement,CVBaseElement.prototype.show=CVBaseElement.prototype.showElement,CVShapeData.prototype.setAsAnimated=SVGShapeData.prototype.setAsAnimated,extendPrototype([BaseElement,TransformElement,CVBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableElement],CVShapeElement),CVShapeElement.prototype.initElement=RenderableDOMElement.prototype.initElement,CVShapeElement.prototype.transformHelper={opacity:1,_opMdf:!1},CVShapeElement.prototype.dashResetter=[],CVShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[])},CVShapeElement.prototype.createStyleElement=function(e,t){var n={data:e,type:e.ty,preTransforms:this.transformsManager.addTransformSequence(t),transforms:[],elements:[],closed:!0===e.hd},r={};if("fl"===e.ty||"st"===e.ty?(r.c=PropertyFactory.getProp(this,e.c,1,255,this),r.c.k||(n.co="rgb("+bmFloor(r.c.v[0])+","+bmFloor(r.c.v[1])+","+bmFloor(r.c.v[2])+")")):"gf"!==e.ty&&"gs"!==e.ty||(r.s=PropertyFactory.getProp(this,e.s,1,null,this),r.e=PropertyFactory.getProp(this,e.e,1,null,this),r.h=PropertyFactory.getProp(this,e.h||{k:0},0,.01,this),r.a=PropertyFactory.getProp(this,e.a||{k:0},0,degToRads,this),r.g=new GradientProperty(this,e.g,this)),r.o=PropertyFactory.getProp(this,e.o,0,.01,this),"st"===e.ty||"gs"===e.ty){if(n.lc=lineCapEnum[e.lc||2],n.lj=lineJoinEnum[e.lj||2],1==e.lj&&(n.ml=e.ml),r.w=PropertyFactory.getProp(this,e.w,0,null,this),r.w.k||(n.wi=r.w.v),e.d){var a=new DashProperty(this,e.d,"canvas",this);r.d=a,r.d.k||(n.da=r.d.dashArray,n.do=r.d.dashoffset[0])}}else n.r=2===e.r?"evenodd":"nonzero";return this.stylesList.push(n),r.style=n,r},CVShapeElement.prototype.createGroupElement=function(){return{it:[],prevViewData:[]}},CVShapeElement.prototype.createTransformElement=function(e){return{transform:{opacity:1,_opMdf:!1,key:this.transformsManager.getNewKey(),op:PropertyFactory.getProp(this,e.o,0,.01,this),mProps:TransformPropertyFactory.getTransformProperty(this,e,this)}}},CVShapeElement.prototype.createShapeElement=function(e){var t=new CVShapeData(this,e,this.stylesList,this.transformsManager);return this.shapes.push(t),this.addShapeToModifiers(t),t},CVShapeElement.prototype.reloadShapes=function(){var e;this._isFirstFrame=!0;var t=this.itemsData.length;for(e=0;e<t;e+=1)this.prevViewData[e]=this.itemsData[e];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[]),t=this.dynamicProperties.length,e=0;e<t;e+=1)this.dynamicProperties[e].getValue();this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame)},CVShapeElement.prototype.addTransformToStyleList=function(e){var t,n=this.stylesList.length;for(t=0;t<n;t+=1)this.stylesList[t].closed||this.stylesList[t].transforms.push(e)},CVShapeElement.prototype.removeTransformFromStyleList=function(){var e,t=this.stylesList.length;for(e=0;e<t;e+=1)this.stylesList[e].closed||this.stylesList[e].transforms.pop()},CVShapeElement.prototype.closeStyles=function(e){var t,n=e.length;for(t=0;t<n;t+=1)e[t].closed=!0},CVShapeElement.prototype.searchShapes=function(e,t,n,r,a){var i,o,s,u,c,l,h=e.length-1,f=[],p=[],d=[].concat(a);for(i=h;i>=0;i-=1){if((u=this.searchProcessedElement(e[i]))?t[i]=n[u-1]:e[i]._shouldRender=r,"fl"===e[i].ty||"st"===e[i].ty||"gf"===e[i].ty||"gs"===e[i].ty)u?t[i].style.closed=!1:t[i]=this.createStyleElement(e[i],d),f.push(t[i].style);else if("gr"===e[i].ty){if(u)for(s=t[i].it.length,o=0;o<s;o+=1)t[i].prevViewData[o]=t[i].it[o];else t[i]=this.createGroupElement(e[i]);this.searchShapes(e[i].it,t[i].it,t[i].prevViewData,r,d)}else"tr"===e[i].ty?(u||(l=this.createTransformElement(e[i]),t[i]=l),d.push(t[i]),this.addTransformToStyleList(t[i])):"sh"===e[i].ty||"rc"===e[i].ty||"el"===e[i].ty||"sr"===e[i].ty?u||(t[i]=this.createShapeElement(e[i])):"tm"===e[i].ty||"rd"===e[i].ty||"pb"===e[i].ty?(u?(c=t[i]).closed=!1:((c=ShapeModifiers.getModifier(e[i].ty)).init(this,e[i]),t[i]=c,this.shapeModifiers.push(c)),p.push(c)):"rp"===e[i].ty&&(u?(c=t[i]).closed=!0:(c=ShapeModifiers.getModifier(e[i].ty),t[i]=c,c.init(this,e,i,t),this.shapeModifiers.push(c),r=!1),p.push(c));this.addProcessedElement(e[i],i+1)}for(this.removeTransformFromStyleList(),this.closeStyles(f),h=p.length,i=0;i<h;i+=1)p[i].closed=!0},CVShapeElement.prototype.renderInnerContent=function(){this.transformHelper.opacity=1,this.transformHelper._opMdf=!1,this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame),this.renderShape(this.transformHelper,this.shapesData,this.itemsData,!0)},CVShapeElement.prototype.renderShapeTransform=function(e,t){(e._opMdf||t.op._mdf||this._isFirstFrame)&&(t.opacity=e.opacity,t.opacity*=t.op.v,t._opMdf=!0)},CVShapeElement.prototype.drawLayer=function(){var e,t,n,r,a,i,o,s,u,c=this.stylesList.length,l=this.globalData.renderer,h=this.globalData.canvasContext;for(e=0;e<c;e+=1)if(("st"!==(s=(u=this.stylesList[e]).type)&&"gs"!==s||0!==u.wi)&&u.data._shouldRender&&0!==u.coOp&&0!==this.globalData.currentGlobalAlpha){for(l.save(),i=u.elements,"st"===s||"gs"===s?(h.strokeStyle="st"===s?u.co:u.grd,h.lineWidth=u.wi,h.lineCap=u.lc,h.lineJoin=u.lj,h.miterLimit=u.ml||0):h.fillStyle="fl"===s?u.co:u.grd,l.ctxOpacity(u.coOp),"st"!==s&&"gs"!==s&&h.beginPath(),l.ctxTransform(u.preTransforms.finalTransform.props),n=i.length,t=0;t<n;t+=1){for("st"!==s&&"gs"!==s||(h.beginPath(),u.da&&(h.setLineDash(u.da),h.lineDashOffset=u.do)),a=(o=i[t].trNodes).length,r=0;r<a;r+=1)"m"===o[r].t?h.moveTo(o[r].p[0],o[r].p[1]):"c"===o[r].t?h.bezierCurveTo(o[r].pts[0],o[r].pts[1],o[r].pts[2],o[r].pts[3],o[r].pts[4],o[r].pts[5]):h.closePath();"st"!==s&&"gs"!==s||(h.stroke(),u.da&&h.setLineDash(this.dashResetter))}"st"!==s&&"gs"!==s&&h.fill(u.r),l.restore()}},CVShapeElement.prototype.renderShape=function(e,t,n,r){var a,i;for(i=e,a=t.length-1;a>=0;a-=1)"tr"===t[a].ty?(i=n[a].transform,this.renderShapeTransform(e,i)):"sh"===t[a].ty||"el"===t[a].ty||"rc"===t[a].ty||"sr"===t[a].ty?this.renderPath(t[a],n[a]):"fl"===t[a].ty?this.renderFill(t[a],n[a],i):"st"===t[a].ty?this.renderStroke(t[a],n[a],i):"gf"===t[a].ty||"gs"===t[a].ty?this.renderGradientFill(t[a],n[a],i):"gr"===t[a].ty?this.renderShape(i,t[a].it,n[a].it):t[a].ty;r&&this.drawLayer()},CVShapeElement.prototype.renderStyledShape=function(e,t){if(this._isFirstFrame||t._mdf||e.transforms._mdf){var n,r,a,i=e.trNodes,o=t.paths,s=o._length;i.length=0;var u=e.transforms.finalTransform;for(a=0;a<s;a+=1){var c=o.shapes[a];if(c&&c.v){for(r=c._length,n=1;n<r;n+=1)1===n&&i.push({t:"m",p:u.applyToPointArray(c.v[0][0],c.v[0][1],0)}),i.push({t:"c",pts:u.applyToTriplePoints(c.o[n-1],c.i[n],c.v[n])});1===r&&i.push({t:"m",p:u.applyToPointArray(c.v[0][0],c.v[0][1],0)}),c.c&&r&&(i.push({t:"c",pts:u.applyToTriplePoints(c.o[n-1],c.i[0],c.v[0])}),i.push({t:"z"}))}}e.trNodes=i}},CVShapeElement.prototype.renderPath=function(e,t){if(!0!==e.hd&&e._shouldRender){var n,r=t.styledShapes.length;for(n=0;n<r;n+=1)this.renderStyledShape(t.styledShapes[n],t.sh)}},CVShapeElement.prototype.renderFill=function(e,t,n){var r=t.style;(t.c._mdf||this._isFirstFrame)&&(r.co="rgb("+bmFloor(t.c.v[0])+","+bmFloor(t.c.v[1])+","+bmFloor(t.c.v[2])+")"),(t.o._mdf||n._opMdf||this._isFirstFrame)&&(r.coOp=t.o.v*n.opacity)},CVShapeElement.prototype.renderGradientFill=function(e,t,n){var r,a=t.style;if(!a.grd||t.g._mdf||t.s._mdf||t.e._mdf||1!==e.t&&(t.h._mdf||t.a._mdf)){var i,o=this.globalData.canvasContext,s=t.s.v,u=t.e.v;if(1===e.t)r=o.createLinearGradient(s[0],s[1],u[0],u[1]);else{var c=Math.sqrt(Math.pow(s[0]-u[0],2)+Math.pow(s[1]-u[1],2)),l=Math.atan2(u[1]-s[1],u[0]-s[0]),h=t.h.v;h>=1?h=.99:h<=-1&&(h=-.99);var f=c*h,p=Math.cos(l+t.a.v)*f+s[0],d=Math.sin(l+t.a.v)*f+s[1];r=o.createRadialGradient(p,d,0,s[0],s[1],c)}var m=e.g.p,v=t.g.c,g=1;for(i=0;i<m;i+=1)t.g._hasOpacity&&t.g._collapsable&&(g=t.g.o[2*i+1]),r.addColorStop(v[4*i]/100,"rgba("+v[4*i+1]+","+v[4*i+2]+","+v[4*i+3]+","+g+")");a.grd=r}a.coOp=t.o.v*n.opacity},CVShapeElement.prototype.renderStroke=function(e,t,n){var r=t.style,a=t.d;a&&(a._mdf||this._isFirstFrame)&&(r.da=a.dashArray,r.do=a.dashoffset[0]),(t.c._mdf||this._isFirstFrame)&&(r.co="rgb("+bmFloor(t.c.v[0])+","+bmFloor(t.c.v[1])+","+bmFloor(t.c.v[2])+")"),(t.o._mdf||n._opMdf||this._isFirstFrame)&&(r.coOp=t.o.v*n.opacity),(t.w._mdf||this._isFirstFrame)&&(r.wi=t.w.v)},CVShapeElement.prototype.destroy=function(){this.shapesData=null,this.globalData=null,this.canvasContext=null,this.stylesList.length=0,this.itemsData.length=0},extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement,ITextElement],CVTextElement),CVTextElement.prototype.tHelper=createTag("canvas").getContext("2d"),CVTextElement.prototype.buildNewText=function(){var e=this.textProperty.currentData;this.renderedLetters=createSizedArray(e.l?e.l.length:0);var t=!1;e.fc?(t=!0,this.values.fill=this.buildColor(e.fc)):this.values.fill="rgba(0,0,0,0)",this.fill=t;var n=!1;e.sc&&(n=!0,this.values.stroke=this.buildColor(e.sc),this.values.sWidth=e.sw);var r,a,i,o,s,u,c,l,h,f,p,d,m=this.globalData.fontManager.getFontByName(e.f),v=e.l,g=this.mHelper;this.stroke=n,this.values.fValue=e.finalSize+"px "+this.globalData.fontManager.getFontByName(e.f).fFamily,a=e.finalText.length;var y=this.data.singleShape,b=.001*e.tr*e.finalSize,k=0,x=0,w=!0,_=0;for(r=0;r<a;r+=1){o=(i=this.globalData.fontManager.getCharData(e.finalText[r],m.fStyle,this.globalData.fontManager.getFontByName(e.f).fFamily))&&i.data||{},g.reset(),y&&v[r].n&&(k=-b,x+=e.yOffset,x+=w?1:0,w=!1),h=(c=o.shapes?o.shapes[0].it:[]).length,g.scale(e.finalSize/100,e.finalSize/100),y&&this.applyTextPropertiesToMatrix(e,g,v[r].line,k,x),p=createSizedArray(h-1);var S=0;for(l=0;l<h;l+=1)if("sh"===c[l].ty){for(u=c[l].ks.k.i.length,f=c[l].ks.k,d=[],s=1;s<u;s+=1)1===s&&d.push(g.applyToX(f.v[0][0],f.v[0][1],0),g.applyToY(f.v[0][0],f.v[0][1],0)),d.push(g.applyToX(f.o[s-1][0],f.o[s-1][1],0),g.applyToY(f.o[s-1][0],f.o[s-1][1],0),g.applyToX(f.i[s][0],f.i[s][1],0),g.applyToY(f.i[s][0],f.i[s][1],0),g.applyToX(f.v[s][0],f.v[s][1],0),g.applyToY(f.v[s][0],f.v[s][1],0));d.push(g.applyToX(f.o[s-1][0],f.o[s-1][1],0),g.applyToY(f.o[s-1][0],f.o[s-1][1],0),g.applyToX(f.i[0][0],f.i[0][1],0),g.applyToY(f.i[0][0],f.i[0][1],0),g.applyToX(f.v[0][0],f.v[0][1],0),g.applyToY(f.v[0][0],f.v[0][1],0)),p[S]=d,S+=1}y&&(k+=v[r].l,k+=b),this.textSpans[_]?this.textSpans[_].elem=p:this.textSpans[_]={elem:p},_+=1}},CVTextElement.prototype.renderInnerContent=function(){var e,t,n,r,a,i,o=this.canvasContext;o.font=this.values.fValue,o.lineCap="butt",o.lineJoin="miter",o.miterLimit=4,this.data.singleShape||this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag);var s,u=this.textAnimator.renderedLetters,c=this.textProperty.currentData.l;t=c.length;var l,h,f=null,p=null,d=null;for(e=0;e<t;e+=1)if(!c[e].n){if((s=u[e])&&(this.globalData.renderer.save(),this.globalData.renderer.ctxTransform(s.p),this.globalData.renderer.ctxOpacity(s.o)),this.fill){for(s&&s.fc?f!==s.fc&&(f=s.fc,o.fillStyle=s.fc):f!==this.values.fill&&(f=this.values.fill,o.fillStyle=this.values.fill),r=(l=this.textSpans[e].elem).length,this.globalData.canvasContext.beginPath(),n=0;n<r;n+=1)for(i=(h=l[n]).length,this.globalData.canvasContext.moveTo(h[0],h[1]),a=2;a<i;a+=6)this.globalData.canvasContext.bezierCurveTo(h[a],h[a+1],h[a+2],h[a+3],h[a+4],h[a+5]);this.globalData.canvasContext.closePath(),this.globalData.canvasContext.fill()}if(this.stroke){for(s&&s.sw?d!==s.sw&&(d=s.sw,o.lineWidth=s.sw):d!==this.values.sWidth&&(d=this.values.sWidth,o.lineWidth=this.values.sWidth),s&&s.sc?p!==s.sc&&(p=s.sc,o.strokeStyle=s.sc):p!==this.values.stroke&&(p=this.values.stroke,o.strokeStyle=this.values.stroke),r=(l=this.textSpans[e].elem).length,this.globalData.canvasContext.beginPath(),n=0;n<r;n+=1)for(i=(h=l[n]).length,this.globalData.canvasContext.moveTo(h[0],h[1]),a=2;a<i;a+=6)this.globalData.canvasContext.bezierCurveTo(h[a],h[a+1],h[a+2],h[a+3],h[a+4],h[a+5]);this.globalData.canvasContext.closePath(),this.globalData.canvasContext.stroke()}s&&this.globalData.renderer.restore()}},extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVImageElement),CVImageElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVImageElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVImageElement.prototype.createContent=function(){if(this.img.width&&(this.assetData.w!==this.img.width||this.assetData.h!==this.img.height)){var e=createTag("canvas");e.width=this.assetData.w,e.height=this.assetData.h;var t,n,r=e.getContext("2d"),a=this.img.width,i=this.img.height,o=a/i,s=this.assetData.w/this.assetData.h,u=this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio;o>s&&"xMidYMid slice"===u||o<s&&"xMidYMid slice"!==u?t=(n=i)*s:n=(t=a)/s,r.drawImage(this.img,(a-t)/2,(i-n)/2,t,n,0,0,this.assetData.w,this.assetData.h),this.img=e}},CVImageElement.prototype.renderInnerContent=function(){this.canvasContext.drawImage(this.img,0,0)},CVImageElement.prototype.destroy=function(){this.img=null},extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVSolidElement),CVSolidElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVSolidElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVSolidElement.prototype.renderInnerContent=function(){var e=this.canvasContext;e.fillStyle=this.data.sc,e.fillRect(0,0,this.data.sw,this.data.sh)},extendPrototype([BaseRenderer],CanvasRendererBase),CanvasRendererBase.prototype.createShape=function(e){return new CVShapeElement(e,this.globalData,this)},CanvasRendererBase.prototype.createText=function(e){return new CVTextElement(e,this.globalData,this)},CanvasRendererBase.prototype.createImage=function(e){return new CVImageElement(e,this.globalData,this)},CanvasRendererBase.prototype.createSolid=function(e){return new CVSolidElement(e,this.globalData,this)},CanvasRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,CanvasRendererBase.prototype.ctxTransform=function(e){if(1!==e[0]||0!==e[1]||0!==e[4]||1!==e[5]||0!==e[12]||0!==e[13])if(this.renderConfig.clearCanvas){this.transformMat.cloneFromProps(e);var t=this.contextData.cTr.props;this.transformMat.transform(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]),this.contextData.cTr.cloneFromProps(this.transformMat.props);var n=this.contextData.cTr.props;this.canvasContext.setTransform(n[0],n[1],n[4],n[5],n[12],n[13])}else this.canvasContext.transform(e[0],e[1],e[4],e[5],e[12],e[13])},CanvasRendererBase.prototype.ctxOpacity=function(e){if(!this.renderConfig.clearCanvas)return this.canvasContext.globalAlpha*=e<0?0:e,void(this.globalData.currentGlobalAlpha=this.contextData.cO);this.contextData.cO*=e<0?0:e,this.globalData.currentGlobalAlpha!==this.contextData.cO&&(this.canvasContext.globalAlpha=this.contextData.cO,this.globalData.currentGlobalAlpha=this.contextData.cO)},CanvasRendererBase.prototype.reset=function(){this.renderConfig.clearCanvas?this.contextData.reset():this.canvasContext.restore()},CanvasRendererBase.prototype.save=function(e){if(this.renderConfig.clearCanvas){e&&this.canvasContext.save();var t,n=this.contextData.cTr.props;this.contextData._length<=this.contextData.cArrPos&&this.contextData.duplicate();var r=this.contextData.saved[this.contextData.cArrPos];for(t=0;t<16;t+=1)r[t]=n[t];this.contextData.savedOp[this.contextData.cArrPos]=this.contextData.cO,this.contextData.cArrPos+=1}else this.canvasContext.save()},CanvasRendererBase.prototype.restore=function(e){if(this.renderConfig.clearCanvas){e&&(this.canvasContext.restore(),this.globalData.blendMode="source-over"),this.contextData.cArrPos-=1;var t,n=this.contextData.saved[this.contextData.cArrPos],r=this.contextData.cTr.props;for(t=0;t<16;t+=1)r[t]=n[t];this.canvasContext.setTransform(n[0],n[1],n[4],n[5],n[12],n[13]),n=this.contextData.savedOp[this.contextData.cArrPos],this.contextData.cO=n,this.globalData.currentGlobalAlpha!==n&&(this.canvasContext.globalAlpha=n,this.globalData.currentGlobalAlpha=n)}else this.canvasContext.restore()},CanvasRendererBase.prototype.configAnimation=function(e){if(this.animationItem.wrapper){this.animationItem.container=createTag("canvas");var t=this.animationItem.container.style;t.width="100%",t.height="100%";var n="0px 0px 0px";t.transformOrigin=n,t.mozTransformOrigin=n,t.webkitTransformOrigin=n,t["-webkit-transform"]=n,t.contentVisibility=this.renderConfig.contentVisibility,this.animationItem.wrapper.appendChild(this.animationItem.container),this.canvasContext=this.animationItem.container.getContext("2d"),this.renderConfig.className&&this.animationItem.container.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.animationItem.container.setAttribute("id",this.renderConfig.id)}else this.canvasContext=this.renderConfig.context;this.data=e,this.layers=e.layers,this.transformCanvas={w:e.w,h:e.h,sx:0,sy:0,tx:0,ty:0},this.setupGlobalData(e,document.body),this.globalData.canvasContext=this.canvasContext,this.globalData.renderer=this,this.globalData.isDashed=!1,this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.globalData.transformCanvas=this.transformCanvas,this.elements=createSizedArray(e.layers.length),this.updateContainerSize()},CanvasRendererBase.prototype.updateContainerSize=function(){var e,t,n,r;if(this.reset(),this.animationItem.wrapper&&this.animationItem.container?(e=this.animationItem.wrapper.offsetWidth,t=this.animationItem.wrapper.offsetHeight,this.animationItem.container.setAttribute("width",e*this.renderConfig.dpr),this.animationItem.container.setAttribute("height",t*this.renderConfig.dpr)):(e=this.canvasContext.canvas.width*this.renderConfig.dpr,t=this.canvasContext.canvas.height*this.renderConfig.dpr),-1!==this.renderConfig.preserveAspectRatio.indexOf("meet")||-1!==this.renderConfig.preserveAspectRatio.indexOf("slice")){var a=this.renderConfig.preserveAspectRatio.split(" "),i=a[1]||"meet",o=a[0]||"xMidYMid",s=o.substr(0,4),u=o.substr(4);n=e/t,(r=this.transformCanvas.w/this.transformCanvas.h)>n&&"meet"===i||r<n&&"slice"===i?(this.transformCanvas.sx=e/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=e/(this.transformCanvas.w/this.renderConfig.dpr)):(this.transformCanvas.sx=t/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.sy=t/(this.transformCanvas.h/this.renderConfig.dpr)),this.transformCanvas.tx="xMid"===s&&(r<n&&"meet"===i||r>n&&"slice"===i)?(e-this.transformCanvas.w*(t/this.transformCanvas.h))/2*this.renderConfig.dpr:"xMax"===s&&(r<n&&"meet"===i||r>n&&"slice"===i)?(e-this.transformCanvas.w*(t/this.transformCanvas.h))*this.renderConfig.dpr:0,this.transformCanvas.ty="YMid"===u&&(r>n&&"meet"===i||r<n&&"slice"===i)?(t-this.transformCanvas.h*(e/this.transformCanvas.w))/2*this.renderConfig.dpr:"YMax"===u&&(r>n&&"meet"===i||r<n&&"slice"===i)?(t-this.transformCanvas.h*(e/this.transformCanvas.w))*this.renderConfig.dpr:0}else"none"===this.renderConfig.preserveAspectRatio?(this.transformCanvas.sx=e/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=t/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.tx=0,this.transformCanvas.ty=0):(this.transformCanvas.sx=this.renderConfig.dpr,this.transformCanvas.sy=this.renderConfig.dpr,this.transformCanvas.tx=0,this.transformCanvas.ty=0);this.transformCanvas.props=[this.transformCanvas.sx,0,0,0,0,this.transformCanvas.sy,0,0,0,0,1,0,this.transformCanvas.tx,this.transformCanvas.ty,0,1],this.ctxTransform(this.transformCanvas.props),this.canvasContext.beginPath(),this.canvasContext.rect(0,0,this.transformCanvas.w,this.transformCanvas.h),this.canvasContext.closePath(),this.canvasContext.clip(),this.renderFrame(this.renderedFrame,!0)},CanvasRendererBase.prototype.destroy=function(){var e;for(this.renderConfig.clearCanvas&&this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),e=(this.layers?this.layers.length:0)-1;e>=0;e-=1)this.elements[e]&&this.elements[e].destroy();this.elements.length=0,this.globalData.canvasContext=null,this.animationItem.container=null,this.destroyed=!0},CanvasRendererBase.prototype.renderFrame=function(e,t){if((this.renderedFrame!==e||!0!==this.renderConfig.clearCanvas||t)&&!this.destroyed&&-1!==e){var n;this.renderedFrame=e,this.globalData.frameNum=e-this.animationItem._isFirstFrame,this.globalData.frameId+=1,this.globalData._mdf=!this.renderConfig.clearCanvas||t,this.globalData.projectInterface.currentFrame=e;var r=this.layers.length;for(this.completeLayers||this.checkLayers(e),n=0;n<r;n+=1)(this.completeLayers||this.elements[n])&&this.elements[n].prepareFrame(e-this.layers[n].st);if(this.globalData._mdf){for(!0===this.renderConfig.clearCanvas?this.canvasContext.clearRect(0,0,this.transformCanvas.w,this.transformCanvas.h):this.save(),n=r-1;n>=0;n-=1)(this.completeLayers||this.elements[n])&&this.elements[n].renderFrame();!0!==this.renderConfig.clearCanvas&&this.restore()}}},CanvasRendererBase.prototype.buildItem=function(e){var t=this.elements;if(!t[e]&&99!==this.layers[e].ty){var n=this.createItem(this.layers[e],this,this.globalData);t[e]=n,n.initExpressions()}},CanvasRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;)this.pendingElements.pop().checkParenting()},CanvasRendererBase.prototype.hide=function(){this.animationItem.container.style.display="none"},CanvasRendererBase.prototype.show=function(){this.animationItem.container.style.display="block"},extendPrototype([CanvasRendererBase,ICompElement,CVBaseElement],CVCompElement),CVCompElement.prototype.renderInnerContent=function(){var e,t=this.canvasContext;for(t.beginPath(),t.moveTo(0,0),t.lineTo(this.data.w,0),t.lineTo(this.data.w,this.data.h),t.lineTo(0,this.data.h),t.lineTo(0,0),t.clip(),e=this.layers.length-1;e>=0;e-=1)(this.completeLayers||this.elements[e])&&this.elements[e].renderFrame()},CVCompElement.prototype.destroy=function(){var e;for(e=this.layers.length-1;e>=0;e-=1)this.elements[e]&&this.elements[e].destroy();this.layers=null,this.elements=null},CVCompElement.prototype.createComp=function(e){return new CVCompElement(e,this.globalData,this)},extendPrototype([CanvasRendererBase],CanvasRenderer),CanvasRenderer.prototype.createComp=function(e){return new CVCompElement(e,this.globalData,this)},HBaseElement.prototype={checkBlendMode:function(){},initRendererElement:function(){this.baseElement=createTag(this.data.tg||"div"),this.data.hasMask?(this.svgElement=createNS("svg"),this.layerElement=createNS("g"),this.maskedElement=this.layerElement,this.svgElement.appendChild(this.layerElement),this.baseElement.appendChild(this.svgElement)):this.layerElement=this.baseElement,styleDiv(this.baseElement)},createContainerElements:function(){this.renderableEffectsManager=new CVEffects(this),this.transformedElement=this.baseElement,this.maskedElement=this.layerElement,this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),0!==this.data.bm&&this.setBlendMode()},renderElement:function(){var e=this.transformedElement?this.transformedElement.style:{};if(this.finalTransform._matMdf){var t=this.finalTransform.mat.toCSS();e.transform=t,e.webkitTransform=t}this.finalTransform._opMdf&&(e.opacity=this.finalTransform.mProp.o.v)},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},destroy:function(){this.layerElement=null,this.transformedElement=null,this.matteElement&&(this.matteElement=null),this.maskManager&&(this.maskManager.destroy(),this.maskManager=null)},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData)},addEffects:function(){},setMatte:function(){}},HBaseElement.prototype.getBaseElement=SVGBaseElement.prototype.getBaseElement,HBaseElement.prototype.destroyBaseElement=HBaseElement.prototype.destroy,HBaseElement.prototype.buildElementParenting=BaseRenderer.prototype.buildElementParenting,extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],HSolidElement),HSolidElement.prototype.createContent=function(){var e;this.data.hasMask?((e=createNS("rect")).setAttribute("width",this.data.sw),e.setAttribute("height",this.data.sh),e.setAttribute("fill",this.data.sc),this.svgElement.setAttribute("width",this.data.sw),this.svgElement.setAttribute("height",this.data.sh)):((e=createTag("div")).style.width=this.data.sw+"px",e.style.height=this.data.sh+"px",e.style.backgroundColor=this.data.sc),this.layerElement.appendChild(e)},extendPrototype([BaseElement,TransformElement,HSolidElement,SVGShapeElement,HBaseElement,HierarchyElement,FrameElement,RenderableElement],HShapeElement),HShapeElement.prototype._renderShapeFrame=HShapeElement.prototype.renderInnerContent,HShapeElement.prototype.createContent=function(){var e;if(this.baseElement.style.fontSize=0,this.data.hasMask)this.layerElement.appendChild(this.shapesContainer),e=this.svgElement;else{e=createNS("svg");var t=this.comp.data?this.comp.data:this.globalData.compSize;e.setAttribute("width",t.w),e.setAttribute("height",t.h),e.appendChild(this.shapesContainer),this.layerElement.appendChild(e)}this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.shapesContainer,0,[],!0),this.filterUniqueShapes(),this.shapeCont=e},HShapeElement.prototype.getTransformedPoint=function(e,t){var n,r=e.length;for(n=0;n<r;n+=1)t=e[n].mProps.v.applyToPointArray(t[0],t[1],0);return t},HShapeElement.prototype.calculateShapeBoundingBox=function(e,t){var n,r,a,i,o,s=e.sh.v,u=e.transformers,c=s._length;if(!(c<=1)){for(n=0;n<c-1;n+=1)r=this.getTransformedPoint(u,s.v[n]),a=this.getTransformedPoint(u,s.o[n]),i=this.getTransformedPoint(u,s.i[n+1]),o=this.getTransformedPoint(u,s.v[n+1]),this.checkBounds(r,a,i,o,t);s.c&&(r=this.getTransformedPoint(u,s.v[n]),a=this.getTransformedPoint(u,s.o[n]),i=this.getTransformedPoint(u,s.i[0]),o=this.getTransformedPoint(u,s.v[0]),this.checkBounds(r,a,i,o,t))}},HShapeElement.prototype.checkBounds=function(e,t,n,r,a){this.getBoundsOfCurve(e,t,n,r);var i=this.shapeBoundingBox;a.x=bmMin(i.left,a.x),a.xMax=bmMax(i.right,a.xMax),a.y=bmMin(i.top,a.y),a.yMax=bmMax(i.bottom,a.yMax)},HShapeElement.prototype.shapeBoundingBox={left:0,right:0,top:0,bottom:0},HShapeElement.prototype.tempBoundingBox={x:0,xMax:0,y:0,yMax:0,width:0,height:0},HShapeElement.prototype.getBoundsOfCurve=function(e,t,n,r){for(var a,i,o,s,u,c,l,h=[[e[0],r[0]],[e[1],r[1]]],f=0;f<2;++f)i=6*e[f]-12*t[f]+6*n[f],a=-3*e[f]+9*t[f]-9*n[f]+3*r[f],o=3*t[f]-3*e[f],i|=0,o|=0,0===(a|=0)&&0===i||(0===a?(s=-o/i)>0&&s<1&&h[f].push(this.calculateF(s,e,t,n,r,f)):(u=i*i-4*o*a)>=0&&((c=(-i+bmSqrt(u))/(2*a))>0&&c<1&&h[f].push(this.calculateF(c,e,t,n,r,f)),(l=(-i-bmSqrt(u))/(2*a))>0&&l<1&&h[f].push(this.calculateF(l,e,t,n,r,f))));this.shapeBoundingBox.left=bmMin.apply(null,h[0]),this.shapeBoundingBox.top=bmMin.apply(null,h[1]),this.shapeBoundingBox.right=bmMax.apply(null,h[0]),this.shapeBoundingBox.bottom=bmMax.apply(null,h[1])},HShapeElement.prototype.calculateF=function(e,t,n,r,a,i){return bmPow(1-e,3)*t[i]+3*bmPow(1-e,2)*e*n[i]+3*(1-e)*bmPow(e,2)*r[i]+bmPow(e,3)*a[i]},HShapeElement.prototype.calculateBoundingBox=function(e,t){var n,r=e.length;for(n=0;n<r;n+=1)e[n]&&e[n].sh?this.calculateShapeBoundingBox(e[n],t):e[n]&&e[n].it&&this.calculateBoundingBox(e[n].it,t)},HShapeElement.prototype.currentBoxContains=function(e){return this.currentBBox.x<=e.x&&this.currentBBox.y<=e.y&&this.currentBBox.width+this.currentBBox.x>=e.x+e.width&&this.currentBBox.height+this.currentBBox.y>=e.y+e.height},HShapeElement.prototype.renderInnerContent=function(){if(this._renderShapeFrame(),!this.hidden&&(this._isFirstFrame||this._mdf)){var e=this.tempBoundingBox,t=999999;if(e.x=t,e.xMax=-t,e.y=t,e.yMax=-t,this.calculateBoundingBox(this.itemsData,e),e.width=e.xMax<e.x?0:e.xMax-e.x,e.height=e.yMax<e.y?0:e.yMax-e.y,this.currentBoxContains(e))return;var n=!1;if(this.currentBBox.w!==e.width&&(this.currentBBox.w=e.width,this.shapeCont.setAttribute("width",e.width),n=!0),this.currentBBox.h!==e.height&&(this.currentBBox.h=e.height,this.shapeCont.setAttribute("height",e.height),n=!0),n||this.currentBBox.x!==e.x||this.currentBBox.y!==e.y){this.currentBBox.w=e.width,this.currentBBox.h=e.height,this.currentBBox.x=e.x,this.currentBBox.y=e.y,this.shapeCont.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h);var r=this.shapeCont.style,a="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";r.transform=a,r.webkitTransform=a}}},extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],HTextElement),HTextElement.prototype.createContent=function(){if(this.isMasked=this.checkMasks(),this.isMasked){this.renderType="svg",this.compW=this.comp.data.w,this.compH=this.comp.data.h,this.svgElement.setAttribute("width",this.compW),this.svgElement.setAttribute("height",this.compH);var e=createNS("g");this.maskedElement.appendChild(e),this.innerElem=e}else this.renderType="html",this.innerElem=this.layerElement;this.checkParenting()},HTextElement.prototype.buildNewText=function(){var e=this.textProperty.currentData;this.renderedLetters=createSizedArray(e.l?e.l.length:0);var t=this.innerElem.style,n=e.fc?this.buildColor(e.fc):"rgba(0,0,0,0)";t.fill=n,t.color=n,e.sc&&(t.stroke=this.buildColor(e.sc),t.strokeWidth=e.sw+"px");var r,a,i=this.globalData.fontManager.getFontByName(e.f);if(!this.globalData.fontManager.chars)if(t.fontSize=e.finalSize+"px",t.lineHeight=e.finalSize+"px",i.fClass)this.innerElem.className=i.fClass;else{t.fontFamily=i.fFamily;var o=e.fWeight,s=e.fStyle;t.fontStyle=s,t.fontWeight=o}var u,c,l,h=e.l;a=h.length;var f,p=this.mHelper,d="",m=0;for(r=0;r<a;r+=1){if(this.globalData.fontManager.chars?(this.textPaths[m]?u=this.textPaths[m]:((u=createNS("path")).setAttribute("stroke-linecap",lineCapEnum[1]),u.setAttribute("stroke-linejoin",lineJoinEnum[2]),u.setAttribute("stroke-miterlimit","4")),this.isMasked||(this.textSpans[m]?l=(c=this.textSpans[m]).children[0]:((c=createTag("div")).style.lineHeight=0,(l=createNS("svg")).appendChild(u),styleDiv(c)))):this.isMasked?u=this.textPaths[m]?this.textPaths[m]:createNS("text"):this.textSpans[m]?(c=this.textSpans[m],u=this.textPaths[m]):(styleDiv(c=createTag("span")),styleDiv(u=createTag("span")),c.appendChild(u)),this.globalData.fontManager.chars){var v,g=this.globalData.fontManager.getCharData(e.finalText[r],i.fStyle,this.globalData.fontManager.getFontByName(e.f).fFamily);if(v=g?g.data:null,p.reset(),v&&v.shapes&&v.shapes.length&&(f=v.shapes[0].it,p.scale(e.finalSize/100,e.finalSize/100),d=this.createPathShape(p,f),u.setAttribute("d",d)),this.isMasked)this.innerElem.appendChild(u);else{if(this.innerElem.appendChild(c),v&&v.shapes){document.body.appendChild(l);var y=l.getBBox();l.setAttribute("width",y.width+2),l.setAttribute("height",y.height+2),l.setAttribute("viewBox",y.x-1+" "+(y.y-1)+" "+(y.width+2)+" "+(y.height+2));var b=l.style,k="translate("+(y.x-1)+"px,"+(y.y-1)+"px)";b.transform=k,b.webkitTransform=k,h[r].yOffset=y.y-1}else l.setAttribute("width",1),l.setAttribute("height",1);c.appendChild(l)}}else if(u.textContent=h[r].val,u.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),this.isMasked)this.innerElem.appendChild(u);else{this.innerElem.appendChild(c);var x=u.style,w="translate3d(0,"+-e.finalSize/1.2+"px,0)";x.transform=w,x.webkitTransform=w}this.isMasked?this.textSpans[m]=u:this.textSpans[m]=c,this.textSpans[m].style.display="block",this.textPaths[m]=u,m+=1}for(;m<this.textSpans.length;)this.textSpans[m].style.display="none",m+=1},HTextElement.prototype.renderInnerContent=function(){var e;if(this.data.singleShape){if(!this._isFirstFrame&&!this.lettersChangedFlag)return;if(this.isMasked&&this.finalTransform._matMdf){this.svgElement.setAttribute("viewBox",-this.finalTransform.mProp.p.v[0]+" "+-this.finalTransform.mProp.p.v[1]+" "+this.compW+" "+this.compH),e=this.svgElement.style;var t="translate("+-this.finalTransform.mProp.p.v[0]+"px,"+-this.finalTransform.mProp.p.v[1]+"px)";e.transform=t,e.webkitTransform=t}}if(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag){var n,r,a,i,o,s=0,u=this.textAnimator.renderedLetters,c=this.textProperty.currentData.l;for(r=c.length,n=0;n<r;n+=1)c[n].n?s+=1:(i=this.textSpans[n],o=this.textPaths[n],a=u[s],s+=1,a._mdf.m&&(this.isMasked?i.setAttribute("transform",a.m):(i.style.webkitTransform=a.m,i.style.transform=a.m)),i.style.opacity=a.o,a.sw&&a._mdf.sw&&o.setAttribute("stroke-width",a.sw),a.sc&&a._mdf.sc&&o.setAttribute("stroke",a.sc),a.fc&&a._mdf.fc&&(o.setAttribute("fill",a.fc),o.style.color=a.fc));if(this.innerElem.getBBox&&!this.hidden&&(this._isFirstFrame||this._mdf)){var l=this.innerElem.getBBox();if(this.currentBBox.w!==l.width&&(this.currentBBox.w=l.width,this.svgElement.setAttribute("width",l.width)),this.currentBBox.h!==l.height&&(this.currentBBox.h=l.height,this.svgElement.setAttribute("height",l.height)),this.currentBBox.w!==l.width+2||this.currentBBox.h!==l.height+2||this.currentBBox.x!==l.x-1||this.currentBBox.y!==l.y-1){this.currentBBox.w=l.width+2,this.currentBBox.h=l.height+2,this.currentBBox.x=l.x-1,this.currentBBox.y=l.y-1,this.svgElement.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h),e=this.svgElement.style;var h="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";e.transform=h,e.webkitTransform=h}}}},extendPrototype([BaseElement,FrameElement,HierarchyElement],HCameraElement),HCameraElement.prototype.setup=function(){var e,t,n,r,a=this.comp.threeDElements.length;for(e=0;e<a;e+=1)if("3d"===(t=this.comp.threeDElements[e]).type){n=t.perspectiveElem.style,r=t.container.style;var i=this.pe.v+"px",o="0px 0px 0px",s="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";n.perspective=i,n.webkitPerspective=i,r.transformOrigin=o,r.mozTransformOrigin=o,r.webkitTransformOrigin=o,n.transform=s,n.webkitTransform=s}},HCameraElement.prototype.createElements=function(){},HCameraElement.prototype.hide=function(){},HCameraElement.prototype.renderFrame=function(){var e,t,n=this._isFirstFrame;if(this.hierarchy)for(t=this.hierarchy.length,e=0;e<t;e+=1)n=this.hierarchy[e].finalTransform.mProp._mdf||n;if(n||this.pe._mdf||this.p&&this.p._mdf||this.px&&(this.px._mdf||this.py._mdf||this.pz._mdf)||this.rx._mdf||this.ry._mdf||this.rz._mdf||this.or._mdf||this.a&&this.a._mdf){if(this.mat.reset(),this.hierarchy)for(e=t=this.hierarchy.length-1;e>=0;e-=1){var r=this.hierarchy[e].finalTransform.mProp;this.mat.translate(-r.p.v[0],-r.p.v[1],r.p.v[2]),this.mat.rotateX(-r.or.v[0]).rotateY(-r.or.v[1]).rotateZ(r.or.v[2]),this.mat.rotateX(-r.rx.v).rotateY(-r.ry.v).rotateZ(r.rz.v),this.mat.scale(1/r.s.v[0],1/r.s.v[1],1/r.s.v[2]),this.mat.translate(r.a.v[0],r.a.v[1],r.a.v[2])}if(this.p?this.mat.translate(-this.p.v[0],-this.p.v[1],this.p.v[2]):this.mat.translate(-this.px.v,-this.py.v,this.pz.v),this.a){var a;a=this.p?[this.p.v[0]-this.a.v[0],this.p.v[1]-this.a.v[1],this.p.v[2]-this.a.v[2]]:[this.px.v-this.a.v[0],this.py.v-this.a.v[1],this.pz.v-this.a.v[2]];var i=Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)),o=[a[0]/i,a[1]/i,a[2]/i],s=Math.sqrt(o[2]*o[2]+o[0]*o[0]),u=Math.atan2(o[1],s),c=Math.atan2(o[0],-o[2]);this.mat.rotateY(c).rotateX(-u)}this.mat.rotateX(-this.rx.v).rotateY(-this.ry.v).rotateZ(this.rz.v),this.mat.rotateX(-this.or.v[0]).rotateY(-this.or.v[1]).rotateZ(this.or.v[2]),this.mat.translate(this.globalData.compSize.w/2,this.globalData.compSize.h/2,0),this.mat.translate(0,0,this.pe.v);var l=!this._prevMat.equals(this.mat);if((l||this.pe._mdf)&&this.comp.threeDElements){var h,f,p;for(t=this.comp.threeDElements.length,e=0;e<t;e+=1)if("3d"===(h=this.comp.threeDElements[e]).type){if(l){var d=this.mat.toCSS();(p=h.container.style).transform=d,p.webkitTransform=d}this.pe._mdf&&((f=h.perspectiveElem.style).perspective=this.pe.v+"px",f.webkitPerspective=this.pe.v+"px")}this.mat.clone(this._prevMat)}}this._isFirstFrame=!1},HCameraElement.prototype.prepareFrame=function(e){this.prepareProperties(e,!0)},HCameraElement.prototype.destroy=function(){},HCameraElement.prototype.getBaseElement=function(){return null},extendPrototype([BaseElement,TransformElement,HBaseElement,HSolidElement,HierarchyElement,FrameElement,RenderableElement],HImageElement),HImageElement.prototype.createContent=function(){var e=this.globalData.getAssetsPath(this.assetData),t=new Image;this.data.hasMask?(this.imageElem=createNS("image"),this.imageElem.setAttribute("width",this.assetData.w+"px"),this.imageElem.setAttribute("height",this.assetData.h+"px"),this.imageElem.setAttributeNS("http://www.w3.org/1999/xlink","href",e),this.layerElement.appendChild(this.imageElem),this.baseElement.setAttribute("width",this.assetData.w),this.baseElement.setAttribute("height",this.assetData.h)):this.layerElement.appendChild(t),t.crossOrigin="anonymous",t.src=e,this.data.ln&&this.baseElement.setAttribute("id",this.data.ln)},extendPrototype([BaseRenderer],HybridRendererBase),HybridRendererBase.prototype.buildItem=SVGRenderer.prototype.buildItem,HybridRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;)this.pendingElements.pop().checkParenting()},HybridRendererBase.prototype.appendElementInPos=function(e,t){var n=e.getBaseElement();if(n){var r=this.layers[t];if(r.ddd&&this.supports3d)this.addTo3dContainer(n,t);else if(this.threeDElements)this.addTo3dContainer(n,t);else{for(var a,i,o=0;o<t;)this.elements[o]&&!0!==this.elements[o]&&this.elements[o].getBaseElement&&(i=this.elements[o],a=(this.layers[o].ddd?this.getThreeDContainerByPos(o):i.getBaseElement())||a),o+=1;a?r.ddd&&this.supports3d||this.layerElement.insertBefore(n,a):r.ddd&&this.supports3d||this.layerElement.appendChild(n)}}},HybridRendererBase.prototype.createShape=function(e){return this.supports3d?new HShapeElement(e,this.globalData,this):new SVGShapeElement(e,this.globalData,this)},HybridRendererBase.prototype.createText=function(e){return this.supports3d?new HTextElement(e,this.globalData,this):new SVGTextLottieElement(e,this.globalData,this)},HybridRendererBase.prototype.createCamera=function(e){return this.camera=new HCameraElement(e,this.globalData,this),this.camera},HybridRendererBase.prototype.createImage=function(e){return this.supports3d?new HImageElement(e,this.globalData,this):new IImageElement(e,this.globalData,this)},HybridRendererBase.prototype.createSolid=function(e){return this.supports3d?new HSolidElement(e,this.globalData,this):new ISolidElement(e,this.globalData,this)},HybridRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,HybridRendererBase.prototype.getThreeDContainerByPos=function(e){for(var t=0,n=this.threeDElements.length;t<n;){if(this.threeDElements[t].startPos<=e&&this.threeDElements[t].endPos>=e)return this.threeDElements[t].perspectiveElem;t+=1}return null},HybridRendererBase.prototype.createThreeDContainer=function(e,t){var n,r,a=createTag("div");styleDiv(a);var i=createTag("div");if(styleDiv(i),"3d"===t){(n=a.style).width=this.globalData.compSize.w+"px",n.height=this.globalData.compSize.h+"px";var o="50% 50%";n.webkitTransformOrigin=o,n.mozTransformOrigin=o,n.transformOrigin=o;var s="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";(r=i.style).transform=s,r.webkitTransform=s}a.appendChild(i);var u={container:i,perspectiveElem:a,startPos:e,endPos:e,type:t};return this.threeDElements.push(u),u},HybridRendererBase.prototype.build3dContainers=function(){var e,t,n=this.layers.length,r="";for(e=0;e<n;e+=1)this.layers[e].ddd&&3!==this.layers[e].ty?("3d"!==r&&(r="3d",t=this.createThreeDContainer(e,"3d")),t.endPos=Math.max(t.endPos,e)):("2d"!==r&&(r="2d",t=this.createThreeDContainer(e,"2d")),t.endPos=Math.max(t.endPos,e));for(e=(n=this.threeDElements.length)-1;e>=0;e-=1)this.resizerElem.appendChild(this.threeDElements[e].perspectiveElem)},HybridRendererBase.prototype.addTo3dContainer=function(e,t){for(var n=0,r=this.threeDElements.length;n<r;){if(t<=this.threeDElements[n].endPos){for(var a,i=this.threeDElements[n].startPos;i<t;)this.elements[i]&&this.elements[i].getBaseElement&&(a=this.elements[i].getBaseElement()),i+=1;a?this.threeDElements[n].container.insertBefore(e,a):this.threeDElements[n].container.appendChild(e);break}n+=1}},HybridRendererBase.prototype.configAnimation=function(e){var t=createTag("div"),n=this.animationItem.wrapper,r=t.style;r.width=e.w+"px",r.height=e.h+"px",this.resizerElem=t,styleDiv(t),r.transformStyle="flat",r.mozTransformStyle="flat",r.webkitTransformStyle="flat",this.renderConfig.className&&t.setAttribute("class",this.renderConfig.className),n.appendChild(t),r.overflow="hidden";var a=createNS("svg");a.setAttribute("width","1"),a.setAttribute("height","1"),styleDiv(a),this.resizerElem.appendChild(a);var i=createNS("defs");a.appendChild(i),this.data=e,this.setupGlobalData(e,a),this.globalData.defs=i,this.layers=e.layers,this.layerElement=this.resizerElem,this.build3dContainers(),this.updateContainerSize()},HybridRendererBase.prototype.destroy=function(){var e;this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.animationItem.container=null,this.globalData.defs=null;var t=this.layers?this.layers.length:0;for(e=0;e<t;e+=1)this.elements[e].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},HybridRendererBase.prototype.updateContainerSize=function(){var e,t,n,r,a=this.animationItem.wrapper.offsetWidth,i=this.animationItem.wrapper.offsetHeight,o=a/i;this.globalData.compSize.w/this.globalData.compSize.h>o?(e=a/this.globalData.compSize.w,t=a/this.globalData.compSize.w,n=0,r=(i-this.globalData.compSize.h*(a/this.globalData.compSize.w))/2):(e=i/this.globalData.compSize.h,t=i/this.globalData.compSize.h,n=(a-this.globalData.compSize.w*(i/this.globalData.compSize.h))/2,r=0);var s=this.resizerElem.style;s.webkitTransform="matrix3d("+e+",0,0,0,0,"+t+",0,0,0,0,1,0,"+n+","+r+",0,1)",s.transform=s.webkitTransform},HybridRendererBase.prototype.renderFrame=SVGRenderer.prototype.renderFrame,HybridRendererBase.prototype.hide=function(){this.resizerElem.style.display="none"},HybridRendererBase.prototype.show=function(){this.resizerElem.style.display="block"},HybridRendererBase.prototype.initItems=function(){if(this.buildAllItems(),this.camera)this.camera.setup();else{var e,t=this.globalData.compSize.w,n=this.globalData.compSize.h,r=this.threeDElements.length;for(e=0;e<r;e+=1){var a=this.threeDElements[e].perspectiveElem.style;a.webkitPerspective=Math.sqrt(Math.pow(t,2)+Math.pow(n,2))+"px",a.perspective=a.webkitPerspective}}},HybridRendererBase.prototype.searchExtraCompositions=function(e){var t,n=e.length,r=createTag("div");for(t=0;t<n;t+=1)if(e[t].xt){var a=this.createComp(e[t],r,this.globalData.comp,null);a.initExpressions(),this.globalData.projectInterface.registerComposition(a)}},extendPrototype([HybridRendererBase,ICompElement,HBaseElement],HCompElement),HCompElement.prototype._createBaseContainerElements=HCompElement.prototype.createContainerElements,HCompElement.prototype.createContainerElements=function(){this._createBaseContainerElements(),this.data.hasMask?(this.svgElement.setAttribute("width",this.data.w),this.svgElement.setAttribute("height",this.data.h),this.transformedElement=this.baseElement):this.transformedElement=this.layerElement},HCompElement.prototype.addTo3dContainer=function(e,t){for(var n,r=0;r<t;)this.elements[r]&&this.elements[r].getBaseElement&&(n=this.elements[r].getBaseElement()),r+=1;n?this.layerElement.insertBefore(e,n):this.layerElement.appendChild(e)},HCompElement.prototype.createComp=function(e){return this.supports3d?new HCompElement(e,this.globalData,this):new SVGCompElement(e,this.globalData,this)},extendPrototype([HybridRendererBase],HybridRenderer),HybridRenderer.prototype.createComp=function(e){return this.supports3d?new HCompElement(e,this.globalData,this):new SVGCompElement(e,this.globalData,this)};var Expressions=function(){var e={initExpressions:function(e){var t=0,n=[];e.renderer.compInterface=CompExpressionInterface(e.renderer),e.renderer.globalData.projectInterface.registerComposition(e.renderer),e.renderer.globalData.pushExpression=function(){t+=1},e.renderer.globalData.popExpression=function(){0===(t-=1)&&function(){var e,t=n.length;for(e=0;e<t;e+=1)n[e].release();n.length=0}()},e.renderer.globalData.registerExpressionProperty=function(e){-1===n.indexOf(e)&&n.push(e)}}};return e}();function _typeof$1(e){return _typeof$1="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof$1(e)}function seedRandom(e,t){var n=this,r=256,a=t.pow(r,6),i=t.pow(2,52),o=2*i,s=255;function u(e){var t,n=e.length,a=this,i=0,o=a.i=a.j=0,u=a.S=[];for(n||(e=[n++]);i<r;)u[i]=i++;for(i=0;i<r;i++)u[i]=u[o=s&o+e[i%n]+(t=u[i])],u[o]=t;a.g=function(e){for(var t,n=0,i=a.i,o=a.j,u=a.S;e--;)t=u[i=s&i+1],n=n*r+u[s&(u[i]=u[o=s&o+t])+(u[o]=t)];return a.i=i,a.j=o,n}}function c(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function l(e,t){var n,r=[],a=_typeof$1(e);if(t&&"object"==a)for(n in e)try{r.push(l(e[n],t-1))}catch(i){}return r.length?r:"string"==a?e:e+"\0"}function h(e,t){for(var n,r=e+"",a=0;a<r.length;)t[s&a]=s&(n^=19*t[s&a])+r.charCodeAt(a++);return f(t)}function f(e){return String.fromCharCode.apply(0,e)}t.seedrandom=function(s,p,d){var m=[],v=h(l((p=!0===p?{entropy:!0}:p||{}).entropy?[s,f(e)]:null===s?function(){try{var t=new Uint8Array(r);return(n.crypto||n.msCrypto).getRandomValues(t),f(t)}catch(o){var a=n.navigator,i=a&&a.plugins;return[+new Date,n,i,n.screen,f(e)]}}():s,3),m),g=new u(m),y=function(){for(var e=g.g(6),t=a,n=0;e<i;)e=(e+n)*r,t*=r,n=g.g(1);for(;e>=o;)e/=2,t/=2,n>>>=1;return(e+n)/t};return y.int32=function(){return 0|g.g(4)},y.quick=function(){return g.g(4)/4294967296},y.double=y,h(f(g.S),e),(p.pass||d||function(e,n,r,a){return a&&(a.S&&c(a,g),e.state=function(){return c(g,{})}),r?(t.random=e,n):e})(y,v,"global"in p?p.global:this==t,p.state)},h(t.random(),e)}function initialize$2(e){seedRandom([],e)}var propTypes={SHAPE:"shape"};function _typeof(e){return _typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}var ExpressionManager=function(){var ob={},Math=BMMath,window=null,document=null,XMLHttpRequest=null,fetch=null,frames=null;function $bm_isInstanceOfArray(e){return e.constructor===Array||e.constructor===Float32Array}function isNumerable(e,t){return"number"===e||"boolean"===e||"string"===e||t instanceof Number}function $bm_neg(e){var t=_typeof(e);if("number"===t||"boolean"===t||e instanceof Number)return-e;if($bm_isInstanceOfArray(e)){var n,r=e.length,a=[];for(n=0;n<r;n+=1)a[n]=-e[n];return a}return e.propType?e.v:-e}initialize$2(BMMath);var easeInBez=BezierFactory.getBezierEasing(.333,0,.833,.833,"easeIn").get,easeOutBez=BezierFactory.getBezierEasing(.167,.167,.667,1,"easeOut").get,easeInOutBez=BezierFactory.getBezierEasing(.33,0,.667,1,"easeInOut").get;function sum(e,t){var n=_typeof(e),r=_typeof(t);if("string"===n||"string"===r)return e+t;if(isNumerable(n,e)&&isNumerable(r,t))return e+t;if($bm_isInstanceOfArray(e)&&isNumerable(r,t))return(e=e.slice(0))[0]+=t,e;if(isNumerable(n,e)&&$bm_isInstanceOfArray(t))return(t=t.slice(0))[0]=e+t[0],t;if($bm_isInstanceOfArray(e)&&$bm_isInstanceOfArray(t)){for(var a=0,i=e.length,o=t.length,s=[];a<i||a<o;)("number"===typeof e[a]||e[a]instanceof Number)&&("number"===typeof t[a]||t[a]instanceof Number)?s[a]=e[a]+t[a]:s[a]=void 0===t[a]?e[a]:e[a]||t[a],a+=1;return s}return 0}var add=sum;function sub(e,t){var n=_typeof(e),r=_typeof(t);if(isNumerable(n,e)&&isNumerable(r,t))return"string"===n&&(e=parseInt(e,10)),"string"===r&&(t=parseInt(t,10)),e-t;if($bm_isInstanceOfArray(e)&&isNumerable(r,t))return(e=e.slice(0))[0]-=t,e;if(isNumerable(n,e)&&$bm_isInstanceOfArray(t))return(t=t.slice(0))[0]=e-t[0],t;if($bm_isInstanceOfArray(e)&&$bm_isInstanceOfArray(t)){for(var a=0,i=e.length,o=t.length,s=[];a<i||a<o;)("number"===typeof e[a]||e[a]instanceof Number)&&("number"===typeof t[a]||t[a]instanceof Number)?s[a]=e[a]-t[a]:s[a]=void 0===t[a]?e[a]:e[a]||t[a],a+=1;return s}return 0}function mul(e,t){var n,r,a,i=_typeof(e),o=_typeof(t);if(isNumerable(i,e)&&isNumerable(o,t))return e*t;if($bm_isInstanceOfArray(e)&&isNumerable(o,t)){for(a=e.length,n=createTypedArray("float32",a),r=0;r<a;r+=1)n[r]=e[r]*t;return n}if(isNumerable(i,e)&&$bm_isInstanceOfArray(t)){for(a=t.length,n=createTypedArray("float32",a),r=0;r<a;r+=1)n[r]=e*t[r];return n}return 0}function div(e,t){var n,r,a,i=_typeof(e),o=_typeof(t);if(isNumerable(i,e)&&isNumerable(o,t))return e/t;if($bm_isInstanceOfArray(e)&&isNumerable(o,t)){for(a=e.length,n=createTypedArray("float32",a),r=0;r<a;r+=1)n[r]=e[r]/t;return n}if(isNumerable(i,e)&&$bm_isInstanceOfArray(t)){for(a=t.length,n=createTypedArray("float32",a),r=0;r<a;r+=1)n[r]=e/t[r];return n}return 0}function mod(e,t){return"string"===typeof e&&(e=parseInt(e,10)),"string"===typeof t&&(t=parseInt(t,10)),e%t}var $bm_sum=sum,$bm_sub=sub,$bm_mul=mul,$bm_div=div,$bm_mod=mod;function clamp(e,t,n){if(t>n){var r=n;n=t,t=r}return Math.min(Math.max(e,t),n)}function radiansToDegrees(e){return e/degToRads}var radians_to_degrees=radiansToDegrees;function degreesToRadians(e){return e*degToRads}var degrees_to_radians=radiansToDegrees,helperLengthArray=[0,0,0,0,0,0];function length(e,t){if("number"===typeof e||e instanceof Number)return t=t||0,Math.abs(e-t);var n;t||(t=helperLengthArray);var r=Math.min(e.length,t.length),a=0;for(n=0;n<r;n+=1)a+=Math.pow(t[n]-e[n],2);return Math.sqrt(a)}function normalize(e){return div(e,length(e))}function rgbToHsl(e){var t,n,r=e[0],a=e[1],i=e[2],o=Math.max(r,a,i),s=Math.min(r,a,i),u=(o+s)/2;if(o===s)t=0,n=0;else{var c=o-s;switch(n=u>.5?c/(2-o-s):c/(o+s),o){case r:t=(a-i)/c+(a<i?6:0);break;case a:t=(i-r)/c+2;break;case i:t=(r-a)/c+4}t/=6}return[t,n,u,e[3]]}function hue2rgb(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function hslToRgb(e){var t,n,r,a=e[0],i=e[1],o=e[2];if(0===i)t=o,r=o,n=o;else{var s=o<.5?o*(1+i):o+i-o*i,u=2*o-s;t=hue2rgb(u,s,a+1/3),n=hue2rgb(u,s,a),r=hue2rgb(u,s,a-1/3)}return[t,n,r,e[3]]}function linear(e,t,n,r,a){if(void 0!==r&&void 0!==a||(r=t,a=n,t=0,n=1),n<t){var i=n;n=t,t=i}if(e<=t)return r;if(e>=n)return a;var o,s=n===t?0:(e-t)/(n-t);if(!r.length)return r+(a-r)*s;var u=r.length,c=createTypedArray("float32",u);for(o=0;o<u;o+=1)c[o]=r[o]+(a[o]-r[o])*s;return c}function random(e,t){if(void 0===t&&(void 0===e?(e=0,t=1):(t=e,e=void 0)),t.length){var n,r=t.length;e||(e=createTypedArray("float32",r));var a=createTypedArray("float32",r),i=BMMath.random();for(n=0;n<r;n+=1)a[n]=e[n]+i*(t[n]-e[n]);return a}return void 0===e&&(e=0),e+BMMath.random()*(t-e)}function createPath(e,t,n,r){var a,i=e.length,o=shapePool.newElement();o.setPathData(!!r,i);var s,u,c=[0,0];for(a=0;a<i;a+=1)s=t&&t[a]?t[a]:c,u=n&&n[a]?n[a]:c,o.setTripleAt(e[a][0],e[a][1],u[0]+e[a][0],u[1]+e[a][1],s[0]+e[a][0],s[1]+e[a][1],a,!0);return o}function initiateExpression(elem,data,property){var val=data.x,needsVelocity=/velocity(?![\w\d])/.test(val),_needsRandom=-1!==val.indexOf("random"),elemType=elem.data.ty,transform,$bm_transform,content,effect,thisProperty=property;thisProperty.valueAtTime=thisProperty.getValueAtTime,Object.defineProperty(thisProperty,"value",{get:function(){return thisProperty.v}}),elem.comp.frameDuration=1/elem.comp.globalData.frameRate,elem.comp.displayStartTime=0;var inPoint=elem.data.ip/elem.comp.globalData.frameRate,outPoint=elem.data.op/elem.comp.globalData.frameRate,width=elem.data.sw?elem.data.sw:0,height=elem.data.sh?elem.data.sh:0,name=elem.data.nm,loopIn,loop_in,loopOut,loop_out,smooth,toWorld,fromWorld,fromComp,toComp,fromCompToSurface,position,rotation,anchorPoint,scale,thisLayer,thisComp,mask,valueAtTime,velocityAtTime,scoped_bm_rt,expression_function=eval("[function _expression_function(){"+val+";scoped_bm_rt=$bm_rt}]")[0],numKeys=property.kf?data.k.length:0,active=!this.data||!0!==this.data.hd,wiggle=function(e,t){var n,r,a=this.pv.length?this.pv.length:1,i=createTypedArray("float32",a),o=Math.floor(5*time);for(n=0,r=0;n<o;){for(r=0;r<a;r+=1)i[r]+=-t+2*t*BMMath.random();n+=1}var s=5*time,u=s-Math.floor(s),c=createTypedArray("float32",a);if(a>1){for(r=0;r<a;r+=1)c[r]=this.pv[r]+i[r]+(-t+2*t*BMMath.random())*u;return c}return this.pv+i[0]+(-t+2*t*BMMath.random())*u}.bind(this);function loopInDuration(e,t){return loopIn(e,t,!0)}function loopOutDuration(e,t){return loopOut(e,t,!0)}thisProperty.loopIn&&(loopIn=thisProperty.loopIn.bind(thisProperty),loop_in=loopIn),thisProperty.loopOut&&(loopOut=thisProperty.loopOut.bind(thisProperty),loop_out=loopOut),thisProperty.smooth&&(smooth=thisProperty.smooth.bind(thisProperty)),this.getValueAtTime&&(valueAtTime=this.getValueAtTime.bind(this)),this.getVelocityAtTime&&(velocityAtTime=this.getVelocityAtTime.bind(this));var comp=elem.comp.globalData.projectInterface.bind(elem.comp.globalData.projectInterface),time,velocity,value,text,textIndex,textTotal,selectorValue;function lookAt(e,t){var n=[t[0]-e[0],t[1]-e[1],t[2]-e[2]],r=Math.atan2(n[0],Math.sqrt(n[1]*n[1]+n[2]*n[2]))/degToRads;return[-Math.atan2(n[1],n[2])/degToRads,r,0]}function easeOut(e,t,n,r,a){return applyEase(easeOutBez,e,t,n,r,a)}function easeIn(e,t,n,r,a){return applyEase(easeInBez,e,t,n,r,a)}function ease(e,t,n,r,a){return applyEase(easeInOutBez,e,t,n,r,a)}function applyEase(e,t,n,r,a,i){void 0===a?(a=n,i=r):t=(t-n)/(r-n),t>1?t=1:t<0&&(t=0);var o=e(t);if($bm_isInstanceOfArray(a)){var s,u=a.length,c=createTypedArray("float32",u);for(s=0;s<u;s+=1)c[s]=(i[s]-a[s])*o+a[s];return c}return(i-a)*o+a}function nearestKey(e){var t,n,r,a=data.k.length;if(data.k.length&&"number"!==typeof data.k[0])if(n=-1,(e*=elem.comp.globalData.frameRate)<data.k[0].t)n=1,r=data.k[0].t;else{for(t=0;t<a-1;t+=1){if(e===data.k[t].t){n=t+1,r=data.k[t].t;break}if(e>data.k[t].t&&e<data.k[t+1].t){e-data.k[t].t>data.k[t+1].t-e?(n=t+2,r=data.k[t+1].t):(n=t+1,r=data.k[t].t);break}}-1===n&&(n=t+1,r=data.k[t].t)}else n=0,r=0;var i={};return i.index=n,i.time=r/elem.comp.globalData.frameRate,i}function key(e){var t,n,r;if(!data.k.length||"number"===typeof data.k[0])throw new Error("The property has no keyframe at index "+e);e-=1,t={time:data.k[e].t/elem.comp.globalData.frameRate,value:[]};var a=Object.prototype.hasOwnProperty.call(data.k[e],"s")?data.k[e].s:data.k[e-1].e;for(r=a.length,n=0;n<r;n+=1)t[n]=a[n],t.value[n]=a[n];return t}function framesToTime(e,t){return t||(t=elem.comp.globalData.frameRate),e/t}function timeToFrames(e,t){return e||0===e||(e=time),t||(t=elem.comp.globalData.frameRate),e*t}function seedRandom(e){BMMath.seedrandom(randSeed+e)}function sourceRectAtTime(){return elem.sourceRectAtTime()}function substring(e,t){return"string"===typeof value?void 0===t?value.substring(e):value.substring(e,t):""}function substr(e,t){return"string"===typeof value?void 0===t?value.substr(e):value.substr(e,t):""}function posterizeTime(e){time=0===e?0:Math.floor(time*e)/e,value=valueAtTime(time)}var index=elem.data.ind,hasParent=!(!elem.hierarchy||!elem.hierarchy.length),parent,randSeed=Math.floor(1e6*Math.random()),globalData=elem.globalData;function executeExpression(e){return value=e,this.frameExpressionId===elem.globalData.frameId&&"textSelector"!==this.propType?value:("textSelector"===this.propType&&(textIndex=this.textIndex,textTotal=this.textTotal,selectorValue=this.selectorValue),thisLayer||(text=elem.layerInterface.text,thisLayer=elem.layerInterface,thisComp=elem.comp.compInterface,toWorld=thisLayer.toWorld.bind(thisLayer),fromWorld=thisLayer.fromWorld.bind(thisLayer),fromComp=thisLayer.fromComp.bind(thisLayer),toComp=thisLayer.toComp.bind(thisLayer),mask=thisLayer.mask?thisLayer.mask.bind(thisLayer):null,fromCompToSurface=fromComp),transform||(transform=elem.layerInterface("ADBE Transform Group"),$bm_transform=transform,transform&&(anchorPoint=transform.anchorPoint)),4!==elemType||content||(content=thisLayer("ADBE Root Vectors Group")),effect||(effect=thisLayer(4)),(hasParent=!(!elem.hierarchy||!elem.hierarchy.length))&&!parent&&(parent=elem.hierarchy[0].layerInterface),time=this.comp.renderedFrame/this.comp.globalData.frameRate,_needsRandom&&seedRandom(randSeed+time),needsVelocity&&(velocity=velocityAtTime(time)),expression_function(),this.frameExpressionId=elem.globalData.frameId,scoped_bm_rt=scoped_bm_rt.propType===propTypes.SHAPE?scoped_bm_rt.v:scoped_bm_rt)}return executeExpression.__preventDeadCodeRemoval=[$bm_transform,anchorPoint,time,velocity,inPoint,outPoint,width,height,name,loop_in,loop_out,smooth,toComp,fromCompToSurface,toWorld,fromWorld,mask,position,rotation,scale,thisComp,numKeys,active,wiggle,loopInDuration,loopOutDuration,comp,lookAt,easeOut,easeIn,ease,nearestKey,key,text,textIndex,textTotal,selectorValue,framesToTime,timeToFrames,sourceRectAtTime,substring,substr,posterizeTime,index,globalData],executeExpression}return ob.initiateExpression=initiateExpression,ob.__preventDeadCodeRemoval=[window,document,XMLHttpRequest,fetch,frames,$bm_neg,add,$bm_sum,$bm_sub,$bm_mul,$bm_div,$bm_mod,clamp,radians_to_degrees,degreesToRadians,degrees_to_radians,normalize,rgbToHsl,hslToRgb,linear,random,createPath],ob}(),expressionHelpers={searchExpressions:function(e,t,n){t.x&&(n.k=!0,n.x=!0,n.initiateExpression=ExpressionManager.initiateExpression,n.effectsSequence.push(n.initiateExpression(e,t,n).bind(n)))},getSpeedAtTime:function(e){var t=this.getValueAtTime(e),n=this.getValueAtTime(e+-.01),r=0;if(t.length){var a;for(a=0;a<t.length;a+=1)r+=Math.pow(n[a]-t[a],2);r=100*Math.sqrt(r)}else r=0;return r},getVelocityAtTime:function(e){if(void 0!==this.vel)return this.vel;var t,n,r=-.001,a=this.getValueAtTime(e),i=this.getValueAtTime(e+r);if(a.length)for(t=createTypedArray("float32",a.length),n=0;n<a.length;n+=1)t[n]=(i[n]-a[n])/r;else t=(i-a)/r;return t},getValueAtTime:function(e){return e*=this.elem.globalData.frameRate,(e-=this.offsetTime)!==this._cachingAtTime.lastFrame&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastFrame<e?this._cachingAtTime.lastIndex:0,this._cachingAtTime.value=this.interpolateValue(e,this._cachingAtTime),this._cachingAtTime.lastFrame=e),this._cachingAtTime.value},getStaticValueAtTime:function(){return this.pv},setGroupProperty:function(e){this.propertyGroup=e}};function addPropertyDecorator(){function e(e,t,n){if(!this.k||!this.keyframes)return this.pv;e=e?e.toLowerCase():"";var r,a,i,o,s,u=this.comp.renderedFrame,c=this.keyframes,l=c[c.length-1].t;if(u<=l)return this.pv;if(n?a=l-(r=t?Math.abs(l-this.elem.comp.globalData.frameRate*t):Math.max(0,l-this.elem.data.ip)):((!t||t>c.length-1)&&(t=c.length-1),r=l-(a=c[c.length-1-t].t)),"pingpong"===e){if(Math.floor((u-a)/r)%2!==0)return this.getValueAtTime((r-(u-a)%r+a)/this.comp.globalData.frameRate,0)}else{if("offset"===e){var h=this.getValueAtTime(a/this.comp.globalData.frameRate,0),f=this.getValueAtTime(l/this.comp.globalData.frameRate,0),p=this.getValueAtTime(((u-a)%r+a)/this.comp.globalData.frameRate,0),d=Math.floor((u-a)/r);if(this.pv.length){for(o=(s=new Array(h.length)).length,i=0;i<o;i+=1)s[i]=(f[i]-h[i])*d+p[i];return s}return(f-h)*d+p}if("continue"===e){var m=this.getValueAtTime(l/this.comp.globalData.frameRate,0),v=this.getValueAtTime((l-.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(o=(s=new Array(m.length)).length,i=0;i<o;i+=1)s[i]=m[i]+(m[i]-v[i])*((u-l)/this.comp.globalData.frameRate)/5e-4;return s}return m+(u-l)/.001*(m-v)}}return this.getValueAtTime(((u-a)%r+a)/this.comp.globalData.frameRate,0)}function t(e,t,n){if(!this.k)return this.pv;e=e?e.toLowerCase():"";var r,a,i,o,s,u=this.comp.renderedFrame,c=this.keyframes,l=c[0].t;if(u>=l)return this.pv;if(n?a=l+(r=t?Math.abs(this.elem.comp.globalData.frameRate*t):Math.max(0,this.elem.data.op-l)):((!t||t>c.length-1)&&(t=c.length-1),r=(a=c[t].t)-l),"pingpong"===e){if(Math.floor((l-u)/r)%2===0)return this.getValueAtTime(((l-u)%r+l)/this.comp.globalData.frameRate,0)}else{if("offset"===e){var h=this.getValueAtTime(l/this.comp.globalData.frameRate,0),f=this.getValueAtTime(a/this.comp.globalData.frameRate,0),p=this.getValueAtTime((r-(l-u)%r+l)/this.comp.globalData.frameRate,0),d=Math.floor((l-u)/r)+1;if(this.pv.length){for(o=(s=new Array(h.length)).length,i=0;i<o;i+=1)s[i]=p[i]-(f[i]-h[i])*d;return s}return p-(f-h)*d}if("continue"===e){var m=this.getValueAtTime(l/this.comp.globalData.frameRate,0),v=this.getValueAtTime((l+.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(o=(s=new Array(m.length)).length,i=0;i<o;i+=1)s[i]=m[i]+(m[i]-v[i])*(l-u)/.001;return s}return m+(m-v)*(l-u)/.001}}return this.getValueAtTime((r-((l-u)%r+l))/this.comp.globalData.frameRate,0)}function n(e,t){if(!this.k)return this.pv;if(e=.5*(e||.4),(t=Math.floor(t||5))<=1)return this.pv;var n,r,a=this.comp.renderedFrame/this.comp.globalData.frameRate,i=a-e,o=t>1?(a+e-i)/(t-1):1,s=0,u=0;for(n=this.pv.length?createTypedArray("float32",this.pv.length):0;s<t;){if(r=this.getValueAtTime(i+s*o),this.pv.length)for(u=0;u<this.pv.length;u+=1)n[u]+=r[u];else n+=r;s+=1}if(this.pv.length)for(u=0;u<this.pv.length;u+=1)n[u]/=t;else n/=t;return n}function r(e){this._transformCachingAtTime||(this._transformCachingAtTime={v:new Matrix});var t=this._transformCachingAtTime.v;if(t.cloneFromProps(this.pre.props),this.appliedTransformations<1){var n=this.a.getValueAtTime(e);t.translate(-n[0]*this.a.mult,-n[1]*this.a.mult,n[2]*this.a.mult)}if(this.appliedTransformations<2){var r=this.s.getValueAtTime(e);t.scale(r[0]*this.s.mult,r[1]*this.s.mult,r[2]*this.s.mult)}if(this.sk&&this.appliedTransformations<3){var a=this.sk.getValueAtTime(e),i=this.sa.getValueAtTime(e);t.skewFromAxis(-a*this.sk.mult,i*this.sa.mult)}if(this.r&&this.appliedTransformations<4){var o=this.r.getValueAtTime(e);t.rotate(-o*this.r.mult)}else if(!this.r&&this.appliedTransformations<4){var s=this.rz.getValueAtTime(e),u=this.ry.getValueAtTime(e),c=this.rx.getValueAtTime(e),l=this.or.getValueAtTime(e);t.rotateZ(-s*this.rz.mult).rotateY(u*this.ry.mult).rotateX(c*this.rx.mult).rotateZ(-l[2]*this.or.mult).rotateY(l[1]*this.or.mult).rotateX(l[0]*this.or.mult)}if(this.data.p&&this.data.p.s){var h=this.px.getValueAtTime(e),f=this.py.getValueAtTime(e);if(this.data.p.z){var p=this.pz.getValueAtTime(e);t.translate(h*this.px.mult,f*this.py.mult,-p*this.pz.mult)}else t.translate(h*this.px.mult,f*this.py.mult,0)}else{var d=this.p.getValueAtTime(e);t.translate(d[0]*this.p.mult,d[1]*this.p.mult,-d[2]*this.p.mult)}return t}function a(){return this.v.clone(new Matrix)}var i=TransformPropertyFactory.getTransformProperty;TransformPropertyFactory.getTransformProperty=function(e,t,n){var o=i(e,t,n);return o.dynamicProperties.length?o.getValueAtTime=r.bind(o):o.getValueAtTime=a.bind(o),o.setGroupProperty=expressionHelpers.setGroupProperty,o};var o=PropertyFactory.getProp;PropertyFactory.getProp=function(r,a,i,s,u){var c=o(r,a,i,s,u);c.kf?c.getValueAtTime=expressionHelpers.getValueAtTime.bind(c):c.getValueAtTime=expressionHelpers.getStaticValueAtTime.bind(c),c.setGroupProperty=expressionHelpers.setGroupProperty,c.loopOut=e,c.loopIn=t,c.smooth=n,c.getVelocityAtTime=expressionHelpers.getVelocityAtTime.bind(c),c.getSpeedAtTime=expressionHelpers.getSpeedAtTime.bind(c),c.numKeys=1===a.a?a.k.length:0,c.propertyIndex=a.ix;var l=0;return 0!==i&&(l=createTypedArray("float32",1===a.a?a.k[0].s.length:a.k.length)),c._cachingAtTime={lastFrame:initialDefaultFrame,lastIndex:0,value:l},expressionHelpers.searchExpressions(r,a,c),c.k&&u.addDynamicProperty(c),c};var s=ShapePropertyFactory.getConstructorFunction(),u=ShapePropertyFactory.getKeyframedConstructorFunction();function c(){}c.prototype={vertices:function(e,t){this.k&&this.getValue();var n,r=this.v;void 0!==t&&(r=this.getValueAtTime(t,0));var a=r._length,i=r[e],o=r.v,s=createSizedArray(a);for(n=0;n<a;n+=1)s[n]="i"===e||"o"===e?[i[n][0]-o[n][0],i[n][1]-o[n][1]]:[i[n][0],i[n][1]];return s},points:function(e){return this.vertices("v",e)},inTangents:function(e){return this.vertices("i",e)},outTangents:function(e){return this.vertices("o",e)},isClosed:function(){return this.v.c},pointOnPath:function(e,t){var n=this.v;void 0!==t&&(n=this.getValueAtTime(t,0)),this._segmentsLength||(this._segmentsLength=bez.getSegmentsLength(n));for(var r,a=this._segmentsLength,i=a.lengths,o=a.totalLength*e,s=0,u=i.length,c=0;s<u;){if(c+i[s].addedLength>o){var l=s,h=n.c&&s===u-1?0:s+1,f=(o-c)/i[s].addedLength;r=bez.getPointInSegment(n.v[l],n.v[h],n.o[l],n.i[h],f,i[s]);break}c+=i[s].addedLength,s+=1}return r||(r=n.c?[n.v[0][0],n.v[0][1]]:[n.v[n._length-1][0],n.v[n._length-1][1]]),r},vectorOnPath:function(e,t,n){1==e?e=this.v.c:0==e&&(e=.999);var r=this.pointOnPath(e,t),a=this.pointOnPath(e+.001,t),i=a[0]-r[0],o=a[1]-r[1],s=Math.sqrt(Math.pow(i,2)+Math.pow(o,2));return 0===s?[0,0]:"tangent"===n?[i/s,o/s]:[-o/s,i/s]},tangentOnPath:function(e,t){return this.vectorOnPath(e,t,"tangent")},normalOnPath:function(e,t){return this.vectorOnPath(e,t,"normal")},setGroupProperty:expressionHelpers.setGroupProperty,getValueAtTime:expressionHelpers.getStaticValueAtTime},extendPrototype([c],s),extendPrototype([c],u),u.prototype.getValueAtTime=function(e){return this._cachingAtTime||(this._cachingAtTime={shapeValue:shapePool.clone(this.pv),lastIndex:0,lastTime:initialDefaultFrame}),e*=this.elem.globalData.frameRate,(e-=this.offsetTime)!==this._cachingAtTime.lastTime&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastTime<e?this._caching.lastIndex:0,this._cachingAtTime.lastTime=e,this.interpolateShape(e,this._cachingAtTime.shapeValue,this._cachingAtTime)),this._cachingAtTime.shapeValue},u.prototype.initiateExpression=ExpressionManager.initiateExpression;var l=ShapePropertyFactory.getShapeProp;ShapePropertyFactory.getShapeProp=function(e,t,n,r,a){var i=l(e,t,n,r,a);return i.propertyIndex=t.ix,i.lock=!1,3===n?expressionHelpers.searchExpressions(e,t.pt,i):4===n&&expressionHelpers.searchExpressions(e,t.ks,i),i.k&&e.addDynamicProperty(i),i}}function initialize$1(){addPropertyDecorator()}function addDecorator(){TextProperty.prototype.getExpressionValue=function(e,t){var n=this.calculateExpression(t);if(e.t!==n){var r={};return this.copyData(r,e),r.t=n.toString(),r.__complete=!1,r}return e},TextProperty.prototype.searchProperty=function(){var e=this.searchKeyframes(),t=this.searchExpressions();return this.kf=e||t,this.kf},TextProperty.prototype.searchExpressions=function(){return this.data.d.x?(this.calculateExpression=ExpressionManager.initiateExpression.bind(this)(this.elem,this.data.d,this),this.addEffect(this.getExpressionValue.bind(this)),!0):null}}function initialize(){addDecorator()}function SVGComposableEffect(){}function SVGTintFilter(e,t,n,r,a){this.filterManager=t;var i=createNS("feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("color-interpolation-filters","linearRGB"),i.setAttribute("values","0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),i.setAttribute("result",r+"_tint_1"),e.appendChild(i),(i=createNS("feColorMatrix")).setAttribute("type","matrix"),i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),i.setAttribute("result",r+"_tint_2"),e.appendChild(i),this.matrixFilter=i;var o=this.createMergeNode(r,[a,r+"_tint_1",r+"_tint_2"]);e.appendChild(o)}function SVGFillFilter(e,t,n,r){this.filterManager=t;var a=createNS("feColorMatrix");a.setAttribute("type","matrix"),a.setAttribute("color-interpolation-filters","sRGB"),a.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),a.setAttribute("result",r),e.appendChild(a),this.matrixFilter=a}function SVGStrokeEffect(e,t,n){this.initialized=!1,this.filterManager=t,this.elem=n,this.paths=[]}function SVGTritoneFilter(e,t,n,r){this.filterManager=t;var a=createNS("feColorMatrix");a.setAttribute("type","matrix"),a.setAttribute("color-interpolation-filters","linearRGB"),a.setAttribute("values","0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),e.appendChild(a);var i=createNS("feComponentTransfer");i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("result",r),this.matrixFilter=i;var o=createNS("feFuncR");o.setAttribute("type","table"),i.appendChild(o),this.feFuncR=o;var s=createNS("feFuncG");s.setAttribute("type","table"),i.appendChild(s),this.feFuncG=s;var u=createNS("feFuncB");u.setAttribute("type","table"),i.appendChild(u),this.feFuncB=u,e.appendChild(i)}function SVGProLevelsFilter(e,t,n,r){this.filterManager=t;var a=this.filterManager.effectElements,i=createNS("feComponentTransfer");(a[10].p.k||0!==a[10].p.v||a[11].p.k||1!==a[11].p.v||a[12].p.k||1!==a[12].p.v||a[13].p.k||0!==a[13].p.v||a[14].p.k||1!==a[14].p.v)&&(this.feFuncR=this.createFeFunc("feFuncR",i)),(a[17].p.k||0!==a[17].p.v||a[18].p.k||1!==a[18].p.v||a[19].p.k||1!==a[19].p.v||a[20].p.k||0!==a[20].p.v||a[21].p.k||1!==a[21].p.v)&&(this.feFuncG=this.createFeFunc("feFuncG",i)),(a[24].p.k||0!==a[24].p.v||a[25].p.k||1!==a[25].p.v||a[26].p.k||1!==a[26].p.v||a[27].p.k||0!==a[27].p.v||a[28].p.k||1!==a[28].p.v)&&(this.feFuncB=this.createFeFunc("feFuncB",i)),(a[31].p.k||0!==a[31].p.v||a[32].p.k||1!==a[32].p.v||a[33].p.k||1!==a[33].p.v||a[34].p.k||0!==a[34].p.v||a[35].p.k||1!==a[35].p.v)&&(this.feFuncA=this.createFeFunc("feFuncA",i)),(this.feFuncR||this.feFuncG||this.feFuncB||this.feFuncA)&&(i.setAttribute("color-interpolation-filters","sRGB"),e.appendChild(i)),(a[3].p.k||0!==a[3].p.v||a[4].p.k||1!==a[4].p.v||a[5].p.k||1!==a[5].p.v||a[6].p.k||0!==a[6].p.v||a[7].p.k||1!==a[7].p.v)&&((i=createNS("feComponentTransfer")).setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("result",r),e.appendChild(i),this.feFuncRComposed=this.createFeFunc("feFuncR",i),this.feFuncGComposed=this.createFeFunc("feFuncG",i),this.feFuncBComposed=this.createFeFunc("feFuncB",i))}function SVGDropShadowEffect(e,t,n,r,a){var i=t.container.globalData.renderConfig.filterSize;e.setAttribute("x",i.x),e.setAttribute("y",i.y),e.setAttribute("width",i.width),e.setAttribute("height",i.height),this.filterManager=t;var o=createNS("feGaussianBlur");o.setAttribute("in","SourceAlpha"),o.setAttribute("result",r+"_drop_shadow_1"),o.setAttribute("stdDeviation","0"),this.feGaussianBlur=o,e.appendChild(o);var s=createNS("feOffset");s.setAttribute("dx","25"),s.setAttribute("dy","0"),s.setAttribute("in",r+"_drop_shadow_1"),s.setAttribute("result",r+"_drop_shadow_2"),this.feOffset=s,e.appendChild(s);var u=createNS("feFlood");u.setAttribute("flood-color","#00ff00"),u.setAttribute("flood-opacity","1"),u.setAttribute("result",r+"_drop_shadow_3"),this.feFlood=u,e.appendChild(u);var c=createNS("feComposite");c.setAttribute("in",r+"_drop_shadow_3"),c.setAttribute("in2",r+"_drop_shadow_2"),c.setAttribute("operator","in"),c.setAttribute("result",r+"_drop_shadow_4"),e.appendChild(c);var l=this.createMergeNode(r,[r+"_drop_shadow_4",a]);e.appendChild(l)}SVGComposableEffect.prototype={createMergeNode:function(e,t){var n,r,a=createNS("feMerge");for(a.setAttribute("result",e),r=0;r<t.length;r+=1)(n=createNS("feMergeNode")).setAttribute("in",t[r]),a.appendChild(n),a.appendChild(n);return a}},extendPrototype([SVGComposableEffect],SVGTintFilter),SVGTintFilter.prototype.renderFrame=function(e){if(e||this.filterManager._mdf){var t=this.filterManager.effectElements[0].p.v,n=this.filterManager.effectElements[1].p.v,r=this.filterManager.effectElements[2].p.v/100;this.matrixFilter.setAttribute("values",n[0]-t[0]+" 0 0 0 "+t[0]+" "+(n[1]-t[1])+" 0 0 0 "+t[1]+" "+(n[2]-t[2])+" 0 0 0 "+t[2]+" 0 0 0 "+r+" 0")}},SVGFillFilter.prototype.renderFrame=function(e){if(e||this.filterManager._mdf){var t=this.filterManager.effectElements[2].p.v,n=this.filterManager.effectElements[6].p.v;this.matrixFilter.setAttribute("values","0 0 0 0 "+t[0]+" 0 0 0 0 "+t[1]+" 0 0 0 0 "+t[2]+" 0 0 0 "+n+" 0")}},SVGStrokeEffect.prototype.initialize=function(){var e,t,n,r,a=this.elem.layerElement.children||this.elem.layerElement.childNodes;for(1===this.filterManager.effectElements[1].p.v?(r=this.elem.maskManager.masksProperties.length,n=0):r=1+(n=this.filterManager.effectElements[0].p.v-1),(t=createNS("g")).setAttribute("fill","none"),t.setAttribute("stroke-linecap","round"),t.setAttribute("stroke-dashoffset",1);n<r;n+=1)e=createNS("path"),t.appendChild(e),this.paths.push({p:e,m:n});if(3===this.filterManager.effectElements[10].p.v){var i=createNS("mask"),o=createElementID();i.setAttribute("id",o),i.setAttribute("mask-type","alpha"),i.appendChild(t),this.elem.globalData.defs.appendChild(i);var s=createNS("g");for(s.setAttribute("mask","url("+getLocationHref()+"#"+o+")");a[0];)s.appendChild(a[0]);this.elem.layerElement.appendChild(s),this.masker=i,t.setAttribute("stroke","#fff")}else if(1===this.filterManager.effectElements[10].p.v||2===this.filterManager.effectElements[10].p.v){if(2===this.filterManager.effectElements[10].p.v)for(a=this.elem.layerElement.children||this.elem.layerElement.childNodes;a.length;)this.elem.layerElement.removeChild(a[0]);this.elem.layerElement.appendChild(t),this.elem.layerElement.removeAttribute("mask"),t.setAttribute("stroke","#fff")}this.initialized=!0,this.pathMasker=t},SVGStrokeEffect.prototype.renderFrame=function(e){var t;this.initialized||this.initialize();var n,r,a=this.paths.length;for(t=0;t<a;t+=1)if(-1!==this.paths[t].m&&(n=this.elem.maskManager.viewData[this.paths[t].m],r=this.paths[t].p,(e||this.filterManager._mdf||n.prop._mdf)&&r.setAttribute("d",n.lastPath),e||this.filterManager.effectElements[9].p._mdf||this.filterManager.effectElements[4].p._mdf||this.filterManager.effectElements[7].p._mdf||this.filterManager.effectElements[8].p._mdf||n.prop._mdf)){var i;if(0!==this.filterManager.effectElements[7].p.v||100!==this.filterManager.effectElements[8].p.v){var o=.01*Math.min(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v),s=.01*Math.max(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v),u=r.getTotalLength();i="0 0 0 "+u*o+" ";var c,l=u*(s-o),h=1+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v*.01,f=Math.floor(l/h);for(c=0;c<f;c+=1)i+="1 "+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v*.01+" ";i+="0 "+10*u+" 0 0"}else i="1 "+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v*.01;r.setAttribute("stroke-dasharray",i)}if((e||this.filterManager.effectElements[4].p._mdf)&&this.pathMasker.setAttribute("stroke-width",2*this.filterManager.effectElements[4].p.v),(e||this.filterManager.effectElements[6].p._mdf)&&this.pathMasker.setAttribute("opacity",this.filterManager.effectElements[6].p.v),(1===this.filterManager.effectElements[10].p.v||2===this.filterManager.effectElements[10].p.v)&&(e||this.filterManager.effectElements[3].p._mdf)){var p=this.filterManager.effectElements[3].p.v;this.pathMasker.setAttribute("stroke","rgb("+bmFloor(255*p[0])+","+bmFloor(255*p[1])+","+bmFloor(255*p[2])+")")}},SVGTritoneFilter.prototype.renderFrame=function(e){if(e||this.filterManager._mdf){var t=this.filterManager.effectElements[0].p.v,n=this.filterManager.effectElements[1].p.v,r=this.filterManager.effectElements[2].p.v,a=r[0]+" "+n[0]+" "+t[0],i=r[1]+" "+n[1]+" "+t[1],o=r[2]+" "+n[2]+" "+t[2];this.feFuncR.setAttribute("tableValues",a),this.feFuncG.setAttribute("tableValues",i),this.feFuncB.setAttribute("tableValues",o)}},SVGProLevelsFilter.prototype.createFeFunc=function(e,t){var n=createNS(e);return n.setAttribute("type","table"),t.appendChild(n),n},SVGProLevelsFilter.prototype.getTableValue=function(e,t,n,r,a){for(var i,o,s=0,u=Math.min(e,t),c=Math.max(e,t),l=Array.call(null,{length:256}),h=0,f=a-r,p=t-e;s<=256;)o=(i=s/256)<=u?p<0?a:r:i>=c?p<0?r:a:r+f*Math.pow((i-e)/p,1/n),l[h]=o,h+=1,s+=256/255;return l.join(" ")},SVGProLevelsFilter.prototype.renderFrame=function(e){if(e||this.filterManager._mdf){var t,n=this.filterManager.effectElements;this.feFuncRComposed&&(e||n[3].p._mdf||n[4].p._mdf||n[5].p._mdf||n[6].p._mdf||n[7].p._mdf)&&(t=this.getTableValue(n[3].p.v,n[4].p.v,n[5].p.v,n[6].p.v,n[7].p.v),this.feFuncRComposed.setAttribute("tableValues",t),this.feFuncGComposed.setAttribute("tableValues",t),this.feFuncBComposed.setAttribute("tableValues",t)),this.feFuncR&&(e||n[10].p._mdf||n[11].p._mdf||n[12].p._mdf||n[13].p._mdf||n[14].p._mdf)&&(t=this.getTableValue(n[10].p.v,n[11].p.v,n[12].p.v,n[13].p.v,n[14].p.v),this.feFuncR.setAttribute("tableValues",t)),this.feFuncG&&(e||n[17].p._mdf||n[18].p._mdf||n[19].p._mdf||n[20].p._mdf||n[21].p._mdf)&&(t=this.getTableValue(n[17].p.v,n[18].p.v,n[19].p.v,n[20].p.v,n[21].p.v),this.feFuncG.setAttribute("tableValues",t)),this.feFuncB&&(e||n[24].p._mdf||n[25].p._mdf||n[26].p._mdf||n[27].p._mdf||n[28].p._mdf)&&(t=this.getTableValue(n[24].p.v,n[25].p.v,n[26].p.v,n[27].p.v,n[28].p.v),this.feFuncB.setAttribute("tableValues",t)),this.feFuncA&&(e||n[31].p._mdf||n[32].p._mdf||n[33].p._mdf||n[34].p._mdf||n[35].p._mdf)&&(t=this.getTableValue(n[31].p.v,n[32].p.v,n[33].p.v,n[34].p.v,n[35].p.v),this.feFuncA.setAttribute("tableValues",t))}},extendPrototype([SVGComposableEffect],SVGDropShadowEffect),SVGDropShadowEffect.prototype.renderFrame=function(e){if(e||this.filterManager._mdf){if((e||this.filterManager.effectElements[4].p._mdf)&&this.feGaussianBlur.setAttribute("stdDeviation",this.filterManager.effectElements[4].p.v/4),e||this.filterManager.effectElements[0].p._mdf){var t=this.filterManager.effectElements[0].p.v;this.feFlood.setAttribute("flood-color",rgbToHex(Math.round(255*t[0]),Math.round(255*t[1]),Math.round(255*t[2])))}if((e||this.filterManager.effectElements[1].p._mdf)&&this.feFlood.setAttribute("flood-opacity",this.filterManager.effectElements[1].p.v/255),e||this.filterManager.effectElements[2].p._mdf||this.filterManager.effectElements[3].p._mdf){var n=this.filterManager.effectElements[3].p.v,r=(this.filterManager.effectElements[2].p.v-90)*degToRads,a=n*Math.cos(r),i=n*Math.sin(r);this.feOffset.setAttribute("dx",a),this.feOffset.setAttribute("dy",i)}}};var _svgMatteSymbols=[];function SVGMatte3Effect(e,t,n){this.initialized=!1,this.filterManager=t,this.filterElem=e,this.elem=n,n.matteElement=createNS("g"),n.matteElement.appendChild(n.layerElement),n.matteElement.appendChild(n.transformedElement),n.baseElement=n.matteElement}function SVGGaussianBlurEffect(e,t,n,r){e.setAttribute("x","-100%"),e.setAttribute("y","-100%"),e.setAttribute("width","300%"),e.setAttribute("height","300%"),this.filterManager=t;var a=createNS("feGaussianBlur");a.setAttribute("result",r),e.appendChild(a),this.feGaussianBlur=a}return SVGMatte3Effect.prototype.findSymbol=function(e){for(var t=0,n=_svgMatteSymbols.length;t<n;){if(_svgMatteSymbols[t]===e)return _svgMatteSymbols[t];t+=1}return null},SVGMatte3Effect.prototype.replaceInParent=function(e,t){var n=e.layerElement.parentNode;if(n){for(var r,a=n.children,i=0,o=a.length;i<o&&a[i]!==e.layerElement;)i+=1;i<=o-2&&(r=a[i+1]);var s=createNS("use");s.setAttribute("href","#"+t),r?n.insertBefore(s,r):n.appendChild(s)}},SVGMatte3Effect.prototype.setElementAsMask=function(e,t){if(!this.findSymbol(t)){var n=createElementID(),r=createNS("mask");r.setAttribute("id",t.layerId),r.setAttribute("mask-type","alpha"),_svgMatteSymbols.push(t);var a=e.globalData.defs;a.appendChild(r);var i=createNS("symbol");i.setAttribute("id",n),this.replaceInParent(t,n),i.appendChild(t.layerElement),a.appendChild(i);var o=createNS("use");o.setAttribute("href","#"+n),r.appendChild(o),t.data.hd=!1,t.show()}e.setMatte(t.layerId)},SVGMatte3Effect.prototype.initialize=function(){for(var e=this.filterManager.effectElements[0].p.v,t=this.elem.comp.elements,n=0,r=t.length;n<r;)t[n]&&t[n].data.ind===e&&this.setElementAsMask(this.elem,t[n]),n+=1;this.initialized=!0},SVGMatte3Effect.prototype.renderFrame=function(){this.initialized||this.initialize()},SVGGaussianBlurEffect.prototype.renderFrame=function(e){if(e||this.filterManager._mdf){var t=.3*this.filterManager.effectElements[0].p.v,n=this.filterManager.effectElements[1].p.v,r=3==n?0:t,a=2==n?0:t;this.feGaussianBlur.setAttribute("stdDeviation",r+" "+a);var i=1==this.filterManager.effectElements[2].p.v?"wrap":"duplicate";this.feGaussianBlur.setAttribute("edgeMode",i)}},registerRenderer("canvas",CanvasRenderer),registerRenderer("html",HybridRenderer),registerRenderer("svg",SVGRenderer),ShapeModifiers.registerModifier("tm",TrimModifier),ShapeModifiers.registerModifier("pb",PuckerAndBloatModifier),ShapeModifiers.registerModifier("rp",RepeaterModifier),ShapeModifiers.registerModifier("rd",RoundCornersModifier),setExpressionsPlugin(Expressions),initialize$1(),initialize(),registerEffect(20,SVGTintFilter,!0),registerEffect(21,SVGFillFilter,!0),registerEffect(22,SVGStrokeEffect,!1),registerEffect(23,SVGTritoneFilter,!0),registerEffect(24,SVGProLevelsFilter,!0),registerEffect(25,SVGDropShadowEffect,!0),registerEffect(28,SVGMatte3Effect,!1),registerEffect(29,SVGGaussianBlurEffect,!0),lottie},module.exports=factory())},8191:function(e,t,n){t.parseMidi=n(3169),t.writeMidi=n(9695)},3169:function(e){function t(e){for(var t,r=new n(e),a=[];!r.eof();){var i=o();a.push(i)}return a;function o(){var e={};e.deltaTime=r.readVarInt();var n=r.readUInt8();if(240===(240&n)){if(255!==n){if(240==n){e.type="sysEx";i=r.readVarInt();return e.data=r.readBytes(i),e}if(247==n){e.type="endSysEx";i=r.readVarInt();return e.data=r.readBytes(i),e}throw"Unrecognised MIDI event type byte: "+n}e.meta=!0;var a=r.readUInt8(),i=r.readVarInt();switch(a){case 0:if(e.type="sequenceNumber",2!==i)throw"Expected length for sequenceNumber event is 2, got "+i;return e.number=r.readUInt16(),e;case 1:return e.type="text",e.text=r.readString(i),e;case 2:return e.type="copyrightNotice",e.text=r.readString(i),e;case 3:return e.type="trackName",e.text=r.readString(i),e;case 4:return e.type="instrumentName",e.text=r.readString(i),e;case 5:return e.type="lyrics",e.text=r.readString(i),e;case 6:return e.type="marker",e.text=r.readString(i),e;case 7:return e.type="cuePoint",e.text=r.readString(i),e;case 32:if(e.type="channelPrefix",1!=i)throw"Expected length for channelPrefix event is 1, got "+i;return e.channel=r.readUInt8(),e;case 33:if(e.type="portPrefix",1!=i)throw"Expected length for portPrefix event is 1, got "+i;return e.port=r.readUInt8(),e;case 47:if(e.type="endOfTrack",0!=i)throw"Expected length for endOfTrack event is 0, got "+i;return e;case 81:if(e.type="setTempo",3!=i)throw"Expected length for setTempo event is 3, got "+i;return e.microsecondsPerBeat=r.readUInt24(),e;case 84:if(e.type="smpteOffset",5!=i)throw"Expected length for smpteOffset event is 5, got "+i;var o=r.readUInt8();return e.frameRate={0:24,32:25,64:29,96:30}[96&o],e.hour=31&o,e.min=r.readUInt8(),e.sec=r.readUInt8(),e.frame=r.readUInt8(),e.subFrame=r.readUInt8(),e;case 88:if(e.type="timeSignature",2!=i&&4!=i)throw"Expected length for timeSignature event is 4 or 2, got "+i;return e.numerator=r.readUInt8(),e.denominator=1<<r.readUInt8(),4===i?(e.metronome=r.readUInt8(),e.thirtyseconds=r.readUInt8()):(e.metronome=36,e.thirtyseconds=8),e;case 89:if(e.type="keySignature",2!=i)throw"Expected length for keySignature event is 2, got "+i;return e.key=r.readInt8(),e.scale=r.readUInt8(),e;case 127:return e.type="sequencerSpecific",e.data=r.readBytes(i),e;default:return e.type="unknownMeta",e.data=r.readBytes(i),e.metatypeByte=a,e}}else{var s;if(0===(128&n)){if(null===t)throw"Running status byte encountered before status byte";s=n,n=t,e.running=!0}else s=r.readUInt8(),t=n;var u=n>>4;switch(e.channel=15&n,u){case 8:return e.type="noteOff",e.noteNumber=s,e.velocity=r.readUInt8(),e;case 9:var c=r.readUInt8();return e.type=0===c?"noteOff":"noteOn",e.noteNumber=s,e.velocity=c,0===c&&(e.byte9=!0),e;case 10:return e.type="noteAftertouch",e.noteNumber=s,e.amount=r.readUInt8(),e;case 11:return e.type="controller",e.controllerType=s,e.value=r.readUInt8(),e;case 12:return e.type="programChange",e.programNumber=s,e;case 13:return e.type="channelAftertouch",e.amount=s,e;case 14:return e.type="pitchBend",e.value=s+(r.readUInt8()<<7)-8192,e;default:throw"Unrecognised MIDI event type: "+u}}}}function n(e){this.buffer=e,this.bufferLen=this.buffer.length,this.pos=0}n.prototype.eof=function(){return this.pos>=this.bufferLen},n.prototype.readUInt8=function(){var e=this.buffer[this.pos];return this.pos+=1,e},n.prototype.readInt8=function(){var e=this.readUInt8();return 128&e?e-256:e},n.prototype.readUInt16=function(){return(this.readUInt8()<<8)+this.readUInt8()},n.prototype.readInt16=function(){var e=this.readUInt16();return 32768&e?e-65536:e},n.prototype.readUInt24=function(){return(this.readUInt8()<<16)+(this.readUInt8()<<8)+this.readUInt8()},n.prototype.readInt24=function(){var e=this.readUInt24();return 8388608&e?e-16777216:e},n.prototype.readUInt32=function(){return(this.readUInt8()<<24)+(this.readUInt8()<<16)+(this.readUInt8()<<8)+this.readUInt8()},n.prototype.readBytes=function(e){var t=this.buffer.slice(this.pos,this.pos+e);return this.pos+=e,t},n.prototype.readString=function(e){var t=this.readBytes(e);return String.fromCharCode.apply(null,t)},n.prototype.readVarInt=function(){for(var e=0;!this.eof();){var t=this.readUInt8();if(!(128&t))return e+t;e+=127&t,e<<=7}return e},n.prototype.readChunk=function(){var e=this.readString(4),t=this.readUInt32();return{id:e,length:t,data:this.readBytes(t)}},e.exports=function(e){var r=new n(e),a=r.readChunk();if("MThd"!=a.id)throw"Bad MIDI file.  Expected 'MHdr', got: '"+a.id+"'";for(var i=function(e){var t=new n(e),r=t.readUInt16(),a=t.readUInt16(),i={format:r,numTracks:a},o=t.readUInt16();32768&o?(i.framesPerSecond=256-(o>>8),i.ticksPerFrame=255&o):i.ticksPerBeat=o;return i}(a.data),o=[],s=0;!r.eof()&&s<i.numTracks;s++){var u=r.readChunk();if("MTrk"!=u.id)throw"Bad MIDI file.  Expected 'MTrk', got: '"+u.id+"'";var c=t(u.data);o.push(c)}return{header:i,tracks:o}}},9695:function(e){function t(e,t,a){var i,o=new r,s=t.length,u=null;for(i=0;i<s;i++)!1!==a.running&&(a.running||t[i].running)||(u=null),u=n(o,t[i],u,a.useByte9ForNoteOff);e.writeChunk("MTrk",o.buffer)}function n(e,t,n,r){var a=t.type,i=t.deltaTime,o=t.text||"",s=t.data||[],u=null;switch(e.writeVarInt(i),a){case"sequenceNumber":e.writeUInt8(255),e.writeUInt8(0),e.writeVarInt(2),e.writeUInt16(t.number);break;case"text":e.writeUInt8(255),e.writeUInt8(1),e.writeVarInt(o.length),e.writeString(o);break;case"copyrightNotice":e.writeUInt8(255),e.writeUInt8(2),e.writeVarInt(o.length),e.writeString(o);break;case"trackName":e.writeUInt8(255),e.writeUInt8(3),e.writeVarInt(o.length),e.writeString(o);break;case"instrumentName":e.writeUInt8(255),e.writeUInt8(4),e.writeVarInt(o.length),e.writeString(o);break;case"lyrics":e.writeUInt8(255),e.writeUInt8(5),e.writeVarInt(o.length),e.writeString(o);break;case"marker":e.writeUInt8(255),e.writeUInt8(6),e.writeVarInt(o.length),e.writeString(o);break;case"cuePoint":e.writeUInt8(255),e.writeUInt8(7),e.writeVarInt(o.length),e.writeString(o);break;case"channelPrefix":e.writeUInt8(255),e.writeUInt8(32),e.writeVarInt(1),e.writeUInt8(t.channel);break;case"portPrefix":e.writeUInt8(255),e.writeUInt8(33),e.writeVarInt(1),e.writeUInt8(t.port);break;case"endOfTrack":e.writeUInt8(255),e.writeUInt8(47),e.writeVarInt(0);break;case"setTempo":e.writeUInt8(255),e.writeUInt8(81),e.writeVarInt(3),e.writeUInt24(t.microsecondsPerBeat);break;case"smpteOffset":e.writeUInt8(255),e.writeUInt8(84),e.writeVarInt(5);var c=31&t.hour|{24:0,25:32,29:64,30:96}[t.frameRate];e.writeUInt8(c),e.writeUInt8(t.min),e.writeUInt8(t.sec),e.writeUInt8(t.frame),e.writeUInt8(t.subFrame);break;case"timeSignature":e.writeUInt8(255),e.writeUInt8(88),e.writeVarInt(4),e.writeUInt8(t.numerator);var l=255&Math.floor(Math.log(t.denominator)/Math.LN2);e.writeUInt8(l),e.writeUInt8(t.metronome),e.writeUInt8(t.thirtyseconds||8);break;case"keySignature":e.writeUInt8(255),e.writeUInt8(89),e.writeVarInt(2),e.writeInt8(t.key),e.writeUInt8(t.scale);break;case"sequencerSpecific":e.writeUInt8(255),e.writeUInt8(127),e.writeVarInt(s.length),e.writeBytes(s);break;case"unknownMeta":null!=t.metatypeByte&&(e.writeUInt8(255),e.writeUInt8(t.metatypeByte),e.writeVarInt(s.length),e.writeBytes(s));break;case"sysEx":e.writeUInt8(240),e.writeVarInt(s.length),e.writeBytes(s);break;case"endSysEx":e.writeUInt8(247),e.writeVarInt(s.length),e.writeBytes(s);break;case"noteOff":(u=(!1!==r&&t.byte9||r&&0==t.velocity?144:128)|t.channel)!==n&&e.writeUInt8(u),e.writeUInt8(t.noteNumber),e.writeUInt8(t.velocity);break;case"noteOn":(u=144|t.channel)!==n&&e.writeUInt8(u),e.writeUInt8(t.noteNumber),e.writeUInt8(t.velocity);break;case"noteAftertouch":(u=160|t.channel)!==n&&e.writeUInt8(u),e.writeUInt8(t.noteNumber),e.writeUInt8(t.amount);break;case"controller":(u=176|t.channel)!==n&&e.writeUInt8(u),e.writeUInt8(t.controllerType),e.writeUInt8(t.value);break;case"programChange":(u=192|t.channel)!==n&&e.writeUInt8(u),e.writeUInt8(t.programNumber);break;case"channelAftertouch":(u=208|t.channel)!==n&&e.writeUInt8(u),e.writeUInt8(t.amount);break;case"pitchBend":(u=224|t.channel)!==n&&e.writeUInt8(u);var h=8192+t.value,f=127&h,p=h>>7&127;e.writeUInt8(f),e.writeUInt8(p);break;default:throw"Unrecognized event type: "+a}return u}function r(){this.buffer=[]}r.prototype.writeUInt8=function(e){this.buffer.push(255&e)},r.prototype.writeInt8=r.prototype.writeUInt8,r.prototype.writeUInt16=function(e){var t=e>>8&255,n=255&e;this.writeUInt8(t),this.writeUInt8(n)},r.prototype.writeInt16=r.prototype.writeUInt16,r.prototype.writeUInt24=function(e){var t=e>>16&255,n=e>>8&255,r=255&e;this.writeUInt8(t),this.writeUInt8(n),this.writeUInt8(r)},r.prototype.writeInt24=r.prototype.writeUInt24,r.prototype.writeUInt32=function(e){var t=e>>24&255,n=e>>16&255,r=e>>8&255,a=255&e;this.writeUInt8(t),this.writeUInt8(n),this.writeUInt8(r),this.writeUInt8(a)},r.prototype.writeInt32=r.prototype.writeUInt32,r.prototype.writeBytes=function(e){this.buffer=this.buffer.concat(Array.prototype.slice.call(e,0))},r.prototype.writeString=function(e){var t,n=e.length,r=[];for(t=0;t<n;t++)r.push(e.codePointAt(t));this.writeBytes(r)},r.prototype.writeVarInt=function(e){if(e<0)throw"Cannot write negative variable-length integer";if(e<=127)this.writeUInt8(e);else{var t=e,n=[];for(n.push(127&t),t>>=7;t;){var r=127&t|128;n.push(r),t>>=7}this.writeBytes(n.reverse())}},r.prototype.writeChunk=function(e,t){this.writeString(e),this.writeUInt32(t.length),this.writeBytes(t)},e.exports=function(e,n){if("object"!==typeof e)throw"Invalid MIDI data";n=n||{};var a,i=e.header||{},o=e.tracks||[],s=o.length,u=new r;for(function(e,t,n){var a=null==t.format?1:t.format,i=128;t.timeDivision?i=t.timeDivision:t.ticksPerFrame&&t.framesPerSecond?i=-(255&t.framesPerSecond)<<8|255&t.ticksPerFrame:t.ticksPerBeat&&(i=32767&t.ticksPerBeat);var o=new r;o.writeUInt16(a),o.writeUInt16(n),o.writeUInt16(i),e.writeChunk("MThd",o.buffer)}(u,i,s),a=0;a<s;a++)t(u,o[a],n);return u.buffer}},2446:function(e,t,n){"use strict";var r=n(6519),a=n(8383),i=n(4008),o=n(4068);e.exports=function(e,t,n){var s,u,c=t.shape,l=c.length,h=1,f=new Array(l),p=0;for(s=l-1;s>=0;--s)if(f[s]=h,h*=c[s],p=Math.max(p,o.scratchMemory(c[s])),t.shape[s]!==n.shape[s])throw new Error("Shape mismatch, real and imaginary arrays must have same size");var d,m=4*h+p;d="array"===t.dtype||"float64"===t.dtype||"custom"===t.dtype?i.mallocDouble(m):i.mallocFloat(m);var v,g,y,b,k=a(d,c.slice(0),f,0),x=a(d,c.slice(0),f.slice(0),h),w=a(d,c.slice(0),f.slice(0),2*h),_=a(d,c.slice(0),f.slice(0),3*h),S=4*h;for(r.assign(k,t),r.assign(x,n),s=l-1;s>=0&&(o(e,h/c[s],c[s],d,k.offset,x.offset,S),0!==s);--s){for(g=1,y=w.stride,b=_.stride,u=s-1;u<l;++u)b[u]=y[u]=g,g*=c[u];for(u=s-2;u>=0;--u)b[u]=y[u]=g,g*=c[u];r.assign(w,k),r.assign(_,x),v=k,k=w,w=v,v=x,x=_,_=v}r.assign(t,k),r.assign(n,x),i.free(d)}},4068:function(e,t,n){var r=n(5844);function a(e,t,n,a,i,o){var s,u,c,l,h,f,p,d,m,v,g,y,b,k,x,w,_,S,C,T,E,I,A,N;for(e|=0,t|=0,i|=0,o|=0,s=n|=0,u=r.log2(s),S=0;S<t;++S){for(p=s>>1,h=0,c=0;c<s-1;c++){for(c<h&&(b=a[i+c],a[i+c]=a[i+h],a[i+h]=b,b=a[o+c],a[o+c]=a[o+h],a[o+h]=b),f=p;f<=h;)h-=f,f>>=1;h+=f}for(g=-1,y=0,v=1,d=0;d<u;d++){for(m=v,v<<=1,w=1,_=0,h=0;h<m;h++){for(c=h;c<s;c+=v)C=a[i+(l=c+m)],T=a[o+l],E=a[i+c],I=a[o+c],k=(A=w*(C+T))-T*(w+_),x=A+(N=C*(_-w)),a[i+l]=E-k,a[o+l]=I-x,a[i+c]+=k,a[o+c]+=x;N=w*(y-g),w=(A=g*(w+_))-_*(g+y),_=A+N}y=Math.sqrt((1-g)/2),e<0&&(y=-y),g=Math.sqrt((1+g)/2)}if(e<0){var P=1/s;for(c=0;c<s;c++)a[i+c]*=P,a[o+c]*=P}i+=n,o+=n}}e.exports=function(e,t,n,i,o,s,u){e|=0,t|=0,n|=0,o|=0,s|=0,r.isPow2(n)?a(e,t,n,i,o,s):function(e,t,n,i,o,s,u){e|=0,t|=0,n|=0,o|=0,s|=0,u|=0;var c,l,h,f,p,d,m,v,g,y=r.nextPow2(2*n+1),b=u,k=b+n,x=k+n,w=x+y,_=w+y,S=_+y,C=-e*Math.PI/n;for(g=0;g<n;++g)l=C*(g*g%(2*n)),f=Math.cos(l),p=Math.sin(l),i[_+(y-g)]=i[_+g]=i[b+g]=f,i[S+(y-g)]=i[S+g]=i[k+g]=p;for(g=n;g<=y-n;++g)i[_+g]=0;for(g=n;g<=y-n;++g)i[S+g]=0;a(1,1,y,i,_,S),C=e<0?1/n:1;for(c=0;c<t;++c){for(g=0;g<n;++g)l=i[o+g],h=i[s+g],d=(f=i[b+g])*(l+h),m=l*((p=-i[k+g])-f),v=h*(f+p),i[x+g]=d-v,i[w+g]=d+m;for(g=n;g<y;++g)i[x+g]=0;for(g=n;g<y;++g)i[w+g]=0;for(a(1,1,y,i,x,w),g=0;g<y;++g)l=i[x+g],h=i[w+g],d=(f=i[_+g])*(l+h),m=l*((p=i[S+g])-f),v=h*(f+p),i[x+g]=d-v,i[w+g]=d+m;for(a(-1,1,y,i,x,w),g=0;g<n;++g)l=i[x+g],h=i[w+g],d=(f=i[b+g])*(l+h),m=l*((p=-i[k+g])-f),v=h*(f+p),i[o+g]=C*(d-v),i[s+g]=C*(d+m);o+=n,s+=n}}(e,t,n,i,o,s,u)},e.exports.scratchMemory=function(e){return r.isPow2(e)?0:2*e+4*r.nextPow2(2*e+1)}},6519:function(e,t,n){"use strict";var r=n(7549),a={body:"",args:[],thisVars:[],localVars:[]};function i(e){if(!e)return a;for(var t=0;t<e.args.length;++t){var n=e.args[t];e.args[t]=0===t?{name:n,lvalue:!0,rvalue:!!e.rvalue,count:e.count||1}:{name:n,lvalue:!1,rvalue:!0,count:1}}return e.thisVars||(e.thisVars=[]),e.localVars||(e.localVars=[]),e}function o(e){for(var t=[],n=0;n<e.args.length;++n)t.push("a"+n);return new Function("P",["return function ",e.funcName,"_ndarrayops(",t.join(","),") {P(",t.join(","),");return a0}"].join(""))(function(e){return r({args:e.args,pre:i(e.pre),body:i(e.body),post:i(e.proc),funcName:e.funcName})}(e))}var s={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var e in s){var n=s[e];t[e]=o({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+n+"c"},funcName:e}),t[e+"eq"]=o({args:["array","array"],body:{args:["a","b"],body:"a"+n+"=b"},rvalue:!0,funcName:e+"eq"}),t[e+"s"]=o({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+n+"s"},funcName:e+"s"}),t[e+"seq"]=o({args:["array","scalar"],body:{args:["a","s"],body:"a"+n+"=s"},rvalue:!0,funcName:e+"seq"})}}();var u={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var e in u){var n=u[e];t[e]=o({args:["array","array"],body:{args:["a","b"],body:"a="+n+"b"},funcName:e}),t[e+"eq"]=o({args:["array"],body:{args:["a"],body:"a="+n+"a"},rvalue:!0,count:2,funcName:e+"eq"})}}();var c={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var e in c){var n=c[e];t[e]=o({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+n+"c"},funcName:e}),t[e+"s"]=o({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+n+"s"},funcName:e+"s"}),t[e+"eq"]=o({args:["array","array"],body:{args:["a","b"],body:"a=a"+n+"b"},rvalue:!0,count:2,funcName:e+"eq"}),t[e+"seq"]=o({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+n+"s"},rvalue:!0,count:2,funcName:e+"seq"})}}();var l=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var e=0;e<l.length;++e){var n=l[e];t[n]=o({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:n}),t[n+"eq"]=o({args:["array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"eq"})}}();var h=["max","min","atan2","pow"];!function(){for(var e=0;e<h.length;++e){var n=h[e];t[n]=o({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:n}),t[n+"s"]=o({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:n+"s"}),t[n+"eq"]=o({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"eq"}),t[n+"seq"]=o({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"seq"})}}();var f=["atan2","pow"];!function(){for(var e=0;e<f.length;++e){var n=f[e];t[n+"op"]=o({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:n+"op"}),t[n+"ops"]=o({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:n+"ops"}),t[n+"opeq"]=o({args:["array","array"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"opeq"}),t[n+"opseq"]=o({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+n,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:n+"opseq"})}}(),t.any=r({args:["array"],pre:a,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),t.all=r({args:["array"],pre:a,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),t.sum=r({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),t.prod=r({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),t.norm2squared=r({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),t.norm2=r({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),t.norminf=r({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),t.norm1=r({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),t.sup=r({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),t.inf=r({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),t.argmin=r({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),t.argmax=r({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),t.random=o({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),t.assign=o({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),t.assigns=o({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),t.equals=r({args:["array","array"],pre:a,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},6800:function(e,t,n){"use strict";var r=n(2446),a=n(7217),i=n(6519),o=n(3675)({args:["array","array","scalar","scalar","scalar"],body:function(e,t,n,r,a){var i=t*n;i<r&&(i=r),i>a&&(i=a)}});e.exports=function(e,t,n,s){"undefined"===typeof n&&(n=-1/0),"undefined"===typeof s&&(s=1/0);var u=t.shape,c=e.shape;if(t.shape.length!==e.shape.length)throw new Error("ndarray-resample: input and output arrays should have the same dimensions");var l,h=u.map((function(){return 0}));if(1===e.size)return(l=i.sum(t)/t.size)<n&&(l=n),l>s&&(l=s),void e.set.apply(e,h.concat(l));if(1===t.size)return(l=t.get.apply(t,h))<n&&(l=n),l>s&&(l=s),void i.assigns(e,l);for(var f=u.length,p=new Array(f),d=!1,m=0;m<f;m++)p[m]=Math.min(c[m],u[m]),c[m]>u[m]&&(d=!0);var v=a.malloc(u),g=a.malloc(u);i.assign(v,t),i.assigns(g,0),r(1,v,g);var y=v.lo,b=v.hi,k=a.malloc(c),x=a.malloc(c);d&&(i.assigns(k,0),i.assigns(x,0));var w=new Array(f),_=new Array(f),S=new Array(f),C=new Array(f);for(m=0;m<1<<f;++m){for(var T=0;T<f;++T)if(m&1<<T){if(w[T]=p[T]-(p[T]+1>>>1),0===w[T])continue;_[T]=c[T]-w[T],S[T]=u[T]-w[T],C[T]=1&p[T]?0:1}else w[T]=p[T]+1>>>1,_[T]=0,S[T]=0,C[T]=0;i.assign(b.apply(y.apply(k,_),w),b.apply(y.apply(v,S),w)),i.assign(y.apply(b.apply(y.apply(x,_),w),C),y.apply(b.apply(y.apply(g,S),w),C)),i.assigns(b.apply(b.apply(y.apply(x,_),w),C),0)}r(-1,k,x),o(e,k,e.size/t.size,n,s),a.free(v),a.free(g),a.free(k),a.free(x)}},7217:function(e,t,n){"use strict";var r=n(8383),a=n(6519),i=n(4008);t.clone=function(e){var t=e.dtype;"generic"!==t&&"array"!==t||(t="double");var n=i.malloc(e.size,t),o=r(n,e.shape);return a.assign(o,e),o},t.malloc=function(e,t){t||(t="double");for(var n=1,a=new Array(e.length),o=e.length-1;o>=0;--o)a[o]=n,n*=e[o];return r(i.malloc(n,t),e,a,0)},t.free=function(e){"generic"!==e.dtype&&"array"!==e.dtype&&i.free(e.data)},t.zeros=function(e,t){t||(t="double");for(var n=1,a=new Array(e.length),o=e.length-1;o>=0;--o)a[o]=n,n*=e[o];var s=i.malloc(n,t);for(o=0;o<n;++o)s[o]=0;return r(s,e,a,0)},t.ones=function(e,t){t||(t="double");for(var n=1,a=new Array(e.length),o=e.length-1;o>=0;--o)a[o]=n,n*=e[o];var s=i.malloc(n,t);for(o=0;o<n;++o)s[o]=1;return r(s,e,a,0)},t.eye=function(e,t){var n,a;t||(t="double");var o=1,s=new Array(e.length);for(n=e.length-1;n>=0;--n)s[n]=o,o*=e[n];var u=i.malloc(o,t);for(n=0;n<o;++n)u[n]=0;var c=1/0,l=0;for(n=e.length-1;n>=0;n--)l+=s[n],c=Math.min(c,e[n]);for(n=0,a=0;n<c;n++,a+=l)u[a]=1;return r(u,e,s,0)}},8383:function(e,t,n){var r=n(9897),a=n(5586),i="undefined"!==typeof Float64Array;function o(e,t){return e[0]-t[0]}function s(){var e,t=this.stride,n=new Array(t.length);for(e=0;e<n.length;++e)n[e]=[Math.abs(t[e]),e];n.sort(o);var r=new Array(n.length);for(e=0;e<r.length;++e)r[e]=n[e][1];return r}function u(e,t){var n=["View",t,"d",e].join("");t<0&&(n="View_Nil"+e);var a="generic"===e;if(-1===t){var i="function "+n+"(a){this.data=a;};var proto="+n+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+n+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+n+"(a){return new "+n+"(a);}";return new Function(i)()}if(0===t){i="function "+n+"(a,d) {this.data = a;this.offset = d};var proto="+n+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+n+"_copy() {return new "+n+"(this.data,this.offset)};proto.pick=function "+n+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+n+"_get(){return "+(a?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+n+"_set(v){return "+(a?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+n+"(a,b,c,d){return new "+n+"(a,d)}";return new Function("TrivialArray",i)(c[e][0])}i=["'use strict'"];var o=r(t),u=o.map((function(e){return"i"+e})),l="this.offset+"+o.map((function(e){return"this.stride["+e+"]*i"+e})).join("+"),h=o.map((function(e){return"b"+e})).join(","),f=o.map((function(e){return"c"+e})).join(",");i.push("function "+n+"(a,"+h+","+f+",d){this.data=a","this.shape=["+h+"]","this.stride=["+f+"]","this.offset=d|0}","var proto="+n+".prototype","proto.dtype='"+e+"'","proto.dimension="+t),i.push("Object.defineProperty(proto,'size',{get:function "+n+"_size(){return "+o.map((function(e){return"this.shape["+e+"]"})).join("*"),"}})"),1===t?i.push("proto.order=[0]"):(i.push("Object.defineProperty(proto,'order',{get:"),t<4?(i.push("function "+n+"_order(){"),2===t?i.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===t&&i.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):i.push("ORDER})")),i.push("proto.set=function "+n+"_set("+u.join(",")+",v){"),a?i.push("return this.data.set("+l+",v)}"):i.push("return this.data["+l+"]=v}"),i.push("proto.get=function "+n+"_get("+u.join(",")+"){"),a?i.push("return this.data.get("+l+")}"):i.push("return this.data["+l+"]}"),i.push("proto.index=function "+n+"_index(",u.join(),"){return "+l+"}"),i.push("proto.hi=function "+n+"_hi("+u.join(",")+"){return new "+n+"(this.data,"+o.map((function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this.shape[",e,"]:i",e,"|0"].join("")})).join(",")+","+o.map((function(e){return"this.stride["+e+"]"})).join(",")+",this.offset)}");var p=o.map((function(e){return"a"+e+"=this.shape["+e+"]"})),d=o.map((function(e){return"c"+e+"=this.stride["+e+"]"}));i.push("proto.lo=function "+n+"_lo("+u.join(",")+"){var b=this.offset,d=0,"+p.join(",")+","+d.join(","));for(var m=0;m<t;++m)i.push("if(typeof i"+m+"==='number'&&i"+m+">=0){d=i"+m+"|0;b+=c"+m+"*d;a"+m+"-=d}");i.push("return new "+n+"(this.data,"+o.map((function(e){return"a"+e})).join(",")+","+o.map((function(e){return"c"+e})).join(",")+",b)}"),i.push("proto.step=function "+n+"_step("+u.join(",")+"){var "+o.map((function(e){return"a"+e+"=this.shape["+e+"]"})).join(",")+","+o.map((function(e){return"b"+e+"=this.stride["+e+"]"})).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(m=0;m<t;++m)i.push("if(typeof i"+m+"==='number'){d=i"+m+"|0;if(d<0){c+=b"+m+"*(a"+m+"-1);a"+m+"=ceil(-a"+m+"/d)}else{a"+m+"=ceil(a"+m+"/d)}b"+m+"*=d}");i.push("return new "+n+"(this.data,"+o.map((function(e){return"a"+e})).join(",")+","+o.map((function(e){return"b"+e})).join(",")+",c)}");var v=new Array(t),g=new Array(t);for(m=0;m<t;++m)v[m]="a[i"+m+"]",g[m]="b[i"+m+"]";i.push("proto.transpose=function "+n+"_transpose("+u+"){"+u.map((function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"})).join(";"),"var a=this.shape,b=this.stride;return new "+n+"(this.data,"+v.join(",")+","+g.join(",")+",this.offset)}"),i.push("proto.pick=function "+n+"_pick("+u+"){var a=[],b=[],c=this.offset");for(m=0;m<t;++m)i.push("if(typeof i"+m+"==='number'&&i"+m+">=0){c=(c+this.stride["+m+"]*i"+m+")|0}else{a.push(this.shape["+m+"]);b.push(this.stride["+m+"])}");return i.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),i.push("return function construct_"+n+"(data,shape,stride,offset){return new "+n+"(data,"+o.map((function(e){return"shape["+e+"]"})).join(",")+","+o.map((function(e){return"stride["+e+"]"})).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",i.join("\n"))(c[e],s)}var c={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};e.exports=function(e,t,n,r){if(void 0===e)return(0,c.array[0])([]);"number"===typeof e&&(e=[e]),void 0===t&&(t=[e.length]);var o=t.length;if(void 0===n){n=new Array(o);for(var s=o-1,l=1;s>=0;--s)n[s]=l,l*=t[s]}if(void 0===r){r=0;for(s=0;s<o;++s)n[s]<0&&(r-=(t[s]-1)*n[s])}for(var h=function(e){if(a(e))return"buffer";if(i)switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(e)?"array":"generic"}(e),f=c[h];f.length<=o+1;)f.push(u(h,f.length-1));return(0,f[o+1])(e,t,n,r)}},5359:function(e,t){"use strict";var n=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n)return n;throw new Error("unable to locate global object")}();e.exports=t=n.fetch,n.fetch&&(t.default=n.fetch.bind(n)),t.Headers=n.Headers,t.Request=n.Request,t.Response=n.Response},888:function(e,t,n){"use strict";var r=n(9047);function a(){}function i(){}i.resetWarningCache=a,e.exports=function(){function e(e,t,n,a,i,o){if(o!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:a};return n.PropTypes=n,n}},2007:function(e,t,n){e.exports=n(888)()},9047:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},886:function(e,t,n){"use strict";e.exports=n(4722)},4722:function(e,t,n){"use strict";var r=t;function a(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}r.build="minimal",r.Writer=n(7063),r.BufferWriter=n(2815),r.Reader=n(6216),r.BufferReader=n(3557),r.util=n(3097),r.rpc=n(9994),r.roots=n(7907),r.configure=a,a()},6216:function(e,t,n){"use strict";e.exports=u;var r,a=n(3097),i=a.LongBits,o=a.utf8;function s(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function u(e){this.buf=e,this.pos=0,this.len=e.length}var c="undefined"!==typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new u(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new u(e);throw Error("illegal buffer")},l=function(){return a.Buffer?function(e){return(u.create=function(e){return a.Buffer.isBuffer(e)?new r(e):c(e)})(e)}:c};function h(){var e=new i(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw s(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw s(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function f(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function p(){if(this.pos+8>this.len)throw s(this,8);return new i(f(this.buf,this.pos+=4),f(this.buf,this.pos+=4))}u.create=l(),u.prototype._slice=a.Array.prototype.subarray||a.Array.prototype.slice,u.prototype.uint32=function(){var e=4294967295;return function(){if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return e;if((this.pos+=5)>this.len)throw this.pos=this.len,s(this,10);return e}}(),u.prototype.int32=function(){return 0|this.uint32()},u.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},u.prototype.bool=function(){return 0!==this.uint32()},u.prototype.fixed32=function(){if(this.pos+4>this.len)throw s(this,4);return f(this.buf,this.pos+=4)},u.prototype.sfixed32=function(){if(this.pos+4>this.len)throw s(this,4);return 0|f(this.buf,this.pos+=4)},u.prototype.float=function(){if(this.pos+4>this.len)throw s(this,4);var e=a.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},u.prototype.double=function(){if(this.pos+8>this.len)throw s(this,4);var e=a.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},u.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw s(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},u.prototype.string=function(){var e=this.bytes();return o.read(e,0,e.length)},u.prototype.skip=function(e){if("number"===typeof e){if(this.pos+e>this.len)throw s(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw s(this)}while(128&this.buf[this.pos++]);return this},u.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!==(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},u._configure=function(e){r=e,u.create=l(),r._configure();var t=a.Long?"toLong":"toNumber";a.merge(u.prototype,{int64:function(){return h.call(this)[t](!1)},uint64:function(){return h.call(this)[t](!0)},sint64:function(){return h.call(this).zzDecode()[t](!1)},fixed64:function(){return p.call(this)[t](!0)},sfixed64:function(){return p.call(this)[t](!1)}})}},3557:function(e,t,n){"use strict";e.exports=i;var r=n(6216);(i.prototype=Object.create(r.prototype)).constructor=i;var a=n(3097);function i(e){r.call(this,e)}i._configure=function(){a.Buffer&&(i.prototype._slice=a.Buffer.prototype.slice)},i.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},i._configure()},7907:function(e){"use strict";e.exports={}},9994:function(e,t,n){"use strict";t.Service=n(4281)},4281:function(e,t,n){"use strict";e.exports=a;var r=n(3097);function a(e,t,n){if("function"!==typeof e)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(a.prototype=Object.create(r.EventEmitter.prototype)).constructor=a,a.prototype.rpcCall=function e(t,n,a,i,o){if(!i)throw TypeError("request must be specified");var s=this;if(!o)return r.asPromise(e,s,t,n,a,i);if(s.rpcImpl)try{return s.rpcImpl(t,n[s.requestDelimited?"encodeDelimited":"encode"](i).finish(),(function(e,n){if(e)return s.emit("error",e,t),o(e);if(null!==n){if(!(n instanceof a))try{n=a[s.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return s.emit("error",e,t),o(e)}return s.emit("data",n,t),o(null,n)}s.end(!0)}))}catch(u){return s.emit("error",u,t),void setTimeout((function(){o(u)}),0)}else setTimeout((function(){o(Error("already ended"))}),0)},a.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},9351:function(e,t,n){"use strict";e.exports=a;var r=n(3097);function a(e,t){this.lo=e>>>0,this.hi=t>>>0}var i=a.zero=new a(0,0);i.toNumber=function(){return 0},i.zzEncode=i.zzDecode=function(){return this},i.length=function(){return 1};var o=a.zeroHash="\0\0\0\0\0\0\0\0";a.fromNumber=function(e){if(0===e)return i;var t=e<0;t&&(e=-e);var n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new a(n,r)},a.from=function(e){if("number"===typeof e)return a.fromNumber(e);if(r.isString(e)){if(!r.Long)return a.fromNumber(parseInt(e,10));e=r.Long.fromString(e)}return e.low||e.high?new a(e.low>>>0,e.high>>>0):i},a.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},a.prototype.toLong=function(e){return r.Long?new r.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var s=String.prototype.charCodeAt;a.fromHash=function(e){return e===o?i:new a((s.call(e,0)|s.call(e,1)<<8|s.call(e,2)<<16|s.call(e,3)<<24)>>>0,(s.call(e,4)|s.call(e,5)<<8|s.call(e,6)<<16|s.call(e,7)<<24)>>>0)},a.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},a.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},a.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},a.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},3097:function(e,t,n){"use strict";var r=t;function a(e,t,n){for(var r=Object.keys(t),a=0;a<r.length;++a)void 0!==e[r[a]]&&n||(e[r[a]]=t[r[a]]);return e}function i(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&a(this,n)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}r.asPromise=n(7206),r.base64=n(1),r.EventEmitter=n(7111),r.float=n(802),r.inquire=n(7172),r.utf8=n(3861),r.pool=n(8236),r.LongBits=n(9351),r.isNode=Boolean("undefined"!==typeof n.g&&n.g&&n.g.process&&n.g.process.versions&&n.g.process.versions.node),r.global=r.isNode&&n.g||"undefined"!==typeof window&&window||"undefined"!==typeof self&&self||this,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isInteger=Number.isInteger||function(e){return"number"===typeof e&&isFinite(e)&&Math.floor(e)===e},r.isString=function(e){return"string"===typeof e||e instanceof String},r.isObject=function(e){return e&&"object"===typeof e},r.isset=r.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!==typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},r.Buffer=function(){try{var e=r.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(t){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(e){return"number"===typeof e?r.Buffer?r._Buffer_allocUnsafe(e):new r.Array(e):r.Buffer?r._Buffer_from(e):"undefined"===typeof Uint8Array?e:new Uint8Array(e)},r.Array="undefined"!==typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.longFromHash=function(e,t){var n=r.LongBits.fromHash(e);return r.Long?r.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))},r.merge=a,r.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},r.newError=i,r.ProtocolError=i("ProtocolError"),r.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},r.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var e=r.Buffer;e?(r._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},r._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):r._Buffer_from=r._Buffer_allocUnsafe=null}},7063:function(e,t,n){"use strict";e.exports=h;var r,a=n(3097),i=a.LongBits,o=a.base64,s=a.utf8;function u(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function c(){}function l(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function h(){this.len=0,this.head=new u(c,0,0),this.tail=this.head,this.states=null}var f=function(){return a.Buffer?function(){return(h.create=function(){return new r})()}:function(){return new h}};function p(e,t,n){t[n]=255&e}function d(e,t){this.len=e,this.next=void 0,this.val=t}function m(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function v(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}h.create=f(),h.alloc=function(e){return new a.Array(e)},a.Array!==Array&&(h.alloc=a.pool(h.alloc,a.Array.prototype.subarray)),h.prototype._push=function(e,t,n){return this.tail=this.tail.next=new u(e,t,n),this.len+=t,this},d.prototype=Object.create(u.prototype),d.prototype.fn=function(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e},h.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new d((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},h.prototype.int32=function(e){return e<0?this._push(m,10,i.fromNumber(e)):this.uint32(e)},h.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},h.prototype.uint64=function(e){var t=i.from(e);return this._push(m,t.length(),t)},h.prototype.int64=h.prototype.uint64,h.prototype.sint64=function(e){var t=i.from(e).zzEncode();return this._push(m,t.length(),t)},h.prototype.bool=function(e){return this._push(p,1,e?1:0)},h.prototype.fixed32=function(e){return this._push(v,4,e>>>0)},h.prototype.sfixed32=h.prototype.fixed32,h.prototype.fixed64=function(e){var t=i.from(e);return this._push(v,4,t.lo)._push(v,4,t.hi)},h.prototype.sfixed64=h.prototype.fixed64,h.prototype.float=function(e){return this._push(a.float.writeFloatLE,4,e)},h.prototype.double=function(e){return this._push(a.float.writeDoubleLE,8,e)};var g=a.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};h.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(p,1,0);if(a.isString(e)){var n=h.alloc(t=o.length(e));o.decode(e,n,0),e=n}return this.uint32(t)._push(g,t,e)},h.prototype.string=function(e){var t=s.length(e);return t?this.uint32(t)._push(s.write,t,e):this._push(p,1,0)},h.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new u(c,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new u(c,0,0),this.len=0),this},h.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},h.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},h._configure=function(e){r=e,h.create=f(),r._configure()}},2815:function(e,t,n){"use strict";e.exports=i;var r=n(7063);(i.prototype=Object.create(r.prototype)).constructor=i;var a=n(3097);function i(){r.call(this)}function o(e,t,n){e.length<40?a.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}i._configure=function(){i.alloc=a._Buffer_allocUnsafe,i.writeBytesBuffer=a.Buffer&&a.Buffer.prototype instanceof Uint8Array&&"set"===a.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]}},i.prototype.bytes=function(e){a.isString(e)&&(e=a._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(i.writeBytesBuffer,t,e),this},i.prototype.string=function(e){var t=a.Buffer.byteLength(e);return this.uint32(t),t&&this._push(o,t,e),this},i._configure()},4463:function(e,t,n){"use strict";var r=n(2791),a=n(5296);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function u(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)o.add(t[e])}var l=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},d={};function m(e,t,n,r,a,i,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var v={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){v[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];v[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){v[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){v[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){v[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){v[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){v[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){v[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){v[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var g=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var a=v.hasOwnProperty(t)?v[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!h.call(d,e)||!h.call(p,e)&&(f.test(e)?d[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(g,y);v[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(g,y);v[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(g,y);v[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){v[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),v.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){v[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var k=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),w=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),E=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),M=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function O(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=R&&e[R]||e["@@iterator"])?e:null}var F,L=Object.assign;function z(e){if(void 0===F)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);F=t&&t[1]||""}return"\n"+F+e}var B=!1;function V(e,t){if(!e||B)return"";B=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),i=r.stack.split("\n"),o=a.length-1,s=i.length-1;1<=o&&0<=s&&a[o]!==i[s];)s--;for(;1<=o&&0<=s;o--,s--)if(a[o]!==i[s]){if(1!==o||1!==s)do{if(o--,0>--s||a[o]!==i[s]){var u="\n"+a[o].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=o&&0<=s);break}}}finally{B=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?z(e):""}function j(e){switch(e.tag){case 5:return z(e.type);case 16:return z("Lazy");case 13:return z("Suspense");case 19:return z("SuspenseList");case 0:case 2:case 15:return e=V(e.type,!1);case 11:return e=V(e.type.render,!1);case 1:return e=V(e.type,!0);default:return""}}function q(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case _:return"Fragment";case w:return"Portal";case C:return"Profiler";case S:return"StrictMode";case A:return"Suspense";case N:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case E:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case I:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case P:return null!==(t=e.displayName||null)?t:q(e.type)||"Memo";case M:t=e._payload,e=e._init;try{return q(e(t))}catch(n){}}return null}function G(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return q(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function U(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function H(e){e._valueTracker||(e._valueTracker=function(e){var t=U(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=U(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function X(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Q(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function $(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function J(e,t){$(e,t);var n=W(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&X(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function ie(e,t){var n=W(t.value),r=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ue(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,le,he=(le=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return le(e,t)}))}:le);function fe(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},de=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ve(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(pe).forEach((function(e){de.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ge=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ge[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ke=null;function xe(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,_e=null,Se=null;function Ce(e){if(e=ba(e)){if("function"!==typeof we)throw Error(i(280));var t=e.stateNode;t&&(t=xa(t),we(e.stateNode,e.type,t))}}function Te(e){_e?Se?Se.push(e):Se=[e]:_e=e}function Ee(){if(_e){var e=_e,t=Se;if(Se=_e=null,Ce(e),t)for(e=0;e<t.length;e++)Ce(t[e])}}function Ie(e,t){return e(t)}function Ae(){}var Ne=!1;function Pe(e,t,n){if(Ne)return e(t,n);Ne=!0;try{return Ie(e,t,n)}finally{Ne=!1,(null!==_e||null!==Se)&&(Ae(),Ee())}}function Me(e,t){var n=e.stateNode;if(null===n)return null;var r=xa(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var De=!1;if(l)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){De=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch(le){De=!1}function Oe(e,t,n,r,a,i,o,s,u){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(l){this.onError(l)}}var Fe=!1,Le=null,ze=!1,Be=null,Ve={onError:function(e){Fe=!0,Le=e}};function je(e,t,n,r,a,i,o,s,u){Fe=!1,Le=null,Oe.apply(Ve,arguments)}function qe(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ge(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(qe(e)!==e)throw Error(i(188))}function Ue(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=qe(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(r=a.return)){n=r;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return We(a),e;if(o===r)return We(a),t;o=o.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=o;else{for(var s=!1,u=a.child;u;){if(u===n){s=!0,n=a,r=o;break}if(u===r){s=!0,r=a,n=o;break}u=u.sibling}if(!s){for(u=o.child;u;){if(u===n){s=!0,n=o,r=a;break}if(u===r){s=!0,r=o,n=a;break}u=u.sibling}if(!s)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var Ke=a.unstable_scheduleCallback,Xe=a.unstable_cancelCallback,Ye=a.unstable_shouldYield,Qe=a.unstable_requestPaint,$e=a.unstable_now,Je=a.unstable_getCurrentPriorityLevel,Ze=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,rt=a.unstable_IdlePriority,at=null,it=null;var ot=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(st(e)/ut|0)|0},st=Math.log,ut=Math.LN2;var ct=64,lt=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ft(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,o=268435455&n;if(0!==o){var s=o&~a;0!==s?r=ht(s):0!==(i&=o)&&(r=ht(i))}else 0!==(o=n&~a)?r=ht(o):0!==i&&(r=ht(i));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(i=t&-t)||16===a&&0!==(4194240&i)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-ot(t)),r|=e[n],t&=~a;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function dt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function vt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function gt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var bt=0;function kt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var xt,wt,_t,St,Ct,Tt=!1,Et=[],It=null,At=null,Nt=null,Pt=new Map,Mt=new Map,Dt=[],Rt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ot(e,t){switch(e){case"focusin":case"focusout":It=null;break;case"dragenter":case"dragleave":At=null;break;case"mouseover":case"mouseout":Nt=null;break;case"pointerover":case"pointerout":Pt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mt.delete(t.pointerId)}}function Ft(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=ba(t))&&wt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Lt(e){var t=ya(e.target);if(null!==t){var n=qe(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ge(n)))return e.blockedOn=t,void Ct(e.priority,(function(){_t(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function zt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ba(n))&&wt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);ke=r,n.target.dispatchEvent(r),ke=null,t.shift()}return!0}function Bt(e,t,n){zt(e)&&n.delete(t)}function Vt(){Tt=!1,null!==It&&zt(It)&&(It=null),null!==At&&zt(At)&&(At=null),null!==Nt&&zt(Nt)&&(Nt=null),Pt.forEach(Bt),Mt.forEach(Bt)}function jt(e,t){e.blockedOn===t&&(e.blockedOn=null,Tt||(Tt=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Vt)))}function qt(e){function t(t){return jt(t,e)}if(0<Et.length){jt(Et[0],e);for(var n=1;n<Et.length;n++){var r=Et[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==It&&jt(It,e),null!==At&&jt(At,e),null!==Nt&&jt(Nt,e),Pt.forEach(t),Mt.forEach(t),n=0;n<Dt.length;n++)(r=Dt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)Lt(n),null===n.blockedOn&&Dt.shift()}var Gt=k.ReactCurrentBatchConfig,Wt=!0;function Ut(e,t,n,r){var a=bt,i=Gt.transition;Gt.transition=null;try{bt=1,Kt(e,t,n,r)}finally{bt=a,Gt.transition=i}}function Ht(e,t,n,r){var a=bt,i=Gt.transition;Gt.transition=null;try{bt=4,Kt(e,t,n,r)}finally{bt=a,Gt.transition=i}}function Kt(e,t,n,r){if(Wt){var a=Yt(e,t,n,r);if(null===a)Wr(e,t,r,Xt,n),Ot(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return It=Ft(It,e,t,n,r,a),!0;case"dragenter":return At=Ft(At,e,t,n,r,a),!0;case"mouseover":return Nt=Ft(Nt,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return Pt.set(i,Ft(Pt.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Mt.set(i,Ft(Mt.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Ot(e,r),4&t&&-1<Rt.indexOf(e)){for(;null!==a;){var i=ba(a);if(null!==i&&xt(i),null===(i=Yt(e,t,n,r))&&Wr(e,t,r,Xt,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else Wr(e,t,r,null,n)}}var Xt=null;function Yt(e,t,n,r){if(Xt=null,null!==(e=ya(e=xe(r))))if(null===(t=qe(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ge(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xt=e,null}function Qt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var $t=null,Jt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Jt,r=n.length,a="value"in $t?$t.value:$t.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===a[i-t];t++);return Zt=a.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,a,i){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,sn,un,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ln=an(cn),hn=L({},cn,{view:0,detail:0}),fn=an(hn),pn=L({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==un&&(un&&"mousemove"===e.type?(on=e.screenX-un.screenX,sn=e.screenY-un.screenY):sn=on=0,un=e),on)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),dn=an(pn),mn=an(L({},pn,{dataTransfer:0})),vn=an(L({},hn,{relatedTarget:0})),gn=an(L({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=L({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=an(yn),kn=an(L({},cn,{data:0})),xn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_n={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=_n[e])&&!!t[e]}function Cn(){return Sn}var Tn=L({},hn,{key:function(e){if(e.key){var t=xn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),En=an(Tn),In=an(L({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),An=an(L({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cn})),Nn=an(L({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Pn=L({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Mn=an(Pn),Dn=[9,13,27,32],Rn=l&&"CompositionEvent"in window,On=null;l&&"documentMode"in document&&(On=document.documentMode);var Fn=l&&"TextEvent"in window&&!On,Ln=l&&(!Rn||On&&8<On&&11>=On),zn=String.fromCharCode(32),Bn=!1;function Vn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var qn=!1;var Gn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Gn[e.type]:"textarea"===t}function Un(e,t,n,r){Te(r),0<(t=Hr(t,"onChange")).length&&(n=new ln("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Hn=null,Kn=null;function Xn(e){zr(e,0)}function Yn(e){if(K(ka(e)))return e}function Qn(e,t){if("change"===e)return t}var $n=!1;if(l){var Jn;if(l){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Jn=Zn}else Jn=!1;$n=Jn&&(!document.documentMode||9<document.documentMode)}function tr(){Hn&&(Hn.detachEvent("onpropertychange",nr),Kn=Hn=null)}function nr(e){if("value"===e.propertyName&&Yn(Kn)){var t=[];Un(t,Kn,e,xe(e)),Pe(Xn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Kn=n,(Hn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Kn)}function ir(e,t){if("click"===e)return Yn(t)}function or(e,t){if("input"===e||"change"===e)return Yn(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ur(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!h.call(t,a)||!sr(e[a],t[a]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function lr(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function hr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function fr(){for(var e=window,t=X();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=X((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function dr(e){var t=fr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=void 0===r.end?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=lr(n,i);var o=lr(n,r);a&&o&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=l&&"documentMode"in document&&11>=document.documentMode,vr=null,gr=null,yr=null,br=!1;function kr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==vr||vr!==X(r)||("selectionStart"in(r=vr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&ur(yr,r)||(yr=r,0<(r=Hr(gr,"onSelect")).length&&(t=new ln("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=vr)))}function xr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var wr={animationend:xr("Animation","AnimationEnd"),animationiteration:xr("Animation","AnimationIteration"),animationstart:xr("Animation","AnimationStart"),transitionend:xr("Transition","TransitionEnd")},_r={},Sr={};function Cr(e){if(_r[e])return _r[e];if(!wr[e])return e;var t,n=wr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Sr)return _r[e]=n[t];return e}l&&(Sr=document.createElement("div").style,"AnimationEvent"in window||(delete wr.animationend.animation,delete wr.animationiteration.animation,delete wr.animationstart.animation),"TransitionEvent"in window||delete wr.transitionend.transition);var Tr=Cr("animationend"),Er=Cr("animationiteration"),Ir=Cr("animationstart"),Ar=Cr("transitionend"),Nr=new Map,Pr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Mr(e,t){Nr.set(e,t),u(t,[e])}for(var Dr=0;Dr<Pr.length;Dr++){var Rr=Pr[Dr];Mr(Rr.toLowerCase(),"on"+(Rr[0].toUpperCase()+Rr.slice(1)))}Mr(Tr,"onAnimationEnd"),Mr(Er,"onAnimationIteration"),Mr(Ir,"onAnimationStart"),Mr("dblclick","onDoubleClick"),Mr("focusin","onFocus"),Mr("focusout","onBlur"),Mr(Ar,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Or="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Or));function Lr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,o,s,u,c){if(je.apply(this,arguments),Fe){if(!Fe)throw Error(i(198));var l=Le;Fe=!1,Le=null,ze||(ze=!0,Be=l)}}(r,t,void 0,e),e.currentTarget=null}function zr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],u=s.instance,c=s.currentTarget;if(s=s.listener,u!==i&&a.isPropagationStopped())break e;Lr(a,s,c),i=u}else for(o=0;o<r.length;o++){if(u=(s=r[o]).instance,c=s.currentTarget,s=s.listener,u!==i&&a.isPropagationStopped())break e;Lr(a,s,c),i=u}}}if(ze)throw e=Be,ze=!1,Be=null,e}function Br(e,t){var n=t[ma];void 0===n&&(n=t[ma]=new Set);var r=e+"__bubble";n.has(r)||(Gr(t,e,2,!1),n.add(r))}function Vr(e,t,n){var r=0;t&&(r|=4),Gr(n,e,r,t)}var jr="_reactListening"+Math.random().toString(36).slice(2);function qr(e){if(!e[jr]){e[jr]=!0,o.forEach((function(t){"selectionchange"!==t&&(Fr.has(t)||Vr(t,!1,e),Vr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[jr]||(t[jr]=!0,Vr("selectionchange",!1,t))}}function Gr(e,t,n,r){switch(Qt(t)){case 1:var a=Ut;break;case 4:a=Ht;break;default:a=Kt}n=a.bind(null,t,n,e),a=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Wr(e,t,n,r,a){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var s=r.stateNode.containerInfo;if(s===a||8===s.nodeType&&s.parentNode===a)break;if(4===o)for(o=r.return;null!==o;){var u=o.tag;if((3===u||4===u)&&((u=o.stateNode.containerInfo)===a||8===u.nodeType&&u.parentNode===a))return;o=o.return}for(;null!==s;){if(null===(o=ya(s)))return;if(5===(u=o.tag)||6===u){r=i=o;continue e}s=s.parentNode}}r=r.return}Pe((function(){var r=i,a=xe(n),o=[];e:{var s=Nr.get(e);if(void 0!==s){var u=ln,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":u=En;break;case"focusin":c="focus",u=vn;break;case"focusout":c="blur",u=vn;break;case"beforeblur":case"afterblur":u=vn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=dn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=An;break;case Tr:case Er:case Ir:u=gn;break;case Ar:u=Nn;break;case"scroll":u=fn;break;case"wheel":u=Mn;break;case"copy":case"cut":case"paste":u=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=In}var l=0!==(4&t),h=!l&&"scroll"===e,f=l?null!==s?s+"Capture":null:s;l=[];for(var p,d=r;null!==d;){var m=(p=d).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==f&&(null!=(m=Me(d,f))&&l.push(Ur(d,m,p)))),h)break;d=d.return}0<l.length&&(s=new u(s,c,null,n,a),o.push({event:s,listeners:l}))}}if(0===(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===ke||!(c=n.relatedTarget||n.fromElement)||!ya(c)&&!c[da])&&(u||s)&&(s=a.window===a?a:(s=a.ownerDocument)?s.defaultView||s.parentWindow:window,u?(u=r,null!==(c=(c=n.relatedTarget||n.toElement)?ya(c):null)&&(c!==(h=qe(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(u=null,c=r),u!==c)){if(l=dn,m="onMouseLeave",f="onMouseEnter",d="mouse","pointerout"!==e&&"pointerover"!==e||(l=In,m="onPointerLeave",f="onPointerEnter",d="pointer"),h=null==u?s:ka(u),p=null==c?s:ka(c),(s=new l(m,d+"leave",u,n,a)).target=h,s.relatedTarget=p,m=null,ya(a)===r&&((l=new l(f,d+"enter",c,n,a)).target=p,l.relatedTarget=h,m=l),h=m,u&&c)e:{for(f=c,d=0,p=l=u;p;p=Kr(p))d++;for(p=0,m=f;m;m=Kr(m))p++;for(;0<d-p;)l=Kr(l),d--;for(;0<p-d;)f=Kr(f),p--;for(;d--;){if(l===f||null!==f&&l===f.alternate)break e;l=Kr(l),f=Kr(f)}l=null}else l=null;null!==u&&Xr(o,s,u,l,!1),null!==c&&null!==h&&Xr(o,h,c,l,!0)}if("select"===(u=(s=r?ka(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===u&&"file"===s.type)var v=Qn;else if(Wn(s))if($n)v=or;else{v=ar;var g=rr}else(u=s.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(v=ir);switch(v&&(v=v(e,r))?Un(o,v,n,a):(g&&g(e,s,r),"focusout"===e&&(g=s._wrapperState)&&g.controlled&&"number"===s.type&&ee(s,"number",s.value)),g=r?ka(r):window,e){case"focusin":(Wn(g)||"true"===g.contentEditable)&&(vr=g,gr=r,yr=null);break;case"focusout":yr=gr=vr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,kr(o,n,a);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":kr(o,n,a)}var y;if(Rn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else qn?Vn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Ln&&"ko"!==n.locale&&(qn||"onCompositionStart"!==b?"onCompositionEnd"===b&&qn&&(y=en()):(Jt="value"in($t=a)?$t.value:$t.textContent,qn=!0)),0<(g=Hr(r,b)).length&&(b=new kn(b,e,null,n,a),o.push({event:b,listeners:g}),y?b.data=y:null!==(y=jn(n))&&(b.data=y))),(y=Fn?function(e,t){switch(e){case"compositionend":return jn(t);case"keypress":return 32!==t.which?null:(Bn=!0,zn);case"textInput":return(e=t.data)===zn&&Bn?null:e;default:return null}}(e,n):function(e,t){if(qn)return"compositionend"===e||!Rn&&Vn(e,t)?(e=en(),Zt=Jt=$t=null,qn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Hr(r,"onBeforeInput")).length&&(a=new kn("onBeforeInput","beforeinput",null,n,a),o.push({event:a,listeners:r}),a.data=y))}zr(o,t)}))}function Ur(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Hr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=Me(e,n))&&r.unshift(Ur(e,i,a)),null!=(i=Me(e,t))&&r.push(Ur(e,i,a))),e=e.return}return r}function Kr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Xr(e,t,n,r,a){for(var i=t._reactName,o=[];null!==n&&n!==r;){var s=n,u=s.alternate,c=s.stateNode;if(null!==u&&u===r)break;5===s.tag&&null!==c&&(s=c,a?null!=(u=Me(n,i))&&o.unshift(Ur(n,u,s)):a||null!=(u=Me(n,i))&&o.push(Ur(n,u,s))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Yr=/\r\n?/g,Qr=/\u0000|\uFFFD/g;function $r(e){return("string"===typeof e?e:""+e).replace(Yr,"\n").replace(Qr,"")}function Jr(e,t,n){if(t=$r(t),$r(e)!==t&&n)throw Error(i(425))}function Zr(){}var ea=null,ta=null;function na(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,ia="function"===typeof Promise?Promise:void 0,oa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ia?function(e){return ia.resolve(null).then(e).catch(sa)}:ra;function sa(e){setTimeout((function(){throw e}))}function ua(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void qt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);qt(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function la(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ha=Math.random().toString(36).slice(2),fa="__reactFiber$"+ha,pa="__reactProps$"+ha,da="__reactContainer$"+ha,ma="__reactEvents$"+ha,va="__reactListeners$"+ha,ga="__reactHandles$"+ha;function ya(e){var t=e[fa];if(t)return t;for(var n=e.parentNode;n;){if(t=n[da]||n[fa]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=la(e);null!==e;){if(n=e[fa])return n;e=la(e)}return t}n=(e=n).parentNode}return null}function ba(e){return!(e=e[fa]||e[da])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ka(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function xa(e){return e[pa]||null}var wa=[],_a=-1;function Sa(e){return{current:e}}function Ca(e){0>_a||(e.current=wa[_a],wa[_a]=null,_a--)}function Ta(e,t){_a++,wa[_a]=e.current,e.current=t}var Ea={},Ia=Sa(Ea),Aa=Sa(!1),Na=Ea;function Pa(e,t){var n=e.type.contextTypes;if(!n)return Ea;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in n)i[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Ma(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Da(){Ca(Aa),Ca(Ia)}function Ra(e,t,n){if(Ia.current!==Ea)throw Error(i(168));Ta(Ia,t),Ta(Aa,n)}function Oa(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(i(108,G(e)||"Unknown",a));return L({},n,r)}function Fa(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ea,Na=Ia.current,Ta(Ia,e),Ta(Aa,Aa.current),!0}function La(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=Oa(e,t,Na),r.__reactInternalMemoizedMergedChildContext=e,Ca(Aa),Ca(Ia),Ta(Ia,e)):Ca(Aa),Ta(Aa,n)}var za=null,Ba=!1,Va=!1;function ja(e){null===za?za=[e]:za.push(e)}function qa(){if(!Va&&null!==za){Va=!0;var e=0,t=bt;try{var n=za;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}za=null,Ba=!1}catch(a){throw null!==za&&(za=za.slice(e+1)),Ke(Ze,qa),a}finally{bt=t,Va=!1}}return null}var Ga=k.ReactCurrentBatchConfig;function Wa(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var Ua=Sa(null),Ha=null,Ka=null,Xa=null;function Ya(){Xa=Ka=Ha=null}function Qa(e){var t=Ua.current;Ca(Ua),e._currentValue=t}function $a(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ja(e,t){Ha=e,Xa=Ka=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(xs=!0),e.firstContext=null)}function Za(e){var t=e._currentValue;if(Xa!==e)if(e={context:e,memoizedValue:t,next:null},null===Ka){if(null===Ha)throw Error(i(308));Ka=e,Ha.dependencies={lanes:0,firstContext:e}}else Ka=Ka.next=e;return t}var ei=null,ti=!1;function ni(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ri(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ai(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ii(e,t){var n=e.updateQueue;null!==n&&(n=n.shared,tc(e)?(null===(e=n.interleaved)?(t.next=t,null===ei?ei=[n]:ei.push(n)):(t.next=e.next,e.next=t),n.interleaved=t):(null===(e=n.pending)?t.next=t:(t.next=e.next,e.next=t),n.pending=t))}function oi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function si(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?a=i=o:i=i.next=o,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ui(e,t,n,r){var a=e.updateQueue;ti=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,s=a.shared.pending;if(null!==s){a.shared.pending=null;var u=s,c=u.next;u.next=null,null===o?i=c:o.next=c,o=u;var l=e.alternate;null!==l&&((s=(l=l.updateQueue).lastBaseUpdate)!==o&&(null===s?l.firstBaseUpdate=c:s.next=c,l.lastBaseUpdate=u))}if(null!==i){var h=a.baseState;for(o=0,l=c=u=null,s=i;;){var f=s.lane,p=s.eventTime;if((r&f)===f){null!==l&&(l=l.next={eventTime:p,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var d=e,m=s;switch(f=t,p=n,m.tag){case 1:if("function"===typeof(d=m.payload)){h=d.call(p,h,f);break e}h=d;break e;case 3:d.flags=-65537&d.flags|128;case 0:if(null===(f="function"===typeof(d=m.payload)?d.call(p,h,f):d)||void 0===f)break e;h=L({},h,f);break e;case 2:ti=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(f=a.effects)?a.effects=[s]:f.push(s))}else p={eventTime:p,lane:f,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===l?(c=l=p,u=h):l=l.next=p,o|=f;if(null===(s=s.next)){if(null===(s=a.shared.pending))break;s=(f=s).next,f.next=null,a.lastBaseUpdate=f,a.shared.pending=null}}if(null===l&&(u=h),a.baseState=u,a.firstBaseUpdate=c,a.lastBaseUpdate=l,null!==(t=a.shared.interleaved)){a=t;do{o|=a.lane,a=a.next}while(a!==t)}else null===i&&(a.shared.lanes=0);Du|=o,e.lanes=o,e.memoizedState=h}}function ci(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(i(191,a));a.call(r)}}}var li=(new r.Component).refs;function hi(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var fi={isMounted:function(e){return!!(e=e._reactInternals)&&qe(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=$u(),a=Ju(e),i=ai(r,a);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),ii(e,i),null!==(t=Zu(e,a,r))&&oi(t,e,a)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=$u(),a=Ju(e),i=ai(r,a);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),ii(e,i),null!==(t=Zu(e,a,r))&&oi(t,e,a)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=$u(),r=Ju(e),a=ai(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),ii(e,a),null!==(t=Zu(e,r,n))&&oi(t,e,r)}};function pi(e,t,n,r,a,i,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,o):!t.prototype||!t.prototype.isPureReactComponent||(!ur(n,r)||!ur(a,i))}function di(e,t,n){var r=!1,a=Ea,i=t.contextType;return"object"===typeof i&&null!==i?i=Za(i):(a=Ma(t)?Na:Ia.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?Pa(e,a):Ea),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=fi,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function mi(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&fi.enqueueReplaceState(t,t.state,null)}function vi(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs=li,ni(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=Za(i):(i=Ma(t)?Na:Ia.current,a.context=Pa(e,i)),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(hi(e,t,i,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&fi.enqueueReplaceState(a,a.state,null),ui(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}var gi=[],yi=0,bi=null,ki=0,xi=[],wi=0,_i=null,Si=1,Ci="";function Ti(e,t){gi[yi++]=ki,gi[yi++]=bi,bi=e,ki=t}function Ei(e,t,n){xi[wi++]=Si,xi[wi++]=Ci,xi[wi++]=_i,_i=e;var r=Si;e=Ci;var a=32-ot(r)-1;r&=~(1<<a),n+=1;var i=32-ot(t)+a;if(30<i){var o=a-a%5;i=(r&(1<<o)-1).toString(32),r>>=o,a-=o,Si=1<<32-ot(t)+a|n<<a|r,Ci=i+e}else Si=1<<i|n<<a|r,Ci=e}function Ii(e){null!==e.return&&(Ti(e,1),Ei(e,1,0))}function Ai(e){for(;e===bi;)bi=gi[--yi],gi[yi]=null,ki=gi[--yi],gi[yi]=null;for(;e===_i;)_i=xi[--wi],xi[wi]=null,Ci=xi[--wi],xi[wi]=null,Si=xi[--wi],xi[wi]=null}var Ni=null,Pi=null,Mi=!1,Di=null;function Ri(e,t){var n=Nc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function Oi(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,Ni=e,Pi=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,Ni=e,Pi=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==_i?{id:Si,overflow:Ci}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Nc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,Ni=e,Pi=null,!0);default:return!1}}function Fi(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function Li(e){if(Mi){var t=Pi;if(t){var n=t;if(!Oi(e,t)){if(Fi(e))throw Error(i(418));t=ca(n.nextSibling);var r=Ni;t&&Oi(e,t)?Ri(r,n):(e.flags=-4097&e.flags|2,Mi=!1,Ni=e)}}else{if(Fi(e))throw Error(i(418));e.flags=-4097&e.flags|2,Mi=!1,Ni=e}}}function zi(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Ni=e}function Bi(e){if(e!==Ni)return!1;if(!Mi)return zi(e),Mi=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!na(e.type,e.memoizedProps)),t&&(t=Pi)){if(Fi(e)){for(e=Pi;e;)e=ca(e.nextSibling);throw Error(i(418))}for(;t;)Ri(e,t),t=ca(t.nextSibling)}if(zi(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){Pi=ca(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}Pi=null}}else Pi=Ni?ca(e.stateNode.nextSibling):null;return!0}function Vi(){Pi=Ni=null,Mi=!1}function ji(e){null===Di?Di=[e]:Di.push(e)}function qi(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var a=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=a.refs;t===li&&(t=a.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function Gi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Wi(e){return(0,e._init)(e._payload)}function Ui(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Mc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function u(e,t,n,r){return null===t||6!==t.tag?((t=Fc(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){var i=n.type;return i===_?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===M&&Wi(i)===t.type)?((r=a(t,n.props)).ref=qi(e,t,n),r.return=e,r):((r=Dc(n.type,n.key,n.props,null,e.mode,r)).ref=qi(e,t,n),r.return=e,r)}function l(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Lc(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function h(e,t,n,r,i){return null===t||7!==t.tag?((t=Rc(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function f(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Fc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case x:return(n=Dc(t.type,t.key,t.props,null,e.mode,n)).ref=qi(e,null,t),n.return=e,n;case w:return(t=Lc(t,e.mode,n)).return=e,t;case M:return f(e,(0,t._init)(t._payload),n)}if(te(t)||O(t))return(t=Rc(t,e.mode,n,null)).return=e,t;Gi(e,t)}return null}function p(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:u(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case x:return n.key===a?c(e,t,n,r):null;case w:return n.key===a?l(e,t,n,r):null;case M:return p(e,t,(a=n._init)(n._payload),r)}if(te(n)||O(n))return null!==a?null:h(e,t,n,r,null);Gi(e,n)}return null}function d(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return u(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case x:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case w:return l(t,e=e.get(null===r.key?n:r.key)||null,r,a);case M:return d(e,t,n,(0,r._init)(r._payload),a)}if(te(r)||O(r))return h(t,e=e.get(n)||null,r,a,null);Gi(t,r)}return null}function m(a,i,s,u){for(var c=null,l=null,h=i,m=i=0,v=null;null!==h&&m<s.length;m++){h.index>m?(v=h,h=null):v=h.sibling;var g=p(a,h,s[m],u);if(null===g){null===h&&(h=v);break}e&&h&&null===g.alternate&&t(a,h),i=o(g,i,m),null===l?c=g:l.sibling=g,l=g,h=v}if(m===s.length)return n(a,h),Mi&&Ti(a,m),c;if(null===h){for(;m<s.length;m++)null!==(h=f(a,s[m],u))&&(i=o(h,i,m),null===l?c=h:l.sibling=h,l=h);return Mi&&Ti(a,m),c}for(h=r(a,h);m<s.length;m++)null!==(v=d(h,a,m,s[m],u))&&(e&&null!==v.alternate&&h.delete(null===v.key?m:v.key),i=o(v,i,m),null===l?c=v:l.sibling=v,l=v);return e&&h.forEach((function(e){return t(a,e)})),Mi&&Ti(a,m),c}function v(a,s,u,c){var l=O(u);if("function"!==typeof l)throw Error(i(150));if(null==(u=l.call(u)))throw Error(i(151));for(var h=l=null,m=s,v=s=0,g=null,y=u.next();null!==m&&!y.done;v++,y=u.next()){m.index>v?(g=m,m=null):g=m.sibling;var b=p(a,m,y.value,c);if(null===b){null===m&&(m=g);break}e&&m&&null===b.alternate&&t(a,m),s=o(b,s,v),null===h?l=b:h.sibling=b,h=b,m=g}if(y.done)return n(a,m),Mi&&Ti(a,v),l;if(null===m){for(;!y.done;v++,y=u.next())null!==(y=f(a,y.value,c))&&(s=o(y,s,v),null===h?l=y:h.sibling=y,h=y);return Mi&&Ti(a,v),l}for(m=r(a,m);!y.done;v++,y=u.next())null!==(y=d(m,a,v,y.value,c))&&(e&&null!==y.alternate&&m.delete(null===y.key?v:y.key),s=o(y,s,v),null===h?l=y:h.sibling=y,h=y);return e&&m.forEach((function(e){return t(a,e)})),Mi&&Ti(a,v),l}return function e(r,i,o,u){if("object"===typeof o&&null!==o&&o.type===_&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case x:e:{for(var c=o.key,l=i;null!==l;){if(l.key===c){if((c=o.type)===_){if(7===l.tag){n(r,l.sibling),(i=a(l,o.props.children)).return=r,r=i;break e}}else if(l.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===M&&Wi(c)===l.type){n(r,l.sibling),(i=a(l,o.props)).ref=qi(r,l,o),i.return=r,r=i;break e}n(r,l);break}t(r,l),l=l.sibling}o.type===_?((i=Rc(o.props.children,r.mode,u,o.key)).return=r,r=i):((u=Dc(o.type,o.key,o.props,null,r.mode,u)).ref=qi(r,i,o),u.return=r,r=u)}return s(r);case w:e:{for(l=o.key;null!==i;){if(i.key===l){if(4===i.tag&&i.stateNode.containerInfo===o.containerInfo&&i.stateNode.implementation===o.implementation){n(r,i.sibling),(i=a(i,o.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=Lc(o,r.mode,u)).return=r,r=i}return s(r);case M:return e(r,i,(l=o._init)(o._payload),u)}if(te(o))return m(r,i,o,u);if(O(o))return v(r,i,o,u);Gi(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==i&&6===i.tag?(n(r,i.sibling),(i=a(i,o)).return=r,r=i):(n(r,i),(i=Fc(o,r.mode,u)).return=r,r=i),s(r)):n(r,i)}}var Hi=Ui(!0),Ki=Ui(!1),Xi={},Yi=Sa(Xi),Qi=Sa(Xi),$i=Sa(Xi);function Ji(e){if(e===Xi)throw Error(i(174));return e}function Zi(e,t){switch(Ta($i,t),Ta(Qi,e),Ta(Yi,Xi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ue(null,"");break;default:t=ue(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ca(Yi),Ta(Yi,t)}function eo(){Ca(Yi),Ca(Qi),Ca($i)}function to(e){Ji($i.current);var t=Ji(Yi.current),n=ue(t,e.type);t!==n&&(Ta(Qi,e),Ta(Yi,n))}function no(e){Qi.current===e&&(Ca(Yi),Ca(Qi))}var ro=Sa(0);function ao(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var io=[];function oo(){for(var e=0;e<io.length;e++)io[e]._workInProgressVersionPrimary=null;io.length=0}var so=k.ReactCurrentDispatcher,uo=k.ReactCurrentBatchConfig,co=0,lo=null,ho=null,fo=null,po=!1,mo=!1,vo=0,go=0;function yo(){throw Error(i(321))}function bo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function ko(e,t,n,r,a,o){if(co=o,lo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,so.current=null===e||null===e.memoizedState?rs:as,e=n(r,a),mo){o=0;do{if(mo=!1,vo=0,25<=o)throw Error(i(301));o+=1,fo=ho=null,t.updateQueue=null,so.current=is,e=n(r,a)}while(mo)}if(so.current=ns,t=null!==ho&&null!==ho.next,co=0,fo=ho=lo=null,po=!1,t)throw Error(i(300));return e}function xo(){var e=0!==vo;return vo=0,e}function wo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===fo?lo.memoizedState=fo=e:fo=fo.next=e,fo}function _o(){if(null===ho){var e=lo.alternate;e=null!==e?e.memoizedState:null}else e=ho.next;var t=null===fo?lo.memoizedState:fo.next;if(null!==t)fo=t,ho=e;else{if(null===e)throw Error(i(310));e={memoizedState:(ho=e).memoizedState,baseState:ho.baseState,baseQueue:ho.baseQueue,queue:ho.queue,next:null},null===fo?lo.memoizedState=fo=e:fo=fo.next=e}return fo}function So(e,t){return"function"===typeof t?t(e):t}function Co(e){var t=_o(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=ho,a=r.baseQueue,o=n.pending;if(null!==o){if(null!==a){var s=a.next;a.next=o.next,o.next=s}r.baseQueue=a=o,n.pending=null}if(null!==a){o=a.next,r=r.baseState;var u=s=null,c=null,l=o;do{var h=l.lane;if((co&h)===h)null!==c&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var f={lane:h,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};null===c?(u=c=f,s=r):c=c.next=f,lo.lanes|=h,Du|=h}l=l.next}while(null!==l&&l!==o);null===c?s=r:c.next=u,sr(r,t.memoizedState)||(xs=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{o=a.lane,lo.lanes|=o,Du|=o,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function To(e){var t=_o(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,o=t.memoizedState;if(null!==a){n.pending=null;var s=a=a.next;do{o=e(o,s.action),s=s.next}while(s!==a);sr(o,t.memoizedState)||(xs=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Eo(){}function Io(e,t){var n=lo,r=_o(),a=t(),o=!sr(r.memoizedState,a);if(o&&(r.memoizedState=a,xs=!0),r=r.queue,Bo(Po.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==fo&&1&fo.memoizedState.tag){if(n.flags|=2048,Ro(9,No.bind(null,n,r,a,t),void 0,null),null===Tu)throw Error(i(349));0!==(30&co)||Ao(n,t,a)}return a}function Ao(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=lo.updateQueue)?(t={lastEffect:null,stores:null},lo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function No(e,t,n,r){t.value=n,t.getSnapshot=r,Mo(t)&&Zu(e,1,-1)}function Po(e,t,n){return n((function(){Mo(t)&&Zu(e,1,-1)}))}function Mo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function Do(e){var t=wo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:So,lastRenderedState:e},t.queue=e,e=e.dispatch=$o.bind(null,lo,e),[t.memoizedState,e]}function Ro(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=lo.updateQueue)?(t={lastEffect:null,stores:null},lo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Oo(){return _o().memoizedState}function Fo(e,t,n,r){var a=wo();lo.flags|=e,a.memoizedState=Ro(1|t,n,void 0,void 0===r?null:r)}function Lo(e,t,n,r){var a=_o();r=void 0===r?null:r;var i=void 0;if(null!==ho){var o=ho.memoizedState;if(i=o.destroy,null!==r&&bo(r,o.deps))return void(a.memoizedState=Ro(t,n,i,r))}lo.flags|=e,a.memoizedState=Ro(1|t,n,i,r)}function zo(e,t){return Fo(8390656,8,e,t)}function Bo(e,t){return Lo(2048,8,e,t)}function Vo(e,t){return Lo(4,2,e,t)}function jo(e,t){return Lo(4,4,e,t)}function qo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Go(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Lo(4,4,qo.bind(null,t,e),n)}function Wo(){}function Uo(e,t){var n=_o();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&bo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ho(e,t){var n=_o();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&bo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ko(e,t,n){return 0===(21&co)?(e.baseState&&(e.baseState=!1,xs=!0),e.memoizedState=n):(sr(n,t)||(n=mt(),lo.lanes|=n,Du|=n,e.baseState=!0),t)}function Xo(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=uo.transition;uo.transition={};try{e(!1),t()}finally{bt=n,uo.transition=r}}function Yo(){return _o().memoizedState}function Qo(e,t,n){var r=Ju(e);n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Jo(e)?Zo(t,n):(es(e,t,n),null!==(e=Zu(e,r,n=$u()))&&ts(e,t,r))}function $o(e,t,n){var r=Ju(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Jo(e))Zo(t,a);else{es(e,t,a);var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=i(o,n);if(a.hasEagerState=!0,a.eagerState=s,sr(s,o))return}catch(u){}null!==(e=Zu(e,r,n=$u()))&&ts(e,t,r)}}function Jo(e){var t=e.alternate;return e===lo||null!==t&&t===lo}function Zo(e,t){mo=po=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function es(e,t,n){tc(e)?(null===(e=t.interleaved)?(n.next=n,null===ei?ei=[t]:ei.push(t)):(n.next=e.next,e.next=n),t.interleaved=n):(null===(e=t.pending)?n.next=n:(n.next=e.next,e.next=n),t.pending=n)}function ts(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var ns={readContext:Za,useCallback:yo,useContext:yo,useEffect:yo,useImperativeHandle:yo,useInsertionEffect:yo,useLayoutEffect:yo,useMemo:yo,useReducer:yo,useRef:yo,useState:yo,useDebugValue:yo,useDeferredValue:yo,useTransition:yo,useMutableSource:yo,useSyncExternalStore:yo,useId:yo,unstable_isNewReconciler:!1},rs={readContext:Za,useCallback:function(e,t){return wo().memoizedState=[e,void 0===t?null:t],e},useContext:Za,useEffect:zo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Fo(4194308,4,qo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Fo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Fo(4,2,e,t)},useMemo:function(e,t){var n=wo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=wo();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Qo.bind(null,lo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},wo().memoizedState=e},useState:Do,useDebugValue:Wo,useDeferredValue:function(e){return wo().memoizedState=e},useTransition:function(){var e=Do(!1),t=e[0];return e=Xo.bind(null,e[1]),wo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=lo,a=wo();if(Mi){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Tu)throw Error(i(349));0!==(30&co)||Ao(r,t,n)}a.memoizedState=n;var o={value:n,getSnapshot:t};return a.queue=o,zo(Po.bind(null,r,o,e),[e]),r.flags|=2048,Ro(9,No.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=wo(),t=Tu.identifierPrefix;if(Mi){var n=Ci;t=":"+t+"R"+(n=(Si&~(1<<32-ot(Si)-1)).toString(32)+n),0<(n=vo++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=go++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},as={readContext:Za,useCallback:Uo,useContext:Za,useEffect:Bo,useImperativeHandle:Go,useInsertionEffect:Vo,useLayoutEffect:jo,useMemo:Ho,useReducer:Co,useRef:Oo,useState:function(){return Co(So)},useDebugValue:Wo,useDeferredValue:function(e){return Ko(_o(),ho.memoizedState,e)},useTransition:function(){return[Co(So)[0],_o().memoizedState]},useMutableSource:Eo,useSyncExternalStore:Io,useId:Yo,unstable_isNewReconciler:!1},is={readContext:Za,useCallback:Uo,useContext:Za,useEffect:Bo,useImperativeHandle:Go,useInsertionEffect:Vo,useLayoutEffect:jo,useMemo:Ho,useReducer:To,useRef:Oo,useState:function(){return To(So)},useDebugValue:Wo,useDeferredValue:function(e){var t=_o();return null===ho?t.memoizedState=e:Ko(t,ho.memoizedState,e)},useTransition:function(){return[To(So)[0],_o().memoizedState]},useMutableSource:Eo,useSyncExternalStore:Io,useId:Yo,unstable_isNewReconciler:!1};function os(e,t){try{var n="",r=t;do{n+=j(r),r=r.return}while(r);var a=n}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a}}function ss(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var us,cs,ls,hs="function"===typeof WeakMap?WeakMap:Map;function fs(e,t,n){(n=ai(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){ju||(ju=!0,qu=r),ss(0,t)},n}function ps(e,t,n){(n=ai(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){ss(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){ss(0,t),"function"!==typeof r&&(null===Gu?Gu=new Set([this]):Gu.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ds(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new hs;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=Sc.bind(null,e,t,n),t.then(e,e))}function ms(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vs(e,t,n,r,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=ai(-1,1)).tag=2,ii(n,t))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}function gs(e,t){if(!Mi)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function ys(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function bs(e,t,n){var r=t.pendingProps;switch(Ai(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ys(t),null;case 1:case 17:return Ma(t.type)&&Da(),ys(t),null;case 3:return r=t.stateNode,eo(),Ca(Aa),Ca(Ia),oo(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(Bi(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==Di&&(ic(Di),Di=null))),ys(t),null;case 5:no(t);var a=Ji($i.current);if(n=t.type,null!==e&&null!=t.stateNode)cs(e,t,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return ys(t),null}if(e=Ji(Yi.current),Bi(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[fa]=t,r[pa]=o,e=0!==(1&t.mode),n){case"dialog":Br("cancel",r),Br("close",r);break;case"iframe":case"object":case"embed":Br("load",r);break;case"video":case"audio":for(a=0;a<Or.length;a++)Br(Or[a],r);break;case"source":Br("error",r);break;case"img":case"image":case"link":Br("error",r),Br("load",r);break;case"details":Br("toggle",r);break;case"input":Q(r,o),Br("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Br("invalid",r);break;case"textarea":ae(r,o),Br("invalid",r)}for(var u in ye(n,o),a=null,o)if(o.hasOwnProperty(u)){var c=o[u];"children"===u?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&Jr(r.textContent,c,e),a=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Jr(r.textContent,c,e),a=["children",""+c]):s.hasOwnProperty(u)&&null!=c&&"onScroll"===u&&Br("scroll",r)}switch(n){case"input":H(r),Z(r,o,!0);break;case"textarea":H(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Zr)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{u=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=u.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=u.createElement(n,{is:r.is}):(e=u.createElement(n),"select"===n&&(u=e,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):e=u.createElementNS(e,n),e[fa]=t,e[pa]=r,us(e,t),t.stateNode=e;e:{switch(u=be(n,r),n){case"dialog":Br("cancel",e),Br("close",e),a=r;break;case"iframe":case"object":case"embed":Br("load",e),a=r;break;case"video":case"audio":for(a=0;a<Or.length;a++)Br(Or[a],e);a=r;break;case"source":Br("error",e),a=r;break;case"img":case"image":case"link":Br("error",e),Br("load",e),a=r;break;case"details":Br("toggle",e),a=r;break;case"input":Q(e,r),a=Y(e,r),Br("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=L({},r,{value:void 0}),Br("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),Br("invalid",e)}for(o in ye(n,a),c=a)if(c.hasOwnProperty(o)){var l=c[o];"style"===o?ve(e,l):"dangerouslySetInnerHTML"===o?null!=(l=l?l.__html:void 0)&&he(e,l):"children"===o?"string"===typeof l?("textarea"!==n||""!==l)&&fe(e,l):"number"===typeof l&&fe(e,""+l):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=l&&"onScroll"===o&&Br("scroll",e):null!=l&&b(e,o,l,u))}switch(n){case"input":H(e),Z(e,r,!1);break;case"textarea":H(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+W(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return ys(t),null;case 6:if(e&&null!=t.stateNode)ls(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(n=Ji($i.current),Ji(Yi.current),Bi(t)){if(r=t.stateNode,n=t.memoizedProps,r[fa]=t,(o=r.nodeValue!==n)&&null!==(e=Ni))switch(e.tag){case 3:Jr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[fa]=t,t.stateNode=r}return ys(t),null;case 13:if(Ca(ro),r=t.memoizedState,Mi&&null!==Pi&&0!==(1&t.mode)&&0===(128&t.flags)){for(r=Pi;r;)r=ca(r.nextSibling);return Vi(),t.flags|=98560,t}if(null!==r&&null!==r.dehydrated){if(r=Bi(t),null===e){if(!r)throw Error(i(318));if(!(r=null!==(r=t.memoizedState)?r.dehydrated:null))throw Error(i(317));r[fa]=t}else Vi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;return ys(t),null}return null!==Di&&(ic(Di),Di=null),0!==(128&t.flags)?(t.lanes=n,t):(r=null!==r,n=!1,null===e?Bi(t):n=null!==e.memoizedState,r!==n&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ro.current)?0===Pu&&(Pu=3):dc())),null!==t.updateQueue&&(t.flags|=4),ys(t),null);case 4:return eo(),null===e&&qr(t.stateNode.containerInfo),ys(t),null;case 10:return Qa(t.type._context),ys(t),null;case 19:if(Ca(ro),null===(o=t.memoizedState))return ys(t),null;if(r=0!==(128&t.flags),null===(u=o.rendering))if(r)gs(o,!1);else{if(0!==Pu||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(u=ao(e))){for(t.flags|=128,gs(o,!1),null!==(r=u.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(u=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=u.childLanes,o.lanes=u.lanes,o.child=u.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=u.memoizedProps,o.memoizedState=u.memoizedState,o.updateQueue=u.updateQueue,o.type=u.type,e=u.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ta(ro,1&ro.current|2),t.child}e=e.sibling}null!==o.tail&&$e()>Bu&&(t.flags|=128,r=!0,gs(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ao(u))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),gs(o,!0),null===o.tail&&"hidden"===o.tailMode&&!u.alternate&&!Mi)return ys(t),null}else 2*$e()-o.renderingStartTime>Bu&&1073741824!==n&&(t.flags|=128,r=!0,gs(o,!1),t.lanes=4194304);o.isBackwards?(u.sibling=t.child,t.child=u):(null!==(n=o.last)?n.sibling=u:t.child=u,o.last=u)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=$e(),t.sibling=null,n=ro.current,Ta(ro,r?1&n|2:1&n),t):(ys(t),null);case 22:case 23:return lc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Au)&&(ys(t),6&t.subtreeFlags&&(t.flags|=8192)):ys(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}us=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},cs=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,Ji(Yi.current);var i,o=null;switch(n){case"input":a=Y(e,a),r=Y(e,r),o=[];break;case"select":a=L({},a,{value:void 0}),r=L({},r,{value:void 0}),o=[];break;case"textarea":a=re(e,a),r=re(e,r),o=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(l in ye(n,r),n=null,a)if(!r.hasOwnProperty(l)&&a.hasOwnProperty(l)&&null!=a[l])if("style"===l){var u=a[l];for(i in u)u.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==l&&"children"!==l&&"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(s.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in r){var c=r[l];if(u=null!=a?a[l]:void 0,r.hasOwnProperty(l)&&c!==u&&(null!=c||null!=u))if("style"===l)if(u){for(i in u)!u.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&u[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(o||(o=[]),o.push(l,n)),n=c;else"dangerouslySetInnerHTML"===l?(c=c?c.__html:void 0,u=u?u.__html:void 0,null!=c&&u!==c&&(o=o||[]).push(l,c)):"children"===l?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(l,""+c):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&(s.hasOwnProperty(l)?(null!=c&&"onScroll"===l&&Br("scroll",e),o||u===c||(o=[])):(o=o||[]).push(l,c))}n&&(o=o||[]).push("style",n);var l=o;(t.updateQueue=l)&&(t.flags|=4)}},ls=function(e,t,n,r){n!==r&&(t.flags|=4)};var ks=k.ReactCurrentOwner,xs=!1;function ws(e,t,n,r){t.child=null===e?Ki(t,null,n,r):Hi(t,e.child,n,r)}function _s(e,t,n,r,a){n=n.render;var i=t.ref;return Ja(t,a),r=ko(e,t,n,r,i,a),n=xo(),null===e||xs?(Mi&&n&&Ii(t),t.flags|=1,ws(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Ws(e,t,a))}function Ss(e,t,n,r,a){if(null===e){var i=n.type;return"function"!==typeof i||Pc(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Dc(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Cs(e,t,i,r,a))}if(i=e.child,0===(e.lanes&a)){var o=i.memoizedProps;if((n=null!==(n=n.compare)?n:ur)(o,r)&&e.ref===t.ref)return Ws(e,t,a)}return t.flags|=1,(e=Mc(i,r)).ref=t.ref,e.return=t,t.child=e}function Cs(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(ur(i,r)&&e.ref===t.ref){if(xs=!1,t.pendingProps=r=i,0===(e.lanes&a))return t.lanes=e.lanes,Ws(e,t,a);0!==(131072&e.flags)&&(xs=!0)}}return Is(e,t,n,r,a)}function Ts(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ta(Nu,Au),Au|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ta(Nu,Au),Au|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,Ta(Nu,Au),Au|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,Ta(Nu,Au),Au|=r;return ws(e,t,a,n),t.child}function Es(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Is(e,t,n,r,a){var i=Ma(n)?Na:Ia.current;return i=Pa(t,i),Ja(t,a),n=ko(e,t,n,r,i,a),r=xo(),null===e||xs?(Mi&&r&&Ii(t),t.flags|=1,ws(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Ws(e,t,a))}function As(e,t,n,r,a){if(Ma(n)){var i=!0;Fa(t)}else i=!1;if(Ja(t,a),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),di(t,n,r),vi(t,n,r,a),r=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var u=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Za(c):c=Pa(t,c=Ma(n)?Na:Ia.current);var l=n.getDerivedStateFromProps,h="function"===typeof l||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==r||u!==c)&&mi(t,o,r,c),ti=!1;var f=t.memoizedState;o.state=f,ui(t,r,o,a),u=t.memoizedState,s!==r||f!==u||Aa.current||ti?("function"===typeof l&&(hi(t,n,l,r),u=t.memoizedState),(s=ti||pi(t,n,s,r,f,u,c))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),o.props=r,o.state=u,o.context=c,r=s):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,ri(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:Wa(t.type,s),o.props=c,h=t.pendingProps,f=o.context,"object"===typeof(u=n.contextType)&&null!==u?u=Za(u):u=Pa(t,u=Ma(n)?Na:Ia.current);var p=n.getDerivedStateFromProps;(l="function"===typeof p||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==h||f!==u)&&mi(t,o,r,u),ti=!1,f=t.memoizedState,o.state=f,ui(t,r,o,a);var d=t.memoizedState;s!==h||f!==d||Aa.current||ti?("function"===typeof p&&(hi(t,n,p,r),d=t.memoizedState),(c=ti||pi(t,n,c,r,f,d,u)||!1)?(l||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,d,u),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,d,u)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=d),o.props=r,o.state=d,o.context=u,r=c):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return Ns(e,t,n,r,i,a)}function Ns(e,t,n,r,a,i){Es(e,t);var o=0!==(128&t.flags);if(!r&&!o)return a&&La(t,n,!1),Ws(e,t,i);r=t.stateNode,ks.current=t;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=Hi(t,e.child,null,i),t.child=Hi(t,null,s,i)):ws(e,t,s,i),t.memoizedState=r.state,a&&La(t,n,!0),t.child}function Ps(e){var t=e.stateNode;t.pendingContext?Ra(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ra(0,t.context,!1),Zi(e,t.containerInfo)}function Ms(e,t,n,r,a){return Vi(),ji(a),t.flags|=256,ws(e,t,n,r),t.child}var Ds={dehydrated:null,treeContext:null,retryLane:0};function Rs(e){return{baseLanes:e,cachePool:null,transitions:null}}function Os(e,t){return{baseLanes:e.baseLanes|t,cachePool:null,transitions:e.transitions}}function Fs(e,t,n){var r,a=t.pendingProps,o=ro.current,s=!1,u=0!==(128&t.flags);if((r=u)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ta(ro,1&o),null===e)return Li(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(o=a.children,e=a.fallback,s?(a=t.mode,s=t.child,o={mode:"hidden",children:o},0===(1&a)&&null!==s?(s.childLanes=0,s.pendingProps=o):s=Oc(o,a,0,null),e=Rc(e,a,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Rs(n),t.memoizedState=Ds,e):Ls(t,o));if(null!==(o=e.memoizedState)){if(null!==(r=o.dehydrated)){if(u)return 256&t.flags?(t.flags&=-257,Vs(e,t,n,Error(i(422)))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=a.fallback,o=t.mode,a=Oc({mode:"visible",children:a.children},o,0,null),(s=Rc(s,o,n,null)).flags|=2,a.return=t,s.return=t,a.sibling=s,t.child=a,0!==(1&t.mode)&&Hi(t,e.child,null,n),t.child.memoizedState=Rs(n),t.memoizedState=Ds,s);if(0===(1&t.mode))t=Vs(e,t,n,null);else if("$!"===r.data)t=Vs(e,t,n,Error(i(419)));else if(a=0!==(n&e.childLanes),xs||a){if(null!==(a=Tu)){switch(n&-n){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}0!==(a=0!==(s&(a.suspendedLanes|n))?0:s)&&a!==o.retryLane&&(o.retryLane=a,Zu(e,a,-1))}dc(),t=Vs(e,t,n,Error(i(421)))}else"$?"===r.data?(t.flags|=128,t.child=e.child,t=Tc.bind(null,e),r._reactRetry=t,t=null):(n=o.treeContext,Pi=ca(r.nextSibling),Ni=t,Mi=!0,Di=null,null!==n&&(xi[wi++]=Si,xi[wi++]=Ci,xi[wi++]=_i,Si=n.id,Ci=n.overflow,_i=t),(t=Ls(t,t.pendingProps.children)).flags|=4096);return t}return s?(a=Bs(e,t,a.children,a.fallback,n),s=t.child,o=e.child.memoizedState,s.memoizedState=null===o?Rs(n):Os(o,n),s.childLanes=e.childLanes&~n,t.memoizedState=Ds,a):(n=zs(e,t,a.children,n),t.memoizedState=null,n)}return s?(a=Bs(e,t,a.children,a.fallback,n),s=t.child,o=e.child.memoizedState,s.memoizedState=null===o?Rs(n):Os(o,n),s.childLanes=e.childLanes&~n,t.memoizedState=Ds,a):(n=zs(e,t,a.children,n),t.memoizedState=null,n)}function Ls(e,t){return(t=Oc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function zs(e,t,n,r){var a=e.child;return e=a.sibling,n=Mc(a,{mode:"visible",children:n}),0===(1&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n}function Bs(e,t,n,r,a){var i=t.mode,o=(e=e.child).sibling,s={mode:"hidden",children:n};return 0===(1&i)&&t.child!==e?((n=t.child).childLanes=0,n.pendingProps=s,t.deletions=null):(n=Mc(e,s)).subtreeFlags=14680064&e.subtreeFlags,null!==o?r=Mc(o,r):(r=Rc(r,i,a,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}function Vs(e,t,n,r){return null!==r&&ji(r),Hi(t,e.child,null,n),(e=Ls(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function js(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),$a(e.return,t,n)}function qs(e,t,n,r,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function Gs(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(ws(e,t,r.children,n),0!==(2&(r=ro.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&js(e,n,t);else if(19===e.tag)js(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ta(ro,r),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===ao(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),qs(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===ao(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}qs(t,!0,n,null,i);break;case"together":qs(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ws(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Du|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Mc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Mc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Us(e,t){switch(Ai(t),t.tag){case 1:return Ma(t.type)&&Da(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return eo(),Ca(Aa),Ca(Ia),oo(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return no(t),null;case 13:if(Ca(ro),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));Vi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ca(ro),null;case 4:return eo(),null;case 10:return Qa(t.type._context),null;case 22:case 23:return lc(),null;default:return null}}var Hs=!1,Ks=!1,Xs="function"===typeof WeakSet?WeakSet:Set,Ys=null;function Qs(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){_c(e,t,r)}else n.current=null}function $s(e,t,n){try{n()}catch(r){_c(e,t,r)}}var Js=!1;function Zs(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,void 0!==i&&$s(t,n,i)}a=a.next}while(a!==r)}}function eu(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function tu(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function nu(e){var t=e.alternate;null!==t&&(e.alternate=null,nu(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[fa],delete t[pa],delete t[ma],delete t[va],delete t[ga])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ru(e){return 5===e.tag||3===e.tag||4===e.tag}function au(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ru(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function iu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(iu(e,t,n),e=e.sibling;null!==e;)iu(e,t,n),e=e.sibling}function ou(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(ou(e,t,n),e=e.sibling;null!==e;)ou(e,t,n),e=e.sibling}var su=null,uu=!1;function cu(e,t,n){for(n=n.child;null!==n;)lu(e,t,n),n=n.sibling}function lu(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(at,n)}catch(s){}switch(n.tag){case 5:Ks||Qs(n,t);case 6:var r=su,a=uu;su=null,cu(e,t,n),uu=a,null!==(su=r)&&(uu?(e=su,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):su.removeChild(n.stateNode));break;case 18:null!==su&&(uu?(e=su,n=n.stateNode,8===e.nodeType?ua(e.parentNode,n):1===e.nodeType&&ua(e,n),qt(e)):ua(su,n.stateNode));break;case 4:r=su,a=uu,su=n.stateNode.containerInfo,uu=!0,cu(e,t,n),su=r,uu=a;break;case 0:case 11:case 14:case 15:if(!Ks&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var i=a,o=i.destroy;i=i.tag,void 0!==o&&(0!==(2&i)||0!==(4&i))&&$s(n,t,o),a=a.next}while(a!==r)}cu(e,t,n);break;case 1:if(!Ks&&(Qs(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){_c(n,t,s)}cu(e,t,n);break;case 21:cu(e,t,n);break;case 22:1&n.mode?(Ks=(r=Ks)||null!==n.memoizedState,cu(e,t,n),Ks=r):cu(e,t,n);break;default:cu(e,t,n)}}function hu(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Xs),t.forEach((function(t){var r=Ec.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function fu(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var o=e,s=t,u=s;e:for(;null!==u;){switch(u.tag){case 5:su=u.stateNode,uu=!1;break e;case 3:case 4:su=u.stateNode.containerInfo,uu=!0;break e}u=u.return}if(null===su)throw Error(i(160));lu(o,s,a),su=null,uu=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(l){_c(a,t,l)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)pu(t,e),t=t.sibling}function pu(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(fu(t,e),du(e),4&r){try{Zs(3,e,e.return),eu(3,e)}catch(m){_c(e,e.return,m)}try{Zs(5,e,e.return)}catch(m){_c(e,e.return,m)}}break;case 1:fu(t,e),du(e),512&r&&null!==n&&Qs(n,n.return);break;case 5:if(fu(t,e),du(e),512&r&&null!==n&&Qs(n,n.return),32&e.flags){var a=e.stateNode;try{fe(a,"")}catch(m){_c(e,e.return,m)}}if(4&r&&null!=(a=e.stateNode)){var o=e.memoizedProps,s=null!==n?n.memoizedProps:o,u=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===u&&"radio"===o.type&&null!=o.name&&$(a,o),be(u,s);var l=be(u,o);for(s=0;s<c.length;s+=2){var h=c[s],f=c[s+1];"style"===h?ve(a,f):"dangerouslySetInnerHTML"===h?he(a,f):"children"===h?fe(a,f):b(a,h,f,l)}switch(u){case"input":J(a,o);break;case"textarea":ie(a,o);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var d=o.value;null!=d?ne(a,!!o.multiple,d,!1):p!==!!o.multiple&&(null!=o.defaultValue?ne(a,!!o.multiple,o.defaultValue,!0):ne(a,!!o.multiple,o.multiple?[]:"",!1))}a[pa]=o}catch(m){_c(e,e.return,m)}}break;case 6:if(fu(t,e),du(e),4&r){if(null===e.stateNode)throw Error(i(162));l=e.stateNode,h=e.memoizedProps;try{l.nodeValue=h}catch(m){_c(e,e.return,m)}}break;case 3:if(fu(t,e),du(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{qt(t.containerInfo)}catch(m){_c(e,e.return,m)}break;case 4:default:fu(t,e),du(e);break;case 13:fu(t,e),du(e),8192&(l=e.child).flags&&null!==l.memoizedState&&(null===l.alternate||null===l.alternate.memoizedState)&&(zu=$e()),4&r&&hu(e);break;case 22:if(l=null!==n&&null!==n.memoizedState,1&e.mode?(Ks=(h=Ks)||l,fu(t,e),Ks=h):fu(t,e),du(e),8192&r){h=null!==e.memoizedState;e:for(f=null,p=e;;){if(5===p.tag){if(null===f){f=p;try{a=p.stateNode,h?"function"===typeof(o=a.style).setProperty?o.setProperty("display","none","important"):o.display="none":(u=p.stateNode,s=void 0!==(c=p.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,u.style.display=me("display",s))}catch(m){_c(e,e.return,m)}}}else if(6===p.tag){if(null===f)try{p.stateNode.nodeValue=h?"":p.memoizedProps}catch(m){_c(e,e.return,m)}}else if((22!==p.tag&&23!==p.tag||null===p.memoizedState||p===e)&&null!==p.child){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;null===p.sibling;){if(null===p.return||p.return===e)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}if(h&&!l&&0!==(1&e.mode))for(Ys=e,e=e.child;null!==e;){for(l=Ys=e;null!==Ys;){switch(f=(h=Ys).child,h.tag){case 0:case 11:case 14:case 15:Zs(4,h,h.return);break;case 1:if(Qs(h,h.return),"function"===typeof(o=h.stateNode).componentWillUnmount){p=h,d=h.return;try{a=p,o.props=a.memoizedProps,o.state=a.memoizedState,o.componentWillUnmount()}catch(m){_c(p,d,m)}}break;case 5:Qs(h,h.return);break;case 22:if(null!==h.memoizedState){yu(l);continue}}null!==f?(f.return=h,Ys=f):yu(l)}e=e.sibling}}break;case 19:fu(t,e),du(e),4&r&&hu(e);case 21:}}function du(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ru(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(fe(a,""),r.flags&=-33),ou(e,au(e),a);break;case 3:case 4:var o=r.stateNode.containerInfo;iu(e,au(e),o);break;default:throw Error(i(161))}}catch(s){_c(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function mu(e,t,n){Ys=e,vu(e,t,n)}function vu(e,t,n){for(var r=0!==(1&e.mode);null!==Ys;){var a=Ys,i=a.child;if(22===a.tag&&r){var o=null!==a.memoizedState||Hs;if(!o){var s=a.alternate,u=null!==s&&null!==s.memoizedState||Ks;s=Hs;var c=Ks;if(Hs=o,(Ks=u)&&!c)for(Ys=a;null!==Ys;)u=(o=Ys).child,22===o.tag&&null!==o.memoizedState?bu(a):null!==u?(u.return=o,Ys=u):bu(a);for(;null!==i;)Ys=i,vu(i,t,n),i=i.sibling;Ys=a,Hs=s,Ks=c}gu(e)}else 0!==(8772&a.subtreeFlags)&&null!==i?(i.return=a,Ys=i):gu(e)}}function gu(e){for(;null!==Ys;){var t=Ys;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ks||eu(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Ks)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:Wa(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&ci(t,o,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}ci(t,s,n)}break;case 5:var u=t.stateNode;if(null===n&&4&t.flags){n=u;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:break;case 13:if(null===t.memoizedState){var l=t.alternate;if(null!==l){var h=l.memoizedState;if(null!==h){var f=h.dehydrated;null!==f&&qt(f)}}}break;default:throw Error(i(163))}Ks||512&t.flags&&tu(t)}catch(p){_c(t,t.return,p)}}if(t===e){Ys=null;break}if(null!==(n=t.sibling)){n.return=t.return,Ys=n;break}Ys=t.return}}function yu(e){for(;null!==Ys;){var t=Ys;if(t===e){Ys=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Ys=n;break}Ys=t.return}}function bu(e){for(;null!==Ys;){var t=Ys;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{eu(4,t)}catch(u){_c(t,n,u)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(u){_c(t,a,u)}}var i=t.return;try{tu(t)}catch(u){_c(t,i,u)}break;case 5:var o=t.return;try{tu(t)}catch(u){_c(t,o,u)}}}catch(u){_c(t,t.return,u)}if(t===e){Ys=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Ys=s;break}Ys=t.return}}var ku,xu=Math.ceil,wu=k.ReactCurrentDispatcher,_u=k.ReactCurrentOwner,Su=k.ReactCurrentBatchConfig,Cu=0,Tu=null,Eu=null,Iu=0,Au=0,Nu=Sa(0),Pu=0,Mu=null,Du=0,Ru=0,Ou=0,Fu=null,Lu=null,zu=0,Bu=1/0,Vu=null,ju=!1,qu=null,Gu=null,Wu=!1,Uu=null,Hu=0,Ku=0,Xu=null,Yu=-1,Qu=0;function $u(){return 0!==(6&Cu)?$e():-1!==Yu?Yu:Yu=$e()}function Ju(e){return 0===(1&e.mode)?1:0!==(2&Cu)&&0!==Iu?Iu&-Iu:null!==Ga.transition?(0===Qu&&(Qu=mt()),Qu):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Qt(e.type)}function Zu(e,t,n){if(50<Ku)throw Ku=0,Xu=null,Error(i(185));var r=ec(e,t);return null===r?null:(gt(r,t,n),0!==(2&Cu)&&r===Tu||(r===Tu&&(0===(2&Cu)&&(Ru|=t),4===Pu&&oc(r,Iu)),nc(r,n),1===t&&0===Cu&&0===(1&e.mode)&&(Bu=$e()+500,Ba&&qa())),r)}function ec(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function tc(e){return(null!==Tu||null!==ei)&&0!==(1&e.mode)&&0===(2&Cu)}function nc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-ot(i),s=1<<o,u=a[o];-1===u?0!==(s&n)&&0===(s&r)||(a[o]=pt(s,t)):u<=t&&(e.expiredLanes|=s),i&=~s}}(e,t);var r=ft(e,e===Tu?Iu:0);if(0===r)null!==n&&Xe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Xe(n),1===t)0===e.tag?function(e){Ba=!0,ja(e)}(sc.bind(null,e)):ja(sc.bind(null,e)),oa((function(){0===Cu&&qa()})),n=null;else{switch(kt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Ic(n,rc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function rc(e,t){if(Yu=-1,Qu=0,0!==(6&Cu))throw Error(i(327));var n=e.callbackNode;if(xc()&&e.callbackNode!==n)return null;var r=ft(e,e===Tu?Iu:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=mc(e,r);else{t=r;var a=Cu;Cu|=2;var o=pc();for(Tu===e&&Iu===t||(Vu=null,Bu=$e()+500,hc(e,t));;)try{gc();break}catch(u){fc(e,u)}Ya(),wu.current=o,Cu=a,null!==Eu?t=0:(Tu=null,Iu=0,t=Pu)}if(0!==t){if(2===t&&(0!==(a=dt(e))&&(r=a,t=ac(e,a))),1===t)throw n=Mu,hc(e,0),oc(e,r),nc(e,$e()),n;if(6===t)oc(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!sr(i(),a))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=mc(e,r))&&(0!==(o=dt(e))&&(r=o,t=ac(e,o))),1===t))throw n=Mu,hc(e,0),oc(e,r),nc(e,$e()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:kc(e,Lu,Vu);break;case 3:if(oc(e,r),(130023424&r)===r&&10<(t=zu+500-$e())){if(0!==ft(e,0))break;if(((a=e.suspendedLanes)&r)!==r){$u(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ra(kc.bind(null,e,Lu,Vu),t);break}kc(e,Lu,Vu);break;case 4:if(oc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var s=31-ot(r);o=1<<s,(s=t[s])>a&&(a=s),r&=~o}if(r=a,10<(r=(120>(r=$e()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*xu(r/1960))-r)){e.timeoutHandle=ra(kc.bind(null,e,Lu,Vu),r);break}kc(e,Lu,Vu);break;default:throw Error(i(329))}}}return nc(e,$e()),e.callbackNode===n?rc.bind(null,e):null}function ac(e,t){var n=Fu;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=mc(e,t))&&(t=Lu,Lu=n,null!==t&&ic(t)),e}function ic(e){null===Lu?Lu=e:Lu.push.apply(Lu,e)}function oc(e,t){for(t&=~Ou,t&=~Ru,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function sc(e){if(0!==(6&Cu))throw Error(i(327));xc();var t=ft(e,0);if(0===(1&t))return nc(e,$e()),null;var n=mc(e,t);if(0!==e.tag&&2===n){var r=dt(e);0!==r&&(t=r,n=ac(e,r))}if(1===n)throw n=Mu,hc(e,0),oc(e,t),nc(e,$e()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,kc(e,Lu,Vu),nc(e,$e()),null}function uc(e,t){var n=Cu;Cu|=1;try{return e(t)}finally{0===(Cu=n)&&(Bu=$e()+500,Ba&&qa())}}function cc(e){null!==Uu&&0===Uu.tag&&0===(6&Cu)&&xc();var t=Cu;Cu|=1;var n=Su.transition,r=bt;try{if(Su.transition=null,bt=1,e)return e()}finally{bt=r,Su.transition=n,0===(6&(Cu=t))&&qa()}}function lc(){Au=Nu.current,Ca(Nu)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,aa(n)),null!==Eu)for(n=Eu.return;null!==n;){var r=n;switch(Ai(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Da();break;case 3:eo(),Ca(Aa),Ca(Ia),oo();break;case 5:no(r);break;case 4:eo();break;case 13:case 19:Ca(ro);break;case 10:Qa(r.type._context);break;case 22:case 23:lc()}n=n.return}if(Tu=e,Eu=e=Mc(e.current,null),Iu=Au=t,Pu=0,Mu=null,Ou=Ru=Du=0,Lu=Fu=null,null!==ei){for(t=0;t<ei.length;t++)if(null!==(r=(n=ei[t]).interleaved)){n.interleaved=null;var a=r.next,i=n.pending;if(null!==i){var o=i.next;i.next=a,r.next=o}n.pending=r}ei=null}return e}function fc(e,t){for(;;){var n=Eu;try{if(Ya(),so.current=ns,po){for(var r=lo.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}po=!1}if(co=0,fo=ho=lo=null,mo=!1,vo=0,_u.current=null,null===n||null===n.return){Pu=1,Mu=t,Eu=null;break}e:{var o=e,s=n.return,u=n,c=t;if(t=Iu,u.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var l=c,h=u,f=h.tag;if(0===(1&h.mode)&&(0===f||11===f||15===f)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var d=ms(s);if(null!==d){d.flags&=-257,vs(d,s,u,0,t),1&d.mode&&ds(o,l,t),c=l;var m=(t=d).updateQueue;if(null===m){var v=new Set;v.add(c),t.updateQueue=v}else m.add(c);break e}if(0===(1&t)){ds(o,l,t),dc();break e}c=Error(i(426))}else if(Mi&&1&u.mode){var g=ms(s);if(null!==g){0===(65536&g.flags)&&(g.flags|=256),vs(g,s,u,0,t),ji(c);break e}}o=c,4!==Pu&&(Pu=2),null===Fu?Fu=[o]:Fu.push(o),c=os(c,u),u=s;do{switch(u.tag){case 3:u.flags|=65536,t&=-t,u.lanes|=t,si(u,fs(0,c,t));break e;case 1:o=c;var y=u.type,b=u.stateNode;if(0===(128&u.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Gu||!Gu.has(b)))){u.flags|=65536,t&=-t,u.lanes|=t,si(u,ps(u,o,t));break e}}u=u.return}while(null!==u)}bc(n)}catch(k){t=k,Eu===n&&null!==n&&(Eu=n=n.return);continue}break}}function pc(){var e=wu.current;return wu.current=ns,null===e?ns:e}function dc(){0!==Pu&&3!==Pu&&2!==Pu||(Pu=4),null===Tu||0===(268435455&Du)&&0===(268435455&Ru)||oc(Tu,Iu)}function mc(e,t){var n=Cu;Cu|=2;var r=pc();for(Tu===e&&Iu===t||(Vu=null,hc(e,t));;)try{vc();break}catch(a){fc(e,a)}if(Ya(),Cu=n,wu.current=r,null!==Eu)throw Error(i(261));return Tu=null,Iu=0,Pu}function vc(){for(;null!==Eu;)yc(Eu)}function gc(){for(;null!==Eu&&!Ye();)yc(Eu)}function yc(e){var t=ku(e.alternate,e,Au);e.memoizedProps=e.pendingProps,null===t?bc(e):Eu=t,_u.current=null}function bc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=bs(n,t,Au)))return void(Eu=n)}else{if(null!==(n=Us(n,t)))return n.flags&=32767,void(Eu=n);if(null===e)return Pu=6,void(Eu=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Eu=t);Eu=t=e}while(null!==t);0===Pu&&(Pu=5)}function kc(e,t,n){var r=bt,a=Su.transition;try{Su.transition=null,bt=1,function(e,t,n,r){do{xc()}while(null!==Uu);if(0!==(6&Cu))throw Error(i(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-ot(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}(e,o),e===Tu&&(Eu=Tu=null,Iu=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Wu||(Wu=!0,Ic(tt,(function(){return xc(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Su.transition,Su.transition=null;var s=bt;bt=1;var u=Cu;Cu|=4,_u.current=null,function(e,t){if(ea=Wt,pr(e=fr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(w){n=null;break e}var s=0,u=-1,c=-1,l=0,h=0,f=e,p=null;t:for(;;){for(var d;f!==n||0!==a&&3!==f.nodeType||(u=s+a),f!==o||0!==r&&3!==f.nodeType||(c=s+r),3===f.nodeType&&(s+=f.nodeValue.length),null!==(d=f.firstChild);)p=f,f=d;for(;;){if(f===e)break t;if(p===n&&++l===a&&(u=s),p===o&&++h===r&&(c=s),null!==(d=f.nextSibling))break;p=(f=p).parentNode}f=d}n=-1===u||-1===c?null:{start:u,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ta={focusedElem:e,selectionRange:n},Wt=!1,Ys=t;null!==Ys;)if(e=(t=Ys).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Ys=e;else for(;null!==Ys;){t=Ys;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var v=m.memoizedProps,g=m.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?v:Wa(t.type,v),g);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var k=t.stateNode.containerInfo;if(1===k.nodeType)k.textContent="";else if(9===k.nodeType){var x=k.body;null!=x&&(x.textContent="")}break;default:throw Error(i(163))}}catch(w){_c(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Ys=e;break}Ys=t.return}m=Js,Js=!1}(e,n),pu(n,e),dr(ta),Wt=!!ea,ta=ea=null,e.current=n,mu(n,e,a),Qe(),Cu=u,bt=s,Su.transition=o}else e.current=n;if(Wu&&(Wu=!1,Uu=e,Hu=a),0===(o=e.pendingLanes)&&(Gu=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),nc(e,$e()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)r(t[n]);if(ju)throw ju=!1,e=qu,qu=null,e;0!==(1&Hu)&&0!==e.tag&&xc(),0!==(1&(o=e.pendingLanes))?e===Xu?Ku++:(Ku=0,Xu=e):Ku=0,qa()}(e,t,n,r)}finally{Su.transition=a,bt=r}return null}function xc(){if(null!==Uu){var e=kt(Hu),t=Su.transition,n=bt;try{if(Su.transition=null,bt=16>e?16:e,null===Uu)var r=!1;else{if(e=Uu,Uu=null,Hu=0,0!==(6&Cu))throw Error(i(331));var a=Cu;for(Cu|=4,Ys=e.current;null!==Ys;){var o=Ys,s=o.child;if(0!==(16&Ys.flags)){var u=o.deletions;if(null!==u){for(var c=0;c<u.length;c++){var l=u[c];for(Ys=l;null!==Ys;){var h=Ys;switch(h.tag){case 0:case 11:case 15:Zs(8,h,o)}var f=h.child;if(null!==f)f.return=h,Ys=f;else for(;null!==Ys;){var p=(h=Ys).sibling,d=h.return;if(nu(h),h===l){Ys=null;break}if(null!==p){p.return=d,Ys=p;break}Ys=d}}}var m=o.alternate;if(null!==m){var v=m.child;if(null!==v){m.child=null;do{var g=v.sibling;v.sibling=null,v=g}while(null!==v)}}Ys=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,Ys=s;else e:for(;null!==Ys;){if(0!==(2048&(o=Ys).flags))switch(o.tag){case 0:case 11:case 15:Zs(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,Ys=y;break e}Ys=o.return}}var b=e.current;for(Ys=b;null!==Ys;){var k=(s=Ys).child;if(0!==(2064&s.subtreeFlags)&&null!==k)k.return=s,Ys=k;else e:for(s=b;null!==Ys;){if(0!==(2048&(u=Ys).flags))try{switch(u.tag){case 0:case 11:case 15:eu(9,u)}}catch(w){_c(u,u.return,w)}if(u===s){Ys=null;break e}var x=u.sibling;if(null!==x){x.return=u.return,Ys=x;break e}Ys=u.return}}if(Cu=a,qa(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(at,e)}catch(w){}r=!0}return r}finally{bt=n,Su.transition=t}}return!1}function wc(e,t,n){ii(e,t=fs(0,t=os(n,t),1)),t=$u(),null!==(e=ec(e,1))&&(gt(e,1,t),nc(e,t))}function _c(e,t,n){if(3===e.tag)wc(e,e,n);else for(;null!==t;){if(3===t.tag){wc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Gu||!Gu.has(r))){ii(t,e=ps(t,e=os(n,e),1)),e=$u(),null!==(t=ec(t,1))&&(gt(t,1,e),nc(t,e));break}}t=t.return}}function Sc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=$u(),e.pingedLanes|=e.suspendedLanes&n,Tu===e&&(Iu&n)===n&&(4===Pu||3===Pu&&(130023424&Iu)===Iu&&500>$e()-zu?hc(e,0):Ou|=n),nc(e,t)}function Cc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=lt,0===(130023424&(lt<<=1))&&(lt=4194304)));var n=$u();null!==(e=ec(e,t))&&(gt(e,t,n),nc(e,n))}function Tc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Cc(e,n)}function Ec(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),Cc(e,n)}function Ic(e,t){return Ke(e,t)}function Ac(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nc(e,t,n,r){return new Ac(e,t,n,r)}function Pc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Mc(e,t){var n=e.alternate;return null===n?((n=Nc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Dc(e,t,n,r,a,o){var s=2;if(r=e,"function"===typeof e)Pc(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case _:return Rc(n.children,a,o,t);case S:s=8,a|=8;break;case C:return(e=Nc(12,n,t,2|a)).elementType=C,e.lanes=o,e;case A:return(e=Nc(13,n,t,a)).elementType=A,e.lanes=o,e;case N:return(e=Nc(19,n,t,a)).elementType=N,e.lanes=o,e;case D:return Oc(n,a,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case T:s=10;break e;case E:s=9;break e;case I:s=11;break e;case P:s=14;break e;case M:s=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Nc(s,n,t,a)).elementType=e,t.type=r,t.lanes=o,t}function Rc(e,t,n,r){return(e=Nc(7,e,r,t)).lanes=n,e}function Oc(e,t,n,r){return(e=Nc(22,e,r,t)).elementType=D,e.lanes=n,e.stateNode={},e}function Fc(e,t,n){return(e=Nc(6,e,null,t)).lanes=n,e}function Lc(e,t,n){return(t=Nc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zc(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vt(0),this.expirationTimes=vt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vt(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Bc(e,t,n,r,a,i,o,s,u){return e=new zc(e,t,n,s,u),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Nc(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ni(i),e}function Vc(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function jc(e){if(!e)return Ea;e:{if(qe(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ma(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Ma(n))return Oa(e,n,t)}return t}function qc(e,t,n,r,a,i,o,s,u){return(e=Bc(n,r,!0,e,0,i,0,s,u)).context=jc(null),n=e.current,(i=ai(r=$u(),a=Ju(n))).callback=void 0!==t&&null!==t?t:null,ii(n,i),e.current.lanes=a,gt(e,a,r),nc(e,r),e}function Gc(e,t,n,r){var a=t.current,i=$u(),o=Ju(a);return n=jc(n),null===t.context?t.context=n:t.pendingContext=n,(t=ai(i,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),ii(a,t),null!==(e=Zu(a,o,i))&&oi(e,a,o),o}function Wc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Uc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Hc(e,t){Uc(e,t),(e=e.alternate)&&Uc(e,t)}ku=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Aa.current)xs=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return xs=!1,function(e,t,n){switch(t.tag){case 3:Ps(t),Vi();break;case 5:to(t);break;case 1:Ma(t.type)&&Fa(t);break;case 4:Zi(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Ta(Ua,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ta(ro,1&ro.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Fs(e,t,n):(Ta(ro,1&ro.current),null!==(e=Ws(e,t,n))?e.sibling:null);Ta(ro,1&ro.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Gs(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ta(ro,ro.current),r)break;return null;case 22:case 23:return t.lanes=0,Ts(e,t,n)}return Ws(e,t,n)}(e,t,n);xs=0!==(131072&e.flags)}else xs=!1,Mi&&0!==(1048576&t.flags)&&Ei(t,ki,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps;var a=Pa(t,Ia.current);Ja(t,n),a=ko(null,t,r,e,a,n);var o=xo();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ma(r)?(o=!0,Fa(t)):o=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,ni(t),a.updater=fi,t.stateNode=a,a._reactInternals=t,vi(t,r,e,n),t=Ns(null,t,r,!0,o,n)):(t.tag=0,Mi&&o&&Ii(t),ws(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"===typeof e)return Pc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===I)return 11;if(e===P)return 14}return 2}(r),e=Wa(r,e),a){case 0:t=Is(null,t,r,e,n);break e;case 1:t=As(null,t,r,e,n);break e;case 11:t=_s(null,t,r,e,n);break e;case 14:t=Ss(null,t,r,Wa(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,Is(e,t,r,a=t.elementType===r?a:Wa(r,a),n);case 1:return r=t.type,a=t.pendingProps,As(e,t,r,a=t.elementType===r?a:Wa(r,a),n);case 3:e:{if(Ps(t),null===e)throw Error(i(387));r=t.pendingProps,a=(o=t.memoizedState).element,ri(e,t),ui(t,r,null,n);var s=t.memoizedState;if(r=s.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Ms(e,t,r,n,a=Error(i(423)));break e}if(r!==a){t=Ms(e,t,r,n,a=Error(i(424)));break e}for(Pi=ca(t.stateNode.containerInfo.firstChild),Ni=t,Mi=!0,Di=null,n=Ki(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(Vi(),r===a){t=Ws(e,t,n);break e}ws(e,t,r,n)}t=t.child}return t;case 5:return to(t),null===e&&Li(t),r=t.type,a=t.pendingProps,o=null!==e?e.memoizedProps:null,s=a.children,na(r,a)?s=null:null!==o&&na(r,o)&&(t.flags|=32),Es(e,t),ws(e,t,s,n),t.child;case 6:return null===e&&Li(t),null;case 13:return Fs(e,t,n);case 4:return Zi(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Hi(t,null,r,n):ws(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,_s(e,t,r,a=t.elementType===r?a:Wa(r,a),n);case 7:return ws(e,t,t.pendingProps,n),t.child;case 8:case 12:return ws(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,o=t.memoizedProps,s=a.value,Ta(Ua,r._currentValue),r._currentValue=s,null!==o)if(sr(o.value,s)){if(o.children===a.children&&!Aa.current){t=Ws(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var u=o.dependencies;if(null!==u){s=o.child;for(var c=u.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=ai(-1,n&-n)).tag=2;var l=o.updateQueue;if(null!==l){var h=(l=l.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),l.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),$a(o.return,n,t),u.lanes|=n;break}c=c.next}}else if(10===o.tag)s=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(i(341));s.lanes|=n,null!==(u=s.alternate)&&(u.lanes|=n),$a(s,n,t),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===t){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}ws(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Ja(t,n),r=r(a=Za(a)),t.flags|=1,ws(e,t,r,n),t.child;case 14:return a=Wa(r=t.type,t.pendingProps),Ss(e,t,r,a=Wa(r.type,a),n);case 15:return Cs(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:Wa(r,a),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,Ma(r)?(e=!0,Fa(t)):e=!1,Ja(t,n),di(t,r,a),vi(t,r,a,n),Ns(null,t,r,!0,e,n);case 19:return Gs(e,t,n);case 22:return Ts(e,t,n)}throw Error(i(156,t.tag))};var Kc="function"===typeof reportError?reportError:function(e){console.error(e)};function Xc(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Qc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function $c(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Jc(){}function Zc(e,t,n,r,a){var i=n._reactRootContainer;if(i){var o=i;if("function"===typeof a){var s=a;a=function(){var e=Wc(o);s.call(e)}}Gc(t,o,e,a)}else o=function(e,t,n,r,a){if(a){if("function"===typeof r){var i=r;r=function(){var e=Wc(o);i.call(e)}}var o=qc(t,r,e,0,null,!1,0,"",Jc);return e._reactRootContainer=o,e[da]=o.current,qr(8===e.nodeType?e.parentNode:e),cc(),o}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var s=r;r=function(){var e=Wc(u);s.call(e)}}var u=Bc(e,0,!1,null,0,!1,0,"",Jc);return e._reactRootContainer=u,e[da]=u.current,qr(8===e.nodeType?e.parentNode:e),cc((function(){Gc(t,u,n,r)})),u}(n,t,e,a,r);return Wc(o)}Yc.prototype.render=Xc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Gc(e,t,null,null)},Yc.prototype.unmount=Xc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;cc((function(){Gc(null,e,null,null)})),t[da]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&Lt(e)}},xt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(yt(t,1|n),nc(t,$e()),0===(6&Cu)&&(Bu=$e()+500,qa()))}break;case 13:var r=$u();cc((function(){return Zu(e,1,r)})),Hc(e,1)}},wt=function(e){13===e.tag&&(Zu(e,134217728,$u()),Hc(e,134217728))},_t=function(e){if(13===e.tag){var t=$u(),n=Ju(e);Zu(e,n,t),Hc(e,n)}},St=function(){return bt},Ct=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},we=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=xa(r);if(!a)throw Error(i(90));K(r),J(r,a)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ie=uc,Ae=cc;var el={usingClientEntryPoint:!1,Events:[ba,ka,xa,Te,Ee,uc]},tl={findFiberByHostInstance:ya,bundleType:0,version:"18.1.0",rendererPackageName:"react-dom"},nl={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:k.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ue(e))?null:e.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.1.0-next-22edb9f77-20220426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var rl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rl.isDisabled&&rl.supportsFiber)try{at=rl.inject(nl),it=rl}catch(le){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=el,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Qc(t))throw Error(i(200));return Vc(e,t,null,n)},t.createRoot=function(e,t){if(!Qc(e))throw Error(i(299));var n=!1,r="",a=Kc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=Bc(e,1,!1,null,0,n,0,r,a),e[da]=t.current,qr(8===e.nodeType?e.parentNode:e),new Xc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=Ue(t))?null:e.stateNode},t.flushSync=function(e){return cc(e)},t.hydrate=function(e,t,n){if(!$c(t))throw Error(i(200));return Zc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Qc(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,a=!1,o="",s=Kc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=qc(t,null,e,1,null!=n?n:null,a,0,o,s),e[da]=t.current,qr(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Yc(t)},t.render=function(e,t,n){if(!$c(t))throw Error(i(200));return Zc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!$c(e))throw Error(i(40));return!!e._reactRootContainer&&(cc((function(){Zc(null,null,e,!1,(function(){e._reactRootContainer=null,e[da]=null}))})),!0)},t.unstable_batchedUpdates=uc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!$c(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return Zc(e,t,n,!1,r)},t.version="18.1.0-next-22edb9f77-20220426"},1250:function(e,t,n){"use strict";var r=n(4164);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},4164:function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4463)},7780:function(e,t,n){"use strict";var r=f(n(2836)),a=f(n(3415)),i=f(n(5053)),o=f(n(2749)),s=f(n(4976)),u=f(n(2455)),c=f(n(2791)),l=f(n(2007)),h=f(n(7625));function f(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(){var e,n,r,o;(0,i.default)(this,t);for(var u=arguments.length,c=Array(u),l=0;l<u;l++)c[l]=arguments[l];return n=r=(0,s.default)(this,(e=t.__proto__||(0,a.default)(t)).call.apply(e,[this].concat(c))),r.handleClickToPause=function(){r.anim.isPaused?r.anim.play():r.anim.pause()},o=n,(0,s.default)(r,o)}return(0,u.default)(t,e),(0,o.default)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.options,n=e.eventListeners,a=t.loop,i=t.autoplay,o=t.animationData,s=t.rendererSettings,u=t.segments;this.options={container:this.el,renderer:"svg",loop:!1!==a,autoplay:!1!==i,segments:!1!==u,animationData:o,rendererSettings:s},this.options=(0,r.default)({},this.options,t),this.anim=h.default.loadAnimation(this.options),this.registerEvents(n)}},{key:"componentWillUpdate",value:function(e){this.options.animationData!==e.options.animationData&&(this.deRegisterEvents(this.props.eventListeners),this.destroy(),this.options=(0,r.default)({},this.options,e.options),this.anim=h.default.loadAnimation(this.options),this.registerEvents(e.eventListeners))}},{key:"componentDidUpdate",value:function(){this.props.isStopped?this.stop():this.props.segments?this.playSegments():this.play(),this.pause(),this.setSpeed(),this.setDirection()}},{key:"componentWillUnmount",value:function(){this.deRegisterEvents(this.props.eventListeners),this.destroy(),this.options.animationData=null,this.anim=null}},{key:"setSpeed",value:function(){this.anim.setSpeed(this.props.speed)}},{key:"setDirection",value:function(){this.anim.setDirection(this.props.direction)}},{key:"play",value:function(){this.anim.play()}},{key:"playSegments",value:function(){this.anim.playSegments(this.props.segments)}},{key:"stop",value:function(){this.anim.stop()}},{key:"pause",value:function(){(this.props.isPaused&&!this.anim.isPaused||!this.props.isPaused&&this.anim.isPaused)&&this.anim.pause()}},{key:"destroy",value:function(){this.anim.destroy()}},{key:"registerEvents",value:function(e){var t=this;e.forEach((function(e){t.anim.addEventListener(e.eventName,e.callback)}))}},{key:"deRegisterEvents",value:function(e){var t=this;e.forEach((function(e){t.anim.removeEventListener(e.eventName,e.callback)}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.width,a=t.height,i=t.ariaRole,o=t.ariaLabel,s=t.isClickToPauseDisabled,u=t.title,l=function(e){return"number"===typeof e?e+"px":e||"100%"},h=(0,r.default)({width:l(n),height:l(a),overflow:"hidden",margin:"0 auto",outline:"none"},this.props.style),f=s?function(){return null}:this.handleClickToPause;return c.default.createElement("div",{ref:function(t){e.el=t},style:h,onClick:f,title:u,role:i,"aria-label":o,tabIndex:"0"})}}]),t}(c.default.Component);p.propTypes={eventListeners:l.default.arrayOf(l.default.object),options:l.default.object.isRequired,height:l.default.oneOfType([l.default.string,l.default.number]),width:l.default.oneOfType([l.default.string,l.default.number]),isStopped:l.default.bool,isPaused:l.default.bool,speed:l.default.number,segments:l.default.arrayOf(l.default.number),direction:l.default.number,ariaRole:l.default.string,ariaLabel:l.default.string,isClickToPauseDisabled:l.default.bool,title:l.default.string},p.defaultProps={eventListeners:[],isStopped:!1,isPaused:!1,speed:1,ariaRole:"button",ariaLabel:"animation",isClickToPauseDisabled:!1,title:""}},6374:function(e,t,n){"use strict";var r=n(2791),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,i={},c=null,l=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(l=t.ref),t)o.call(t,r)&&!u.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:a,type:e,key:c,ref:l,props:i,_owner:s.current}}t.jsx=c,t.jsxs=c},9117:function(e,t){"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.iterator;var d={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,v={};function g(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||d}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||d}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=g.prototype;var k=b.prototype=new y;k.constructor=b,m(k,g.prototype),k.isPureReactComponent=!0;var x=Array.isArray,w=Object.prototype.hasOwnProperty,_={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function C(e,t,r){var a,i={},o=null,s=null;if(null!=t)for(a in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)w.call(t,a)&&!S.hasOwnProperty(a)&&(i[a]=t[a]);var u=arguments.length-2;if(1===u)i.children=r;else if(1<u){for(var c=Array(u),l=0;l<u;l++)c[l]=arguments[l+2];i.children=c}if(e&&e.defaultProps)for(a in u=e.defaultProps)void 0===i[a]&&(i[a]=u[a]);return{$$typeof:n,type:e,key:o,ref:s,props:i,_owner:_.current}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var E=/\/+/g;function I(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function A(e,t,a,i,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0}}if(u)return o=o(u=e),e=""===i?"."+I(u,0):i,x(o)?(a="",null!=e&&(a=e.replace(E,"$&/")+"/"),A(o,t,a,"",(function(e){return e}))):null!=o&&(T(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,a+(!o.key||u&&u.key===o.key?"":(""+o.key).replace(E,"$&/")+"/")+e)),t.push(o)),1;if(u=0,i=""===i?".":i+":",x(e))for(var c=0;c<e.length;c++){var l=i+I(s=e[c],c);u+=A(s,t,a,l,o)}else if(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof l)for(e=l.call(e),c=0;!(s=e.next()).done;)u+=A(s=s.value,t,a,l=i+I(s,c++),o);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return u}function N(e,t,n){if(null==e)return e;var r=[],a=0;return A(e,r,"","",(function(e){return t.call(n,e,a++)})),r}function P(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var M={current:null},D={transition:null},R={ReactCurrentDispatcher:M,ReactCurrentBatchConfig:D,ReactCurrentOwner:_};t.Children={map:N,forEach:function(e,t,n){N(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return N(e,(function(){t++})),t},toArray:function(e){return N(e,(function(e){return e}))||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=g,t.Fragment=a,t.Profiler=o,t.PureComponent=b,t.StrictMode=i,t.Suspense=l,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=m({},e.props),i=e.key,o=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,s=_.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(c in t)w.call(t,c)&&!S.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==u?u[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){u=Array(c);for(var l=0;l<c;l++)u[l]=arguments[l+2];a.children=u}return{$$typeof:n,type:e.type,key:i,ref:o,props:a,_owner:s}},t.createContext=function(e){return(e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=C,t.createFactory=function(e){var t=C.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:f,_payload:{_status:-1,_result:e},_init:P}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return M.current.useCallback(e,t)},t.useContext=function(e){return M.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return M.current.useDeferredValue(e)},t.useEffect=function(e,t){return M.current.useEffect(e,t)},t.useId=function(){return M.current.useId()},t.useImperativeHandle=function(e,t,n){return M.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return M.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return M.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return M.current.useMemo(e,t)},t.useReducer=function(e,t,n){return M.current.useReducer(e,t,n)},t.useRef=function(e){return M.current.useRef(e)},t.useState=function(e){return M.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return M.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return M.current.useTransition()},t.version="18.1.0"},2791:function(e,t,n){"use strict";e.exports=n(9117)},184:function(e,t,n){"use strict";e.exports=n(6374)},6813:function(e,t){"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<i(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,o=a>>>1;r<o;){var s=2*(r+1)-1,u=e[s],c=s+1,l=e[c];if(0>i(u,n))c<a&&0>i(l,u)?(e[r]=l,e[c]=n,r=c):(e[r]=u,e[s]=n,r=s);else{if(!(c<a&&0>i(l,n)))break e;e[r]=l,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,u=s.now();t.unstable_now=function(){return s.now()-u}}var c=[],l=[],h=1,f=null,p=3,d=!1,m=!1,v=!1,g="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function k(e){for(var t=r(l);null!==t;){if(null===t.callback)a(l);else{if(!(t.startTime<=e))break;a(l),t.sortIndex=t.expirationTime,n(c,t)}t=r(l)}}function x(e){if(v=!1,k(e),!m)if(null!==r(c))m=!0,D(w);else{var t=r(l);null!==t&&R(x,t.startTime-e)}}function w(e,n){m=!1,v&&(v=!1,y(T),T=-1),d=!0;var i=p;try{for(k(n),f=r(c);null!==f&&(!(f.expirationTime>n)||e&&!A());){var o=f.callback;if("function"===typeof o){f.callback=null,p=f.priorityLevel;var s=o(f.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?f.callback=s:f===r(c)&&a(c),k(n)}else a(c);f=r(c)}if(null!==f)var u=!0;else{var h=r(l);null!==h&&R(x,h.startTime-n),u=!1}return u}finally{f=null,p=i,d=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var _,S=!1,C=null,T=-1,E=5,I=-1;function A(){return!(t.unstable_now()-I<E)}function N(){if(null!==C){var e=t.unstable_now();I=e;var n=!0;try{n=C(!0,e)}finally{n?_():(S=!1,C=null)}}else S=!1}if("function"===typeof b)_=function(){b(N)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,M=P.port2;P.port1.onmessage=N,_=function(){M.postMessage(null)}}else _=function(){g(N,0)};function D(e){C=e,S||(S=!0,_())}function R(e,n){T=g((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||d||(m=!0,D(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,a,i){var o=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?o+i:o:i=o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:h++,callback:a,priorityLevel:e,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>o?(e.sortIndex=i,n(l,e),null===r(c)&&e===r(l)&&(v?(y(T),T=-1):v=!0,R(x,i-o))):(e.sortIndex=s,n(c,e),m||d||(m=!0,D(w))),e},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},5296:function(e,t,n){"use strict";e.exports=n(6813)},6699:function(e,t,n){var r=n(2501),a=n(9112),i=n(2132),o=n(890),s=n(4113),u=n(1725),c=n(3411);c.alea=r,c.xor128=a,c.xorwow=i,c.xorshift7=o,c.xor4096=s,c.tychei=u,e.exports=c},2501:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n=function(){var e=4022871197;return function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)}}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function s(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function u(e,t){var n=new o(e),r=t&&t.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.alea=u}(0,e=n.nmd(e),n.amdD)},1725:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.tychei=u}(0,e=n.nmd(e),n.amdD)},9112:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xor128=u}(0,e=n.nmd(e),n.amdD)},4113:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,i=t.i;return t.w=r=r+1640531527|0,n=a[i+34&127],e=a[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=a[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,a,i,o,s=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),a=0,i=-32;i<u;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,a=0==(n=s[127&i]^=r+o)?a+1:0);for(a>=128&&(s[127&(t&&t.length||0)]=-1),a=127,i=512;i>0;--i)r=s[a+34&127],n=s[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[a]=r^n;e.w=o,e.X=s,e.i=a}(t,e)}function s(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.X&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xor4096=u}(0,e=n.nmd(e),n.amdD)},890:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],n=(e^=e>>>7)^e<<24,n^=(e=r[a+1&7])^e>>>10,n^=(e=r[a+3&7])^e>>>3,n^=(e=r[a+4&7])^e<<7,e=r[a+7&7],n^=(e^=e<<13)^e<<9,r[a]=n,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function s(e,t){return t.x=e.x.slice(),t.i=e.i,t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.x&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xorshift7=u}(0,e=n.nmd(e),n.amdD)},2132:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xorwow=u}(0,e=n.nmd(e),n.amdD)},3411:function(e,t,n){var r;!function(a,i){var o,s=(0,eval)("this"),u=256,c=i.pow(u,6),l=i.pow(2,52),h=2*l,f=255;function p(e,t,n){var r=[],f=g(v((t=1==t?{entropy:!0}:t||{}).entropy?[e,y(a)]:null==e?function(){try{var e;return o&&(e=o.randomBytes)?e=e(u):(e=new Uint8Array(u),(s.crypto||s.msCrypto).getRandomValues(e)),y(e)}catch(r){var t=s.navigator,n=t&&t.plugins;return[+new Date,s,n,s.screen,y(a)]}}():e,3),r),p=new d(r),b=function(){for(var e=p.g(6),t=c,n=0;e<l;)e=(e+n)*u,t*=u,n=p.g(1);for(;e>=h;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return 0|p.g(4)},b.quick=function(){return p.g(4)/4294967296},b.double=b,g(y(p.S),a),(t.pass||n||function(e,t,n,r){return r&&(r.S&&m(r,p),e.state=function(){return m(p,{})}),n?(i.random=e,t):e})(b,f,"global"in t?t.global:this==i,t.state)}function d(e){var t,n=e.length,r=this,a=0,i=r.i=r.j=0,o=r.S=[];for(n||(e=[n++]);a<u;)o[a]=a++;for(a=0;a<u;a++)o[a]=o[i=f&i+e[a%n]+(t=o[a])],o[i]=t;(r.g=function(e){for(var t,n=0,a=r.i,i=r.j,o=r.S;e--;)t=o[a=f&a+1],n=n*u+o[f&(o[a]=o[i=f&i+t])+(o[i]=t)];return r.i=a,r.j=i,n})(u)}function m(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function v(e,t){var n,r=[],a=typeof e;if(t&&"object"==a)for(n in e)try{r.push(v(e[n],t-1))}catch(i){}return r.length?r:"string"==a?e:e+"\0"}function g(e,t){for(var n,r=e+"",a=0;a<r.length;)t[f&a]=f&(n^=19*t[f&a])+r.charCodeAt(a++);return y(t)}function y(e){return String.fromCharCode.apply(0,e)}if(i.seedrandom=p,g(i.random(),a),e.exports){e.exports=p;try{o=n(5042)}catch(b){}}else void 0===(r=function(){return p}.call(t,n,t,e))||(e.exports=r)}([],Math)},6105:function(e,t,n){var r=n(4575).default,a=n(3913).default;self,e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t,n){"use strict";n.r(t),n.d(t,"SVGNS",(function(){return r})),n.d(t,"drawSVGPath",(function(){return a})),n.d(t,"drawSVGText",(function(){return i})),n.d(t,"createSVGGroupChild",(function(){return o})),n.d(t,"setFade",(function(){return s}));var r="http://www.w3.org/2000/svg";function a(e,t,n,a,i,o){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,u=document.createElementNS(r,"path");return u.setAttributeNS(null,"d",t),u.setAttributeNS(null,"transform","translate(".concat(n,", ").concat(a,") scale(").concat(i,", ").concat(o,")")),u.setAttributeNS(null,"opacity","".concat(s)),e.appendChild(u),u}function i(e,t,n,a,i){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,c=document.createElementNS(r,"text");c.setAttributeNS(null,"font-family","Times"),c.setAttributeNS(null,"font-size",i),o&&c.setAttributeNS(null,"font-weight","bold"),c.setAttributeNS(null,"transform","translate(".concat(n,", ").concat(a,") scale(").concat(s,", ").concat(u,")"));var l=document.createTextNode(t);return c.appendChild(l),e.appendChild(c),c}function o(e,t){var n=document.createElementNS(r,"g");return n.setAttribute("data-id",t),e.appendChild(n),n}function s(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=e.querySelector("animate");if(!i){(i=document.createElementNS(r,"animate")).setAttributeNS(null,"attributeName","opacity"),i.setAttributeNS(null,"dur","4s"),i.setAttributeNS(null,"fill","freeze"),i.setAttributeNS(null,"keyTimes","0; 0.25; 0.5; 0.75; 1");var o=(n+3*a)/4;i.setAttributeNS(null,"values","".concat(n,"; ").concat(o,"; ").concat(a,"; ").concat(o,"; ").concat(n))}return t?i.setAttributeNS(null,"repeatCount","indefinite"):i.setAttributeNS(null,"repeatCount","1"),e.appendChild(i),e}},function(e,t,n){"use strict";n.r(t),n.d(t,"PATH_SCALE",(function(){return r})),n.d(t,"staffLinePath",(function(){return i})),n.d(t,"extraLinePath",(function(){return o})),n.d(t,"barPath",(function(){return s})),n.d(t,"stemPath",(function(){return u})),n.d(t,"singleFlagPath",(function(){return c})),n.d(t,"multiFlagPath",(function(){return l})),n.d(t,"tiePath",(function(){return h})),n.d(t,"dotPath",(function(){return f})),n.d(t,"NOTE_PATHS",(function(){return p})),n.d(t,"REST_PATHS",(function(){return d})),n.d(t,"CLEF_PATHS",(function(){return m})),n.d(t,"ACCIDENTAL_PATHS",(function(){return v}));var r=100,a="M 0,10 C 0,-15 35,-50 80,-50 110,-50 125,-35 125,-10 \n125,15 90,50 45,50 15,50 0,35 0,10 Z",i="m 0,0 h 100",o="m -25,0 h 175",s="m 0,-200 v 400",u="m 0,0 v 100 h 15 v -100 z",c="M0,0 h 12 c 7,100 175,156 62,314 79,-177 -49,\n-193 -61,-200 l -13,-5 z",l="m 0,0 h 10 c 6,72 173,64 84,227 44,-120 -44,\n-123 -94,-167 z",h="M 0,25 C 10,46 30,67 50,67 69,67 90,47 100,25 94,\n65 73,89 50,89 26,89 5,63 0,25 Z",f="M 5 -20 a 20 20 0 1 0 0.00001 0 z",p={4:{path:"m 0,0 c 0,-37 49,-51 79,-51 31,0 83,13 83,51 0,39 \n-55,51 -84,51 C 49,51 0,37 0,0 Z m 111,31 c 13,-19 0,-58 -22,-68 -33,-15 \n-53,10 -39,49 9,27 48,39 61,19 z",width:150,stemVSteps:0,stemAnchor:0,flags:0},2:{path:"m 0,10 c 0,-25 35,-60 80,-60 15,0 45,4 45,40 C 125,16 \n89,50 45,50 17,50 0,36 0,10 Z m 71,7 c 17,-11 45,-34 38,-45 -7,-10 -39,1 \n-57,12 -19,11 -42,31 -36,42 6,10 37,2 55,-9 z",width:125,stemVSteps:7,stemAnchor:-10,flags:0},1:{path:a,width:125,stemVSteps:7,stemAnchor:-10,flags:0},.5:{path:a,width:125,stemVSteps:7,stemAnchor:-10,flags:1},.25:{path:a,width:125,stemVSteps:9,stemAnchor:-10,flags:2},.125:{path:a,width:125,stemVSteps:11,stemAnchor:-10,flags:3},.0625:{path:a,width:125,stemVSteps:13,stemAnchor:-10,flags:4}},d={4:"m 0,-50 h 125 v -50 H 0 Z",2:"M 0,0 H 125 V -50 H 0 Z",1:"m 0,-25 c 39,-39 37,-75 8,-120 l 6,-5 61,103 C \n40,-13 31,4 73,71 l -5,5 C 14,52 16,125 67,144 l -4,6 C -37,102 -1,22 59,60 Z",.5:"m 52,-47 c 26,-2 42,-21 48,-42 l 12,4 L 64,83 52,79 \n88,-49 c 0,0 -17,22 -57,22 -16,0 -31,-13 -31,-27 0,-18 10,-31 27,-31 17,0 \n33,15 25,38 z",.25:"m 129,-191 c -6,21 -22,40 -48,42 8,-23 -8,-38 \n-25,-38 -17,0 -27,13 -27,31 0,14 15,27 31,27 40,0 57,-22 57,-22 l -20,69 \nc -7,18 -22,33 -45,35 8,-23 -8,-38 -25,-38 -17,0 -27,13 -27,31 0,14 15,27 \n31,27 40,0 57,-22 57,-22 l -36,128 12,4 77,-270 z",.125:"m 129,-191 c -6,21 -22,40 -48,42 8,-23 -8,-38 \n-25,-38 -17,0 -27,13 -27,31 0,14 15,27 31,27 40,0 57,-22 57,-22 l -20,69 \nc -7,18 -22,33 -45,35 8,-23 -8,-38 -25,-38 -17,0 -27,13 -27,31 0,14 15,27 \n31,27 40,0 57,-22 57,-22 L 68,20 C 61,37 46,51 24,52 32,29 16,14 -1,14 c \n-17,0 -27,13 -27,31 0,14 15,27 31,27 38,0 55,-20 57,-22 l -36,128 12,4 \n105,-369 z",.0625:"m 158,-292 c -6,21 -22,40 -48,42 8,-23 -8,-38 \n-25,-38 -17,0 -27,13 -27,31 0,14 15,27 31,27 40,0 57,-22 57,-22 l -17,61 \nv 0 c -6,21 -22,40 -48,42 8,-23 -8,-38 -25,-38 -17,0 -27,13 -27,31 0,14 \n15,27 31,27 40,0 57,-22 57,-22 l -20,69 c -7,18 -22,33 -45,35 8,-23 -8,-38 \n-25,-38 -17,0 -27,13 -27,31 0,14 15,27 31,27 40,0 57,-22 57,-22 L 68,20 C \n61,37 46,51 24,52 32,29 16,14 -1,14 c -17,0 -27,13 -27,31 0,14 15,27 31,27 \n38,0 55,-20 57,-22 l -36,128 12,4 134,-469 z"},m={50:{path:"m 101,-199 c -49,0 -100,28 -100,83 0,39 58,57 82,26 15,-20 \n-4,-47 -32,-47 -23,1 -25,0 -25,-8 0,-22 40,-46 71,-41 91,16 67,208 -105,302 \n75,-27 198,-94 211,-201 6,-66 -42,-114 -102,-114 z m 143,33 c -13,0 -23,11 \n-23,24 0,14 10,24 23,24 13,0 23,-11 23,-24 0,-13 -10,-24 -23,-24 z m 2,83 c \n-13,0 -23,11 -23,24 0,14 10,24 23,24 13,0 23,-11 23,-24 0,-13 -10,-24 -23,-24 \nz",upper:-4,lower:3},71:{path:"M 139,48 C 102,57 76,120 131,151 41,128 64,24 129,2 L \n117,-57 C -32,47 26,217 166,182 Z m 12,-1 27,131 C 242,153 216,46 151,47 \nZ m -35,-177 c 34,-23 82,-117 50,-140 -23,-17 -71,33 -50,140 z m -10,10 c \n-23,-77 -20,-200 48,-213 19,-4 89,171 -26,266 l 13,66 c 120,-6 137,155 \n39,191 l 12,58 c 30,131 -137,145 -138,47 0,-29 37,-59 63,-37 21,18 25,71 \n-25,70 32,42 103,0 91,-65 L 167,193 C 56,232 -112,63 106,-120 Z",upper:-7,lower:8}},v=[null,"m -49,-121 v 52 l -29,9 v -48 h -8 v 51 l -20,6 v 29 l \n20,-6 v 70 l -20,6 v 30 l 20,-6 v 51 h 8 V 69 l 30,-8 v 50 h 8 V 58 l 20,-6 \nV 23 l -20,6 v -71 l 20,-6 v -29 l -20,6 v -50 z m 1,82 v 71 l -29,9 v -71 z","M -106,-166 V 67 c 52,-42 85,-56 85,-94 0,-47 -46,-51 \n-73,-22 v -117 z m 31,120 c 20,0 42,46 -20,91 V -7 c 0,-28 10,-39 20,-39 z","m -81,-58 v -48 H -92 V 73 l 60,-13 v 50 h 11 V -72 Z m \n50,24 v 58 l -50,11 v -58 z"]},function(e,t,n){"use strict";n.r(t),n.d(t,"MIN_RESOLUTION",(function(){return r})),n.d(t,"STEM_WIDTH",(function(){return a})),n.d(t,"LINE_STROKE",(function(){return i})),n.d(t,"COMPACT_SPACING",(function(){return o}));var r=.0625,a=15,i=1,o=150},function(e,t,n){"use strict";n.r(t),n.d(t,"MAX_QUARTER_DIVISION",(function(){return h})),n.d(t,"ScrollType",(function(){return i})),n.d(t,"StaffSVGRender",(function(){return f}));var i,o=n(2),s=n(0),u=n(1),c=[{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[0,1,0,1,0,0,1,0,1,0,1,0]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-6],accidental:[0,0,3,0,3,0,0,3,0,3,0,3]},{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[3,0,0,1,0,3,0,0,1,0,1,0]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-6],accidental:[0,2,0,0,3,0,2,0,0,3,0,3]},{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[3,0,3,0,0,3,0,3,0,0,1,0]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-6],accidental:[0,2,0,2,0,0,2,0,2,0,0,3]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-7],accidental:[3,0,3,0,3,0,0,3,0,3,0,0]},{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[0,1,0,1,0,3,0,0,1,0,1,0]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-6],accidental:[0,0,3,0,3,0,2,0,0,3,0,3]},{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[3,0,0,1,0,3,0,3,0,0,1,0]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-6],accidental:[0,2,0,0,3,0,2,0,2,0,0,3]},{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[3,0,3,0,0,3,0,3,0,3,0,0]}],l=[{accidental:1,pitches:[]},{accidental:2,pitches:[70,75,68,73,66]},{accidental:1,pitches:[78,73]},{accidental:2,pitches:[70,75,68]},{accidental:1,pitches:[78,73,80,75]},{accidental:2,pitches:[70]},{accidental:2,pitches:[70,75,68,73,66,71]},{accidental:1,pitches:[78]},{accidental:2,pitches:[70,75,68,73]},{accidental:1,pitches:[78,73,80]},{accidental:2,pitches:[70,75]},{accidental:1,pitches:[78,73,80,75,70]}],h=16;!function(e){e[e.PAGE=0]="PAGE",e[e.NOTE=1]="NOTE",e[e.BAR=2]="BAR"}(i||(i={}));var f=function(){function e(t,n,a){var s=this;r(this,e),this.handleScrollEvent=function(e){s.lastKnownScrollLeft=s.parentElement.scrollLeft,s.ticking||window.requestAnimationFrame((function(){s.changeAndDrawSignaturesIfNeeded(s.lastKnownScrollLeft),s.ticking=!1})),s.ticking=!0},this.scoreInfo=t,this.config={noteHeight:n.noteHeight||6,noteSpacing:n.noteSpacing||1,pixelsPerTimeStep:n.pixelsPerTimeStep||30,noteRGB:n.noteRGB||"8, 41, 64",activeNoteRGB:n.activeNoteRGB||"240, 84, 119"},this.div=a,this.timeSignatureNumerator=4,this.timeSignatureDenominator=4,this.key=n.defaultKey||0,this.scrollType=n.scrollType||i.PAGE,this.scale=this.config.noteHeight/u.PATH_SCALE,(void 0===n.pixelsPerTimeStep||n.pixelsPerTimeStep<=0)&&(this.config.pixelsPerTimeStep=0,this.config.noteSpacing=o.COMPACT_SPACING*this.scale),this.clear(),this.redraw()}return a(e,[{key:"clear",value:function(){for(;this.div.lastChild;)this.div.removeChild(this.div.lastChild);this.div.style.overflow="visible",this.div.style.position="relative",this.overlaySVG=document.createElementNS(s.SVGNS,"svg"),this.overlaySVG.style.position="absolute",this.div.appendChild(this.overlaySVG),this.overlayG=Object(s.createSVGGroupChild)(this.overlaySVG,"overlay"),this.signaturesBlinking=!1,this.signaturesQuarters=0,this.parentElement=document.createElement("div"),this.parentElement.style.overflow="auto",this.div.appendChild(this.parentElement),this.ticking=!1,this.lastKnownScrollLeft=0,this.parentElement.addEventListener("scroll",this.handleScrollEvent),this.staffSVG=document.createElementNS(s.SVGNS,"svg"),this.parentElement.appendChild(this.staffSVG),this.staffG=Object(s.createSVGGroupChild)(this.staffSVG,"staff"),this.linesG=Object(s.createSVGGroupChild)(this.staffSVG,"lines"),this.setStroke(this.linesG),this.staffG.appendChild(this.linesG),this.musicG=Object(s.createSVGGroupChild)(this.staffSVG,"music"),this.setFill(this.musicG),this.setStroke(this.musicG,0),this.staffG.appendChild(this.musicG),this.signaturesG=Object(s.createSVGGroupChild)(this.staffSVG,"signatures"),this.staffG.appendChild(this.signaturesG);var e=0,t=0;this.scoreInfo.notes.forEach((function(n){e+=n.pitch,++t}));var n=e/t;this.clef=n<60?50:71,this.signaturesList=[{x:0,q:0}],this.signatureCurrent=0,this.signatureNext=0,this.changeKeySignatureIfNeeded(0),this.changeTimeSignatureIfNeeded(0),this.vStepSize=this.config.noteHeight/2,this.hStepSize=this.config.pixelsPerTimeStep,this.staffOffset=0,this.height=0,this.width=0,this.musicBlockMap=new Map,this.playingNotes=[],this.lastBar=0,this.barAccidentals={},this.lastQ=-1}},{key:"isPaintingActiveNote",value:function(e,t){var n=e.start===t.start,r=e.start<=t.start&&e.start+e.length>=t.start+t.length;return n||r}},{key:"redraw",value:function(e,t){var n=this,r=-1,a=0===this.config.pixelsPerTimeStep;if(e){var o=[];this.playingNotes.forEach((function(t){n.isPaintingActiveNote(t,e)?o.push(t):n.highlightElement(n.getGroup(t),!1)})),this.playingNotes=o;var u=this.getGroup(e);if(u){this.playingNotes.push(e),this.highlightElement(u,!0),r=u.getBoundingClientRect().left-this.staffSVG.getBoundingClientRect().left;var c=e.start,l=u.getAttribute("data-is-bar-beginning");(this.scrollType!==i.BAR||l)&&this.scrollIntoViewIfNeeded(t,r),!a&&this.signaturesBlinking&&c>=this.signaturesQuarters&&(this.signaturesBlinking=!1,Object(s.setFade)(this.overlayG,this.signaturesBlinking))}}else{this.setDetails();var h=-1===this.lastQ,f=0,p=0;h?(p=this.drawSignatures(this.overlayG,f,!0,!0,!0),a&&(this.width=0,p+=this.config.noteSpacing),p+=this.drawRests(this.initialRest,f+p)):f=this.width,this.musicBlockMap.forEach((function(e,t){a||(f=n.quartersToTime(t)*n.hStepSize),t>n.lastQ?(p+=n.drawMusicBlock(e,f+p),n.lastQ=t):t===n.lastQ&&(p+=n.drawRests(e,f+p))}));var d=this.staffSVG.getBoundingClientRect(),m=this.musicG.getBoundingClientRect();if(this.updateVerticalBoundaries(m.top-d.top,m.bottom-d.top),a)this.width+=p;else{var v=this.musicBlockMap.get(this.lastQ),g=this.quartersToTime(this.lastQ+v.notes[0].length);this.width=g*this.config.pixelsPerTimeStep}this.staffSVG.setAttributeNS(null,"width","".concat(this.width)),this.redrawStaff(this.linesG,0,this.width)}return r}},{key:"drawMusicBlock",value:function(e,t){var n=this,r=e.notes[0].start,a=this.drawBarIfNeeded(r,t);a+=this.drawSignaturesIfNeeded(r,t+a);for(var i=0,c=4;c>=o.MIN_RESOLUTION&&!i;c/=2)c<=e.notes[0].length&&(i=c);if(0===i){var l=0===e.notes[0].length?"[infinite]":"".concat(4/e.notes[0].length);console.warn(" StaffRender ","background:orange; color:white","StaffRender does not handle notes shorther than "+"1/".concat(4/o.MIN_RESOLUTION,"th, and this score tries to draw a ")+"1/".concat(l,"th. Shortest possible note will be drawn instead.")),i=o.MIN_RESOLUTION}var h,f=u.NOTE_PATHS[i];if(f.stemAnchor&&(h=Object(s.createSVGGroupChild)(this.musicG,"stem")),e.notes.forEach((function(r){for(var o=r.vSteps*n.vStepSize,c=2*(r.vSteps>0?Math.floor(r.vSteps/2):Math.ceil(r.vSteps/2)),l=r.vSteps>0?-2:2,h=c;Math.abs(h)>4;h+=l)Object(s.drawSVGPath)(n.linesG,u.extraLinePath,t+a,h*n.vStepSize,n.scale,1);if(r.g=r.tiedFrom?r.tiedFrom.g:Object(s.createSVGGroupChild)(n.musicG,"".concat(r.start,"-").concat(r.pitch)),e.isBarBeginning&&r.g.setAttribute("data-is-bar-beginning","true"),r.tiedFrom){var p=t+a-r.tiedFrom.xHeadRight;Object(s.drawSVGPath)(r.g,u.tiePath,r.tiedFrom.xHeadRight,o,p/u.PATH_SCALE,n.scale*(r.vSteps<0?-1:1),r.opacity)}Object(s.drawSVGPath)(r.g,f.path,t+a,o,n.scale,n.scale,r.opacity),r.xHeadRight=t+a+f.width*n.scale,1.5*i<=r.length&&Object(s.drawSVGPath)(r.g,u.dotPath,t+a+f.width*n.scale+n.vStepSize/2,o-n.vStepSize/2,n.scale,n.scale,r.opacity),0!==r.accidental&&Object(s.drawSVGPath)(r.g,u.ACCIDENTAL_PATHS[r.accidental],t+a,o,n.scale,n.scale,r.opacity)})),f.stemAnchor){var p,d,m=t+a,v=f.stemAnchor*this.scale,g=e.minVStep+e.maxVStep<0,y=f.flags>2?2*(f.flags-2):0;if(g?(p=e.maxVStep*this.vStepSize-v,d=(e.minVStep+7+y)*this.vStepSize):(m+=(f.width-o.STEM_WIDTH)*this.scale,p=e.minVStep*this.vStepSize+v,d=(e.maxVStep-7-y)*this.vStepSize),Object(s.drawSVGPath)(h,u.stemPath,m,p,this.scale,(d-p)/u.PATH_SCALE),1===f.flags)Object(s.drawSVGPath)(h,u.singleFlagPath,m,d,this.scale,this.scale*(g?-1:1),1);else if(f.flags>1)for(var b=0;b<f.flags;++b)Object(s.drawSVGPath)(h,u.multiFlagPath,m,d,this.scale,this.scale*(g?-1:1),1),d+=(g?-2:2)*this.vStepSize}return 0===this.config.pixelsPerTimeStep&&(a+=f.width*this.scale,h&&(a+=h.getBoundingClientRect().width),a+=this.config.noteSpacing),a+=this.drawRests(e,t+a)}},{key:"drawBarIfNeeded",value:function(e,t){var n=0,r=this.lastBar+this.getBarLength();return 0!==e&&e>=r&&(this.config.pixelsPerTimeStep>0?t-=this.config.noteSpacing:n=this.config.noteSpacing,Object(s.drawSVGPath)(this.linesG,u.barPath,t,0,1,this.scale),this.lastBar=r),n}},{key:"drawRests",value:function(e,t){var n=0,r=e.restToNextLength;if(r){this.config.pixelsPerTimeStep>0&&(t+=this.quartersToTime(e.notes[0].length)*this.hStepSize);var a,i=e.notes[0].start+e.notes[0].length,c=0,l=this.lastBar+this.getBarLength()-i;for(r>l&&(c=r-l,r=l),a=4;a>this.getBarLength()&&a>=o.MIN_RESOLUTION;a/=2);for(var h=a;(r||c)&&h>=o.MIN_RESOLUTION;){if(h<=r){n+=this.drawBarIfNeeded(i,t+n),n+=this.drawSignaturesIfNeeded(i,t+n);var f=Object(s.drawSVGPath)(this.musicG,u.REST_PATHS[h],t+n,0,this.scale,this.scale);this.config.pixelsPerTimeStep>0?t+=this.quartersToTime(h)*this.hStepSize:(n+=f.getBoundingClientRect().width,n+=this.config.noteSpacing),i+=h,r-=h}if(c&&r<=0){var p=this.getBarLength();for(c>p?(r=p,c-=p):(r=c,c=0),a=4;a>this.getBarLength()&&a>=o.MIN_RESOLUTION;a/=2);h=a}r<h&&(h/=2)}}return n}},{key:"redrawStaff",value:function(e,t,n){var r=e.querySelector('g[data-id="staff-five-lines"]');if(r)r.setAttributeNS(null,"transform","scale(".concat(n/u.PATH_SCALE,", 1)"));else{r=Object(s.createSVGGroupChild)(e,"staff-five-lines");for(var a=0,i=-4;i<=4;i+=2)Object(s.drawSVGPath)(r,u.staffLinePath,t,a+i*this.vStepSize,n/u.PATH_SCALE,1)}return r}},{key:"clearSignatureOverlay",value:function(){for(;this.overlayG.lastChild;)this.overlayG.removeChild(this.overlayG.lastChild)}},{key:"drawSignaturesIfNeeded",value:function(e,t){var n=0,r=this.changeKeySignatureIfNeeded(e),a=this.changeTimeSignatureIfNeeded(e);if(r||a){var i=o.COMPACT_SPACING*this.scale*(this.config.pixelsPerTimeStep>0?3:2);this.signaturesList.push({x:t-i,q:e}),null===this.signatureNext&&(this.signatureNext=t);var u=e>0?Object(s.createSVGGroupChild)(this.signaturesG,"signatures"):this.overlayG;n+=this.drawSignatures(u,t+n,!1,r,a)}return 0===this.config.pixelsPerTimeStep?n:0}},{key:"drawSignatures",value:function(e,t,n,r,a){var i,c=this,h=o.COMPACT_SPACING*this.scale,f=h,p=e===this.overlayG||this.config.pixelsPerTimeStep>0;if(p){(i=document.createElementNS(s.SVGNS,"rect")).setAttributeNS(null,"x","".concat(t)),i.setAttributeNS(null,"y","0"),i.setAttributeNS(null,"width","1"),i.setAttributeNS(null,"height","1"),i.setAttribute("data-id","background"),e.appendChild(i);var d=document.defaultView.getComputedStyle(this.div.parentElement);i.setAttributeNS(null,"fill",d.getPropertyValue("background-color"))}if(n){var m=Object(s.drawSVGPath)(e,u.CLEF_PATHS[this.clef].path,t+f,0,this.scale,this.scale);this.setFill(m),f+=3*h}if(r){var v=l[this.key].accidental,g=71===this.clef?0:14;l[this.key].pitches.forEach((function(n){var r=c.getPitchDetails(n).vSteps,a=Object(s.drawSVGPath)(e,u.ACCIDENTAL_PATHS[v],t+f,(g+r)*c.vStepSize,c.scale,c.scale);c.setFill(a),f+=a.getBoundingClientRect().width}))}if(a){var y=Object(s.createSVGGroupChild)(e,"time-key"),b="".concat(2.85*this.config.noteHeight,"px");Object(s.drawSVGText)(y,"".concat(this.timeSignatureNumerator),t+f,-.5,b,!0),Object(s.drawSVGText)(y,"".concat(this.timeSignatureDenominator),t+f,4*this.vStepSize-.5,b,!0),this.setFill(y),f+=y.getBoundingClientRect().width+h}var k=this.redrawStaff(e,t,f);this.setStroke(k);var x=this.div.getBoundingClientRect(),w=e.getBoundingClientRect();if(this.updateVerticalBoundaries(w.top-x.top,w.bottom-x.top),p&&(i.setAttributeNS(null,"y","".concat(-this.staffOffset)),i.setAttributeNS(null,"height","".concat(this.height)),i.setAttributeNS(null,"width","".concat(f))),e===this.overlayG){this.overlaySVG.setAttributeNS(null,"width","".concat(f+5));for(var _=0;_<5;++_){var S=Object(s.drawSVGPath)(e,u.stemPath,f+_,_*_-this.staffOffset,1/o.STEM_WIDTH,(this.height-2*_*_)/u.PATH_SCALE,(_-5)*(_-5)*2/u.PATH_SCALE);this.setFill(S)}}if(this.config.pixelsPerTimeStep>0){var C=0===this.signaturesQuarters;return C&&(this.signaturesQuarters=this.timeToQuarters(f/this.hStepSize)),(C||t>0)&&(this.signaturesBlinking=!0,Object(s.setFade)(e,this.signaturesBlinking)),0}return f}},{key:"changeKeySignatureIfNeeded",value:function(e){if(this.scoreInfo.keySignatures){for(var t=this.key,n=0;n<this.scoreInfo.keySignatures.length&&this.scoreInfo.keySignatures[n].start<=e;++n)t=this.scoreInfo.keySignatures[n].key;if(t!==this.key)return this.key=t,!0}return!1}},{key:"changeTimeSignatureIfNeeded",value:function(e){if(this.scoreInfo.timeSignatures){for(var t=this.timeSignatureNumerator,n=this.timeSignatureDenominator,r=0;r<this.scoreInfo.timeSignatures.length&&this.scoreInfo.timeSignatures[r].start<=e;++r)t=this.scoreInfo.timeSignatures[r].numerator,n=this.scoreInfo.timeSignatures[r].denominator;if(t!==this.timeSignatureNumerator||n!==this.timeSignatureDenominator)return this.timeSignatureNumerator=t,this.timeSignatureDenominator=n,!0}return!1}},{key:"changeAndDrawSignaturesIfNeeded",value:function(e){var t;if(e<this.signatureCurrent||null!==this.signatureNext&&this.signatureNext<=e){t=this.signaturesList[0].q,this.signatureNext=null;for(var n=0;n<this.signaturesList.length;++n){if(e<this.signaturesList[n].x){this.signatureNext=this.signaturesList[n].x;break}this.signatureCurrent=this.signaturesList[n].x,t=this.signaturesList[n].q}}if(void 0!==t){var r=this.key,a=this.timeSignatureNumerator,i=this.timeSignatureDenominator;this.changeKeySignatureIfNeeded(t),this.changeTimeSignatureIfNeeded(t),this.clearSignatureOverlay(),this.drawSignatures(this.overlayG,0,!0,!0,!0),this.key=r,this.timeSignatureNumerator=a,this.timeSignatureDenominator=i}this.config.pixelsPerTimeStep>0&&0===e&&(this.signatureNext=0,this.signaturesBlinking=!0,Object(s.setFade)(this.overlayG,this.signaturesBlinking))}},{key:"getBarLength",value:function(){return 4*this.timeSignatureNumerator/this.timeSignatureDenominator}},{key:"scrollIntoViewIfNeeded",value:function(e,t){if(e)if(this.scrollType===i.PAGE){var n=this.parentElement.getBoundingClientRect().width;t>this.parentElement.scrollLeft+n&&(this.parentElement.scrollLeft=t-20)}else{var r=this.parentElement.getBoundingClientRect().width;this.parentElement.scrollLeft=t-.5*r}}},{key:"updateVerticalBoundaries",value:function(e,t){var n=0;if(e<0){this.staffOffset-=e;var r="translate(0, ".concat(this.staffOffset,")");this.overlayG.setAttributeNS(null,"transform",r),this.staffG.setAttributeNS(null,"transform",r),n=this.height-e}if((n=Math.max(n,t-e))>this.height){this.height=n,this.overlaySVG.setAttributeNS(null,"height","".concat(this.height)),this.staffSVG.setAttributeNS(null,"height","".concat(this.height));for(var a=this.div.querySelectorAll('rect[data-id="background"]'),i=0;i<a.length;++i){var o=a[i];o.setAttributeNS(null,"y","".concat(-this.staffOffset)),o.setAttributeNS(null,"height","".concat(this.height))}}}},{key:"setFill",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.setAttributeNS(null,"fill",this.getColor(t))}},{key:"setStroke",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.LINE_STROKE,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e.setAttributeNS(null,"stroke",this.getColor(n)),e.setAttributeNS(null,"stroke-width","".concat(t))}},{key:"getColor",value:function(e){return"rgb(".concat(e?this.config.activeNoteRGB:this.config.noteRGB,")")}},{key:"getOpacity",value:function(e){return e?e/127*.8+.2:1}},{key:"getGroup",value:function(e){var t=e.start,n=e.pitch;return this.staffSVG.querySelector('g[data-id="'.concat(t,"-").concat(n,'"]'))}},{key:"highlightElement",value:function(e,t){e.setAttribute("fill",this.getColor(t)),e.setAttribute("stroke",this.getColor(t))}},{key:"getBarBeginnings",value:function(){var e=new Set,t=0;this.scoreInfo.notes.forEach((function(e){e.start+e.length>t&&(t=e.start+e.length)}));var n=this.scoreInfo.timeSignatures?this.scoreInfo.timeSignatures.slice(0):[{start:0,numerator:4,denominator:4}];n.sort((function(e,t){return e.start-t.start}));for(var r=0,a=0;a<n.length;++a)for(var i=a===n.length-1?t:n[a].start,o=4*n[a].numerator/n[a].denominator;r<i;r+=o)e.add(r);return e}},{key:"quartersToTime",value:function(e){return e/this.scoreInfo.tempos[0].qpm*60}},{key:"timeToQuarters",value:function(e){return e*this.scoreInfo.tempos[0].qpm/60}},{key:"setDetails",value:function(){var e=this,t=new Map,n=this.getBarBeginnings(),r=new Set(n);this.scoreInfo.notes.slice().sort((function(e,t){return e.start-t.start})).forEach((function(n){var a=e.getQNote(n);r.add(a.start),r.add(a.start+a.length),t.has(a.start)?t.get(a.start).push(a):t.set(a.start,[a])})),Array.from(r).sort((function(e,t){return e-t})).forEach((function(n){var r=[];t.forEach((function(t){t.forEach((function(t){var a=e.splitQNote(t,n);a&&r.push(a)}))})),r.forEach((function(e){t.has(e.start)?t.get(e.start).push(e):t.set(e.start,[e])}))})),t=new Map(Array.from(t).sort((function(e,t){return e[0]-t[0]})));var a=this.key,i=null,o=0,s=n[Symbol.iterator](),u=s.next();t.forEach((function(t,n){var r={maxVStep:Number.MAX_SAFE_INTEGER,minVStep:Number.MIN_SAFE_INTEGER,restToNextLength:0,isBarBeginning:!1,notes:[]};e.changeKeySignatureIfNeeded(n);var a=u.value+e.getBarLength();!u.done&&n>=a&&(u=s.next(),e.barAccidentals={},r.isBarBeginning=!0),t.forEach((function(t){e.analyzePitch(t,n),r.minVStep=Math.max(t.vSteps,r.minVStep),r.maxVStep=Math.min(t.vSteps,r.maxVStep),r.notes.push(t)})),i&&(i.restToNextLength=n-o),e.musicBlockMap.set(n,r),i=r,o=n+r.notes[0].length})),this.initialRest={maxVStep:0,minVStep:0,restToNextLength:this.musicBlockMap.values().next().value.notes[0].start,isBarBeginning:!0,notes:[{start:0,length:0,vSteps:0,accidental:0,opacity:0,pitch:0,xHeadRight:0}]},this.key=a}},{key:"getQNote",value:function(e){return{start:e.start,length:e.length,vSteps:0,accidental:0,opacity:this.getOpacity(e.intensity),pitch:e.pitch,xHeadRight:0}}},{key:"splitQNote",value:function(e,t){var n=e.start+e.length-t;return t>e.start&&n>0?(e.length-=n,{start:t,length:n,vSteps:e.vSteps,accidental:e.accidental,opacity:e.opacity,pitch:e.pitch,xHeadRight:0,tiedFrom:e}):null}},{key:"analyzePitch",value:function(e,t){var n=this.getPitchDetails(e.pitch);n.vSteps in this.barAccidentals?n.accidental===this.barAccidentals[n.vSteps]?n.accidental=0:(3===this.barAccidentals[n.vSteps]?n.accidental=n.keyAccidental:0===n.accidental&&(n.accidental=3),this.barAccidentals[n.vSteps]=n.accidental):(e.tiedFrom&&(n.accidental=0),this.barAccidentals[n.vSteps]=n.accidental),e.vSteps=n.vSteps,e.accidental=n.accidental}},{key:"getPitchDetails",value:function(e){var t=e-60,n=Math.floor(t/12),r=t-12*n,a=c[this.key].steps[r],i=71===this.clef?6:-6,o=1===l[this.key].accidental?69+(r+3)%12:64+(r+8)%12;return{vSteps:i-7*n+a,accidental:c[this.key].accidental[r],keyAccidental:l[this.key].pitches.indexOf(o)>-1?l[this.key].accidental:0}}}]),e}()},function(e,t,n){"use strict";n.r(t);var r=n(3);n.d(t,"MAX_QUARTER_DIVISION",(function(){return r.MAX_QUARTER_DIVISION})),n.d(t,"ScrollType",(function(){return r.ScrollType})),n.d(t,"StaffSVGRender",(function(){return r.StaffSVGRender}))}])},4008:function(e,t,n){"use strict";var r=n(5844),a=n(8287),i=n(9778).lW;n.g.__TYPEDARRAY_POOL||(n.g.__TYPEDARRAY_POOL={UINT8:a([32,0]),UINT16:a([32,0]),UINT32:a([32,0]),BIGUINT64:a([32,0]),INT8:a([32,0]),INT16:a([32,0]),INT32:a([32,0]),BIGINT64:a([32,0]),FLOAT:a([32,0]),DOUBLE:a([32,0]),DATA:a([32,0]),UINT8C:a([32,0]),BUFFER:a([32,0])});var o="undefined"!==typeof Uint8ClampedArray,s="undefined"!==typeof BigUint64Array,u="undefined"!==typeof BigInt64Array,c=n.g.__TYPEDARRAY_POOL;c.UINT8C||(c.UINT8C=a([32,0])),c.BIGUINT64||(c.BIGUINT64=a([32,0])),c.BIGINT64||(c.BIGINT64=a([32,0])),c.BUFFER||(c.BUFFER=a([32,0]));var l=c.DATA,h=c.BUFFER;function f(e){if(e){var t=e.length||e.byteLength,n=r.log2(t);l[n].push(e)}}function p(e){e=r.nextPow2(e);var t=r.log2(e),n=l[t];return n.length>0?n.pop():new ArrayBuffer(e)}function d(e){return new Uint8Array(p(e),0,e)}function m(e){return new Uint16Array(p(2*e),0,e)}function v(e){return new Uint32Array(p(4*e),0,e)}function g(e){return new Int8Array(p(e),0,e)}function y(e){return new Int16Array(p(2*e),0,e)}function b(e){return new Int32Array(p(4*e),0,e)}function k(e){return new Float32Array(p(4*e),0,e)}function x(e){return new Float64Array(p(8*e),0,e)}function w(e){return o?new Uint8ClampedArray(p(e),0,e):d(e)}function _(e){return s?new BigUint64Array(p(8*e),0,e):null}function S(e){return u?new BigInt64Array(p(8*e),0,e):null}function C(e){return new DataView(p(e),0,e)}function T(e){e=r.nextPow2(e);var t=r.log2(e),n=h[t];return n.length>0?n.pop():new i(e)}t.free=function(e){if(i.isBuffer(e))h[r.log2(e.length)].push(e);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(e)&&(e=e.buffer),!e)return;var t=e.length||e.byteLength,n=0|r.log2(t);l[n].push(e)}},t.freeUint8=t.freeUint16=t.freeUint32=t.freeBigUint64=t.freeInt8=t.freeInt16=t.freeInt32=t.freeBigInt64=t.freeFloat32=t.freeFloat=t.freeFloat64=t.freeDouble=t.freeUint8Clamped=t.freeDataView=function(e){f(e.buffer)},t.freeArrayBuffer=f,t.freeBuffer=function(e){h[r.log2(e.length)].push(e)},t.malloc=function(e,t){if(void 0===t||"arraybuffer"===t)return p(e);switch(t){case"uint8":return d(e);case"uint16":return m(e);case"uint32":return v(e);case"int8":return g(e);case"int16":return y(e);case"int32":return b(e);case"float":case"float32":return k(e);case"double":case"float64":return x(e);case"uint8_clamped":return w(e);case"bigint64":return S(e);case"biguint64":return _(e);case"buffer":return T(e);case"data":case"dataview":return C(e);default:return null}return null},t.mallocArrayBuffer=p,t.mallocUint8=d,t.mallocUint16=m,t.mallocUint32=v,t.mallocInt8=g,t.mallocInt16=y,t.mallocInt32=b,t.mallocFloat32=t.mallocFloat=k,t.mallocFloat64=t.mallocDouble=x,t.mallocUint8Clamped=w,t.mallocBigUint64=_,t.mallocBigInt64=S,t.mallocDataView=C,t.mallocBuffer=T,t.clearCache=function(){for(var e=0;e<32;++e)c.UINT8[e].length=0,c.UINT16[e].length=0,c.UINT32[e].length=0,c.INT8[e].length=0,c.INT16[e].length=0,c.INT32[e].length=0,c.FLOAT[e].length=0,c.DOUBLE[e].length=0,c.BIGUINT64[e].length=0,c.BIGINT64[e].length=0,c.UINT8C[e].length=0,l[e].length=0,h[e].length=0}},8871:function(e){"use strict";e.exports=function(e,t,n){return 0===e.length?e:t?(n||e.sort(t),function(e,t){for(var n=1,r=e.length,a=e[0],i=e[0],o=1;o<r;++o)if(i=a,t(a=e[o],i)){if(o===n){n++;continue}e[n++]=a}return e.length=n,e}(e,t)):(n||e.sort(),function(e){for(var t=1,n=e.length,r=e[0],a=e[0],i=1;i<n;++i,a=r)if(a=r,(r=e[i])!==a){if(i===t){t++;continue}e[t++]=r}return e.length=t,e}(e))}},914:function(){},5410:function(){},8628:function(){},5778:function(){},1601:function(){},7792:function(){},5042:function(){}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.loaded=!0,n.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.amdD=function(){throw new Error("define cannot be used indirect")},__webpack_require__.amdO={},function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};__webpack_require__.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"===typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"===typeof n.then)return n}var a=Object.create(null);__webpack_require__.r(a);var i={};e=e||[null,t({}),t([]),t(t)];for(var o=2&r&&n;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((function(e){i[e]=function(){return n[e]}}));return i.default=function(){return n},__webpack_require__.d(a,i),a}}(),__webpack_require__.d=function(e,t){for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.f={},__webpack_require__.e=function(e){return Promise.all(Object.keys(__webpack_require__.f).reduce((function(t,n){return __webpack_require__.f[n](e,t),t}),[]))},__webpack_require__.u=function(e){return"static/js/"+e+".83a1ffe4.chunk.js"},__webpack_require__.miniCssF=function(e){},__webpack_require__.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={},t="midify:";__webpack_require__.l=function(n,r,a,i){if(e[n])e[n].push(r);else{var o,s;if(void 0!==a)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var l=u[c];if(l.getAttribute("src")==n||l.getAttribute("data-webpack")==t+a){o=l;break}}o||(s=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,__webpack_require__.nc&&o.setAttribute("nonce",__webpack_require__.nc),o.setAttribute("data-webpack",t+a),o.src=n),e[n]=[r];var h=function(t,r){o.onerror=o.onload=null,clearTimeout(f);var a=e[n];if(delete e[n],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach((function(e){return e(r)})),t)return t(r)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),s&&document.head.appendChild(o)}}}(),__webpack_require__.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},__webpack_require__.p="/",function(){var e={179:0};__webpack_require__.f.j=function(t,n){var r=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var a=new Promise((function(n,a){r=e[t]=[n,a]}));n.push(r[2]=a);var i=__webpack_require__.p+__webpack_require__.u(t),o=new Error;__webpack_require__.l(i,(function(n){if(__webpack_require__.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var a=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+a+": "+i+")",o.name="ChunkLoadError",o.type=a,o.request=i,r[1](o)}}),"chunk-"+t,t)}};var t=function(t,n){var r,a,i=n[0],o=n[1],s=n[2],u=0;if(i.some((function(t){return 0!==e[t]}))){for(r in o)__webpack_require__.o(o,r)&&(__webpack_require__.m[r]=o[r]);if(s)s(__webpack_require__)}for(t&&t(n);u<i.length;u++)a=i[u],__webpack_require__.o(e,a)&&e[a]&&e[a][0](),e[a]=0},n=self.webpackChunkmidify=self.webpackChunkmidify||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var __webpack_exports__={};!function(){"use strict";var e={};__webpack_require__.r(e),__webpack_require__.d(e,{browserFiles:function(){return Of},browserHTTPRequest:function(){return Kf},concatenateArrayBuffers:function(){return Oh},copyModel:function(){return kf},decodeWeights:function(){return Ah},encodeWeights:function(){return Eh},fromMemory:function(){return Qf},getLoadHandlers:function(){return Gh},getModelArtifactsInfoForJSON:function(){return Lh},getSaveHandlers:function(){return qh},http:function(){return Hf},isHTTPScheme:function(){return Wf},listModels:function(){return vf},loadWeights:function(){return Bf},moveModel:function(){return wf},registerLoadRouter:function(){return jh},registerSaveRouter:function(){return Vh},removeModel:function(){return yf},weightsLoaderFactory:function(){return jf},withSaveHandler:function(){return $f}});var t={};__webpack_require__.r(t),__webpack_require__.d(t,{assert:function(){return KH},assertContextRunning:function(){return YH},assertRange:function(){return XH},log:function(){return JH},setLogger:function(){return $H},warn:function(){return ZH}});var n={};__webpack_require__.r(n);var r={};__webpack_require__.r(r),__webpack_require__.d(r,{AMOscillator:function(){return cY},AMSynth:function(){return jY},Abs:function(){return CY},Add:function(){return vY},AmplitudeEnvelope:function(){return zY},Analyser:function(){return x$},AudioToGain:function(){return sY},AutoFilter:function(){return zQ},AutoPanner:function(){return VQ},AutoWah:function(){return qQ},BaseContext:function(){return VK},BiquadFilter:function(){return qY},BitCrusher:function(){return WQ},Buffer:function(){return tJ},BufferSource:function(){return rJ},Buffers:function(){return nJ},Channel:function(){return A$},Chebyshev:function(){return HQ},Chorus:function(){return $Q},Clock:function(){return MX},Compressor:function(){return O$},Context:function(){return jK},Convolver:function(){return j$},CrossFade:function(){return OQ},DCMeter:function(){return C$},Delay:function(){return DX},Destination:function(){return H$},Distortion:function(){return JQ},Draw:function(){return $$},DuoSynth:function(){return HY},EQ3:function(){return V$},Emitter:function(){return BK},Envelope:function(){return RY},FFT:function(){return S$},FMOscillator:function(){return lY},FMSynth:function(){return KY},FatOscillator:function(){return fY},FeedbackCombFilter:function(){return rQ},FeedbackDelay:function(){return e$},Filter:function(){return GY},Follower:function(){return jQ},Freeverb:function(){return i$},Frequency:function(){return dX},FrequencyClass:function(){return hX},FrequencyEnvelope:function(){return WY},FrequencyShifter:function(){return n$},Gain:function(){return SX},GainToAudio:function(){return TY},Gate:function(){return F$},GrainPlayer:function(){return SY},GreaterThan:function(){return NY},GreaterThanZero:function(){return AY},IntervalTimeline:function(){return jX},JCReverb:function(){return c$},LFO:function(){return bY},Limiter:function(){return L$},Listener:function(){return Y$},Loop:function(){return lQ},LowpassCombFilter:function(){return iQ},Master:function(){return K$},MembraneSynth:function(){return QY},Merge:function(){return XQ},MetalSynth:function(){return YY},Meter:function(){return _$},MidSideCompressor:function(){return z$},MidSideMerge:function(){return v$},MidSideSplit:function(){return m$},Midi:function(){return LX},MidiClass:function(){return FX},Mono:function(){return N$},MonoSynth:function(){return UY},MultibandCompressor:function(){return B$},MultibandSplit:function(){return P$},Multiply:function(){return uY},Negate:function(){return EY},Noise:function(){return $X},NoiseSynth:function(){return $Y},Offline:function(){return RX},OfflineContext:function(){return KK},OmniOscillator:function(){return mY},OnePoleFilter:function(){return aQ},Oscillator:function(){return aY},PWMOscillator:function(){return pY},PanVol:function(){return I$},Panner:function(){return BQ},Panner3D:function(){return D$},Param:function(){return bX},Part:function(){return hQ},Pattern:function(){return DQ},Phaser:function(){return p$},PingPongDelay:function(){return h$},PitchShift:function(){return f$},Player:function(){return wY},Players:function(){return _Y},PluckSynth:function(){return oQ},PolySynth:function(){return sQ},Pow:function(){return PY},PulseOscillator:function(){return hY},Recorder:function(){return R$},Reverb:function(){return d$},Sampler:function(){return uQ},Scale:function(){return gY},ScaleExp:function(){return MY},Sequence:function(){return RQ},Signal:function(){return EX},Solo:function(){return E$},Split:function(){return KQ},StateTimeline:function(){return yX},StereoWidener:function(){return y$},Subtract:function(){return IY},SyncedSignal:function(){return DY},Synth:function(){return BY},Ticks:function(){return BX},TicksClass:function(){return zX},Time:function(){return lX},TimeClass:function(){return cX},Timeline:function(){return DK},ToneAudioBuffer:function(){return HK},ToneAudioBuffers:function(){return OX},ToneAudioNode:function(){return kX},ToneBufferSource:function(){return QX},ToneEvent:function(){return cQ},ToneOscillatorNode:function(){return rY},Transport:function(){return W$},TransportTime:function(){return vX},TransportTimeClass:function(){return mX},Tremolo:function(){return b$},Unit:function(){return n},UserMedia:function(){return tY},Vibrato:function(){return k$},Volume:function(){return GX},WaveShaper:function(){return oY},Waveform:function(){return T$},Zero:function(){return yY},connect:function(){return wX},connectSeries:function(){return xX},connectSignal:function(){return IX},context:function(){return Z$},dbToGain:function(){return tX},debug:function(){return t},defaultArg:function(){return SK},disconnect:function(){return _X},ftom:function(){return iX},gainToDb:function(){return nX},getContext:function(){return QK},getDestination:function(){return X$},getDraw:function(){return J$},getListener:function(){return Q$},getTransport:function(){return U$},immediate:function(){return G$},intervalToFrequencyRatio:function(){return rX},isArray:function(){return oK},isBoolean:function(){return iK},isDefined:function(){return tK},isFunction:function(){return nK},isNote:function(){return uK},isNumber:function(){return rK},isObject:function(){return aK},isString:function(){return sK},isUndef:function(){return eK},loaded:function(){return eJ},mtof:function(){return sX},now:function(){return q$},optionsFromArguments:function(){return _K},setContext:function(){return $K},start:function(){return JK},supported:function(){return HH},version:function(){return aq}});var a=__webpack_require__(2791),i=__webpack_require__.t(a,2),o=__webpack_require__(1250);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},l(e,t)}function h(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}function p(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e,t){if(t&&("object"===d(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return m(e)}function g(e){var t=p();return function(){var n,r=f(e);if(t){var a=f(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return v(this,n)}}__webpack_require__.p;var y=__webpack_require__(184),b=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"render",value:function(){return(0,y.jsxs)("div",{className:"header",children:[(0,y.jsx)("img",{src:"logo.jpg",className:"logo"}),(0,y.jsx)("p",{className:"loader-text",children:"WAV TO MIDI"})]})}}]),n}(a.Component),k=b;function x(){x=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(I){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var a=t&&t.prototype instanceof h?t:h,i=Object.create(a.prototype),o=new C(r||[]);return i._invoke=function(e,t,n){var r="suspendedStart";return function(a,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw i;return E()}for(n.method=a,n.arg=i;;){var o=n.delegate;if(o){var s=w(o,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(e,n,o),i}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(I){return{type:"throw",arg:I}}}e.wrap=u;var l={};function h(){}function f(){}function p(){}var m={};s(m,a,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(T([])));g&&g!==t&&n.call(g,a)&&(m=g);var y=p.prototype=h.prototype=Object.create(m);function b(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function r(a,i,o,s){var u=c(e[a],e,i);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==d(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,o,s)}),(function(e){r("throw",e,o,s)})):t.resolve(h).then((function(e){l.value=e,o(l)}),(function(e){return r("throw",e,o,s)}))}s(u.arg)}var a;this._invoke=function(e,n){function i(){return new t((function(t,a){r(e,n,t,a)}))}return a=a?a.then(i,i):i()}}function w(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,l;var a=r.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function T(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:E}}function E(){return{value:void 0,done:!0}}return f.prototype=p,s(y,"constructor",p),s(p,"constructor",f),f.displayName=s(p,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,s(e,o,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},b(k.prototype),s(k.prototype,i,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,a,i){void 0===i&&(i=Promise);var o=new k(u(t,n,r,a),i);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},b(y),s(y,o,"Generator"),s(y,a,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],o=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;S(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:T(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},e}function w(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,a)}function _(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){w(i,r,a,o,s,"next",e)}function s(e){w(i,r,a,o,s,"throw",e)}o(void 0)}))}}function S(){return S=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},S.apply(this,arguments)}function C(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}function T(e){var t,n,r="";if("string"===typeof e||"number"===typeof e)r+=e;else if("object"===typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=T(e[t]))&&(r&&(r+=" "),r+=n);else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}function E(){for(var e,t,n=0,r="";n<arguments.length;)(e=arguments[n++])&&(t=T(e))&&(r&&(r+=" "),r+=t);return r}var I=function(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}},A=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,N=I((function(e){return A.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91}));var P=function(){function e(e){var t=this;this._insertTag=function(e){var n;n=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,n),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{n.insertRule(e,n.cssRules.length)}catch(r){0}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){return e.parentNode&&e.parentNode.removeChild(e)})),this.tags=[],this.ctr=0},e}(),M=Math.abs,D=String.fromCharCode,R=Object.assign;function O(e){return e.trim()}function F(e,t,n){return e.replace(t,n)}function L(e,t){return e.indexOf(t)}function z(e,t){return 0|e.charCodeAt(t)}function B(e,t,n){return e.slice(t,n)}function V(e){return e.length}function j(e){return e.length}function q(e,t){return t.push(e),e}var G=1,W=1,U=0,H=0,K=0,X="";function Y(e,t,n,r,a,i,o){return{value:e,root:t,parent:n,type:r,props:a,children:i,line:G,column:W,length:o,return:""}}function Q(e,t){return R(Y("",null,null,"",null,null,0),e,{length:-e.length},t)}function $(){return K=H>0?z(X,--H):0,W--,10===K&&(W=1,G--),K}function J(){return K=H<U?z(X,H++):0,W++,10===K&&(W=1,G++),K}function Z(){return z(X,H)}function ee(){return H}function te(e,t){return B(X,e,t)}function ne(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function re(e){return G=W=1,U=V(X=e),H=0,[]}function ae(e){return X="",e}function ie(e){return O(te(H-1,ue(91===e?e+2:40===e?e+1:e)))}function oe(e){for(;(K=Z())&&K<33;)J();return ne(e)>2||ne(K)>3?"":" "}function se(e,t){for(;--t&&J()&&!(K<48||K>102||K>57&&K<65||K>70&&K<97););return te(e,ee()+(t<6&&32==Z()&&32==J()))}function ue(e){for(;J();)switch(K){case e:return H;case 34:case 39:34!==e&&39!==e&&ue(K);break;case 40:41===e&&ue(e);break;case 92:J()}return H}function ce(e,t){for(;J()&&e+K!==57&&(e+K!==84||47!==Z()););return"/*"+te(t,H-1)+"*"+D(47===e?e:J())}function le(e){for(;!ne(Z());)J();return te(e,H)}var he="-ms-",fe="-moz-",pe="-webkit-",de="comm",me="rule",ve="decl",ge="@keyframes";function ye(e,t){for(var n="",r=j(e),a=0;a<r;a++)n+=t(e[a],a,e,t)||"";return n}function be(e,t,n,r){switch(e.type){case"@import":case ve:return e.return=e.return||e.value;case de:return"";case ge:return e.return=e.value+"{"+ye(e.children,r)+"}";case me:e.value=e.props.join(",")}return V(n=ye(e.children,r))?e.return=e.value+"{"+n+"}":""}function ke(e,t){switch(function(e,t){return(((t<<2^z(e,0))<<2^z(e,1))<<2^z(e,2))<<2^z(e,3)}(e,t)){case 5103:return pe+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return pe+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return pe+e+fe+e+he+e+e;case 6828:case 4268:return pe+e+he+e+e;case 6165:return pe+e+he+"flex-"+e+e;case 5187:return pe+e+F(e,/(\w+).+(:[^]+)/,"-webkit-box-$1$2-ms-flex-$1$2")+e;case 5443:return pe+e+he+"flex-item-"+F(e,/flex-|-self/,"")+e;case 4675:return pe+e+he+"flex-line-pack"+F(e,/align-content|flex-|-self/,"")+e;case 5548:return pe+e+he+F(e,"shrink","negative")+e;case 5292:return pe+e+he+F(e,"basis","preferred-size")+e;case 6060:return pe+"box-"+F(e,"-grow","")+pe+e+he+F(e,"grow","positive")+e;case 4554:return pe+F(e,/([^-])(transform)/g,"$1-webkit-$2")+e;case 6187:return F(F(F(e,/(zoom-|grab)/,pe+"$1"),/(image-set)/,pe+"$1"),e,"")+e;case 5495:case 3959:return F(e,/(image-set\([^]*)/,pe+"$1$`$1");case 4968:return F(F(e,/(.+:)(flex-)?(.*)/,"-webkit-box-pack:$3-ms-flex-pack:$3"),/s.+-b[^;]+/,"justify")+pe+e+e;case 4095:case 3583:case 4068:case 2532:return F(e,/(.+)-inline(.+)/,pe+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(V(e)-1-t>6)switch(z(e,t+1)){case 109:if(45!==z(e,t+4))break;case 102:return F(e,/(.+:)(.+)-([^]+)/,"$1-webkit-$2-$3$1"+fe+(108==z(e,t+3)?"$3":"$2-$3"))+e;case 115:return~L(e,"stretch")?ke(F(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==z(e,t+1))break;case 6444:switch(z(e,V(e)-3-(~L(e,"!important")&&10))){case 107:return F(e,":",":"+pe)+e;case 101:return F(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+pe+(45===z(e,14)?"inline-":"")+"box$3$1"+pe+"$2$3$1"+he+"$2box$3")+e}break;case 5936:switch(z(e,t+11)){case 114:return pe+e+he+F(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return pe+e+he+F(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return pe+e+he+F(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return pe+e+he+e+e}return e}function xe(e){return ae(we("",null,null,null,[""],e=re(e),0,[0],e))}function we(e,t,n,r,a,i,o,s,u){for(var c=0,l=0,h=o,f=0,p=0,d=0,m=1,v=1,g=1,y=0,b="",k=a,x=i,w=r,_=b;v;)switch(d=y,y=J()){case 40:if(108!=d&&58==_.charCodeAt(h-1)){-1!=L(_+=F(ie(y),"&","&\f"),"&\f")&&(g=-1);break}case 34:case 39:case 91:_+=ie(y);break;case 9:case 10:case 13:case 32:_+=oe(d);break;case 92:_+=se(ee()-1,7);continue;case 47:switch(Z()){case 42:case 47:q(Se(ce(J(),ee()),t,n),u);break;default:_+="/"}break;case 123*m:s[c++]=V(_)*g;case 125*m:case 59:case 0:switch(y){case 0:case 125:v=0;case 59+l:p>0&&V(_)-h&&q(p>32?Ce(_+";",r,n,h-1):Ce(F(_," ","")+";",r,n,h-2),u);break;case 59:_+=";";default:if(q(w=_e(_,t,n,c,l,a,s,b,k=[],x=[],h),i),123===y)if(0===l)we(_,t,w,w,k,i,h,s,x);else switch(f){case 100:case 109:case 115:we(e,w,w,r&&q(_e(e,w,w,0,0,a,s,b,a,k=[],h),x),a,x,h,s,r?k:x);break;default:we(_,w,w,w,[""],x,0,s,x)}}c=l=p=0,m=g=1,b=_="",h=o;break;case 58:h=1+V(_),p=d;default:if(m<1)if(123==y)--m;else if(125==y&&0==m++&&125==$())continue;switch(_+=D(y),y*m){case 38:g=l>0?1:(_+="\f",-1);break;case 44:s[c++]=(V(_)-1)*g,g=1;break;case 64:45===Z()&&(_+=ie(J())),f=Z(),l=h=V(b=_+=le(ee())),y++;break;case 45:45===d&&2==V(_)&&(m=0)}}return i}function _e(e,t,n,r,a,i,o,s,u,c,l){for(var h=a-1,f=0===a?i:[""],p=j(f),d=0,m=0,v=0;d<r;++d)for(var g=0,y=B(e,h+1,h=M(m=o[d])),b=e;g<p;++g)(b=O(m>0?f[g]+" "+y:F(y,/&\f/g,f[g])))&&(u[v++]=b);return Y(e,t,n,0===a?me:s,u,c,l)}function Se(e,t,n){return Y(e,t,n,de,D(K),B(e,2,-2),0)}function Ce(e,t,n,r){return Y(e,t,n,ve,B(e,0,r),B(e,r+1,-1),r)}var Te=function(e,t,n){for(var r=0,a=0;r=a,a=Z(),38===r&&12===a&&(t[n]=1),!ne(a);)J();return te(e,H)},Ee=function(e,t){return ae(function(e,t){var n=-1,r=44;do{switch(ne(r)){case 0:38===r&&12===Z()&&(t[n]=1),e[n]+=Te(H-1,t,n);break;case 2:e[n]+=ie(r);break;case 4:if(44===r){e[++n]=58===Z()?"&\f":"",t[n]=e[n].length;break}default:e[n]+=D(r)}}while(r=J());return e}(re(e),t))},Ie=new WeakMap,Ae=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,n=e.parent,r=e.column===n.column&&e.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||Ie.get(n))&&!r){Ie.set(e,!0);for(var a=[],i=Ee(t,a),o=n.props,s=0,u=0;s<i.length;s++)for(var c=0;c<o.length;c++,u++)e.props[u]=a[s]?i[s].replace(/&\f/g,o[c]):o[c]+" "+i[s]}}},Ne=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}},Pe=[function(e,t,n,r){if(e.length>-1&&!e.return)switch(e.type){case ve:e.return=ke(e.value,e.length);break;case ge:return ye([Q(e,{value:F(e.value,"@","@"+pe)})],r);case me:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,(function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return ye([Q(e,{props:[F(t,/:(read-\w+)/,":-moz-$1")]})],r);case"::placeholder":return ye([Q(e,{props:[F(t,/:(plac\w+)/,":-webkit-input-$1")]}),Q(e,{props:[F(t,/:(plac\w+)/,":-moz-$1")]}),Q(e,{props:[F(t,/:(plac\w+)/,he+"input-$1")]})],r)}return""}))}}],Me=function(e){var t=e.key;if("css"===t){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var r=e.stylisPlugins||Pe;var a,i,o={},s=[];a=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),n=1;n<t.length;n++)o[t[n]]=!0;s.push(e)}));var u,c,l=[be,(c=function(e){u.insert(e)},function(e){e.root||(e=e.return)&&c(e)})],h=function(e){var t=j(e);return function(n,r,a,i){for(var o="",s=0;s<t;s++)o+=e[s](n,r,a,i)||"";return o}}([Ae,Ne].concat(r,l));i=function(e,t,n,r){u=n,ye(xe(e?e+"{"+t.styles+"}":t.styles),h),r&&(f.inserted[t.name]=!0)};var f={key:t,sheet:new P({key:t,container:a,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:o,registered:{},insert:i};return f.sheet.hydrate(s),f};var De=function(e){for(var t,n=0,r=0,a=e.length;a>=4;++r,a-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(a){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)},Re={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Oe=/[A-Z]|^ms/g,Fe=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Le=function(e){return 45===e.charCodeAt(1)},ze=function(e){return null!=e&&"boolean"!==typeof e},Be=I((function(e){return Le(e)?e:e.replace(Oe,"-$&").toLowerCase()})),Ve=function(e,t){switch(e){case"animation":case"animationName":if("string"===typeof t)return t.replace(Fe,(function(e,t,n){return qe={name:t,styles:n,next:qe},t}))}return 1===Re[e]||Le(e)||"number"!==typeof t||0===t?t:t+"px"};function je(e,t,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return qe={name:n.name,styles:n.styles,next:qe},n.name;if(void 0!==n.styles){var r=n.next;if(void 0!==r)for(;void 0!==r;)qe={name:r.name,styles:r.styles,next:qe},r=r.next;return n.styles+";"}return function(e,t,n){var r="";if(Array.isArray(n))for(var a=0;a<n.length;a++)r+=je(e,t,n[a])+";";else for(var i in n){var o=n[i];if("object"!==typeof o)null!=t&&void 0!==t[o]?r+=i+"{"+t[o]+"}":ze(o)&&(r+=Be(i)+":"+Ve(i,o)+";");else if(!Array.isArray(o)||"string"!==typeof o[0]||null!=t&&void 0!==t[o[0]]){var s=je(e,t,o);switch(i){case"animation":case"animationName":r+=Be(i)+":"+s+";";break;default:r+=i+"{"+s+"}"}}else for(var u=0;u<o.length;u++)ze(o[u])&&(r+=Be(i)+":"+Ve(i,o[u])+";")}return r}(e,t,n);case"function":if(void 0!==e){var a=qe,i=n(e);return qe=a,je(e,t,i)}}if(null==t)return n;var o=t[n];return void 0!==o?o:n}var qe,Ge=/label:\s*([^\s;\n{]+)\s*(;|$)/g;var We=function(e,t,n){if(1===e.length&&"object"===typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var r=!0,a="";qe=void 0;var i=e[0];null==i||void 0===i.raw?(r=!1,a+=je(n,t,i)):a+=i[0];for(var o=1;o<e.length;o++)a+=je(n,t,e[o]),r&&(a+=i[o]);Ge.lastIndex=0;for(var s,u="";null!==(s=Ge.exec(a));)u+="-"+s[1];return{name:De(a)+u,styles:a,next:qe}},Ue=(0,a.createContext)("undefined"!==typeof HTMLElement?Me({key:"css"}):null);Ue.Provider;var He=function(e){return(0,a.forwardRef)((function(t,n){var r=(0,a.useContext)(Ue);return e(t,r,n)}))},Ke=(0,a.createContext)({});i.useInsertionEffect&&i.useInsertionEffect;function Xe(e,t,n){var r="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):r+=n+" "})),r}var Ye=function(e,t,n){var r=e.key+"-"+t.name;!1===n&&void 0===e.registered[r]&&(e.registered[r]=t.styles)},Qe=N,$e=function(e){return"theme"!==e},Je=function(e){return"string"===typeof e&&e.charCodeAt(0)>96?Qe:$e},Ze=function(e,t,n){var r;if(t){var a=t.shouldForwardProp;r=e.__emotion_forwardProp&&a?function(t){return e.__emotion_forwardProp(t)&&a(t)}:a}return"function"!==typeof r&&n&&(r=e.__emotion_forwardProp),r},et=i.useInsertionEffect?i.useInsertionEffect:function(e){e()};var tt=function(e){var t=e.cache,n=e.serialized,r=e.isStringTag;Ye(t,n,r);var a;a=function(){return function(e,t,n){Ye(e,t,n);var r=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var a=t;do{e.insert(t===a?"."+r:"",a,e.sheet,!0),a=a.next}while(void 0!==a)}}(t,n,r)},et(a);return null},nt=function e(t,n){var r,i,o=t.__emotion_real===t,s=o&&t.__emotion_base||t;void 0!==n&&(r=n.label,i=n.target);var u=Ze(t,n,o),c=u||Je(s),l=!c("as");return function(){var h=arguments,f=o&&void 0!==t.__emotion_styles?t.__emotion_styles.slice(0):[];if(void 0!==r&&f.push("label:"+r+";"),null==h[0]||void 0===h[0].raw)f.push.apply(f,h);else{0,f.push(h[0][0]);for(var p=h.length,d=1;d<p;d++)f.push(h[d],h[0][d])}var m=He((function(e,t,n){var r=l&&e.as||s,o="",h=[],p=e;if(null==e.theme){for(var d in p={},e)p[d]=e[d];p.theme=(0,a.useContext)(Ke)}"string"===typeof e.className?o=Xe(t.registered,h,e.className):null!=e.className&&(o=e.className+" ");var m=We(f.concat(h),t.registered,p);o+=t.key+"-"+m.name,void 0!==i&&(o+=" "+i);var v=l&&void 0===u?Je(r):c,g={};for(var y in e)l&&"as"===y||v(y)&&(g[y]=e[y]);return g.className=o,g.ref=n,(0,a.createElement)(a.Fragment,null,(0,a.createElement)(tt,{cache:t,serialized:m,isStringTag:"string"===typeof r}),(0,a.createElement)(r,g))}));return m.displayName=void 0!==r?r:"Styled("+("string"===typeof s?s:s.displayName||s.name||"Component")+")",m.defaultProps=t.defaultProps,m.__emotion_real=m,m.__emotion_base=s,m.__emotion_styles=f,m.__emotion_forwardProp=u,Object.defineProperty(m,"toString",{value:function(){return"."+i}}),m.withComponent=function(t,r){return e(t,S({},n,r,{shouldForwardProp:Ze(m,r,!0)})).apply(void 0,f)},m}},rt=nt.bind();["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){rt[e]=rt(e)}));var at=rt;function it(e,t){return at(e,t)}function ot(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function st(e){return null!==e&&"object"===typeof e&&e.constructor===Object}function ut(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clone:!0},r=n.clone?S({},e):e;return st(e)&&st(t)&&Object.keys(t).forEach((function(a){"__proto__"!==a&&(st(t[a])&&a in e&&st(e[a])?r[a]=ut(e[a],t[a],n):r[a]=t[a])})),r}var ct=function(e,t){return t?ut(e,t,{clone:!1}):e};function lt(e){for(var t="https://mui.com/production-error/?code="+e,n=1;n<arguments.length;n+=1)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+e+"; visit "+t+" for the full message."}function ht(e){if("string"!==typeof e)throw new Error(lt(7));return e.charAt(0).toUpperCase()+e.slice(1)}var ft={xs:0,sm:600,md:900,lg:1200,xl:1536},pt={keys:["xs","sm","md","lg","xl"],up:function(e){return"@media (min-width:".concat(ft[e],"px)")}};function dt(e,t,n){var r=e.theme||{};if(Array.isArray(t)){var a=r.breakpoints||pt;return t.reduce((function(e,r,i){return e[a.up(a.keys[i])]=n(t[i]),e}),{})}if("object"===typeof t){var i=r.breakpoints||pt;return Object.keys(t).reduce((function(e,r){if(-1!==Object.keys(i.values||ft).indexOf(r)){e[i.up(r)]=n(t[r],r)}else{var a=r;e[a]=t[a]}return e}),{})}return n(t)}function mt(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=null==t||null==(e=t.keys)?void 0:e.reduce((function(e,n){return e[t.up(n)]={},e}),{});return n||{}}function vt(e,t){return e.reduce((function(e,t){var n=e[t];return(!n||0===Object.keys(n).length)&&delete e[t],e}),t)}function gt(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!t||"string"!==typeof t)return null;if(e&&e.vars&&n){var r="vars.".concat(t).split(".").reduce((function(e,t){return e&&e[t]?e[t]:null}),e);if(null!=r)return r}return t.split(".").reduce((function(e,t){return e&&null!=e[t]?e[t]:null}),e)}function yt(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;return r="function"===typeof e?e(n):Array.isArray(e)?e[n]||a:gt(e,n)||a,t&&(r=t(r)),r}var bt=function(e){var t=e.prop,n=e.cssProperty,r=void 0===n?e.prop:n,a=e.themeKey,i=e.transform,o=function(e){if(null==e[t])return null;var n=e[t],o=gt(e.theme,a)||{};return dt(e,n,(function(e){var n=yt(o,i,e);return e===n&&"string"===typeof e&&(n=yt(o,i,"".concat(t).concat("default"===e?"":ht(e)),e)),!1===r?n:ot({},r,n)}))};return o.propTypes={},o.filterProps=[t],o};var kt=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.reduce((function(e,t){return t.filterProps.forEach((function(n){e[n]=t})),e}),{}),a=function(e){return Object.keys(e).reduce((function(t,n){return r[n]?ct(t,r[n](e)):t}),{})};return a.propTypes={},a.filterProps=t.reduce((function(e,t){return e.concat(t.filterProps)}),[]),a};function xt(e){if(Array.isArray(e))return e}function wt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _t(e,t){if(e){if("string"===typeof e)return wt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wt(e,t):void 0}}function St(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ct(e,t){return xt(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(u){s=!0,a=u}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}}(e,t)||_t(e,t)||St()}var Tt={m:"margin",p:"padding"},Et={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},It={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},At=function(e){var t={};return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}((function(e){if(e.length>2){if(!It[e])return[e];e=It[e]}var t=Ct(e.split(""),2),n=t[0],r=t[1],a=Tt[n],i=Et[r]||"";return Array.isArray(i)?i.map((function(e){return a+e})):[a+i]})),Nt=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],Pt=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],Mt=[].concat(Nt,Pt);function Dt(e,t,n,r){var a,i=null!=(a=gt(e,t,!1))?a:n;return"number"===typeof i?function(e){return"string"===typeof e?e:i*e}:Array.isArray(i)?function(e){return"string"===typeof e?e:i[e]}:"function"===typeof i?i:function(){}}function Rt(e){return Dt(e,"spacing",8)}function Ot(e,t){if("string"===typeof t||null==t)return t;var n=e(Math.abs(t));return t>=0?n:"number"===typeof n?-n:"-".concat(n)}function Ft(e,t,n,r){if(-1===t.indexOf(n))return null;var a=function(e,t){return function(n){return e.reduce((function(e,r){return e[r]=Ot(t,n),e}),{})}}(At(n),r);return dt(e,e[n],a)}function Lt(e,t){var n=Rt(e.theme);return Object.keys(e).map((function(r){return Ft(e,t,r,n)})).reduce(ct,{})}function zt(e){return Lt(e,Nt)}function Bt(e){return Lt(e,Pt)}function Vt(e){return Lt(e,Mt)}zt.propTypes={},zt.filterProps=Nt,Bt.propTypes={},Bt.filterProps=Pt,Vt.propTypes={},Vt.filterProps=Mt;var jt=Vt;function qt(e){return"number"!==typeof e?e:"".concat(e,"px solid")}var Gt=bt({prop:"border",themeKey:"borders",transform:qt}),Wt=bt({prop:"borderTop",themeKey:"borders",transform:qt}),Ut=bt({prop:"borderRight",themeKey:"borders",transform:qt}),Ht=bt({prop:"borderBottom",themeKey:"borders",transform:qt}),Kt=bt({prop:"borderLeft",themeKey:"borders",transform:qt}),Xt=bt({prop:"borderColor",themeKey:"palette"}),Yt=bt({prop:"borderTopColor",themeKey:"palette"}),Qt=bt({prop:"borderRightColor",themeKey:"palette"}),$t=bt({prop:"borderBottomColor",themeKey:"palette"}),Jt=bt({prop:"borderLeftColor",themeKey:"palette"}),Zt=function(e){if(void 0!==e.borderRadius&&null!==e.borderRadius){var t=Dt(e.theme,"shape.borderRadius",4);return dt(e,e.borderRadius,(function(e){return{borderRadius:Ot(t,e)}}))}return null};Zt.propTypes={},Zt.filterProps=["borderRadius"];var en=kt(Gt,Wt,Ut,Ht,Kt,Xt,Yt,Qt,$t,Jt,Zt),tn=kt(bt({prop:"displayPrint",cssProperty:!1,transform:function(e){return{"@media print":{display:e}}}}),bt({prop:"display"}),bt({prop:"overflow"}),bt({prop:"textOverflow"}),bt({prop:"visibility"}),bt({prop:"whiteSpace"})),nn=kt(bt({prop:"flexBasis"}),bt({prop:"flexDirection"}),bt({prop:"flexWrap"}),bt({prop:"justifyContent"}),bt({prop:"alignItems"}),bt({prop:"alignContent"}),bt({prop:"order"}),bt({prop:"flex"}),bt({prop:"flexGrow"}),bt({prop:"flexShrink"}),bt({prop:"alignSelf"}),bt({prop:"justifyItems"}),bt({prop:"justifySelf"})),rn=function(e){if(void 0!==e.gap&&null!==e.gap){var t=Dt(e.theme,"spacing",8);return dt(e,e.gap,(function(e){return{gap:Ot(t,e)}}))}return null};rn.propTypes={},rn.filterProps=["gap"];var an=function(e){if(void 0!==e.columnGap&&null!==e.columnGap){var t=Dt(e.theme,"spacing",8);return dt(e,e.columnGap,(function(e){return{columnGap:Ot(t,e)}}))}return null};an.propTypes={},an.filterProps=["columnGap"];var on=function(e){if(void 0!==e.rowGap&&null!==e.rowGap){var t=Dt(e.theme,"spacing",8);return dt(e,e.rowGap,(function(e){return{rowGap:Ot(t,e)}}))}return null};on.propTypes={},on.filterProps=["rowGap"];var sn=kt(rn,an,on,bt({prop:"gridColumn"}),bt({prop:"gridRow"}),bt({prop:"gridAutoFlow"}),bt({prop:"gridAutoColumns"}),bt({prop:"gridAutoRows"}),bt({prop:"gridTemplateColumns"}),bt({prop:"gridTemplateRows"}),bt({prop:"gridTemplateAreas"}),bt({prop:"gridArea"})),un=kt(bt({prop:"position"}),bt({prop:"zIndex",themeKey:"zIndex"}),bt({prop:"top"}),bt({prop:"right"}),bt({prop:"bottom"}),bt({prop:"left"})),cn=kt(bt({prop:"color",themeKey:"palette"}),bt({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette"}),bt({prop:"backgroundColor",themeKey:"palette"})),ln=bt({prop:"boxShadow",themeKey:"shadows"});function hn(e){return e<=1&&0!==e?"".concat(100*e,"%"):e}var fn=bt({prop:"width",transform:hn}),pn=function(e){if(void 0!==e.maxWidth&&null!==e.maxWidth){return dt(e,e.maxWidth,(function(t){var n,r,a;return{maxWidth:(null==(n=e.theme)||null==(r=n.breakpoints)||null==(a=r.values)?void 0:a[t])||ft[t]||hn(t)}}))}return null};pn.filterProps=["maxWidth"];var dn=bt({prop:"minWidth",transform:hn}),mn=bt({prop:"height",transform:hn}),vn=bt({prop:"maxHeight",transform:hn}),gn=bt({prop:"minHeight",transform:hn}),yn=(bt({prop:"size",cssProperty:"width",transform:hn}),bt({prop:"size",cssProperty:"height",transform:hn}),kt(fn,pn,dn,mn,vn,gn,bt({prop:"boxSizing"}))),bn=bt({prop:"fontFamily",themeKey:"typography"}),kn=bt({prop:"fontSize",themeKey:"typography"}),xn=bt({prop:"fontStyle",themeKey:"typography"}),wn=bt({prop:"fontWeight",themeKey:"typography"}),_n=bt({prop:"letterSpacing"}),Sn=bt({prop:"textTransform"}),Cn=bt({prop:"lineHeight"}),Tn=bt({prop:"textAlign"}),En=kt(bt({prop:"typography",cssProperty:!1,themeKey:"typography"}),bn,kn,xn,wn,_n,Cn,Tn,Sn),In={borders:en.filterProps,display:tn.filterProps,flexbox:nn.filterProps,grid:sn.filterProps,positions:un.filterProps,palette:cn.filterProps,shadows:ln.filterProps,sizing:yn.filterProps,spacing:jt.filterProps,typography:En.filterProps},An={borders:en,display:tn,flexbox:nn,grid:sn,positions:un,palette:cn,shadows:ln,sizing:yn,spacing:jt,typography:En},Nn=Object.keys(In).reduce((function(e,t){return In[t].forEach((function(n){e[n]=An[t]})),e}),{});function Pn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.reduce((function(e,t){return e.concat(Object.keys(t))}),[]),a=new Set(r);return t.every((function(e){return a.size===Object.keys(e).length}))}function Mn(e,t){return"function"===typeof e?e(t):e}var Dn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:An,t=Object.keys(e).reduce((function(t,n){return e[n].filterProps.forEach((function(r){t[r]=e[n]})),t}),{});function n(e,n,r){var a,i=(ot(a={},e,n),ot(a,"theme",r),a),o=t[e];return o?o(i):ot({},e,n)}function r(e){var a=e||{},i=a.sx,o=a.theme,s=void 0===o?{}:o;if(!i)return null;function u(e){var a=e;if("function"===typeof e)a=e(s);else if("object"!==typeof e)return e;if(!a)return null;var i=mt(s.breakpoints),o=Object.keys(i),u=i;return Object.keys(a).forEach((function(e){var i=Mn(a[e],s);if(null!==i&&void 0!==i)if("object"===typeof i)if(t[e])u=ct(u,n(e,i,s));else{var o=dt({theme:s},i,(function(t){return ot({},e,t)}));Pn(o,i)?u[e]=r({sx:i,theme:s}):u=ct(u,o)}else u=ct(u,n(e,i,s))})),vt(o,u)}return Array.isArray(i)?i.map(u):u(i)}return r}();Dn.filterProps=["sx"];var Rn=Dn;function On(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Fn(e){return function(e){if(Array.isArray(e))return wt(e)}(e)||On(e)||_t(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Ln=["sx"];function zn(e){var t,n=e.sx,r=function(e){var t={systemProps:{},otherProps:{}};return Object.keys(e).forEach((function(n){Nn[n]?t.systemProps[n]=e[n]:t.otherProps[n]=e[n]})),t}(C(e,Ln)),a=r.systemProps,i=r.otherProps;return t=Array.isArray(n)?[a].concat(Fn(n)):"function"===typeof n?function(){var e=n.apply(void 0,arguments);return st(e)?S({},a,e):a}:S({},a,n),S({},i,{sx:t})}var Bn=["values","unit","step"];function Vn(e){var t=e.values,n=void 0===t?{xs:0,sm:600,md:900,lg:1200,xl:1536}:t,r=e.unit,a=void 0===r?"px":r,i=e.step,o=void 0===i?5:i,s=C(e,Bn),u=function(e){var t=Object.keys(e).map((function(t){return{key:t,val:e[t]}}))||[];return t.sort((function(e,t){return e.val-t.val})),t.reduce((function(e,t){return S({},e,ot({},t.key,t.val))}),{})}(n),c=Object.keys(u);function l(e){var t="number"===typeof n[e]?n[e]:e;return"@media (min-width:".concat(t).concat(a,")")}function h(e){var t="number"===typeof n[e]?n[e]:e;return"@media (max-width:".concat(t-o/100).concat(a,")")}function f(e,t){var r=c.indexOf(t);return"@media (min-width:".concat("number"===typeof n[e]?n[e]:e).concat(a,") and ")+"(max-width:".concat((-1!==r&&"number"===typeof n[c[r]]?n[c[r]]:t)-o/100).concat(a,")")}return S({keys:c,values:u,up:l,down:h,between:f,only:function(e){return c.indexOf(e)+1<c.length?f(e,c[c.indexOf(e)+1]):l(e)},not:function(e){var t=c.indexOf(e);return 0===t?l(c[1]):t===c.length-1?h(c[t]):f(e,c[c.indexOf(e)+1]).replace("@media","@media not all and")},unit:a},s)}var jn={borderRadius:4};function qn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;if(e.mui)return e;var t=Rt({spacing:e}),n=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var a=0===n.length?[1]:n;return a.map((function(e){var n=t(e);return"number"===typeof n?"".concat(n,"px"):n})).join(" ")};return n.mui=!0,n}var Gn=["breakpoints","palette","spacing","shape"];var Wn=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.breakpoints,n=void 0===t?{}:t,r=e.palette,a=void 0===r?{}:r,i=e.spacing,o=e.shape,s=void 0===o?{}:o,u=C(e,Gn),c=Vn(n),l=qn(i),h=ut({breakpoints:c,direction:"ltr",components:{},palette:S({mode:"light"},a),spacing:l,shape:S({},jn,s)},u),f=arguments.length,p=new Array(f>1?f-1:0),d=1;d<f;d++)p[d-1]=arguments[d];return h=p.reduce((function(e,t){return ut(e,t)}),h)};var Un=a.createContext(null);function Hn(){return a.useContext(Un)}function Kn(e){return 0===Object.keys(e).length}var Xn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=Hn();return!t||Kn(t)?e:t},Yn=Wn();var Qn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Yn;return Xn(e)},$n=["className","component"];var Jn=function(e){return e},Zn=function(){var e=Jn;return{configure:function(t){e=t},generate:function(t){return e(t)},reset:function(){e=Jn}}}(),er=Zn;function tr(e,t){var n;return S({toolbar:(n={minHeight:56},ot(n,e.up("xs"),{"@media (orientation: landscape)":{minHeight:48}}),ot(n,e.up("sm"),{minHeight:64}),n)},t)}function nr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(t,e),n)}function rr(e){if(e.type)return e;if("#"===e.charAt(0))return rr(function(e){e=e.slice(1);var t=new RegExp(".{1,".concat(e.length>=6?2:1,"}"),"g"),n=e.match(t);return n&&1===n[0].length&&(n=n.map((function(e){return e+e}))),n?"rgb".concat(4===n.length?"a":"","(").concat(n.map((function(e,t){return t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3})).join(", "),")"):""}(e));var t=e.indexOf("("),n=e.substring(0,t);if(-1===["rgb","rgba","hsl","hsla","color"].indexOf(n))throw new Error(lt(9,e));var r,a=e.substring(t+1,e.length-1);if("color"===n){if(r=(a=a.split(" ")).shift(),4===a.length&&"/"===a[3].charAt(0)&&(a[3]=a[3].slice(1)),-1===["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(r))throw new Error(lt(10,r))}else a=a.split(",");return{type:n,values:a=a.map((function(e){return parseFloat(e)})),colorSpace:r}}function ar(e){var t=e.type,n=e.colorSpace,r=e.values;return-1!==t.indexOf("rgb")?r=r.map((function(e,t){return t<3?parseInt(e,10):e})):-1!==t.indexOf("hsl")&&(r[1]="".concat(r[1],"%"),r[2]="".concat(r[2],"%")),r=-1!==t.indexOf("color")?"".concat(n," ").concat(r.join(" ")):"".concat(r.join(", ")),"".concat(t,"(").concat(r,")")}function ir(e){var t="hsl"===(e=rr(e)).type?rr(function(e){var t=(e=rr(e)).values,n=t[0],r=t[1]/100,a=t[2]/100,i=r*Math.min(a,1-a),o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e+n/30)%12;return a-i*Math.max(Math.min(t-3,9-t,1),-1)},s="rgb",u=[Math.round(255*o(0)),Math.round(255*o(8)),Math.round(255*o(4))];return"hsla"===e.type&&(s+="a",u.push(t[3])),ar({type:s,values:u})}(e)).values:e.values;return t=t.map((function(t){return"color"!==e.type&&(t/=255),t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)})),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function or(e,t){return e=rr(e),t=nr(t),"rgb"!==e.type&&"hsl"!==e.type||(e.type+="a"),"color"===e.type?e.values[3]="/".concat(t):e.values[3]=t,ar(e)}function sr(e,t){if(e=rr(e),t=nr(t),-1!==e.type.indexOf("hsl"))e.values[2]*=1-t;else if(-1!==e.type.indexOf("rgb")||-1!==e.type.indexOf("color"))for(var n=0;n<3;n+=1)e.values[n]*=1-t;return ar(e)}function ur(e,t){if(e=rr(e),t=nr(t),-1!==e.type.indexOf("hsl"))e.values[2]+=(100-e.values[2])*t;else if(-1!==e.type.indexOf("rgb"))for(var n=0;n<3;n+=1)e.values[n]+=(255-e.values[n])*t;else if(-1!==e.type.indexOf("color"))for(var r=0;r<3;r+=1)e.values[r]+=(1-e.values[r])*t;return ar(e)}var cr={black:"#000",white:"#fff"},lr={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},hr={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},fr={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},pr={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},dr={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},mr={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},vr={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},gr=["mode","contrastThreshold","tonalOffset"],yr={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:cr.white,default:cr.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},br={text:{primary:cr.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:cr.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function kr(e,t,n,r){var a=r.light||r,i=r.dark||1.5*r;e[t]||(e.hasOwnProperty(n)?e[t]=e[n]:"light"===t?e.light=ur(e.main,a):"dark"===t&&(e.dark=sr(e.main,i)))}function xr(e){var t=e.mode,n=void 0===t?"light":t,r=e.contrastThreshold,a=void 0===r?3:r,i=e.tonalOffset,o=void 0===i?.2:i,s=C(e,gr),u=e.primary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:dr[200],light:dr[50],dark:dr[400]}:{main:dr[700],light:dr[400],dark:dr[800]}}(n),c=e.secondary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:hr[200],light:hr[50],dark:hr[400]}:{main:hr[500],light:hr[300],dark:hr[700]}}(n),l=e.error||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:fr[500],light:fr[300],dark:fr[700]}:{main:fr[700],light:fr[400],dark:fr[800]}}(n),h=e.info||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:mr[400],light:mr[300],dark:mr[700]}:{main:mr[700],light:mr[500],dark:mr[900]}}(n),f=e.success||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:vr[400],light:vr[300],dark:vr[700]}:{main:vr[800],light:vr[500],dark:vr[900]}}(n),p=e.warning||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:pr[400],light:pr[300],dark:pr[700]}:{main:"#ed6c02",light:pr[500],dark:pr[900]}}(n);function d(e){var t=function(e,t){var n=ir(e),r=ir(t);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}(e,br.text.primary)>=a?br.text.primary:yr.text.primary;return t}var m=function(e){var t=e.color,n=e.name,r=e.mainShade,a=void 0===r?500:r,i=e.lightShade,s=void 0===i?300:i,u=e.darkShade,c=void 0===u?700:u;if(!(t=S({},t)).main&&t[a]&&(t.main=t[a]),!t.hasOwnProperty("main"))throw new Error(lt(11,n?" (".concat(n,")"):"",a));if("string"!==typeof t.main)throw new Error(lt(12,n?" (".concat(n,")"):"",JSON.stringify(t.main)));return kr(t,"light",s,o),kr(t,"dark",c,o),t.contrastText||(t.contrastText=d(t.main)),t},v={dark:br,light:yr};return ut(S({common:S({},cr),mode:n,primary:m({color:u,name:"primary"}),secondary:m({color:c,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:m({color:l,name:"error"}),warning:m({color:p,name:"warning"}),info:m({color:h,name:"info"}),success:m({color:f,name:"success"}),grey:lr,contrastThreshold:a,getContrastText:d,augmentColor:m,tonalOffset:o},v[n]),s)}var wr=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];var _r={textTransform:"uppercase"},Sr='"Roboto", "Helvetica", "Arial", sans-serif';function Cr(e,t){var n="function"===typeof t?t(e):t,r=n.fontFamily,a=void 0===r?Sr:r,i=n.fontSize,o=void 0===i?14:i,s=n.fontWeightLight,u=void 0===s?300:s,c=n.fontWeightRegular,l=void 0===c?400:c,h=n.fontWeightMedium,f=void 0===h?500:h,p=n.fontWeightBold,d=void 0===p?700:p,m=n.htmlFontSize,v=void 0===m?16:m,g=n.allVariants,y=n.pxToRem,b=C(n,wr);var k=o/14,x=y||function(e){return"".concat(e/v*k,"rem")},w=function(e,t,n,r,i){return S({fontFamily:a,fontWeight:e,fontSize:x(t),lineHeight:n},a===Sr?{letterSpacing:"".concat((o=r/t,Math.round(1e5*o)/1e5),"em")}:{},i,g);var o},_={h1:w(u,96,1.167,-1.5),h2:w(u,60,1.2,-.5),h3:w(l,48,1.167,0),h4:w(l,34,1.235,.25),h5:w(l,24,1.334,0),h6:w(f,20,1.6,.15),subtitle1:w(l,16,1.75,.15),subtitle2:w(f,14,1.57,.1),body1:w(l,16,1.5,.15),body2:w(l,14,1.43,.15),button:w(f,14,1.75,.4,_r),caption:w(l,12,1.66,.4),overline:w(l,12,2.66,1,_r)};return ut(S({htmlFontSize:v,pxToRem:x,fontFamily:a,fontSize:o,fontWeightLight:u,fontWeightRegular:l,fontWeightMedium:f,fontWeightBold:d},_),b,{clone:!1})}function Tr(){return["".concat(arguments.length<=0?void 0:arguments[0],"px ").concat(arguments.length<=1?void 0:arguments[1],"px ").concat(arguments.length<=2?void 0:arguments[2],"px ").concat(arguments.length<=3?void 0:arguments[3],"px rgba(0,0,0,").concat(.2,")"),"".concat(arguments.length<=4?void 0:arguments[4],"px ").concat(arguments.length<=5?void 0:arguments[5],"px ").concat(arguments.length<=6?void 0:arguments[6],"px ").concat(arguments.length<=7?void 0:arguments[7],"px rgba(0,0,0,").concat(.14,")"),"".concat(arguments.length<=8?void 0:arguments[8],"px ").concat(arguments.length<=9?void 0:arguments[9],"px ").concat(arguments.length<=10?void 0:arguments[10],"px ").concat(arguments.length<=11?void 0:arguments[11],"px rgba(0,0,0,").concat(.12,")")].join(",")}var Er=["none",Tr(0,2,1,-1,0,1,1,0,0,1,3,0),Tr(0,3,1,-2,0,2,2,0,0,1,5,0),Tr(0,3,3,-2,0,3,4,0,0,1,8,0),Tr(0,2,4,-1,0,4,5,0,0,1,10,0),Tr(0,3,5,-1,0,5,8,0,0,1,14,0),Tr(0,3,5,-1,0,6,10,0,0,1,18,0),Tr(0,4,5,-2,0,7,10,1,0,2,16,1),Tr(0,5,5,-3,0,8,10,1,0,3,14,2),Tr(0,5,6,-3,0,9,12,1,0,3,16,2),Tr(0,6,6,-3,0,10,14,1,0,4,18,3),Tr(0,6,7,-4,0,11,15,1,0,4,20,3),Tr(0,7,8,-4,0,12,17,2,0,5,22,4),Tr(0,7,8,-4,0,13,19,2,0,5,24,4),Tr(0,7,9,-4,0,14,21,2,0,5,26,4),Tr(0,8,9,-5,0,15,22,2,0,6,28,5),Tr(0,8,10,-5,0,16,24,2,0,6,30,5),Tr(0,8,11,-5,0,17,26,2,0,6,32,5),Tr(0,9,11,-5,0,18,28,2,0,7,34,6),Tr(0,9,12,-6,0,19,29,2,0,7,36,6),Tr(0,10,13,-6,0,20,31,3,0,8,38,7),Tr(0,10,13,-6,0,21,33,3,0,8,40,7),Tr(0,10,14,-6,0,22,35,3,0,8,42,7),Tr(0,11,14,-7,0,23,36,3,0,9,44,8),Tr(0,11,15,-7,0,24,38,3,0,9,46,8)],Ir=["duration","easing","delay"],Ar={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},Nr={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function Pr(e){return"".concat(Math.round(e),"ms")}function Mr(e){if(!e)return 0;var t=e/36;return Math.round(10*(4+15*Math.pow(t,.25)+t/5))}function Dr(e){var t=S({},Ar,e.easing),n=S({},Nr,e.duration);return S({getAutoHeightDuration:Mr,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r.duration,i=void 0===a?n.standard:a,o=r.easing,s=void 0===o?t.easeInOut:o,u=r.delay,c=void 0===u?0:u;C(r,Ir);return(Array.isArray(e)?e:[e]).map((function(e){return"".concat(e," ").concat("string"===typeof i?i:Pr(i)," ").concat(s," ").concat("string"===typeof c?c:Pr(c))})).join(",")}},e,{easing:t,duration:n})}var Rr={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},Or=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function Fr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.mixins,n=void 0===t?{}:t,r=e.palette,a=void 0===r?{}:r,i=e.transitions,o=void 0===i?{}:i,s=e.typography,u=void 0===s?{}:s,c=C(e,Or),l=xr(a),h=Wn(e),f=ut(h,{mixins:tr(h.breakpoints,n),palette:l,shadows:Er.slice(),typography:Cr(l,u),transitions:Dr(o),zIndex:S({},Rr)});f=ut(f,c);for(var p=arguments.length,d=new Array(p>1?p-1:0),m=1;m<p;m++)d[m-1]=arguments[m];return f=d.reduce((function(e,t){return ut(e,t)}),f)}var Lr=Fr,zr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.defaultTheme,n=e.defaultClassName,r=void 0===n?"MuiBox-root":n,i=e.generateClassName,o=e.styleFunctionSx,s=void 0===o?Rn:o,u=it("div")(s),c=a.forwardRef((function(e,n){var a=Qn(t),o=zn(e),s=o.className,c=o.component,l=void 0===c?"div":c,h=C(o,$n);return(0,y.jsx)(u,S({as:l,ref:n,className:E(s,i?i(r):r),theme:a},h))}));return c}({defaultTheme:Lr(),defaultClassName:"MuiBox-root",generateClassName:er.generate}),Br=zr;function Vr(e,t,n){var r={};return Object.keys(e).forEach((function(a){r[a]=e[a].reduce((function(e,r){return r&&(n&&n[r]&&e.push(n[r]),e.push(t(r))),e}),[]).join(" ")})),r}function jr(e,t){var n=S({},t);return Object.keys(e).forEach((function(t){void 0===n[t]&&(n[t]=e[t])})),n}function qr(e){var t=e.props,n=e.name,r=e.defaultTheme,a=function(e){var t=e.theme,n=e.name,r=e.props;return t&&t.components&&t.components[n]&&t.components[n].defaultProps?jr(t.components[n].defaultProps,r):r}({theme:Qn(r),name:n,props:t});return a}var Gr=Lr();function Wr(e){return qr({props:e.props,name:e.name,defaultTheme:Gr})}var Ur=["variant"];function Hr(e){return 0===e.length}function Kr(e){var t=e.variant,n=C(e,Ur),r=t||"";return Object.keys(n).sort().forEach((function(t){r+="color"===t?Hr(r)?e[t]:ht(e[t]):"".concat(Hr(r)?t:ht(t)).concat(ht(e[t].toString()))})),r}var Xr=["name","slot","skipVariantsResolver","skipSx","overridesResolver"],Yr=["theme"],Qr=["theme"];function $r(e){return 0===Object.keys(e).length}var Jr=function(e,t){return t.components&&t.components[e]&&t.components[e].styleOverrides?t.components[e].styleOverrides:null},Zr=function(e,t){var n=[];t&&t.components&&t.components[e]&&t.components[e].variants&&(n=t.components[e].variants);var r={};return n.forEach((function(e){var t=Kr(e.props);r[t]=e.style})),r},ea=function(e,t,n,r){var a,i,o=e.ownerState,s=void 0===o?{}:o,u=[],c=null==n||null==(a=n.components)||null==(i=a[r])?void 0:i.variants;return c&&c.forEach((function(n){var r=!0;Object.keys(n.props).forEach((function(t){s[t]!==n.props[t]&&e[t]!==n.props[t]&&(r=!1)})),r&&u.push(t[Kr(n.props)])})),u};function ta(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}var na=Wn();var ra=function(e){return ta(e)&&"classes"!==e},aa=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.defaultTheme,n=void 0===t?na:t,r=e.rootShouldForwardProp,a=void 0===r?ta:r,i=e.slotShouldForwardProp,o=void 0===i?ta:i,s=e.styleFunctionSx,u=void 0===s?Rn:s;return function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.name,s=r.slot,c=r.skipVariantsResolver,l=r.skipSx,h=r.overridesResolver,f=C(r,Xr),p=void 0!==c?c:s&&"Root"!==s||!1,d=l||!1;var m=ta;"Root"===s?m=a:s&&(m=o);var v=it(e,S({shouldForwardProp:m,label:t},f)),g=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];var o=r?r.map((function(e){return"function"===typeof e&&e.__emotion_real!==e?function(t){var r=t.theme,a=C(t,Yr);return e(S({theme:$r(r)?n:r},a))}:e})):[],s=e;i&&h&&o.push((function(e){var t=$r(e.theme)?n:e.theme,r=Jr(i,t);if(r){var a={};return Object.entries(r).forEach((function(n){var r=Ct(n,2),i=r[0],o=r[1];a[i]="function"===typeof o?o(S({},e,{theme:t})):o})),h(e,a)}return null})),i&&!p&&o.push((function(e){var t=$r(e.theme)?n:e.theme;return ea(e,Zr(i,t),t,i)})),d||o.push((function(e){var t=$r(e.theme)?n:e.theme;return u(S({},e,{theme:t}))}));var c=o.length-r.length;if(Array.isArray(e)&&c>0){var l=new Array(c).fill("");(s=[].concat(Fn(e),Fn(l))).raw=[].concat(Fn(e.raw),Fn(l))}else"function"===typeof e&&e.__emotion_real!==e&&(s=function(t){var r=t.theme,a=C(t,Qr);return e(S({theme:$r(r)?n:r},a))});var f=v.apply(void 0,[s].concat(Fn(o)));return f};return v.withConfig&&(g.withConfig=v.withConfig),g}}({defaultTheme:Gr,rootShouldForwardProp:ra}),ia=aa,oa={active:"Mui-active",checked:"Mui-checked",completed:"Mui-completed",disabled:"Mui-disabled",error:"Mui-error",expanded:"Mui-expanded",focused:"Mui-focused",focusVisible:"Mui-focusVisible",required:"Mui-required",selected:"Mui-selected"};function sa(e,t){return oa[t]||"".concat(er.generate(e),"-").concat(t)}function ua(e,t){var n={};return t.forEach((function(t){n[t]=sa(e,t)})),n}function ca(e){return sa("MuiStepper",e)}ua("MuiStepper",["root","horizontal","vertical","alternativeLabel"]);var la=ht,ha=a.createContext({});var fa=ha,pa=a.createContext({});var da=pa;function ma(e){return sa("MuiStepConnector",e)}ua("MuiStepConnector",["root","horizontal","vertical","alternativeLabel","active","completed","disabled","line","lineHorizontal","lineVertical"]);var va=["className"],ga=ia("div",{name:"MuiStepConnector",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,t[n.orientation],n.alternativeLabel&&t.alternativeLabel,n.completed&&t.completed]}})((function(e){var t=e.ownerState;return S({flex:"1 1 auto"},"vertical"===t.orientation&&{marginLeft:12},t.alternativeLabel&&{position:"absolute",top:12,left:"calc(-50% + 20px)",right:"calc(50% + 20px)"})})),ya=ia("span",{name:"MuiStepConnector",slot:"Line",overridesResolver:function(e,t){var n=e.ownerState;return[t.line,t["line".concat(la(n.orientation))]]}})((function(e){var t=e.ownerState,n=e.theme;return S({display:"block",borderColor:"light"===n.palette.mode?n.palette.grey[400]:n.palette.grey[600]},"horizontal"===t.orientation&&{borderTopStyle:"solid",borderTopWidth:1},"vertical"===t.orientation&&{borderLeftStyle:"solid",borderLeftWidth:1,minHeight:24})})),ba=a.forwardRef((function(e,t){var n=Wr({props:e,name:"MuiStepConnector"}),r=n.className,i=C(n,va),o=a.useContext(fa),s=o.alternativeLabel,u=o.orientation,c=void 0===u?"horizontal":u,l=a.useContext(da),h=l.active,f=l.disabled,p=S({},n,{alternativeLabel:s,orientation:c,active:h,completed:l.completed,disabled:f}),d=function(e){var t=e.classes,n=e.orientation;return Vr({root:["root",n,e.alternativeLabel&&"alternativeLabel",e.active&&"active",e.completed&&"completed",e.disabled&&"disabled"],line:["line","line".concat(la(n))]},ma,t)}(p);return(0,y.jsx)(ga,S({className:E(d.root,r),ref:t,ownerState:p},i,{children:(0,y.jsx)(ya,{className:d.line,ownerState:p})}))})),ka=["activeStep","alternativeLabel","children","className","connector","nonLinear","orientation"],xa=ia("div",{name:"MuiStepper",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,t[n.orientation],n.alternativeLabel&&t.alternativeLabel]}})((function(e){var t=e.ownerState;return S({display:"flex"},"horizontal"===t.orientation&&{flexDirection:"row",alignItems:"center"},"vertical"===t.orientation&&{flexDirection:"column"},t.alternativeLabel&&{alignItems:"flex-start"})})),wa=(0,y.jsx)(ba,{}),_a=a.forwardRef((function(e,t){var n=Wr({props:e,name:"MuiStepper"}),r=n.activeStep,i=void 0===r?0:r,o=n.alternativeLabel,s=void 0!==o&&o,u=n.children,c=n.className,l=n.connector,h=void 0===l?wa:l,f=n.nonLinear,p=void 0!==f&&f,d=n.orientation,m=void 0===d?"horizontal":d,v=C(n,ka),g=S({},n,{alternativeLabel:s,orientation:m}),b=function(e){return Vr({root:["root",e.orientation,e.alternativeLabel&&"alternativeLabel"]},ca,e.classes)}(g),k=a.Children.toArray(u).filter(Boolean),x=k.map((function(e,t){return a.cloneElement(e,S({index:t,last:t+1===k.length},e.props))})),w=a.useMemo((function(){return{activeStep:i,alternativeLabel:s,connector:h,nonLinear:p,orientation:m}}),[i,s,h,p,m]);return(0,y.jsx)(fa.Provider,{value:w,children:(0,y.jsx)(xa,S({ownerState:g,className:E(b.root,c),ref:t},v,{children:x}))})})),Sa=_a;function Ca(e){return sa("MuiStep",e)}ua("MuiStep",["root","horizontal","vertical","alternativeLabel","completed"]);var Ta=["active","children","className","completed","disabled","expanded","index","last"],Ea=ia("div",{name:"MuiStep",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,t[n.orientation],n.alternativeLabel&&t.alternativeLabel,n.completed&&t.completed]}})((function(e){var t=e.ownerState;return S({},"horizontal"===t.orientation&&{paddingLeft:8,paddingRight:8},t.alternativeLabel&&{flex:1,position:"relative"})})),Ia=a.forwardRef((function(e,t){var n=Wr({props:e,name:"MuiStep"}),r=n.active,i=n.children,o=n.className,s=n.completed,u=n.disabled,c=n.expanded,l=void 0!==c&&c,h=n.index,f=n.last,p=C(n,Ta),d=a.useContext(fa),m=d.activeStep,v=d.connector,g=d.alternativeLabel,b=d.orientation,k=d.nonLinear,x=void 0!==r&&r,w=void 0!==s&&s,_=void 0!==u&&u;m===h?x=void 0===r||r:!k&&m>h?w=void 0===s||s:!k&&m<h&&(_=void 0===u||u);var T=a.useMemo((function(){return{index:h,last:f,expanded:l,icon:h+1,active:x,completed:w,disabled:_}}),[h,f,l,x,w,_]),I=S({},n,{active:x,orientation:b,alternativeLabel:g,completed:w,disabled:_,expanded:l}),A=function(e){var t=e.classes;return Vr({root:["root",e.orientation,e.alternativeLabel&&"alternativeLabel",e.completed&&"completed"]},Ca,t)}(I),N=(0,y.jsxs)(Ea,S({className:E(A.root,o),ref:t,ownerState:I},p,{children:[v&&g&&0!==h?v:null,i]}));return(0,y.jsx)(da.Provider,{value:T,children:v&&!g&&0!==h?(0,y.jsxs)(a.Fragment,{children:[v,N]}):N})})),Aa=Ia;function Na(e){return sa("MuiSvgIcon",e)}ua("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);var Pa=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],Ma=ia("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,"inherit"!==n.color&&t["color".concat(la(n.color))],t["fontSize".concat(la(n.fontSize))]]}})((function(e){var t,n,r,a,i,o,s,u,c,l,h,f,p,d,m,v,g,y=e.theme,b=e.ownerState;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:"currentColor",flexShrink:0,transition:null==(t=y.transitions)||null==(n=t.create)?void 0:n.call(t,"fill",{duration:null==(r=y.transitions)||null==(a=r.duration)?void 0:a.shorter}),fontSize:{inherit:"inherit",small:(null==(i=y.typography)||null==(o=i.pxToRem)?void 0:o.call(i,20))||"1.25rem",medium:(null==(s=y.typography)||null==(u=s.pxToRem)?void 0:u.call(s,24))||"1.5rem",large:(null==(c=y.typography)||null==(l=c.pxToRem)?void 0:l.call(c,35))||"2.1875"}[b.fontSize],color:null!=(h=null==(f=(y.vars||y).palette)||null==(p=f[b.color])?void 0:p.main)?h:{action:null==(d=(y.vars||y).palette)||null==(m=d.action)?void 0:m.active,disabled:null==(v=(y.vars||y).palette)||null==(g=v.action)?void 0:g.disabled,inherit:void 0}[b.color]}})),Da=a.forwardRef((function(e,t){var n=Wr({props:e,name:"MuiSvgIcon"}),r=n.children,a=n.className,i=n.color,o=void 0===i?"inherit":i,s=n.component,u=void 0===s?"svg":s,c=n.fontSize,l=void 0===c?"medium":c,h=n.htmlColor,f=n.inheritViewBox,p=void 0!==f&&f,d=n.titleAccess,m=n.viewBox,v=void 0===m?"0 0 24 24":m,g=C(n,Pa),b=S({},n,{color:o,component:u,fontSize:l,instanceFontSize:e.fontSize,inheritViewBox:p,viewBox:v}),k={};p||(k.viewBox=v);var x=function(e){var t=e.color,n=e.fontSize,r=e.classes;return Vr({root:["root","inherit"!==t&&"color".concat(la(t)),"fontSize".concat(la(n))]},Na,r)}(b);return(0,y.jsxs)(Ma,S({as:u,className:E(x.root,a),ownerState:b,focusable:"false",color:h,"aria-hidden":!d||void 0,role:d?"img":void 0,ref:t},k,g,{children:[r,d?(0,y.jsx)("title",{children:d}):null]}))}));Da.muiName="SvgIcon";var Ra=Da;function Oa(e,t){var n=function(n,r){return(0,y.jsx)(Ra,S({"data-testid":"".concat(t,"Icon"),ref:r},n,{children:e}))};return n.muiName=Ra.muiName,a.memo(a.forwardRef(n))}var Fa=Oa((0,y.jsx)("path",{d:"M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 17l-5-5 1.4-1.4 3.6 3.6 7.6-7.6L19 8l-9 9z"}),"CheckCircle"),La=Oa((0,y.jsx)("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}),"Warning");function za(e){return sa("MuiStepIcon",e)}var Ba,Va=ua("MuiStepIcon",["root","active","completed","error","text"]),ja=["active","className","completed","error","icon"],qa=ia(Ra,{name:"MuiStepIcon",slot:"Root",overridesResolver:function(e,t){return t.root}})((function(e){var t,n=e.theme;return ot(t={display:"block",transition:n.transitions.create("color",{duration:n.transitions.duration.shortest}),color:(n.vars||n).palette.text.disabled},"&.".concat(Va.completed),{color:(n.vars||n).palette.primary.main}),ot(t,"&.".concat(Va.active),{color:(n.vars||n).palette.primary.main}),ot(t,"&.".concat(Va.error),{color:(n.vars||n).palette.error.main}),t})),Ga=ia("text",{name:"MuiStepIcon",slot:"Text",overridesResolver:function(e,t){return t.text}})((function(e){var t=e.theme;return{fill:(t.vars||t).palette.primary.contrastText,fontSize:t.typography.caption.fontSize,fontFamily:t.typography.fontFamily}})),Wa=a.forwardRef((function(e,t){var n=Wr({props:e,name:"MuiStepIcon"}),r=n.active,a=void 0!==r&&r,i=n.className,o=n.completed,s=void 0!==o&&o,u=n.error,c=void 0!==u&&u,l=n.icon,h=C(n,ja),f=S({},n,{active:a,completed:s,error:c}),p=function(e){var t=e.classes;return Vr({root:["root",e.active&&"active",e.completed&&"completed",e.error&&"error"],text:["text"]},za,t)}(f);if("number"===typeof l||"string"===typeof l){var d=E(i,p.root);return c?(0,y.jsx)(qa,S({as:La,className:d,ref:t,ownerState:f},h)):s?(0,y.jsx)(qa,S({as:Fa,className:d,ref:t,ownerState:f},h)):(0,y.jsxs)(qa,S({className:d,ref:t,ownerState:f},h,{children:[Ba||(Ba=(0,y.jsx)("circle",{cx:"12",cy:"12",r:"12"})),(0,y.jsx)(Ga,{className:p.text,x:"12",y:"16",textAnchor:"middle",ownerState:f,children:l})]}))}return l}));function Ua(e){return sa("MuiStepLabel",e)}var Ha=ua("MuiStepLabel",["root","horizontal","vertical","label","active","completed","error","disabled","iconContainer","alternativeLabel","labelContainer"]),Ka=["children","className","componentsProps","error","icon","optional","StepIconComponent","StepIconProps"],Xa=ia("span",{name:"MuiStepLabel",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,t[n.orientation]]}})((function(e){var t,n=e.ownerState;return S((ot(t={display:"flex",alignItems:"center"},"&.".concat(Ha.alternativeLabel),{flexDirection:"column"}),ot(t,"&.".concat(Ha.disabled),{cursor:"default"}),t),"vertical"===n.orientation&&{textAlign:"left",padding:"8px 0"})})),Ya=ia("span",{name:"MuiStepLabel",slot:"Label",overridesResolver:function(e,t){return t.label}})((function(e){var t,n=e.theme;return S({},n.typography.body2,(ot(t={display:"block",transition:n.transitions.create("color",{duration:n.transitions.duration.shortest})},"&.".concat(Ha.active),{color:(n.vars||n).palette.text.primary,fontWeight:500}),ot(t,"&.".concat(Ha.completed),{color:(n.vars||n).palette.text.primary,fontWeight:500}),ot(t,"&.".concat(Ha.alternativeLabel),{textAlign:"center",marginTop:16}),ot(t,"&.".concat(Ha.error),{color:(n.vars||n).palette.error.main}),t))})),Qa=ia("span",{name:"MuiStepLabel",slot:"IconContainer",overridesResolver:function(e,t){return t.iconContainer}})((function(){return ot({flexShrink:0,display:"flex",paddingRight:8},"&.".concat(Ha.alternativeLabel),{paddingRight:0})})),$a=ia("span",{name:"MuiStepLabel",slot:"LabelContainer",overridesResolver:function(e,t){return t.labelContainer}})((function(e){var t=e.theme;return{width:"100%",color:(t.vars||t).palette.text.secondary}})),Ja=a.forwardRef((function(e,t){var n=Wr({props:e,name:"MuiStepLabel"}),r=n.children,i=n.className,o=n.componentsProps,s=void 0===o?{}:o,u=n.error,c=void 0!==u&&u,l=n.icon,h=n.optional,f=n.StepIconComponent,p=n.StepIconProps,d=C(n,Ka),m=a.useContext(fa),v=m.alternativeLabel,g=m.orientation,b=a.useContext(da),k=b.active,x=b.disabled,w=b.completed,_=b.icon,T=l||_,I=f;T&&!I&&(I=Wa);var A=S({},n,{active:k,alternativeLabel:v,completed:w,disabled:x,error:c,orientation:g}),N=function(e){var t=e.classes,n=e.orientation,r=e.active,a=e.completed,i=e.error,o=e.disabled,s=e.alternativeLabel;return Vr({root:["root",n,i&&"error",o&&"disabled",s&&"alternativeLabel"],label:["label",r&&"active",a&&"completed",i&&"error",o&&"disabled",s&&"alternativeLabel"],iconContainer:["iconContainer",s&&"alternativeLabel"],labelContainer:["labelContainer"]},Ua,t)}(A);return(0,y.jsxs)(Xa,S({className:E(N.root,i),ref:t,ownerState:A},d,{children:[T||I?(0,y.jsx)(Qa,{className:N.iconContainer,ownerState:A,children:(0,y.jsx)(I,S({completed:w,active:k,error:c,icon:T},p))}):null,(0,y.jsxs)($a,{className:N.labelContainer,ownerState:A,children:[r?(0,y.jsx)(Ya,S({className:N.label,ownerState:A},s.label,{children:r})):null,h]})]}))}));Ja.muiName="StepLabel";var Za=Ja;function ei(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,l(e,t)}var ti=__webpack_require__(4164),ni=!1,ri=a.createContext(null),ai="unmounted",ii="exited",oi="entering",si="entered",ui="exiting",ci=function(e){function t(t,n){var r;r=e.call(this,t,n)||this;var a,i=n&&!n.isMounting?t.enter:t.appear;return r.appearStatus=null,t.in?i?(a=ii,r.appearStatus=oi):a=si:a=t.unmountOnExit||t.mountOnEnter?ai:ii,r.state={status:a},r.nextCallback=null,r}ei(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===ai?{status:ii}:null};var n=t.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==oi&&n!==si&&(t=oi):n!==oi&&n!==si||(t=ui)}this.updateStatus(!1,t)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var e,t,n,r=this.props.timeout;return e=t=n=r,null!=r&&"number"!==typeof r&&(e=r.exit,t=r.enter,n=void 0!==r.appear?r.appear:t),{exit:e,enter:t,appear:n}},n.updateStatus=function(e,t){void 0===e&&(e=!1),null!==t?(this.cancelNextCallback(),t===oi?this.performEnter(e):this.performExit()):this.props.unmountOnExit&&this.state.status===ii&&this.setState({status:ai})},n.performEnter=function(e){var t=this,n=this.props.enter,r=this.context?this.context.isMounting:e,a=this.props.nodeRef?[r]:[ti.findDOMNode(this),r],i=a[0],o=a[1],s=this.getTimeouts(),u=r?s.appear:s.enter;!e&&!n||ni?this.safeSetState({status:si},(function(){t.props.onEntered(i)})):(this.props.onEnter(i,o),this.safeSetState({status:oi},(function(){t.props.onEntering(i,o),t.onTransitionEnd(u,(function(){t.safeSetState({status:si},(function(){t.props.onEntered(i,o)}))}))})))},n.performExit=function(){var e=this,t=this.props.exit,n=this.getTimeouts(),r=this.props.nodeRef?void 0:ti.findDOMNode(this);t&&!ni?(this.props.onExit(r),this.safeSetState({status:ui},(function(){e.props.onExiting(r),e.onTransitionEnd(n.exit,(function(){e.safeSetState({status:ii},(function(){e.props.onExited(r)}))}))}))):this.safeSetState({status:ii},(function(){e.props.onExited(r)}))},n.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},n.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(r){n&&(n=!1,t.nextCallback=null,e(r))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},n.onTransitionEnd=function(e,t){this.setNextCallback(t);var n=this.props.nodeRef?this.props.nodeRef.current:ti.findDOMNode(this),r=null==e&&!this.props.addEndListener;if(n&&!r){if(this.props.addEndListener){var a=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],i=a[0],o=a[1];this.props.addEndListener(i,o)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},n.render=function(){var e=this.state.status;if(e===ai)return null;var t=this.props,n=t.children,r=(t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef,C(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return a.createElement(ri.Provider,{value:null},"function"===typeof n?n(e,r):a.cloneElement(a.Children.only(n),r))},t}(a.Component);function li(){}ci.contextType=ri,ci.propTypes={},ci.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:li,onEntering:li,onEntered:li,onExit:li,onExiting:li,onExited:li},ci.UNMOUNTED=ai,ci.EXITED=ii,ci.ENTERING=oi,ci.ENTERED=si,ci.EXITING=ui;var hi=ci;function fi(e,t){var n,r,a=e.timeout,i=e.easing,o=e.style,s=void 0===o?{}:o;return{duration:null!=(n=s.transitionDuration)?n:"number"===typeof a?a:a[t.mode]||0,easing:null!=(r=s.transitionTimingFunction)?r:"object"===typeof i?i[t.mode]:i,delay:s.transitionDelay}}function pi(e,t){"function"===typeof e?e(t):e&&(e.current=t)}var di=function(e,t){return a.useMemo((function(){return null==e&&null==t?null:function(n){pi(e,n),pi(t,n)}}),[e,t])};function mi(e){return sa("MuiCollapse",e)}ua("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);var vi=["addEndListener","children","className","collapsedSize","component","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","orientation","style","timeout","TransitionComponent"],gi=ia("div",{name:"MuiCollapse",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,t[n.orientation],"entered"===n.state&&t.entered,"exited"===n.state&&!n.in&&"0px"===n.collapsedSize&&t.hidden]}})((function(e){var t=e.theme,n=e.ownerState;return S({height:0,overflow:"hidden",transition:t.transitions.create("height")},"horizontal"===n.orientation&&{height:"auto",width:0,transition:t.transitions.create("width")},"entered"===n.state&&S({height:"auto",overflow:"visible"},"horizontal"===n.orientation&&{width:"auto"}),"exited"===n.state&&!n.in&&"0px"===n.collapsedSize&&{visibility:"hidden"})})),yi=ia("div",{name:"MuiCollapse",slot:"Wrapper",overridesResolver:function(e,t){return t.wrapper}})((function(e){return S({display:"flex",width:"100%"},"horizontal"===e.ownerState.orientation&&{width:"auto",height:"100%"})})),bi=ia("div",{name:"MuiCollapse",slot:"WrapperInner",overridesResolver:function(e,t){return t.wrapperInner}})((function(e){return S({width:"100%"},"horizontal"===e.ownerState.orientation&&{width:"auto",height:"100%"})})),ki=a.forwardRef((function(e,t){var n=Wr({props:e,name:"MuiCollapse"}),r=n.addEndListener,i=n.children,o=n.className,s=n.collapsedSize,u=void 0===s?"0px":s,c=n.component,l=n.easing,h=n.in,f=n.onEnter,p=n.onEntered,d=n.onEntering,m=n.onExit,v=n.onExited,g=n.onExiting,b=n.orientation,k=void 0===b?"vertical":b,x=n.style,w=n.timeout,_=void 0===w?Nr.standard:w,T=n.TransitionComponent,I=void 0===T?hi:T,A=C(n,vi),N=S({},n,{orientation:k,collapsedSize:u}),P=function(e){var t=e.orientation,n=e.classes;return Vr({root:["root","".concat(t)],entered:["entered"],hidden:["hidden"],wrapper:["wrapper","".concat(t)],wrapperInner:["wrapperInner","".concat(t)]},mi,n)}(N),M=Qn(Gr),D=a.useRef(),R=a.useRef(null),O=a.useRef(),F="number"===typeof u?"".concat(u,"px"):u,L="horizontal"===k,z=L?"width":"height";a.useEffect((function(){return function(){clearTimeout(D.current)}}),[]);var B=a.useRef(null),V=di(t,B),j=function(e){return function(t){if(e){var n=B.current;void 0===t?e(n):e(n,t)}}},q=function(){return R.current?R.current[L?"clientWidth":"clientHeight"]:0},G=j((function(e,t){R.current&&L&&(R.current.style.position="absolute"),e.style[z]=F,f&&f(e,t)})),W=j((function(e,t){var n=q();R.current&&L&&(R.current.style.position="");var r=fi({style:x,timeout:_,easing:l},{mode:"enter"}),a=r.duration,i=r.easing;if("auto"===_){var o=M.transitions.getAutoHeightDuration(n);e.style.transitionDuration="".concat(o,"ms"),O.current=o}else e.style.transitionDuration="string"===typeof a?a:"".concat(a,"ms");e.style[z]="".concat(n,"px"),e.style.transitionTimingFunction=i,d&&d(e,t)})),U=j((function(e,t){e.style[z]="auto",p&&p(e,t)})),H=j((function(e){e.style[z]="".concat(q(),"px"),m&&m(e)})),K=j(v),X=j((function(e){var t=q(),n=fi({style:x,timeout:_,easing:l},{mode:"exit"}),r=n.duration,a=n.easing;if("auto"===_){var i=M.transitions.getAutoHeightDuration(t);e.style.transitionDuration="".concat(i,"ms"),O.current=i}else e.style.transitionDuration="string"===typeof r?r:"".concat(r,"ms");e.style[z]=F,e.style.transitionTimingFunction=a,g&&g(e)}));return(0,y.jsx)(I,S({in:h,onEnter:G,onEntered:U,onEntering:W,onExit:H,onExited:K,onExiting:X,addEndListener:function(e){"auto"===_&&(D.current=setTimeout(e,O.current||0)),r&&r(B.current,e)},nodeRef:B,timeout:"auto"===_?null:_},A,{children:function(e,t){return(0,y.jsx)(gi,S({as:c,className:E(P.root,o,{entered:P.entered,exited:!h&&"0px"===F&&P.hidden}[e]),style:S(ot({},L?"minWidth":"minHeight",F),x),ownerState:S({},N,{state:e}),ref:V},t,{children:(0,y.jsx)(yi,{ownerState:S({},N,{state:e}),className:P.wrapper,ref:R,children:(0,y.jsx)(bi,{ownerState:S({},N,{state:e}),className:P.wrapperInner,children:i})})}))}}))}));ki.muiSupportAuto=!0;var xi=ki;function wi(e){return sa("MuiStepContent",e)}ua("MuiStepContent",["root","last","transition"]);var _i=["children","className","TransitionComponent","transitionDuration","TransitionProps"],Si=ia("div",{name:"MuiStepContent",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,n.last&&t.last]}})((function(e){var t=e.ownerState,n=e.theme;return S({marginLeft:12,paddingLeft:20,paddingRight:8,borderLeft:"1px solid ".concat("light"===n.palette.mode?n.palette.grey[400]:n.palette.grey[600])},t.last&&{borderLeft:"none"})})),Ci=ia(xi,{name:"MuiStepContent",slot:"Transition",overridesResolver:function(e,t){return t.transition}})({}),Ti=a.forwardRef((function(e,t){var n=Wr({props:e,name:"MuiStepContent"}),r=n.children,i=n.className,o=n.TransitionComponent,s=void 0===o?xi:o,u=n.transitionDuration,c=void 0===u?"auto":u,l=n.TransitionProps,h=C(n,_i),f=(a.useContext(fa).orientation,a.useContext(da)),p=f.active,d=f.last,m=f.expanded,v=S({},n,{last:d}),g=function(e){var t=e.classes;return Vr({root:["root",e.last&&"last"],transition:["transition"]},wi,t)}(v);var b=c;return"auto"!==c||s.muiSupportAuto||(b=void 0),(0,y.jsx)(Si,S({className:E(g.root,i),ref:t,ownerState:v},h,{children:(0,y.jsx)(Ci,S({as:s,in:p||m,className:g.transition,ownerState:v,timeout:b,unmountOnExit:!0},l,{children:r}))}))})),Ei=Ti,Ii="undefined"!==typeof window?a.useLayoutEffect:a.useEffect;var Ai,Ni=function(e){var t=a.useRef(e);return Ii((function(){t.current=e})),a.useCallback((function(){return t.current.apply(void 0,arguments)}),[])},Pi=!0,Mi=!1,Di={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function Ri(e){e.metaKey||e.altKey||e.ctrlKey||(Pi=!0)}function Oi(){Pi=!1}function Fi(){"hidden"===this.visibilityState&&Mi&&(Pi=!0)}function Li(e){var t=e.target;try{return t.matches(":focus-visible")}catch(n){}return Pi||function(e){var t=e.type,n=e.tagName;return!("INPUT"!==n||!Di[t]||e.readOnly)||"TEXTAREA"===n&&!e.readOnly||!!e.isContentEditable}(t)}var zi=function(){var e=a.useCallback((function(e){var t;null!=e&&((t=e.ownerDocument).addEventListener("keydown",Ri,!0),t.addEventListener("mousedown",Oi,!0),t.addEventListener("pointerdown",Oi,!0),t.addEventListener("touchstart",Oi,!0),t.addEventListener("visibilitychange",Fi,!0))}),[]),t=a.useRef(!1);return{isFocusVisibleRef:t,onFocus:function(e){return!!Li(e)&&(t.current=!0,!0)},onBlur:function(){return!!t.current&&(Mi=!0,window.clearTimeout(Ai),Ai=window.setTimeout((function(){Mi=!1}),100),t.current=!1,!0)},ref:e}};function Bi(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Vi(e,t){var n=Object.create(null);return e&&a.Children.map(e,(function(e){return e})).forEach((function(e){n[e.key]=function(e){return t&&(0,a.isValidElement)(e)?t(e):e}(e)})),n}function ji(e,t,n){return null!=n[t]?n[t]:e.props[t]}function qi(e,t){return Vi(e.children,(function(n){return(0,a.cloneElement)(n,{onExited:t.bind(null,n),in:!0,appear:ji(n,"appear",e),enter:ji(n,"enter",e),exit:ji(n,"exit",e)})}))}function Gi(e,t,n){var r=Vi(e.children),i=function(e,t){function n(n){return n in t?t[n]:e[n]}e=e||{},t=t||{};var r,a=Object.create(null),i=[];for(var o in e)o in t?i.length&&(a[o]=i,i=[]):i.push(o);var s={};for(var u in t){if(a[u])for(r=0;r<a[u].length;r++){var c=a[u][r];s[a[u][r]]=n(c)}s[u]=n(u)}for(r=0;r<i.length;r++)s[i[r]]=n(i[r]);return s}(t,r);return Object.keys(i).forEach((function(o){var s=i[o];if((0,a.isValidElement)(s)){var u=o in t,c=o in r,l=t[o],h=(0,a.isValidElement)(l)&&!l.props.in;!c||u&&!h?c||!u||h?c&&u&&(0,a.isValidElement)(l)&&(i[o]=(0,a.cloneElement)(s,{onExited:n.bind(null,s),in:l.props.in,exit:ji(s,"exit",e),enter:ji(s,"enter",e)})):i[o]=(0,a.cloneElement)(s,{in:!1}):i[o]=(0,a.cloneElement)(s,{onExited:n.bind(null,s),in:!0,exit:ji(s,"exit",e),enter:ji(s,"enter",e)})}})),i}var Wi=Object.values||function(e){return Object.keys(e).map((function(t){return e[t]}))},Ui=function(e){function t(t,n){var r,a=(r=e.call(this,t,n)||this).handleExited.bind(m(r));return r.state={contextValue:{isMounting:!0},handleExited:a,firstRender:!0},r}ei(t,e);var n=t.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(e,t){var n=t.children,r=t.handleExited;return{children:t.firstRender?qi(e,r):Gi(e,n,r),firstRender:!1}},n.handleExited=function(e,t){var n=Vi(this.props.children);e.key in n||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState((function(t){var n=S({},t.children);return delete n[e.key],{children:n}})))},n.render=function(){var e=this.props,t=e.component,n=e.childFactory,r=C(e,["component","childFactory"]),i=this.state.contextValue,o=Wi(this.state.children).map(n);return delete r.appear,delete r.enter,delete r.exit,null===t?a.createElement(ri.Provider,{value:i},o):a.createElement(ri.Provider,{value:i},a.createElement(t,r,o))},t}(a.Component);Ui.propTypes={},Ui.defaultProps={component:"div",childFactory:function(e){return e}};var Hi=Ui;__webpack_require__(2110),i.useInsertionEffect?i.useInsertionEffect:a.useLayoutEffect;function Ki(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return We(t)}var Xi=function(){var e=Ki.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}};var Yi=function(e){var t=e.className,n=e.classes,r=e.pulsate,i=void 0!==r&&r,o=e.rippleX,s=e.rippleY,u=e.rippleSize,c=e.in,l=e.onExited,h=e.timeout,f=Ct(a.useState(!1),2),p=f[0],d=f[1],m=E(t,n.ripple,n.rippleVisible,i&&n.ripplePulsate),v={width:u,height:u,top:-u/2+s,left:-u/2+o},g=E(n.child,p&&n.childLeaving,i&&n.childPulsate);return c||p||d(!0),a.useEffect((function(){if(!c&&null!=l){var e=setTimeout(l,h);return function(){clearTimeout(e)}}}),[l,c,h]),(0,y.jsx)("span",{className:m,style:v,children:(0,y.jsx)("span",{className:g})})};var Qi,$i,Ji,Zi,eo,to,no,ro,ao=ua("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),io=["center","classes","className"],oo=Xi(eo||(eo=Qi||(Qi=Bi(["\n  0% {\n    transform: scale(0);\n    opacity: 0.1;\n  }\n\n  100% {\n    transform: scale(1);\n    opacity: 0.3;\n  }\n"])))),so=Xi(to||(to=$i||($i=Bi(["\n  0% {\n    opacity: 1;\n  }\n\n  100% {\n    opacity: 0;\n  }\n"])))),uo=Xi(no||(no=Ji||(Ji=Bi(["\n  0% {\n    transform: scale(1);\n  }\n\n  50% {\n    transform: scale(0.92);\n  }\n\n  100% {\n    transform: scale(1);\n  }\n"])))),co=ia("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),lo=ia(Yi,{name:"MuiTouchRipple",slot:"Ripple"})(ro||(ro=Zi||(Zi=Bi(["\n  opacity: 0;\n  position: absolute;\n\n  &."," {\n    opacity: 0.3;\n    transform: scale(1);\n    animation-name: ",";\n    animation-duration: ","ms;\n    animation-timing-function: ",";\n  }\n\n  &."," {\n    animation-duration: ","ms;\n  }\n\n  & ."," {\n    opacity: 1;\n    display: block;\n    width: 100%;\n    height: 100%;\n    border-radius: 50%;\n    background-color: currentColor;\n  }\n\n  & ."," {\n    opacity: 0;\n    animation-name: ",";\n    animation-duration: ","ms;\n    animation-timing-function: ",";\n  }\n\n  & ."," {\n    position: absolute;\n    /* @noflip */\n    left: 0px;\n    top: 0;\n    animation-name: ",";\n    animation-duration: 2500ms;\n    animation-timing-function: ",";\n    animation-iteration-count: infinite;\n    animation-delay: 200ms;\n  }\n"]))),ao.rippleVisible,oo,550,(function(e){return e.theme.transitions.easing.easeInOut}),ao.ripplePulsate,(function(e){return e.theme.transitions.duration.shorter}),ao.child,ao.childLeaving,so,550,(function(e){return e.theme.transitions.easing.easeInOut}),ao.childPulsate,uo,(function(e){return e.theme.transitions.easing.easeInOut})),ho=a.forwardRef((function(e,t){var n=Wr({props:e,name:"MuiTouchRipple"}),r=n.center,i=void 0!==r&&r,o=n.classes,s=void 0===o?{}:o,u=n.className,c=C(n,io),l=Ct(a.useState([]),2),h=l[0],f=l[1],p=a.useRef(0),d=a.useRef(null);a.useEffect((function(){d.current&&(d.current(),d.current=null)}),[h]);var m=a.useRef(!1),v=a.useRef(null),g=a.useRef(null),b=a.useRef(null);a.useEffect((function(){return function(){clearTimeout(v.current)}}),[]);var k=a.useCallback((function(e){var t=e.pulsate,n=e.rippleX,r=e.rippleY,a=e.rippleSize,i=e.cb;f((function(e){return[].concat(Fn(e),[(0,y.jsx)(lo,{classes:{ripple:E(s.ripple,ao.ripple),rippleVisible:E(s.rippleVisible,ao.rippleVisible),ripplePulsate:E(s.ripplePulsate,ao.ripplePulsate),child:E(s.child,ao.child),childLeaving:E(s.childLeaving,ao.childLeaving),childPulsate:E(s.childPulsate,ao.childPulsate)},timeout:550,pulsate:t,rippleX:n,rippleY:r,rippleSize:a},p.current)])})),p.current+=1,d.current=i}),[s]),x=a.useCallback((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=t.pulsate,a=void 0!==r&&r,o=t.center,s=void 0===o?i||t.pulsate:o,u=t.fakeElement,c=void 0!==u&&u;if("mousedown"===(null==e?void 0:e.type)&&m.current)m.current=!1;else{"touchstart"===(null==e?void 0:e.type)&&(m.current=!0);var l,h,f,p=c?null:b.current,d=p?p.getBoundingClientRect():{width:0,height:0,left:0,top:0};if(s||void 0===e||0===e.clientX&&0===e.clientY||!e.clientX&&!e.touches)l=Math.round(d.width/2),h=Math.round(d.height/2);else{var y=e.touches?e.touches[0]:e,x=y.clientX,w=y.clientY;l=Math.round(x-d.left),h=Math.round(w-d.top)}if(s)(f=Math.sqrt((2*Math.pow(d.width,2)+Math.pow(d.height,2))/3))%2===0&&(f+=1);else{var _=2*Math.max(Math.abs((p?p.clientWidth:0)-l),l)+2,S=2*Math.max(Math.abs((p?p.clientHeight:0)-h),h)+2;f=Math.sqrt(Math.pow(_,2)+Math.pow(S,2))}null!=e&&e.touches?null===g.current&&(g.current=function(){k({pulsate:a,rippleX:l,rippleY:h,rippleSize:f,cb:n})},v.current=setTimeout((function(){g.current&&(g.current(),g.current=null)}),80)):k({pulsate:a,rippleX:l,rippleY:h,rippleSize:f,cb:n})}}),[i,k]),w=a.useCallback((function(){x({},{pulsate:!0})}),[x]),_=a.useCallback((function(e,t){if(clearTimeout(v.current),"touchend"===(null==e?void 0:e.type)&&g.current)return g.current(),g.current=null,void(v.current=setTimeout((function(){_(e,t)})));g.current=null,f((function(e){return e.length>0?e.slice(1):e})),d.current=t}),[]);return a.useImperativeHandle(t,(function(){return{pulsate:w,start:x,stop:_}}),[w,x,_]),(0,y.jsx)(co,S({className:E(s.root,ao.root,u),ref:b},c,{children:(0,y.jsx)(Hi,{component:null,exit:!0,children:h})}))})),fo=ho;function po(e){return sa("MuiButtonBase",e)}var mo,vo=ua("MuiButtonBase",["root","disabled","focusVisible"]),go=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],yo=ia("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:function(e,t){return t.root}})((ot(mo={display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"}},"&.".concat(vo.disabled),{pointerEvents:"none",cursor:"default"}),ot(mo,"@media print",{colorAdjust:"exact"}),mo)),bo=a.forwardRef((function(e,t){var n=Wr({props:e,name:"MuiButtonBase"}),r=n.action,i=n.centerRipple,o=void 0!==i&&i,s=n.children,u=n.className,c=n.component,l=void 0===c?"button":c,h=n.disabled,f=void 0!==h&&h,p=n.disableRipple,d=void 0!==p&&p,m=n.disableTouchRipple,v=void 0!==m&&m,g=n.focusRipple,b=void 0!==g&&g,k=n.LinkComponent,x=void 0===k?"a":k,w=n.onBlur,_=n.onClick,T=n.onContextMenu,I=n.onDragLeave,A=n.onFocus,N=n.onFocusVisible,P=n.onKeyDown,M=n.onKeyUp,D=n.onMouseDown,R=n.onMouseLeave,O=n.onMouseUp,F=n.onTouchEnd,L=n.onTouchMove,z=n.onTouchStart,B=n.tabIndex,V=void 0===B?0:B,j=n.TouchRippleProps,q=n.touchRippleRef,G=n.type,W=C(n,go),U=a.useRef(null),H=a.useRef(null),K=di(H,q),X=zi(),Y=X.isFocusVisibleRef,Q=X.onFocus,$=X.onBlur,J=X.ref,Z=Ct(a.useState(!1),2),ee=Z[0],te=Z[1];f&&ee&&te(!1),a.useImperativeHandle(r,(function(){return{focusVisible:function(){te(!0),U.current.focus()}}}),[]);var ne=Ct(a.useState(!1),2),re=ne[0],ae=ne[1];a.useEffect((function(){ae(!0)}),[]);var ie=re&&!d&&!f;function oe(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v;return Ni((function(r){return t&&t(r),!n&&H.current&&H.current[e](r),!0}))}a.useEffect((function(){ee&&b&&!d&&re&&H.current.pulsate()}),[d,b,ee,re]);var se=oe("start",D),ue=oe("stop",T),ce=oe("stop",I),le=oe("stop",O),he=oe("stop",(function(e){ee&&e.preventDefault(),R&&R(e)})),fe=oe("start",z),pe=oe("stop",F),de=oe("stop",L),me=oe("stop",(function(e){$(e),!1===Y.current&&te(!1),w&&w(e)}),!1),ve=Ni((function(e){U.current||(U.current=e.currentTarget),Q(e),!0===Y.current&&(te(!0),N&&N(e)),A&&A(e)})),ge=function(){var e=U.current;return l&&"button"!==l&&!("A"===e.tagName&&e.href)},ye=a.useRef(!1),be=Ni((function(e){b&&!ye.current&&ee&&H.current&&" "===e.key&&(ye.current=!0,H.current.stop(e,(function(){H.current.start(e)}))),e.target===e.currentTarget&&ge()&&" "===e.key&&e.preventDefault(),P&&P(e),e.target===e.currentTarget&&ge()&&"Enter"===e.key&&!f&&(e.preventDefault(),_&&_(e))})),ke=Ni((function(e){b&&" "===e.key&&H.current&&ee&&!e.defaultPrevented&&(ye.current=!1,H.current.stop(e,(function(){H.current.pulsate(e)}))),M&&M(e),_&&e.target===e.currentTarget&&ge()&&" "===e.key&&!e.defaultPrevented&&_(e)})),xe=l;"button"===xe&&(W.href||W.to)&&(xe=x);var we={};"button"===xe?(we.type=void 0===G?"button":G,we.disabled=f):(W.href||W.to||(we.role="button"),f&&(we["aria-disabled"]=f));var _e=di(J,U),Se=di(t,_e);var Ce=S({},n,{centerRipple:o,component:l,disabled:f,disableRipple:d,disableTouchRipple:v,focusRipple:b,tabIndex:V,focusVisible:ee}),Te=function(e){var t=e.disabled,n=e.focusVisible,r=e.focusVisibleClassName,a=Vr({root:["root",t&&"disabled",n&&"focusVisible"]},po,e.classes);return n&&r&&(a.root+=" ".concat(r)),a}(Ce);return(0,y.jsxs)(yo,S({as:xe,className:E(Te.root,u),ownerState:Ce,onBlur:me,onClick:_,onContextMenu:ue,onFocus:ve,onKeyDown:be,onKeyUp:ke,onMouseDown:se,onMouseLeave:he,onMouseUp:le,onDragLeave:ce,onTouchEnd:pe,onTouchMove:de,onTouchStart:fe,ref:Se,tabIndex:f?-1:V,type:G},we,W,{children:[s,ie?(0,y.jsx)(fo,S({ref:K,center:o},j)):null]}))})),ko=bo;function xo(e){return sa("MuiButton",e)}var wo=ua("MuiButton",["root","text","textInherit","textPrimary","textSecondary","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","contained","containedInherit","containedPrimary","containedSecondary","disableElevation","focusVisible","disabled","colorInherit","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]);var _o=a.createContext({}),So=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],Co=function(e){return S({},"small"===e.size&&{"& > *:nth-of-type(1)":{fontSize:18}},"medium"===e.size&&{"& > *:nth-of-type(1)":{fontSize:20}},"large"===e.size&&{"& > *:nth-of-type(1)":{fontSize:22}})},To=ia(ko,{shouldForwardProp:function(e){return ra(e)||"classes"===e},name:"MuiButton",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,t[n.variant],t["".concat(n.variant).concat(la(n.color))],t["size".concat(la(n.size))],t["".concat(n.variant,"Size").concat(la(n.size))],"inherit"===n.color&&t.colorInherit,n.disableElevation&&t.disableElevation,n.fullWidth&&t.fullWidth]}})((function(e){var t,n,r,a=e.theme,i=e.ownerState;return S({},a.typography.button,(ot(t={minWidth:64,padding:"6px 16px",borderRadius:(a.vars||a).shape.borderRadius,transition:a.transitions.create(["background-color","box-shadow","border-color","color"],{duration:a.transitions.duration.short}),"&:hover":S({textDecoration:"none",backgroundColor:a.vars?"rgba(".concat(a.vars.palette.text.primaryChannel," / ").concat(a.vars.palette.action.hoverOpacity,")"):or(a.palette.text.primary,a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"text"===i.variant&&"inherit"!==i.color&&{backgroundColor:a.vars?"rgba(".concat(a.vars.palette[i.color].mainChannel," / ").concat(a.vars.palette.action.hoverOpacity,")"):or(a.palette[i.color].main,a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"outlined"===i.variant&&"inherit"!==i.color&&{border:"1px solid ".concat((a.vars||a).palette[i.color].main),backgroundColor:a.vars?"rgba(".concat(a.vars.palette[i.color].mainChannel," / ").concat(a.vars.palette.action.hoverOpacity,")"):or(a.palette[i.color].main,a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"contained"===i.variant&&{backgroundColor:(a.vars||a).palette.grey.A100,boxShadow:(a.vars||a).shadows[4],"@media (hover: none)":{boxShadow:(a.vars||a).shadows[2],backgroundColor:(a.vars||a).palette.grey[300]}},"contained"===i.variant&&"inherit"!==i.color&&{backgroundColor:(a.vars||a).palette[i.color].dark,"@media (hover: none)":{backgroundColor:(a.vars||a).palette[i.color].main}}),"&:active":S({},"contained"===i.variant&&{boxShadow:(a.vars||a).shadows[8]})},"&.".concat(wo.focusVisible),S({},"contained"===i.variant&&{boxShadow:(a.vars||a).shadows[6]})),ot(t,"&.".concat(wo.disabled),S({color:(a.vars||a).palette.action.disabled},"outlined"===i.variant&&{border:"1px solid ".concat((a.vars||a).palette.action.disabledBackground)},"outlined"===i.variant&&"secondary"===i.color&&{border:"1px solid ".concat((a.vars||a).palette.action.disabled)},"contained"===i.variant&&{color:(a.vars||a).palette.action.disabled,boxShadow:(a.vars||a).shadows[0],backgroundColor:(a.vars||a).palette.action.disabledBackground})),t),"text"===i.variant&&{padding:"6px 8px"},"text"===i.variant&&"inherit"!==i.color&&{color:(a.vars||a).palette[i.color].main},"outlined"===i.variant&&{padding:"5px 15px",border:"1px solid currentColor"},"outlined"===i.variant&&"inherit"!==i.color&&{color:(a.vars||a).palette[i.color].main,border:a.vars?"1px solid rgba(".concat(a.vars.palette[i.color].mainChannel," / 0.5)"):"1px solid ".concat(or(a.palette[i.color].main,.5))},"contained"===i.variant&&{color:a.vars?a.vars.palette.text.primary:null==(n=(r=a.palette).getContrastText)?void 0:n.call(r,a.palette.grey[300]),backgroundColor:(a.vars||a).palette.grey[300],boxShadow:(a.vars||a).shadows[2]},"contained"===i.variant&&"inherit"!==i.color&&{color:(a.vars||a).palette[i.color].contrastText,backgroundColor:(a.vars||a).palette[i.color].main},"inherit"===i.color&&{color:"inherit",borderColor:"currentColor"},"small"===i.size&&"text"===i.variant&&{padding:"4px 5px",fontSize:a.typography.pxToRem(13)},"large"===i.size&&"text"===i.variant&&{padding:"8px 11px",fontSize:a.typography.pxToRem(15)},"small"===i.size&&"outlined"===i.variant&&{padding:"3px 9px",fontSize:a.typography.pxToRem(13)},"large"===i.size&&"outlined"===i.variant&&{padding:"7px 21px",fontSize:a.typography.pxToRem(15)},"small"===i.size&&"contained"===i.variant&&{padding:"4px 10px",fontSize:a.typography.pxToRem(13)},"large"===i.size&&"contained"===i.variant&&{padding:"8px 22px",fontSize:a.typography.pxToRem(15)},i.fullWidth&&{width:"100%"})}),(function(e){var t;return e.ownerState.disableElevation&&(ot(t={boxShadow:"none","&:hover":{boxShadow:"none"}},"&.".concat(wo.focusVisible),{boxShadow:"none"}),ot(t,"&:active",{boxShadow:"none"}),ot(t,"&.".concat(wo.disabled),{boxShadow:"none"}),t)})),Eo=ia("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:function(e,t){var n=e.ownerState;return[t.startIcon,t["iconSize".concat(la(n.size))]]}})((function(e){var t=e.ownerState;return S({display:"inherit",marginRight:8,marginLeft:-4},"small"===t.size&&{marginLeft:-2},Co(t))})),Io=ia("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:function(e,t){var n=e.ownerState;return[t.endIcon,t["iconSize".concat(la(n.size))]]}})((function(e){var t=e.ownerState;return S({display:"inherit",marginRight:-4,marginLeft:8},"small"===t.size&&{marginRight:-2},Co(t))})),Ao=a.forwardRef((function(e,t){var n=a.useContext(_o),r=Wr({props:jr(n,e),name:"MuiButton"}),i=r.children,o=r.color,s=void 0===o?"primary":o,u=r.component,c=void 0===u?"button":u,l=r.className,h=r.disabled,f=void 0!==h&&h,p=r.disableElevation,d=void 0!==p&&p,m=r.disableFocusRipple,v=void 0!==m&&m,g=r.endIcon,b=r.focusVisibleClassName,k=r.fullWidth,x=void 0!==k&&k,w=r.size,_=void 0===w?"medium":w,T=r.startIcon,I=r.type,A=r.variant,N=void 0===A?"text":A,P=C(r,So),M=S({},r,{color:s,component:c,disabled:f,disableElevation:d,disableFocusRipple:v,fullWidth:x,size:_,type:I,variant:N}),D=function(e){var t=e.color,n=e.disableElevation,r=e.fullWidth,a=e.size,i=e.variant,o=e.classes;return S({},o,Vr({root:["root",i,"".concat(i).concat(la(t)),"size".concat(la(a)),"".concat(i,"Size").concat(la(a)),"inherit"===t&&"colorInherit",n&&"disableElevation",r&&"fullWidth"],label:["label"],startIcon:["startIcon","iconSize".concat(la(a))],endIcon:["endIcon","iconSize".concat(la(a))]},xo,o))}(M),R=T&&(0,y.jsx)(Eo,{className:D.startIcon,ownerState:M,children:T}),O=g&&(0,y.jsx)(Io,{className:D.endIcon,ownerState:M,children:g});return(0,y.jsxs)(To,S({ownerState:M,className:E(l,n.className),component:c,disabled:f,focusRipple:!v,focusVisibleClassName:E(D.focusVisible,b),ref:t,type:I},P,{classes:D,children:[R,i,O]}))})),No=Ao;function Po(e){return sa("MuiTypography",e)}ua("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);var Mo=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],Do=ia("span",{name:"MuiTypography",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,n.variant&&t[n.variant],"inherit"!==n.align&&t["align".concat(la(n.align))],n.noWrap&&t.noWrap,n.gutterBottom&&t.gutterBottom,n.paragraph&&t.paragraph]}})((function(e){var t=e.theme,n=e.ownerState;return S({margin:0},n.variant&&t.typography[n.variant],"inherit"!==n.align&&{textAlign:n.align},n.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},n.gutterBottom&&{marginBottom:"0.35em"},n.paragraph&&{marginBottom:16})})),Ro={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},Oo={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},Fo=a.forwardRef((function(e,t){var n=Wr({props:e,name:"MuiTypography"}),r=function(e){return Oo[e]||e}(n.color),a=zn(S({},n,{color:r})),i=a.align,o=void 0===i?"inherit":i,s=a.className,u=a.component,c=a.gutterBottom,l=void 0!==c&&c,h=a.noWrap,f=void 0!==h&&h,p=a.paragraph,d=void 0!==p&&p,m=a.variant,v=void 0===m?"body1":m,g=a.variantMapping,b=void 0===g?Ro:g,k=C(a,Mo),x=S({},a,{align:o,color:r,className:s,component:u,gutterBottom:l,noWrap:f,paragraph:d,variant:v,variantMapping:b}),w=u||(d?"p":b[v]||Ro[v])||"span",_=function(e){var t=e.align,n=e.gutterBottom,r=e.noWrap,a=e.paragraph,i=e.variant,o=e.classes;return Vr({root:["root",i,"inherit"!==e.align&&"align".concat(la(t)),n&&"gutterBottom",r&&"noWrap",a&&"paragraph"]},Po,o)}(x);return(0,y.jsx)(Do,S({as:w,ref:t,ownerState:x,className:E(_.root,s)},k))})),Lo=Fo;function zo(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_t(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}var Bo=function(){function e(t,n){s(this,e),this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return c(e,[{key:"get",value:function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}},{key:"set",value:function(e,t){this.dataIdsCount++,this.data.set(e,t)}},{key:"has",value:function(e){return this.data.has(e)}},{key:"delete",value:function(e){return this.dataIdsCount--,this.data.delete(e)}},{key:"numDataIds",value:function(){return this.dataIdsCount}}]),e}(),Vo=function(){function e(){s(this,e)}return c(e,[{key:"decComplexRef",value:function(e){}},{key:"time",value:function(e){return jo("time")}},{key:"read",value:function(e){return jo("read")}},{key:"readSync",value:function(e){return jo("readSync")}},{key:"numDataIds",value:function(){return jo("numDataIds")}},{key:"disposeData",value:function(e){return jo("disposeData")}},{key:"write",value:function(e,t,n){return jo("write")}},{key:"move",value:function(e,t,n,r){return jo("move")}},{key:"memory",value:function(){return jo("memory")}},{key:"floatPrecision",value:function(){return jo("floatPrecision")}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"batchMatMul",value:function(e,t,n,r){return jo("batchMatMul")}},{key:"fusedBatchMatMul",value:function(e){e.a,e.b,e.transposeA,e.transposeB,e.bias,e.activation,e.preluActivationWeights;return jo("fusedBatchMatMul")}},{key:"slice",value:function(e,t,n){return jo("slice")}},{key:"stridedSlice",value:function(e,t,n,r){return jo("stridedSlice")}},{key:"unstack",value:function(e,t){return jo("unstack")}},{key:"reverse",value:function(e,t){return jo("reverse")}},{key:"concat",value:function(e,t){return jo("concat")}},{key:"neg",value:function(e){return jo("neg")}},{key:"add",value:function(e,t){return jo("add")}},{key:"addN",value:function(e){return jo("addN")}},{key:"subtract",value:function(e,t){return jo("subtract")}},{key:"multiply",value:function(e,t){return jo("multiply")}},{key:"realDivide",value:function(e,t){return jo("realDivide")}},{key:"floorDiv",value:function(e,t){return jo("floorDiv")}},{key:"sum",value:function(e,t){return jo("sum")}},{key:"prod",value:function(e,t){return jo("prod")}},{key:"unsortedSegmentSum",value:function(e,t,n){return jo("unsortedSegmentSum")}},{key:"argMin",value:function(e,t){return jo("argMin")}},{key:"argMax",value:function(e,t){return jo("argMax")}},{key:"equal",value:function(e,t){return jo("equal")}},{key:"notEqual",value:function(e,t){return jo("notEqual")}},{key:"less",value:function(e,t){return jo("less")}},{key:"lessEqual",value:function(e,t){return jo("lessEqual")}},{key:"greater",value:function(e,t){return jo("greater")}},{key:"greaterEqual",value:function(e,t){return jo("greaterEqual")}},{key:"logicalNot",value:function(e){return jo("logicalNot")}},{key:"logicalAnd",value:function(e,t){return jo("logicalAnd")}},{key:"logicalOr",value:function(e,t){return jo("logicalOr")}},{key:"where",value:function(e){return jo("where")}},{key:"select",value:function(e,t,n){return jo("select")}},{key:"topk",value:function(e,t,n){return jo("topk")}},{key:"min",value:function(e,t){return jo("min")}},{key:"minimum",value:function(e,t){return jo("minimum")}},{key:"mod",value:function(e,t){return jo("mod")}},{key:"max",value:function(e,t){return jo("max")}},{key:"maximum",value:function(e,t){return jo("maximum")}},{key:"all",value:function(e,t){return jo("all")}},{key:"any",value:function(e,t){return jo("any")}},{key:"squaredDifference",value:function(e,t){return jo("squaredDifference")}},{key:"ceil",value:function(e){return jo("ceil")}},{key:"floor",value:function(e){return jo("floor")}},{key:"round",value:function(e){return jo("round")}},{key:"sign",value:function(e){return jo("sign")}},{key:"isNaN",value:function(e){return jo("isNaN")}},{key:"isInf",value:function(e){return jo("isInf")}},{key:"isFinite",value:function(e){return jo("isFinite")}},{key:"pow",value:function(e,t){return jo("pow")}},{key:"exp",value:function(e){return jo("exp")}},{key:"expm1",value:function(e){return jo("expm1")}},{key:"softmax",value:function(e,t){return jo("softmax")}},{key:"log",value:function(e){return jo("log")}},{key:"log1p",value:function(e){return jo("log1p")}},{key:"sqrt",value:function(e){return jo("sqrt")}},{key:"rsqrt",value:function(e){return jo("rsqrt")}},{key:"square",value:function(e){return jo("square")}},{key:"reciprocal",value:function(e){return jo("reciprocal")}},{key:"relu",value:function(e){return jo("relu")}},{key:"relu6",value:function(e){return jo("relu6")}},{key:"prelu",value:function(e,t){return jo("prelu")}},{key:"elu",value:function(e){return jo("elu")}},{key:"eluDer",value:function(e,t){return jo("eluDer")}},{key:"selu",value:function(e){return jo("selu")}},{key:"int",value:function(e){return jo("int")}},{key:"clip",value:function(e,t,n){return jo("clip")}},{key:"abs",value:function(e){return jo("abs")}},{key:"complexAbs",value:function(e){return jo("complexAbs")}},{key:"sigmoid",value:function(e){return jo("sigmoid")}},{key:"softplus",value:function(e){return jo("softplus")}},{key:"sin",value:function(e){return jo("sin")}},{key:"cos",value:function(e){return jo("cos")}},{key:"tan",value:function(e){return jo("tan")}},{key:"asin",value:function(e){return jo("asin")}},{key:"acos",value:function(e){return jo("acos")}},{key:"atan",value:function(e){return jo("atan")}},{key:"atan2",value:function(e,t){return jo("atan2")}},{key:"sinh",value:function(e){return jo("sinh")}},{key:"cosh",value:function(e){return jo("cosh")}},{key:"tanh",value:function(e){return jo("tanh")}},{key:"asinh",value:function(e){return jo("asinh")}},{key:"acosh",value:function(e){return jo("acosh")}},{key:"atanh",value:function(e){return jo("atanh")}},{key:"erf",value:function(e){return jo("erf")}},{key:"step",value:function(e,t){return jo("step")}},{key:"fusedConv2d",value:function(e){e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights;return jo("fusedConv2d")}},{key:"conv2d",value:function(e,t,n){return jo("conv2d")}},{key:"conv2dDerInput",value:function(e,t,n){return jo("conv2dDerInput")}},{key:"conv2dDerFilter",value:function(e,t,n){return jo("conv2dDerFilter")}},{key:"fusedDepthwiseConv2D",value:function(e){e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights;return jo("fusedDepthwiseConv2D")}},{key:"depthwiseConv2D",value:function(e,t,n){return jo("depthwiseConv2D")}},{key:"depthwiseConv2DDerInput",value:function(e,t,n){return jo("depthwiseConv2DDerInput")}},{key:"depthwiseConv2DDerFilter",value:function(e,t,n){return jo("depthwiseConv2DDerFilter")}},{key:"conv3d",value:function(e,t,n){return jo("conv3d")}},{key:"conv3dDerInput",value:function(e,t,n){return jo("conv3dDerInput")}},{key:"conv3dDerFilter",value:function(e,t,n){return jo("conv3dDerFilter")}},{key:"maxPool",value:function(e,t){return jo("maxPool")}},{key:"maxPoolBackprop",value:function(e,t,n,r){return jo("maxPoolBackprop")}},{key:"avgPool",value:function(e,t){return jo("avgPool")}},{key:"avgPoolBackprop",value:function(e,t,n){return jo("avgPoolBackprop")}},{key:"avgPool3d",value:function(e,t){return jo("avgPool3d")}},{key:"avgPool3dBackprop",value:function(e,t,n){return jo("avgPool3dBackprop")}},{key:"maxPool3d",value:function(e,t){return jo("maxPool3d")}},{key:"maxPool3dBackprop",value:function(e,t,n,r){return jo("maxPool3dBackprop")}},{key:"reshape",value:function(e,t){return jo("reshape")}},{key:"cast",value:function(e,t){return jo("cast")}},{key:"tile",value:function(e,t){return jo("tile")}},{key:"pad",value:function(e,t,n){return jo("pad")}},{key:"transpose",value:function(e,t){return jo("transpose")}},{key:"gather",value:function(e,t,n){return jo("gather")}},{key:"gatherND",value:function(e,t){return jo("gatherND")}},{key:"scatterND",value:function(e,t,n){return jo("scatterND")}},{key:"batchToSpaceND",value:function(e,t,n){return jo("batchToSpaceND")}},{key:"spaceToBatchND",value:function(e,t,n){return jo("spaceToBatchND")}},{key:"resizeBilinear",value:function(e,t,n,r,a){return jo("resizeBilinear")}},{key:"resizeBilinearBackprop",value:function(e,t,n){return jo("resizeBilinearBackprop")}},{key:"resizeNearestNeighbor",value:function(e,t,n,r,a){return jo("resizeNearestNeighbor")}},{key:"resizeNearestNeighborBackprop",value:function(e,t,n){return jo("resizeNearestNeighborBackprop")}},{key:"batchNorm",value:function(e,t,n,r,a,i){return jo("batchNorm")}},{key:"localResponseNormalization4D",value:function(e,t,n,r,a){return jo("localResponseNormalization4D")}},{key:"LRNGrad",value:function(e,t,n,r,a,i,o){return jo("LRNGrad")}},{key:"multinomial",value:function(e,t,n,r){return jo("multinomial")}},{key:"oneHot",value:function(e,t,n,r){return jo("oneHot")}},{key:"cumsum",value:function(e,t,n,r){return jo("cumsum")}},{key:"nonMaxSuppression",value:function(e,t,n,r,a){return jo("nonMaxSuppression")}},{key:"fft",value:function(e){return jo("fft")}},{key:"ifft",value:function(e){return jo("ifft")}},{key:"complex",value:function(e,t){return jo("complex")}},{key:"real",value:function(e){return jo("real")}},{key:"imag",value:function(e){return jo("imag")}},{key:"cropAndResize",value:function(e,t,n,r,a,i){return jo("cropAndResize")}},{key:"depthToSpace",value:function(e,t,n){return jo("depthToSpace")}},{key:"split",value:function(e,t,n){return jo("split")}},{key:"sparseToDense",value:function(e,t,n,r){return jo("sparseToDense")}},{key:"diag",value:function(e){return jo("diag")}},{key:"fill",value:function(e,t,n){return jo("fill")}},{key:"onesLike",value:function(e){return jo("onesLike")}},{key:"zerosLike",value:function(e){return jo("zerosLike")}},{key:"linspace",value:function(e,t,n){return jo("linspace")}},{key:"dispose",value:function(){return jo("dispose")}}]),e}();function jo(e){throw new Error("'".concat(e,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}function qo(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,n=e[--t],e[t]=e[r],e[r]=n}function Go(e,t,n){return Math.max(e,Math.min(t,n))}function Wo(e){return e%2===0?e:e+1}function Uo(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function Ho(e,t){if(!e)throw new Error("string"===typeof t?t:t())}function Ko(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";Ho($o(e,t),(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}))}function Xo(e){Ho(null!=e,(function(){return"The input to the tensor constructor must be a non-null value."}))}function Yo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t&&(t=[]),Array.isArray(e)||us(e)&&!n)for(var r=0;r<e.length;++r)Yo(e[r],t,n);else t.push(e);return t}function Qo(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function $o(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Jo(e){return e%1===0}function Zo(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function es(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function ts(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return 0},n=arguments.length>2?arguments[2]:void 0;return new Promise((function(r,a){var i=0;!function o(){if(e())r();else{i++;var s=t(i);null!=n&&i>=n?a():setTimeout(o,s)}}()}))}function ns(e,t){for(var n=1,r=-1,a=0;a<e.length;++a)if(e[a]>=0)n*=e[a];else if(-1===e[a]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(r," and dim ").concat(a));r=a}else if(e[a]<0)throw Error("Shapes can not be < 0. Found ".concat(e[a]," at dim ").concat(a));if(-1===r){if(t>0&&t!==n)throw Error("Size(".concat(t,") must match the product of shape ").concat(e));return e}if(0===n)throw Error("Cannot infer the missing size in [".concat(e,"] when ")+"there are 0 elements");if(t%n!==0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(t," / ").concat(n));var i=e.slice();return i[r]=t/n,i}function rs(e,t){var n=t.length;return Ho((e=null==e?t.map((function(e,t){return t})):[].concat(e)).every((function(e){return e>=-n&&e<n})),(function(){return"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(e)})),Ho(e.every((function(e){return Jo(e)})),(function(){return"All values in axis param must be integers but "+"got axis ".concat(e)})),e.map((function(e){return e<0?n+e:e}))}function as(e,t){for(var n=[],r=[],a=null!=t&&Array.isArray(t)&&0===t.length,i=null==t||a?null:rs(t,e).sort(),o=0,s=0;s<e.length;++s){if(null!=i){if(i[o]===s&&1!==e[s])throw new Error("Can't squeeze axis ".concat(s," since its dim '").concat(e[s],"' is not 1"));(null==i[o]||i[o]>s)&&1===e[s]&&(n.push(e[s]),r.push(s)),i[o]<=s&&o++}1!==e[s]&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function is(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else{if("bool"!==e)throw new Error("Unknown data type ".concat(e));n=new Uint8Array(t)}return n}function os(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type ".concat(e));n=new Array(t)}return n}function ss(e,t){return"complex64"!==t&&(("float32"!==t||"complex64"===e)&&(("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)))}function us(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function cs(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype ".concat(e))}function ls(e){return"string"===typeof e||e instanceof String}function hs(e){return"number"===typeof e}function fs(e){return Array.isArray(e)?fs(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":hs(e)?"float32":ls(e)?"string":"boolean"===typeof e?"bool":"float32"}function ps(e){return!!(e&&e.constructor&&e.call&&e.apply)}function ds(e,t){for(var n=t;n<e;++n)if(e%n===0)return n;return e}function ms(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function vs(e,t,n){var r=new Array;if(1===t.length)for(var a=t[0],i=0;i<a;i++)r[i]=n[e+i];else for(var o=t[0],s=t.slice(1),u=s.reduce((function(e,t){return e*t})),c=0;c<o;c++)r[c]=vs(e+c*u,s,n);return r}function gs(e,t){if(0===e.length)return t[0];var n=e.reduce((function(e,t){return e*t}));if(0===n)return[];if(n!==t.length)throw new Error("[".concat(e,"] does not match the input size ").concat(t.length,"."));return vs(0,e,t)}function ys(e,t){for(var n=bs(e,t),r=0;r<n.length;r++)n[r]=1;return n}function bs(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type ".concat(t))}function ks(e,t){var n=e.reduce((function(e,t){return e*t}),1);if(null==t||"float32"===t)return gs(e,new Float32Array(n));if("int32"===t)return gs(e,new Int32Array(n));if("bool"===t)return gs(e,new Uint8Array(n));throw new Error("Unknown data type ".concat(t))}function xs(e){e.forEach((function(t){Ho(Number.isInteger(t)&&t>=0,(function(){return"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(e,"].")}))}))}function ws(e,t,n){if(0===t)return 0;if(1===t)return e[0];for(var r=e[e.length-1],a=0;a<e.length-1;++a)r+=n[a]*e[a];return r}function _s(e,t,n){if(0===t)return[];if(1===t)return[e];for(var r=new Array(t),a=0;a<r.length-1;++a)r[a]=Math.floor(e/n[a]),e-=r[a]*n[a];return r[r.length-1]=e,r}function Ss(e){return e&&e.then&&"function"===typeof e.then}var Cs="tfjsflags",Ts=function(){function e(t){s(this,e),this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return c(e,[{key:"setPlatform",value:function(e,t){null!=this.platform&&console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(t,".")),this.platformName=e,this.platform=t}},{key:"registerFlag",value:function(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){var r=this.urlFlags[e];console.warn("Setting feature override from URL ".concat(e,": ").concat(r,".")),this.set(e,r)}}},{key:"getAsync",value:function(){var e=_(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t in this.flags)){e.next=2;break}return e.abrupt("return",this.flags[t]);case 2:return e.next=4,this.evaluateFlag(t);case 4:return this.flags[t]=e.sent,e.abrupt("return",this.flags[t]);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(e){if(e in this.flags)return this.flags[e];var t=this.evaluateFlag(e);if(Ss(t))throw new Error("Flag ".concat(e," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[e]=t,this.flags[e]}},{key:"getNumber",value:function(e){return this.get(e)}},{key:"getBool",value:function(e){return this.get(e)}},{key:"getFlags",value:function(){return this.flags}},{key:"features",get:function(){return this.flags}},{key:"set",value:function(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag ".concat(e," as it has not been registered."));this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}},{key:"evaluateFlag",value:function(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '".concat(e,"': no evaluation function found."));return this.flagRegistry[e].evaluationFn()}},{key:"setFlags",value:function(e){this.flags=Object.assign({},e)}},{key:"reset",value:function(){this.flags={},this.urlFlags={},this.populateURLFlags()}},{key:"populateURLFlags",value:function(){var e=this;if("undefined"!==typeof this.global&&"undefined"!==typeof this.global.location&&"undefined"!==typeof this.global.location.search){var t=function(e){var t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return Es(t,r[0],r[1]),r.join("=")})),t}(this.global.location.search);if(Cs in t)t.tfjsflags.split(",").forEach((function(t){var n=Ct(t.split(":"),2),r=n[0],a=n[1];e.urlFlags[r]=function(e,t){if("true"===(t=t.toLowerCase())||"false"===t)return"true"===t;if("".concat(+t)===t)return+t;throw new Error("Could not parse value flag value ".concat(t," for flag ").concat(e,"."))}(r,a)}))}}}]),e}();function Es(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function Is(){return Ns}var As,Ns=null;function Ps(){if(null==As){var e;if("undefined"!==typeof window)e=window;else if("undefined"!==typeof __webpack_require__.g)e=__webpack_require__.g;else if("undefined"!==typeof process)e=process;else{if("undefined"===typeof self)throw new Error("Could not find a global object");e=self}As=e}return As}function Ms(e,t){var n=function(){var e=Ps();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(n.has(e))return n.get(e);var r=t();return n.set(e,r),n.get(e)}var Ds="Abs",Rs="Acos",Os="Acosh",Fs="Add",Ls="AddN",zs="All",Bs="Any",Vs="ArgMax",js="ArgMin",qs="Asin",Gs="Asinh",Ws="Atan",Us="Atanh",Hs="Atan2",Ks="AvgPool",Xs="AvgPoolGrad",Ys="AvgPool3D",Qs="AvgPool3DGrad",$s="BatchMatMul",Js="BatchToSpaceND",Zs="Bincount",eu="Cast",tu="Ceil",nu="ClipByValue",ru="Complex",au="ComplexAbs",iu="Concat",ou="Conv2D",su="Conv2DBackpropFilter",uu="Conv2DBackpropInput",cu="Conv3D",lu="Conv3DBackpropFilterV2",hu="Conv3DBackpropInputV2",fu="Cos",pu="Cosh",du="Cumsum",mu="CropAndResize",vu="DenseBincount",gu="DepthToSpace",yu="DepthwiseConv2dNative",bu="DepthwiseConv2dNativeBackpropFilter",ku="DepthwiseConv2dNativeBackpropInput",xu="Diag",wu="Dilation2D",_u="Dilation2DBackpropInput",Su="Dilation2DBackpropFilter",Cu="RealDiv",Tu="Elu",Eu="EluGrad",Iu="Erf",Au="Equal",Nu="Exp",Pu="ExpandDims",Mu="Expm1",Du="FFT",Ru="Fill",Ou="FlipLeftRight",Fu="Floor",Lu="FloorDiv",zu="FusedBatchNorm",Bu="GatherV2",Vu="GatherNd",ju="Greater",qu="GreaterEqual",Gu="Identity",Wu="IFFT",Uu="Imag",Hu="IsFinite",Ku="IsInf",Xu="IsNan",Yu="LeakyRelu",Qu="Less",$u="LessEqual",Ju="LinSpace",Zu="Log",ec="Log1p",tc="LogicalAnd",nc="LogicalNot",rc="LogicalOr",ac="LRN",ic="LRNGrad",oc="Max",sc="Maximum",uc="MaxPool",cc="MaxPoolGrad",lc="MaxPool3D",hc="MaxPool3DGrad",fc="MaxPoolWithArgmax",pc="Mean",dc="Min",mc="Minimum",vc="MirrorPad",gc="Mod",yc="Multinomial",bc="Multiply",kc="Neg",xc="NotEqual",wc="NonMaxSuppressionV3",_c="NonMaxSuppressionV4",Sc="NonMaxSuppressionV5",Cc="OnesLike",Tc="OneHot",Ec="Pack",Ic="PadV2",Ac="Pow",Nc="Prelu",Pc="Prod",Mc="Range",Dc="Real",Rc="Reciprocal",Oc="Relu",Fc="Reshape",Lc="ResizeNearestNeighbor",zc="ResizeNearestNeighborGrad",Bc="ResizeBilinear",Vc="ResizeBilinearGrad",jc="Relu6",qc="Reverse",Gc="Round",Wc="Rsqrt",Uc="ScatterNd",Hc="Select",Kc="Selu",Xc="Slice",Yc="Sin",Qc="Sinh",$c="Sign",Jc="Sigmoid",Zc="Softplus",el="Sqrt",tl="Sum",nl="SpaceToBatchND",rl="SplitV",al="Softmax",il="SquaredDifference",ol="Square",sl="Sub",ul="SparseToDense",cl="StridedSlice",ll="Tan",hl="Tanh",fl="Tile",pl="TopK",dl="Transpose",ml="Unique",vl="Unpack",gl="UnsortedSegmentSum",yl="ZerosLike",bl="Step",kl="RotateWithOffset",xl="_FusedMatMul",wl="FusedConv2D",_l="FusedDepthwiseConv2D",Sl=Ms("kernelRegistry",(function(){return new Map})),Cl=Ms("gradRegistry",(function(){return new Map}));function Tl(e){return Cl.get(e)}function El(e){for(var t=Sl.entries(),n=[];;){var r=t.next(),a=r.done,i=r.value;if(a)break;var o=Ct(i,2),s=o[0],u=o[1];Ct(s.split("_"),1)[0]===e&&n.push(u)}return n}function Il(e){var t=e.kernelName,n=e.backendName,r=Nl(t,n);Sl.has(r)&&console.warn("The kernel '".concat(t,"' for backend ")+"'".concat(n,"' is already registered")),Sl.set(r,e)}function Al(e){var t=e.kernelName;Cl.has(t)&&Is().getBool("DEBUG")&&console.warn("Overriding the gradient for '".concat(t,"'")),Cl.set(t,e)}function Nl(e,t){return"".concat(t,"_").concat(e)}var Pl=function(){function e(t,n){s(this,e),this.backendTimer=t,this.logger=n,null==n&&(this.logger=new Ml)}return c(e,[{key:"profileKernel",value:function(e,t,n){var r,a=this.backendTimer.time((function(){r=n()}));if(Is().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(var i=function(t){var n=r[t];n.data().then((function(t){!function(e,t,n){if("float32"!==t)return!1;for(var r=0;r<e.length;r++){var a=e[r];if(isNaN(a)||!isFinite(a))return console.warn("Found ".concat(a," in the result of '").concat(n,"'")),!0}}(t,n.dtype,e)}))},o=0;o<r.length;o++)i(o);return{kernelName:e,outputs:r,inputs:t,timeMs:a.then((function(e){return e.kernelMs})),extraInfo:a.then((function(e){return null!=e.getExtraProfileInfo?e.getExtraProfileInfo():""}))}}},{key:"logKernelProfile",value:function(e){var t=this,n=e.kernelName,r=e.outputs,a=e.timeMs,i=e.inputs,o=e.extraInfo;r.forEach((function(e){Promise.all([e.data(),a,o]).then((function(r){t.logger.logKernelProfile(n,e,r[0],r[1],i,r[2])}))}))}}]),e}();var Ml=function(){function e(){s(this,e)}return c(e,[{key:"logKernelProfile",value:function(e,t,n,r,a,i){var o="number"===typeof r?es("".concat(r,"ms"),9):r.error,s=es(e,25),u=t.rank,c=t.size,l=es(t.shape.toString(),14),h="";for(var f in a){var p=a[f];if(null!=p){var d=p.shape||t.shape,m=d.length;h+="".concat(f,": ").concat(m,"D ").concat(m>0?d:""," ")}}console.log("%c".concat(s,"\t%c").concat(o,"\t%c").concat(u,"D ").concat(l,"\t%c").concat(c,"\t%c").concat(h,"\t%c").concat(i),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}]),e}();function Dl(e,t,n){for(var r={},a={},i=0;i<t.length;i++)r[t[i].id]=!0;for(var o=0;o<e.length;o++){var s=e[o],u=s.inputs;for(var c in u){for(var l=u[c],h=!1,f=0;f<t.length;f++)if(r[l.id]){s.outputs.forEach((function(e){return r[e.id]=!0})),h=!0,a[s.id]=!0;break}if(h)break}}var p={};p[n.id]=!0;for(var d={},m=e.length-1;m>=0;m--)for(var v=e[m],g=v.inputs,y=0;y<v.outputs.length;y++)if(p[v.outputs[y].id]){for(var b in g)p[g[b].id]=!0,d[v.id]=!0;break}for(var k=[],x=0;x<e.length;x++){var w=e[x];if(a[w.id]&&d[w.id]){var _={};for(var S in w.inputs){var C=w.inputs[S];r[C.id]&&(_[S]=C)}var T=Object.assign({},w);T.inputs=_,T.outputs=w.outputs,k.push(T)}}return k}function Rl(e,t,n,r){for(var a=function(a){var i=t[a],o=[];if(i.outputs.forEach((function(t){var n=e[t.id];null!=n?o.push(n):o.push(null)})),null==i.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(i.kernelName,"."));var s=i.gradient(o),u=function(t){if(!(t in s))throw new Error("Cannot backprop through input ".concat(t,". ")+"Available gradients found: ".concat(Object.keys(s),"."));var a=n((function(){return s[t]()}));if("float32"!==a.dtype)throw new Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input ")+"".concat(t," must have 'float32' dtype, but has '").concat(a.dtype,"'"));var o=i.inputs[t];if(!$o(a.shape,o.shape))throw new Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input ")+"'".concat(t,"' has shape '").concat(a.shape,"', which does not match ")+"the shape of the input '".concat(o.shape,"'"));if(null==e[o.id])e[o.id]=a;else{var u=e[o.id];e[o.id]=r(u,a),u.dispose()}};for(var c in i.inputs)u(c)},i=t.length-1;i>=0;i--)a(i)}function Ol(e,t,n,r){var a=ms(t),i=function(e,t,n,r){var a=Qo(t),i=r[r.length-1],o=new Array(i).fill(0),s=t.length,u="complex64"===n?Bl(e):e;if(s>1)for(var c=0;c<a/i;c++)for(var l=c*i,h=0;h<i;h++)o[h]=Math.max(o[h],Fl(u[l+h],0,n).length);return o}(e,t,n,a),o=t.length,s=zl(e,t,n,a,i),u=["Tensor"];return r&&(u.push("  dtype: ".concat(n)),u.push("  rank: ".concat(o)),u.push("  shape: [".concat(t,"]")),u.push("  values:")),u.push(s.map((function(e){return"    "+e})).join("\n")),u.join("\n")}function Fl(e,t,n){return es(Array.isArray(e)?"".concat(parseFloat(e[0].toFixed(7))," + ")+"".concat(parseFloat(e[1].toFixed(7)),"j"):ls(e)?"'".concat(e,"'"):"bool"===n?Ll(e):parseFloat(e.toFixed(7)).toString(),t)}function Ll(e){return 0===e?"false":"true"}function zl(e,t,n,r,a){var i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],o="complex64"===n?2:1,s=t[0],u=t.length;if(0===u){if("complex64"===n){var c=Bl(e);return[Fl(c[0],0,n)]}return"bool"===n?[Ll(e[0])]:[e[0].toString()]}if(1===u){if(s>20){var l=3*o,h=Array.from(e.slice(0,l)),f=Array.from(e.slice((s-3)*o,s*o));return"complex64"===n&&(h=Bl(h),f=Bl(f)),["["+h.map((function(e,t){return Fl(e,a[t],n)})).join(", ")+", ..., "+f.map((function(e,t){return Fl(e,a[s-3+t],n)})).join(", ")+"]"]}var p="complex64"===n?Bl(e):Array.from(e);return["["+p.map((function(e,t){return Fl(e,a[t],n)})).join(", ")+"]"]}var d=t.slice(1),m=r.slice(1),v=r[0]*o,g=[];if(s>20){for(var y=0;y<3;y++){var b=y*v,k=b+v;g.push.apply(g,Fn(zl(e.slice(b,k),d,n,m,a,!1)))}g.push("...");for(var x=s-3;x<s;x++){var w=x*v,_=w+v;g.push.apply(g,Fn(zl(e.slice(w,_),d,n,m,a,x===s-1)))}}else for(var S=0;S<s;S++){var C=S*v,T=C+v;g.push.apply(g,Fn(zl(e.slice(C,T),d,n,m,a,S===s-1)))}var E=2===u?",":"";g[0]="["+g[0]+E;for(var I=1;I<g.length-1;I++)g[I]=" "+g[I]+E;for(var A=",\n",N=2;N<u;N++)A+="\n";return g[g.length-1]=" "+g[g.length-1]+"]"+(i?"":A),g}function Bl(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}function Vl(e,t){return"string"===t?Gl(e):jl([e],t)}function jl(e,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Yo(e)),Is().getBool("DEBUG")&&function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(t," being uploaded contains ").concat(r,"."))}}(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){for(var n=new Uint8Array(e.length),r=0;r<n.length;++r)0!==Math.round(e[r])&&(n[r]=1);return n}throw new Error("Unknown data type ".concat(t))}function ql(){return Is().platform.now()}function Gl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",Is().platform.encode(e,t)}function Wl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",Is().platform.decode(e,t)}var Ul=function(){function e(t,n,r){var a=this;if(s(this,e),this.dtype=n,this.shape=t.slice(),this.size=Qo(t),null!=r){var i=r.length;Ho(i===this.size,(function(){return"Length of values '".concat(i,"' does not match the size ")+"inferred by the shape '".concat(a.size,"'.")}))}if("complex64"===n)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||os(n,this.size),this.strides=ms(t)}return c(e,[{key:"set",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];0===r.length&&(r=[0]),Ho(r.length===this.rank,(function(){return"The number of provided coordinates (".concat(r.length,") must ")+"match the rank (".concat(t.rank,")")}));var i=this.locToIndex(r);this.values[i]=e}},{key:"get",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];0===t.length&&(t=[0]);for(var r=0,a=0,i=t;a<i.length;a++){var o=i[a];if(o<0||o>=this.shape[r]){var s="Requested out of range element at ".concat(t,". ")+"  Buffer shape=".concat(this.shape);throw new Error(s)}r++}for(var u=t[t.length-1],c=0;c<t.length-1;++c)u+=this.strides[c]*t[c];return this.values[u]}},{key:"locToIndex",value:function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}},{key:"indexToLoc",value:function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}},{key:"rank",get:function(){return this.shape.length}},{key:"toTensor",value:function(){return Hl().makeTensor(this.values,this.shape,this.dtype)}}]),e}(),Hl=null,Kl=null;var Xl=function(){function e(t,n,r,a){s(this,e),this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=Qo(t),this.strides=ms(t),this.dataId=r,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}return c(e,[{key:"rank",get:function(){return this.shape.length}},{key:"buffer",value:function(){var e=_(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.data();case 2:return t=e.sent,e.abrupt("return",Kl.buffer(this.shape,this.dtype,t));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"bufferSync",value:function(){return Kl.buffer(this.shape,this.dtype,this.dataSync())}},{key:"array",value:function(){var e=_(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.data();case 2:return t=e.sent,e.abrupt("return",gs(this.shape,t));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"arraySync",value:function(){return gs(this.shape,this.dataSync())}},{key:"data",value:function(){var e=_(x().mark((function e(){var t,n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.throwIfDisposed(),t=Hl().read(this.dataId),"string"!==this.dtype){e.next=13;break}return e.next=5,t;case 5:return n=e.sent,e.prev=6,e.abrupt("return",n.map((function(e){return Wl(e)})));case 10:throw e.prev=10,e.t0=e.catch(6),new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().");case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this,[[6,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"dataSync",value:function(){this.throwIfDisposed();var e=Hl().readSync(this.dataId);if("string"===this.dtype)try{return e.map((function(e){return Wl(e)}))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}},{key:"bytes",value:function(){var e=_(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.throwIfDisposed(),e.next=3,Hl().read(this.dataId);case 3:if(t=e.sent,"string"!==this.dtype){e.next=8;break}return e.abrupt("return",t);case 8:return e.abrupt("return",new Uint8Array(t.buffer));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dispose",value:function(){this.isDisposed||(Hl().disposeTensor(this),this.isDisposedInternal=!0)}},{key:"isDisposed",get:function(){return this.isDisposedInternal}},{key:"throwIfDisposed",value:function(){if(this.isDisposed)throw new Error("Tensor is disposed.")}},{key:"print",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Kl.print(this,e)}},{key:"clone",value:function(){return this.throwIfDisposed(),Kl.clone(this)}},{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.dataSync();return Ol(t,this.shape,this.dtype,e)}},{key:"cast",value:function(e){return this.throwIfDisposed(),Kl.cast(this,e)}},{key:"variable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),Hl().makeVariable(this,e,t,n)}}]),e}();Object.defineProperty(Xl,Symbol.hasInstance,{value:function(e){return!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}});var Yl,Ql,$l,Jl,Zl,eh=function(e){h(n,e);var t=g(n);function n(e,r,a,i){var o;return s(this,n),(o=t.call(this,e.shape,e.dtype,e.dataId,i)).trainable=r,o.name=a,o}return c(n,[{key:"assign",value:function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(e.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!$o(e.shape,this.shape))throw new Error("shape of the new value (".concat(e.shape,") and ")+"previous value (".concat(this.shape,") must match"));Hl().disposeTensor(this),this.dataId=e.dataId,Hl().incRef(this,null)}},{key:"dispose",value:function(){Hl().disposeVariable(this),this.isDisposedInternal=!0}}]),n}(Xl);Object.defineProperty(eh,Symbol.hasInstance,{value:function(e){return e instanceof Xl&&null!=e.assign&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(Yl||(Yl={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(Ql||(Ql={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}($l||($l={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(Jl||(Jl={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(Zl||(Zl={}));var th={float32:Jl,int32:Ql,bool:$l,complex64:Zl};function nh(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast ".concat(e," with ").concat(t))}return th[e][t]}function rh(e){return nh(e,"int32")}function ah(e,t){if(e.dtype===t.dtype)return[e,t];var n=nh(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function ih(e,t){return t.some((function(t){return t.id===e.id}))}function oh(e){var t=[];return sh(e,t,new Set),t}function sh(e,t,n){if(null!=e)if(e instanceof Xl)t.push(e);else if(r=e,Array.isArray(r)||"object"===typeof r){var r,a=e;for(var i in a){var o=a[i];n.has(o)||(n.add(o),sh(o,t,n))}}}var uh=function(){function e(){s(this,e),this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((function(e){return e.name}))))}}}return c(e,[{key:"dispose",value:function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()}}]),e}(),ch=function(){function e(t){s(this,e),this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new uh}return c(e,[{key:"ready",value:function(){var e=_(x().mark((function e(){var t,n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.pendingBackendInit){e.next=2;break}return e.abrupt("return",this.pendingBackendInit.then((function(){})));case 2:if(null==this.backendInstance){e.next=4;break}return e.abrupt("return");case 4:t=this.getSortedBackends(),n=0;case 6:if(!(n<t.length)){e.next=18;break}return r=t[n],e.next=10,this.initializeBackend(r).success;case 10:if(!e.sent){e.next=15;break}return e.next=14,this.setBackend(r);case 14:return e.abrupt("return");case 15:n++,e.next=6;break;case 18:throw new Error("Could not initialize any backends, all backend initializations failed.");case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"backend",get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '".concat(t,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance}},{key:"backendNames",value:function(){return Object.keys(this.registryFactory)}},{key:"findBackend",value:function(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;if(this.initializeBackend(e).asyncInit)return null}return this.registry[e]}},{key:"findBackendFactory",value:function(e){return e in this.registryFactory?this.registryFactory[e].factory:null}},{key:"registerBackend",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e in this.registryFactory?(console.warn("".concat(e," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}},{key:"setBackend",value:function(){var e=_(x().mark((function e(t){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.registryFactory[t]){e.next=2;break}throw new Error("Backend name '".concat(t,"' not found in registry"));case 2:if(this.backendName=t,null!=this.registry[t]){e.next=16;break}if(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,!n.asyncInit){e.next=12;break}return e.next=9,r;case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=r;case 13:if(e.t0){e.next=16;break}return e.abrupt("return",!1);case 16:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new Pl(this.backendInstance),e.abrupt("return",!0);case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupRegisteredKernels",value:function(){var e=this;El(this.backendName).forEach((function(t){null!=t.setupFunc&&t.setupFunc(e.backendInstance)}))}},{key:"disposeRegisteredKernels",value:function(e){var t=this;El(e).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(t.registry[e])}))}},{key:"initializeBackend",value:function(e){var t=this,n=this.registryFactory[e];if(null==n)throw new Error("Cannot initialize backend ".concat(e,", no registration found."));try{var r=n.factory();if(!r||r instanceof Vo||"function"!==typeof r.then)return this.registry[e]=r,{success:!0,asyncInit:!1};var a=++this.pendingBackendInitId,i=r.then((function(n){return!(a<t.pendingBackendInitId)&&(t.registry[e]=n,t.pendingBackendInit=null,!0)})).catch((function(n){return a<t.pendingBackendInitId||(t.pendingBackendInit=null,console.warn("Initialization of backend ".concat(e," failed")),console.warn(n.stack||n.message)),!1}));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}catch(o){return console.warn("Initialization of backend ".concat(e," failed")),console.warn(o.stack||o.message),{success:!1,asyncInit:!1}}}},{key:"removeBackend",value:function(e){if(!(e in this.registryFactory))throw new Error("".concat(e," backend not found in registry"));this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}},{key:"getSortedBackends",value:function(){var e=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(t,n){return e.registryFactory[n].priority-e.registryFactory[t].priority}))}},{key:"initializeBackendsAndReturnBest",value:function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var n=e[t],r=this.initializeBackend(n),a=r.success,i=r.asyncInit;if(i||a)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}},{key:"moveData",value:function(e,t){var n=this.state.tensorInfo.get(t),r=n.backend,a=this.readSync(t);r.disposeData(t),n.backend=e,e.move(t,a,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}},{key:"tidy",value:function(e,t){var n,r=this,a=null;if(null==t){if("function"!==typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!==typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=e}return this.scopedRun((function(){return r.startScope(a)}),(function(){return r.endScope(n)}),(function(){return(n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))}},{key:"scopedRun",value:function(e,t,n){e();try{var r=n();return t(),r}catch(a){throw t(),a}}},{key:"nextTensorId",value:function(){return e.nextTensorId++}},{key:"nextVariableId",value:function(){return e.nextVariableId++}},{key:"clone",value:function(e){var t=this.makeTensorFromDataId(e.dataId,e.shape,e.dtype),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],(function(e){return{x:function(){var t="float32",n={x:e},r={dtype:t};return fh.runKernelFunc((function(n){return n.cast(e,t)}),n,null,eu,r)}}}),[],{}),t}},{key:"runKernel",value:function(e,t,n,r,a){return this.runKernelFunc(null,t,null,e,n,r,a)}},{key:"shouldCheckForMemLeaks",value:function(){return this.ENV.getBool("IS_TEST")}},{key:"checkKernelForMemLeak",value:function(e,t,n){var r=this.backend.numDataIds(),a=0;n.forEach((function(e){a+="complex64"===e.dtype?3:1}));var i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-t-a-i;if(o>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(o," data ids) after running '").concat(e,"'"))}},{key:"runKernelFunc",value:function(e,t,n,r,a,i,o){var s,u=this,c=[],l=this.isTapeOn();null==r&&(r=null!=this.state.activeScope?this.state.activeScope.name:"");var h,f=this.state.numBytes,p=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;var d,m,v=function(e,t){var n=Nl(e,t);return Sl.get(n)}(r,this.backendName);if(null!=v)h=function(){var e=u.backend.numDataIds();d=v.kernelFunc({inputs:t,attrs:a,backend:u.backend});var n=Array.isArray(d)?d:[d];u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(r,e,n);var s=n.map((function(e){if(null!=e.rank)return e;var t=e.dataId,n=e.shape,r=e.dtype;return u.makeTensorFromDataId(t,n,r)}));if(l){var h=u.getTensorsForGradient(r,t,s);if(null==h){null==o&&(o=[]);var f=s.filter((function(e,t){return o[t]}));h=(i||[]).slice().concat(f)}c=u.saveTensorsForBackwardMode(h)}return s};else{if(null==e)throw new Error("Error running ".concat(r,": Neither modular kernel nor forward func passed"));var g=function(e){l&&(c=e.map((function(e){return u.keep(u.clone(e))})))};h=function(){var t=u.backend.numDataIds();d=u.tidy((function(){return e(u.backend,g)}));var n=Array.isArray(d)?d:[d];return u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(r,t,n),n}}return this.scopedRun((function(){return u.state.kernelDepth++}),(function(){return u.state.kernelDepth--}),(function(){u.ENV.getBool("DEBUG")||u.state.profiling?(m=u.profiler.profileKernel(r,t,(function(){return h()})),u.ENV.getBool("DEBUG")&&u.profiler.logKernelProfile(m),s=m.outputs):s=h()})),l&&this.addTapeNode(r,t,s,n,c,a),this.state.profiling&&this.state.activeProfile.kernels.push({name:r,bytesAdded:this.state.numBytes-f,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-p,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(t).map((function(e){return null!=t[e]?t[e].shape:null})),outputShapes:s.map((function(e){return e.shape})),kernelTimeMs:m.timeMs,extraInfo:m.extraInfo}),Array.isArray(d)?s:s[0]}},{key:"saveTensorsForBackwardMode",value:function(e){var t=this;return e.map((function(e){return t.keep(t.clone(e))}))}},{key:"getTensorsForGradient",value:function(e,t,n){var r=Tl(e);if(null!=r){var a,i=r.inputsToSave||[],o=r.outputsToSave||[];r.saveAllInputs?(Ho(Array.isArray(t),(function(){return"saveAllInputs is true, expected inputs to be an array."})),a=Object.keys(t).map((function(e){return t[e]}))):a=i.map((function(e){return t[e]}));var s=n.filter((function(e,t){return o[t]}));return a.concat(s)}return null}},{key:"makeTensor",value:function(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var a=e;"string"===n&&ls(e[0])&&(a=e.map((function(e){return Gl(e)})));var i=r.write(a,t,n),o=new Xl(t,n,i,this.nextTensorId());if(this.incRef(o,r),"string"===n){var s=this.state.tensorInfo.get(i),u=function(e){if(null==e)return 0;var t=0;return e.forEach((function(e){return t+=e.length})),t}(a);this.state.numBytes+=u-s.bytes,s.bytes=u}return o}},{key:"makeTensorFromDataId",value:function(e,t,n,r){var a=new Xl(t,n=n||"float32",e,this.nextTensorId());return this.incRef(a,r),a}},{key:"makeVariable",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.cast(r));var a=new eh(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error("Variable with name ".concat(a.name," was already registered"));return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}},{key:"incRef",value:function(e,t){var n=this.state.tensorInfo.has(e.dataId)?this.state.tensorInfo.get(e.dataId).refCount:0;if(this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;var r=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(r=e.size*cs(e.dtype)),this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:r,refCount:0}),this.state.numBytes+=r}this.state.tensorInfo.get(e.dataId).refCount++,e instanceof eh||this.track(e)}},{key:"disposeTensor",value:function(e){if(this.state.tensorInfo.has(e.dataId)){this.state.numTensors--,"string"===e.dtype&&this.state.numStringTensors--;var t=this.state.tensorInfo.get(e.dataId);t.refCount<=1?("complex64"!==e.dtype&&(this.state.numBytes-=t.bytes),this.state.numDataBuffers--,t.backend.disposeData(e.dataId),this.state.tensorInfo.delete(e.dataId)):(t.backend.decComplexRef(e.dataId),this.state.tensorInfo.get(e.dataId).refCount--)}}},{key:"disposeVariables",value:function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}}},{key:"disposeVariable",value:function(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}},{key:"memory",value:function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}},{key:"profile",value:function(){var e=_(x().mark((function e(t){var n,r,a,i,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],e.next=6,t();case 6:this.state.activeProfile.result=e.sent,this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,Fn(this.state.activeProfile.kernels.map((function(e){return e.totalBytesSnapshot})))),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,a=zo(this.state.activeProfile.kernels),e.prev=12,a.s();case 14:if((i=a.n()).done){e.next=24;break}return o=i.value,e.next=18,o.kernelTimeMs;case 18:return o.kernelTimeMs=e.sent,e.next=21,o.extraInfo;case 21:o.extraInfo=e.sent;case 22:e.next=14;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(12),a.e(e.t0);case 29:return e.prev=29,a.f(),e.finish(29);case 32:return e.abrupt("return",this.state.activeProfile);case 33:case"end":return e.stop()}}),e,this,[[12,26,29,32]])})));return function(t){return e.apply(this,arguments)}}()},{key:"isTapeOn",value:function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}},{key:"addTapeNode",value:function(e,t,n,r,a,i){var o=this,s={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},u=Tl(e);null!=u&&(r=u.gradFunc),null!=r&&(s.gradient=function(e){return e=e.map((function(e,t){if(null==e){var r=n[t],a=bs(r.size,r.dtype);return o.makeTensor(a,r.shape,r.dtype)}return e})),r(e.length>1?e:e[0],a,i)}),this.state.activeTape.push(s)}},{key:"keep",value:function(e){return e.kept=!0,e}},{key:"startTape",value:function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}},{key:"endTape",value:function(){this.state.gradientDepth--}},{key:"startScope",value:function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}},{key:"endScope",value:function(e){for(var t=this,n=oh(e),r=new Set(n.map((function(e){return e.id}))),a=0;a<this.state.activeScope.track.length;a++){var i=this.state.activeScope.track[a];i.kept||r.has(i.id)||i.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(e){e.kept||e.scopeId!==o.id||t.track(e)}))}},{key:"gradients",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(Ho(t.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));var i=this.scopedRun((function(){return r.startTape()}),(function(){return r.endTape()}),(function(){return r.tidy("forward",e)}));Ho(i instanceof Xl,(function(){return"The result y returned by f() must be a tensor."}));var o=Dl(this.state.activeTape,t,i);if(!a&&0===o.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var e={};e[i.id]=null==n?lh(i.shape):n,Rl(e,o,(function(e){return r.tidy(e)}),ph);var a=t.map((function(t){return e[t.id]}));return 0===r.state.gradientDepth&&(r.state.activeTape.forEach((function(e){var t,n=zo(e.saved);try{for(n.s();!(t=n.n()).done;){t.value.dispose()}}catch(r){n.e(r)}finally{n.f()}})),r.state.activeTape=null),{value:i,grads:a}}))}},{key:"customGrad",value:function(e){var t=this;return Ho(ps(e),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i;Ho(r.every((function(e){return e instanceof Xl})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var o={};return r.forEach((function(e,t){o[t]=e})),t.runKernelFunc((function(t,n){return Ho((i=e.apply(void 0,[].concat(r,[n]))).value instanceof Xl,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),Ho(ps(i.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),i.value}),o,(function(e,t){var n=i.gradFunc(e,t),a=Array.isArray(n)?n:[n];Ho(a.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),Ho(a.every((function(e){return e instanceof Xl})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var o={};return a.forEach((function(e,t){o[t]=function(){return e}})),o}))}}},{key:"readSync",value:function(e){return this.state.tensorInfo.get(e).backend.readSync(e)}},{key:"read",value:function(e){return this.state.tensorInfo.get(e).backend.read(e)}},{key:"time",value:function(){var e=_(x().mark((function e(t){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ql(),e.next=3,this.backend.time(t);case 3:return(r=e.sent).wallMs=ql()-n,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"track",value:function(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}},{key:"registeredVariables",get:function(){return this.state.registeredVariables}},{key:"reset",value:function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new uh,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}]),e}();function lh(e){var t=ys(Qo(e),"float32");return fh.makeTensor(t,e,"float32")}function hh(){var e=Ps();if(null==e._tfengine){var t=new Ts(e);e._tfengine=new ch(t)}return function(e){Ns=e}(e._tfengine.ENV),Hl=function(){return e._tfengine},e._tfengine}ch.nextTensorId=0,ch.nextVariableId=0;var fh=hh();function ph(e,t){var n={a:e,b:t};return fh.runKernel(Fs,n)}function dh(){if("undefined"!==typeof navigator&&null!=navigator){var e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function mh(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}var vh=Is();function gh(e,t){var n=e;if(us(e))return"string"===t?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||us(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&Is().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&yh(e,r,[]),r}function yh(e,t,n){if(n=n||[],Array.isArray(e)||us(e)){Ho(t.length>0,(function(){return"Element arr[".concat(n.join("]["),"] should be a primitive, ")+"but is an array of ".concat(e.length," elements")})),Ho(e.length===t[0],(function(){return"Element arr[".concat(n.join("]["),"] should have ").concat(t[0]," ")+"elements, but has ".concat(e.length," elements")}));for(var r=t.slice(1),a=0;a<e.length;++a)yh(e[a],r,n.concat(a))}else Ho(0===t.length,(function(){return"Element arr[".concat(n.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(t[0]," elements")}))}function bh(e,t,n,r){if("string_or_numeric"!==e){if(null==e)throw new Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must ")+"be ".concat(e," tensor, but got ").concat(t," tensor"))}}function kh(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(e instanceof Xl)return bh(r,e.dtype,t,n),e;var a=fs(e);if("string"!==a&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),bh(r,a,t,n),null==e||!us(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e){var i=null==e?"null":e.constructor.name;throw new Error("Argument '".concat(t,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(i,"'"))}var o=gh(e,a);us(e)||Array.isArray(e)||(e=[e]);var s=!0,u="string"!==a?jl(e,a):Yo(e,[],s);return fh.makeTensor(u,o,a)}function xh(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(e))throw new Error("Argument ".concat(t," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");var a=e;return a.map((function(e,a){return kh(e,"".concat(t,"[").concat(a,"]"),n,r)}))}vh.registerFlag("DEBUG",(function(){return!1}),(function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),vh.registerFlag("IS_BROWSER",(function(){return mh()})),vh.registerFlag("IS_NODE",(function(){return"undefined"!==typeof process&&"undefined"!==typeof process.versions&&"undefined"!==typeof process.versions.node})),vh.registerFlag("IS_CHROME",(function(){return"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),vh.registerFlag("PROD",(function(){return!1})),vh.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return vh.getBool("DEBUG")})),vh.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),vh.registerFlag("IS_TEST",(function(){return!1})),vh.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(function(){return!0}));function wh(e){var t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(t.length," keys."));var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+="__op";var a=function(){fh.startScope(n);try{var e=r.apply(void 0,arguments);return Ss(e)&&console.error("Cannot return a Promise inside of tidy."),fh.endScope(e),e}catch(t){throw fh.endScope(null),t}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}var _h=wh({complex_:function(e,t){var n=kh(e,"real","complex"),r=kh(t,"imag","complex");Ko(n.shape,r.shape,"real and imag shapes, ".concat(n.shape," and ").concat(r.shape,", ")+"must match in call to tf.complex().");var a={real:n,imag:r};return fh.runKernel(ru,a)}});function Sh(e,t,n,r){if(null==r&&(r=fs(e)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!us(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){xs(t);var a=Qo(t),i=Qo(n);Ho(a===i,(function(){return"Based on the provided shape, [".concat(t,"], the tensor should have ")+"".concat(a," values but has ").concat(i)}));for(var o=0;o<n.length;++o){var s=n[o],u=o!==n.length-1||s!==Qo(t.slice(o));Ho(n[o]===t[o]||!u,(function(){return"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(t,"). ")}))}}return us(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==r?jl(e,r):Yo(e,[],!0),fh.makeTensor(e,t,r)}function Ch(e,t,n){return Sh(e,t,gh(e,n),n)}var Th={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};function Eh(e,t){return Ih.apply(this,arguments)}function Ih(){return Ih=_(x().mark((function e(t,n){var r,a,i,o,s,u;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=[],a=[],i=Array.isArray(t)?t.map((function(e){return e.name})):Object.keys(t),o=function(e){var o=i[e],s=Array.isArray(t)?t[e].tensor:t[o];if("float32"!==s.dtype&&"int32"!==s.dtype&&"bool"!==s.dtype&&"string"!==s.dtype&&"complex64"!==s.dtype)throw new Error("Unsupported dtype in weight '".concat(o,"': ").concat(s.dtype));var u={name:o,shape:s.shape,dtype:s.dtype};if("string"===s.dtype){var c=new Promise(function(){var e=_(x().mark((function e(t){var n,r,a,i,o,u,c;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.bytes();case 2:for(n=e.sent,r=n.reduce((function(e,t){return e+t.length}),0)+4*n.length,a=new Uint8Array(r),i=0,o=0;o<n.length;o++)u=n[o],c=new Uint8Array(new Uint32Array([u.length]).buffer),a.set(c,i),i+=4,a.set(u,i),i+=u.length;t(a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());a.push(c)}else a.push(s.data());null!=n&&(u.group=n),r.push(u)},s=0;s<i.length;++s)o(s);return e.next=7,Promise.all(a);case 7:return u=e.sent,e.abrupt("return",{data:Nh(u),specs:r});case 9:case"end":return e.stop()}}),e)}))),Ih.apply(this,arguments)}function Ah(e,t){var n,r,a={},i=0,o=zo(t);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=s.name,c=s.dtype,l=s.shape,h=Qo(l),f=void 0;if("quantization"in s){var p=s.quantization;if("uint8"===p.dtype||"uint16"===p.dtype){if(!("min"in p)||!("scale"in p))throw new Error("Weight ".concat(s.name," with quantization ").concat(p.dtype," ")+"doesn't have corresponding metadata min and scale.")}else{if("float16"!==p.dtype)throw new Error("Weight ".concat(s.name," has unknown ")+"quantization dtype ".concat(p.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");if("float32"!==c)throw new Error("Weight ".concat(s.name," is quantized with ").concat(p.dtype," ")+"which only supports weights of type float32 not ".concat(c,"."))}var d=Th[p.dtype],m=e.slice(i,i+h*d),v="uint8"===p.dtype?new Uint8Array(m):new Uint16Array(m);if("float32"===c)if("uint8"===p.dtype||"uint16"===p.dtype){f=new Float32Array(v.length);for(var g=0;g<v.length;g++){var y=v[g];f[g]=y*p.scale+p.min}}else{if("float16"!==p.dtype)throw new Error("Unsupported quantization type ".concat(p.dtype," ")+"for weight type float32.");void 0===n&&(n=zh()),f=n(v)}else{if("int32"!==c)throw new Error("Unsupported dtype in weight '".concat(u,"': ").concat(c));if("uint8"!==p.dtype&&"uint16"!==p.dtype)throw new Error("Unsupported quantization type ".concat(p.dtype," ")+"for weight type int32.");f=new Int32Array(v.length);for(var b=0;b<v.length;b++){var k=v[b];f[b]=Math.round(k*p.scale+p.min)}}i+=h*d}else if("string"===c){var x=Qo(s.shape);f=[];for(var w=0;w<x;w++){var _=new Uint32Array(e.slice(i,i+4))[0];i+=4;var S=new Uint8Array(e.slice(i,i+_));f.push(S),i+=_}}else{var C=Th[c],T=e.slice(i,i+h*C);if("float32"===c)f=new Float32Array(T);else if("int32"===c)f=new Int32Array(T);else if("bool"===c)f=new Uint8Array(T);else{if("complex64"!==c)throw new Error("Unsupported dtype in weight '".concat(u,"': ").concat(c));f=new Float32Array(T);for(var E=new Float32Array(f.length/2),I=new Float32Array(f.length/2),A=0;A<E.length;A++)E[A]=f[2*A],I[A]=f[2*A+1];var N=Ch(E,l,"float32"),P=Ch(I,l,"float32");a[u]=_h(N,P),N.dispose(),P.dispose()}i+=h*C}"complex64"!==c&&(a[u]=Ch(f,l,c))}}catch(M){o.e(M)}finally{o.f()}return a}function Nh(e){if(null===e)throw new Error("Invalid input value: ".concat(JSON.stringify(e)));var t=0,n=[];e.forEach((function(e){if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(e.constructor.name))}));var r=new Uint8Array(t),a=0;return n.forEach((function(e){r.set(new Uint8Array(e.buffer),a),a+=e.byteLength})),r.buffer}var Ph="undefined"!==typeof Buffer&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function Mh(e){return Ph?Buffer.byteLength(e):new Blob([e]).size}function Dh(e){if(Ph)return Buffer.from(e).toString("base64");for(var t=new Uint8Array(e),n="",r=0,a=t.length;r<a;r++)n+=String.fromCharCode(t[r]);return btoa(n)}function Rh(e){if(Ph){var t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}for(var n=atob(e),r=new Uint8Array(n.length),a=0;a<n.length;++a)r.set([n.charCodeAt(a)],a);return r.buffer}function Oh(e){if(1===e.length)return e[0];var t=0;e.forEach((function(e){t+=e.byteLength}));var n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(new Uint8Array(e),r),r+=e.byteLength})),n.buffer}function Fh(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function Lh(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:Mh(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:Mh(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}function zh(){var e=function(){var e=function(e){for(var t=e<<13,n=0;0===(8388608&t);)n-=8388608,t<<=1;return(t&=-8388609)|n+947912704},t=new Uint32Array(2048);t[0]=0;for(var n=1;n<1024;n++)t[n]=e(n);for(var r=1024;r<2048;r++)t[r]=939524096+(r-1024<<13);return t}(),t=function(){var e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(var t=1;t<31;t++)e[t]=t<<23;for(var n=33;n<63;n++)e[n]=2147483648+(n-32<<23);return e}(),n=function(){for(var e=new Uint32Array(64),t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return function(r){for(var a=new ArrayBuffer(4*r.length),i=new Uint32Array(a),o=0;o<r.length;o++){var s=r[o],u=e[n[s>>10]+(1023&s)]+t[s>>10];i[o]=u}return new Float32Array(a)}}var Bh=function(){function e(){s(this,e),this.saveRouters=[],this.loadRouters=[]}return c(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerSaveRouter",value:function(t){e.getInstance().saveRouters.push(t)}},{key:"registerLoadRouter",value:function(t){e.getInstance().loadRouters.push(t)}},{key:"getSaveHandlers",value:function(t){return e.getHandlers(t,"save")}},{key:"getLoadHandlers",value:function(t,n){return e.getHandlers(t,"load",n)}},{key:"getHandlers",value:function(t,n,r){var a=[];return("load"===n?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach((function(e){var n=e(t,r);null!==n&&a.push(n)})),a}}]),e}(),Vh=function(e){return Bh.registerSaveRouter(e)},jh=function(e){return Bh.registerLoadRouter(e)},qh=function(e){return Bh.getSaveHandlers(e)},Gh=function(e,t){return Bh.getLoadHandlers(e,t)},Wh="tensorflowjs",Uh="models_store",Hh="model_info_store";function Kh(){if(!Is().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e="undefined"===typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function Xh(e){var t=e.result;t.createObjectStore(Uh,{keyPath:"modelPath"}),t.createObjectStore(Hh,{keyPath:"modelPath"})}var Yh=function(){function e(t){if(s(this,e),this.indexedDB=Kh(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return c(e,[{key:"save",value:function(){var e=_(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 2:return e.abrupt("return",this.databaseAction(this.modelPath,t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=_(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.databaseAction(this.modelPath));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"databaseAction",value:function(e,t){var n=this;return new Promise((function(e,r){var a=n.indexedDB.open(Wh,1);a.onupgradeneeded=function(){return Xh(a)},a.onsuccess=function(){var i=a.result;if(null==t){var o=i.transaction(Uh,"readonly"),s=o.objectStore(Uh).get(n.modelPath);s.onsuccess=function(){if(null==s.result)return i.close(),r(new Error("Cannot find model with path '".concat(n.modelPath,"' ")+"in IndexedDB."));e(s.result.modelArtifacts)},s.onerror=function(e){return i.close(),r(s.error)},o.oncomplete=function(){return i.close()}}else{var u,c=Lh(t),l=i.transaction(Hh,"readwrite"),h=l.objectStore(Hh),f=h.put({modelPath:n.modelPath,modelArtifactsInfo:c});f.onsuccess=function(){var a=(u=i.transaction(Uh,"readwrite")).objectStore(Uh).put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:c});a.onsuccess=function(){return e({modelArtifactsInfo:c})},a.onerror=function(e){var t=(h=l.objectStore(Hh)).delete(n.modelPath);t.onsuccess=function(){return i.close(),r(a.error)},t.onerror=function(e){return i.close(),r(a.error)}}},f.onerror=function(e){return i.close(),r(f.error)},l.oncomplete=function(){null==u?i.close():u.oncomplete=function(){return i.close()}}}},a.onerror=function(e){return r(a.error)}}))}}]),e}();Yh.URL_SCHEME="indexeddb://";var Qh=function(e){return Is().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Yh.URL_SCHEME)?(t=e.slice(Yh.URL_SCHEME.length),new Yh(t)):null;var t};Bh.registerSaveRouter(Qh),Bh.registerLoadRouter(Qh);var $h=function(){function e(){s(this,e),this.indexedDB=Kh()}return c(e,[{key:"listModels",value:function(){var e=_(x().mark((function e(){var t=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=t.indexedDB.open(Wh,1);r.onupgradeneeded=function(){return Xh(r)},r.onsuccess=function(){var t=r.result,a=t.transaction(Hh,"readonly"),i=a.objectStore(Hh).getAll();i.onsuccess=function(){var t,n={},r=zo(i.result);try{for(r.s();!(t=r.n()).done;){var a=t.value;n[a.modelPath]=a.modelArtifactsInfo}}catch(o){r.e(o)}finally{r.f()}e(n)},i.onerror=function(e){return t.close(),n(i.error)},a.oncomplete=function(){return t.close()}},r.onerror=function(e){return n(r.error)}})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"removeModel",value:function(){var e=_(x().mark((function e(t){var n=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(r=t).startsWith(Yh.URL_SCHEME)?r.slice(Yh.URL_SCHEME.length):r,e.abrupt("return",new Promise((function(e,r){var a=n.indexedDB.open(Wh,1);a.onupgradeneeded=function(){return Xh(a)},a.onsuccess=function(){var n,i=a.result,o=i.transaction(Hh,"readwrite"),s=o.objectStore(Hh),u=s.get(t);u.onsuccess=function(){if(null==u.result)return i.close(),r(new Error("Cannot find model with path '".concat(t,"' ")+"in IndexedDB."));var a=s.delete(t),o=function(){var a=(n=i.transaction(Uh,"readwrite")).objectStore(Uh).delete(t);a.onsuccess=function(){return e(u.result.modelArtifactsInfo)},a.onerror=function(e){return r(u.error)}};a.onsuccess=o,a.onerror=function(e){return o(),i.close(),r(u.error)}},u.onerror=function(e){return i.close(),r(u.error)},o.oncomplete=function(){null==n?i.close():n.oncomplete=function(){return i.close()}}},a.onerror=function(e){return r(a.error)}})));case 2:case"end":return e.stop()}var r}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Jh="/",Zh="tensorflowjs_models",ef="info",tf="model_topology",nf="weight_specs",rf="weight_data",af="model_metadata";function of(e){return{info:[Zh,e,ef].join(Jh),topology:[Zh,e,tf].join(Jh),weightSpecs:[Zh,e,nf].join(Jh),weightData:[Zh,e,rf].join(Jh),modelMetadata:[Zh,e,af].join(Jh)}}function sf(e){var t=e.split(Jh);if(t.length<3)throw new Error("Invalid key format: ".concat(e));return t.slice(1,t.length-1).join(Jh)}var uf=function(){function e(t){if(s(this,e),!Is().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=of(this.modelPath)}return c(e,[{key:"save",value:function(){var e=_(x().mark((function e(t){var n,r,a,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=4;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 4:return n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),a=Lh(t),e.prev=7,this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,Dh(t.weightData)),i={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy},null!=t.signature&&(i.signature=t.signature),null!=t.userDefinedMetadata&&(i.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(i.modelInitializer=t.modelInitializer),this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),e.abrupt("return",{modelArtifactsInfo:a});case 20:throw e.prev=20,e.t0=e.catch(7),this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(a.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(a.weightSpecsBytes,", ")+"weightDataBytes=".concat(a.weightDataBytes,"."));case 28:case"end":return e.stop()}}),e,this,[[7,20]])})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=_(x().mark((function e(){var t,n,r,a,i,o,s;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(t=JSON.parse(this.LS.getItem(this.keys.info)))){e.next=3;break}throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));case 3:if("JSON"===t.modelTopologyType){e.next=5;break}throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");case 5:if(n={},null!=(r=JSON.parse(this.LS.getItem(this.keys.topology)))){e.next=9;break}throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");case 9:if(n.modelTopology=r,null!=(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))){e.next=13;break}throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");case 13:if(n.weightSpecs=a,null!=(i=this.LS.getItem(this.keys.modelMetadata))&&(o=JSON.parse(i),n.format=o.format,n.generatedBy=o.generatedBy,n.convertedBy=o.convertedBy,null!=o.signature&&(n.signature=o.signature),null!=o.userDefinedMetadata&&(n.userDefinedMetadata=o.userDefinedMetadata),null!=o.modelInitializer&&(n.modelInitializer=o.modelInitializer)),null!=(s=this.LS.getItem(this.keys.weightData))){e.next=19;break}throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));case 19:return n.weightData=Rh(s),e.abrupt("return",n);case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();uf.URL_SCHEME="localstorage://";var cf=function(e){return Is().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(uf.URL_SCHEME)?(t=e.slice(uf.URL_SCHEME.length),new uf(t)):null;var t};Bh.registerSaveRouter(cf),Bh.registerLoadRouter(cf);var lf=function(){function e(){s(this,e),Ho(Is().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),Ho("undefined"===typeof window||"undefined"!==typeof window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return c(e,[{key:"listModels",value:function(){var e=_(x().mark((function e(){var t,n,r,a,i,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t={},n=Zh+Jh,r=Jh+ef,a=0;a<this.LS.length;++a)(i=this.LS.key(a)).startsWith(n)&&i.endsWith(r)&&(o=sf(i),t[o]=JSON.parse(this.LS.getItem(i)));return e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"removeModel",value:function(){var e=_(x().mark((function e(t){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(a=t).startsWith(uf.URL_SCHEME)?a.slice(uf.URL_SCHEME.length):a,n=of(t),null!=this.LS.getItem(n.info)){e.next=4;break}throw new Error("Cannot find model at path '".concat(t,"'"));case 4:return r=JSON.parse(this.LS.getItem(n.info)),this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),e.abrupt("return",r);case 10:case"end":return e.stop()}var a}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),hf="://",ff=function(){function e(){s(this,e),this.managers={}}return c(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerManager",value:function(t,n){Ho(null!=t,(function(){return"scheme must not be undefined or null."})),t.endsWith(hf)&&(t=t.slice(0,t.indexOf(hf))),Ho(t.length>0,(function(){return"scheme must not be an empty string."}));var r=e.getInstance();Ho(null==r.managers[t],(function(){return"A model store manager is already registered for scheme '".concat(t,"'.")})),r.managers[t]=n}},{key:"getManager",value:function(e){var t=this.getInstance().managers[e];if(null==t)throw new Error("Cannot find model manager for scheme '".concat(e,"'"));return t}},{key:"getSchemes",value:function(){return Object.keys(this.getInstance().managers)}}]),e}();function pf(e){if(-1===e.indexOf(hf))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+"".concat(ff.getSchemes().join(",")));return{scheme:e.split(hf)[0],path:e.split(hf)[1]}}function df(e,t){return mf.apply(this,arguments)}function mf(){return mf=_(x().mark((function e(t,n){var r,a,i,o,s,u,c,l,h,f,p=arguments;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=p.length>2&&void 0!==p[2]&&p[2],Ho(t!==n,(function(){return"Old path and new path are the same: '".concat(t,"'")})),Ho((a=Bh.getLoadHandlers(t)).length>0,(function(){return"Copying failed because no load handler is found for source URL ".concat(t,".")})),Ho(a.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") ")+"load handlers for source URL ".concat(t,".")})),i=a[0],Ho((o=Bh.getSaveHandlers(n)).length>0,(function(){return"Copying failed because no save handler is found for destination "+"URL ".concat(n,".")})),Ho(o.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") ")+"save handlers for destination URL ".concat(n,".")})),s=o[0],u=pf(t).scheme,c=pf(t).path,l=u===pf(t).scheme,e.next=15,i.load();case 15:if(h=e.sent,!r||!l){e.next=19;break}return e.next=19,ff.getManager(u).removeModel(c);case 19:return e.next=21,s.save(h);case 21:if(f=e.sent,!r||l){e.next=25;break}return e.next=25,ff.getManager(u).removeModel(c);case 25:return e.abrupt("return",f.modelArtifactsInfo);case 26:case"end":return e.stop()}}),e)}))),mf.apply(this,arguments)}function vf(){return gf.apply(this,arguments)}function gf(){return(gf=_(x().mark((function e(){var t,n,r,a,i,o,s;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=ff.getSchemes(),n={},r=zo(t),e.prev=3,r.s();case 5:if((a=r.n()).done){e.next=13;break}return i=a.value,e.next=9,ff.getManager(i).listModels();case 9:for(s in o=e.sent)n[i+hf+s]=o[s];case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return e.abrupt("return",n);case 22:case"end":return e.stop()}}),e,null,[[3,15,18,21]])})))).apply(this,arguments)}function yf(e){return bf.apply(this,arguments)}function bf(){return(bf=_(x().mark((function e(t){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=pf(t),r=ff.getManager(n.scheme),e.abrupt("return",r.removeModel(n.path));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function kf(e,t){return xf.apply(this,arguments)}function xf(){return(xf=_(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!1,e.abrupt("return",df(t,n,false));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function wf(e,t){return _f.apply(this,arguments)}function _f(){return(_f=_(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!0,e.abrupt("return",df(t,n,true));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Sf=function(){function e(){s(this,e)}return c(e,[{key:"fetch",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return fetch(e,t)}))},{key:"now",value:function(){return performance.now()}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got ".concat(t));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return new TextDecoder(t).decode(e)}}]),e}();if(Is().get("IS_BROWSER")){Is().setPlatform("browser",new Sf);try{ff.registerManager(uf.URL_SCHEME,new lf)}catch(ZJ){}try{ff.registerManager(Yh.URL_SCHEME,new $h)}catch(ZJ){}}var Cf,Tf=function(){return __webpack_require__(5410)};var Ef=function(){function e(){s(this,e),this.util=__webpack_require__(8628),this.textEncoder=new this.util.TextEncoder}return c(e,[{key:"fetch",value:function(e,t){return null!=Is().global.fetch?Is().global.fetch(e,t):(null==Cf&&(Cf=Tf()),Cf(e,t))}},{key:"now",value:function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(t));return this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}}]),e}();function If(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return t=t||"float32",xs(e),new Ul(e,t,n)}Is().get("IS_NODE")&&Is().setPlatform("node",new Ef);var Af=wh({cast_:function(e,t){var n=kh(e,"x","cast");if(!function(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}(t))throw new Error("Failed to cast to unknown dtype ".concat(t));if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var r={x:n},a={dtype:t};return fh.runKernel(eu,r,a)}});var Nf=wh({clone_:function(e){var t={x:kh(e,"x","clone","string_or_numeric")};return fh.runKernel(Gu,t)}});hh();var Pf={buffer:If,cast:Af,clone:Nf,print:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(e.toString(t))}};!function(e){Kl=e}(Pf);function Mf(e){return new Promise((function(e){return setTimeout(e)})).then(e)}var Df=function(){function e(t){if(s(this,e),!Is().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelTopologyFileName=t+".json",this.weightDataFileName=t+".weights.bin"}return c(e,[{key:"save",value:function(){var e=_(x().mark((function e(t){var n,r,a,i,o,s;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"!==typeof document){e.next=2;break}throw new Error("Browser downloads are not supported in this environment since `document` is not present");case 2:if(n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer)){e.next=7;break}throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 7:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},null!=t.signature&&(a.signature=t.signature),null!=t.userDefinedMetadata&&(a.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(a.modelInitializer=t.modelInitializer),i=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),(o=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,o.href=i,e.next=18,Mf((function(){return o.dispatchEvent(new MouseEvent("click"))}));case 18:if(null==t.weightData){e.next=24;break}return(s=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=n,e.next=24,Mf((function(){return s.dispatchEvent(new MouseEvent("click"))}));case 24:return e.abrupt("return",{modelArtifactsInfo:Lh(t)});case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();Df.URL_SCHEME="downloads://";var Rf=function(){function e(t){if(s(this,e),null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+"but received ".concat(t));this.files=t}return c(e,[{key:"load",value:function(){var e=_(x().mark((function e(){var t,n,r=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.files[0],n=this.files.slice(1),e.abrupt("return",new Promise((function(e,a){var i=new FileReader;i.onload=function(i){var o=JSON.parse(i.target.result),s=o.modelTopology;if(null!=s){0===n.length&&e({modelTopology:s});var u=o.weightsManifest;if(null!=u){var c;try{c=r.checkManifestAndWeightFiles(u,n)}catch(ZJ){return void a(ZJ)}var l=[],h=[],f=[];u.forEach((function(e){e.paths.forEach((function(e){h.push(e),f.push(null)})),l.push.apply(l,Fn(e.weights))})),u.forEach((function(t){t.paths.forEach((function(t){var n=new FileReader;n.onload=function(n){var r=n.target.result,a=h.indexOf(t);if(f[a]=r,-1===f.indexOf(null)){var i={modelTopology:s,weightSpecs:l,weightData:Oh(f),format:o.format,generatedBy:o.generatedBy,convertedBy:o.convertedBy};null!=o.signature&&(i.signature=o.signature),null!=o.userDefinedMetadata&&(i.userDefinedMetadata=o.userDefinedMetadata),null!=o.modelInitializer&&(i.modelInitializer=o.modelInitializer),e(i)}},n.onerror=function(e){return a("Failed to weights data from file of path '".concat(t,"'."))},n.readAsArrayBuffer(c[t])}))}))}else a(new Error("weightManifest field is missing from file ".concat(t.name)))}else a(new Error("modelTopology field is missing from file ".concat(t.name)))},i.onerror=function(e){return a("Failed to read model topology and weights manifest JSON "+"from file '".concat(t.name,"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only.")},i.readAsText(t)})));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkManifestAndWeightFiles",value:function(e,t){var n,r=[],a=t.map((function(e){return Fh(e.name)})),i={},o=zo(e);try{for(o.s();!(n=o.n()).done;){n.value.paths.forEach((function(e){var n=Fh(e);if(-1!==r.indexOf(n))throw new Error("Duplicate file basename found in weights manifest: "+"'".concat(n,"'"));if(r.push(n),-1===a.indexOf(n))throw new Error("Weight file with basename '".concat(n,"' is not provided."));i[e]=t[a.indexOf(n)]}))}}catch(ZJ){o.e(ZJ)}finally{o.f()}if(r.length!==t.length)throw new Error("Mismatch in the number of files in weights manifest "+"(".concat(r.length,") and the number of weight files provided ")+"(".concat(t.length,")."));return i}}]),e}();function Of(e){return new Rf(e)}function Ff(e,t,n,r){!function(e){Ho(null!=e&&Array.isArray(e)&&e.length>0,(function(){return"promises must be a none empty array"}))}(e),function(e,t){Ho(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(e)})),Ho(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(t)})),Ho(t>=e,(function(){return"startFraction must be no more than endFraction, but "+"got startFraction ".concat(e," and endFraction ")+"".concat(t)}))}(n=null==n?0:n,r=null==r?1:r);var a=0;return Promise.all(e.map((function(i){return i.then((function(i){var o=n+ ++a/e.length*(r-n);return t(o),i})),i})))}function Lf(e,t){return zf.apply(this,arguments)}function zf(){return(zf=_(x().mark((function e(t,n){var r,a,i,o,s,u,c,l,h;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n&&(n={}),r=null==n.fetchFunc?Is().platform.fetch:n.fetchFunc,a=t.map((function(e){return r(e,n.requestInit,{isBinary:!0})})),i=0,o=.5,null!=n.onProgress){e.next=11;break}return e.next=8,Promise.all(a);case 8:e.t0=e.sent,e.next=14;break;case 11:return e.next=13,Ff(a,n.onProgress,i,o);case 13:e.t0=e.sent;case 14:if(s=e.t0,u=s.map((function(e){return e.arrayBuffer()})),c=.5,l=1,null!=n.onProgress){e.next=24;break}return e.next=21,Promise.all(u);case 21:e.t1=e.sent,e.next=27;break;case 24:return e.next=26,Ff(u,n.onProgress,c,l);case 26:e.t1=e.sent;case 27:return h=e.t1,e.abrupt("return",h);case 29:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Bf(e){return Vf.apply(this,arguments)}function Vf(){return Vf=_(x().mark((function e(t){var n,r,a,i,o=arguments;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:"",r=o.length>2?o[2]:void 0,a=o.length>3?o[3]:void 0,i=jf((function(e){return Lf(e,{requestInit:a})})),e.abrupt("return",i(t,n,r));case 6:case"end":return e.stop()}}),e)}))),Vf.apply(this,arguments)}function jf(e){return function(){var t=_(x().mark((function t(n){var r,a,i,o,s,u,c,l,h,f,p,d,m=arguments;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=m.length>1&&void 0!==m[1]?m[1]:"",a=m.length>2?m[2]:void 0,i=n.map((function(){return!1})),o={},s=null!=a?a.map((function(){return!1})):[],u=[],n.forEach((function(e,t){var n=0;e.weights.forEach((function(e){var r="quantization"in e?e.quantization.dtype:e.dtype,c=Th[r]*Qo(e.shape),l=function(){i[t]=!0,null==o[t]&&(o[t]=[]),o[t].push({manifestEntry:e,groupOffset:n,sizeBytes:c})};null!=a?a.forEach((function(t,n){t===e.name&&(l(),s[n]=!0)})):l(),u.push(e.name),n+=c}))})),s.every((function(e){return e}))){t.next=10;break}throw c=a.filter((function(e,t){return!s[t]})),new Error("Could not find weights in manifest with names: "+"".concat(c.join(", "),". \n")+"Manifest JSON has weights with names: "+"".concat(u.join(", "),"."));case 10:return l=i.reduce((function(e,t,n){return t&&e.push(n),e}),[]),h=[],l.forEach((function(e){n[e].paths.forEach((function(e){var t=r+(r.endsWith("/")?"":"/")+e;h.push(t)}))})),t.next=15,e(h);case 15:return f=t.sent,p={},d=0,l.forEach((function(e){for(var t=n[e].paths.length,r=0,a=0;a<t;a++)r+=f[d+a].byteLength;for(var i=new ArrayBuffer(r),s=new Uint8Array(i),u=0,c=0;c<t;c++){var l=new Uint8Array(f[d+c]);s.set(l,u),u+=l.byteLength}o[e].forEach((function(e){var t=Ah(i.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(var n in t)p[n]=t[n]})),d+=t})),t.abrupt("return",p);case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}Bh.registerSaveRouter((function(e){return Is().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Df.URL_SCHEME)?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new Df(e)}(e.slice(Df.URL_SCHEME.length)):null}));var qf=function(){function e(t,n){if(s(this,e),this.DEFAULT_METHOD="POST",null==n&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,this.weightUrlConverter=n.weightUrlConverter,null!=n.fetchFunc?(Ho("function"===typeof n.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=n.fetchFunc):this.fetch=Is().platform.fetch,Ho(null!=t&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&Ho(2===t.length,(function(){return"URL paths for http must have a length of 2, "+"(actual length is ".concat(t.length,").")})),this.path=t,null!=n.requestInit&&null!=n.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return c(e,[{key:"save",value:function(){var e=_(x().mark((function e(t){var n,r,a,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");case 2:return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},null!=t.signature&&(a.signature=t.signature),null!=t.userDefinedMetadata&&(a.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(a.modelInitializer=t.modelInitializer),n.body.append("model.json",new Blob([JSON.stringify(a)],{type:"application/json"}),"model.json"),null!=t.weightData&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),e.next=13,this.fetch(this.path,n);case 13:if(!(i=e.sent).ok){e.next=18;break}return e.abrupt("return",{modelArtifactsInfo:Lh(t),responses:[i]});case 18:throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(i.status,"."));case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=_(x().mark((function e(){var t,n,r,a,i,o,s,u,c,l,h,f,p,d,m,v;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch(this.path,this.requestInit);case 2:if((t=e.sent).ok){e.next=5;break}throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(t.status,". Please verify this URL points to ")+"the model JSON of the model to load.");case 5:return e.prev=5,e.next=8,t.json();case 8:n=e.sent,e.next=16;break;case 11:throw e.prev=11,e.t0=e.catch(5),r="Failed to parse model JSON of response from ".concat(this.path,"."),this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 16:if(a=n.modelTopology,i=n.weightsManifest,o=n.generatedBy,s=n.convertedBy,u=n.format,c=n.signature,l=n.userDefinedMetadata,null!=a||null!=i){e.next=25;break}throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");case 25:if(null==i){e.next=32;break}return e.next=28,this.loadWeights(i);case 28:p=e.sent,d=Ct(p,2),h=d[0],f=d[1];case 32:return m={modelTopology:a,weightSpecs:h,weightData:f,generatedBy:o,convertedBy:s,format:u},null!=c&&(m.signature=c),null!=l&&(m.userDefinedMetadata=l),(v=n.modelInitializer)&&(m.modelInitializer=v),e.abrupt("return",m);case 38:case"end":return e.stop()}}),e,this,[[5,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"loadWeights",value:function(){var e=_(x().mark((function e(t){var n,r,a,i,o,s,u,c,l,h,f,p,d,m,v,g,y,b,k;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Array.isArray(this.path)?this.path[1]:this.path,r=Gf(n),a=Ct(r,2),i=a[0],o=a[1],s=this.weightPathPrefix||i,u=[],c=zo(t);try{for(c.s();!(l=c.n()).done;)h=l.value,u.push.apply(u,Fn(h.weights))}catch(ZJ){c.e(ZJ)}finally{c.f()}f=[],p=[],d=zo(t);try{for(d.s();!(m=d.n()).done;){v=m.value,g=zo(v.paths);try{for(g.s();!(y=g.n()).done;)b=y.value,null!=this.weightUrlConverter?p.push(this.weightUrlConverter(b)):f.push(s+b+o)}catch(ZJ){g.e(ZJ)}finally{g.f()}}}catch(ZJ){d.e(ZJ)}finally{d.f()}if(!this.weightUrlConverter){e.next=19;break}return e.t0=f.push,e.t1=f,e.t2=Fn,e.next=16,Promise.all(p);case 16:e.t3=e.sent,e.t4=(0,e.t2)(e.t3),e.t0.apply.call(e.t0,e.t1,e.t4);case 19:return e.next=21,Lf(f,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});case 21:return k=e.sent,e.abrupt("return",[u,Oh(k)]);case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function Gf(e){var t=e.lastIndexOf("/"),n=e.lastIndexOf("?");return[e.substring(0,t)+"/",n>t?e.substring(n):""]}function Wf(e){return null!=e.match(qf.URL_SCHEME_REGEX)}qf.URL_SCHEME_REGEX=/^https?:\/\//;var Uf=function(e,t){if("undefined"===typeof fetch&&(null==t||null==t.fetchFunc))return null;return(Array.isArray(e)?e.every((function(e){return Wf(e)})):Wf(e))?Hf(e,t):null};function Hf(e,t){return new qf(e,t)}function Kf(e,t){return Hf(e,t)}Bh.registerSaveRouter(Uf),Bh.registerLoadRouter(Uf);var Xf=function(){function e(t){s(this,e),this.modelArtifacts=t}return c(e,[{key:"load",value:function(){var e=_(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.modelArtifacts);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Yf=function(){function e(t){s(this,e),this.saveHandler=t}return c(e,[{key:"save",value:function(){var e=_(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.saveHandler(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function Qf(e,t,n,r){if(1===arguments.length){var a=null!=e.modelTopology||null!=e.weightSpecs;return a?new Xf(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Xf({modelTopology:e}))}return console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Xf({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r})}function $f(e){return new Yf(e)}function Jf(e,t,n){var r=e.shape.length;Ho(r===t.length,(function(){return"Error in slice".concat(r,"D: Length of begin ").concat(t," must ")+"match the rank of the array (".concat(r,").")})),Ho(r===n.length,(function(){return"Error in slice".concat(r,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(r,").")}));for(var a=function(a){Ho(t[a]+n[a]<=e.shape[a],(function(){return"Error in slice".concat(r,"D: begin[").concat(a,"] + size[").concat(a,"] ")+"(".concat(t[a]+n[a],") would overflow input.shape[").concat(a,"] (").concat(e.shape[a],")")}))},i=0;i<r;++i)a(i)}function Zf(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function ep(e,t,n){return n<=e?n:n-(t-1)}function tp(e,t){for(var n=[],r=0;r<e;r++)n.push(t+r);return n}function np(e,t,n,r,a,i,o,s,u){var c=e.length,l=new Array(c),h=new Array(c),f=new Array(c);if(t.length&&n>0){var p=t[0],d=n+1;l=function(e,t,n,r,a){for(var i=Fn(a),o=tp(n,t),s=0;s<i.length;s++)if(o.indexOf(s)>-1)i[s]=0;else{var u=ep(t,n,s),c=r[u];e&1<<u&&(c=0),i[s]=c}return i}(o,p,d,r,e),h=function(e,t,n,r,a){for(var i=Fn(a),o=tp(n,t),s=0;s<i.length;s++)if(o.indexOf(s)>-1)i[s]=Number.MAX_SAFE_INTEGER;else{var u=ep(t,n,s),c=r[u];e&1<<u&&(c=Number.MAX_SAFE_INTEGER),i[s]=c}for(var l=0;l<i.length;l++){var h=a[l];i[l]<0&&(i[l]+=h),i[l]=Go(0,i[l],a[l])}return i}(s,p,d,a,e),f=function(e,t,n,r){for(var a=Fn(e),i=a.length;i<r.length;i++)a.push(1);for(var o=0;o<n;o++)0===o?a[t]=1:(a.splice(t,0,1),a.pop());return a}(i,p,d,e)}else for(var m=0;m<c;m++)l[m]=ap(o,r,i,e,m,u),h[m]=ip(s,a,i,e,m,u),f[m]=rp(i,m,u);return{begin:l,end:h,strides:f}}function rp(e,t,n){var r=e[t];return(n&1<<t||null==r)&&(r=1),r}function ap(e,t,n,r,a,i){var o=t[a],s=n[a]||1;(e&1<<a||i&1<<a||null==o)&&(o=s>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var u=r[a];return o<0&&(o+=u),o=Go(0,o,u-1)}function ip(e,t,n,r,a,i){var o=t[a],s=n[a]||1;(e&1<<a||i&1<<a||null==o)&&(o=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var u=r[a];return o<0&&(o+=u),o=s>0?Go(0,o,u):Go(-1,o,u-1)}function op(e,t,n){for(var r=n.length,a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(var i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function sp(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function up(e,t,n){var r,a,i=e.shape.length;return(r="number"===typeof t?[t].concat(Fn(new Array(i-1).fill(0))):t.length<i?t.concat(new Array(i-t.length).fill(0)):t.slice()).forEach((function(e){Ho(-1!==e,(function(){return"slice() does not support negative begin indexing."}))})),a=(a=null==n?new Array(i).fill(-1):"number"===typeof n?[n].concat(Fn(new Array(i-1).fill(-1))):n.length<i?n.concat(new Array(i-n.length).fill(-1)):n).map((function(t,n){return t>=0?t:(Ho(-1===t,(function(){return"Negative size values should be exactly -1 but got "+"".concat(t," for the slice() size at index ").concat(n,".")})),e.shape[n]-r[n])})),[r,a]}function cp(e,t,n,r,a,i,o,s,u){var c=t.slice(),l=n.slice(),h=r;null==r&&(h=new Array(c.length));var f=Zf(o);if(f.length>1)throw new Error("Multiple ellipses in slice is not allowed.");if(0!==o&&0!==s)throw new Error("Using both ellipsisMask and newAxisMask is not yet supported.");if(0!==o&&0!==u)throw new Error("Using both ellipsisMask and shrinkAxisMask is not yet supported.");var p=e.length-c.length,d=Zf(s),m=e.slice();d.forEach((function(e){c[e]=0,l[e]=1,m.splice(e,0,1)}));var v=np(m,f,p,c,l,h,a,i,o),g=v.begin,y=v.end,b=v.strides;c=g,l=y,h=b;var k=Zf(u);k.forEach((function(e){l[e]=c[e]+1,h[e]=1}));var x=function(e,t,n){for(var r=[],a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}(c,l,h),w=x.filter((function(e,t){return-1===k.indexOf(t)}));return{nonStrided:h.every((function(e){return 1===e})),$begin:c,$end:l,$strides:h,size:x,newShape:m,outShape:w}}var lp=function(){function e(){s(this,e)}return c(e,[{key:"getClassName",value:function(){return this.constructor.className}}],[{key:"fromConfig",value:function(e,t){return new e(t)}}]),e}(),hp=function(){function e(){s(this,e),this.classNameMap={}}return c(e,null,[{key:"getMap",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"register",value:function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]}}]),e}();function fp(e){Ho(null!=e.className,(function(){return"Class being registered does not have the static className property defined."})),Ho("string"===typeof e.className,(function(){return"className is required to be a string, but got type "+typeof e.className})),Ho(e.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),hp.register(e)}function pp(e){Is().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function dp(){return fh}function mp(){return fh.memory()}function vp(e,t){return fh.tidy(e,t)}function gp(e){oh(e).forEach((function(e){return e.dispose()}))}function yp(e){return fh.keep(e)}function bp(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return fh.registerBackend(e,t,n)}function kp(e){return fh.customGrad(e)}function xp(e,t){if((us(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&us(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Sh(e,[],[],t)}var wp=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"minimize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.computeGradients(e,n),a=r.value,i=r.grads;if(null!=n){var o=n.map((function(e){return{name:e.name,tensor:i[e.name]}}));this.applyGradients(o)}else this.applyGradients(i);return gp(i),t?a:(a.dispose(),null)}},{key:"iterations",get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}},{key:"incrementIterations",value:function(){this.iterations_=this.iterations+1}},{key:"computeGradients",value:function(e,t){return function(e,t){Ho(ps(e),(function(){return"The f passed in variableGrads(f) must be a function"})),Ho(null==t||Array.isArray(t)&&t.every((function(e){return e instanceof eh})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=t;if(!n)for(var r in t=[],fh.registeredVariables)t.push(fh.registeredVariables[r]);var a=n?t.filter((function(e){return!e.trainable})):null,i=t.length;t=t.filter((function(e){return e.trainable})),Ho(t.length>0,(function(){return"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(i," variables is ")+"trainable."}));var o=fh.gradients(e,t,null,!0),s=o.value,u=o.grads;Ho(u.some((function(e){return null!=e})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),Ho(0===s.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(s.rank," tensor")}));var c={};return t.forEach((function(e,t){null!=u[t]&&(c[e.name]=u[t])})),null!=a&&a.forEach((function(e){return c[e.name]=null})),{value:s,grads:c}}(e,t)}},{key:"dispose",value:function(){null!=this.iterations_&&gp(this.iterations_)}},{key:"saveIterations",value:function(){var e=_(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==this.iterations_&&(this.iterations_=0),e.abrupt("return",{name:"iter",tensor:xp(this.iterations_,"int32")});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getWeights",value:function(){var e=_(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("getWeights() is not implemented for this optimizer yet.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=_(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"extractIterations",value:function(){var e=_(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t[0].tensor.data();case 2:return this.iterations_=e.sent[0],e.abrupt("return",t.slice(1));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(lp);Object.defineProperty(wp,Symbol.hasInstance,{value:function(e){return null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients}});var _p=wh({abs_:function(e){var t=kh(e,"x","abs");if("complex64"===t.dtype){var n={x:t};return fh.runKernel(au,n)}var r={x:t};return fh.runKernel(Ds,r)}});var Sp=wh({add_:function(e,t){var n=kh(e,"a","add"),r=kh(t,"b","add"),a=Ct(ah(n,r),2),i={a:n=a[0],b:r=a[1]};return fh.runKernel(Fs,i)}});var Cp=wh({all_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=kh(e,"x","all","bool"),a={x:r},i={axis:t,keepDims:n};return fh.runKernel(zs,a,i)}});var Tp=wh({any_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=kh(e,"x","any","bool"),a={x:r},i={axis:t,keepDims:n};return fh.runKernel(Bs,a,i)}});var Ep=wh({argMax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=kh(e,"x","argMax"),r={x:n},a={axis:t};return fh.runKernel(Vs,r,a)}});function Ip(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5?arguments[5]:void 0,o=e[3],s=[].concat(Fn(t),[o]),u=qp(a);return Pp(e,s,n,i,r,null,null,u)}function Ap(e,t,n,r,a,i){var o,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",u=Rp(t),c=Ct(u,2),l=c[0],h=c[1];if("channelsLast"===s)o=[l,h,e[3],e[3]];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));o=[l,h,e[1],e[1]]}return Pp(e,o,n,r,a,i,!1,s)}function Np(e,t,n,r,a,i){var o,s,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC",c=Op(t),l=Ct(c,3),h=l[0],f=l[1],p=l[2];if("NDHWC"===u)s="channelsLast",o=[h,f,p,e[4],e[4]];else{if("NCDHW"!==u)throw new Error("Unknown dataFormat ".concat(u));s="channelsFirst",o=[h,f,p,e[1],e[1]]}return Mp(e,o,n,r,a,!1,s,i)}function Pp(e,t,n,r,a,i){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",u=-1,c=-1,l=-1,h=-1;if("channelsLast"===s){var f=Ct(e,4);u=f[0],c=f[1],l=f[2],h=f[3]}else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));var p=Ct(e,4);u=p[0],h=p[1],c=p[2],l=p[3]}var d,m=Ct(t,4),v=m[0],g=m[1],y=m[3],b=Rp(n),k=Ct(b,2),x=k[0],w=k[1],_=Rp(r),S=Ct(_,2),C=S[0],T=S[1],E=Fp(v,C),I=Fp(g,T),A=Lp(a,c,l,x,w,E,I,i,s),N=A.padInfo,P=A.outHeight,M=A.outWidth,D=o?y*h:y;return"channelsFirst"===s?d=[u,D,P,M]:"channelsLast"===s&&(d=[u,P,M,D]),{batchSize:u,dataFormat:s,inHeight:c,inWidth:l,inChannels:h,outHeight:P,outWidth:M,outChannels:D,padInfo:N,strideHeight:x,strideWidth:w,filterHeight:v,filterWidth:g,effectiveFilterHeight:E,effectiveFilterWidth:I,dilationHeight:C,dilationWidth:T,inShape:e,outShape:d,filterShape:t}}function Mp(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",s=arguments.length>7?arguments[7]:void 0,u=-1,c=-1,l=-1,h=-1,f=-1;if("channelsLast"===o){var p=Ct(e,5);u=p[0],c=p[1],l=p[2],h=p[3],f=p[4]}else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat ".concat(o));var d=Ct(e,5);u=d[0],f=d[1],c=d[2],l=d[3],h=d[4]}var m,v=Ct(t,5),g=v[0],y=v[1],b=v[2],k=v[4],x=Op(n),w=Ct(x,3),_=w[0],S=w[1],C=w[2],T=Op(r),E=Ct(T,3),I=E[0],A=E[1],N=E[2],P=Fp(g,I),M=Fp(y,A),D=Fp(b,N),R=zp(a,c,l,h,_,S,C,P,M,D,s),O=R.padInfo,F=R.outDepth,L=R.outHeight,z=R.outWidth,B=i?k*f:k;return"channelsFirst"===o?m=[u,B,F,L,z]:"channelsLast"===o&&(m=[u,F,L,z,B]),{batchSize:u,dataFormat:o,inDepth:c,inHeight:l,inWidth:h,inChannels:f,outDepth:F,outHeight:L,outWidth:z,outChannels:B,padInfo:O,strideDepth:_,strideHeight:S,strideWidth:C,filterDepth:g,filterHeight:y,filterWidth:b,effectiveFilterDepth:P,effectiveFilterHeight:M,effectiveFilterWidth:D,dilationDepth:I,dilationHeight:A,dilationWidth:N,inShape:e,outShape:m,filterShape:t}}function Dp(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=Fp(t,r);return Math.floor((e[0]*(n-1)-n+a)/2)}function Rp(e){return"number"===typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function Op(e){return"number"===typeof e?[e,e,e]:e}function Fp(e,t){return t<=1?e:e+(e-1)*(t-1)}function Lp(e,t,n,r,a,i,o,s,u){var c,l,h;if("number"===typeof e){c={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};var f=function(e,t,n,r,a){null==r&&(r=Dp(e,t,n));var i=e[0],o=e[1];return[Bp((i-t+2*r)/n+1,a),Bp((o-t+2*r)/n+1,a)]}([t,n],i,r,e,s);l=f[0],h=f[1]}else if("same"===e){l=Math.ceil(t/r),h=Math.ceil(n/a);var p=Math.max(0,(l-1)*r+i-t),d=Math.max(0,(h-1)*a+o-n),m=Math.floor(p/2),v=p-m,g=Math.floor(d/2);c={top:m,bottom:v,left:g,right:d-g,type:"SAME"}}else if("valid"===e)c={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((t-i+1)/r),h=Math.ceil((n-o+1)/a);else{if("object"!==typeof e)throw Error("Unknown padding parameter: ".concat(e));var y="channelsLast"===u?e[1][0]:e[2][0],b="channelsLast"===u?e[1][1]:e[2][1],k="channelsLast"===u?e[2][0]:e[3][0],x="channelsLast"===u?e[2][1]:e[3][1];c={top:y,bottom:b,left:k,right:x,type:0===y&&0===b&&0===k&&0===x?"VALID":"EXPLICIT"},l=Bp((t-i+y+b)/r+1,s),h=Bp((n-o+k+x)/a+1,s)}return{padInfo:c,outHeight:l,outWidth:h}}function zp(e,t,n,r,a,i,o,s,u,c,l){var h,f,p,d;if("number"===typeof e){h={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};var m=function(e,t,n,r,a,i){null==a&&(a=Dp(e,t,r));var o=e[0],s=e[1],u=e[2];return[Bp((o-t+2*a)/r+1,i),Bp((s-t+2*a)/r+1,i),Bp((u-t+2*a)/r+1,i),n]}([t,n,r,1],s,1,a,e,l);f=m[0],p=m[1],d=m[2]}else if("same"===e){var v=((f=Math.ceil(t/a))-1)*a+s-t,g=((p=Math.ceil(n/i))-1)*i+u-n,y=((d=Math.ceil(r/o))-1)*o+c-r,b=Math.floor(v/2),k=v-b,x=Math.floor(g/2),w=g-x,_=Math.floor(y/2);h={top:x,bottom:w,left:_,right:y-_,front:b,back:k,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: ".concat(e));h={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},f=Math.ceil((t-s+1)/a),p=Math.ceil((n-u+1)/i),d=Math.ceil((r-c+1)/o)}return{padInfo:h,outDepth:f,outHeight:p,outWidth:d}}function Bp(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode ".concat(t))}}function Vp(e){var t=Ct(Rp(e),3),n=t[0],r=t[1],a=t[2];return 1===n&&1===r&&1===a}function jp(e,t){return Vp(e)||Vp(t)}function qp(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(e))}var Gp=wh({reshape_:function(e,t){var n={x:kh(e,"x","reshape","string_or_numeric")},r={shape:t};return fh.runKernel(Fc,n,r)}});var Wp=wh({avgPool_:function(e,t,n,r,a){var i=kh(e,"x","avgPool","float32");Ho(jp(n,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")}));var o=i,s=!1;3===i.rank&&(s=!0,o=Gp(i,[1,i.shape[0],i.shape[1],i.shape[2]])),Ho(4===o.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank ".concat(o.rank,".")})),null!=a&&Ho(Jo(r),(function(){return"Error in avgPool: pad must be an integer when using, "+"dimRoundingMode ".concat(a," but got pad ").concat(r,".")}));var u={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:a},l=fh.runKernel(Ks,u,c);return l=Af(l,i.dtype),s?Gp(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});var Up=wh({avgPool3d_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",o=arguments.length>6?arguments[6]:void 0;null==o?o=[1,1,1]:pp("dilations is deprecated, this field will be gone in v3.0.0.");var s=kh(e,"x","avgPool3d","float32"),u=s,c=!1;4===s.rank&&(c=!0,u=Gp(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),Ho(5===u.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank ".concat(u.rank,".")})),Ho("NDHWC"===i,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(i)})),Ho(jp(n,o),(function(){return"Error in avgPool3d: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(o,"'")})),null!=a&&Ho(Jo(r),(function(){return"Error in avgPool3d: pad must be an integer when using, "+"dimRoundingMode ".concat(a," but got pad ").concat(r,".")}));var l={x:u},h={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i,dilations:o},f=fh.runKernel(Ys,l,h);return f=Af(f,u.dtype),c?Gp(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}});var Hp=wh({batchToSpaceND_:function(e,t,n){var r=kh(e,"x","batchToSpaceND"),a=t.reduce((function(e,t){return e*t}));Ho(r.rank>=1+t.length,(function(){return"input rank is ".concat(r.rank," but should be > than blockShape.length ").concat(t.length)})),Ho(n.length===t.length,(function(){return"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(t.length)})),Ho(r.shape[0]%a===0,(function(){return"input tensor batch is ".concat(r.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(t.join(" * ")," === ").concat(a)}));var i={x:r},o={blockShape:t,crops:n};return fh.runKernel(Js,i,o)}});var Kp=wh({batchNorm_:function(e,t,n,r,a,i){null==i&&(i=.001);var o,s,u=kh(e,"x","batchNorm"),c=kh(t,"mean","batchNorm"),l=kh(n,"variance","batchNorm");null!=a&&(o=kh(a,"scale","batchNorm")),null!=r&&(s=kh(r,"offset","batchNorm")),Ho(c.rank===l.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),Ho(null==s||c.rank===s.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),Ho(null==o||c.rank===o.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var h=function(e){return 0===e.rank||1===e.rank?Gp(e,[1,1,1,e.size]):2===e.rank?Gp(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?Gp(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e}(u),f={x:h,scale:o,offset:s,mean:c,variance:l},p={varianceEpsilon:i},d=fh.runKernel(zu,f,p);return Gp(d,u.shape)}});var Xp=wh({batchNorm2d_:function(e,t,n,r,a,i){var o,s,u=kh(e,"x","batchNorm"),c=kh(t,"mean","batchNorm"),l=kh(n,"variance","batchNorm");return null!=a&&(o=kh(a,"scale","batchNorm")),null!=r&&(s=kh(r,"offset","batchNorm")),Ho(2===u.rank,(function(){return"Error in batchNorm2D: x must be rank 2 but got rank "+"".concat(u.rank,".")})),Ho(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(c.rank,".")})),Ho(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&Ho(2===o.rank||1===o.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&Ho(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(s.rank,".")})),Kp(u,c,l,s,o,i)}});var Yp=wh({batchNorm3d_:function(e,t,n,r,a,i){var o,s,u=kh(e,"x","batchNorm"),c=kh(t,"mean","batchNorm"),l=kh(n,"variance","batchNorm");return null!=a&&(o=kh(a,"scale","batchNorm")),null!=r&&(s=kh(r,"offset","batchNorm")),Ho(3===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(u.rank,".")})),Ho(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(c.rank,".")})),Ho(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&Ho(3===o.rank||1===o.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&Ho(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(s.rank,".")})),Kp(u,c,l,s,o,i)}});var Qp=wh({batchNorm4d_:function(e,t,n,r,a,i){var o,s,u=kh(e,"x","batchNorm"),c=kh(t,"mean","batchNorm"),l=kh(n,"variance","batchNorm");return null!=a&&(o=kh(a,"scale","batchNorm")),null!=r&&(s=kh(r,"offset","batchNorm")),Ho(4===u.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(u.rank,".")})),Ho(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(c.rank,".")})),Ho(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&Ho(4===o.rank||1===o.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&Ho(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(s.rank,".")})),Kp(u,c,l,s,o,i)}});var $p=wh({clipByValue_:function(e,t,n){var r=kh(e,"x","clipByValue");Ho(t<=n,(function(){return"Error in clip: min (".concat(t,") must be ")+"less than or equal to max (".concat(n,").")}));var a={x:r},i={clipValueMin:t,clipValueMax:n};return fh.runKernel(nu,a,i)}});var Jp=wh({concat_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Ho(e.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=xh(e,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((function(e){if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(e.dtype,". "))})),1===n.length)return Nf(n[0]);var r=n,a={axis:t};return fh.runKernel(iu,r,a)}});var Zp=wh({concat1d_:function(e){return Jp(e,0)}});var ed=wh({concat2d_:function(e,t){return Jp(e,t)}});var td=wh({concat3d_:function(e,t){return Jp(e,t)}});var nd=wh({concat4d_:function(e,t){return Jp(e,t)}});var rd=wh({conv2d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=kh(e,"x","conv2d"),u=kh(t,"filter","conv2d"),c=s,l=!1;3===s.rank&&(l=!0,c=Gp(s,[1,s.shape[0],s.shape[1],s.shape[2]])),Ho(4===c.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank ".concat(c.rank,".")})),Ho(4===u.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+"".concat(u.rank,".")})),null!=o&&Ho(Jo(r),(function(){return"Error in conv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(r,".")}));var h="NHWC"===a?c.shape[3]:c.shape[1];Ho(h===u.shape[2],(function(){return"Error in conv2d: depth of input (".concat(h,") must match ")+"input depth for filter ".concat(u.shape[2],".")})),Ho(jp(n,i),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(i,"'")}));var f={x:c,filter:u},p={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o},d=fh.runKernel(ou,f,p);return l?Gp(d,[d.shape[1],d.shape[2],d.shape[3]]):d}});var ad=wh({conv1d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6?arguments[6]:void 0,s=kh(e,"x","conv1d"),u=kh(t,"filter","conv1d"),c=s,l=!1;2===s.rank&&(l=!0,c=Gp(s,[1,s.shape[0],s.shape[1]])),Ho(3===c.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank ".concat(c.rank,".")})),Ho(3===u.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+"".concat(u.rank,".")})),null!=o&&Ho(Jo(r),(function(){return"Error in conv1d: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(r,".")})),Ho(c.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input (".concat(c.shape[2],") must match ")+"input depth for filter ".concat(u.shape[1],".")})),Ho(jp(n,i),(function(){return"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(i,"'")})),Ho("NWC"===a,(function(){return"Error in conv1d: got dataFormat of ".concat(a," but only NWC is currently supported.")}));var h=Gp(u,[1,u.shape[0],u.shape[1],u.shape[2]]),f=Gp(c,[c.shape[0],1,c.shape[1],c.shape[2]]),p=[1,n],d=[1,i],m="NHWC",v=rd(f,h,p,r,m,d,o);return Gp(v,l?[v.shape[2],v.shape[3]]:[v.shape[0],v.shape[2],v.shape[3]])}});var id=wh({conv2DBackpropInput_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0;Ho(e.length===t.rank,(function(){return"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var s=e,u=t,c=!1;3===t.rank&&(c=!0,u=Gp(t,[1,t.shape[0],t.shape[1],t.shape[2]]),s=[1,e[0],e[1],e[2]]),Ho(4===s.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(s.length,".")})),Ho(4===u.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(u.rank)})),Ho(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank)}));var l="NHWC"===i?s[3]:s[1],h="NHWC"===i?u.shape[3]:u.shape[1];Ho(l===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input (".concat(l,") must ")+"match input depth for filter ".concat(n.shape[2],".")})),Ho(h===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output (".concat(h,") must ")+"match output depth for filter ".concat(n.shape[3],".")})),null!=o&&Ho(Jo(a),(function(){return"Error in conv2dDerInput: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(a,".")}));var f={dy:u,filter:n},p={strides:r,pad:a,dataFormat:i,dimRoundingMode:o,inputShape:s},d=fh.runKernel(uu,f,p);return c?Gp(d,[d.shape[1],d.shape[2],d.shape[3]]):d}});var od=wh({conv2dTranspose_:function(e,t,n,r,a,i){var o=kh(e,"x","conv2dTranspose"),s=kh(t,"filter","conv2dTranspose");return id(n,o,s,r,a,"NHWC",i)}});var sd=wh({conv3d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1],o=kh(e,"x","conv3d"),s=kh(t,"filter","conv3d"),u=o,c=!1;4===o.rank&&(c=!0,u=Gp(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),Ho(5===u.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank ".concat(u.rank,".")})),Ho(5===s.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+"".concat(s.rank,".")})),Ho(u.shape[4]===s.shape[3],(function(){return"Error in conv3d: depth of input (".concat(u.shape[4],") must match ")+"input depth for filter ".concat(s.shape[3],".")})),Ho(jp(n,i),(function(){return"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(i,"'")})),Ho("NDHWC"===a,(function(){return"Error in conv3d: got dataFormat of ".concat(a," but only NDHWC is currently supported.")}));var l={x:u,filter:s},h={strides:n,pad:r,dataFormat:a,dilations:i},f=fh.runKernel(cu,l,h);return c?Gp(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}});var ud=wh({depthwiseConv2d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=kh(e,"x","depthwiseConv2d"),u=kh(t,"filter","depthwiseConv2d"),c=s,l=!1;3===s.rank&&(l=!0,c=Gp(s,[1,s.shape[0],s.shape[1],s.shape[2]])),Ho(4===c.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(c.rank,".")})),Ho(4===u.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(u.rank,".")})),Ho(c.shape[3]===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels "+"(".concat(c.shape[3],") must match the inChannels dimension in ")+"filter ".concat(u.shape[2],".")})),null!=o&&Ho(Jo(r),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(r,".")}));var h={x:c,filter:u},f={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o},p=fh.runKernel(yu,h,f);return l?Gp(p,[p.shape[1],p.shape[2],p.shape[3]]):p}});var cd=wh({floorDiv_:function(e,t){var n=kh(e,"a","floorDiv"),r=kh(t,"b","floorDiv"),a=Ct(ah(n,r),2),i={a:n=a[0],b:r=a[1]};return fh.runKernel(Lu,i)}});var ld=wh({div_:function(e,t){var n=kh(e,"a","div"),r=kh(t,"b","div"),a=Ct(ah(n,r),2);if(n=a[0],r=a[1],"int32"===n.dtype&&"int32"===r.dtype)return cd(n,r);var i={a:n,b:r};return fh.runKernel(Cu,i,{})}});var hd=wh({elu_:function(e){var t={x:kh(e,"x","elu")};return fh.runKernel(Tu,t)}});function fd(e,t){for(var n=e.length,r=[],a=0;a<n;a++){var i=n-1-a,o=e[i]||1;(t[t.length-1-a]||1)>1&&1===o&&r.unshift(i)}return r}function pd(e,t){for(var n=[],r=0;r<t.length;r++){var a=e[e.length-r-1],i=t.length-r-1,o=t[i];(null==a||1===a&&o>1)&&n.unshift(i)}return n}function dd(e,t){for(var n=[],r=Math.max(e.length,t.length),a=0;a<r;a++){var i=e[e.length-a-1];null==i&&(i=1);var o=t[t.length-a-1];if(null==o&&(o=1),1===i)n.unshift(o);else if(1===o)n.unshift(i);else{if(i!==o){var s="Operands could not be broadcast together with shapes "+"".concat(e," and ").concat(t,".");throw Error(s)}n.unshift(i)}}return n}var md=wh({equal_:function(e,t){var n=kh(e,"a","equal"),r=kh(t,"b","equal"),a=Ct(ah(n,r),2);n=a[0],r=a[1],dd(n.shape,r.shape);var i={a:n,b:r};return fh.runKernel(Au,i)}});var vd=wh({expandDims_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=kh(e,"x","expandDims","string_or_numeric");Ho(t<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var r={input:n},a={dim:t};return fh.runKernel(Pu,r,a)}});var gd=wh({tile_:function(e,t){var n=kh(e,"x","tile","string_or_numeric");Ho(n.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(t,".")}));var r={x:n},a={reps:t};return fh.runKernel(fl,r,a)}});var yd=wh({eye_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";null==t&&(t=e);for(var a=If([e,t],r),i=e<=t?e:t,o=0;o<i;++o)a.set(1,o,o);var s=Gp(a.toTensor(),[e,t]);if(null==n)return s;if(1===n.length)return gd(vd(s,0),[n[0],1,1]);if(2===n.length)return gd(vd(vd(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return gd(vd(vd(vd(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}});function bd(e,t,n){var r={shape:e,value:t,dtype:n};return fh.runKernel(Ru,{},r)}var kd=wh({floor_:function(e){var t={x:kh(e,"x","floor")};return fh.runKernel(Fu,t)}});var xd=wh({gather_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=kh(e,"x","gather"),i=kh(t,"indices","gather","int32"),o={x:a,indices:i},s={axis:n,batchDims:r};return fh.runKernel(Bu,o,s)}});var wd=wh({greater_:function(e,t){var n=kh(e,"a","greater"),r=kh(t,"b","greater"),a=Ct(ah(n,r),2);n=a[0],r=a[1],dd(n.shape,r.shape);var i={a:n,b:r};return fh.runKernel(ju,i)}});var _d=wh({greaterEqual_:function(e,t){var n=kh(e,"a","greaterEqual"),r=kh(t,"b","greaterEqual"),a=Ct(ah(n,r),2);n=a[0],r=a[1],dd(n.shape,r.shape);var i={a:n,b:r};return fh.runKernel(qu,i)}});var Sd=wh({leakyRelu_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,n=kh(e,"x","leakyRelu"),r={x:n},a={alpha:t};return fh.runKernel(Yu,r,a)}});var Cd=wh({log_:function(e){var t={x:kh(e,"x","log")};return fh.runKernel(Zu,t)}});var Td=wh({exp_:function(e){var t={x:kh(e,"x","exp")};return fh.runKernel(Nu,t)}});var Ed=wh({max_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=kh(e,"x","max"),a={x:r},i={reductionIndices:t,keepDims:n};return fh.runKernel(oc,a,i)}});var Id=wh({mul_:function(e,t){var n=kh(e,"a","mul"),r=kh(t,"b","mul"),a=Ct(ah(n,r),2),i={a:n=a[0],b:r=a[1]};return fh.runKernel(bc,i)}});var Ad=wh({sub_:function(e,t){var n=kh(e,"a","sub"),r=kh(t,"b","sub"),a=Ct(ah(n,r),2),i={a:n=a[0],b:r=a[1]};return fh.runKernel(sl,i)}});var Nd=wh({sum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=kh(e,"x","sum");"bool"===r.dtype&&(r=Af(r,"int32"));var a={x:r},i={axis:t,keepDims:n};return fh.runKernel(tl,a,i)}});var Pd=wh({logSoftmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=kh(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(t));var r=kp((function(e,n){var r=Ed(e,t,!0),a=Ad(e,r),i=Ad(Af(a,"float32"),Cd(Nd(Td(a),t,!0)));n([i]);return{value:i,gradFunc:function(e,n){var r=Ct(n,1)[0],a=Td(r);return Ad(e,Id(Nd(e,t,!0),a))}}}));return r(n)}});var Md=wh({logicalAnd_:function(e,t){var n=kh(e,"a","logicalAnd","bool"),r=kh(t,"b","logicalAnd","bool");dd(n.shape,r.shape);var a={a:n,b:r};return fh.runKernel(tc,a)}});var Dd=wh({logicalOr_:function(e,t){var n=kh(e,"a","logicalOr","bool"),r=kh(t,"b","logicalOr","bool");dd(n.shape,r.shape);var a={a:n,b:r};return fh.runKernel(rc,a)}});var Rd=wh({maxPool_:function(e,t,n,r,a){var i=kh(e,"x","maxPool"),o=i,s=!1;3===i.rank&&(s=!0,o=Gp(i,[1,i.shape[0],i.shape[1],i.shape[2]])),Ho(4===o.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(o.rank,".")})),Ho(jp(n,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")})),null!=a&&Ho(Jo(r),(function(){return"Error in maxPool: pad must be an integer when using, "+"dimRoundingMode ".concat(a," but got pad ").concat(r,".")}));var u={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:a},l=fh.runKernel(uc,u,c);return s?Gp(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});var Od=wh({maxPool3d_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",o=arguments.length>6?arguments[6]:void 0;null==o?o=[1,1,1]:pp("dilations is deprecated, this field will be gone in v3.0.0.");var s=kh(e,"x","maxPool3d"),u=s,c=!1;4===s.rank&&(c=!0,u=Gp(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),Ho(5===u.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank ".concat(u.rank,".")})),Ho("NDHWC"===i,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(i)})),Ho(jp(n,o),(function(){return"Error in maxPool3d: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(o,"'")})),null!=a&&Ho(Jo(r),(function(){return"Error in maxPool3d: pad must be an integer when using, "+"dimRoundingMode ".concat(a," but got pad ").concat(r,".")}));var l={x:u},h={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i,dilations:o},f=fh.runKernel(lc,l,h);return c?Gp(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}});var Fd=wh({maximum_:function(e,t){var n=kh(e,"a","maximum"),r=kh(t,"b","maximum"),a=Ct(ah(n,r),2);n=a[0],r=a[1],"bool"===n.dtype&&(n=Af(n,"int32"),r=Af(r,"int32")),dd(n.shape,r.shape);var i={a:n,b:r};return fh.runKernel(sc,i)}});var Ld=wh({mean_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=kh(e,"x","mean"),a={x:r},i={axis:t,keepDims:n};return fh.runKernel(pc,a,i)}});var zd=wh({min_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=kh(e,"x","min"),a={x:r},i={axis:t,keepDims:n};return fh.runKernel(dc,a,i)}});var Bd=wh({minimum_:function(e,t){var n=kh(e,"a","minimum"),r=kh(t,"b","minimum"),a=Ct(ah(n,r),2);n=a[0],r=a[1],"bool"===n.dtype&&(n=Af(n,"int32"),r=Af(r,"int32")),dd(n.shape,r.shape);var i={a:n,b:r};return fh.runKernel(mc,i)}});function Vd(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function jd(e,t){for(var n=[],r=e.length,a=0;a<r;a++)-1===t.indexOf(a)&&n.push(e[a]);var i=t.map((function(t){return e[t]}));return[n,i]}function qd(e,t){return function(e,t,n){for(var r=e.length+t.length,a=[],i=0,o=0,s=0;s<r;s++)-1===n.indexOf(s)?a.push(e[i++]):a.push(t[o++]);return a}(e,t.map((function(e){return 1})),t)}function Gd(e,t,n){Ho(Vd(t,n),(function(){return"".concat(e," supports only inner-most axes for now. ")+"Got axes ".concat(t," and rank-").concat(n," input.")}))}function Wd(e,t){if(Vd(e,t))return null;for(var n=[],r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((function(e){return n.push(e)})),n}function Ud(e){return e.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[0]}))}function Hd(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}var Kd=wh({square_:function(e){var t=kh(e,"x","square");return fh.runKernel("Square",{x:t},{})}});var Xd=wh({moments_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=rs(t,(e=kh(e,"x","moments")).shape),a=Ld(e,r,n),i=a.shape;n||(i=qd(a.shape,r));var o=Kd(Ad(Af(e,"float32"),Gp(a,i))),s=Ld(o,r,n);return{mean:a,variance:s}}});var Yd=wh({neg_:function(e){var t={x:kh(e,"x","neg")};return fh.runKernel(kc,t)}});var Qd=wh({notEqual_:function(e,t){var n=kh(e,"a","notEqual"),r=kh(t,"b","notEqual"),a=Ct(ah(n,r),2);n=a[0],r=a[1],dd(n.shape,r.shape);var i={a:n,b:r};return fh.runKernel(xc,i)}});var $d=wh({oneHot_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(t<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(t));var a=kh(e,"indices","oneHot","int32"),i={indices:a},o={depth:t,onValue:n,offValue:r};return fh.runKernel(Tc,i,o)}});function Jd(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===t){var n=Jd(e,"float32"),r=Jd(e,"float32");return _h(n,r)}var a=bs(Qo(e),t);return fh.makeTensor(a,e,t)}function Zd(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===t){var n=Zd(e,"float32"),r=Jd(e,"float32");return _h(n,r)}var a=ys(Qo(e),t);return fh.makeTensor(a,e,t)}var em=wh({onesLike_:function(e){var t={x:kh(e,"x","onesLike")};return fh.runKernel(Cc,t)}});var tm=wh({pad_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=kh(e,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var a={paddings:t,constantValue:n},i={x:r};return fh.runKernel(Ic,i,a)}});var nm=wh({prelu_:function(e,t){var n={x:kh(e,"x","prelu"),alpha:kh(t,"alpha","prelu")};return fh.runKernel(Nc,n)}}),rm=__webpack_require__(282),am=function(){function e(t,n,r,a,i){s(this,e),this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var o=i||Math.random();this.random=rm.alea(o.toString())}return c(e,[{key:"nextValue",value:function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,r=!1;!r;){var a=void 0,i=void 0,o=void 0;do{o=(a=2*this.random()-1)*a+(i=2*this.random()-1)*i}while(o>=1||0===o);var s=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*a*s,n=this.mean+this.stdDev*i*s,this.truncated&&!this.isValidTruncated(t)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)}},{key:"convertValue",value:function(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}},{key:"isValidTruncated",value:function(e){return e<=this.upper&&e>=this.lower}}]),e}(),im=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(s(this,e),this.canReturnFloat=function(){return null==t.dtype||"float32"===t.dtype},this.min=n,this.range=r-n,this.dtype=a,null==i&&(i=Math.random()),"number"===typeof i&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(n," - ").concat(r," <= 1 and dtype is not float"));this.random=rm.alea(i)}return c(e,[{key:"convertValue",value:function(e){return this.canReturnFloat()?e:Math.round(e)}},{key:"nextValue",value:function(){return this.convertValue(this.min+this.range*this.random())}}]),e}();var om=wh({randomNormal_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(null!=r&&"bool"===r)throw new Error("Unsupported data type ".concat(r));for(var i=new am(t,n,r,!1,a),o=If(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}});var sm=wh({randomUniform_:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",a=arguments.length>4?arguments[4]:void 0,i=If(e,r),o=new im(t,n,null,a),s=0;s<i.values.length;s++)i.values[s]=o.nextValue();return i.toTensor()}});var um=wh({relu_:function(e){var t={x:kh(e,"x","relu")};return fh.runKernel(Oc,t)}});var cm=wh({reverse_:function(e,t){var n={x:kh(e,"x","reverse")},r={dims:t};return fh.runKernel(qc,n,r)}});var lm=wh({rsqrt_:function(e){var t={x:kh(e,"x","rsqrt")};return fh.runKernel(Wc,t)}});var hm=wh({selu_:function(e){var t={x:kh(e,"x","selu")};return fh.runKernel(Kc,t)}});var fm=wh({separableConv2d_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC",s=kh(e,"x","separableConv2d"),u=kh(t,"depthwiseFilter","separableConv2d"),c=kh(n,"pointwiseFilter","separableConv2d"),l=s,h=!1;if(3===s.rank&&(h=!0,l=Gp(s,[1,s.shape[0],s.shape[1],s.shape[2]])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");Ho(4===l.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(l.rank,".")})),Ho(4===u.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(u.rank,".")})),Ho(4===c.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(u.rank,".")})),Ho(1===c.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(c.shape[0],".")})),Ho(1===c.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(c.shape[1],".")}));var f=u.shape[2],p=u.shape[3];Ho(c.shape[2]===f*p,(function(){return"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(f*p,", ")+"but got ".concat(c.shape[2],".")}));var d=ud(l,u,r,a,o,i),m=1,v=rd(d,c,m,"valid",o);return h?Gp(v,[v.shape[1],v.shape[2],v.shape[3]]):v}});var pm=wh({sigmoid_:function(e){var t={x:kh(e,"x","sigmoid")};return fh.runKernel(Jc,t)}});var dm=wh({slice_:function(e,t,n){var r=kh(e,"x","slice","string_or_numeric");if(0===r.rank)throw new Error("Slicing scalar is not possible");var a={x:r},i={begin:t,size:n};return fh.runKernel(Xc,a,i)}});var mm=wh({slice1d_:function(e,t,n){var r=kh(e,"x","slice1d");return Ho(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-".concat(r.rank," tensor")})),dm(r,[t],[n])}});var vm=wh({slice2d_:function(e,t,n){var r=kh(e,"x","slice2d");return Ho(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-".concat(r.rank," tensor")})),dm(r,t,n)}});var gm=wh({slice3d_:function(e,t,n){var r=kh(e,"x","slice3d");return Ho(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-".concat(r.rank," tensor")})),dm(r,t,n)}});var ym=wh({slice4d_:function(e,t,n){var r=kh(e,"x","slice4d");return Ho(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-".concat(r.rank," tensor")})),dm(r,t,n)}});var bm=wh({softmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=kh(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(t));var r={logits:n},a={dim:t};return fh.runKernel(al,r,a)}});var km=wh({softplus_:function(e){var t={x:kh(e,"x","softplus")};return fh.runKernel(Zc,t)}});var xm=wh({split_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=kh(e,"x","split"),a={x:r},i={numOrSizeSplits:t,axis:n};return fh.runKernel(rl,a,i)}});var wm=wh({sqrt_:function(e){var t={x:kh(e,"x","sqrt")};return fh.runKernel(el,t)}});var _m=wh({squeeze_:function(e,t){var n=kh(e,"x","squeeze");return Gp(n,as(n.shape,t).newShape)}});var Sm=wh({stack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=xh(e,"tensors","stack","string_or_numeric");Ho(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),n.length>0&&Ho(t<=n[0].rank,(function(){return"Axis must be <= rank of the tensor"}));var r=n,a={axis:t};return fh.runKernel(Ec,r,a)}});var Cm=wh({tanh_:function(e){var t={x:kh(e,"x","tanh")};return fh.runKernel(hl,t)}});function Tm(e,t){Xo(e);var n=gh(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Sh(e,null,n,t)}function Em(e,t,n){if(Xo(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");var r=gh(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Sh(e,t,r,n)}var Im=wh({truncatedNormal_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");for(var i=new am(t,n,r,!0,a),o=If(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}});var Am=wh({unstack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=kh(e,"x","unstack","string_or_numeric");Ho(t>=-n.shape.length&&t<n.shape.length,(function(){return"Axis = ".concat(t," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")")}));var r={value:n},a={axis:t};return fh.runKernel(vl,r,a)}});function Nm(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return fh.makeVariable(e,t,n,r)}var Pm=wh({broadcastTo_:function(e,t){var n=kh(e,"broadcastTo","x"),r=n.shape;if(t.some((function(e){return!(e>0)||e%1!==0})))throw new Error("broadcastTo(): Invalid broadcast shape [".concat(t,"]."));if(t.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(t.length," < input.rank=").concat(n.rank,"."));if(t.length>n.rank){for(var a=n.shape.slice();a.length<t.length;)a.unshift(1);n=Gp(n,a)}for(var i=n.shape,o=Array.from(t),s=t.length-1;s>=0;s--)if(i[s]===t[s])o[s]=1;else if(1!==n.shape[s])throw new Error("broadcastTo(): [".concat(r,"] cannot be broadcast to [").concat(t,"]."));var u=o.map((function(e,t){return e>1?t:-1})).filter((function(e){return e>=0}));if(0===u.length)return Nf(n);var c={x:n},l={reps:o};return fh.runKernel(fl,c,l)}});var Mm=wh({where_:function(e,t,n){var r=kh(t,"a","where"),a=kh(n,"b","where"),i=kh(e,"condition","where","bool"),o=dd(r.shape,a.shape),s=Pm(r,o),u=Pm(a,o);1===i.rank&&Ho(i.shape[0]===r.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})),1!==i.rank&&Ko(i.shape,u.shape,"Error in where: ");var c={condition:i,t:s,e:u};return fh.runKernel(Hc,c)}});var Dm=wh({zerosLike_:function(e){var t={x:kh(e,"x","zerosLike")};return fh.runKernel(yl,t)}});var Rm=wh({transpose_:function(e,t){var n=kh(e,"x","transpose");if(null==t&&(t=n.shape.map((function(e,t){return t})).reverse()),Ho(n.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of perm ".concat(t,".")})),t.forEach((function(e){Ho(e>=0&&e<n.rank,(function(){return"All entries in 'perm' must be between 0 and ".concat(n.rank-1)+" but got ".concat(t)}))})),n.rank<=1)return n.clone();var r={x:n},a={perm:t};return fh.runKernel(dl,r,a)}});var Om=wh({dropout_:function(e,t,n,r){var a=kh(e,"x","dropout");if(Ho("float32"===a.dtype,(function(){return"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(a.dtype," tensor instead.")})),Ho(t>=0&&t<1,(function(){return"rate must be a float in the range [0, 1), but got ".concat(t,".")})),0===t)return e instanceof Xl?a.clone():a;var i=function(e,t){if(null==t)return e.shape.slice();if($o(e.shape,t))return t;if(e.shape.length===t.length){for(var n=[],r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(a,n),o=1-t,s=ld(kd(Sp(sm(i,0,1,"float32",r),o)),o);return Id(a,s)}});var Fm=wh({imag_:function(e){var t={input:kh(e,"input","imag")};return fh.runKernel(Uu,t)}});var Lm=wh({real_:function(e){var t={input:kh(e,"input","real")};return fh.runKernel(Dc,t)}});var zm=wh({fft_:function(e){Ho("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(e.dtype,".")}));var t={input:e};return fh.runKernel(Du,t)}});var Bm=wh({rfft_:function(e,t){Ho("float32"===e.dtype,(function(){return"The dtype for rfft() must be real value but got ".concat(e.dtype)}));var n,r=e.shape[e.shape.length-1],a=e.size/r;if(null!=t&&t<r){var i=e.shape.map((function(e){return 0})),o=e.shape.map((function(e){return e}));o[e.shape.length-1]=t,n=dm(e,i,o),r=t}else if(null!=t&&t>r){var s=e.shape.map((function(e){return e}));s[e.shape.length-1]=t-r,n=Jp([e,Jd(s)],e.shape.length-1),r=t}else n=e;var u=Dm(n),c=Gp(_h(n,u),[a,r]),l=zm(c),h=Math.floor(r/2)+1,f=Lm(l),p=Fm(l),d=xm(f,[h,r-h],f.shape.length-1),m=xm(p,[h,r-h],p.shape.length-1),v=n.shape.slice();return v[n.shape.length-1]=h,Gp(_h(d[0],m[0]),v)}});var Vm=wh({ifft_:function(e){Ho("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(e.dtype,".")}));var t={input:e};return fh.runKernel(Wu,t)}});var jm=wh({irfft_:function(e){var t,n=e.shape[e.shape.length-1],r=e.size/n;if(n<=2){var a=Gp(e,[r,n]);t=Vm(a)}else{var i=[r,2*(n-1)],o=Gp(Lm(e),[r,n]),s=Gp(Fm(e),[r,n]),u=cm(dm(o,[0,1],[r,n-2]),1),c=Id(cm(dm(s,[0,1],[r,n-2]),1),xp(-1)),l=Jp([o,u],1),h=Jp([s,c],1),f=Gp(_h(l,h),[i[0],i[1]]);t=Vm(f)}if(t=Lm(t),3===e.rank&&0!==e.shape[0]){var p=t,d=e.shape[0];t=Gp(t,[d,t.shape[0]/d,t.shape[1]]),p.dispose()}return t}});var qm=wh({conv2DBackpropFilter_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0,s=e;3===e.rank&&(s=Gp(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var u=t;3===u.rank&&(u=Gp(t,[1,t.shape[0],t.shape[1],t.shape[2]])),Ho(4===s.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(s.shape,".")})),Ho(4===u.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(u.shape,".")})),Ho(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,".")}));var c="NHWC"===i?s.shape[3]:s.shape[1],l="NHWC"===i?u.shape[3]:u.shape[1];Ho(c===n[2],(function(){return"Error in conv2dDerFilter: depth of input ".concat(c,") must ")+"match input depth in filter (".concat(n[2],".")})),Ho(l===n[3],(function(){return"Error in conv2dDerFilter: depth of dy (".concat(l,") must ")+"match output depth for filter (".concat(n[3],").")})),null!=o&&Ho(Jo(a),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(a,".")}));var h={x:s,dy:u},f={strides:r,pad:a,dataFormat:i,dimRoundingMode:o,filterShape:n};return fh.runKernel(su,h,f)}});var Gm=wh({relu6_:function(e){var t={x:kh(e,"x","relu6")};return fh.runKernel(jc,t)}});var Wm=wh({step_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=kh(e,"x","step"),r={x:n},a={alpha:t};return fh.runKernel(bl,r,a)}});function Um(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return Id(e,Wm(t));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function Hm(e,t){var n=t,r=pd(e.shape,t.shape);return r.length>0&&(n=Nd(n,r)),Gp(n,e.shape)}function Km(e,t,n,r){if("linear"===t)return e;if("relu"===t)return um(e);if("elu"===t)return hd(e);if("relu6"===t)return Gm(e);if("prelu"===t)return nm(e,n);if("leakyrelu"===t)return Sd(e,r);throw new Error("Unknown fused activation ".concat(t,"."))}var Xm=function(e,t){return!(e>0)||"linear"===t};var Ym=wh({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,i=e.dataFormat,o=void 0===i?"NHWC":i,s=e.dilations,u=void 0===s?[1,1]:s,c=e.dimRoundingMode,l=e.bias,h=e.activation,f=void 0===h?"linear":h,p=e.preluActivationWeights,d=e.leakyreluAlpha;if(f=f||"linear",!1===Xm(fh.state.gradientDepth,f)){var m=rd(t,n,r,a,o,u,c);return null!=l&&(m=Sp(m,l)),Km(m,f,p,d)}var v=kh(t,"x","conv2d"),g=kh(n,"filter","conv2d"),y=v,b=!1;3===v.rank&&(b=!0,y=Gp(v,[1,v.shape[0],v.shape[1],v.shape[2]])),Ho(4===y.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(y.rank,".")})),Ho(4===g.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(g.rank,".")})),null!=c&&Ho(Jo(a),(function(){return"Error in fused conv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(c," but got pad ").concat(a,".")})),Ho(y.shape[3]===g.shape[2],(function(){return"Error in conv2d: depth of input (".concat(y.shape[3],") must match ")+"input depth for filter ".concat(g.shape[2],".")})),Ho(jp(r,u),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(r," and dilations '").concat(u,"'")})),Ho("NHWC"===o,(function(){return"Error in conv2d: got dataFormat of ".concat(o," but only NHWC is currently supported.")}));var k,x,w=Pp(y.shape,g.shape,r,u,a,c);null!=l&&(k=Ct(ah(k=kh(l,"bias","fused conv2d"),v),1)[0],dd(w.outShape,k.shape)),null!=p&&(x=kh(p,"prelu weights","fused conv2d"));var _=function(e,t){var n=Ct(t,4),i=n[0],o=n[1],s=n[2],c=n[3],l=Um(e,s,f);Ho(Vp(u),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(u,"'")}));var h=[id(o.shape,l,i,r,a),qm(o,l,i.shape,r,a)];if(null!=c){var p=Hm(c,l);h.push(p)}return h},S={x:y,filter:g,bias:k,preluActivationWeights:x},C={strides:r,pad:a,dataFormat:o,dilations:u,dimRoundingMode:c,activation:f,leakyreluAlpha:d};if(null==l){var T=kp((function(e,t,n){var r=fh.runKernel(wl,S,C);return n([t,e,r]),b&&(r=Gp(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:_}}));return T(y,g)}var E=kp((function(e,t,n,r){var a=fh.runKernel(wl,S,C);return r([t,e,a,n]),b&&(a=Gp(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:_}}));return E(y,g,k)}});var Qm=wh({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=e;3===e.rank&&(s=Gp(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var u=t;3===u.rank&&(u=Gp(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var c={x:s,dy:u},l={strides:r,pad:a,dimRoundingMode:o,dilations:i,filterShape:n};return fh.runKernel(bu,c,l)}});var $m=wh({depthwiseConv2dNativeBackpropInput_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=t,u=!1;3===t.rank&&(u=!0,s=Gp(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var c={dy:s,filter:n},l={strides:r,pad:a,dimRoundingMode:o,dilations:i,inputShape:e},h=fh.runKernel(ku,c,l);return u?Gp(h,[h.shape[1],h.shape[2],h.shape[3]]):h}});wh({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,i=e.dataFormat,o=void 0===i?"NHWC":i,s=e.dilations,u=void 0===s?[1,1]:s,c=e.dimRoundingMode,l=e.bias,h=e.activation,f=void 0===h?"linear":h,p=e.preluActivationWeights,d=e.leakyreluAlpha;if(!1===Xm(fh.state.gradientDepth,f)){var m=ud(t,n,r,a,o,u,c);return null!=l&&(m=Sp(m,l)),Km(m,f,p,d)}var v=kh(t,"x","depthwiseConv2d"),g=kh(n,"filter","depthwiseConv2d"),y=v,b=!1;3===v.rank&&(b=!0,y=Gp(v,[1,v.shape[0],v.shape[1],v.shape[2]])),Ho(4===y.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(y.rank,".")})),Ho(4===g.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, "+"but got rank ".concat(g.rank,".")})),Ho(y.shape[3]===g.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels "+"(".concat(y.shape[3],") must match the inChannels dimension in ")+"filter ".concat(g.shape[2],".")})),null==u&&(u=[1,1]),Ho(jp(r,u),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must "+"be 1. Got strides ".concat(r," and dilations '").concat(u,"'")})),null!=c&&Ho(Jo(a),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when "+"using dimRoundingMode ".concat(c," but got pad ").concat(a,".")}));var k,x,w=Pp(y.shape,g.shape,r,u,a,c,!0);if(null!=l){var _=Ct(ah(k=kh(l,"bias","fused conv2d"),v),1);k=_[0],dd(w.outShape,k.shape)}null!=p&&(x=kh(p,"prelu weights","fused depthwiseConv2d"));var S=function(e,t){Ho(Vp(u),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(u,"'")}));var n=Ct(t,4),i=n[0],o=n[1],s=n[2],l=n[3],h=Um(e,s,f),p=$m(o.shape,h,i,r,a,u,c),d=Qm(o,h,i.shape,r,a,u,c);return null!=l?[p,d,Hm(k,h)]:[p,d]},C={x:y,filter:g,bias:k,preluActivationWeights:x},T={strides:r,pad:a,dataFormat:o,dilations:u,dimRoundingMode:c,activation:f,leakyreluAlpha:d};if(null==l){var E=kp((function(e,t,n){var r=fh.runKernel(_l,C,T);return n([t,e,r]),b&&(r=Gp(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:S}}));return E(y,g)}var I=kp((function(e,t,n,r){var a=fh.runKernel(_l,C,T);return r([t,e,a,n]),b&&(a=Gp(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:S}}));return I(y,g,k)}});var Jm=wh({matMul_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=kh(e,"a","matMul"),i=kh(t,"b","matMul"),o=ah(a,i),s=Ct(o,2),u={a:a=s[0],b:i=s[1]},c={transposeA:n,transposeB:r};return fh.runKernel($s,u,c)}});var Zm=wh({fusedMatMul_:function(e){var t=e.a,n=e.b,r=e.transposeA,a=void 0!==r&&r,i=e.transposeB,o=void 0!==i&&i,s=e.bias,u=e.activation,c=void 0===u?"linear":u,l=e.preluActivationWeights,h=e.leakyreluAlpha;if(!1===Xm(fh.state.gradientDepth,c)){var f=Jm(t,n,a,o);return null!=s&&(f=Sp(f,s)),Km(f,c,l,h)}var p=kh(t,"a","fused matMul"),d=kh(n,"b","fused matMul"),m=Ct(ah(p,d),2);p=m[0],d=m[1];var v=a?p.shape[p.rank-2]:p.shape[p.rank-1],g=o?d.shape[d.rank-1]:d.shape[d.rank-2],y=a?p.shape[p.rank-1]:p.shape[p.rank-2],b=o?d.shape[d.rank-2]:d.shape[d.rank-1],k=p.shape.slice(0,-2),x=d.shape.slice(0,-2),w=Qo(k),_=Qo(x);Ho(p.rank>=2&&d.rank>=2&&p.rank===d.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at "+"least 2, got ranks ".concat(p.rank," and ").concat(d.rank,".")})),Ho($o(k,x),(function(){return"Error in fused matMul: outer dimensions (".concat(k,") and (")+"".concat(x,") of Tensors with shapes ").concat(p.shape," and ")+"".concat(d.shape," must match.")})),Ho(v===g,(function(){return"Error in fused matMul: inner shapes (".concat(v,") and (")+"".concat(g,") of Tensors with shapes ").concat(p.shape," and ")+"".concat(d.shape," and transposeA=").concat(a)+" and transposeB=".concat(o," must match.")}));var S,C,T=p.shape.slice(0,-2).concat([y,b]),E=Gp(p,a?[w,v,y]:[w,y,v]),I=Gp(d,o?[_,b,g]:[_,g,b]);null!=s&&(S=Ct(ah(S=kh(s,"bias","fused matMul"),p),1)[0],dd(T,S.shape)),null!=l&&(C=kh(l,"prelu weights","fused matMul"));var A=function(e,t){var n,r,i=Ct(t,4),u=i[0],l=i[1],h=i[2],f=i[3],p=Um(Gp(e,h.shape),h,c);return a||o?!a&&o?(n=Jm(p,l,!1,!1),r=Jm(p,u,!0,!1)):a&&!o?(n=Jm(l,p,!1,!0),r=Jm(u,p,!1,!1)):(n=Jm(l,p,!0,!0),r=Jm(p,u,!0,!0)):(n=Jm(p,l,!1,!0),r=Jm(u,p,!0,!1)),null!=s?[n,r,Hm(f,p)]:[n,r]},N={a:E,b:I,bias:S,preluActivationWeights:C},P={transposeA:a,transposeB:o,activation:c,leakyreluAlpha:h};if(null==s){var M=kp((function(e,t,n){var r=fh.runKernel(xl,N,P);return n([e,t,r]),{value:Gp(r,T),gradFunc:A}}));return M(E,I)}var D=kp((function(e,t,n,r){var a=fh.runKernel(xl,N,P);return r([e,t,a,n]),{value:Gp(a,T),gradFunc:A}}));return D(E,I,S)}});function ev(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function tv(e,t,n){for(var r=1-e%2,a=new Float32Array(e),i=0;i<e;++i){var o=2*Math.PI*i/(e+r-1);a[i]=t-n*Math.cos(o)}return Tm(a,"float32")}wh({hammingWindow_:function(e){return tv(e,.54,.46)}});var nv=wh({hannWindow_:function(e){return tv(e,.5,.5)}});var rv=wh({frame_:function(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=0,o=[];i+t<=e.size;)o.push(dm(e,i,t)),i+=n;if(r)for(;i<e.size;){var s=i+t-e.size,u=Jp([dm(e,i,t-s),bd([s],a)]);o.push(u),i+=n}return 0===o.length?Em([],[0,t]):Gp(Jp(o),[o.length,t])}});wh({stft_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:nv;null==r&&(r=ev(t));for(var i=rv(e,t,n),o=Id(i,a(t)),s=[],u=0;u<i.shape[0];u++)s.push(Bm(dm(o,[u,0],[1,t]),r));return Jp(s)}});wh({cropAndResize_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=kh(e,"image","cropAndResize"),s=kh(t,"boxes","cropAndResize","float32"),u=kh(n,"boxInd","cropAndResize","int32"),c=s.shape[0];Ho(4===o.rank,(function(){return"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(o.rank,".")})),Ho(2===s.rank&&4===s.shape[1],(function(){return"Error in cropAndResize: boxes must be have size [".concat(c,",4] ")+"but had shape ".concat(s.shape,".")})),Ho(1===u.rank&&u.shape[0]===c,(function(){return"Error in cropAndResize: boxInd must be have size [".concat(c,"] ")+"but had shape ".concat(s.shape,".")})),Ho(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(r.length,".")})),Ho(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was ".concat(r)})),Ho("bilinear"===a||"nearest"===a,(function(){return"method must be bilinear or nearest, but was ".concat(a)}));var l={image:o,boxes:s,boxInd:u},h={method:a,extrapolationValue:i,cropSize:r},f=fh.runKernel(mu,l,h);return f}});wh({flipLeftRight_:function(e){var t=kh(e,"image","flipLeftRight","float32");Ho(4===t.rank,(function(){return"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(t.rank,".")}));var n={image:t};return fh.runKernel(Ou,n,{})}});wh({rotateWithOffset_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=kh(e,"image","rotateWithOffset","float32");Ho(4===a.rank,(function(){return"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(a.rank,".")}));var i={image:a},o={radians:t,fillValue:n,center:r},s=fh.runKernel(kl,i,o);return s}});function av(e,t,n,r,a,i){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==i&&(i=0);var o=e.shape[0];return n=Math.min(n,o),Ho(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '".concat(r,"'")})),Ho(2===e.rank,(function(){return"boxes must be a 2D tensor, but was of rank '".concat(e.rank,"'")})),Ho(4===e.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was ".concat(e.shape[1])})),Ho(1===t.rank,(function(){return"scores must be a 1D tensor"})),Ho(t.shape[0]===o,(function(){return"scores has incompatible shape with boxes. Expected ".concat(o,", ")+"but was ".concat(t.shape[0])})),Ho(0<=i&&i<=1,(function(){return"softNmsSigma must be in [0, 1], but was '".concat(i,"'")})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}wh({nonMaxSuppression_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=kh(e,"boxes","nonMaxSuppression"),o=kh(t,"scores","nonMaxSuppression"),s=av(i,o,n,r,a),u={maxOutputSize:n=s.maxOutputSize,iouThreshold:r=s.iouThreshold,scoreThreshold:a=s.scoreThreshold};return fh.runKernel(wc,{boxes:i,scores:o},u)}});function iv(e,t,n){var r=function(e,t,n){return function(e,t,n){var r=0,a=e.length,i=0,o=!1;for(;r<a;){var s=n(t,e[i=r+(a-r>>>1)]);s>0?r=i+1:(a=i,o=!s)}return o?r:-r-1}(e,t,n||ov)}(e,t,n),a=r<0?-(r+1):r;e.splice(a,0,t)}function ov(e,t){return e>t?1:e<t?-1:0}function sv(e,t,n,r,a){return lv(e,t,n,r,a,0)}function uv(e,t,n,r,a,i){return lv(e,t,n,r,a,0,!1,i,!0)}function cv(e,t,n,r,a,i){return lv(e,t,n,r,a,i,!0)}function lv(e,t,n,r,a,i){for(var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=arguments.length>8&&void 0!==arguments[8]&&arguments[8],c=[],l=0;l<t.length;l++)t[l]>a&&c.push({score:t[l],boxIndex:l,suppressBeginIndex:0});c.sort(pv);for(var h=i>0?-.5/i:0,f=[],p=[];f.length<n&&c.length>0;){var d=c.pop(),m=d.score,v=d.boxIndex,g=d.suppressBeginIndex;if(m<a)break;for(var y=!1,b=f.length-1;b>=g;--b){var k=hv(e,v,f[b]);if(k>=r){y=!0;break}if(d.score=d.score*fv(r,h,k),d.score<=a)break}d.suppressBeginIndex=f.length,y||(d.score===m?(f.push(v),p.push(d.score)):d.score>a&&iv(c,d,pv))}var x=f.length,w=n-x;s&&w>0&&(f.push.apply(f,Fn(new Array(w).fill(0))),p.push.apply(p,Fn(new Array(w).fill(0))));var _={selectedIndices:f};return o&&(_.selectedScores=p),u&&(_.validOutputs=x),_}function hv(e,t,n){var r=e.subarray(4*t,4*t+4),a=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(a[0],a[2]),l=Math.min(a[1],a[3]),h=Math.max(a[0],a[2]),f=Math.max(a[1],a[3]),p=(s-i)*(u-o),d=(h-c)*(f-l);if(p<=0||d<=0)return 0;var m=Math.max(i,c),v=Math.max(o,l),g=Math.min(s,h),y=Math.min(u,f),b=Math.max(g-m,0)*Math.max(y-v,0);return b/(p+d-b)}function fv(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function pv(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}wh({nonMaxSuppressionWithScore_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=kh(e,"boxes","nonMaxSuppression"),s=kh(t,"scores","nonMaxSuppression"),u=av(o,s,n,r,a,i),c={boxes:o,scores:s},l={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:a=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma},h=fh.runKernel(Sc,c,l);return{selectedIndices:h[0],selectedScores:h[1]}}});wh({nonMaxSuppressionPadded_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=kh(e,"boxes","nonMaxSuppression"),s=kh(t,"scores","nonMaxSuppression"),u=av(o,s,n,r,a,null),c=u.maxOutputSize,l=u.iouThreshold,h=u.scoreThreshold,f={boxes:o,scores:s},p={maxOutputSize:c,iouThreshold:l,scoreThreshold:h,padToMaxOutputSize:i},d=fh.runKernel(_c,f,p);return{selectedIndices:d[0],validOutputs:d[1]}}});function dv(e){return xt(e)||On(e)||_t(e)||St()}var mv=wh({resizeBilinear_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=kh(e,"images","resizeBilinear");Ho(3===a.rank||4===a.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,".")})),Ho(2===t.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(t,".")})),Ho(!1===r||!1===n,(function(){return"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."}));var i=a,o=!1;3===a.rank&&(o=!0,i=Gp(a,[1,a.shape[0],a.shape[1],a.shape[2]])),dv(t);var s={images:i},u={alignCorners:n,halfPixelCenters:r,size:t},c=fh.runKernel(Bc,s,u);return o?Gp(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});var vv=wh({resizeNearestNeighbor_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=kh(e,"images","resizeNearestNeighbor");Ho(3===a.rank||4===a.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,".")})),Ho(2===t.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(t,".")})),Ho("float32"===a.dtype||"int32"===a.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"})),Ho(!1===r||!1===n,(function(){return"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."}));var i=a,o=!1;3===a.rank&&(o=!0,i=Gp(a,[1,a.shape[0],a.shape[1],a.shape[2]])),dv(t);var s={images:i},u={alignCorners:n,halfPixelCenters:r,size:t},c=fh.runKernel(Lc,s,u);return o?Gp(c,[c.shape[1],c.shape[2],c.shape[3]]):c}});var gv=wh({lessEqual_:function(e,t){var n=kh(e,"a","lessEqual"),r=kh(t,"b","lessEqual"),a=Ct(ah(n,r),2);n=a[0],r=a[1],dd(n.shape,r.shape);var i={a:n,b:r};return fh.runKernel($u,i)}});function yv(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");var a={start:e,stop:t,step:n,dtype:r};return fh.runKernel(Mc,{},a)}var bv=wh({bandPart_:function(e,t,n){Ho(t%1===0,(function(){return"bandPart(): numLower must be an integer, got ".concat(t,".")})),Ho(n%1===0,(function(){return"bandPart(): numUpper must be an integer, got ".concat(n,".")}));var r=kh(e,"a","bandPart");Ho(r.rank>=2,(function(){return"bandPart(): Rank must be at least 2, got ".concat(r.rank,".")}));var a=r.shape,i=Ct(r.shape.slice(-2),2),o=i[0],s=i[1];if(!(t<=o))throw new Error("bandPart(): numLower (".concat(t,")")+" must not be greater than the number of rows (".concat(o,")."));if(!(n<=s))throw new Error("bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(s,")."));t<0&&(t=o),n<0&&(n=s);var u=Gp(yv(0,o,1,"int32"),[-1,1]),c=yv(0,s,1,"int32"),l=Ad(u,c),h=Md(gv(l,xp(+t,"int32")),_d(l,xp(-n,"int32"))),f=Jd([o,s],r.dtype);return Gp(Sm(Am(Gp(r,[-1,o,s])).map((function(e){return Mm(h,e,f)}))),a)}});var kv=wh({pow_:function(e,t){var n=kh(e,"base","pow"),r=kh(t,"exp","pow"),a=Ct(ah(n,r),2),i={a:n=a[0],b:r=a[1]};return fh.runKernel(Ac,i)}});function xv(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===e.rank)return _p(e);if(1!==e.rank&&null===n)return xv(Gp(e,[-1]),t,n);if(1===e.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===t)return Nd(_p(e),n);if(t===1/0)return Ed(_p(e),n);if(t===-1/0)return zd(_p(e),n);if("euclidean"===t||2===t)return wm(Nd(kv(_p(e),xp(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}if(Array.isArray(n)&&2===n.length){if(1===t)return Ed(Nd(_p(e),n[0]),n[1]-1);if(t===1/0)return Ed(Nd(_p(e),n[1]),n[0]);if(t===-1/0)return zd(Nd(_p(e),n[1]),n[0]);if("fro"===t||"euclidean"===t)return wm(Nd(Kd(e),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}throw new Error("Error in norm: invalid axis: ".concat(n))}var wv=wh({norm_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=xv(e=kh(e,"x","norm"),t,n),i=a.shape;if(r){var o=rs(n,e.shape);i=qd(a.shape,o)}return Gp(a,i)}});var _v=wh({gramSchmidt_:function(e){var t;Array.isArray(e)?function(){t=!1,Ho(null!=e&&e.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=e[0].shape[0],r=function(t){Ho(e[t].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(e[t].shape[0]," vs. ").concat(n,")")}))},a=1;a<e.length;++a)r(a)}():(t=!0,e=xm(e,e.shape[0],0).map((function(e){return _m(e,[0])}))),Ho(e.length<=e[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors (".concat(e.length,") exceeds ")+"number of dimensions (".concat(e[0].shape[0],").")}));for(var n=[],r=e,a=function(e){n.push(fh.tidy((function(){var t=r[e];if(e>0)for(var a=0;a<e;++a){var i=Id(Nd(Id(n[a],t)),n[a]);t=Ad(t,i)}return ld(t,wv(t,"euclidean"))})))},i=0;i<e.length;++i)a(i);return t?Sm(n,0):n}});function Sv(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return fh.tidy((function(){Ho(2===e.shape.length,(function(){return"qr2d() requires a 2D Tensor, but got a ".concat(e.shape.length,"D Tensor.")}));for(var n=e.shape[0],r=e.shape[1],a=yd(n),i=Nf(e),o=Em([[1]],[1,1]),s=Nf(o),u=n>=r?r:n,c=function(e){var t=i,u=s,c=a,l=Ct(fh.tidy((function(){var t=dm(i,[e,e],[n-e,1]),u=wv(t),c=dm(i,[e,e],[1,1]),l=Mm(wd(c,0),Em([[-1]]),Em([[1]])),h=Ad(c,Id(l,u)),f=ld(t,h);s=1===f.shape[0]?Nf(o):Jp([o,dm(f,[1,0],[f.shape[0]-1,f.shape[1]])],0);var p=Yd(ld(Jm(l,h),u)),d=dm(i,[e,0],[n-e,r]),m=Id(p,s),v=Rm(s);if(0===e)i=Ad(d,Jm(m,Jm(v,d)));else{var g=Ad(d,Jm(m,Jm(v,d)));i=Jp([dm(i,[0,0],[e,r]),g],0)}var y=Rm(m),b=dm(a,[0,e],[n,a.shape[1]-e]);if(0===e)a=Ad(b,Jm(Jm(b,s),y));else{var k=Ad(b,Jm(Jm(b,s),y));a=Jp([dm(a,[0,0],[n,e]),k],1)}return[s,i,a]})),3);s=l[0],i=l[1],a=l[2],gp([t,u,c])},l=0;l<u;++l)c(l);return!t&&n>r&&(a=dm(a,[0,0],[n,r]),i=dm(i,[0,0],[r,r])),[a,i]}))}var Cv,Tv=wh({qr_:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Ho(e.rank>=2,(function(){return"qr() requires input tensor to have a rank >= 2, but got rank ".concat(e.rank)})),2===e.rank)return Sv(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce((function(e,t){return e*t})),r=Am(Gp(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],i=[];r.forEach((function(e){var n=Ct(Sv(e,t),2),r=n[0],o=n[1];a.push(r),i.push(o)}));var o=Gp(Sm(a,0),e.shape),s=Gp(Sm(i,0),e.shape);return[o,s]}});!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(Cv||(Cv={}));var Ev=wh({computeWeightedLoss_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Cv.SUM_BY_NONZERO_WEIGHTS,r=kh(e,"losses","computeWeightedLoss"),a=null;null!=t&&(a=kh(t,"weights","computeWeightedLoss"));var i=null==a?r:Id(r,a);if(n===Cv.NONE)return i;if(n===Cv.SUM)return Nd(i);if(n===Cv.MEAN){if(null==a)return Ld(i);var o=r.size/a.size,s=ld(Nd(i),Nd(a));return o>1?ld(s,xp(o)):s}if(n===Cv.SUM_BY_NONZERO_WEIGHTS){if(null==a)return ld(Nd(i),xp(r.size));var u=Id(a,Zd(r.shape)),c=Af(Nd(Qd(u,xp(0))),"float32");return ld(Nd(i),c)}throw Error("Unknown reduction: ".concat(n))}});wh({absoluteDifference_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Cv.SUM_BY_NONZERO_WEIGHTS,a=kh(e,"labels","absoluteDifference"),i=kh(t,"predictions","absoluteDifference"),o=null;null!=n&&(o=kh(n,"weights","absoluteDifference")),Ko(a.shape,i.shape,"Error in absoluteDifference: ");var s=_p(Ad(a,i));return Ev(s,o,r)}});wh({cosineDistance_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Cv.SUM_BY_NONZERO_WEIGHTS,i=kh(e,"labels","cosineDistance"),o=kh(t,"predictions","cosineDistance"),s=null;null!=r&&(s=kh(r,"weights","cosineDistance")),Ko(i.shape,o.shape,"Error in cosineDistance: ");var u=xp(1),c=Ad(u,Nd(Id(i,o),n,!0));return Ev(c,s,a)}});wh({hingeLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Cv.SUM_BY_NONZERO_WEIGHTS,a=kh(e,"labels","hingeLoss"),i=kh(t,"predictions","hingeLoss"),o=null;null!=n&&(o=kh(n,"weights","hingeLoss")),Ko(a.shape,i.shape,"Error in hingeLoss: ");var s=xp(1);a=Ad(Id(xp(2),a),s);var u=um(Ad(s,Id(a,i)));return Ev(u,o,r)}});wh({huberLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Cv.SUM_BY_NONZERO_WEIGHTS,i=kh(e,"labels","huberLoss"),o=kh(t,"predictions","huberLoss"),s=null;null!=n&&(s=kh(n,"weights","huberLoss")),Ko(i.shape,o.shape,"Error in huberLoss: ");var u=xp(r),c=_p(Ad(o,i)),l=Bd(c,u),h=Ad(c,l),f=Sp(Id(xp(.5),Kd(l)),Id(u,h));return Ev(f,s,a)}});wh({logLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Cv.SUM_BY_NONZERO_WEIGHTS,i=kh(e,"labels","logLoss"),o=kh(t,"predictions","logLoss"),s=null;null!=n&&(s=kh(n,"weights","logLoss")),Ko(i.shape,o.shape,"Error in logLoss: ");var u=xp(1),c=xp(r),l=Yd(Id(i,Cd(Sp(o,c)))),h=Id(Ad(u,i),Cd(Sp(Ad(u,o),c))),f=Ad(l,h);return Ev(f,s,a)}});var Iv=wh({squaredDifference_:function(e,t){var n=kh(e,"a","squaredDifference"),r=kh(t,"b","squaredDifference"),a=Ct(ah(n,r),2);n=a[0],r=a[1],dd(n.shape,r.shape);var i={a:n,b:r};return fh.runKernel(il,i,{})}});wh({meanSquaredError_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Cv.SUM_BY_NONZERO_WEIGHTS,a=kh(e,"labels","meanSquaredError"),i=kh(t,"predictions","meanSquaredError"),o=null;null!=n&&(o=kh(n,"weights","meanSquaredError")),Ko(a.shape,i.shape,"Error in meanSquaredError: ");var s=Iv(a,i);return Ev(s,o,r)}});var Av=wh({log1p_:function(e){var t={x:kh(e,"x","log1p")};return fh.runKernel(ec,t)}});function Nv(e,t){var n=kh(e,"labels","sigmoidCrossEntropyWithLogits"),r=kh(t,"logits","sigmoidCrossEntropyWithLogits");Ko(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var a=um(r),i=Id(r,n),o=Av(Td(Yd(_p(r))));return Sp(Ad(a,i),o)}wh({sigmoidCrossEntropy_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Cv.SUM_BY_NONZERO_WEIGHTS,i=kh(e,"multiClassLabels","sigmoidCrossEntropy"),o=kh(t,"logits","sigmoidCrossEntropy"),s=null;if(null!=n&&(s=kh(n,"weights","sigmoidCrossEntropy")),Ko(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=xp(r),c=xp(1),l=xp(.5);i=Sp(Id(i,Ad(c,u)),Id(l,u))}var h=Nv(i,o);return Ev(h,s,a)}});var Pv=wh({logSumExp_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=kh(e,"x","logSumExp"),a=rs(t,r.shape),i=Ed(r,a,!0),o=Ad(r,i),s=Td(o),u=Nd(s,a),c=Cd(u),l=Sp(Gp(i,c.shape),c);if(n){var h=qd(l.shape,a);return Gp(l,h)}return l}});function Mv(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+"supported. Labels / logits was rank ".concat(t.rank," ")+"and dim was ".concat(n));var r=kp((function(e,t,r){var a=Pv(t,[n],!0),i=Ad(Af(t,"float32"),a);r([e,i]);var o=Yd(Id(i,e));return{value:Nd(o,[n]),gradFunc:function(e,t){var r=Ct(t,2),a=r[0],i=r[1],o=qd(e.shape,[n]);return[Id(Gp(e,o),Ad(Af(a,"float32"),Td(i))),Id(Gp(e,o),Ad(Td(i),Af(a,"float32")))]}}}));return r(e,t)}wh({softmaxCrossEntropy_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Cv.SUM_BY_NONZERO_WEIGHTS,i=kh(e,"onehotLabels","softmaxCrossEntropy"),o=kh(t,"logits","softmaxCrossEntropy"),s=null;if(null!=n&&(s=kh(n,"weights","softmaxCrossEntropy")),Ko(i.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var u=xp(r),c=xp(1),l=xp(i.shape[1]);i=Sp(Id(i,Ad(c,u)),ld(u,l))}var h=Mv(i,o);return Ev(h,s,a)}});var Dv={bandPart:bv,gramSchmidt:_v,qr:Tv},Rv=function(e){h(n,e);var t=g(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return s(this,n),(a=t.call(this)).learningRate=e,a.rho=r,a.epsilon=i,a.accumulatedGrads=[],a.accumulatedUpdates=[],null==i&&(a.epsilon=fh.backend.epsilon()),a}return c(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=fh.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:"".concat(n,"/accum_grad"),variable:vp((function(){return Dm(a).variable(false)}))}),null==t.accumulatedUpdates[r]&&(t.accumulatedUpdates[r]={originalName:"".concat(n,"/accum_var"),variable:vp((function(){return Dm(a).variable(false)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable,s=t.accumulatedUpdates[r].variable;vp((function(){var e=Sp(Id(o,t.rho),Id(Kd(i),1-t.rho)),n=Id(ld(wm(Sp(s,t.epsilon)),wm(Sp(o,t.epsilon))),i),r=Sp(Id(s,t.rho),Id(Kd(n),1-t.rho));o.assign(e),s.assign(r);var u=Sp(Id(n,-t.learningRate),a);a.assign(u)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedUpdates&&(gp(this.accumulatedGrads.map((function(e){return e.variable}))),gp(this.accumulatedUpdates.map((function(e){return e.variable}))))}},{key:"getWeights",value:function(){var e=_(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(Fn(this.accumulatedGrads),Fn(this.accumulatedUpdates)),e.next=3,this.saveIterations();case 3:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=_(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,n=t.length/2,!1,this.accumulatedGrads=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}})),this.accumulatedUpdates=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}]),n}(wp);Rv.className="Adadelta",fp(Rv);var Ov=function(e){h(n,e);var t=g(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return s(this,n),(r=t.call(this)).learningRate=e,r.initialAccumulatorValue=a,r.accumulatedGrads=[],r}return c(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=fh.registeredVariables[n];if(null==t.accumulatedGrads[r]){t.accumulatedGrads[r]={originalName:"".concat(n,"/accumulator"),variable:vp((function(){return bd(a.shape,t.initialAccumulatorValue).variable(false)}))}}var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable;vp((function(){var e=Sp(o,Kd(i));o.assign(e);var n=Sp(Id(ld(i,wm(Sp(e,fh.backend.epsilon()))),-t.learningRate),a);a.assign(n)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedGrads&&gp(this.accumulatedGrads.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=_(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(this.accumulatedGrads.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=_(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,!1,this.accumulatedGrads=t.map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}]),n}(wp);Ov.className="Adagrad",fp(Ov);var Fv=function(e){h(n,e);var t=g(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return s(this,n),(i=t.call(this)).learningRate=e,i.beta1=r,i.beta2=a,i.epsilon=o,i.accumulatedFirstMoment=[],i.accumulatedSecondMoment=[],vp((function(){i.accBeta1=xp(r).variable(),i.accBeta2=xp(a).variable()})),null==o&&(i.epsilon=fh.backend.epsilon()),i}return c(n,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);vp((function(){var r=Ad(1,t.accBeta1),a=Ad(1,t.accBeta2);n.forEach((function(n,i){var o=fh.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:"".concat(n,"/m"),variable:vp((function(){return Dm(o).variable(false)}))}),null==t.accumulatedSecondMoment[i]&&(t.accumulatedSecondMoment[i]={originalName:"".concat(n,"/v"),variable:vp((function(){return Dm(o).variable(false)}))});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[i].variable,c=t.accumulatedSecondMoment[i].variable,l=Sp(Id(u,t.beta1),Id(s,1-t.beta1)),h=Sp(Id(c,t.beta2),Id(Kd(s),1-t.beta2)),f=ld(l,r),p=ld(h,a);u.assign(l),c.assign(h);var d=Sp(Id(ld(f,Sp(wm(p),t.epsilon)),-t.learningRate),o);o.assign(d)}})),t.accBeta1.assign(Id(t.accBeta1,t.beta1)),t.accBeta2.assign(Id(t.accBeta2,t.beta2))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&gp(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedSecondMoment&&gp(this.accumulatedSecondMoment.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=_(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(Fn(this.accumulatedFirstMoment),Fn(this.accumulatedSecondMoment)),e.next=3,this.saveIterations();case 3:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=_(x().mark((function e(t){var n,r=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,vp((function(){r.accBeta1.assign(kv(r.beta1,r.iterations_+1)),r.accBeta2.assign(kv(r.beta2,r.iterations_+1))})),n=t.length/2,!1,this.accumulatedFirstMoment=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}})),this.accumulatedSecondMoment=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}]),n}(wp);Fv.className="Adam",fp(Fv);var Lv=function(e){h(n,e);var t=g(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return s(this,n),(i=t.call(this)).learningRate=e,i.beta1=r,i.beta2=a,i.epsilon=o,i.decay=u,i.accumulatedFirstMoment=[],i.accumulatedWeightedInfNorm=[],vp((function(){i.iteration=xp(0).variable(),i.accBeta1=xp(r).variable()})),null==o&&(i.epsilon=fh.backend.epsilon()),i}return c(n,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);vp((function(){var r=Ad(1,t.accBeta1),a=ld(-t.learningRate,Sp(Id(t.iteration,t.decay),1));n.forEach((function(n,i){var o=fh.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:"".concat(n,"/m"),variable:Dm(o).variable(false)}),null==t.accumulatedWeightedInfNorm[i]&&(t.accumulatedWeightedInfNorm[i]={originalName:"".concat(n,"/v"),variable:Dm(o).variable(false)});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[i].variable,c=t.accumulatedWeightedInfNorm[i].variable,l=Sp(Id(u,t.beta1),Id(s,1-t.beta1)),h=Id(c,t.beta2),f=_p(s),p=Fd(h,f);u.assign(l),c.assign(p);var d=Sp(Id(ld(a,r),ld(l,Sp(p,t.epsilon))),o);o.assign(d)}})),t.iteration.assign(Sp(t.iteration,1)),t.accBeta1.assign(Id(t.accBeta1,t.beta1))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&gp(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedWeightedInfNorm&&gp(this.accumulatedWeightedInfNorm.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=_(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("getWeights() is not implemented for Adamax yet.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=_(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("setWeights() is not implemented for Adamax yet.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}]),n}(wp);Lv.className="Adamax",fp(Lv);var zv=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this)).learningRate=e,r.setLearningRate(e),r}return c(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=Array.isArray(e)?e[r].tensor:e[n];if(null!=a){var i=fh.registeredVariables[n];vp((function(){var e=Sp(Id(t.c,a),i);i.assign(e)}))}})),this.incrementIterations()}},{key:"setLearningRate",value:function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=yp(xp(-e))}},{key:"dispose",value:function(){this.c.dispose()}},{key:"getWeights",value:function(){var e=_(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0]);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=_(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:if(0===(t=e.sent).length){e.next=5;break}throw new Error("SGD optimizer does not have settable weights.");case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate)}}]),n}(wp);zv.className="SGD",fp(zv);var Bv=function(e){h(n,e);var t=g(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return s(this,n),(a=t.call(this,e)).learningRate=e,a.momentum=r,a.useNesterov=i,a.accumulations=[],a.m=xp(a.momentum),a}return c(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=fh.registeredVariables[n];if(null==t.accumulations[r]){t.accumulations[r]={originalName:"".concat(n,"/momentum"),variable:vp((function(){return Dm(a).variable(false)}))}}var i=t.accumulations[r].variable,o=Array.isArray(e)?e[r].tensor:e[n];null!=o&&vp((function(){var e,n=Sp(Id(t.m,i),o);e=t.useNesterov?Sp(Id(t.c,Sp(o,Id(n,t.m))),a):Sp(Id(t.c,n),a),i.assign(n),a.assign(e)}))})),this.incrementIterations()}},{key:"dispose",value:function(){this.m.dispose(),null!=this.accumulations&&gp(this.accumulations.map((function(e){return e.variable})))}},{key:"setMomentum",value:function(e){this.momentum=e}},{key:"getWeights",value:function(){var e=_(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(this.accumulations.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=_(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,!1,this.accumulations=t.map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}]),n}(zv);Bv.className="Momentum",fp(Bv);var Vv=function(e){h(n,e);var t=g(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(s(this,n),(r=t.call(this)).learningRate=e,r.decay=a,r.momentum=i,r.epsilon=o,r.accumulatedMeanSquares=[],r.accumulatedMoments=[],r.accumulatedMeanGrads=[],r.centered=u,null==o&&(r.epsilon=fh.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.");return r}return c(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=fh.registeredVariables[n],i=!1;null==t.accumulatedMeanSquares[r]&&(t.accumulatedMeanSquares[r]={originalName:"".concat(n,"/rms"),variable:vp((function(){return Dm(a).variable(i)}))}),null==t.accumulatedMoments[r]&&(t.accumulatedMoments[r]={originalName:"".concat(n,"/momentum"),variable:vp((function(){return Dm(a).variable(i)}))}),null==t.accumulatedMeanGrads[r]&&t.centered&&(t.accumulatedMeanGrads[r]={originalName:"".concat(n,"/mg"),variable:vp((function(){return Dm(a).variable(i)}))});var o=Array.isArray(e)?e[r].tensor:e[n];if(null!=o){var s=t.accumulatedMeanSquares[r].variable,u=t.accumulatedMoments[r].variable;vp((function(){var e=Sp(Id(s,t.decay),Id(Kd(o),1-t.decay));if(t.centered){var n=t.accumulatedMeanGrads[r].variable,i=Sp(Id(n,t.decay),Id(o,1-t.decay)),c=ld(Id(o,t.learningRate),wm(Ad(e,Sp(Kd(i),t.epsilon)))),l=Sp(Id(u,t.momentum),c);s.assign(e),n.assign(i),u.assign(l);var h=Ad(a,l);a.assign(h)}else{var f=Sp(Id(s,t.decay),Id(Kd(o),1-t.decay)),p=Sp(Id(u,t.momentum),ld(Id(o,t.learningRate),wm(Sp(f,t.epsilon))));s.assign(f),u.assign(p);var d=Ad(a,p);a.assign(d)}}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedMeanSquares&&gp(this.accumulatedMeanSquares.map((function(e){return e.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&gp(this.accumulatedMeanGrads.map((function(e){return e.variable}))),null!=this.accumulatedMoments&&gp(this.accumulatedMoments.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=_(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(Fn(this.accumulatedMeanSquares),Fn(this.accumulatedMoments)),this.centered&&t.push.apply(t,Fn(this.accumulatedMeanGrads)),e.next=4,this.saveIterations();case 4:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=_(x().mark((function e(t){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,n=this.centered?t.length/3:t.length/2,r=!1,this.accumulatedMeanSquares=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})),this.accumulatedMoments=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*n,3*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}]),n}(wp);Vv.className="RMSProp",fp(Vv);var jv=function(){function e(){s(this,e)}return c(e,null,[{key:"sgd",value:function(e){return new zv(e)}},{key:"momentum",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Bv(e,t,n)}},{key:"rmsprop",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return new Vv(e,t,n,r,a)}},{key:"adam",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new Fv(e,t,n,r)}},{key:"adadelta",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new Rv(e,t,n)}},{key:"adamax",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.002,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return new Lv(e,t,n,r,a)}},{key:"adagrad",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return new Ov(e,t)}}]),e}(),qv={sgd:jv.sgd,momentum:jv.momentum,adadelta:jv.adadelta,adagrad:jv.adagrad,rmsprop:jv.rmsprop,adamax:jv.adamax,adam:jv.adam},Gv="undefined"!==typeof requestAnimationFrame?requestAnimationFrame:"undefined"!==typeof setImmediate?setImmediate:function(e){return e()};function Wv(){return new Promise((function(e){return Gv((function(){return e()}))}))}function Uv(e,t){var n=e[0].length;e.forEach((function(e,t){Ho(e.length===n,(function(){return"Error in concat".concat(n,"D: rank of tensors[").concat(t,"] must be the same ")+"as the rank of the rest (".concat(n,")")}))})),Ho(t>=0&&t<n,(function(){return"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,".")}));var r=e[0];e.forEach((function(e,a){for(var i=0;i<n;i++)Ho(i===t||e[i]===r[i],(function(){return"Error in concat".concat(n,"D: Shape of tensors[").concat(a,"] (").concat(e,") ")+"does not match the shape of the rest (".concat(r,") ")+"along the non-concatenated axis ".concat(a,".")}))}))}function Hv(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}function Kv(e){return e<=30?e:ds(e,Math.floor(Math.sqrt(e)))}function Xv(e,t,n){return[n*("number"===typeof e?e:e[0]),t*("number"===typeof e?e:e[1])]}function Yv(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];if(r)(a=a.concat(t.slice(0))).push(e[0]/n),a=a.concat(e.slice(1));else{a=a.concat(e[0]);for(var i=t.length,o=0;o<i;++o)a=a.concat([e[o+1]/t[o],t[o]]);a=a.concat(e.slice(i+1))}return a}function Qv(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=[];if(n){r.push(t);for(var a=t+1;a<e;++a)a<=2*t?(r.push(a),r.push(a-(t+1))):r.push(a)}else{for(var i=[],o=[],s=1;s<e;++s)s>=2*t+1||s%2===1?o.push(s):i.push(s);r.push.apply(r,i),r.push(0),r.push.apply(r,o)}return r}function $v(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];r?a.push(e[0]/n):a.push(e[0]*n);for(var i=1;i<e.length;++i)i<=t.length?r?a.push(t[i-1]*e[i]):a.push(e[i]/t[i-1]):a.push(e[i]);return a}function Jv(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function Zv(e,t,n){for(var r=e.slice(0,1),a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}function eg(e,t){var n=e.shape.length,r=t.shape.length;if(n<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(n,"."));if(r<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(r,"."));if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.shape[r-1]>n)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(t.shape[r-1]," vs. ").concat(n));if(0===Qo(e.shape))throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(e.shape,"."));for(var a=t.shape,i=a[a.length-1],o=1,s=0;s<a.length-1;++s)o*=a[s];var u=e.shape,c=a.slice();c.pop();for(var l=1,h=i;h<n;++h)l*=u[h],c.push(u[h]);var f=[].concat(Fn(ms(e.shape).map((function(e){return e/l}))),[1]).slice(0,i);return[c,o,l,f]}function tg(e,t,n){for(var r=t.shape.length,a=r>1?t.shape[r-1]:1,i=n.length,o=1,s=a;s<i;++s)o*=n[s];var u=a<1?1:a;return{sliceRank:a,numUpdates:Qo(t.shape)/u,sliceSize:o,strides:[].concat(Fn(ms(n.slice(0,a))),[1]),outputSize:Qo(n)}}var ng=1.7580993408473768,rg=1.0507009873554805,ag=.3275911,ig=.254829592,og=-.284496736,sg=1.421413741,ug=-1.453152027,cg=1.061405429;function lg(){var e;Is().getBool("IS_TEST")||(e=console).warn.apply(e,arguments)}function hg(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(e.length,", imag: ").concat(t.length,"."));for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function fg(e,t){return{real:e[2*t],imag:e[2*t+1]}}function pg(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function dg(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function mg(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if("number"===typeof t)Ho(e.shape[n]%t===0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(t).fill(e.shape[n]/t);else{var a=t.reduce((function(e,t){return-1===t&&(e+=1),e}),0);Ho(a<=1,(function(){return"There should be only one negative value in split array."}));var i=t.indexOf(-1);if(-1!==i){var o=t.reduce((function(e,t){return t>0?e+t:e}));t[i]=e.shape[n]-o}Ho(e.shape[n]===t.reduce((function(e,t){return e+t})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=t}return r}function vg(e,t,n,r){var a=t.shape.length,i=e.shape.length;if(0!==r&&(r<-a||r>a))throw new Error("Expect batchDims in the range of [-".concat(a,", ").concat(a,"], but got ").concat(r));if(r<0&&(r+=a),r>i)throw new Error("batchDims (".concat(r,") must be less than rank(x) (\n    ").concat(i,")."));if(n<r)throw new Error("batchDims (".concat(r,") must be less than or equal to axis (").concat(n,")."));for(var o=0;o<r;++o)if(e.shape[o]!==t.shape[o])throw new Error("x.shape[".concat(o,"]: ").concat(e.shape[o]," should be equal to indices.shape[").concat(o,"]: ").concat(t.shape[o],"."));for(var s=e.shape[n],u=[],c=1,l=1,h=1,f=0;f<r;++f)u.push(e.shape[f]),c*=e.shape[f];for(var p=r;p<n;p++)u.push(e.shape[p]),l*=e.shape[p];for(var d=r;d<a;d++)u.push(t.shape[d]);for(var m=n+1;m<i;m++)u.push(e.shape[m]),h*=e.shape[m];return{batchSize:c,sliceSize:h,outerSize:l,dimSize:s,outputShape:u}}function gg(e){try{return e.map((function(e){return Wl(e)}))}catch(ZJ){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat(ZJ))}}function yg(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);for(var a=If(e,"int32"),i=If([n.length,e.length],"int32"),o=0;o<n.length;o++){var s=a.indexToLoc(n[o]),u=o*e.length;i.values.set(s,u)}return i.toTensor()}var bg={kernelName:Ds,inputsToSave:["x"],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){return Id(e,Wm(Af(n,"float32"),-1))}}}},kg={kernelName:Rs,inputsToSave:["x"],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){var t=Kd(Af(n,"float32")),r=wm(Ad(xp(1),t));return Yd(ld(e,r))}}}},xg={kernelName:Os,inputsToSave:["x"],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){var t=wm(Ad(Kd(Af(n,"float32")),1));return ld(e,t)}}}},wg={kernelName:Fs,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Ct(t,2),r=n[0],a=n[1],i=dd(r.shape,a.shape);return{a:function(){var t=e,n=pd(r.shape,i);return n.length>0&&(t=Nd(t,n)),Gp(t,r.shape)},b:function(){var t=e,n=pd(a.shape,i);return n.length>0&&(t=Nd(t,n)),Gp(t,a.shape)}}}},_g={kernelName:Ls,saveAllInputs:!0,gradFunc:function(e,t){var n={};return t.forEach((function(t,r){n[r]=function(){return e.clone()}})),n}},Sg={kernelName:Vs,inputsToSave:["x"],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){return Dm(n)}}}},Cg={kernelName:js,inputsToSave:["x"],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){return Dm(n)}}}},Tg={kernelName:qs,inputsToSave:["x"],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){return ld(e,wm(Ad(xp(1),Kd(Af(n,"float32")))))}}}},Eg={kernelName:Gs,inputsToSave:["x"],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){var t=wm(Sp(xp(1),Kd(Af(n,"float32"))));return ld(e,t)}}}},Ig={kernelName:Hs,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Ct(t,2),r=n[0],a=n[1],i=dd(r.shape,a.shape);return{a:function(){var t=Sp(Kd(r),Kd(a)),n=Id(e,ld(a,t)),o=pd(r.shape,i);return o.length>0&&(n=Nd(n,o)),Gp(n,r.shape)},b:function(){var t=Sp(Kd(r),Kd(a)),n=Yd(Id(e,ld(r,t))),o=pd(a.shape,i);return o.length>0&&(n=Nd(n,o)),Gp(n,a.shape)}}}},Ag={kernelName:Ws,inputsToSave:["x"],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){return ld(e,Sp(Kd(Af(n,"float32")),1))}}}},Ng={kernelName:Us,inputsToSave:["x"],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){return ld(e,Ad(xp(1),Kd(Af(n,"float32"))))}}}};var Pg=wh({avgPool3dGrad_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1,1],i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,s=kh(e,"dy","avgPool3dGrad"),u=kh(t,"input","avgPool3dGrad"),c=s,l=u,h=!1;4===u.rank&&(h=!0,c=Gp(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),l=Gp(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),Ho(5===c.rank,(function(){return"Error in avgPool3dGrad: dy must be rank 5 but got rank "+"".concat(c.rank,".")})),Ho(5===l.rank,(function(){return"Error in avgPool3dGrad: input must be rank 5 but got rank "+"".concat(l.rank,".")})),Ho(jp(r,a),(function(){return"Error in avgPool3dGrad: Either strides or dilations "+"must be 1. Got strides ".concat(r," and dilations '").concat(a,"'")})),null!=o&&Ho(Jo(i),(function(){return"Error in avgPool3dGrad: pad must be an integer when "+"using, dimRoundingMode ".concat(o," but got pad ").concat(i,".")}));var f={dy:c,input:l},p={filterSize:n,strides:r,dilations:a,pad:i,dimRoundingMode:o},d=fh.runKernel(Qs,f,p);return h?Gp(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}}),Mg={kernelName:Ys,inputsToSave:["x"],gradFunc:function(e,t,n){var r=Ct(t,1)[0],a=n.filterSize,i=n.strides,o=n.dilations,s=n.pad,u=n.dimRoundingMode,c=null==o?[1,1,1]:o;return{x:function(){return Pg(e,r,a,i,c,s,u)}}}};var Dg=wh({avgPoolGrad_:function(e,t,n,r,a){var i=kh(e,"dy","avgPoolGrad"),o=kh(t,"input","avgPoolGrad");Ho(o.rank===i.rank,(function(){return"Rank of input (".concat(o.rank,") does not match rank of dy (").concat(i.rank,")")}));var s=o,u=i,c=!1;3===o.rank&&(c=!0,s=Gp(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=Gp(i,[1,i.shape[0],i.shape[1],i.shape[2]])),Ho(4===u.rank,(function(){return"Error in avgPoolGrad: dy must be rank 4 but got rank "+"".concat(u.rank,".")})),Ho(4===s.rank,(function(){return"Error in avgPoolGrad: input must be rank 4 but got rank "+"".concat(s.rank,".")}));var l={dy:u,input:s},h={filterSize:n,strides:r,pad:a},f=fh.runKernel(Xs,l,h);return c?Gp(f,[f.shape[1],f.shape[2],f.shape[3]]):f}}),Rg={kernelName:Ks,inputsToSave:["x"],gradFunc:function(e,t,n){var r=Ct(t,1)[0],a=n.filterSize,i=n.strides,o=n.pad;return{x:function(){return Dg(e,r,a,i,o)}}}},Og={kernelName:$s,inputsToSave:["a","b"],gradFunc:function(e,t,n){var r=Ct(t,2),a=r[0],i=r[1],o=n.transposeA,s=n.transposeB;return o||s?!o&&s?{a:function(){return Jm(e,i,!1,!1)},b:function(){return Jm(e,a,!0,!1)}}:o&&!s?{a:function(){return Jm(i,e,!1,!0)},b:function(){return Jm(a,e,!1,!1)}}:{a:function(){return Jm(i,e,!0,!0)},b:function(){return Jm(e,a,!0,!0)}}:{a:function(){return Jm(e,i,!1,!0)},b:function(){return Jm(a,e,!0,!1)}}}};var Fg=wh({spaceToBatchND_:function(e,t,n){var r=kh(e,"x","spaceToBatchND");Ho(r.rank>=1+t.length,(function(){return"input rank ".concat(r.rank," should be > than [blockShape] ").concat(t.length)})),Ho(n.length===t.length,(function(){return"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(t.length)})),Ho(r.shape.reduce((function(e,r,a){return a>0&&a<=t.length?e&&(r+n[a-1][0]+n[a-1][1])%t[a-1]===0:e}),!0),(function(){return"input spatial dimensions ".concat(r.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(t.toString())}));var a={x:r},i={blockShape:t,paddings:n};return fh.runKernel(nl,a,i)}}),Lg={kernelName:Js,gradFunc:function(e,t,n){var r=n.blockShape,a=n.crops;return{x:function(){return Fg(e,r,a)}}}},zg={kernelName:"BroadcastTo",gradFunc:function(e,t,n){for(var r=n,a=r.inputShape,i=r.shape,o=Array.from(i),s=a.length-1;s>=0;s--)if(a[s]===i[s])o[s]=1;else if(1!==a[s])throw new Error("broadcastTo(): [".concat(a,"] cannot be broadcast to [").concat(i,"]."));for(var u=[],c=0;c<o.length;c++)o[c]>1&&u.push(c);return{x:function(){return Nd(e,u,!0)}}}},Bg={kernelName:eu,gradFunc:function(e){return{x:function(){return e.clone()}}}},Vg={kernelName:tu,gradFunc:function(e){return{x:function(){return Dm(e)}}}},jg={kernelName:nu,inputsToSave:["x"],gradFunc:function(e,t,n){var r=Ct(t,1)[0],a=n.clipValueMin,i=n.clipValueMax;return{x:function(){return Mm(Md(_d(r,a),gv(r,i)),e,Dm(e))}}}},qg={kernelName:au,inputsToSave:["x"],gradFunc:bg.gradFunc},Gg={kernelName:iu,saveAllInputs:!0,gradFunc:function(e,t,n){var r=t.map((function(e){return e.shape})),a=rs(n.axis,t[0].shape)[0],i=r.map((function(e){return e[a]}));return xm(e,i,a).map((function(e){return function(){return e}}))}},Wg={kernelName:ou,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=Ct(t,2),a=r[0],i=r[1],o=n.dilations,s=n.strides,u=n.pad,c=n.dataFormat;return Ho(Vp(o),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(o,"'")})),{x:function(){return id(a.shape,e,i,s,u,c)},filter:function(){return qm(a,e,i.shape,s,u,c)}}}},Ug={kernelName:uu,inputsToSave:["dy","filter"],gradFunc:function(e,t,n){var r=Ct(t,2),a=r[0],i=r[1],o=n.strides,s=n.pad,u=n.dataFormat,c=n.dimRoundingMode;return{dy:function(){return rd(e,i,o,s,u,1,c)},filter:function(){return qm(e,a,i.shape,o,s,u,c)}}}};var Hg=wh({conv3DBackpropFilter_:function(e,t,n,r,a){var i=e;4===e.rank&&(i=Gp(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));var o=t;4===o.rank&&(o=Gp(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),Ho(5===i.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+"".concat(i.shape,".")})),Ho(5===o.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+"".concat(o.shape,".")})),Ho(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+"".concat(n,".")})),Ho(i.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input ".concat(i.shape[4],") must ")+"match input depth in filter (".concat(n[3],".")})),Ho(o.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy (".concat(o.shape[4],") must ")+"match output depth for filter (".concat(n[4],").")}));var s={x:i,dy:o},u={strides:r,pad:a,filterShape:n};return fh.runKernel(lu,s,u)}});var Kg=wh({conv3DBackpropInput_:function(e,t,n,r,a){Ho(e.length===t.rank,(function(){return"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var i=e,o=t,s=!1;4===t.rank&&(s=!0,o=Gp(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),i=[1,e[0],e[1],e[2],e[3]]);var u=i[4],c=o.shape[4];Ho(5===i.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(i.length,".")})),Ho(5===o.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(o.rank)})),Ho(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank)})),Ho(u===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input (".concat(u,") must ")+"match input depth for filter ".concat(n.shape[3],".")})),Ho(c===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output (".concat(c,") must ")+"match output depth for filter ".concat(n.shape[4],".")}));var l={dy:o,filter:n},h={pad:a,strides:r,inputShape:i},f=fh.runKernel(hu,l,h);return s?Gp(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}}),Xg={kernelName:cu,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=n.dilations,a=n.strides,i=n.pad;Ho(Vp(r),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are "+"not yet supported in gradients. Got dilations '".concat(r,"'")}));var o=Ct(t,2),s=o[0],u=o[1];return{x:function(){return Kg(s.shape,e,u,a,i)},filter:function(){return Hg(s,e,u.shape,a,i)}}}};var Yg=wh({sin_:function(e){var t={x:kh(e,"x","sin")};return fh.runKernel(Yc,t)}}),Qg={kernelName:fu,inputsToSave:["x"],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){return Id(Yd(Yg(Af(n,"float32"))),e)}}}};var $g=wh({sinh_:function(e){var t={x:kh(e,"x","sinh")};return fh.runKernel(Qc,t)}}),Jg={kernelName:pu,inputsToSave:["x"],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){return Id($g(Af(n,"float32")),e)}}}};var Zg=wh({cumsum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=kh(e,"x","cumsum"),i={x:a},o={axis:t,exclusive:n,reverse:r};return fh.runKernel(du,i,o)}}),ey={kernelName:du,inputsToSave:["x"],gradFunc:function(e,t,n){var r=Ct(t,1)[0],a=n.axis,i=n.exclusive,o=n.reverse;return{x:function(){var t=Wd([a],r.rank),n=Zg(e,a,i,!o);return null!=t&&(n=Rm(n,t)),n}}}},ty={kernelName:yu,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=n.dilations,a=n.strides,i=n.pad,o=n.dimRoundingMode,s=null==r?[1,1]:r;Ho(Vp(s),(function(){return"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(s,"'")}));var u=Ct(t,2),c=u[0],l=u[1];return Ho(4===c.rank,(function(){return"Error in gradient of depthwiseConv2dNative: input must be "+"rank 4, but got rank ".concat(c.rank,".")})),Ho(4===l.rank,(function(){return"Error in gradient of depthwiseConv2dNative: filter must be "+"rank 4, but got rank ".concat(l.rank,".")})),Ho(c.shape[3]===l.shape[2],(function(){return"Error in gradient of depthwiseConv2d: number of input "+"channels (".concat(c.shape[3],") must match the inChannels dimension ")+"in filter ".concat(l.shape[2],".")})),Ho(jp(a,s),(function(){return"Error in gradient of depthwiseConv2d: Either strides or "+"dilations must be  1. Got strides ".concat(a," and dilations ")+"'".concat(s,"'.")})),null!=o&&Ho(Jo(i),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(i,".")})),{x:function(){return $m(c.shape,e,l,a,i,r,o)},filter:function(){return Qm(c,e,l.shape,a,i,r,o)}}}},ny={kernelName:wu,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=Ct(t,2),a=r[0],i=r[1],o={x:a,filter:i,dy:e},s={x:a,filter:i,dy:e};return{x:function(){return fh.runKernel(_u,o,n)},filter:function(){return fh.runKernel(Su,s,n)}}}},ry={kernelName:Tu,outputsToSave:[!0],gradFunc:function(e,t){var n={dy:e,y:Ct(t,1)[0]};return{x:function(){return fh.runKernel(Eu,n)}}}},ay={kernelName:Iu,inputsToSave:["x"],gradFunc:function(e,t){var n=Ct(t,1)[0],r=Id(Td(Yd(Kd(n))),2/Math.sqrt(Math.PI));return{x:function(){return Id(e,r)}}}},iy={kernelName:Nu,outputsToSave:[!0],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){return Id(e,n)}}}},oy={kernelName:Pu,inputsToSave:["input"],gradFunc:function(e,t){var n=Ct(t,1)[0];return{input:function(){return Gp(e,n.shape)}}}},sy={kernelName:Mu,inputsToSave:["x"],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){return Id(e,Td(n))}}}},uy={kernelName:Fu,gradFunc:function(e){return{x:function(){return Dm(e)}}}},cy={kernelName:Lu,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Ct(t,2),r=n[0],a=n[1],i=dd(r.shape,a.shape);return{a:function(){var t=ld(e,Af(a,"float32")),n=pd(r.shape,i);return n.length>0?Gp(Nd(t,n),r.shape):t},b:function(){var t=Id(e,Af(r,"float32")),n=pd(a.shape,i);n.length>0&&(t=Gp(Nd(t,n),a.shape));var o=Kd(a);return Yd(ld(t,Af(o,"float32")))}}}},ly={kernelName:zu,inputsToSave:["x","mean","variance","scale"],gradFunc:function(e,t,n){var r=n.varianceEpsilon,a=Ct(t,4),i=a[0],o=a[1],s=a[2],u=a[3],c=null==u?xp(1):u,l=pd(o.shape,i.shape),h=[];if(1===o.rank){for(var f=0;f<i.shape.length-1;++f)h.push(i.shape[f]);h.push(1)}var p=Ad(i,o),d=Id(e,c),m=lm(Sp(s,xp(r))),v=Id(Id(Id(m,m),m),xp(-.5));return{x:function(){return 1===o.rank?Gp(Id(Id(e,gd(Gp(m,[1,1,1,o.shape[0]]),h)),c),i.shape):Gp(Id(Id(e,m),c),i.shape)},mean:function(){var e=Id(Id(m,xp(-1)),d);return 1===o.rank&&(e=Nd(e,l)),Gp(e,o.shape)},variance:function(){var e=Id(Id(v,p),d);return 1===o.rank&&(e=Nd(e,l)),Gp(e,o.shape)},scale:function(){var t=Id(p,m),n=Id(e,t);return 1===o.rank&&(n=Nd(n,l)),Gp(n,o.shape)},offset:function(){var t=e;return 1===o.rank&&(t=Nd(t,l)),Gp(t,o.shape)}}}};var hy=wh({unsortedSegmentSum_:function(e,t,n){var r=kh(e,"x","unsortedSegmentSum"),a=kh(t,"segmentIds","unsortedSegmentSum","int32");Ho(Jo(n),(function(){return"numSegments must be of dtype int"}));var i={x:r,segmentIds:a},o={numSegments:n};return fh.runKernel(gl,i,o)}}),fy={kernelName:Bu,inputsToSave:["x","indices"],gradFunc:function(e,t,n){var r=Ct(t,2),a=r[0],i=r[1],o=n.axis,s=rs(o,a.shape)[0];return{x:function(){var t=a.shape,n=i.size,r=t.slice(0,s),u=r.length,c=t.slice(o,t.length).slice(1),l=c.length,h=py(0,u),f=py(u+1,u+1+l),p=dy([r,[n],c]),d=Gp(e,p),m=Gp(i,[n]),v=dy([[u],h,f]),g=Rm(d,v),y=hy(g,m,a.shape[s]),b=Ud(v);return y=Rm(y,b)},indices:function(){return i}}}};function py(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function dy(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var my={kernelName:qu,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Ct(t,2),r=n[0],a=n[1];return{a:function(){return Dm(r)},b:function(){return Dm(a)}}}},vy={kernelName:Gu,gradFunc:function(e){return{x:function(){return Af(e,"float32")}}}},gy={kernelName:Hu,gradFunc:function(e){return{x:function(){return Dm(e)}}}},yy={kernelName:Ku,gradFunc:function(e){return{x:function(){return Dm(e)}}}},by={kernelName:Xu,gradFunc:function(e){return{x:function(){return Dm(e)}}}},ky={kernelName:Yu,inputsToSave:["x"],gradFunc:function(e,t,n){var r=Ct(t,1)[0],a=n.alpha,i=wd(r,0);return{x:function(){return Mm(i,e,Id(e,a))}}}},xy={kernelName:ec,inputsToSave:["x"],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){return ld(e,Sp(n,1))}}}},wy={kernelName:Zu,inputsToSave:["x"],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){return ld(e,Af(n,"float32"))}}}},_y={kernelName:"LogSoftmax",inputsToSave:[],outputsToSave:[!0],gradFunc:function(e,t,n){var r=Ct(t,1)[0],a=n.axis;return{logits:function(){var t=Td(r);return Ad(e,Id(Nd(e,a,!0),t))}}}};var Sy=wh({localResponseNormalizationBackprop_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5,s={x:e,y:t,dy:n},u={depthRadius:r,bias:a,alpha:i,beta:o};return fh.runKernel(ic,s,u)}}),Cy={kernelName:ac,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=Ct(t,2),a=r[0],i=r[1],o=n.depthRadius,s=n.bias,u=n.alpha,c=n.beta;return{x:function(){return Sy(a,i,e,o,s,u,c)}}}};function Ty(e,t,n,r){return t.rank<n.rank&&(t=Gp(t,qd(t.shape,r))),e.rank<n.rank&&(e=Gp(e,qd(e.shape,r))),{x:function(){return Id(e,Af(md(n,t),e.dtype))}}}var Ey={kernelName:oc,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=n.reductionIndices,a=t[0],i=Ty(e,t[1],a,rs(r,a.shape));return{x:function(){return i.x()}}}};var Iy=wh({less_:function(e,t){var n=kh(e,"a","less"),r=kh(t,"b","less"),a=Ct(ah(n,r),2);n=a[0],r=a[1],dd(n.shape,r.shape);var i={a:n,b:r};return fh.runKernel(Qu,i)}}),Ay={kernelName:sc,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Ct(t,2),r=n[0],a=n[1];return{a:function(){return Id(e,Af(_d(r,a),"float32"))},b:function(){return Id(e,Af(Iy(r,a),"float32"))}}}};var Ny=wh({maxPool3dGrad_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1],o=arguments.length>6?arguments[6]:void 0,s=arguments.length>7?arguments[7]:void 0,u=kh(e,"dy","maxPool3dGrad"),c=kh(t,"input","maxPool3dGrad"),l=kh(n,"output","maxPool3dGrad"),h=u,f=c,p=l,d=!1;4===c.rank&&(d=!0,h=Gp(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),f=Gp(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]]),p=Gp(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),Ho(5===h.rank,(function(){return"Error in maxPool3dGrad: dy must be rank 5 but got rank "+"".concat(h.rank,".")})),Ho(5===f.rank,(function(){return"Error in maxPool3dGrad: input must be rank 5 but got rank "+"".concat(f.rank,".")})),Ho(5===p.rank,(function(){return"Error in maxPool3dGrad: output must be rank 5 but got rank "+"".concat(p.rank,".")})),Ho(jp(a,i),(function(){return"Error in maxPool3dGrad: Either strides or dilations "+"must be 1. Got strides ".concat(a," and dilations '").concat(i,"'")})),null!=s&&Ho(Jo(o),(function(){return"Error in maxPool3dGrad: pad must be an integer when "+"using, dimRoundingMode ".concat(s," but got pad ").concat(o,".")}));var m={dy:h,input:f,output:p},v={filterSize:r,strides:a,dilations:i,pad:o,dimRoundingMode:s},g=fh.runKernel(hc,m,v);return d?Gp(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}}),Py={kernelName:lc,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=Ct(t,2),a=r[0],i=r[1],o=n.filterSize,s=n.strides,u=n.dilations,c=n.pad,l=n.dimRoundingMode,h=null==u?[1,1,1]:u;return{x:function(){return Ny(e,a,i,o,s,h,c,l)}}}};var My=wh({maxPoolGrad_:function(e,t,n,r,a,i,o){var s=kh(e,"dy","maxPoolGrad"),u=kh(t,"input","maxPoolGrad"),c=kh(n,"output","maxPoolGrad");Ho(u.rank===s.rank,(function(){return"Rank of input (".concat(u.rank,") does not match rank of dy ")+"(".concat(s.rank,")")})),Ho(4===s.rank,(function(){return"Error in maxPoolGrad: dy must be rank 4 but got rank "+"".concat(s.rank,".")})),Ho(4===u.rank,(function(){return"Error in maxPoolGrad: input must be rank 4 but got rank "+"".concat(u.rank,".")})),null!=o&&Ho(Jo(i),(function(){return"Error in maxPoolGrad: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(i,".")}));var l={dy:s,input:u,output:c},h={filterSize:r,strides:a,pad:i,dimRoundingMode:o};return fh.runKernel(cc,l,h)}}),Dy={kernelName:uc,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=Ct(t,2),a=r[0],i=r[1],o=n.filterSize,s=n.strides,u=n.pad;return{x:function(){return My(e,a,i,o,s,u)}}}},Ry={kernelName:pc,inputsToSave:["x"],gradFunc:function(e,t,n){var r=Ct(t,1)[0],a=rs(n.axis,r.shape),i=Qo(jd(r.shape,a)[1]);return{x:function(){var t=r.shape.slice();a.forEach((function(e){t[e]=1}));var n=Gp(e,t);return ld(Id(n,Zd(r.shape,"float32")),i)}}}},Oy={kernelName:dc,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=n.axis,a=Ct(t,2),i=a[0],o=Ty(e,a[1],i,rs(r,i.shape));return{x:function(){return o.x()}}}},Fy={kernelName:mc,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Ct(t,2),r=n[0],a=n[1];return{a:function(){return Id(e,Af(gv(r,a),"float32"))},b:function(){return Id(e,Af(wd(r,a),"float32"))}}}},Ly={kernelName:vc,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],a=n.paddings.map((function(e){return e[0]}));return{x:function(){return dm(e,a,r.shape)}}}},zy={kernelName:gc,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Ct(t,2),r=n[0],a=n[1],i=dd(r.shape,a.shape);return{a:function(){var t=pd(r.shape,i);return t.length>0?Gp(Nd(e,t),r.shape):e},b:function(){var t=Id(e,Yd(kd(ld(r,a)))),n=pd(a.shape,i);return n.length>0?Gp(Nd(t,n),a.shape):t}}}},By={kernelName:bc,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Ct(t,2),r=n[0],a=n[1],i=dd(r.shape,a.shape);return{a:function(){var t=Id(e,Af(a,"float32")),n=pd(r.shape,i);return n.length>0?Gp(Nd(t,n),r.shape):t},b:function(){var t=Id(e,Af(r,"float32")),n=pd(a.shape,i);return n.length>0?Gp(Nd(t,n),a.shape):t}}}},Vy={kernelName:kc,gradFunc:function(e){return{x:function(){return Yd(e)}}}},jy={kernelName:Tc,inputsToSave:["indices"],gradFunc:function(e,t){var n=t[0];return{indices:function(){return Jd(n.shape,"float32")}}}},qy={kernelName:Cc,gradFunc:function(e){return{x:function(){return Dm(e)}}}},Gy={kernelName:Ec,saveAllInputs:!0,gradFunc:function(e,t,n){var r=n.axis;return Am(e,r).map((function(e){return function(){return e}}))}},Wy={kernelName:Ic,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],a=n.paddings.map((function(e){return e[0]}));return{x:function(){return dm(e,a,r.shape)}}}},Uy={kernelName:Ac,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:function(e,t){var n=Ct(t,3),r=n[0],a=n[1],i=n[2],o=r,s=a,u=dd(o.shape,s.shape);return{a:function(){var t=Af(s,"float32"),n=Id(e,Id(t,kv(o,Ad(t,xp(1))))),r=pd(o.shape,u);return r.length>0&&(n=Nd(n,r)),Gp(n,o.shape)},b:function(){var t=wd(o,0),n=Mm(t,Cd(o),Dm(o)),r=Id(e,Id(i,n)),a=pd(s.shape,u);return a.length>0&&(r=Nd(r,a)),Gp(r,s.shape)}}}},Hy={kernelName:Nc,inputsToSave:["x","alpha"],gradFunc:function(e,t){var n=Ct(t,2),r=n[0],a=n[1],i=wd(r,0);return{x:function(){return Mm(i,e,Id(e,a))},alpha:function(){var t=Mm(i,Dm(e),Id(e,r)),n=pd(a.shape,e.shape);return n.length>0&&(t=Nd(t,n)),Gp(t,a.shape)}}}},Ky={kernelName:Cu,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Ct(t,2),r=n[0],a=n[1],i=dd(r.shape,a.shape);return{a:function(){var t=ld(e,Af(a,"float32")),n=pd(r.shape,i);return n.length>0?Gp(Nd(t,n),r.shape):t},b:function(){var t=Id(e,Af(r,"float32")),n=pd(a.shape,i);n.length>0&&(t=Gp(Nd(t,n),a.shape));var o=Kd(a);return Yd(ld(t,Af(o,"float32")))}}}},Xy={kernelName:Rc,inputsToSave:["x"],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){return ld(e,Yd(Kd(n)))}}}},Yy={kernelName:jc,inputsToSave:["x"],gradFunc:function(e,t){var n=Ct(t,1)[0],r=Id(gv(n,6),Wm(n));return{x:function(){return Id(e,Af(r,"float32"))}}}},Qy={kernelName:Oc,inputsToSave:["x"],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){return Id(e,Af(Wm(n),"float32"))}}}},$y={kernelName:Fc,inputsToSave:["x"],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){return Gp(e,n.shape)}}}},Jy={kernelName:Bc,inputsToSave:["images"],gradFunc:function(e,t,n){var r={dy:e,images:Ct(t,1)[0]};return{images:function(){return fh.runKernel(Vc,r,n)}}}},Zy={kernelName:Lc,inputsToSave:["images"],gradFunc:function(e,t,n){var r={dy:e,images:Ct(t,1)[0]};return{images:function(){return fh.runKernel(zc,r,n)}}}},eb={kernelName:qc,gradFunc:function(e,t,n){var r=rs(n.dims,e.shape);return{x:function(){return cm(e,r)}}}},tb={kernelName:Gc,gradFunc:function(e){return{x:function(){return Dm(e)}}}},nb={kernelName:Wc,inputsToSave:["x"],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){return Yd(ld(e,Id(kv(n,1.5),2)))}}}};var rb=wh({logicalNot_:function(e){var t={x:kh(e,"x","logicalNot","bool")};return fh.runKernel(nc,t)}}),ab={kernelName:Hc,inputsToSave:["condition"],gradFunc:function(e,t){var n=Ct(t,1)[0];return{condition:function(){return Af(Dm(n),"float32")},t:function(){return Id(e,Af(n,e.dtype))},e:function(){return Id(e,Af(rb(n),e.dtype))}}}},ib={kernelName:Kc,inputsToSave:["x"],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){var t=wd(n,xp(0)),r=xp(ng),a=xp(rg),i=Id(e,a),o=Id(Id(e,r),Td(Af(n,"float32")));return Mm(t,i,o)}}}},ob={kernelName:Jc,outputsToSave:[!0],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){return Id(e,Id(n,Ad(xp(1),n)))}}}},sb={kernelName:$c,gradFunc:function(e){return{x:function(){return Dm(e)}}}};var ub=wh({cos_:function(e){var t={x:kh(e,"x","cos")};return fh.runKernel(fu,t)}}),cb={kernelName:Yc,inputsToSave:["x"],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){return Id(ub(Af(n,"float32")),e)}}}};var lb=wh({cosh_:function(e){var t={x:kh(e,"x","cosh")};return fh.runKernel(pu,t)}}),hb={kernelName:nl,gradFunc:function(e,t,n){var r=n.blockShape,a=n.paddings;return{x:function(){return Hp(e,r,a)}}}},fb={kernelName:rl,gradFunc:function(e,t,n){var r=n.axis;return{x:function(){return Jp(e,r)}}}},pb={kernelName:fl,inputsToSave:["x"],gradFunc:function(e,t,n){var r=Ct(t,1)[0],a=n.reps;return{x:function(){var t=Dm(r);if(1===r.rank)for(var n=0;n<a[0];++n)t=Sp(t,dm(e,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(var i=0;i<a[0];++i)for(var o=0;o<a[1];++o)t=Sp(t,dm(e,[i*r.shape[0],o*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(var s=0;s<a[0];++s)for(var u=0;u<a[1];++u)for(var c=0;c<a[2];++c)t=Sp(t,dm(e,[s*r.shape[0],u*r.shape[1],c*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+"".concat(r.rank," tensors yet."));for(var l=0;l<a[0];++l)for(var h=0;h<a[1];++h)for(var f=0;f<a[2];++f)for(var p=0;p<a[3];++p)t=Sp(t,dm(e,[l*r.shape[0],h*r.shape[1],f*r.shape[2],p*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return t}}}};for(var db=0,mb=[bg,kg,xg,wg,_g,Sg,Cg,Tg,Eg,Ig,Ag,Ng,Mg,Rg,Og,Lg,zg,Bg,Vg,jg,qg,Gg,Ug,Wg,Xg,Qg,Jg,ey,ty,ny,Ky,ry,ay,iy,oy,sy,cy,uy,ly,fy,my,vy,gy,yy,by,ky,xy,wy,_y,Cy,Ey,Ey,Ay,Py,Dy,Ry,Oy,Fy,Ly,zy,By,Vy,jy,qy,Gy,Wy,Wy,Uy,Hy,Xy,Yy,Qy,$y,Jy,Zy,eb,tb,nb,ab,ib,ob,sb,cb,{kernelName:Qc,inputsToSave:["x"],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){return Id(lb(Af(n,"float32")),e)}}}},{kernelName:Xc,inputsToSave:["x"],gradFunc:function(e,t,n){for(var r=Ct(t,1)[0],a=n.begin,i=n.size,o=r.shape,s=Ct(up(r,a,i),2),u=s[0],c=s[1],l=[],h=0;h<e.rank;h++)l.push([u[h],o[h]-u[h]-c[h]]);return{x:function(){return tm(e,l)}}}},{kernelName:al,outputsToSave:[!0],gradFunc:function(e,t,n){var r=Ct(t,1)[0],a=n.dim,i=Id(e,r);return{logits:function(){return Ad(i,Id(Nd(i,[a],true),r))}}}},{kernelName:Zc,inputsToSave:["x"],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){return Id(e,pm(n))}}}},hb,hb,fb,fb,{kernelName:el,inputsToSave:["x"],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){return ld(e,Id(wm(Af(n,"float32")),2))}}}},{kernelName:il,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Ct(t,2),r=n[0],a=n[1],i=xp(2);return{a:function(){return Id(e,Id(i,Ad(r,a)))},b:function(){return Id(e,Id(i,Ad(a,r)))}}}},{kernelName:ol,inputsToSave:["x"],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){return Id(e,Id(Af(n,"float32"),2))}}}},{kernelName:bl,gradFunc:function(e){return{x:function(){return Dm(e)}}}},{kernelName:sl,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Ct(t,2),r=n[0],a=n[1],i=dd(r.shape,a.shape);return{a:function(){var t=e,n=pd(r.shape,i);return n.length>0&&(t=Nd(t,n)),Gp(t,r.shape)},b:function(){var t=e,n=pd(a.shape,i);return n.length>0&&(t=Nd(t,n)),Gp(Yd(t),a.shape)}}}},{kernelName:tl,inputsToSave:["x"],gradFunc:function(e,t,n){var r=Ct(t,1)[0],a=r.shape.slice();rs(n.axis,r.shape).forEach((function(e){a[e]=1}));var i=Gp(e,a),o=Id(i,Zd(r.shape,"float32"));return{x:function(){return o}}}},{kernelName:ll,inputsToSave:["x"],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){return ld(e,Kd(ub(n)))}}}},{kernelName:hl,outputsToSave:[!0],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){return Id(Ad(xp(1),Kd(n)),e)}}}},pb,{kernelName:dl,gradFunc:function(e,t,n){var r=Ud(n.perm);return{x:function(){return Rm(e,r)}}}},{kernelName:vl,gradFunc:function(e,t,n){var r=n.axis;return{value:function(){return Sm(e,r)}}}},{kernelName:gl,inputsToSave:["segmentIds"],gradFunc:function(e,t){var n=Ct(t,1)[0];return{x:function(){return function(e,t){for(var n=Fd(t,Dm(t)),r=xd(e,n),a=_d(t,xp(0,"int32")),i=r.rank-a.rank,o=0;o<i;++o)a=vd(a,o+1);a=Md(a,Zd(r.shape,"bool"));var s=Dm(r);return Mm(a,r,s)}(e,n)}}}},{kernelName:yl,gradFunc:function(e){return{x:function(){return Dm(e)}}}}];db<mb.length;db++){Al(mb[db])}Xl.prototype.abs=function(){return this.throwIfDisposed(),_p(this)};var vb=wh({acos_:function(e){var t={x:kh(e,"x","acos")};return fh.runKernel(Rs,t)}});Xl.prototype.acos=function(){return this.throwIfDisposed(),vb(this)};var gb=wh({acosh_:function(e){var t={x:kh(e,"x","acosh")};return fh.runKernel(Os,t)}});Xl.prototype.acosh=function(){return this.throwIfDisposed(),gb(this)};var yb=wh({mod_:function(e,t){var n=kh(e,"a","mod"),r=kh(t,"b","mod"),a=Ct(ah(n,r),2),i={a:n=a[0],b:r=a[1]};return fh.runKernel(gc,i)}});var bb=wh({addStrict_:function(e,t){pp("strict variants of ops have been deprecated and will be removed in future");var n=kh(e,"a","addStrict"),r=kh(t,"b","addStrict");return Ko(n.shape,r.shape,"Error in addStrict: "),Sp(n,r)}}),kb=wh({divStrict_:function(e,t){pp("strict variants of ops have been deprecated and will be removed in future");var n=kh(e,"a","div"),r=kh(t,"b","div");return Ko(n.shape,r.shape,"Error in divideStrict: "),ld(n,r)}}),xb=wh({maximumStrict_:function(e,t){pp("strict variants of ops have been deprecated and will be removed in future");var n=kh(e,"a","maximumStrict"),r=kh(t,"b","maximumStrict");return Ko(n.shape,r.shape,"Error in maximumStrict: "),Fd(n,r)}}),wb=wh({minimumStrict_:function(e,t){pp("strict variants of ops have been deprecated and will be removed in future");var n=kh(e,"a","minimumStrict"),r=kh(t,"b","minimumStrict");return Ko(n.shape,r.shape,"Error in minimumStrict: "),Bd(n,r)}}),_b=wh({modStrict_:function(e,t){pp("strict variants of ops have been deprecated and will be removed in future");var n=kh(e,"a","modStrict"),r=kh(t,"b","modStrict");return Ko(n.shape,r.shape,"Error in modStrict: "),yb(n,r)}}),Sb=wh({mulStrict_:function(e,t){pp("strict variants of ops have been deprecated and will be removed in future");var n=kh(e,"a","mul"),r=kh(t,"b","mul");return Ko(n.shape,r.shape,"Error in multiplyStrict: "),Id(n,r)}}),Cb=wh({powStrict_:function(e,t){return pp("strict variants of ops have been deprecated and will be removed in future"),Ko(e.shape,t.shape,"Error in powStrict: "),kv(e,t)}}),Tb=wh({squaredDifferenceStrict_:function(e,t){pp("strict variants of ops have been deprecated and will be removed in future");var n=kh(e,"a","squaredDifferenceStrict"),r=kh(t,"b","squaredDifferenceStrict");return Ko(n.shape,r.shape,"Error in squaredDifferenceStrict: "),Iv(n,r)}}),Eb=wh({subStrict_:function(e,t){pp("strict variants of ops have been deprecated and will be removed in future");var n=kh(e,"a","subStrict"),r=kh(t,"b","subStrict");return Ko(n.shape,r.shape,"Error in subStrict: "),Ad(n,r)}});Xl.prototype.addStrict=function(e){return this.throwIfDisposed(),bb(this,e)},Xl.prototype.add=function(e){return this.throwIfDisposed(),Sp(this,e)},Xl.prototype.all=function(e,t){return this.throwIfDisposed(),Cp(this,e,t)},Xl.prototype.any=function(e,t){return this.throwIfDisposed(),Tp(this,e,t)},Xl.prototype.argMax=function(e){return this.throwIfDisposed(),Ep(this,e)};var Ib=wh({argMin_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=kh(e,"x","argMin"),r={x:n},a={axis:t};return fh.runKernel(js,r,a)}});Xl.prototype.argMin=function(e){return this.throwIfDisposed(),Ib(this,e)},Xl.prototype.asScalar=function(){return this.throwIfDisposed(),Ho(1===this.size,(function(){return"The array must have only 1 element."})),Gp(this,[])},Xl.prototype.asType=function(e){return this.throwIfDisposed(),Af(this,e)},Xl.prototype.as1D=function(){return this.throwIfDisposed(),Gp(this,[this.size])},Xl.prototype.as2D=function(e,t){return this.throwIfDisposed(),Gp(this,[e,t])},Xl.prototype.as3D=function(e,t,n){return this.throwIfDisposed(),Gp(this,[e,t,n])},Xl.prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),Gp(this,[e,t,n,r])},Xl.prototype.as5D=function(e,t,n,r,a){return this.throwIfDisposed(),Gp(this,[e,t,n,r,a])};var Ab=wh({asin_:function(e){var t={x:kh(e,"x","asin")};return fh.runKernel(qs,t)}});Xl.prototype.asin=function(){return this.throwIfDisposed(),Ab(this)};var Nb=wh({asinh_:function(e){var t={x:kh(e,"x","asinh")};return fh.runKernel(Gs,t)}});Xl.prototype.asinh=function(){return this.throwIfDisposed(),Nb(this)};var Pb=wh({atan_:function(e){var t={x:kh(e,"x","atan")};return fh.runKernel(Ws,t)}});Xl.prototype.atan=function(){return this.throwIfDisposed(),Pb(this)};var Mb=wh({atan2_:function(e,t){var n=kh(e,"a","atan2"),r=kh(t,"b","atan2"),a=Ct(ah(n,r),2),i={a:n=a[0],b:r=a[1]};return fh.runKernel(Hs,i)}});Xl.prototype.atan2=function(e){return this.throwIfDisposed(),Mb(this,e)};var Db=wh({atanh_:function(e){var t={x:kh(e,"x","atanh")};return fh.runKernel(Us,t)}});Xl.prototype.atanh=function(){return this.throwIfDisposed(),Db(this)},Xl.prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),Wp(this,e,t,n,r)},Xl.prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),Hp(this,e,t)},Xl.prototype.batchNorm=function(e,t,n,r,a){return this.throwIfDisposed(),Kp(this,e,t,n,r,a)},Xl.prototype.broadcastTo=function(e){return this.throwIfDisposed(),Pm(this,e)},Xl.prototype.cast=function(e){return this.throwIfDisposed(),Af(this,e)};var Rb=wh({ceil_:function(e){var t={x:kh(e,"x","ceil")};return fh.runKernel(tu,t)}});Xl.prototype.ceil=function(){return this.throwIfDisposed(),Rb(this)},Xl.prototype.clipByValue=function(e,t){return this.throwIfDisposed(),$p(this,e,t)},Xl.prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof Xl&&(e=[e]),Jp([this].concat(Fn(e)),t)},Xl.prototype.conv1d=function(e,t,n,r,a,i){return this.throwIfDisposed(),ad(this,e,t,n,r,a,i)},Xl.prototype.conv2dTranspose=function(e,t,n,r,a){return this.throwIfDisposed(),od(this,e,t,n,r,a)},Xl.prototype.conv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),rd(this,e,t,n,r,a,i)},Xl.prototype.cos=function(){return this.throwIfDisposed(),ub(this)},Xl.prototype.cosh=function(){return this.throwIfDisposed(),lb(this)},Xl.prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),Zg(this,e,t,n)};var Ob=wh({depthToSpace_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC",r=kh(e,"x","depthToSpace"),a="NHWC"===n?r.shape[1]:r.shape[2],i="NHWC"===n?r.shape[2]:r.shape[3],o="NHWC"===n?r.shape[3]:r.shape[1];Ho(a*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(a," and ").concat(t,"  for depthToSpace with input shape\n    ").concat(r.shape)})),Ho(i*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(i," and ").concat(t," for depthToSpace with input shape\n        ").concat(r.shape)})),Ho(o%(t*t)===0,(function(){return"Dimension size must be evenly divisible by ".concat(t*t," but is ").concat(o," for depthToSpace with input shape ").concat(r.shape)}));var s={x:r},u={blockSize:t,dataFormat:n};return fh.runKernel(gu,s,u)}});Xl.prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),Ob(this,e,t)},Xl.prototype.depthwiseConv2D=function(e,t,n,r,a,i){return pp("depthwiseConv2D is deprecated, use depthwiseConv2d instead"),this.throwIfDisposed(),ud(this,e,t,n,r,a,i)},Xl.prototype.depthwiseConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),ud(this,e,t,n,r,a,i)};var Fb=wh({dilation2d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=kh(e,"x","dilation2d"),s=kh(t,"filter","dilation2d");Ho(3===o.rank||4===o.rank,(function(){return"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(o.rank,".")})),Ho(3===s.rank,(function(){return"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(s.rank,".")})),Ho("NHWC"===i,(function(){return"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(i)}));var u=o,c=!1;3===o.rank&&(u=Gp(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0);var l={x:u,filter:s},h={strides:n,pad:r,dilations:a},f=fh.runKernel(wu,l,h);return c?Gp(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});Xl.prototype.dilation2d=function(e,t,n,r,a){return this.throwIfDisposed(),Fb(this,e,t,n,r,a)};var Lb=wh({divNoNan_:function(e,t){var n=kh(e,"a","div"),r=kh(t,"b","div"),a=Ct(ah(n,r),2);n=a[0],r=a[1];var i=ld(n,r),o=Dm(i),s=md(r,o);return Mm(s,o,i)}});Xl.prototype.divNoNan=function(e){return this.throwIfDisposed(),Lb(this,e)},Xl.prototype.divStrict=function(e){return this.throwIfDisposed(),kb(this,e)},Xl.prototype.div=function(e){return this.throwIfDisposed(),ld(this,e)};var zb=wh({dot_:function(e,t){var n=kh(e,"t1","dot"),r=kh(t,"t2","dot");Ho((1===n.rank||2===n.rank)&&(1===r.rank||2===r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")}));var a=1===n.rank?n.size:n.shape[1],i=1===r.rank?r.size:r.shape[0];if(Ho(a===i,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+"".concat(a," and ").concat(i,".")})),1===n.rank&&1===r.rank){var o=Gp(n,[1,-1]),s=Gp(r,[-1,1]),u=Jm(o,s);return Gp(u,[])}if(1===n.rank&&2===r.rank){var c=Gp(n,[1,-1]),l=Gp(r,[r.shape[0],r.shape[1]]),h=Jm(c,l);return Gp(h,[h.size])}if(2===n.rank&&1===r.rank){var f=Gp(r,[-1,1]),p=Jm(n,f);return Gp(p,[p.size])}var d=Gp(r,[r.shape[0],r.shape[1]]);return Jm(n,d)}});Xl.prototype.dot=function(e){return this.throwIfDisposed(),zb(this,e)},Xl.prototype.elu=function(){return this.throwIfDisposed(),hd(this)};var Bb=wh({equalStrict_:function(e,t){pp("strict variants of ops have been deprecated and will be removed in future");var n=kh(e,"a","equalStrict"),r=kh(t,"b","equalStrict");return Ko(n.shape,r.shape,"Error in equalStrict: "),md(n,r)}}),Vb=wh({greaterEqualStrict_:function(e,t){pp("strict variants of ops have been deprecated and will be removed in future");var n=kh(e,"a","greaterEqualStrict"),r=kh(t,"b","greaterEqualStrict");return Ko(n.shape,r.shape,"Error in greaterEqualStrict: "),_d(n,r)}}),jb=wh({greaterStrict_:function(e,t){pp("strict variants of ops have been deprecated and will be removed in future");var n=kh(e,"a","greaterStrict"),r=kh(t,"b","greaterStrict");return Ko(n.shape,r.shape,"Error in greaterStrict: "),wd(n,r)}}),qb=wh({lessEqualStrict_:function(e,t){pp("strict variants of ops have been deprecated and will be removed in future");var n=kh(e,"a","lessEqualStrict"),r=kh(t,"b","lessEqualStrict");return Ko(n.shape,r.shape,"Error in lessEqualStrict: "),gv(n,r)}}),Gb=wh({lessStrict_:function(e,t){pp("strict variants of ops have been deprecated and will be removed in future");var n=kh(e,"a","lessStrict"),r=kh(t,"b","lessStrict");return Ko(n.shape,r.shape,"Error in lessStrict: "),Iy(n,r)}}),Wb=wh({notEqualStrict_:function(e,t){pp("strict variants of ops have been deprecated and will be removed in future");var n=kh(e,"a","notEqualStrict"),r=kh(t,"b","notEqualStrict");return Ko(n.shape,r.shape,"Error in notEqualStrict: "),Qd(n,r)}});Xl.prototype.equalStrict=function(e){return this.throwIfDisposed(),Bb(this,e)},Xl.prototype.equal=function(e){return this.throwIfDisposed(),md(this,e)};var Ub=wh({erf_:function(e){var t=kh(e,"x","erf");Ho("int32"===t.dtype||"float32"===t.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===t.dtype&&(t=Af(t,"float32"));var n={x:t};return fh.runKernel(Iu,n)}});Xl.prototype.erf=function(){return this.throwIfDisposed(),Ub(this)},Xl.prototype.exp=function(){return this.throwIfDisposed(),Td(this)},Xl.prototype.expandDims=function(e){return this.throwIfDisposed(),vd(this,e)};var Hb=wh({expm1_:function(e){var t={x:kh(e,"x","expm1")};return fh.runKernel(Mu,t)}});Xl.prototype.expm1=function(){return this.throwIfDisposed(),Hb(this)},Xl.prototype.fft=function(){return this.throwIfDisposed(),zm(this)},Xl.prototype.flatten=function(){return this.throwIfDisposed(),Gp(this,[this.size])},Xl.prototype.floor=function(){return this.throwIfDisposed(),kd(this)},Xl.prototype.floorDiv=function(e){return this.throwIfDisposed(),cd(this,e)},Xl.prototype.gather=function(e,t){return this.throwIfDisposed(),xd(this,e,t)},Xl.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),Vb(this,e)},Xl.prototype.greaterEqual=function(e){return this.throwIfDisposed(),_d(this,e)},Xl.prototype.greaterStrict=function(e){return this.throwIfDisposed(),jb(this,e)},Xl.prototype.greater=function(e){return this.throwIfDisposed(),wd(this,e)},Xl.prototype.ifft=function(){return this.throwIfDisposed(),Vm(this)},Xl.prototype.irfft=function(){return this.throwIfDisposed(),jm(this)};var Kb=wh({isFinite_:function(e){var t={x:kh(e,"x","isFinite")};return fh.runKernel(Hu,t)}});Xl.prototype.isFinite=function(){return this.throwIfDisposed(),Kb(this)};var Xb=wh({isInf_:function(e){var t={x:kh(e,"x","isInf")};return fh.runKernel(Ku,t)}});Xl.prototype.isInf=function(){return this.throwIfDisposed(),Xb(this)};var Yb=wh({isNaN_:function(e){var t={x:kh(e,"x","isNaN")};return fh.runKernel(Xu,t)}});Xl.prototype.isNaN=function(){return this.throwIfDisposed(),Yb(this)},Xl.prototype.leakyRelu=function(e){return this.throwIfDisposed(),Sd(this,e)},Xl.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),qb(this,e)},Xl.prototype.lessEqual=function(e){return this.throwIfDisposed(),gv(this,e)},Xl.prototype.lessStrict=function(e){return this.throwIfDisposed(),Gb(this,e)},Xl.prototype.less=function(e){return this.throwIfDisposed(),Iy(this,e)};var Qb=wh({localResponseNormalization_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,i=kh(e,"x","localResponseNormalization");Ho(4===i.rank||3===i.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(i.rank,".")})),Ho(Jo(t),(function(){return"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(t,".")}));var o=i,s=!1;3===i.rank&&(s=!0,o=Gp(i,[1,i.shape[0],i.shape[1],i.shape[2]]));var u={x:o},c={depthRadius:t,bias:n,alpha:r,beta:a},l=fh.runKernel(ac,u,c);return s?Gp(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});Xl.prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),Qb(this,e,t,n,r)};var $b=wh({logSigmoid_:function(e){var t=kh(e,"x","logSigmoid"),n=kp((function(e){return{value:Yd(km(Yd(e))),gradFunc:function(t){return Id(t,pm(Yd(e)))}}}));return n(t)}});Xl.prototype.logSigmoid=function(){return this.throwIfDisposed(),$b(this)},Xl.prototype.logSoftmax=function(e){return this.throwIfDisposed(),Pd(this,e)},Xl.prototype.logSumExp=function(e,t){return this.throwIfDisposed(),Pv(this,e,t)},Xl.prototype.log=function(){return this.throwIfDisposed(),Cd(this)},Xl.prototype.log1p=function(){return this.throwIfDisposed(),Av(this)},Xl.prototype.logicalAnd=function(e){return this.throwIfDisposed(),Md(this,e)},Xl.prototype.logicalNot=function(){return this.throwIfDisposed(),rb(this)},Xl.prototype.logicalOr=function(e){return this.throwIfDisposed(),Dd(this,e)};var Jb=wh({logicalXor_:function(e,t){var n=kh(e,"a","logicalXor","bool"),r=kh(t,"b","logicalXor","bool");return dd(n.shape,r.shape),Md(Dd(e,t),rb(Md(e,t)))}});Xl.prototype.logicalXor=function(e){return this.throwIfDisposed(),Jb(this,e)},Xl.prototype.matMul=function(e,t,n){return this.throwIfDisposed(),Jm(this,e,t,n)},Xl.prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),Rd(this,e,t,n,r)},Xl.prototype.max=function(e,t){return this.throwIfDisposed(),Ed(this,e,t)},Xl.prototype.maximumStrict=function(e){return this.throwIfDisposed(),xb(this,e)},Xl.prototype.maximum=function(e){return this.throwIfDisposed(),Fd(this,e)},Xl.prototype.mean=function(e,t){return this.throwIfDisposed(),Ld(this,e,t)},Xl.prototype.min=function(e,t){return this.throwIfDisposed(),zd(this,e,t)},Xl.prototype.minimumStrict=function(e){return this.throwIfDisposed(),wb(this,e)},Xl.prototype.minimum=function(e){return this.throwIfDisposed(),Bd(this,e)};var Zb=wh({mirrorPad_:function(e,t,n){Ho("reflect"===n||"symmetric"===n,(function(){return"Invalid mode. Mode must be either reflect or symmetric. "+"Got ".concat(n,".")}));var r=kh(e,"x","mirrorPad");if(0===r.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");Ho(t.length===r.rank,(function(){return"Padding doesn't match input. Must be ".concat(r.rank,". ")+"Got ".concat(t.length,".")}));for(var a="reflect"===n?1:0,i=function(e){Ho(2===t[e].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Ho(t[e][0]>=0&&t[e][0]<=r.shape[e]-a&&t[e][1]>=0&&t[e][1]<=r.shape[e]-a,(function(){return"Padding in dimension ".concat(e," cannot be greater than or equal ")+"to ".concat(r.shape[e]-a," or less than 0 for input of ")+"shape ".concat(r.shape)}))},o=0;o<r.rank;o++)i(o);var s={paddings:t,mode:n},u={x:r};return fh.runKernel(vc,u,s)}});Xl.prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),Zb(this,e,t)},Xl.prototype.modStrict=function(e){return this.throwIfDisposed(),_b(this,e)},Xl.prototype.mod=function(e){return this.throwIfDisposed(),yb(this,e)},Xl.prototype.mulStrict=function(e){return this.throwIfDisposed(),Sb(this,e)},Xl.prototype.mul=function(e){return this.throwIfDisposed(),Id(this,e)},Xl.prototype.neg=function(){return this.throwIfDisposed(),Yd(this)},Xl.prototype.norm=function(e,t,n){return this.throwIfDisposed(),wv(this,e,t,n)},Xl.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),Wb(this,e)},Xl.prototype.notEqual=function(e){return this.throwIfDisposed(),Qd(this,e)},Xl.prototype.oneHot=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.throwIfDisposed(),$d(this,e,t,n)},Xl.prototype.onesLike=function(){return this.throwIfDisposed(),em(this)},Xl.prototype.pad=function(e,t){return this.throwIfDisposed(),tm(this,e,t)};var ek=wh({pool_:function(e,t,n,r,a,i){null==a&&(a=[1,1]),null==i&&(i=1),0===r&&(r="valid");var o=kh(e,"x","maxPool"),s=o,u=!1;3===o.rank&&(u=!0,s=Gp(o,[1,o.shape[0],o.shape[1],o.shape[2]])),Ho(jp(i,a),(function(){return"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(a,"'")}));var c,l=Ap(s.shape,t,i,a,r),h=[l.dilationHeight,l.dilationWidth];c="same"===r?function(e,t){var n=e.map((function(e,n){return e+(e-1)*(t[n]-1)})).map((function(e){return e-1})),r=n.map((function(e){return Math.floor(e/2)})),a=n.map((function(e,t){return e-r[t]}));return n.map((function(e,t){return[r[t],a[t]]}))}([l.filterHeight,l.filterWidth],h):[[0,0],[0,0]];var f=1===h[0]&&1===h[1],p=function(e,t,n){var r=n.map((function(e){return e[0]})),a=n.map((function(e){return e[1]})),i=e.concat(r,a),o=t.map((function(e,t){return(e-i[t]%e)%e})),s=a.map((function(e,t){return e+o[t]})),u=t.map((function(e,t){return[r[t],s[t]]})),c=t.map((function(e,t){return[0,o[t]]}));return[u,c]}([l.inHeight,l.inWidth],h,c),d=Ct(p,2),m=d[0],v=d[1],g=f?r:"valid",y=f?s:Fg(s,h,m),b=("avg"===n?function(){return Wp(y,t,i,g)}:function(){return Rd(y,t,i,g)})(),k=f?b:Hp(b,h,v);return u?Gp(k,[k.shape[1],k.shape[2],k.shape[3]]):k}});Xl.prototype.pool=function(e,t,n,r,a){return this.throwIfDisposed(),ek(this,e,t,n,r,a)},Xl.prototype.powStrict=function(e){return this.throwIfDisposed(),Cb(this,e)},Xl.prototype.pow=function(e){return this.throwIfDisposed(),kv(this,e)},Xl.prototype.prelu=function(e){return this.throwIfDisposed(),nm(this,e)};var tk=wh({prod_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=kh(e,"x","prod");"bool"===r.dtype&&(r=Af(r,"int32"));var a={x:r},i={axis:t,keepDims:n};return fh.runKernel(Pc,a,i)}});Xl.prototype.prod=function(e,t){return this.throwIfDisposed(),tk(this,e,t)};var nk=wh({reciprocal_:function(e){var t={x:kh(e,"x","reciprocal")};return fh.runKernel(Rc,t)}});Xl.prototype.reciprocal=function(){return this.throwIfDisposed(),nk(this)},Xl.prototype.relu=function(){return this.throwIfDisposed(),um(this)},Xl.prototype.relu6=function(){return this.throwIfDisposed(),Gm(this)},Xl.prototype.reshapeAs=function(e){return this.throwIfDisposed(),Gp(this,e.shape)},Xl.prototype.reshape=function(e){return this.throwIfDisposed(),Gp(this,e)},Xl.prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),mv(this,e,t,n)},Xl.prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),vv(this,e,t,n)},Xl.prototype.reverse=function(e){return this.throwIfDisposed(),cm(this,e)},Xl.prototype.rfft=function(){return this.throwIfDisposed(),Bm(this)};var rk=wh({round_:function(e){var t={x:kh(e,"x","round")};return fh.runKernel(Gc,t)}});Xl.prototype.round=function(){return this.throwIfDisposed(),rk(this)},Xl.prototype.rsqrt=function(){return this.throwIfDisposed(),lm(this)},Xl.prototype.selu=function(){return this.throwIfDisposed(),hm(this)},Xl.prototype.separableConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),fm(this,e,t,n,r,a,i)},Xl.prototype.sigmoid=function(){return this.throwIfDisposed(),pm(this)};var ak=wh({sign_:function(e){var t={x:kh(e,"x","sign")};return fh.runKernel($c,t)}});Xl.prototype.sign=function(){return this.throwIfDisposed(),ak(this)},Xl.prototype.sin=function(){return this.throwIfDisposed(),Yg(this)},Xl.prototype.sinh=function(){return this.throwIfDisposed(),$g(this)},Xl.prototype.slice=function(e,t){return this.throwIfDisposed(),dm(this,e,t)},Xl.prototype.softmax=function(e){return this.throwIfDisposed(),bm(this,e)},Xl.prototype.softplus=function(){return this.throwIfDisposed(),km(this)},Xl.prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),Fg(this,e,t)},Xl.prototype.split=function(e,t){return this.throwIfDisposed(),xm(this,e,t)},Xl.prototype.sqrt=function(){return this.throwIfDisposed(),wm(this)},Xl.prototype.square=function(){return this.throwIfDisposed(),Kd(this)},Xl.prototype.squaredDifference=function(e){return this.throwIfDisposed(),Iv(this,e)},Xl.prototype.squaredDifferenceStrict=function(e){return this.throwIfDisposed(),Tb(this,e)},Xl.prototype.squeeze=function(e){return this.throwIfDisposed(),_m(this,e)},Xl.prototype.stack=function(e,t){this.throwIfDisposed();var n=e instanceof Xl?[this,e]:[this].concat(Fn(e));return Sm(n,t)},Xl.prototype.step=function(e){return this.throwIfDisposed(),Wm(this,e)};var ik=wh({stridedSlice_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c=kh(e,"x","stridedSlice"),l={x:c},h={begin:t,end:n,strides:r,beginMask:a,endMask:i,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:u};return fh.runKernel(cl,l,h)}});Xl.prototype.stridedSlice=function(e,t,n,r,a,i,o,s){return this.throwIfDisposed(),ik(this,e,t,n,r,a,i,o,s)},Xl.prototype.subStrict=function(e){return this.throwIfDisposed(),Eb(this,e)},Xl.prototype.sub=function(e){return this.throwIfDisposed(),Ad(this,e)},Xl.prototype.sum=function(e,t){return this.throwIfDisposed(),Nd(this,e,t)};var ok=wh({tan_:function(e){var t={x:kh(e,"x","tan")};return fh.runKernel(ll,t)}});Xl.prototype.tan=function(){return this.throwIfDisposed(),ok(this)},Xl.prototype.tanh=function(){return this.throwIfDisposed(),Cm(this)},Xl.prototype.tile=function(e){return this.throwIfDisposed(),gd(this,e)},Xl.prototype.toBool=function(){return this.throwIfDisposed(),Af(this,"bool")},Xl.prototype.toFloat=function(){return this.throwIfDisposed(),Af(this,"float32")},Xl.prototype.toInt=function(){return this.throwIfDisposed(),Af(this,"int32")};var sk=wh({topk_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=kh(e,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var a=r.shape[r.shape.length-1];if(t>a)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(a,") ")+"but got ".concat(t));var i={x:r},o={k:t,sorted:n},s=fh.runKernel(pl,i,o),u=Ct(s,2),c=u[0],l=u[1];return{values:c,indices:l}}});Xl.prototype.topk=function(e,t){return this.throwIfDisposed(),sk(this,e,t)},Xl.prototype.transpose=function(e){return this.throwIfDisposed(),Rm(this,e)};var uk,ck=wh({unique_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=kh(e,"x","unique","string_or_numeric");Ho(n.rank>0,(function(){return"The input tensor must be at least 1D"}));var r={x:n},a={axis:t},i=fh.runKernel(ml,r,a),o=Ct(i,2),s=o[0],u=o[1];return{values:s,indices:u}}});function lk(){return null==uk&&(uk=fh.backend.epsilon()),uk}function hk(e,t,n){return hk=p()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&l(a,n.prototype),a},hk.apply(null,arguments)}function fk(e){var t="function"===typeof Map?new Map:void 0;return fk=function(e){if(null===e||!function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return hk(e,arguments,f(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),l(n,e)},fk(e)}Xl.prototype.unique=function(e){return this.throwIfDisposed(),ck(this,e)},Xl.prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),hy(this,e,t)},Xl.prototype.unstack=function(e){return this.throwIfDisposed(),Am(this,e)},Xl.prototype.where=function(e,t){return this.throwIfDisposed(),Mm(e,this,t)},Xl.prototype.zerosLike=function(){return this.throwIfDisposed(),Dm(this)};var pk=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),r=t.call(this,e),Object.setPrototypeOf(m(r),n.prototype),r}return c(n)}(fk(Error)),dk=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),r=t.call(this,e),Object.setPrototypeOf(m(r),n.prototype),r}return c(n)}(fk(Error)),mk=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),r=t.call(this,e),Object.setPrototypeOf(m(r),n.prototype),r}return c(n)}(fk(Error)),vk=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),r=t.call(this,e),Object.setPrototypeOf(m(r),n.prototype),r}return c(n)}(fk(Error)),gk=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),r=t.call(this,e),Object.setPrototypeOf(m(r),n.prototype),r}return c(n)}(fk(Error));Error;function yk(e,t){if(Array.isArray(e)){for(var n=[],r=0;r<t;r++)n=n.concat(e);return n}var a=new Array(t);return a.fill(e),a}function bk(e,t){if(!e)throw new gk(t)}function kk(e,t){var n,r=0,a=zo(e);try{for(a.s();!(n=a.n()).done;){n.value===t&&r++}}catch(ZJ){a.e(ZJ)}finally{a.f()}return r}function xk(e){return 1===e.length?e[0]:e}function wk(e){return Array.isArray(e)?e:[e]}function _k(e){var t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==t[0]?t:"private"+t}function Sk(e){return e.length<=1||-1===e.indexOf("_")?e:e.replace(/[_]+(\w|$)/g,(function(e,t){return t.toUpperCase()}))}var Ck={};function Tk(e){if(null===e||void 0===e)return null;var t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function Ek(e){if(null!=e&&"object"===typeof e)if(Array.isArray(e))e.forEach((function(e){return Ek(e)}));else for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t],a=e[r];null!=a&&"object"===typeof a&&(Array.isArray(a)||"ndarray"!==a.type||"number"!==typeof a.value?Ek(a):e[r]=a.value)}}function Ik(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"object",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("string"===typeof e){var i,o=e;if(o in n)i=n[o];else if(o in Ck)i=Ck[o];else if(null==(i=t[o]))throw new mk("Unknown ".concat(r,": ").concat(e,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");return i}var s=e;if(null==s.className||null==s.config)throw new mk("".concat(r,": Improper config format: ")+"".concat(JSON.stringify(s),".\n")+"'className' and 'config' must set.");var u,c,l=s.className;if(l in n){var h=Ct(n[l],2);u=h[0],c=h[1]}else if(l in Ck){var f=Ct(Ck.className,2);u=f[0],c=f[1]}else if(l in t){var p=Ct(t[l],2);u=p[0],c=p[1]}if(null==u)throw new mk("Unknown ".concat(r,": ").concat(l,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");if(null!=c){for(var d={},m=0,v=Object.keys(Ck);m<v.length;m++){var g=v[m];d[g]=Ck[g]}for(var y=0,b=Object.keys(n);y<b.length;y++){var k=b[y];d[k]=n[k]}var x=s.config;x.customObjects=d;for(var w=Object.assign({},Ck),_=0,S=Object.keys(n);_<S.length;_++){var C=S[_];Ck[C]=n[C]}Ek(s.config);var T=c(u,s.config,n,a);return Ck=Object.assign({},w),T}for(var E=Object.assign({},Ck),I=0,A=Object.keys(n);I<A.length;I++){var N=A[I];Ck[N]=n[N]}var P=new u(s.config);return Ck=Object.assign({},E),P}function Ak(e,t){return-1*function(e,t){return e<t?-1:e>t?1:0}(e,t)}function Nk(e){if(null==e)return e;var t,n=[],r=zo(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;-1===n.indexOf(a)&&n.push(a)}}catch(ZJ){r.e(ZJ)}finally{r.f()}return n}function Pk(e){if(null==e)throw new mk("Invalid value in obj: ".concat(JSON.stringify(e)));for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function Mk(e,t,n){if(null!=n&&e.indexOf(n)<0)throw new mk("".concat(n," is not a valid ").concat(t,".  Valid values are ").concat(e," or null/undefined."))}function Dk(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return bk(n>=0),bk(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every((function(e){return typeof e===t}))}function Rk(e,t){Array.isArray(e)?(Ho(e.length>0,(function(){return"".concat(t," is unexpectedly an empty array.")})),e.forEach((function(e,n){return Rk(e,"element ".concat(n+1," of ").concat(t))}))):Ho(Number.isInteger(e)&&e>0,(function(){return"Expected ".concat(t," to be a positive integer, but got ")+"".concat(Ok(e),".")}))}function Ok(e){return null===e?"null":Array.isArray(e)?"["+e.map((function(e){return Ok(e)})).join(",")+"]":"string"===typeof e?'"'.concat(e,'"'):"".concat(e)}function Fk(e){return"relu"===e?"relu":"linear"===e?"linear":"elu"===e?"elu":null}function Lk(e,t){return vp((function(){return wm(Nd(Id(e,e),t,!0))}))}var zk=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"getConfig",value:function(){return{}}}]),n}(lp),Bk=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this)).defaultMaxValue=2,r.defaultAxis=0,r.maxValue=null!=e.maxValue?e.maxValue:r.defaultMaxValue,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return c(n,[{key:"apply",value:function(e){var t=this;return vp((function(){var n=Lk(e,t.axis),r=$p(n,0,t.maxValue);return Id(e,ld(r,Sp(lk(),n)))}))}},{key:"getConfig",value:function(){return{maxValue:this.maxValue,axis:this.axis}}}]),n}(zk);Bk.className="MaxNorm",fp(Bk);var Vk=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this)).defaultAxis=0,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return c(n,[{key:"apply",value:function(e){var t=this;return vp((function(){return ld(e,Sp(lk(),Lk(e,t.axis)))}))}},{key:"getConfig",value:function(){return{axis:this.axis}}}]),n}(zk);Vk.className="UnitNorm",fp(Vk);var jk=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"apply",value:function(e){return um(e)}}]),n}(zk);jk.className="NonNeg",fp(jk);var qk=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this)).defaultMinValue=0,r.defaultMaxValue=1,r.defaultRate=1,r.defaultAxis=0,r.minValue=null!=e.minValue?e.minValue:r.defaultMinValue,r.maxValue=null!=e.maxValue?e.maxValue:r.defaultMaxValue,r.rate=null!=e.rate?e.rate:r.defaultRate,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return c(n,[{key:"apply",value:function(e){var t=this;return vp((function(){var n=Lk(e,t.axis),r=Sp(Id(t.rate,$p(n,t.minValue,t.maxValue)),Id(1-t.rate,n));return Id(e,ld(r,Sp(lk(),n)))}))}},{key:"getConfig",value:function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}]),n}(zk);qk.className="MinMaxNorm",fp(qk);var Gk={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Wk(e){return Tk(e)}function Uk(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Ik(e,hp.getMap().classNameMap,t,"constraint")}function Hk(e){return null==e?null:"string"===typeof e?Uk({className:e in Gk?Gk[e]:e,config:{}}):e instanceof zk?e:Uk(e)}var Kk=["channelsFirst","channelsLast"],Xk=["nearest","bilinear"],Yk=["valid","same","causal"],Qk=["max","avg"],$k=["sum","mul","concat","ave"],Jk=new Map;function Zk(e){Mk(Kk,"DataFormat",e)}function ex(e){Mk(Yk,"PaddingMode",e)}function tx(e){Mk(Qk,"PoolMode",e)}var nx=[];function rx(e,t){nx.push(e);try{var n=t();return nx.pop(),n}catch(r){throw nx.pop(),r}}function ax(e){if(!sx(e))throw new Error("Not a valid tensor name: '"+e+"'");return(0===nx.length?"":nx.join("/")+"/")+e}function ix(e){if(!sx(e))throw new Error("Not a valid tensor name: '"+e+"'");Jk.has(e)||Jk.set(e,0);var t=Jk.get(e);if(Jk.set(e,Jk.get(e)+1),t>0){var n="".concat(e,"_").concat(t);return Jk.set(n,1),n}return e}var ox=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function sx(e){return!!e.match(ox)}function ux(e,t,n){null==t&&(t=0),null==n&&(n=e.length);for(var r=1,a=t;a<n;++a)r*=e[a];return r}function cx(e){return Tm(e=Array.isArray(e)?new Float32Array(e):e)}function lx(e){return zd(cx(e)).dataSync()[0]}function hx(e){return Ed(cx(e)).dataSync()[0]}function fx(e,t){if(t<e)throw new mk("end (".concat(t,") < begin (").concat(e,") is forbidden."));for(var n=[],r=e;r<t;++r)n.push(r);return n}function px(e,t){return e.asType(t)}function dx(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),e.reshape(n)}function mx(e){var t=[ux(e.shape)];return e.reshape(t)}function vx(e,t,n){return vp((function(){switch(e.rank){case 1:return mm(e,t,n);case 2:return vm(e,[t,0],[n,e.shape[1]]);case 3:return gm(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return ym(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return dm(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return dm(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new mk("sliceAlongFirstAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function gx(e,t,n){return vp((function(){switch(e.rank){case 1:return mm(e,t,n);case 2:return vm(e,[0,t],[e.shape[0],n]);case 3:return gm(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return ym(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new mk("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function yx(e,t,n,r){return vp((function(){switch(e.rank){case 1:return mm(e,t,n);case 2:switch(r){case 1:return vx(e,t,n);case 2:return gx(e,t,n);default:throw new mk("The axis is not within the rank of the tensor "+"".concat(r))}case 3:switch(r){case 1:return vx(e,t,n);case 2:return gm(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return gx(e,t,n);default:throw new mk("The axis is not within the rank of the tensor "+"".concat(r))}case 4:switch(r){case 1:return vx(e,t,n);case 2:return ym(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return ym(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return gx(e,t,n);default:throw new mk("The axis is not within the rank of the tensor "+"".concat(r))}default:throw new mk("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function bx(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return n<0&&(n=0!==(t=e[0].rank)?t:0),n===e[0].rank&&(n=-1),Jp(e,n)}function kx(e,t){switch(e.rank){case 1:return Zp([e,t]);case 2:return ed([e,t],0);case 3:return td([e,t],0);case 4:return nd([e,t],0);default:throw new mk("concatAlongFirstAxis() received an unsupported "+"tensor rank: ".concat(e.rank))}}function xx(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new mk("The length of input n (".concat(t.length,") does not match ")+"the number of dimensions in input x (".concat(e.rank,")"));return gd(e,t)}function wx(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;return om(e,t,n,r,a)}function _x(e,t,n,r){if(e.rank<2||t.rank<2)throw new vk("dot requires both inputs to be rank >= 2"+" but got x shape = ".concat(e.shape," and y shape = ").concat(t.shape));if(t.rank>=3&&e.shape.slice(-1)[0]!==t.shape.slice(-2)[0])throw new vk("If rank y >= 3, then the second last dim"+" of y must equal the last dim of x but got x shape = ".concat(e.shape," and ")+" y shape = ".concat(t.shape));if(2===e.rank&&2===t.rank){return Zm({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?Tx(e.rank,r,"channelsLast"):null,activation:n})}var a=e.shape.slice(),i=a.pop();e=e.reshape([-1,i]);var o=t.shape.slice(),s=o.pop(),u=o.pop(),c=[].concat(Fn(o),[s]),l=Array.from({length:t.rank},(function(e,n){return 0===n?t.rank-2:n<=t.rank-2?n-1:n}));t=t.transpose(l).reshape([u,-1]);var h=[].concat(Fn(a),Fn(c));return Zm({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?Tx(e.rank,r,"channelsLast"):null,activation:n}).reshape(h)}function Sx(e,t,n){return vp((function(){return t=Array.isArray(t)?Tm(t,"int32"):t.toInt(),xd(e,t,n)}))}function Cx(e){return Id(e,e)}function Tx(e,t,n){var r=t.shape;if(1!==t.rank&&t.rank!==e)throw new mk("Unexpected bias dimensions: ".concat(t.rank)+"; expected it to be 1 or ".concat(e));if(5===e){if("channelsFirst"===n)return 1===r.length?t.reshape([1,r[0],1,1,1]):t.reshape([1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return 1===r.length?t.reshape([1,1,1,1,r[0]]):t.reshape([1].concat(r))}else if(4===e){if("channelsFirst"===n)return 1===r.length?t.reshape([1,r[0],1,1]):t.reshape([1,r[2],r[0],r[1]]);if("channelsLast"===n)return 1===r.length?t.reshape([1,1,1,r[0]]):t.reshape([1].concat(r))}else if(3===e){if("channelsFirst"===n)return 1===r.length?t.reshape([1,r[0],1]):t.reshape([1,r[1],r[0]]);if("channelsLast"===n)return 1===r.length?t.reshape([1,1,r[0]]):t.reshape([1].concat(r))}else if(e<3)return t;throw new mk("Unsupported input rank by biasAdd: ".concat(t.rank))}function Ex(e,t,n){return vp((function(){return null==n&&(n="channelsLast"),Zk(n),e.add(Tx(e.rank,t,n))}))}function Ix(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1!==t)throw new vk("Support for alpha values other than 1 (".concat(t,") is not implemented ")+"yet.");return hd(e)}function Ax(e,t,n,r){return vp((function(){return Om(e,t,n,r)}))}function Nx(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n?e():t()}var Px=["fanIn","fanOut","fanAvg"],Mx=["normal","uniform","truncatedNormal"];var Dx=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"fromConfigUsesCustomObjects",value:function(){return!1}},{key:"getConfig",value:function(){return{}}}]),n}(lp),Rx=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"apply",value:function(e,t){return Jd(e,t)}}]),n}(Dx);Rx.className="Zeros",fp(Rx);var Ox=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"apply",value:function(e,t){return Zd(e,t)}}]),n}(Dx);Ox.className="Ones",fp(Ox);var Fx=function(e){h(n,e);var t=g(n);function n(e){var r;if(s(this,n),r=t.call(this),"object"!==typeof e)throw new mk("Expected argument of type ConstantConfig but got ".concat(e));if(void 0===e.value)throw new mk("config must have value set but got ".concat(e));return r.value=e.value,r}return c(n,[{key:"apply",value:function(e,t){var n=this;return vp((function(){return Id(xp(n.value),Zd(e,t))}))}},{key:"getConfig",value:function(){return{value:this.value}}}]),n}(Dx);Fx.className="Constant",fp(Fx);var Lx=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this)).DEFAULT_MINVAL=-.05,r.DEFAULT_MAXVAL=.05,r.minval=e.minval||r.DEFAULT_MINVAL,r.maxval=e.maxval||r.DEFAULT_MAXVAL,r.seed=e.seed,r}return c(n,[{key:"apply",value:function(e,t){return sm(e,this.minval,this.maxval,t)}},{key:"getConfig",value:function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}]),n}(Dx);Lx.className="RandomUniform",fp(Lx);var zx=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this)).DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=e.mean||r.DEFAULT_MEAN,r.stddev=e.stddev||r.DEFAULT_STDDEV,r.seed=e.seed,r}return c(n,[{key:"apply",value:function(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new vk("randomNormal does not support dType ".concat(t,"."));return wx(e,this.mean,this.stddev,t,this.seed)}},{key:"getConfig",value:function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}]),n}(Dx);zx.className="RandomNormal",fp(zx);var Bx=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this)).DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=e.mean||r.DEFAULT_MEAN,r.stddev=e.stddev||r.DEFAULT_STDDEV,r.seed=e.seed,r}return c(n,[{key:"apply",value:function(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new vk("truncatedNormal does not support dType ".concat(t,"."));return Im(e,this.mean,this.stddev,t,this.seed)}},{key:"getConfig",value:function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}]),n}(Dx);Bx.className="TruncatedNormal",fp(Bx);var Vx=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this)).gain=null!=e.gain?e.gain:1,r}return c(n,[{key:"apply",value:function(e,t){var n=this;return vp((function(){if(2!==e.length||e[0]!==e[1])throw new mk("Identity matrix initializer can only be used for 2D square matrices.");return Id(n.gain,yd(e[0]))}))}},{key:"getConfig",value:function(){return{gain:this.gain}}}]),n}(Dx);Vx.className="Identity",fp(Vx);var jx=function(e){h(n,e);var t=g(n);function n(e){var r,a;if(s(this,n),r=t.call(this),e.scale<0)throw new mk("scale must be a positive float. Got: ".concat(e.scale));return r.scale=null==e.scale?1:e.scale,r.mode=null==e.mode?"fanIn":e.mode,a=r.mode,Mk(Px,"FanMode",a),r.distribution=null==e.distribution?"normal":e.distribution,function(e){Mk(Mx,"Distribution",e)}(r.distribution),r.seed=e.seed,r}return c(n,[{key:"apply",value:function(e,t){var n=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"channelsLast";if(Zk(r),2===e.length)t=e[0],n=e[1];else if(-1!==[3,4,5].indexOf(e.length)){if("channelsFirst"===r){var a=ux(e,2);t=e[1]*a,n=e[0]*a}else if("channelsLast"===r){var i=ux(e,0,e.length-2);t=e[e.length-2]*i,n=e[e.length-1]*i}}else{var o=ux(e);t=Math.sqrt(o),n=Math.sqrt(o)}return[t,n]}(e),r=n[0],a=n[1],i=this.scale;if("fanIn"===this.mode?i/=Math.max(1,r):"fanOut"===this.mode?i/=Math.max(1,a):i/=Math.max(1,(r+a)/2),"normal"===this.distribution){var o=Math.sqrt(i);if("float32"!==(t=t||"float32")&&"int32"!==t)throw new vk("".concat(this.getClassName()," does not support dType ").concat(t,"."));return Im(e,0,o,t,this.seed)}var s=Math.sqrt(3*i);return sm(e,-s,s,t)}},{key:"getConfig",value:function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}]),n}(Dx);jx.className="VarianceScaling",fp(jx);var qx=function(e){h(n,e);var t=g(n);function n(e){return s(this,n),t.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})}return c(n,[{key:"getClassName",value:function(){return jx.className}}]),n}(jx);qx.className="GlorotUniform",fp(qx);var Gx=function(e){h(n,e);var t=g(n);function n(e){return s(this,n),t.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})}return c(n,[{key:"getClassName",value:function(){return jx.className}}]),n}(jx);Gx.className="GlorotNormal",fp(Gx);var Wx=function(e){h(n,e);var t=g(n);function n(e){return s(this,n),t.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}return c(n,[{key:"getClassName",value:function(){return jx.className}}]),n}(jx);Wx.className="HeNormal",fp(Wx);var Ux=function(e){h(n,e);var t=g(n);function n(e){return s(this,n),t.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}return c(n,[{key:"getClassName",value:function(){return jx.className}}]),n}(jx);Ux.className="HeUniform",fp(Ux);var Hx=function(e){h(n,e);var t=g(n);function n(e){return s(this,n),t.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}return c(n,[{key:"getClassName",value:function(){return jx.className}}]),n}(jx);Hx.className="LeCunNormal",fp(Hx);var Kx=function(e){h(n,e);var t=g(n);function n(e){return s(this,n),t.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}return c(n,[{key:"getClassName",value:function(){return jx.className}}]),n}(jx);Kx.className="LeCunNormal",fp(Kx);var Xx=function(e){h(n,e);var t=g(n);function n(e){var r;if(s(this,n),(r=t.call(this)).DEFAULT_GAIN=1,r.gain=null==e.gain?r.DEFAULT_GAIN:e.gain,r.seed=e.seed,null!=r.seed)throw new vk("Random seed is not implemented for Orthogonal Initializer yet.");return r}return c(n,[{key:"apply",value:function(e,t){var n=this;return vp((function(){if(e.length<2)throw new vk("Shape must be at least 2D.");e[0]*e[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more "+"than 2000 (".concat(e[0]*e[1],") elements: ")+"Slowness may result.");var t=wx(e[0]>e[1]?[e[1],e[0]]:e,0,1,"float32"),r=Dv.gramSchmidt(t);return e[0]>e[1]&&(r=r.transpose()),Id(n.gain,r)}))}},{key:"getConfig",value:function(){return{gain:this.gain,seed:this.seed}}}]),n}(Dx);Xx.className="Orthogonal",fp(Xx);var Yx={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function Qx(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Ik(e,hp.getMap().classNameMap,t,"initializer")}function $x(e){return Tk(e)}function Jx(e){if("string"===typeof e){var t=e in Yx?Yx[e]:e;if("GlorotNormal"===t)return new Gx;if("GlorotUniform"===t)return new qx;if("HeNormal"===t)return new Wx;if("HeUniform"===t)return new Ux;if("LeCunNormal"===t)return new Hx;if("LeCunUniform"===t)return new Kx;var n={};return n.className=t,n.config={},Qx(n)}return e instanceof Dx?e:Qx(e)}var Zx=0;function ew(){return Zx++}var tw={};function nw(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e in tw||(tw[e]=0),tw[e]+=1,e+tw[e].toString()}function rw(e){return Array.isArray(e)&&Array.isArray(e[0])}function aw(e){return 0===e.length?[]:Array.isArray(e[0])?e:[e]}function iw(e){var t;if(Array.isArray(e)){if(1!==e.length)throw new mk("Expected Tensor length to be 1; got ".concat(e.length));t=e[0]}else t=e;return t}function ow(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(1===e.length)return e[0];throw new mk("Expected exactly 1 Shape; got ".concat(e.length))}return e}function sw(e){var t,n=0,r=zo(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;0===a.shape.length?n+=1:n+=a.shape.reduce((function(e,t){return e*t}))}}catch(ZJ){r.e(ZJ)}finally{r.f()}return n}var uw="Variable",cw=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:uw,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;s(this,e),this.dtype=null==n?"float32":n,this.shape=t.shape,this.id=ew(),r=null==r?uw:r,this.originalName=ax(r),this.name=ix(this.originalName),this.trainable_=a,this.constraint=i,this.val=Nm(t,this.trainable_,this.name,this.dtype)}return c(e,[{key:"read",value:function(){return this.assertNotDisposed(),this.val}},{key:"write",value:function(e){return this.assertNotDisposed(),function(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,e),this.val.id!==e.id&&(this.val.assign(e),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}},{key:"dispose",value:function(){this.assertNotDisposed(),this.val.dispose()}},{key:"assertNotDisposed",value:function(){if(this.val.isDisposed)throw new Error("LayersVariable ".concat(this.name," is already disposed."))}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this.trainable_=e,this.val.trainable=e}}]),e}();function lw(e){return e.map((function(e){return e.read()}))}function hw(e){e.forEach((function(e){e[0].write(e[1])}))}var fw=c((function e(t){s(this,e),this.dtype=t.dtype,this.shape=t.shape,null!=t.shape?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}})),pw=c((function e(t,n,r,a,i,o,u){s(this,e),this.dtype=t,this.shape=n,this.sourceLayer=r,this.inputs=a,this.callArgs=i,this.outputTensorIndex=u,this.id=ew(),null!=o&&(this.originalName=ax(o),this.name=ix(this.originalName)),this.rank=n.length})),dw=0,mw=function(){function e(t,n){s(this,e),this.callArgs=n,this.id=dw++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;var r,a=zo(t.inboundLayers);try{for(a.s();!(r=a.n()).done;){var i=r.value;null!=i&&i.outboundNodes.push(this)}}catch(ZJ){a.e(ZJ)}finally{a.f()}t.outboundLayer.inboundNodes.push(this)}return c(e,[{key:"getConfig",value:function(){var e,t=[],n=zo(this.inboundLayers);try{for(n.s();!(e=n.n()).done;){var r=e.value;null!=r?t.push(r.name):t.push(null)}}catch(ZJ){n.e(ZJ)}finally{n.f()}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}]),e}(),vw=0,gw=function(e){h(n,e);var t=g(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s(this,n),(e=t.call(this))._callHook=null,e._addedWeightNames=[],e._stateful=!1,e.id=vw++,e.activityRegularizer=null,e.inputSpec=null,e.supportsMasking=!1,e._trainableWeights=[],e._nonTrainableWeights=[],e._losses=[],e._updates=[],e._built=!1,e.inboundNodes=[],e.outboundNodes=[];var a=r.name;if(!a){var i=e.getClassName();a=_k(i)+"_"+nw(i)}if(e.name=a,e.trainable_=null==r.trainable||r.trainable,null!=r.inputShape||null!=r.batchInputShape){var o;if(null!=r.batchInputShape)o=r.batchInputShape;else if(null!=r.inputShape){var u=null;null!=r.batchSize&&(u=r.batchSize),o=[u].concat(r.inputShape)}e.batchInputShape=o;var c=r.dtype;null==c&&(c=r.inputDType),null==c&&(c="float32"),e.dtype=c}return null!=r.weights?e.initialWeights=r.weights:e.initialWeights=null,e._refCount=null,e.fastWeightInitDuringBuild=!1,e}return c(n,[{key:"getNodeAtIndex",value:function(e,t){if(0===this.inboundNodes.length)throw new dk("The layer has never been called "+"and thus has no defined ".concat(t,"."));if(this.inboundNodes.length<=e)throw new mk("Asked to get ".concat(t," at node ").concat(e,", ")+"but the layer has only ".concat(this.inboundNodes.length," inbound nodes."));return this.inboundNodes[e]}},{key:"getInputAt",value:function(e){return xk(this.getNodeAtIndex(e,"input").inputTensors)}},{key:"getOutputAt",value:function(e){return xk(this.getNodeAtIndex(e,"output").outputTensors)}},{key:"input",get:function(){if(this.inboundNodes.length>1)throw new pk("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new pk("Layer ".concat(this.name)+" is not connected, no input to return.");return xk(this.getNodeAtIndex(0,"input").inputTensors)}},{key:"output",get:function(){if(0===this.inboundNodes.length)throw new pk("Layer ".concat(this.name)+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new pk("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return xk(this.getNodeAtIndex(0,"output").outputTensors)}},{key:"losses",get:function(){return this._losses}},{key:"calculateLosses",value:function(){return this.losses.map((function(e){return e()}))}},{key:"updates",get:function(){return this._updates}},{key:"built",get:function(){return this._built},set:function(e){this._built=e}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this._trainableWeights.forEach((function(t){return t.trainable=e})),this.trainable_=e}},{key:"trainableWeights",get:function(){return this.trainable_?this._trainableWeights.filter((function(e){return e.trainable})):[]},set:function(e){this._trainableWeights=e}},{key:"nonTrainableWeights",get:function(){return this.trainable?this._trainableWeights.filter((function(e){return!e.trainable})).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(e){this._nonTrainableWeights=e}},{key:"weights",get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)}},{key:"stateful",get:function(){return this._stateful}},{key:"resetStates",value:function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}},{key:"assertInputCompatibility",value:function(e){if(e=wk(e),null!=this.inputSpec&&0!==this.inputSpec.length){var t=wk(this.inputSpec);if(e.length!==t.length)throw new mk("Layer ".concat(this.name," expects ").concat(t.length," inputs, ")+"but it received ".concat(e.length," input tensors. ")+"Input received: ".concat(e));for(var n=0;n<e.length;n++){var r=e[n],a=t[n];if(null!=a){var i=r.rank;if(null!=a.ndim&&i!==a.ndim)throw new mk("Input ".concat(n," is incompatible with layer ").concat(this.name,": ")+"expected ndim=".concat(a.ndim,", found ndim=").concat(i));if(null!=a.maxNDim&&i>a.maxNDim)throw new mk("Input ".concat(n," is incompatible with layer ").concat(this.name)+": expected max_ndim=".concat(a.maxNDim,", found ndim=").concat(i));if(null!=a.minNDim&&i<a.minNDim)throw new mk("Input ".concat(n," is incompatible with layer ").concat(this.name)+": expected min_ndim=".concat(a.minNDim,", found ndim=").concat(i,"."));if(null!=a.dtype&&r.dtype!==a.dtype)throw new mk("Input ".concat(n," is incompatible with layer ").concat(this.name," ")+": expected dtype=".concat(a.dtype,", found dtype=").concat(r.dtype,"."));if(a.axes){var o=r.shape;for(var s in a.axes){var u=Number(s),c=a.axes[s],l=u>=0?o[u]:o[o.length+u];if(null!=c&&-1===[c,null].indexOf(l))throw new mk("Input ".concat(n," is incompatible with layer ")+"".concat(this.name,": expected axis ").concat(u," of input shape to ")+"have value ".concat(c," but got shape ").concat(o,"."))}}if(null!=a.shape)for(var h=0;h<a.shape.length;++h){var f=a.shape[h],p=r.shape[h];if(null!=f&&null!=p&&f!==p)throw new mk("Input ".concat(n," is incompatible with layer ")+"".concat(this.name,": expected shape=").concat(a.shape,", ")+"found shape=".concat(r.shape,"."))}}}}}},{key:"call",value:function(e,t){return e}},{key:"invokeCallHook",value:function(e,t){null!=this._callHook&&this._callHook(e,t)}},{key:"setCallHook",value:function(e){this._callHook=e}},{key:"clearCallHook",value:function(){this._callHook=null}},{key:"apply",value:function(e,t){var n=this;t=t||{},this.assertNotDisposed();var r,a=wk(e),i=!0,o=zo(a);try{for(o.s();!(r=o.n()).done;){if(!(r.value instanceof pw)){i=!1;break}}}catch(ZJ){o.e(ZJ)}finally{o.f()}var s,u=!0,c=zo(a);try{for(c.s();!(s=c.n()).done;){if(s.value instanceof pw){u=!1;break}}}catch(ZJ){c.e(ZJ)}finally{c.f()}if(i===u)throw new mk("Arguments to apply() must be all SymbolicTensors or all Tensors");return rx(this.name,(function(){if(!n.built){n.assertInputCompatibility(e);var r,i=[],o=zo(wk(e));try{for(o.s();!(r=o.n()).done;){var s=r.value;i.push(s.shape)}}catch(ZJ){o.e(ZJ)}finally{o.f()}n.build(xk(i)),n.built=!0,n.initialWeights&&n.setWeights(n.initialWeights),null===n._refCount&&u&&(n._refCount=1)}if(n.assertInputCompatibility(e),u){var c,l=n.call(e,t),h=[],f=zo(wk(l));try{for(f.s();!(c=f.n()).done;){var p=c.value;-1!==a.indexOf(p)&&(p=p.clone()),h.push(p)}}catch(ZJ){f.e(ZJ)}finally{f.f()}if(l=xk(h),null!=n.activityRegularizer)throw new vk("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}var d,m=function(e){e=wk(e);var t,n=[],r=zo(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n.push(a.shape)}}catch(ZJ){r.e(ZJ)}finally{r.f()}return xk(n)}(e),v=n.computeOutputShape(m),g="float32";if(n.warnOnIncompatibleInputShape(Array.isArray(e)?m[0]:m),d=null!=v&&v.length>0&&Array.isArray(v[0])?v.map((function(r,a){return new pw(g,r,n,wk(e),t,n.name,a)})):new pw(g,v,n,wk(e),t,n.name),n.addInboundNode(e,d,null,null,m,v,t),n._refCount++,null!=n.activityRegularizer)throw new vk("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return d}))}},{key:"warnOnIncompatibleInputShape",value:function(e){if(null!=this.batchInputShape)if(e.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+"".concat(JSON.stringify(e),") does not match that of the ")+"batchInputShape (".concat(JSON.stringify(this.batchInputShape),") ")+"of the layer ".concat(this.name));else{var t=!1;this.batchInputShape.forEach((function(n,r){null!=n&&null!=e[r]&&e[r]!==n&&(t=!0)})),t&&console.warn("The shape of the input tensor "+"(".concat(JSON.stringify(e),") does not ")+"match the expectation of layer ".concat(this.name,": ")+"".concat(JSON.stringify(this.batchInputShape)))}}},{key:"outputShape",get:function(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new pk("The layer ".concat(this.name," has never been called and thus has no ")+"defined output shape.");var e,t=[],n=zo(this.inboundNodes);try{for(n.s();!(e=n.n()).done;){var r=e.value,a=JSON.stringify(r.outputShapes);-1===t.indexOf(a)&&t.push(a)}}catch(ZJ){n.e(ZJ)}finally{n.f()}if(1===t.length){var i=this.inboundNodes[0].outputShapes;return Array.isArray(i)&&Array.isArray(i[0])&&1===i.length?i[0]:i}throw new pk("The layer ".concat(this.name," has multiple inbound nodes with different ")+'output shapes. Hence the notion of "output shape" is ill-defined for the layer.')}},{key:"countParams",value:function(){if(!this.built)throw new dk("You tried to call countParams() on ".concat(this.name,", ")+"but the layer is not built yet. Build it first by calling build(batchInputShape).");return sw(this.weights)}},{key:"build",value:function(e){this.built=!0}},{key:"getWeights",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return lw(e?this.trainableWeights:this.weights)}},{key:"setWeights",value:function(e){var t=this;vp((function(){var n=t.weights;if(n.length!==e.length)throw new mk('You called setWeights(weights) on layer "'.concat(t.name,'" ')+"with a weight list of length ".concat(e.length,", ")+"but the layer was expecting ".concat(n.length," weights. ")+"Provided weights: ".concat(e,"..."));if(0!==n.length){for(var r=[],a=lw(n),i=0;i<a.length;++i){var o=a[i],s=n[i],u=e[i];if(!$o(o.shape,u.shape))throw new mk("Layer weight shape ".concat(o.shape," ")+"not compatible with provided weight shape ".concat(u.shape));r.push([s,u])}hw(r)}}))}},{key:"addWeight",value:function(e,t,n,r,a,i,o){if(-1!==this._addedWeightNames.indexOf(e))throw new mk("Duplicate weight name ".concat(e," for layer ").concat(this.name));this._addedWeightNames.push(e),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=Jx("zeros"));var s=r.apply(t,n),u=new cw(s,n,e,i,o);return s.dispose(),null!=a&&this.addLoss((function(){return a.apply(u.read())})),null==i&&(i=!0),i?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}},{key:"setFastWeightInitDuringBuild",value:function(e){this.fastWeightInitDuringBuild=e}},{key:"addLoss",value:function(e){var t;null==e||Array.isArray(e)&&0===e.length||(e=wk(e),void 0!==this._losses&&null!==this._losses&&(t=this.losses).push.apply(t,Fn(e)))}},{key:"computeOutputShape",value:function(e){return e}},{key:"computeMask",value:function(e,t){var n=this;if(!this.supportsMasking){if(null!=t){if(!Array.isArray(t))throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.");t.forEach((function(e){if(null!=e)throw new TypeError("Layer ".concat(n.name," does not support masking, ")+"but was passed an inputMask.")}))}return null}return t}},{key:"addInboundNode",value:function(e,t,n,r,a,i){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=wk(e);t=wk(t),n=wk(n),r=wk(r),a=aw(a),i=aw(i);var u,c=[],l=[],h=[],f=zo(s);try{for(f.s();!(u=f.n()).done;){var p=u.value;c.push(p.sourceLayer),l.push(p.nodeIndex),h.push(p.tensorIndex)}}catch(ZJ){f.e(ZJ)}finally{f.f()}new mw({outboundLayer:this,inboundLayers:c,nodeIndices:l,tensorIndices:h,inputTensors:s,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:a,outputShapes:i},o);for(var d=0;d<t.length;d++)t[d].sourceLayer=this,t[d].nodeIndex=this.inboundNodes.length-1,t[d].tensorIndex=d}},{key:"getConfig",value:function(){var e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e}},{key:"disposeWeights",value:function(){return this.weights.forEach((function(e){return e.dispose()})),this.weights.length}},{key:"assertNotDisposed",value:function(){if(0===this._refCount)throw new Error("Layer '".concat(this.name,"' is already disposed."))}},{key:"dispose",value:function(){if(!this.built)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been ")+"built yet.");if(null===this._refCount)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been used ")+"yet.");this.assertNotDisposed();var e=0;return 0===--this._refCount&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}],[{key:"nodeKey",value:function(e,t){return e.name+"_ib-"+t.toString()}}]),n}(lp);function yw(e,t,n){if((null==t||null!=n&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),0===t.inboundNodes.length)return[e];var r=t.inboundNodes[n];if(0===r.inboundLayers.length)return r.inputTensors;for(var a=[],i=0;i<r.inboundLayers.length;i++){var o,s=zo(yw(r.inputTensors[i],r.inboundLayers[i],r.nodeIndices[i]));try{for(s.s();!(o=s.n()).done;){var u=o.value;-1===a.indexOf(u)&&a.push(u)}}catch(ZJ){s.e(ZJ)}finally{s.f()}}return a}var bw,kw=function(e){h(n,e);var t=g(n);function n(e){var r;if(s(this,n),r=t.call(this,{dtype:e.dtype,name:null!=e.name?e.name:nw("input").toString()}),null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),r.trainable=!1,r.built=!0,r.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new mk("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var a=e.batchInputShape;if(null==a){if(null==e.inputShape)throw new mk("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");a=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new mk("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var i=e.dtype||"float32";r.batchInputShape=a,r.dtype=i,r.inputSpec=[{shape:a}];var o=new pw(r.dtype,r.batchInputShape,m(r),[],{},r.name);return o.nodeIndex=0,o.tensorIndex=0,new mw({outboundLayer:m(r),inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[o],outputTensors:[o],inputMasks:[null],outputMasks:[null],inputShapes:[a],outputShapes:[a]}),r}return c(n,[{key:"apply",value:function(e,t){throw new mk("Cannot pass any input to an "+"InputLayer's apply() method. InputLayer name: ".concat(this.name))}},{key:"dispose",value:function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}},{key:"getConfig",value:function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}]),n}(gw);function xw(e){if(null==e.batchShape&&null==e.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new mk("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var t=e.batchShape;null!=e.shape&&null==t&&(t=[null].concat(e.shape));var n=e.dtype;return null==n&&(n="float32"),new kw({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}function ww(e){return _w.apply(this,arguments)}function _w(){return _w=_(x().mark((function e(t){var n,r,a,i,o,s,u,c;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}return e.abrupt("return");case 2:for(i in n=[],r=[],a=[],t)"number"!==typeof(o=t[i])&&(s=o,n.push(s.data()),r.push(i),a.push(s));if(!(n.length>0)){e.next=12;break}return e.next=9,Promise.all(n);case 9:for(u=e.sent,c=0;c<u.length;++c)t[r[c]]=u[c][0];gp(a);case 12:case"end":return e.stop()}}),e)}))),_w.apply(this,arguments)}function Sw(e){if(null!=e)for(var t in e){var n=e[t];"number"!==typeof n&&n.dispose()}}kw.className="InputLayer",fp(kw),function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}(bw||(bw={}));var Cw=function(){function e(){s(this,e),this.validationData=null}return c(e,[{key:"setParams",value:function(e){this.params=e}},{key:"onEpochBegin",value:function(){var e=_(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=_(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchBegin",value:function(){var e=_(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=_(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onTrainBegin",value:function(){var e=_(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrainEnd",value:function(){var e=_(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"setModel",value:function(e){}}]),e}(),Tw=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;s(this,e),null==t&&(t=[]),this.callbacks=t,this.queueLength=n}return c(e,[{key:"append",value:function(e){this.callbacks.push(e)}},{key:"setParams",value:function(e){var t,n=zo(this.callbacks);try{for(n.s();!(t=n.n()).done;){t.value.setParams(e)}}catch(ZJ){n.e(ZJ)}finally{n.f()}}},{key:"setModel",value:function(e){var t,n=zo(this.callbacks);try{for(n.s();!(t=n.n()).done;){t.value.setModel(e)}}catch(ZJ){n.e(ZJ)}finally{n.f()}}},{key:"onEpochBegin",value:function(){var e=_(x().mark((function e(t,n){var r,a,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=zo(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onEpochBegin(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=_(x().mark((function e(t,n){var r,a,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=zo(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onEpochEnd(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchBegin",value:function(){var e=_(x().mark((function e(t,n){var r,a,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=zo(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onBatchBegin(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=_(x().mark((function e(t,n){var r,a,i;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=zo(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onBatchEnd(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onTrainBegin",value:function(){var e=_(x().mark((function e(t){var n,r,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==t&&(t={}),n=zo(this.callbacks),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,a.onTrainBegin(t);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrainEnd",value:function(){var e=_(x().mark((function e(t){var n,r,a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==t&&(t={}),n=zo(this.callbacks),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,a.onTrainEnd(t);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Ew=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.call(this)}return c(n,[{key:"onEpochBegin",value:function(){var e=_(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.seen=0,this.totals={};case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=_(x().mark((function e(t,n){var r,a,i,o=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i in null==n&&(n={}),r=null==n.size?0:n.size,this.seen+=r,a=function(e){var t=n[e];if("number"===typeof t)o.totals.hasOwnProperty(e)||(o.totals[e]=0),o.totals[e]=o.totals[e]+t*r;else{var a;e in o.totals?a=o.totals[e]:o.totals[e]=0;var i=vp((function(){return Sp(o.totals[e],Id(t,r))}));o.totals[e]=i,null!=a&&a.dispose()}},n)a(i);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=_(x().mark((function e(t,n){var r,a,i,o=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n){e.next=19;break}r=zo(this.params.metrics),e.prev=2,i=function(){var e=a.value;if(null==o.totals[e])return"continue";"number"===typeof o.totals[e]?n[e]=o.totals[e]/o.seen:vp((function(){var t=Id(ld(1,o.seen),o.totals[e]);n[e]=t,o.totals[e].dispose(),yp(n[e])}))},r.s();case 5:if((a=r.n()).done){e.next=11;break}if("continue"!==i()){e.next=9;break}return e.abrupt("continue",9);case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),r.e(e.t0);case 16:return e.prev=16,r.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[2,13,16,19]])})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(Cw),Iw=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"onTrainBegin",value:function(){var e=_(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.epoch=[],this.history={};case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=_(x().mark((function e(t,n){var r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r in null==n&&(n={}),this.epoch.push(t),n)null==this.history[r]&&(this.history[r]=[]),this.history[r].push(n[r]);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"syncData",value:function(){var e=_(x().mark((function e(){var t,n,r,a,i,o,s,u,c;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a in t=[],n=[],r=[],this.history)for(i=this.history[a],o=0;o<i.length;++o)"number"!==typeof i[o]&&(s=i[o],t.push(s.data()),n.push(a),r.push(o));return e.next=6,Promise.all(t);case 6:for(u=e.sent,c=0;c<u.length;++c)this.history[n[c]][r[c]].dispose(),this.history[n[c]][r[c]]=u[c][0];case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Cw),Aw=function(e){h(n,e);var t=g(n);function n(e,r){var a;if(s(this,n),(a=t.call(this)).currentEpoch=0,a.yieldEvery=r||"auto","auto"===a.yieldEvery&&(a.yieldEvery=125),"never"===a.yieldEvery&&null!=e.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return hs(a.yieldEvery)&&(a.maybeWait=function(e,t){var n,r=ql();return function(){var a=ql();return a-r<t?n:(r=a,n=e.apply(void 0,arguments))}}(a.maybeWait.bind(m(a)),a.yieldEvery)),a.trainBegin=e.onTrainBegin,a.trainEnd=e.onTrainEnd,a.epochBegin=e.onEpochBegin,a.epochEnd=e.onEpochEnd,a.batchBegin=e.onBatchBegin,a.batchEnd=e.onBatchEnd,a.yield=e.onYield,a}return c(n,[{key:"maybeWait",value:function(){var e=_(x().mark((function e(t,n,r){var a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=[],null==this.yield){e.next=5;break}return e.next=4,ww(r);case 4:a.push(this.yield(t,n,r));case 5:return a.push(Wv()),e.next=8,Promise.all(a);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"onEpochBegin",value:function(){var e=_(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentEpoch=t,null==this.epochBegin){e.next=6;break}return e.next=4,ww(n);case 4:return e.next=6,this.epochBegin(t,n);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=_(x().mark((function e(t,n){var r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],null==this.epochEnd){e.next=5;break}return e.next=4,ww(n);case 4:r.push(this.epochEnd(t,n));case 5:return"epoch"===this.yieldEvery&&r.push(Wv()),e.next=8,Promise.all(r);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchBegin",value:function(){var e=_(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.batchBegin){e.next=5;break}return e.next=3,ww(n);case 3:return e.next=5,this.batchBegin(t,n);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=_(x().mark((function e(t,n){var r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],null==this.batchEnd){e.next=5;break}return e.next=4,ww(n);case 4:r.push(this.batchEnd(t,n));case 5:return"batch"===this.yieldEvery?r.push(Wv()):hs(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,t,n)),e.next=8,Promise.all(r);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onTrainBegin",value:function(){var e=_(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.trainBegin){e.next=5;break}return e.next=3,ww(t);case 3:return e.next=5,this.trainBegin(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrainEnd",value:function(){var e=_(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.trainEnd){e.next=5;break}return e.next=3,ww(t);case 3:return e.next=5,this.trainEnd(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Cw);function Nw(e,t){return null==e&&(e={}),e instanceof Cw?[e]:Array.isArray(e)&&e[0]instanceof Cw?e:wk(e).map((function(e){return new Aw(e,t)}))}var Pw=function(){function e(){s(this,e)}return c(e,null,[{key:"registerCallbackConstructor",value:function(t,n){Ho(t>=0&&Number.isInteger(t),(function(){return"Verbosity level is expected to be an integer >= 0, "+"but got ".concat(t)})),e.checkForDuplicate(n),null==e.constructors[t]&&(e.constructors[t]=[]),e.constructors[t].push(n)}},{key:"checkForDuplicate",value:function(t){for(var n in e.constructors){e.constructors[+n].forEach((function(e){if(e===t)throw new mk("Duplicate callback constructor.")}))}}},{key:"clear",value:function(){e.constructors={}}},{key:"createCallbacks",value:function(t){var n=[];for(var r in e.constructors){var a=+r;t>=a&&n.push.apply(n,Fn(e.constructors[a]))}return n.map((function(e){return new e}))}}]),e}();function Mw(e,t,n,r,a,i,o,s,u){var c=new Iw,l=[new Ew].concat(Fn(Pw.createCallbacks(t)));null!=e&&l.push.apply(l,Fn(e)),l.push(c);var h=new Tw(l);return h.setParams({epochs:n,initialEpoch:r,samples:a,steps:i,batchSize:o,verbose:t,doValidation:s,metrics:u}),{callbackList:h,history:c}}function Dw(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}function Rw(){return Rw="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Dw(e,t);if(r){var a=Object.getOwnPropertyDescriptor(r,t);return a.get?a.get.call(arguments.length<3?e:n):a.value}},Rw.apply(this,arguments)}function Ow(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Ik(e,hp.getMap().classNameMap,t,"layer",n)}function Fw(e,t){return vp((function(){"float32"!==e.dtype&&(e=e.asType("float32"));var n=Nd(Cx(e),t,!0),r=bd(n.shape,lk()),a=wm(Fd(n,r));return ld(e,a)}))}function Lw(e,t){return vp((function(){return Ld(Cx(Ad(t,e)),-1)}))}function zw(e,t){return vp((function(){return Ld(_p(Ad(t,e)),-1)}))}function Bw(e,t){return vp((function(){var n=Ad(e,t),r=$p(_p(e),lk(),Number.MAX_VALUE),a=_p(ld(n,r));return Id(100,Ld(a,-1))}))}function Vw(e,t){return vp((function(){var n=$p(t,lk(),Number.MAX_VALUE),r=Cd(Sp(1,n)),a=$p(e,lk(),Number.MAX_VALUE),i=Cd(Sp(1,a));return Ld(Cx(Ad(r,i)),-1)}))}function jw(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return vp((function(){if(n)t=bm(t);else{var r=Nd(t,t.shape.length-1,!0);t=ld(t,r)}return t=$p(t,lk(),1-lk()),Yd(Nd(Id(e.toFloat(),Cd(t)),t.shape.length-1))}))}function qw(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return vp((function(){var r=kd(mx(e)).toInt(),a=(t=$p(t,lk(),1-lk())).shape;return jw($d(r,a[a.length-1]).reshape(a),t,n)}))}function Gw(e,t){return vp((function(){var n;return n=$p(t,lk(),1-lk()),n=Cd(ld(n,Ad(1,n))),Ld(function(e,t){if(!$o(e.shape,t.shape))throw new mk("logits and labels must have the same shape, but got shapes "+"".concat(JSON.stringify(e.shape)," and ").concat(JSON.stringify(t.shape)));return vp((function(){var n=t.relu(),r=t.abs().neg();return n.sub(t.mul(e)).add(r.exp().log1p())}))}(e,n),-1)}))}function Ww(e,t){return vp((function(){var n=$p(e,lk(),1),r=$p(t,lk(),1);return Nd(Id(e,Cd(ld(n,r))),-1)}))}function Uw(e,t){return vp((function(){var n=Fw(e,-1),r=Fw(t,-1),a=Id(n,r);return Yd(Nd(a,-1))}))}Pw.constructors={};var Hw={meanSquaredError:Lw,meanAbsoluteError:zw,meanAbsolutePercentageError:Bw,meanSquaredLogarithmicError:Vw,squaredHinge:function(e,t){return vp((function(){var n=Fd(0,Ad(1,Id(e,t)));return Ld(Cx(n),-1)}))},hinge:function(e,t){return vp((function(){var n=Fd(0,Ad(1,Id(e,t)));return Ld(n,-1)}))},categoricalHinge:function(e,t){return vp((function(){var n=Nd(Id(e,t),-1),r=Ed(Id(Ad(1,e),t),-1);return Fd(0,Sp(1,Ad(r,n)))}))},logcosh:function(e,t){return vp((function(){var n=Math.log(2),r=Ad(t,e),a=Ad(Sp(r,km(Id(-2,r))),n);return Ld(a,-1)}))},categoricalCrossentropy:jw,sparseCategoricalCrossentropy:qw,binaryCrossentropy:Gw,kullbackLeiblerDivergence:Ww,poisson:function(e,t){return vp((function(){var n=Cd(Sp(lk(),t));return Ld(Ad(t,Id(e,n)),-1)}))},cosineProximity:Uw};function Kw(e){if("string"===typeof e){if(e in Hw)return Hw[e];var t="Unknown loss ".concat(e);throw e.toLowerCase().includes("softmaxcrossentropy")&&(t="Unknown loss ".concat(e,". ")+'Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new mk(t)}return e}function Xw(e,t){return vp((function(){var n=Id(.5,em(t)),r=px(wd(t,n),e.dtype);return Ld(md(e,r),-1)}))}function Yw(e,t){return vp((function(){return px(md(Ep(e,-1),Ep(t,-1)),"float32")}))}function Qw(e,t){return vp((function(){return Md(e.equal(1),t.equal(1)).sum().cast("float32")}))}function $w(e,t){return Gw(e,t)}function Jw(e,t){return e.rank===t.rank&&(e=e.squeeze([e.rank-1])),(t=t.argMax(-1)).dtype!==e.dtype&&(t=t.asType(e.dtype)),md(e,t).asType("float32")}var Zw=jw,e_=qw,t_={binaryAccuracy:Xw,categoricalAccuracy:Yw,precision:function(e,t){return vp((function(){var n=Qw(e,t),r=function(e,t){return vp((function(){return Md(e.equal(0),t.equal(1)).sum().cast("float32")}))}(e,t),a=n.add(r);return Mm(wd(a,0),n.div(a),0).cast("float32")}))},categoricalCrossentropy:Zw,sparseCategoricalCrossentropy:e_,mse:Lw,MSE:Lw,mae:zw,MAE:zw,mape:Bw,MAPE:Bw,cosine:Uw};function n_(e){if("string"===typeof e&&e in t_)return t_[e];if("string"!==typeof e&&null!=e)return e;throw new mk("Unknown metric ".concat(e))}function r_(e){if(bk(null!==e,"Unknown LossOrMetricFn ".concat(e)),"string"===typeof e)return e;for(var t,n=0,r=Object.keys(Hw);n<r.length;n++){var a=r[n];if(Hw[a]===e){t=a;break}}if(void 0!==t)return t;for(var i=0,o=Object.keys(t_);i<o.length;i++){var s=o[i];if(t_[s]===e){t=s;break}}return void 0!==t?t:e.name}var a_=1048576;function i_(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e||"object"!==typeof e||Object.getPrototypeOf(e)!==Object.prototype||!o_(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){var r=JSON.stringify(e);r.length>a_&&console.warn('User-defined metadata of model "'.concat(t,'" is too large in ')+"size (length=".concat(r.length," when serialized). It is not ")+"recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+"".concat(a_,"."))}}function o_(e){if(null===e)return!0;if("object"===typeof e){if(Object.getPrototypeOf(e)===Object.prototype){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];if("string"!==typeof r)return!1;if(!o_(e[r]))return!1}return!0}if(Array.isArray(e)){var a,i=zo(e);try{for(i.s();!(a=i.n()).done;){if(!o_(a.value))return!1}}catch(ZJ){i.e(ZJ)}finally{i.f()}return!0}return!1}var o=typeof e;return"string"===o||"number"===o||"boolean"===o}function s_(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.log,i=c_(e),o=["Layer (type)","Output shape","Param #"];if(i?(t=t||65,n=n||[.45,.85,1]):(t=t||98,n=n||[.33,.55,.67,1]),n[n.length-1]<=1&&(n=n.map((function(e){return Math.floor(t*e)}))),!i)for(var s in o.push("Receives inputs"),r=[],e.nodesByDepth){var u;(u=r).push.apply(u,Fn(e.nodesByDepth[s]))}a("_".repeat(t)),l_(o,n,a),a("=".repeat(t));for(var c=e.layers,l=0;l<c.length;++l)i?h_(c[l],n,a):f_(c[l],n,r,a),a((l===c.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();var h=u_(e),f=sw(e.nonTrainableWeights);a("Total params: ".concat(h+f)),a("Trainable params: ".concat(h)),a("Non-trainable params: ".concat(f)),a("_".repeat(t))}function u_(e){return null!=e.collectedTrainableWeights?sw(e.collectedTrainableWeights):sw(e.trainableWeights)}function c_(e){var t=!0,n=[],r=[];for(var a in e.nodesByDepth)n.push(e.nodesByDepth[a]);for(var i=0,o=n;i<o.length;i++){var s=o[i];if(s.length>1||1===s.length&&s[0].inboundLayers.length>1){t=!1;break}r.push.apply(r,Fn(s))}if(t){var u,c=zo(e.layers);try{for(c.s();!(u=c.n()).done;){var l,h=u.value,f=!1,p=zo(h.inboundNodes);try{for(p.s();!(l=p.n()).done;){var d=l.value;if(-1!==r.indexOf(d)){if(f){t=!1;break}f=!0}}}catch(ZJ){p.e(ZJ)}finally{p.f()}if(!t)break}}catch(ZJ){c.e(ZJ)}finally{c.f()}}return t}function l_(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log,r="",a=0;a<e.length;++a)a>0&&(r=r.slice(0,r.length-1)+" "),r=(r+=e[a]).slice(0,t[a]),r+=" ".repeat(t[a]-r.length);n(r)}function h_(e,t,n){var r;try{r=JSON.stringify(e.outputShape)}catch(ZJ){r="multiple"}var a=e.name,i=e.getClassName();l_(["".concat(a," (").concat(i,")"),r,e.countParams().toString()],t,n)}function f_(e,t,n,r){var a;try{a=JSON.stringify(e.outputShape)}catch(ZJ){a="multiple"}var i,o=[],s=zo(e.inboundNodes);try{for(s.s();!(i=s.n()).done;){var u=i.value;if(!(null!=n&&n.length>0&&-1===n.indexOf(u)))for(var c=0;c<u.inboundLayers.length;++c){var l=u.inboundLayers[c].name,h=u.nodeIndices[c],f=u.tensorIndices[c];o.push("".concat(l,"[").concat(h,"][").concat(f,"]"))}}}catch(ZJ){s.e(ZJ)}finally{s.f()}var p=e.name,d=e.getClassName(),m=0===o.length?"":o[0];l_(["".concat(p," (").concat(d,")"),a,e.countParams().toString(),m],t,r);for(var v=1;v<o.length;++v)l_(["","","",o[v]],t,r)}function p_(e,t,n){return("inboundNodes"===e||"outputLayers"===e||"inputLayers"===e)&&0===t&&"string"===typeof n}function d_(e,t){if(null===e)return null;if("string"===typeof e)return Sk(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){for(var n=[],r=e.length,a=0;a<r;++a){var i=e[a];p_(t,a,i)?n.push(i):n.push(d_(i,t))}return n}for(var o={},s=0,u=Object.keys(e);s<u.length;s++){var c=u[s],l=e[c];if("name"===c&&"string"===typeof l)o[c]=l;else{var h=Sk(c);o[h]=d_(l,h)}}return o}function m_(e,t){if(null===e||void 0===e)return null;if("string"===typeof e)return _k(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){for(var n=[],r=e.length,a=0;a<r;++a){var i=e[a];p_(t,a,i)?n.push(i):n.push(m_(i,t))}return n}for(var o={},s=0,u=Object.keys(e);s<u.length;s++){var c=u[s],l=e[c],h=_k(c);o[h]="name"!==c&&"className"!==c||"string"!==typeof l?m_(l,c):l}return o}var v_="2.8.6";var g_=function(){function e(t){if(s(this,e),this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof e)for(var n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(null==t)return;var r,a=zo(t);try{for(a.s();!(r=a.n()).done;){var i=r.value;this.add(i.key,i.value)}}catch(ZJ){a.e(ZJ)}finally{a.f()}}}return c(e,[{key:"add",value:function(e,t,n){if(null!=this.id2Value[e.id])throw new mk("Duplicate key: name=".concat(e.name,", id=").concat(e.id));return this.id2Value[e.id]=function(e,t){if(null==e.dtype||e.dtype===t.dtype)return t;try{return Af(t,e.dtype)}catch(ZJ){throw new mk("The dtype of the feed (".concat(t.dtype,") can not be cast to the dtype ")+"of the key '".concat(e.name,"' (").concat(e.dtype,")."))}}(e,t),this.name2Id[e.name]=e.id,null!=n&&(this.id2Mask[e.id]=n),this}},{key:"addFeed",value:function(e){this.add(e.key,e.value)}},{key:"hasKey",value:function(e){return null!=this.id2Value[e.id]}},{key:"names",value:function(){return Object.keys(this.name2Id)}},{key:"getValue",value:function(e){if(e instanceof pw){if(null==this.id2Value[e.id])throw new mk("Nonexistent key: ".concat(e.name));return this.id2Value[e.id]}var t=this.name2Id[e];if(null==t)throw new mk("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Value[t]}},{key:"getMask",value:function(e){if(e instanceof pw){if(null==this.id2Value[e.id])throw new mk("Nonexistent key: ".concat(e.name));return this.id2Mask[e.id]}var t=this.name2Id[e];if(null==t)throw new mk("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Mask[t]}},{key:"disposeMasks",value:function(){null!=this.id2Mask&&gp(this.id2Mask)}}]),e}(),y_={},b_={};function k_(e,t,n,r){var a,i=null!=n&&n.training,o=Array.isArray(e),s=o?e:[e],u=s.map((function(e){return e.name})),c=[],l=t.names(),h=zo(u);try{for(h.s();!(a=h.n()).done;){var f=a.value;-1!==l.indexOf(f)?c.push(t.getValue(f)):c.push(null)}}catch(ZJ){h.e(ZJ)}finally{h.f()}null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);var p,d,m=u.join(",")+"|"+t.names().join(",");if(null==y_[m]){var v=function(e,t){Ho(null!=e&&e.length>0,(function(){return"Expected at least one fetch, got none"}));var n=[],r={};if(1===e.length){var a=w_(e[0],t);n=a.sorted,r=a.recipientMap}else{var i,o=new Set,s=zo(e);try{for(s.s();!(i=s.n()).done;){var u,c=w_(i.value,t),l=c.sorted,h=c.recipientMap,f=zo(l);try{for(f.s();!(u=f.n()).done;){var p=u.value;o.has(p.name)||(n.push(p),o.add(p.name))}}catch(ZJ){f.e(ZJ)}finally{f.f()}var d=function(e){null==r[e]&&(r[e]=new Set),h[e].forEach((function(t){return r[e].add(t)}))};for(var m in h)d(m)}}catch(ZJ){s.e(ZJ)}finally{s.f()}}return{sorted:n,recipientCounts:x_(r)}}(s,t);p=v.sorted,d=v.recipientCounts,y_[m]=p,b_[m]=d}p=y_[m],d={},i||Object.assign(d,b_[m]);for(var g=new g_(t),y=0;y<p.length;++y){if(null!=r){var b=mp().numTensors;b>r.maxNumTensors&&(r.maxNumTensors=b),b<r.minNumTensors&&(r.minNumTensors=b)}var k=p[y],x=k.sourceLayer;if(!(x instanceof kw)){var w,_=[],S=[],C=[],T=!1,E=zo(k.inputs);try{for(E.s();!(w=E.n()).done;){var I=w.value,A=g.getValue(I),N=g.getMask(I);_.push(A),S.push(N),null!=N&&(T=!0),i||(d[I.name]--,0!==d[I.name]||t.hasKey(I)||-1!==u.indexOf(I.name)||A.isDisposed||!0===I.sourceLayer.stateful||C.push(A))}}catch(ZJ){E.e(ZJ)}finally{E.f()}T&&((n=n||{}).mask=S[0]);var P=wk(x.apply(_,n)),M=null;x.supportsMasking&&(M=x.computeMask(_,S));for(var D=__(k),R=Array.isArray(D)?D:[D],O=0;O<R.length;++O){g.hasKey(R[O])||g.add(R[O],P[O],Array.isArray(M)?M[0]:M);var F=u.indexOf(R[O].name);-1!==F&&(c[F]=P[O])}i||gp(C)}}return g.disposeMasks(),o?c:c[0]}function x_(e){var t={};for(var n in e)t[n]=e[n].size;return t}function w_(e,t){var n,r=new Set,a=[],i={},o=zo(t.names());try{for(o.s();!(n=o.n()).done;){var s=n.value;r.add(s)}}catch(ZJ){o.e(ZJ)}finally{o.f()}var u=[],c=[];for(u.push(e);u.length>0;){var l=u[u.length-1];if(r.has(l.name))u.pop();else{var h=c[c.length-1]===u.length-1;if(0===l.inputs.length||h)u.pop(),a.push(l),r.add(l.name),h&&c.pop();else{c.push(u.length-1);var f,p=zo(l.inputs);try{for(p.s();!(f=p.n()).done;){var d=f.value;null==i[d.name]&&(i[d.name]=new Set),i[d.name].add(l.name),r.has(d.name)||u.push(d)}}catch(ZJ){p.e(ZJ)}finally{p.f()}}}}return{sorted:a,recipientMap:i}}function __(e){var t;if(1===e.sourceLayer.inboundNodes.length)t=e.sourceLayer.output;else{for(var n=null,r=0;r<e.sourceLayer.inboundNodes.length;++r){var a,i=zo(e.sourceLayer.inboundNodes[r].outputTensors);try{for(i.s();!(a=i.n()).done;){if(a.value.id===e.id){n=r;break}}}catch(ZJ){i.e(ZJ)}finally{i.f()}}t=e.sourceLayer.getOutputAt(n)}return t}var S_=function(e){h(n,e);var t=g(n);function n(e){var r;if(s(this,n),(r=t.call(this,{})).containerNodes=new Set,r.name=e.name,null==r.name){var a=r.getClassName().toLowerCase();r.name=nw(a)}if(r.supportsMasking=!1,r.trainable_=!0,Array.isArray(e.inputs)?r.inputs=e.inputs.slice():r.inputs=[e.inputs],Array.isArray(e.outputs)?r.outputs=e.outputs.slice():r.outputs=[e.outputs],Nk(r.inputs).length!==r.inputs.length)throw new mk("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+"".concat(r.inputs.map((function(e){return e.name}))));Nk(r.outputs).length!==r.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+"".concat(r.outputs.map((function(e){return e.name})))),r.inputLayers=[],r.inputLayersNodeIndices=[],r.inputLayersTensorIndices=[],r.outputLayers=[],r.outputLayersNodeIndices=[],r.outputLayersTensorIndices=[],r.layers=[],r.internalContainerRefs=[];var i,o=zo(r.outputs);try{for(o.s();!(i=o.n()).done;){var u=i.value,c=u.sourceLayer,l=u.nodeIndex,h=u.tensorIndex;r.outputLayers.push(c),r.outputLayersNodeIndices.push(l),r.outputLayersTensorIndices.push(h)}}catch(ZJ){o.e(ZJ)}finally{o.f()}var f,p=zo(r.inputs);try{for(p.s();!(f=p.n()).done;){var d=f.value,v=d.sourceLayer,g=d.nodeIndex,y=d.tensorIndex;bk(0===g,"input layer has >1 nodes"),bk(0===y,"input layer has >1 tensors"),r.inputLayers.push(v),r.inputLayersNodeIndices.push(g),r.inputLayersTensorIndices.push(y)}}catch(ZJ){p.e(ZJ)}finally{p.f()}r.inputNames=[],r.outputNames=[],r.feedInputShapes=[],r.feedInputNames=[],r.feedOutputNames=[];for(var b=0;b<r.inputLayers.length;b++){var k=r.inputLayers[b];if(!(k instanceof kw))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. "+"Received inputs: ".concat(e.inputs,". ")+"Input ".concat(b," (0-based) originates ")+"from layer type ".concat(k.getClassName(),"."));r.inputNames.push(k.name),r.feedInputShapes.push(k.batchInputShape),r.feedInputNames.push(k.name)}var x,w=zo(r.outputLayers);try{for(w.s();!(x=w.n()).done;){var _=x.value;r.outputNames.push(_.name)}}catch(ZJ){w.e(ZJ)}finally{w.f()}r.internalInputShapes=r.inputs.map((function(e){return e.shape})),r.internalOutputShapes=r.outputs.map((function(e){return e.shape}));var S,C={},T={},E={},I={},A={},N=[],P=function e(t,a,i,o,s,u){null!=o&&null!=s&&null!=u||(o=t.sourceLayer,s=t.nodeIndex,u=t.tensorIndex);var c=o.inboundNodes[s];if(-1!==i.indexOf(c))throw new dk("The tensor ".concat(t.name,' at layer "').concat(o.name,'" ')+"is part of a cycle.");if(-1===a.indexOf(c)){r.containerNodes.add(n.nodeKey(o,s)),o.id in A||(A[o.id]=Object.keys(A).length),-1===i.indexOf(c)&&i.push(c);for(var l=c.inboundLayers.length,h=0;h<l;h++){e(c.inputTensors[h],a,i,c.inboundLayers[h],c.nodeIndices[h],c.tensorIndices[h])}for(a.push(c);i.indexOf(c)>=0;)i.splice(i.indexOf(c),1);N.push(c)}},M=[],D=[],R=zo(r.outputs);try{for(R.s();!(S=R.n()).done;){P(S.value,M,D)}}catch(ZJ){R.e(ZJ)}finally{R.f()}var O,F=zo(N.slice().reverse());try{for(F.s();!(O=F.n()).done;){var L=O.value;T[L.id]=L,L.id in C||(C[L.id]=0);var z=C[L.id],B=null==E[L.outboundLayer.id]?0:E[L.outboundLayer.id];z=Math.max(z,B),E[L.outboundLayer.id]=z,I[L.outboundLayer.id]=L.outboundLayer,C[L.id]=z;for(var V=0;V<L.inboundLayers.length;V++){var j=L.inboundLayers[V],q=L.nodeIndices[V],G=j.inboundNodes[q],W=null==C[G.id]?0:C[G.id];C[G.id]=Math.max(z+1,W),T[G.id]=G}}}catch(ZJ){F.e(ZJ)}finally{F.f()}var U={};for(var H in C){var K=C[H];K in U||(U[K]=[]),U[K].push(T[H])}var X={};for(var Y in E){var Q=E[Y];Q in X||(X[Q]=[]),X[Q].push(I[Y])}var $=Object.keys(X).map((function(e){return parseInt(e,10)})).sort(Ak);r.layers=[];var J,Z=zo($);try{for(Z.s();!(J=Z.n()).done;){var ee=X[J.value];ee.sort((function(e,t){var n=A[e.id],r=A[t.id];return n<r?-1:n>r?1:0}));var te,ne=zo(ee);try{for(ne.s();!(te=ne.n()).done;){var re=te.value;re instanceof n&&r.internalContainerRefs.push(re),r.layers.push(re)}}catch(ZJ){ne.e(ZJ)}finally{ne.f()}}}catch(ZJ){Z.e(ZJ)}finally{Z.f()}r.layersByDepth=X,$=Object.keys(U).map((function(e){return parseInt(e,10)})).sort(Ak);var ae,ie=r.inputs.slice(),oe=[],se=zo($);try{for(se.s();!(ae=se.n()).done;){var ue,ce=zo(U[ae.value]);try{for(ce.s();!(ue=ce.n()).done;){var le=ue.value,he=le.outboundLayer;if(null!=he){var fe,pe=zo(le.inputTensors);try{for(pe.s();!(fe=pe.n()).done;){var de=fe.value;if(-1===ie.indexOf(de))throw new dk("Graph disconnected: cannot obtain value for tensor ".concat(de)+' at layer "'.concat(he.name,'". ')+"The following previous layers were accessed without "+"issue: ".concat(oe))}}catch(ZJ){pe.e(ZJ)}finally{pe.f()}var me,ve=zo(le.outputTensors);try{for(ve.s();!(me=ve.n()).done;){var ge=me.value;ie.push(ge)}}catch(ZJ){ve.e(ZJ)}finally{ve.f()}oe.push(he.name)}}}catch(ZJ){ce.e(ZJ)}finally{ce.f()}}}catch(ZJ){se.e(ZJ)}finally{se.f()}r.nodesByDepth=U;var ye,be=r.layers.map((function(e){return e.name})),ke=zo(be);try{var xe=function(){var e=ye.value,t=be.filter((function(t){return t===e})).length;if(1!==t)throw new dk('The name "'.concat(e,'" is used ').concat(t," times ")+"in the model. All layer names should be unique. Layer names: "+JSON.stringify(be))};for(ke.s();!(ye=ke.n()).done;)xe()}catch(ZJ){ke.e(ZJ)}finally{ke.f()}return r.outboundNodes=[],r.inboundNodes=[],new mw({outboundLayer:m(r),inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:r.inputs,outputTensors:r.outputs,inputMasks:r.inputs.map((function(e){return null})),outputMasks:r.outputs.map((function(e){return null})),inputShapes:r.inputs.map((function(e){return e.shape})),outputShapes:r.outputs.map((function(e){return e.shape}))}),r.built=!0,r._refCount=1,r}return c(n,[{key:"assertNotDisposed",value:function(){if(0===this._refCount)throw new Error("Container '".concat(this.name,"' is already disposed."))}},{key:"dispose",value:function(){this.assertNotDisposed();var e={refCountAfterDispose:null,numDisposedVariables:0};if(0===--this._refCount){var t,n=zo(this.layers);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.numDisposedVariables+=r.dispose().numDisposedVariables}}catch(ZJ){n.e(ZJ)}finally{n.f()}var a,i=zo(this.internalContainerRefs);try{for(i.s();!(a=i.n()).done;){var o=a.value;e.numDisposedVariables+=o.dispose().numDisposedVariables}}catch(ZJ){i.e(ZJ)}finally{i.f()}}return e.refCountAfterDispose=this._refCount,e}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this.layers.forEach((function(t){t._trainableWeights.forEach((function(t){return t.trainable=e}))})),this.trainable_=e}},{key:"trainableWeights",get:function(){if(this._trainableWeights.length>0)throw new mk("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];var e,t=[],n=zo(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value;t=t.concat(r.trainableWeights)}}catch(ZJ){n.e(ZJ)}finally{n.f()}return t}},{key:"nonTrainableWeights",get:function(){var e,t=[],n=zo(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,Fn(r.nonTrainableWeights))}}catch(ZJ){n.e(ZJ)}finally{n.f()}if(!this.trainable){var a,i=[],o=zo(this.layers);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.push.apply(i,Fn(s.trainableWeights))}}catch(ZJ){o.e(ZJ)}finally{o.f()}return i.concat(t)}return t}},{key:"weights",get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)}},{key:"loadWeights",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r={},a=0,i=zo(this.layers);try{for(i.s();!(t=i.n()).done;){var o,s=t.value,u=zo(s.weights);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(null!=r[c.originalName])throw new mk("Duplicate weight name: ".concat(c.originalName));r[c.originalName]=c,a++}}catch(ZJ){u.e(ZJ)}finally{u.f()}}}catch(ZJ){i.e(ZJ)}finally{i.f()}var l=[];for(var h in e){var f=h;if(null==r[h]){var p=h.split("/"),d=p.slice(0,-2).concat([p[p.length-1]]);f=d.join("/")}if(null!=r[f])l.push([r[f],e[h]]);else if(n)throw new mk("Provided weight data has no target variable: ".concat(h));delete r[f]}if(n){var m=[];for(var v in r)m.push(v);if(m.length>0)throw new mk("".concat(m.length," of ").concat(a," weights are not set: ")+"".concat(m))}hw(l)}},{key:"updatedConfig",value:function(){var e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion="tfjs-layers ".concat(v_),t.backend="TensorFlow.js",t}},{key:"toJSON",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=m_(this.updatedConfig());return t?JSON.stringify(n):n}},{key:"call",value:function(e,t){var n=this;return vp((function(){e=wk(e);for(var r=new g_,a=0;a<n.inputs.length;++a)r.add(n.inputs[a],e[a]);return k_(n.outputs,r,t)}))}},{key:"computeMask",value:function(e,t){var n=this;return vp((function(){var r;return e=wk(e),r=null==t?yk(null,e.length):wk(t),n.runInternalGraph(e,r)[1]}))}},{key:"computeOutputShape",value:function(e){var t=aw(e);if(t.length!==this.inputLayers.length)throw new mk("Invalid inputShape argument ".concat(e,": ")+"model has ".concat(this.inputLayers.length," tensor inputs."));for(var n={},r=0;r<t.length;r++){var a=this.inputLayers[r],i=t[r];n[a.name+"_0_0"]=i}var o=Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(Ak);if(o.length>1){var s,u=zo(o);try{for(u.s();!(s=u.n()).done;){var c,l=s.value,h=zo(this.nodesByDepth[l]);try{for(h.s();!(c=h.n()).done;){var f=c.value,p=f.outboundLayer;if(-1===this.inputLayers.map((function(e){return e.id})).indexOf(p.id)){for(var d=[],m=0;m<f.inboundLayers.length;m++){var v=f.inboundLayers[m],g=f.nodeIndices[m],y=f.tensorIndices[m],b=n["".concat(v.name,"_").concat(g,"_").concat(y)];d.push(b)}for(var k=aw(p.computeOutputShape(xk(d))),x=p.inboundNodes.indexOf(f),w=0;w<k.length;w++){n["".concat(p.name,"_").concat(x,"_").concat(w)]=k[w]}}}}catch(ZJ){h.e(ZJ)}finally{h.f()}}}catch(ZJ){u.e(ZJ)}finally{u.f()}}for(var _=[],S=[],C=0;C<this.outputLayers.length;C++){var T=this.outputLayers[C],E=this.outputLayersNodeIndices[C],I=this.outputLayersTensorIndices[C],A="".concat(T.name,"_").concat(E,"_").concat(I);S.push(A)}for(var N=0;N<S.length;N++){var P=S[N];bk(P in n),_.push(n[P])}return xk(_)}},{key:"runInternalGraph",value:function(e,t){null==t&&(t=yk(null,e.length));for(var n={},r=0;r<this.inputs.length;++r){var a=this.inputs[r],i=e[r],o=t[r];n[a.id]=[i,o]}var s,u=Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(Ak),c=zo(u);try{for(c.s();!(s=c.n()).done;){var l,h=s.value,f=zo(this.nodesByDepth[h]);try{for(f.s();!(l=f.n()).done;){var p,d=l.value,m=d.outboundLayer,v=d.inputTensors,g=d.outputTensors,y=new Array,b=zo(v);try{for(b.s();!(p=b.n()).done;){var k=p.value;k.id in n&&y.push(n[k.id])}}catch(ZJ){b.e(ZJ)}finally{b.f()}if(y.length===v.length){var x={},w=void 0,_=void 0,S=void 0,C=void 0;if(null!=d.callArgs&&(x=d.callArgs),1===y.length){var T=Ct(y[0],2),E=T[0],I=T[1];null==x.mask&&(x.mask=I),S=wk(m.call(E,x)),C=wk(m.computeMask(E,I)),w=[E],_=[I]}else w=y.map((function(e){return e[0]})),_=y.map((function(e){return e[1]})),null==x.mask&&(x.mask=_),S=wk(m.call(w,x)),C=wk(m.computeMask(w,_));if(m.activityRegularizer)throw new vk("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(var A=0;A<g.length;++A){var N=g[A],P=S[A],M=C[A];n[N.id]=[P,M]}}}}catch(ZJ){f.e(ZJ)}finally{f.f()}}}catch(ZJ){c.e(ZJ)}finally{c.f()}var D,R=[],O=[],F=[],L=zo(this.outputs);try{for(L.s();!(D=L.n()).done;){var z=D.value;bk(z.id in n,"Could not compute output ".concat(z.name," : ").concat(z.id));var B=Ct(n[z.id],2),V=B[0],j=B[1];F.push(V.shape),R.push(V),O.push(j)}}catch(ZJ){L.e(ZJ)}finally{L.f()}return[R,O,F]}},{key:"buildNodeConversionMap",value:function(e){var t,r,a={},i=zo(this.layers);try{for(i.s();!(r=i.n()).done;){var o=r.value;t=o instanceof n?1:0;for(var s=0;s<o.inboundNodes.length;s++){var u=n.nodeKey(o,s);this.containerNodes.has(u)&&(a[u]=t,t+=1)}}}catch(ZJ){i.e(ZJ)}finally{i.f()}return a}},{key:"getLayer",value:function(e,t){if(null!=t){if(this.layers.length<=t)throw new mk("Was asked to retrieve layer at index ".concat(t,", but model only ")+"has ".concat(this.layers.length," layer(s)."));return this.layers[t]}if(null==e)throw new mk("Provide either a layer name or layer index");var n,r=zo(this.layers);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.name===e)return a}}catch(ZJ){r.e(ZJ)}finally{r.f()}throw new mk("No such layer: ".concat(e))}},{key:"calculateLosses",value:function(){var e=this;return vp((function(){var t,r=[],a=zo(e.layers);try{for(a.s();!(t=a.n()).done;)for(var i=t.value,o=0;o<i.inboundNodes.length;++o){var s=n.nodeKey(i,o);e.containerNodes.has(s)&&r.push.apply(r,Fn(i.calculateLosses()))}}catch(ZJ){a.e(ZJ)}finally{a.f()}return r}))}},{key:"getConfig",value:function(){var e,t={name:this.name},r=this.buildNodeConversionMap(this.layers),a=[],i=zo(this.layers);try{for(i.s();!(e=i.n()).done;){for(var o=e.value,s=o.getClassName(),u=o.getConfig(),c=[],l=0;l<o.inboundNodes.length;l++){var h=o.inboundNodes[l],f=n.nodeKey(o,l),p={};if(this.containerNodes.has(f)){if(h.callArgs)try{JSON.stringify(h.callArgs),p=h.callArgs}catch(ZJ){console.warn("Layer ".concat(o.name," was passed ")+"non-serializable keyword arguments: "+"".concat(h.callArgs,". They will not be included ")+"in the serialized model (and thus will be missing at deserialization time)."),p={}}if(h.inboundLayers.length>0){for(var d=[],m=0;m<h.inboundLayers.length;m++){var v=h.inboundLayers[m],g=h.nodeIndices[m],y=h.tensorIndices[m],b=r[n.nodeKey(v,g)];null==b&&(b=0),d.push([v.name,b,y,p])}c.push(d)}}}var k={};k.name=o.name,k.className=s,k.config=u,k.inboundNodes=c,a.push(k)}}catch(ZJ){i.e(ZJ)}finally{i.f()}t.layers=a;for(var x=[],w=0;w<this.inputLayers.length;w++){var _=this.inputLayers[w],S=this.inputLayersNodeIndices[w],C=n.nodeKey(_,S);if(this.containerNodes.has(C)){var T=r[C];null!==T&&void 0!==T||(T=0);var E=this.inputLayersTensorIndices[w];x.push([_.name,T,E])}}t.inputLayers=x;for(var I=[],A=0;A<this.outputLayers.length;A++){var N=this.outputLayers[A],P=this.outputLayersNodeIndices[A],M=n.nodeKey(N,P);if(this.containerNodes.has(M)){var D=r[M];null!==D&&void 0!==D||(D=0);var R=this.outputLayersTensorIndices[A];I.push([N.name,D,R])}}return t.outputLayers=I,t}},{key:"stateful",get:function(){if(this._stateful)throw new mk("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");var e,t=zo(this.layers);try{for(t.s();!(e=t.n()).done;){if(e.value.stateful)return!0}}catch(ZJ){t.e(ZJ)}finally{t.f()}return!1}},{key:"resetStates",value:function(){var e=this;vp((function(){e.layers.forEach((function(e){e.stateful&&e.resetStates()}))}))}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r={},a={};function i(e,t){e.name in a?a[e.name].push(t):a[e.name]=[t]}function o(e,t){var n,a,o=[],s=zo(t);try{for(s.s();!(a=s.n()).done;){var u=a.value,c=u[0],l=u[1],h=u[2];if(n=null==u[3]?{}:u[3],!(c in r))return void i(e,t);var f=r[c];if(f.inboundNodes.length<=l)return void i(e,t);var p=f.inboundNodes[l];o.push(p.outputTensors[h])}}catch(ZJ){s.e(ZJ)}finally{s.f()}o.length>0&&e.apply(xk(o),n)}function s(e){var a=e.name,o=Ow(e,null!=t.customObjects?t.customObjects:{});o.setFastWeightInitDuringBuild(n),r[a]=o,e.inboundNodes.forEach((function(e){if(!(e instanceof Array))throw new mk("Corrupted configuration, expected array for nodeData: ".concat(e));i(o,e)}))}var u,c=t.name,l=t.layers,h=zo(l);try{for(h.s();!(u=h.n()).done;){var f=u.value;s(f)}}catch(ZJ){h.e(ZJ)}finally{h.f()}for(;!Pk(a);){var p,d=zo(l);try{for(d.s();!(p=d.n()).done;){var m=p.value,v=r[m.name];if(v.name in a){var g=a[v.name];delete a[v.name];var y,b=zo(g);try{for(b.s();!(y=b.n()).done;){var k=y.value;o(v,k)}}catch(ZJ){b.e(ZJ)}finally{b.f()}}}}catch(ZJ){d.e(ZJ)}finally{d.f()}}var x,w=[],_=[],S=t.inputLayers,C=zo(S);try{for(C.s();!(x=C.n()).done;){var T=x.value,E=T[0],I=T[1],A=T[2];bk(E in r);var N=r[E],P=N.inboundNodes[I].outputTensors;w.push(P[A])}}catch(ZJ){C.e(ZJ)}finally{C.f()}var M,D=t.outputLayers,R=zo(D);try{for(R.s();!(M=R.n()).done;){var O=M.value,F=O[0],L=O[1],z=O[2];bk(F in r);var B=r[F],V=B.inboundNodes[L].outputTensors;_.push(V[z])}}catch(ZJ){R.e(ZJ)}finally{R.f()}return new e({inputs:w,outputs:_,name:c})}}]),n}(gw);function C_(e,t,n){var r=t.length;if(null==e||Array.isArray(e)&&0===e.length)return t.map((function(e){return null}));if(1===r)return Array.isArray(e)&&1===e.length?e:"object"===typeof e&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error("Provided ".concat(n," is an array of ").concat(e.length," ")+"element(s), but the model has ".concat(r," outputs. ")+"Make sure a set of weights is provided for each model output.");return e}if("object"===typeof e&&Object.keys(e).length>0&&"object"===typeof e[Object.keys(e)[0]]){var a=[];return t.forEach((function(t){t in e?a.push(e[t]):a.push(null)})),a}throw new Error("The model has multiple (".concat(r,") outputs, ")+"so ".concat(n," must be either an array with ")+"".concat(r," elements or an object with ").concat(t," keys. ")+"Provided ".concat(n," not understood: ").concat(JSON.stringify(e)))}function T_(e,t){return C_(e,t,"classWeight")}function E_(e,t,n,r){return I_.apply(this,arguments)}function I_(){return(I_=_(x().mark((function e(t,n,r,a){var i,o,s;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n&&null==a){e.next=2;break}throw new Error("Support sampleWeight is not implemented yet");case 2:if(null==r){e.next=15;break}return i=vp((function(){if(1===t.shape.length)return t.clone();if(2===t.shape.length){if(t.shape[1]>1){return t.argMax(1)}if(1===t.shape[1])return t.reshape([t.shape[0]]);throw new Error("Encountered unexpected last-dimension size (".concat(t.shape[1],") ")+"during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor (".concat(t.rank,") during ")+"handling of class weights. The rank is expected to be 1 or 2.")})),e.t0=Array,e.next=7,i.data();case 7:return e.t1=e.sent,o=e.t0.from.call(e.t0,e.t1),gp(i),s=[],o.forEach((function(e){if(null==r[e])throw new Error("classWeight must contain all classes in the training data. "+"The class ".concat(e," exists in the data but not in ")+"classWeight");s.push(r[e])})),e.abrupt("return",Tm(s,"float32"));case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A_(e,t){return Id(e,t)}function N_(e,t){var n,r,a=t;n=a.xs,r=a.ys,Ho(null!=n&&null!=r,(function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+"".concat(t)}));var i=P_("input",e.inputNames,n),o=P_("output",e.outputNames,r),s=i[0].shape[0];Ho(i.length===e.inputs.length,(function(){return"LayersModel has ".concat(e.inputs.length," inputs, but the dataset ")+"provides ".concat(i.length," inputs.  (Expected input keys: ")+"".concat(JSON.stringify(e.inputNames),")")})),Ho(o.length===e.outputs.length,(function(){return"LayersModel has ".concat(e.outputs.length," outputs, but the dataset ")+"provides ".concat(o.length," outputs.  (Expected output keys: ")+"".concat(JSON.stringify(e.outputNames),")")}));for(var u=function(t){Ho(i[t].shape[0]===s,(function(){return"Batch size mismatch: input "+"".concat(e.inputNames[t]," has ").concat(i[t].shape[0],"; ")+"expected  ".concat(s," based on input ").concat(e.inputNames[0],".")}))},c=0;c<i.length;c++)u(c);for(var l=function(t){Ho(o[t].shape[0]===s,(function(){return"Batch size mismatch: output "+"".concat(e.outputNames[t]," has ").concat(o[t].shape[0],"; ")+"expected  ".concat(s," based on input ").concat(e.inputNames[0],".")}))},h=0;h<o.length;h++)l(h);return{xs:i,ys:o}}function P_(e,t,n){if(n instanceof Xl)return[n];if(Array.isArray(n))return Ho(n.length===t.length,(function(){return"Received an array of ".concat(n.length," Tensors, but expected ").concat(t.length," to match the ").concat(e," keys ").concat(t,".")})),n;var r,a=[],i=zo(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(null==n[o])throw new mk("The feature data generated by the dataset lacks the required "+"".concat(e," key '").concat(o,"'."));a.push(n[o])}}catch(ZJ){i.e(ZJ)}finally{i.f()}return a}function M_(e){if(3===e.length)throw new vk("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}function D_(e,t,n){return R_.apply(this,arguments)}function R_(){return R_=_(x().mark((function e(t,n,r){var a,i,o,s,u,c,l,h,f,p,d,m,v,g,y,b,k,w,_,S,C,T,E,I,A,N,P,M,D,R,O,F,L;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null!=r.batchesPerEpoch,Ho(null!=t.optimizer,(function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."})),Ho(null!=r,(function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."})),Ho(null!=r.epochs&&r.epochs>0&&Number.isInteger(r.epochs),(function(){return"For fitDataset(), config.epochs is expected to be a positive "+"integer, but got ".concat(r.epochs)})),Ho(!a||r.batchesPerEpoch>0&&Number.isInteger(r.batchesPerEpoch),(function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a "+"positive integer if specified, but got ".concat(r.batchesPerEpoch)})),Ho(null==r.validationSplit,(function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."})),!t.isTraining){e.next=8;break}throw new Error("Cannot start training because another fit() call is ongoing.");case 8:return t.isTraining=!0,e.prev=9,(i=null!=r.validationData)&&(F_(r.validationData)?Ho(null==r.validationBatches||r.validationBatches>0&&Number.isInteger(r.validationBatches),(function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, "+"but got ".concat(r.validationBatches)})):(u=M_(r.validationData),o=u.xs,s=u.ys)),c=t.makeTrainFunction(),l=t.getDedupedMetricsNames(),h=i?l.slice().concat(l.map((function(e){return"val_"+e}))):l.slice(),f=Nw(r.callbacks,r.yieldEvery),p=null==r.verbose?1:r.verbose,d=Mw(f,p,r.epochs,null,null,O_(n,r),null,i,h),m=d.callbackList,v=d.history,m.setModel(t),t.history=v,e.next=22,m.onTrainBegin();case 22:return t.stopTraining_=!1,g=null==r.initialEpoch?0:r.initialEpoch,e.next=26,n.iterator();case 26:y=e.sent;case 27:if(!(g<r.epochs)){e.next=98;break}return b={},e.next=31,m.onEpochBegin(g);case 31:if(k=0,w=0,a){e.next=37;break}return e.next=36,n.iterator();case 36:y=e.sent;case 37:if(a&&!(k<r.batchesPerEpoch)){e.next=91;break}return e.next=40,y.next();case 40:if(_=e.sent,!a||!_.done){e.next=44;break}return console.warn("You provided `batchesPerEpoch` as "+"".concat(r.batchesPerEpoch,", ")+"but your dataset iterator ran out of data after "+"".concat(k," batches; ")+"interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+"".concat(r.batchesPerEpoch*r.epochs," batches). ")+"You may need to use the repeat() function when building your dataset."),e.abrupt("break",91);case 44:if(null==_.value){e.next=73;break}return S=N_(t,_.value),C=S.xs,T=S.ys,(E={}).batch=w,E.size=C[0].shape[0],e.next=51,m.onBatchBegin(w,E);case 51:if(I=[],null==r.classWeight){e.next=64;break}A=T_(r.classWeight,t.outputNames),N=0;case 55:if(!(N<A.length)){e.next=64;break}return e.t0=I,e.next=59,E_(T[N],null,A[N]);case 59:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 61:++N,e.next=55;break;case 64:for(P=C.concat(T).concat(I),M=c(P),gp(P),D=0;D<l.length;++D)R=l[D],O=M[D],E[R]=O,yp(O);return e.next=70,m.onBatchEnd(w,E);case 70:Sw(E),w++,k++;case 73:if(!(a?k>=r.batchesPerEpoch:_.done)){e.next=87;break}if(!i){e.next=86;break}if(F=void 0,!F_(r.validationData)){e.next=84;break}return e.t2=wk,e.next=80,t.evaluateDataset(r.validationData,{batches:r.validationBatches});case 80:e.t3=e.sent,F=(0,e.t2)(e.t3),e.next=85;break;case 84:F=wk(t.evaluate(o,s,{batchSize:null==r.validationBatchSize?32:r.validationBatchSize,verbose:0}));case 85:for(L=0;L<t.metricsNames.length;++L)b["val_".concat(t.metricsNames[L])]=F[L];case 86:return e.abrupt("break",91);case 87:if(!t.stopTraining_){e.next=89;break}return e.abrupt("break",91);case 89:e.next=37;break;case 91:return e.next=93,m.onEpochEnd(g,b);case 93:if(g++,!t.stopTraining_){e.next=96;break}return e.abrupt("break",98);case 96:e.next=27;break;case 98:return e.next=100,m.onTrainEnd();case 100:return e.next=102,t.history.syncData();case 102:return e.abrupt("return",t.history);case 103:return e.prev=103,t.isTraining=!1,e.finish(103);case 106:case"end":return e.stop()}}),e,null,[[9,,103,106]])}))),R_.apply(this,arguments)}function O_(e,t){var n=null;return null!=t.batchesPerEpoch?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}function F_(e){return"function"===typeof e.iterator}function L_(e){return"function"===typeof e.next}function z_(e,t,n){return B_.apply(this,arguments)}function B_(){return B_=_(x().mark((function e(t,n,r){var a,i,o,s,u,c,l,h,f;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null!=(r=r||{}).batches,i=t.testFunction,o=[],!(r.verbose>0)){e.next=6;break}throw new vk("Verbose mode is not implemented yet.");case 6:if(Ho(!a||r.batches>0&&Number.isInteger(r.batches),(function(){return"Test loop expects `batches` to be a positive integer, but "+"received ".concat(JSON.stringify(r.batches))})),!L_(n)){e.next=11;break}e.t0=n,e.next=14;break;case 11:return e.next=13,n.iterator();case 13:e.t0=e.sent;case 14:s=e.t0,u=0,c=0,l=x().mark((function e(){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.next();case 2:if(n=e.sent,o=vp((function(){return n.value&&function(){var e=N_(t,n.value),r=e.xs,a=e.ys,s=r.concat(a),l=vp((function(){return i(s)}));if(gp(s),0===c)for(var h=0;h<l.length;++h)o.push(xp(0));for(var f=s[0].shape[0],p=function(e){var t=l[e],n=o[e];o[e]=vp((function(){return Sp(o[e],Id(f,t))})),c>0&&gp(n)},d=0;d<l.length;++d)p(d);gp(l),u+=f,++c}(),o})),!n.done){e.next=7;break}return a&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` "+"batches (in this case, ".concat(r.batches," batches). ")+"You may need to use the repeat() function when building your dataset."),e.abrupt("return","break");case 7:case"end":return e.stop()}}),e)}));case 18:if(a&&!(c<r.batches)){e.next=25;break}return e.delegateYield(l(),"t1",20);case 20:if("break"!==e.t1){e.next=23;break}return e.abrupt("break",25);case 23:e.next=18;break;case 25:for(h=0;h<o.length;++h)f=o[h],o[h]=ld(o[h],u),gp(f);return e.abrupt("return",xk(o));case 27:case"end":return e.stop()}}),e)}))),B_.apply(this,arguments)}function V_(e){Ho(e>0&&Number.isInteger(e),(function(){return"batchSize is required to be a positive integer, but got ".concat(e)}))}function j_(e,t,n){return null==e?[null]:Array.isArray(e)?e.map((function(e){return vx(e,t,n-t)})):vx(e,t,n-t)}function q_(e,t){return vp((function(){return null==e?null:Array.isArray(e)?e.map((function(e){return q_(e,t)})):Sx(e,"int32"===t.dtype?t:t.toInt())}))}function G_(e,t){for(var n=[],r=0,a=null;r<e;)(a=r+t)>=e&&(a=e),n.push([r,a]),r=a;return n}function W_(e,t,n,r,a,i,o,s,u,c,l,h,f,p,d){return U_.apply(this,arguments)}function U_(){return U_=_(x().mark((function e(t,n,r,a,i,o,s,u,c,l,h,f,p,d,m){var v,g,y,b,k,w,_,S;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==i&&(i=32),null==o&&(o=1),null==h&&(h=!0),null==p&&(p=0),v=!1,null!=c&&null!=l&&(v=!0),null==m){e.next=10;break}if(v=!0,null!=d){e.next=10;break}throw new mk("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");case 10:return null!=(g=t.checkNumSamples(r,i,d,"steps_per_epoch"))&&(y=fx(0,g)),null==s&&(s=1),b=Mw(u,s,o,p,g,d,i,v,f),k=b.callbackList,w=b.history,k.setModel(t),t.history=w,e.next=18,k.onTrainBegin();case 18:t.stopTraining_=!1,_=x().mark((function e(o){var s;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.onEpochBegin(o);case 2:if(s={},null==d){e.next=7;break}throw new vk("stepsPerEpoch mode is not implemented yet.");case 7:return e.delegateYield(x().mark((function e(){var o,u,f,p;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("batch"!==h){e.next=4;break}throw new vk("batch shuffling is not implemneted yet");case 4:h&&qo(y);case 5:o=Tm(y),u=G_(g,i),f=x().mark((function e(h){var f;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f={},e.next=3,k.onBatchBegin(h,f);case 3:return vp((function(){var e=u[h][0],p=u[h][1],d=vx(o,e,p-e);f.batch=h,f.size=p-e;for(var m=q_(r,d),g=n(m),y=0;y<a.length;++y){var b=a[y],k=g[y];f[b]=k,yp(k)}if(h===u.length-1&&v)for(var x=t.testLoop(c,l,i),w=0;w<a.length;++w){var _=a[w],S=x[w];yp(S),s["val_"+_]=S}})),e.next=6,k.onBatchEnd(h,f);case 6:if(Sw(f),!t.stopTraining_){e.next=9;break}return e.abrupt("return","break");case 9:case"end":return e.stop()}}),e)})),p=0;case 9:if(!(p<u.length)){e.next=17;break}return e.delegateYield(f(p),"t0",11);case 11:if("break"!==e.t0){e.next=14;break}return e.abrupt("break",17);case 14:++p,e.next=9;break;case 17:o.dispose();case 18:case"end":return e.stop()}}),e)}))(),"t0",8);case 8:return e.next=10,k.onEpochEnd(o,s);case 10:if(!t.stopTraining_){e.next=12;break}return e.abrupt("return","break");case 12:case"end":return e.stop()}}),e)})),S=p;case 21:if(!(S<o)){e.next=29;break}return e.delegateYield(_(S),"t0",23);case 23:if("break"!==e.t0){e.next=26;break}return e.abrupt("break",29);case 26:++S,e.next=21;break;case 29:return e.next=31,k.onTrainEnd();case 31:return e.next=33,t.history.syncData();case 33:return e.abrupt("return",t.history);case 34:case"end":return e.stop()}}),e)}))),U_.apply(this,arguments)}function H_(e,t,n){return K_.apply(this,arguments)}function K_(){return K_=_(x().mark((function e(t,n,r){var a,i,o,s,u,c,l,h,f,p,d,m,v,g,y,b,k,w,_,S,C,T,E,I,A=arguments;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=A.length>3&&void 0!==A[3]?A[3]:{},!t.isTraining){e.next=3;break}throw new Error("Cannot start training because another fit() call is ongoing.");case 3:return t.isTraining=!0,e.prev=4,V_(f=null==a.batchSize?32:a.batchSize),p=!1,e.next=10,t.standardizeUserData(n,r,a.sampleWeight,a.classWeight,p,f);case 10:if(d=e.sent,i=d[0],o=d[1],h=d[2],m=!1,!(null!=a.validationData&&a.validationData.length>0)){e.next=36;break}if(m=!0,2!==a.validationData.length){e.next=22;break}s=a.validationData[0],u=a.validationData[1],e.next=27;break;case 22:if(3!==a.validationData.length){e.next=26;break}throw new vk("validationData including sample weights is not supported yet.");case 26:throw new mk("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+"".concat(a.validationData," is invalid."));case 27:return g=!0,e.next=30,t.standardizeUserData(s,u,null,null,g,f);case 30:y=e.sent,c=y[0],l=y[1],v=c.concat(l),e.next=37;break;case 36:null!=a.validationSplit&&a.validationSplit>0&&a.validationSplit<1?(m=!0,b=Math.floor(i[0].shape[0]*(1-a.validationSplit)),k=i[0].shape[0],c=j_(i,b,k),i=j_(i,0,b),l=j_(o,b,k),o=j_(o,0,b),v=c.concat(l)):null!=a.validationSteps&&(m=!0);case 37:return w=i.concat(o).concat(h),t.checkTrainableWeightsConsistency(),_=t.makeTrainFunction(),S=t.getDedupedMetricsNames(),m?(t.makeTestFunction(),C=t.testFunction,T=S.slice().concat(S.map((function(e){return"val_"+e})))):(C=null,v=[],T=S.slice()),E=Nw(a.callbacks,a.yieldEvery),e.next=45,W_(t,_,w,S,f,a.epochs,a.verbose,E,C,v,a.shuffle,T,a.initialEpoch,null,null);case 45:return I=e.sent,e.abrupt("return",I);case 47:return e.prev=47,t.isTraining=!1,Y_(i,n),Y_(o,r),Y_(c,s),Y_(l,u),null!=h&&gp(h),e.finish(47);case 55:case"end":return e.stop()}}),e,null,[[4,,47,55]])}))),K_.apply(this,arguments)}function X_(e){var t=[];e instanceof Xl&&(e=[e]);for(var n=0;n<e.length;++n){var r=e[n];if(1===r.rank)t.push(dx(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function Y_(e,t){if(null!=e){var n=[];if(t instanceof Xl)n.push(t.id);else if(Array.isArray(t))t.forEach((function(e){return n.push(e.id)}));else if(null!=t)for(var r in t){var a=t[r];n.push(a.id)}var i=[];if(e instanceof Xl)-1===n.indexOf(e.id)&&i.push(e);else if(Array.isArray(e))e.forEach((function(e){-1===n.indexOf(e.id)&&i.push(e)}));else if(null!=e)for(var o in e){var s=e[o];-1===n.indexOf(s.id)&&i.push(s)}i.forEach((function(e){e.isDisposed||e.dispose()}))}}function Q_(e){return Array.isArray(e)}function $_(e){return!function(e){return e instanceof Xl}(e)&&!Q_(e)}function J_(e,t,n){var r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(null==t||0===t.length){if(null!=e){var o=!1;if(Q_(e)&&e.length>0)o=!0;else if($_(e)){for(var s in e)if(e.hasOwnProperty(s)){o=!0;break}}else o=!0;if(o)throw new mk("Error when checking model ".concat(i," expected no data, ")+"but got ".concat(e))}return[]}if(null==e)return t.map((function(e){return null}));if($_(e)){r=[];var u,c=zo(t);try{for(c.s();!(u=c.n()).done;){var l=u.value;if(null==e[l])throw new mk('No data provided for "'.concat(l,'". Need data for each key in: ')+"".concat(t));r.push(e[l])}}catch(ZJ){c.e(ZJ)}finally{c.f()}}else if(Q_(e)){if(e.length!==t.length)throw new mk("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"model expected. Expected to see ".concat(t.length," Tensor(s), but ")+"instead got the following list of Tensor(s): ".concat(e));r=e}else{if(t.length>1)throw new mk("The model ".concat(i," expects ").concat(t.length," Tensor(s), ")+"but only received one Tensor. Found: Tensor with shape ".concat(e.shape));r=[e]}if(r=X_(r),null!=n)for(var h=0;h<t.length;++h)if(null!=n[h]){var f=r[h];if(f.shape.length!==n[h].length)throw new mk("Error when checking ".concat(i,": expected ").concat(t[h]," ")+"to have ".concat(n[h].length," dimension(s). but got array with ")+"shape ".concat(f.shape));for(var p=0;p<n[h].length;++p)if(0!==p||a){var d=f.shape[p],m=n[h][p];if(null!=m&&m>=0&&d!==m)throw new mk("Error when checking ".concat(i,": expected ").concat(t[h]," ")+"to have shape [".concat(n[h],"], but got array with shape ")+"[".concat(f.shape,"]."))}}return r}function Z_(e,t,n){var r=Nk(e.map((function(e){return e.shape[0]})));r.sort();var a=Nk(t.map((function(e){return e.shape[0]})));if(a.sort(),r.length>1)throw new mk("All input Tensors (x) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(e.map((function(e){return e.shape})))));if(a.length>1)throw new mk("All target Tensors (y) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(t.map((function(e){return e.shape})))));if(r.length>0&&a.length>0&&!$o(r,a))throw new mk("Input Tensors should have the same number of samples as target "+"Tensors. Found ".concat(r[0]," input sample(s) and ").concat(a[0]," target ")+"sample(s).")}function eS(e,t,n){for(var r=[Lw,Gw,jw],a=0;a<e.length;++a){var i=e[a],o=t[a],s=n[a];if(null!=o){if(o===jw&&1===i.shape[i.shape.length-1])throw new mk("You are passing a target array of shape ".concat(i.shape," while using ")+"a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==r.indexOf(o))for(var u=i.shape.slice(1),c=s.slice(1),l=0;l<u.length;++l){var h=u[l],f=c[l];if(null!=f&&h!==f)throw new mk("A target Tensor with shape ".concat(i.shape," was passed for an ")+"output of shape ".concat(s,", while using a loss function that ")+"expects targets to have the same shape as the output.")}}}}function tS(e,t,n){var r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(Array.isArray(e)){if(e.length!==t.length)throw new mk("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"the model expected. Expected to see ".concat(t.length," Tensor(s),")+" but instead got ".concat(e.length," Tensors(s)."));r=e}else{if(t.length>1)throw new mk("The model expects ".concat(t.length," ").concat(i," Tensors, ")+"but only received one Tensor. Found: array with shape "+"".concat(JSON.stringify(e.shape),"."));r=[e]}if(null!=n)for(var o=0;o<t.length;++o)if(null!=n[o]){var s=r[o];if(s.shape.length!==n[o].length)throw new mk("Error when checking ".concat(i,": expected ").concat(t[o]," ")+"to have ".concat(n[o].length," dimension(s), but got array with ")+"shape ".concat(JSON.stringify(s.shape)));for(var u=0;u<n[o].length;++u)if(0!==u||a){var c=s.shape[u],l=n[o][u];if(null!=l&&l!==c)throw new mk("Error when checking ".concat(i,": expected ")+"".concat(t[o]," to have shape ").concat(JSON.stringify(n[o])," but ")+"got array with shape ".concat(JSON.stringify(s.shape),"."))}}}var nS=function(t){h(r,t);var n=g(r);function r(e){var t;return s(this,r),(t=n.call(this,e)).isTraining=!1,t}return c(r,[{key:"summary",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;if(!this.built)throw new mk("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");s_(this,e,t,n)}},{key:"compile",value:function(e){var t=this;if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"===typeof e.optimizer)this.optimizer_=function(e){var t={Adagrad:function(){return qv.adagrad(.01)},Adadelta:function(){return qv.adadelta(1,.95,lk())},Adam:function(){return qv.adam(.001,.9,.999,lk())},Adamax:function(){return qv.adamax(.002,.9,.999,lk(),0)},RMSProp:function(){return qv.rmsprop(.001,.9,0,lk())},SGD:function(){return qv.sgd(.01)}};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new mk("Unknown Optimizer ".concat(e))}(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof wp))throw new mk("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}var n=[];if(Array.isArray(e.loss)||"string"===typeof e.loss||"function"===typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new mk("When passing an Array as loss, it should have one entry per "+"model output. The model has ".concat(this.outputs.length," output(s), ")+"but you passed loss=".concat(e.loss,"."));var r=e.loss;n=r.map((function(e){return Kw(e)}))}else{var a=Kw(e.loss);this.outputs.forEach((function(e){n.push(a)}))}else{for(var i in e.loss=e.loss,e.loss)if(-1===this.outputNames.indexOf(i))throw new mk('Unknown entry in loss dictionary: "'.concat(i,'". ')+"Only expected the following keys: ".concat(this.outputNames));var o,s=zo(this.outputNames);try{for(s.s();!(o=s.n()).done;){var u=o.value;null==e.loss[u]&&console.warn('Output "'.concat(u,'" is missing from loss dictionary. We assume ')+"this was done on purpose, and we will not be expecting data "+"to be passed to ".concat(u," during training")),n.push(Kw(e.loss[u]))}}catch(ZJ){s.e(ZJ)}finally{s.f()}}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var c=0;c<this.outputs.length;++c){var l=this.internalOutputShapes[c],h=this.outputNames[c];this.feedOutputNames.push(h),this.feedOutputShapes.push(l),this.feedLossFns.push(this.lossFunctions[c])}var f=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],rx("loss",(function(){for(var e=0;e<t.outputs.length;++e)if(-1===f.indexOf(e)){var n=t.lossFunctions[e];t.outputs.length>1&&(t.metricsTensors.push([n,e]),t.metricsNames.push(t.outputNames[e]+"_loss"))}}));var p=function(e,t){if(null==e||Array.isArray(e)&&0===e.length)return t.map((function(e){return[]}));var n;if("string"===typeof e||"function"===typeof e)n=[e];else{if(!Array.isArray(e)&&"object"!==typeof e)throw new TypeError("Type of metrics argument not understood. Expected an string,"+"function, Array, or Object, found: ".concat(e));n=e}if(Array.isArray(n))return t.map((function(e){return n}));var r,a=[],i=zo(t);try{for(i.s();!(r=i.n()).done;){var o=r.value,s=n.hasOwnProperty(o)?n[o]:[];Array.isArray(s)||(s=[s]),a.push(s)}}catch(ZJ){i.e(ZJ)}finally{i.f()}return a}(e.metrics,this.outputNames),d=function(e,n,r){t.outputNames.length>1&&(n=t.outputNames[e]+"_"+n),t.metricsNames.push(n),t.metricsTensors.push([r,e])};rx("metric",(function(){for(var e=function(e){if(-1!==f.indexOf(e))return"continue";!function(n){var r,a,i,o,s=zo(n);try{for(s.s();!(o=s.n()).done;){var u=o.value;if("string"===typeof u&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(u)){var c=t.internalOutputShapes[e];1===c[c.length-1]||t.lossFunctions[e]===Gw?-1!==["accuracy","acc"].indexOf(u)?a=Xw:-1!==["crossentropy","ce"].indexOf(u)&&(a=$w):t.lossFunctions[e]===qw?-1!==["accuracy","acc"].indexOf(u)?a=Jw:-1!==["crossentropy","ce"].indexOf(u)&&(a=e_):-1!==["accuracy","acc"].indexOf(u)?a=Yw:-1!==["crossentropy","ce"].indexOf(u)&&(a=Zw);var l=void 0;-1!==["accuracy","acc"].indexOf(u)?l="acc":-1!==["crossentropy","ce"].indexOf(u)&&(l="ce"),i=a,r=""+l}else{var h=n_(u);i=h,r=""+r_(u)}var f=void 0;rx(r,(function(){f=i})),d(e,r,f)}}catch(ZJ){s.e(ZJ)}finally{s.f()}}(p[e])},n=0;n<t.outputs.length;++n)e(n)})),this.collectedTrainableWeights=this.trainableWeights}},{key:"checkTrainableWeightsConsistency",value:function(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}},{key:"evaluate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=null==n.batchSize?32:n.batchSize;V_(r);var a=!0,i=this.standardizeUserDataXY(e,t,a,r);try{var o=i[0].concat(i[1]);this.makeTestFunction();var s=this.testFunction,u=this.testLoop(s,o,r,n.verbose,n.steps);return xk(u)}finally{Y_(i[0],e),Y_(i[1],t)}}},{key:"evaluateDataset",value:function(){var e=_(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.makeTestFunction(),e.abrupt("return",z_(this,t,n));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"checkNumSamples",value:function(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(null!=n){if(r=null,null!=t)throw new mk("If ".concat(a," is set, batchSize must be null or undefined.")+"Got batchSize = ".concat(t))}else{if(null==e)throw new mk("Either the input data should have a defined shape, or "+"".concat(a," shoud be specified."));r=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return r}},{key:"execute",value:function(e,t){if(Array.isArray(t)&&0===t.length)throw new mk("`outputs` is an empty Array, which is not allowed.");var n=Array.isArray(t),r=n?t:[t],a=this.retrieveSymbolicTensors(r),i=new g_;if(e instanceof Xl&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new mk("The number of inputs provided (".concat(e.length,") ")+"does not match the number of inputs of this model "+"(".concat(this.inputs.length,")."));for(var o=0;o<this.inputs.length;++o)i.add(this.inputs[o],e[o])}else{var s,u=zo(this.inputs);try{for(u.s();!(s=u.n()).done;){var c=s.value,l=e[c.name];if(null==l)throw new mk("No value is provided for the model's input ".concat(c.name));i.add(c,l)}}catch(ZJ){u.e(ZJ)}finally{u.f()}}var h=k_(a,i);return n?h:h[0]}},{key:"retrieveSymbolicTensors",value:function(e){var t,n=yk(null,e.length),r=e.length,a=zo(this.layers);try{for(a.s();!(t=a.n()).done;){for(var i=t.value,o=Array.isArray(i.output)?i.output:[i.output],s=o.map((function(e){return e.name})),u=0;u<e.length;++u){var c=s.indexOf(e[u]);if(-1!==c&&(n[u]=o[c],r--),0===r)break}if(0===r)break}}catch(ZJ){a.e(ZJ)}finally{a.f()}if(r>0){var l=[];throw n.forEach((function(t,n){null==t&&l.push(e[n])})),new mk("Cannot find SymbolicTensors for output name(s): "+"".concat(JSON.stringify(l)))}return n}},{key:"predictLoop",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return vp((function(){var a=t.checkNumSamples(e);if(r)throw new vk("Verbose predictLoop() is not implemented yet.");for(var i=G_(a,n),o=t.outputs.map((function(e){return[]})),s=function(n){vp((function(){var r=i[n][0],a=i[n][1],o=j_(e,r,a),s=[];if(Array.isArray(o))for(var u=0;u<o.length;++u)s.push({key:t.inputs[u],value:o[u]});else s.push({key:t.inputs[0],value:o});var c=new g_(s);return k_(t.outputs,c)})).forEach((function(e,t){return o[t].push(e)}))},u=0;u<i.length;++u)s(u);return xk(o.map((function(e){return Jp(e,0)})))}))}},{key:"predict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=X_(e);tS(n,this.inputNames,this.feedInputShapes,!1);try{var r=null==t.batchSize?32:t.batchSize;return V_(r),this.predictLoop(n,r)}finally{Y_(n,e)}}},{key:"predictOnBatch",value:function(e){tS(e,this.inputNames,this.feedInputShapes,!0);var t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}},{key:"standardizeUserDataXY",value:function(e,t){var n=arguments.length>3?arguments[3]:void 0;if(null==this.optimizer_)throw new dk("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var r=[],a=0;a<this.feedOutputShapes.length;++a){var i=this.feedOutputShapes[a],o=this.feedLossFns[a];o===qw?r.push(i.slice(0,i.length-1).concat([1])):r.push(i)}if(Z_(e=J_(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=J_(t,this.feedOutputNames,r,!1,"target")),eS(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=n&&n>0&&e[0].shape[0]%n!==0)throw new mk("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+"".concat(n,". Found: ").concat(e[0].shape[0]," sample(s)."));return[e,t]}},{key:"standardizeUserData",value:function(){var e=_(x().mark((function e(t,n,r,a){var i,o,s,u,c,l,h,f,p,d=arguments;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=!(d.length>4&&void 0!==d[4])||d[4],o=d.length>5?d[5]:void 0,s=this.standardizeUserDataXY(t,n,i,o),u=Ct(s,2),c=u[0],l=u[1],null==r){e.next=5;break}throw new Error("sample weight is not supported yet.");case 5:if(h=null,null==a){e.next=19;break}f=T_(a,this.outputNames),h=[],p=0;case 10:if(!(p<f.length)){e.next=19;break}return e.t0=h,e.next=14,E_(l[p],null,f[p]);case 14:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 16:++p,e.next=10;break;case 19:return e.abrupt("return",[c,l,h]);case 20:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"testLoop",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4?arguments[4]:void 0;return vp((function(){var o=r.checkNumSamples(t,n,i,"steps"),s=[];if(a>0)throw new vk("Verbose mode is not implemented yet.");if(null!=i)throw new vk("steps mode in testLoop() is not implemented yet");for(var u=G_(o,n),c=Tm(fx(0,o)),l=0;l<u.length;++l){var h=u[l][0],f=u[l][1],p=vx(c,h,f-h),d=q_(t,p),m=e(d);if(0===l)for(var v=0;v<m.length;++v)s.push(xp(0));for(var g=0;g<m.length;++g){var y=m[g];s[g]=Sp(s[g],Id(f-h,y))}}for(var b=0;b<s.length;++b)s[b]=ld(s[b],o);return s}))}},{key:"getDedupedMetricsNames",value:function(){for(var e=this.metricsNames,t=[],n=0;n<e.length;++n){var r=e[n],a=r;if(kk(e,r)>1){var i=kk(e.slice(0,n),r);a+="_".concat(i)}t.push(a)}return t}},{key:"makeTrainFunction",value:function(){var e=this;return function(t){var n=[],r=t.slice(0,e.inputs.length),a=t.slice(e.inputs.length,e.inputs.length+e.outputs.length),i=t.slice(e.inputs.length+e.outputs.length,e.inputs.length+2*e.outputs.length),o=[],s=e.collectedTrainableWeights.map((function(e){return e.read()}));return[e.optimizer_.minimize((function(){for(var t=[],s=0;s<e.inputs.length;++s)t.push({key:e.inputs[s],value:r[s]});for(var u,c=new g_(t),l=k_(e.outputs,c,{training:!0}),h=0;h<e.lossFunctions.length;++h){var f=(0,e.lossFunctions[h])(a[h],l[h]);null!=i[h]&&(f=A_(f,i[h]));var p=Ld(f);n.push(p),u=0===h?f:Sp(u,f)}for(var d=0;d<e.metricsTensors.length;++d){var m=void 0;if(e.outputs.length>1&&d<e.outputs.length)m=n[d];else{var v=e.metricsTensors[d][0],g=e.metricsTensors[d][1];m=Ld(v(a[g],l[g]))}yp(m),o.push(m)}return u=Ld(u),e.calculateLosses().forEach((function(e){u=Sp(u,e)})),u}),!0,s)].concat(o)}}},{key:"makeTestFunction",value:function(){var e=this;this.testFunction=function(t){return vp((function(){for(var n,r=[],a=t.slice(0,e.inputs.length),i=t.slice(e.inputs.length,e.inputs.length+e.outputs.length),o=[],s=0;s<e.inputs.length;++s)o.push({key:e.inputs[s],value:a[s]});for(var u=new g_(o),c=k_(e.outputs,u),l=0;l<e.lossFunctions.length;++l){var h=e.lossFunctions[l],f=Ld(h(i[l],c[l]));n=0===l?f:Sp(n,f),r.push(n)}for(var p=0;p<e.metricsTensors.length;++p){var d=e.metricsTensors[p][0],m=e.metricsTensors[p][1],v=Ld(d(i[m],c[m]));r.push(v)}return r}))}}},{key:"fit",value:function(){var e=_(x().mark((function e(t,n){var r,a=arguments;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>2&&void 0!==a[2]?a[2]:{},e.abrupt("return",H_(this,t,n,r));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fitDataset",value:function(){var e=_(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",D_(this,t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"trainOnBatch",value:function(){var e=_(x().mark((function e(t,n){var r,a,i,o,s,u,c,l,h,f;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.standardizeUserData(t,n);case 2:r=e.sent,a=r[0],i=r[1],o=this.makeTrainFunction(),s=o(a.concat(i)),u=[],c=zo(s),e.prev=9,c.s();case 11:if((l=c.n()).done){e.next=19;break}return h=l.value,e.next=15,h.data();case 15:f=e.sent,u.push(f[0]);case 17:e.next=11;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(9),c.e(e.t0);case 24:return e.prev=24,c.f(),e.finish(24);case 27:return gp(s),e.abrupt("return",xk(u));case 29:case"end":return e.stop()}}),e,this,[[9,21,24,27]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getNamedWeights",value:function(e){for(var t=[],n=null!=e&&e.trainableOnly,r=n?this.trainableWeights:this.weights,a=this.getWeights(n),i=0;i<r.length;++i)n&&!r[i].trainable||t.push({name:r[i].originalName,tensor:a[i]});return t}},{key:"stopTraining",get:function(){return this.stopTraining_},set:function(e){this.stopTraining_=e}},{key:"optimizer",get:function(){return this.optimizer_},set:function(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}},{key:"dispose",value:function(){var e=Rw(f(r.prototype),"dispose",this).call(this);if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){var t=mp().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-mp().numTensors}return e}},{key:"getLossIdentifiers",value:function(){var e;if("string"===typeof this.loss)e=_k(this.loss);else if(Array.isArray(this.loss)){var t,n=zo(this.loss);try{for(n.s();!(t=n.n()).done;){if("string"!==typeof t.value)throw new Error("Serialization of non-string loss is not supported.")}}catch(ZJ){n.e(ZJ)}finally{n.f()}e=this.loss.map((function(e){return _k(e)}))}else{var r=Object.keys(this.loss);e={};for(var a=this.loss,i=0,o=r;i<o.length;i++){var s=o[i];if("string"!==typeof a[s])throw new Error("Serialization of non-string loss is not supported.");e[s]=_k(a[s])}}return e}},{key:"getMetricIdentifiers",value:function(){if("string"===typeof this.metrics||"function"===typeof this.metrics)return[_k(r_(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map((function(e){return _k(r_(e))}));var e={};for(var t in this.metrics)e[t]=_k(r_(this.metrics[t]));return e}},{key:"getTrainingConfig",value:function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}},{key:"loadTrainingConfig",value:function(e){if(null!=e.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=e.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=e.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");var t,n,r=Ow(d_(e.optimizer_config));if("string"===typeof e.loss)t=Sk(e.loss);else if(Array.isArray(e.loss))t=e.loss.map((function(e){return Sk(e)}));else if(null!=e.loss)for(var a in t={},e.loss)t[a]=Sk(e.loss[a]);if(Array.isArray(e.metrics))n=e.metrics.map((function(e){return Sk(e)}));else if(null!=e.metrics)for(var i in n={},e.metrics)n[i]=Sk(e.metrics[i]);this.compile({loss:t,metrics:n,optimizer:r})}},{key:"save",value:function(){var t=_(x().mark((function t(n,r){var a,i,o,s,u,c,l,h,f;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"!==typeof n){t.next=9;break}if(0!==(a=qh(n)).length){t.next=6;break}throw new mk("Cannot find any save handlers for URL '".concat(n,"'"));case 6:if(!(a.length>1)){t.next=8;break}throw new mk("Found more than one (".concat(a.length,") save handlers for ")+"URL '".concat(n,"'"));case 8:n=a[0];case 9:if(null!=n.save){t.next=11;break}throw new mk("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");case 11:return t.next=13,Eh(this.getNamedWeights(r));case 13:if(i=t.sent,!1,null,o=this.toJSON(null,false),s={modelTopology:o,format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v".concat(v_),convertedBy:null},!(null!=r&&r.includeOptimizer)||null==this.optimizer){t.next=34;break}return s.trainingConfig=this.getTrainingConfig(),c="optimizer",t.t0=e,t.next=25,this.optimizer.getWeights();case 25:return t.t1=t.sent,t.t2=c,t.next=29,t.t0.encodeWeights.call(t.t0,t.t1,t.t2);case 29:l=t.sent,h=l.data,f=l.specs,(u=i.specs).push.apply(u,Fn(f)),i.data=Oh([i.data,h]);case 34:return null!=this.userDefinedMetadata&&(!0,i_(this.userDefinedMetadata,this.name,true),s.userDefinedMetadata=this.userDefinedMetadata),s.weightData=i.data,s.weightSpecs=i.specs,t.abrupt("return",n.save(s));case 38:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"setUserDefinedMetadata",value:function(e){i_(e,this.name),this.userDefinedMetadata=e}},{key:"getUserDefinedMetadata",value:function(){return this.userDefinedMetadata}}]),r}(S_);nS.className="Model",fp(nS);var rS=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n)}(nS);rS.className="Functional",fp(rS);var aS=function(e){h(n,e);var t=g(n);function n(e){var r;if(s(this,n),e=e||{},(r=t.call(this,{inputs:[],outputs:[]})).trainable=!0,r.built=!1,r.name=null!=e.name?e.name:nw("sequential_"),null!=e.layers){var a,i=zo(e.layers);try{for(i.s();!(a=i.n()).done;){var o=a.value;r.add(o)}}catch(ZJ){i.e(ZJ)}finally{i.f()}}return r}return c(n,[{key:"checkShape",value:function(e){if(e.inboundNodes[0].outputTensors[0].shape.some((function(e){return e<0})))throw new mk("Negative dimension size caused by adding layer "+"".concat(e.name," with input shape [")+"".concat(e.inboundNodes[0].inputTensors[0].shape,"]"))}},{key:"add",value:function(e){var t,r=e instanceof n||e instanceof nS;if(r){if(1!==(t=e).outputs.length)throw new mk("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==t.inputs.length)throw new mk("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new mk("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var a=xw({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(a)}if(r)this.outputs=t.outputs,this.inputs=t.inputs;else{if(1!==e.inboundNodes.length)throw new mk("A layer added to a Sequential model must not already be "+"connected somewhere else. LayersModel received layer ".concat(e.name," ")+"which has ".concat(e.inboundNodes.length," pre-existing inbound ")+"connections.");if(1!==e.inboundNodes[0].outputTensors.length)throw new mk("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=yw(this.outputs[0])}this.inboundNodes=[],new mw({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:yk(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((function(e){return e.shape})),outputShapes:this.outputs[0].shape})}else{var i=e.apply(this.outputs[0]);if(Array.isArray(i))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[i],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}},{key:"pop",value:function(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}},{key:"call",value:function(e,t){return null==this.model&&this.build(),this.model.call(e,t)}},{key:"build",value:function(e){if(ow(e),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new nS({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}},{key:"countParams",value:function(){return this.built||this.build(),Rw(f(n.prototype),"countParams",this).call(this)}},{key:"summary",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;this.built||this.build(),Rw(f(n.prototype),"summary",this).call(this,e,t,r)}},{key:"setWeights",value:function(e){null==this.model&&this.build(),this.model.setWeights(e)}},{key:"evaluate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new dk("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}},{key:"evaluateDataset",value:function(){var e=_(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.built){e.next=2;break}throw new dk("The model needs to be compiled before being used.");case 2:return e.abrupt("return",this.model.evaluateDataset(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"predict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==this.model&&this.build(),this.model.predict(e,t)}},{key:"predictOnBatch",value:function(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)}},{key:"compile",value:function(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}},{key:"optimizer",get:function(){return null==this.model?void 0:this.model.optimizer},set:function(e){this.model.optimizer=e}},{key:"fit",value:function(){var e=_(x().mark((function e(t,n){var r,a=arguments;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.length>2&&void 0!==a[2]?a[2]:{},this.built){e.next=3;break}throw new dk("The model needs to be compiled before being used.");case 3:return e.abrupt("return",this.model.fit(t,n,r));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fitDataset",value:function(){var e=_(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.built){e.next=2;break}throw new dk("The model needs to be compiled before being used.");case 2:return e.abrupt("return",this.model.fitDataset(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"trainOnBatch",value:function(){var e=_(x().mark((function e(t,n){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.model.trainOnBatch(t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"stopTraining",get:function(){if(null==this.model)throw new mk("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining},set:function(e){if(null==this.model)throw new mk("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}},{key:"getConfig",value:function(){var e,t=[],n=zo(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value,a={};a.className=r.getClassName(),a.config=r.getConfig(),t.push(a)}}catch(ZJ){n.e(ZJ)}finally{n.f()}return{name:this.name,layers:t}}}],[{key:"fromConfig",value:function(e,t){var r,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i={};if(t instanceof Array){if(null==t[0].className||"Merge"===t[0].className)throw new mk("Legacy serialization format not supported yet.");r=t}else Ho(null!=t.layers,(function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."})),r=t.layers,delete t.layers,i=t;var o=new e(i);if(!(o instanceof n))throw new vk("Sequential.fromConfig called on non-Sequential input: ".concat(o));var s,u=zo(r);try{for(u.s();!(s=u.n()).done;){var c=s.value,l=void 0,h=Ow(c,l,a);a&&h.setFastWeightInitDuringBuild(!0),o.add(h)}}catch(ZJ){u.e(ZJ)}finally{u.f()}return o}}]),n}(nS);function iS(e){return new nS(e)}function oS(e){return new aS(e)}function sS(e){return xw(e)}aS.className="Sequential",fp(aS);var uS=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"getConfig",value:function(){return{}}}]),n}(lp),cS=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Ix(e,t)}}]),n}(uS);cS.className="elu",fp(cS);var lS=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"apply",value:function(e){return hm(e)}}]),n}(uS);lS.className="selu",fp(lS);var hS=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"apply",value:function(e){return um(e)}}]),n}(uS);hS.className="relu",fp(hS);var fS=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"apply",value:function(e){return vp((function(){return Bd(6,um(e))}))}}]),n}(uS);fS.className="relu6",fp(fS);var pS=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"apply",value:function(e){return e}}]),n}(uS);pS.className="linear",fp(pS);var dS=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"apply",value:function(e){return pm(e)}}]),n}(uS);dS.className="sigmoid",fp(dS);var mS=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"apply",value:function(e){return function(e){return vp((function(){var t=Sp(.5,Id(.2,e));return $p(t,0,1)}))}(e)}}]),n}(uS);mS.className="hardSigmoid",fp(mS);var vS=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"apply",value:function(e){return km(e)}}]),n}(uS);vS.className="softplus",fp(vS);var gS=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"apply",value:function(e){return function(e){return vp((function(){return ld(e,_p(e).add(1))}))}(e)}}]),n}(uS);gS.className="softsign",fp(gS);var yS=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"apply",value:function(e){return Cm(e)}}]),n}(uS);yS.className="tanh",fp(yS);var bS=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return bm(e,t)}}]),n}(uS);bS.className="softmax",fp(bS);var kS=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return Pd(e,t)}}]),n}(uS);kS.className="logSoftmax",fp(kS);var xS=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return vp((function(){return pm(e.mul(t)).mul(e)}))}}]),n}(uS);function wS(e){return e.getClassName()}function _S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Ik(e,hp.getMap().classNameMap,t,"activation")}function SS(e){if(null==e){var t={className:"linear",config:{}};return _S(t)}if("string"===typeof e){var n={};return n.className=e,n.config={},_S(n)}return e instanceof uS?e:_S(e)}function CS(e){if(null!=e&&"object"!==typeof e)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an "+"object, but received: ".concat(e))}xS.className="swish",fp(xS);var TS=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n)}(lp),ES=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),r=t.call(this),CS(e),r.l1=null==e||null==e.l1?.01:e.l1,r.l2=null==e||null==e.l2?.01:e.l2,r.hasL1=0!==r.l1,r.hasL2=0!==r.l2,r}return c(n,[{key:"apply",value:function(e){var t=this;return vp((function(){var n=Jd([1]);return t.hasL1&&(n=Sp(n,Nd(Id(t.l1,_p(e))))),t.hasL2&&(n=Sp(n,Nd(Id(t.l2,Cx(e))))),n.asScalar()}))}},{key:"getConfig",value:function(){return{l1:this.l1,l2:this.l2}}}],[{key:"fromConfig",value:function(e,t){return new e({l1:t.l1,l2:t.l2})}}]),n}(TS);ES.className="L1L2",fp(ES);var IS={l1l2:"L1L2"};function AS(e){return Tk(e)}function NS(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Ik(e,hp.getMap().classNameMap,t,"regularizer")}function PS(e){return null==e?null:"string"===typeof e?NS({className:e in IS?IS[e]:e,config:{}}):e instanceof TS?e:NS(e)}var MS=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,null==e?{}:e)).supportsMasking=!0,null!=e&&(r.maxValue=e.maxValue),r}return c(n,[{key:"call",value:function(e,t){e=iw(e);var n=um(e);return null!=this.maxValue&&(n=$p(n,0,this.maxValue)),n}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={maxValue:this.maxValue},t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gw);MS.className="ReLU",fp(MS);var DS=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA=.3,null==e&&(e={}),r.alpha=null==e.alpha?r.DEFAULT_ALPHA:e.alpha,r}return c(n,[{key:"call",value:function(e,t){var n=iw(e);return Sd(n,this.alpha)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={alpha:this.alpha},t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gw);DS.className="LeakyReLU",fp(DS);var RS=function(e){h(n,e);var t=g(n);function n(e){var r;if(s(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),r.supportsMasking=!0,r.alphaInitializer=Jx(e.alphaInitializer||r.DEFAULT_ALPHA_INITIALIZER),r.alphaRegularizer=PS(e.alphaRegularizer),r.alphaConstraint=Hk(e.alphaConstraint),null==e.sharedAxes)r.sharedAxes=null;else if(Array.isArray(e.sharedAxes))r.sharedAxes=e.sharedAxes;else{if("number"!==typeof e.sharedAxes)throw new mk("Expected sharedAxes to be a number or an array of numbers, "+"but got ".concat(e.sharedAxes));r.sharedAxes=[e.sharedAxes]}return r}return c(n,[{key:"build",value:function(e){var t=(e=ow(e)).slice(1);if(null!=this.sharedAxes){var n,r=zo(this.sharedAxes);try{for(r.s();!(n=r.n()).done;){t[n.value-1]=1}}catch(ZJ){r.e(ZJ)}finally{r.f()}}this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var a={};if(null!=this.sharedAxes)for(var i=1;i<e.length;++i)a[i]=e[i];this.inputSpec=[new fw({ndim:e.length,axes:a})],this.built=!0}},{key:"call",value:function(e,t){return e=iw(e),nm(e,this.alpha.read())}},{key:"getConfig",value:function(){var e={alphaInitializer:$x(this.alphaInitializer),alphaRegularizer:AS(this.alphaRegularizer),alphaConstraint:Wk(this.alphaConstraint),sharedAxes:this.sharedAxes},t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gw);RS.className="PReLU",fp(RS);var OS=function(e){h(n,e);var t=g(n);function n(e){var r;if(s(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==r.DEFAULT_ALPHA)throw new vk("Non-default alpha value (".concat(e.alpha,") is not supported by the ")+"ELU layer yet.");return r.alpha=null==e.alpha?r.DEFAULT_ALPHA:e.alpha,r}return c(n,[{key:"call",value:function(e,t){var n=iw(e);return hd(n)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={alpha:this.alpha},t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gw);OS.className="ELU",fp(OS);var FS=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_THETA=1,null==e&&(e={}),r.theta=null==e.theta?r.DEFAULT_THETA:e.theta,r}return c(n,[{key:"call",value:function(e,t){var n=iw(e);return n.mul(px(n.greater(this.theta),"float32"))}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={theta:this.theta},t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gw);FS.className="ThresholdedReLU",fp(FS);var LS=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_AXIS=1,null==e&&(e={}),r.softmax=(new bS).apply,r.axis=null==e.axis?r.DEFAULT_AXIS:e.axis,r}return c(n,[{key:"call",value:function(e,t){var n=iw(e);return this.softmax(n,this.axis)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={axis:this.axis},t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gw);function zS(e,t,n){if("number"===typeof e)return yk(e,t);if(e.length!==t)throw new mk("The ".concat(n," argument must be an integer or tuple of ").concat(t," integers.")+" Received: ".concat(e.length," elements."));for(var r=0;r<t;++r){var a=e[r];if((i=a)!==parseInt(i.toString(),10))throw new mk("The ".concat(n," argument must be an integer or tuple of ").concat(t)+" integers. Received: ".concat(JSON.stringify(e)," including a")+" non-integer number ".concat(a))}return e;var i}function BS(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;if(null==e)return e;var i,o=t+(t-1)*(a-1);return i="same"===n?e:e-o+1,Math.floor((i+r-1)/r)}function VS(e,t,n,r){if(null==e)return null;if("valid"===r)e=e*t+hx([n-t,0]);else{if("same"!==r)throw new mk("Unsupport padding mode: ".concat(r,"."));e*=t}return e}function jS(e,t){return vp((function(){return Zk(t),"channelsFirst"===t?Rm(e,[0,2,3,1]):e}))}function qS(e,t){return vp((function(){return Zk(t),"channelsFirst"===t?Rm(e,[0,2,3,4,1]):e}))}function GS(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return vp((function(){if(null==i&&(i="channelsLast"),Zk(i),3!==e.shape.length)throw new mk("The input of a conv1dWithBias operation should be 3, but is "+"".concat(e.shape.length," instead."));if(3!==t.shape.length)throw new mk("The kernel for a conv1dWithBias operation should be 3, but is "+"".concat(t.shape.length," instead"));if(null!=n&&1!==n.shape.length)throw new mk("The bias for a conv1dWithBias operation should be 1, but is "+"".concat(t.shape.length," instead"));if("channelsFirst"===i&&(e=Rm(e,[0,2,1])),"causal"===a)throw new vk("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var s=ad(e,t,r,"same"===a?"same":"valid","NWC",o);return null!=n&&(s=Ex(s,n)),s}))}function WS(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return vp((function(){if(null==i&&(i="channelsLast"),Zk(i),3!==e.rank&&4!==e.rank)throw new mk("conv2dWithBiasActivation expects input to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));if(3!==t.rank&&4!==t.rank)throw new mk("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));var u=jS(e,i);if("causal"===a)throw new vk("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=Ym({x:u,filter:t,strides:r,pad:"same"===a?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:s}),"channelsFirst"===i&&(u=Rm(u,[0,3,1,2])),u}))}function US(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;return vp((function(){if(null==i&&(i="channelsLast"),Zk(i),4!==e.rank&&5!==e.rank)throw new mk("conv3dWithBias expects input to be of rank 4 or 5, but received "+"".concat(e.rank,"."));if(4!==t.rank&&5!==t.rank)throw new mk("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+"".concat(e.rank,"."));var s=qS(e,i);if("causal"===a)throw new vk("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return s=sd(s,t,r,"same"===a?"same":"valid","NDHWC",o),null!=n&&(s=Ex(s,n)),"channelsFirst"===i&&(s=Rm(s,[0,4,1,2,3])),s}))}LS.className="Softmax",fp(LS);var HS=function(e){h(n,e);var t=g(n);function n(e,r){var a;if(s(this,n),(a=t.call(this,r)).bias=null,a.DEFAULT_KERNEL_INITIALIZER="glorotNormal",a.DEFAULT_BIAS_INITIALIZER="zeros",n.verifyArgs(r),a.rank=e,Rk(a.rank,"rank"),1!==a.rank&&2!==a.rank&&3!==a.rank)throw new vk("Convolution layer for rank other than 1, 2, or 3 (".concat(a.rank,") is ")+"not implemented yet.");if(a.kernelSize=zS(r.kernelSize,e,"kernelSize"),a.strides=zS(null==r.strides?1:r.strides,e,"strides"),a.padding=null==r.padding?"valid":r.padding,ex(a.padding),a.dataFormat=null==r.dataFormat?"channelsLast":r.dataFormat,Zk(a.dataFormat),a.activation=SS(r.activation),a.useBias=null==r.useBias||r.useBias,a.biasInitializer=Jx(r.biasInitializer||a.DEFAULT_BIAS_INITIALIZER),a.biasConstraint=Hk(r.biasConstraint),a.biasRegularizer=PS(r.biasRegularizer),a.activityRegularizer=PS(r.activityRegularizer),a.dilationRate=zS(null==r.dilationRate?1:r.dilationRate,e,"dilationRate"),1===a.rank&&Array.isArray(a.dilationRate)&&1!==a.dilationRate.length)throw new mk("dilationRate must be a number or an array of a single number for 1D convolution, but received "+"".concat(JSON.stringify(a.dilationRate)));if(2===a.rank){if("number"===typeof a.dilationRate)a.dilationRate=[a.dilationRate,a.dilationRate];else if(2!==a.dilationRate.length)throw new mk("dilationRate must be a number or array of two numbers for 2D "+"convolution, but received ".concat(JSON.stringify(a.dilationRate)))}else if(3===a.rank)if("number"===typeof a.dilationRate)a.dilationRate=[a.dilationRate,a.dilationRate,a.dilationRate];else if(3!==a.dilationRate.length)throw new mk("dilationRate must be a number or array of three numbers for 3D "+"convolution, but received ".concat(JSON.stringify(a.dilationRate)));return a}return c(n,[{key:"getConfig",value:function(){var e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:wS(this.activation),useBias:this.useBias,biasInitializer:$x(this.biasInitializer),biasRegularizer:AS(this.biasRegularizer),activityRegularizer:AS(this.activityRegularizer),biasConstraint:Wk(this.biasConstraint)},t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"verifyArgs",value:function(e){if(bk("kernelSize"in e,"required key 'kernelSize' not in config"),"number"!==typeof e.kernelSize&&!Dk(e.kernelSize,"number",1,3))throw new mk("BaseConv expects config.kernelSize to be number or number[] with "+"length 1, 2, or 3, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(gw),KS=function(e){h(n,e);var t=g(n);function n(e,r){var a;return s(this,n),(a=t.call(this,e,r)).kernel=null,n.verifyArgs(r),a.filters=r.filters,Rk(a.filters,"filters"),a.kernelInitializer=Jx(r.kernelInitializer||a.DEFAULT_KERNEL_INITIALIZER),a.kernelConstraint=Hk(r.kernelConstraint),a.kernelRegularizer=PS(r.kernelRegularizer),a}return c(n,[{key:"build",value:function(e){e=ow(e);var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new mk("The channel dimension of the input should be defined. "+"Found ".concat(e[t]));var n=e[t],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:ot({},t,n)}],this.built=!0}},{key:"call",value:function(e,t){var n=this;return vp((function(){var t;e=iw(e);var r=null==n.bias?null:n.bias.read(),a=Fk(n.activation.getClassName());if(null!=a&&2===n.rank)t=WS(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate,a);else{if(1===n.rank)t=GS(e,n.kernel.read(),r,n.strides[0],n.padding,n.dataFormat,n.dilationRate[0]);else if(2===n.rank)t=WS(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate);else{if(3!==n.rank)throw new vk("convolutions greater than 3D are not implemented yet.");t=US(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate)}null!=n.activation&&(t=n.activation.apply(t))}return t}))}},{key:"computeOutputShape",value:function(e){e=ow(e);for(var t=[],n="channelsLast"===this.dataFormat?e.slice(1,e.length-1):e.slice(2),r=0;r<n.length;++r){var a=BS(n[r],this.kernelSize[r],this.padding,this.strides[r],"number"===typeof this.dilationRate?this.dilationRate:this.dilationRate[r]);t.push(a)}var i=[e[0]];return"channelsLast"===this.dataFormat?(i=i.concat(t)).push(this.filters):(i.push(this.filters),i=i.concat(t)),i}},{key:"getConfig",value:function(){var e={filters:this.filters,kernelInitializer:$x(this.kernelInitializer),kernelRegularizer:AS(this.kernelRegularizer),kernelConstraint:Wk(this.kernelConstraint)},t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"verifyArgs",value:function(e){if(!("filters"in e)||"number"!==typeof e.filters||e.filters<1)throw new mk("Convolution layer expected config.filters to be a 'number' > 0 "+"but got ".concat(JSON.stringify(e.filters)))}}]),n}(HS),XS=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),r=t.call(this,2,e),n.verifyArgs(e),r}return c(n,[{key:"getConfig",value:function(){var e=Rw(f(n.prototype),"getConfig",this).call(this);return delete e.rank,e}}],[{key:"verifyArgs",value:function(e){if("number"!==typeof e.kernelSize&&!Dk(e.kernelSize,"number",1,2))throw new mk("Conv2D expects config.kernelSize to be number or number[] with "+"length 1 or 2, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(KS);XS.className="Conv2D",fp(XS);var YS=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),r=t.call(this,3,e),n.verifyArgs(e),r}return c(n,[{key:"getConfig",value:function(){var e=Rw(f(n.prototype),"getConfig",this).call(this);return delete e.rank,e}}],[{key:"verifyArgs",value:function(e){if("number"!==typeof e.kernelSize&&(!Array.isArray(e.kernelSize)||1!==e.kernelSize.length&&3!==e.kernelSize.length))throw new mk("Conv3D expects config.kernelSize to be number or"+" [number, number, number], but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(KS);YS.className="Conv3D",fp(YS);var QS=function(e){h(n,e);var t=g(n);function n(e){var r;if(s(this,n),(r=t.call(this,e)).inputSpec=[new fw({ndim:4})],"same"!==r.padding&&"valid"!==r.padding)throw new mk("Conv2DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(r.padding));return r}return c(n,[{key:"build",value:function(e){if(4!==(e=ow(e)).length)throw new mk("Input should have rank 4; Received input shape: "+JSON.stringify(e));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new mk("The channel dimension of the inputs should be defined. Found `None`.");var n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new fw({ndim:4,axes:ot({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return vp((function(){var t=iw(e);if(4!==t.shape.length)throw new mk("Conv2DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(t.shape.length));var r,a,i=t.shape,o=i[0];"channelsFirst"===n.dataFormat?(r=2,a=3):(r=1,a=2);var s=i[r],u=i[a],c=n.kernelSize[0],l=n.kernelSize[1],h=n.strides[0],f=n.strides[1],p=[o,VS(s,h,c,n.padding),VS(u,f,l,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(t=Rm(t,[0,2,3,1]));var d=od(t,n.kernel.read(),p,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(d=Rm(d,[0,3,1,2])),null!=n.bias&&(d=Ex(d,n.bias.read(),n.dataFormat)),null!=n.activation&&(d=n.activation.apply(d)),d}))}},{key:"computeOutputShape",value:function(e){var t,n,r,a=(e=ow(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,r=3):(t=3,n=1,r=2);var i=this.kernelSize[0],o=this.kernelSize[1],s=this.strides[0],u=this.strides[1];return a[t]=this.filters,a[n]=VS(a[n],s,i,this.padding),a[r]=VS(a[r],u,o,this.padding),a}},{key:"getConfig",value:function(){var e=Rw(f(n.prototype),"getConfig",this).call(this);return delete e.dilationRate,e}}]),n}(XS);QS.className="Conv2DTranspose",fp(QS);var $S=function(e){h(n,e);var t=g(n);function n(e,r){var a;if(s(this,n),(a=t.call(this,e,r)).DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",a.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",a.depthwiseKernel=null,a.pointwiseKernel=null,null==r.filters)throw new mk("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=r.kernelInitializer||null!=r.kernelRegularizer||null!=r.kernelConstraint)throw new mk("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=r.padding&&"same"!==r.padding&&"valid"!==r.padding)throw new mk("SeparableConv".concat(a.rank,"D supports only padding modes: ")+"'same' and 'valid', but received ".concat(JSON.stringify(r.padding)));return a.depthMultiplier=null==r.depthMultiplier?1:r.depthMultiplier,a.depthwiseInitializer=Jx(r.depthwiseInitializer||a.DEFAULT_DEPTHWISE_INITIALIZER),a.depthwiseRegularizer=PS(r.depthwiseRegularizer),a.depthwiseConstraint=Hk(r.depthwiseConstraint),a.pointwiseInitializer=Jx(r.depthwiseInitializer||a.DEFAULT_POINTWISE_INITIALIZER),a.pointwiseRegularizer=PS(r.pointwiseRegularizer),a.pointwiseConstraint=Hk(r.pointwiseConstraint),a}return c(n,[{key:"build",value:function(e){if((e=ow(e)).length<this.rank+2)throw new mk("Inputs to SeparableConv".concat(this.rank,"D should have rank ")+"".concat(this.rank+2,", but received input shape: ")+"".concat(JSON.stringify(e)));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t]||e[t]<0)throw new mk("The channel dimension of the inputs should be defined, "+"but found ".concat(JSON.stringify(e[t])));for(var n=e[t],r=this.kernelSize.concat([n,this.depthMultiplier]),a=[],i=0;i<this.rank;++i)a.push(1);a.push(n*this.depthMultiplier,this.filters);var o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new fw({ndim:this.rank+2,axes:ot({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return vp((function(){var t;if(e=iw(e),1===n.rank)throw new vk("1D separable convolution is not implemented yet.");return 2===n.rank&&("channelsFirst"===n.dataFormat&&(e=Rm(e,[0,2,3,1])),t=fm(e,n.depthwiseKernel.read(),n.pointwiseKernel.read(),n.strides,n.padding,n.dilationRate,"NHWC")),n.useBias&&(t=Ex(t,n.bias.read(),n.dataFormat)),null!=n.activation&&(t=n.activation.apply(t)),"channelsFirst"===n.dataFormat&&(t=Rm(t,[0,3,1,2])),t}))}},{key:"getConfig",value:function(){var e=Rw(f(n.prototype),"getConfig",this).call(this);return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=$x(this.depthwiseInitializer),e.pointwiseInitializer=$x(this.pointwiseInitializer),e.depthwiseRegularizer=AS(this.depthwiseRegularizer),e.pointwiseRegularizer=AS(this.pointwiseRegularizer),e.depthwiseConstraint=Wk(this.depthwiseConstraint),e.pointwiseConstraint=Wk(this.pointwiseConstraint),e}}]),n}(KS);$S.className="SeparableConv";var JS=function(e){h(n,e);var t=g(n);function n(e){return s(this,n),t.call(this,2,e)}return c(n)}($S);JS.className="SeparableConv2D",fp(JS);var ZS=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),r=t.call(this,1,e),n.verifyArgs(e),r.inputSpec=[{ndim:3}],r}return c(n,[{key:"getConfig",value:function(){var e=Rw(f(n.prototype),"getConfig",this).call(this);return delete e.rank,delete e.dataFormat,e}}],[{key:"verifyArgs",value:function(e){if("number"!==typeof e.kernelSize&&!Dk(e.kernelSize,"number",1,1))throw new mk("Conv1D expects config.kernelSize to be number or number[] with "+"length 1, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(KS);ZS.className="Conv1D",fp(ZS);var eC=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),r=t.call(this,e),"number"===typeof e.cropping?r.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"===typeof e.cropping[0]?r.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:r.cropping=e.cropping,r.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,r.inputSpec=[{ndim:4}],r}return c(n,[{key:"computeOutputShape",value:function(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}},{key:"call",value:function(e,t){var n=this;return vp((function(){if(e=iw(e),"channelsLast"===n.dataFormat){var t=yx(e,n.cropping[0][0],e.shape[1]-n.cropping[0][0]-n.cropping[0][1],2);return yx(t,n.cropping[1][0],e.shape[2]-n.cropping[1][1]-n.cropping[1][0],3)}var r=yx(e,n.cropping[0][0],e.shape[2]-n.cropping[0][0]-n.cropping[0][1],3);return yx(r,n.cropping[1][0],e.shape[3]-n.cropping[1][1]-n.cropping[1][0],4)}))}},{key:"getConfig",value:function(){var e={cropping:this.cropping,dataFormat:this.dataFormat},t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gw);eC.className="Cropping2D",fp(eC);var tC=function(e){h(n,e);var t=g(n);function n(e){var r,a;return s(this,n),(r=t.call(this,e)).DEFAULT_SIZE=[2,2],r.inputSpec=[{ndim:4}],r.size=null==e.size?r.DEFAULT_SIZE:e.size,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Zk(r.dataFormat),r.interpolation=null==e.interpolation?"nearest":e.interpolation,a=r.interpolation,Mk(Xk,"InterpolationFormat",a),r}return c(n,[{key:"computeOutputShape",value:function(e){if("channelsFirst"===this.dataFormat){var t=null==e[2]?null:this.size[0]*e[2],n=null==e[3]?null:this.size[1]*e[3];return[e[0],e[1],t,n]}var r=null==e[1]?null:this.size[0]*e[1],a=null==e[2]?null:this.size[1]*e[2];return[e[0],r,a,e[3]]}},{key:"call",value:function(e,t){var n=this;return vp((function(){var t=iw(e),r=t.shape;if("channelsFirst"===n.dataFormat){t=Rm(t,[0,2,3,1]);var a=n.size[0]*r[2],i=n.size[1]*r[3],o="nearest"===n.interpolation?t.resizeNearestNeighbor([a,i]):t.resizeBilinear([a,i]);return Rm(o,[0,3,1,2])}var s=n.size[0]*r[1],u=n.size[1]*r[2];return"nearest"===n.interpolation?t.resizeNearestNeighbor([s,u]):t.resizeBilinear([s,u])}))}},{key:"getConfig",value:function(){var e={size:this.size,dataFormat:this.dataFormat},t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gw);tC.className="UpSampling2D",fp(tC);var nC=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,2,e)).depthwiseKernel=null,r.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,r.depthwiseInitializer=Jx(e.depthwiseInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.depthwiseConstraint=Hk(e.depthwiseConstraint),r.depthwiseRegularizer=PS(e.depthwiseRegularizer),r}return c(n,[{key:"build",value:function(e){if((e=ow(e)).length<4)throw new mk("Inputs to DepthwiseConv2D should have rank 4. "+"Received input shape: ".concat(JSON.stringify(e),"."));var t="channelsFirst"===this.dataFormat?1:3;if(null==e[t]||e[t]<0)throw new mk("The channel dimension of the inputs to DepthwiseConv2D should "+"be defined, but is not (".concat(e[t],")."));var n=e[t],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return vp((function(){var t=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"valid",a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0;return vp((function(){null==a&&(a="channelsLast"),Zk(a);var o=jS(e,a);if(4!==e.rank)throw new mk("Input for depthwiseConv2d is required to be 4-D, but is instead "+"".concat(e.rank,"-D"));if(4!==t.rank)throw new mk("depthwiseKernel is required to be 4-D, but is instead "+"".concat(t.rank,"-D"));return o=ud(o,t,n,"same"===r?"same":"valid","NHWC",i),"channelsFirst"===a&&(o=Rm(o,[0,3,1,2])),o}))}(e=iw(e),n.depthwiseKernel.read(),n.strides,n.padding,n.dataFormat,null);return n.useBias&&(t=Ex(t,n.bias.read(),n.dataFormat)),null!=n.activation&&(t=n.activation.apply(t)),t}))}},{key:"computeOutputShape",value:function(e){e=ow(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,a=BS(t,this.kernelSize[0],this.padding,this.strides[0]),i=BS(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],r,a,i]:[e[0],a,i,r]}},{key:"getConfig",value:function(){var e=Rw(f(n.prototype),"getConfig",this).call(this);return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=$x(this.depthwiseInitializer),e.depthwiseRegularizer=AS(this.depthwiseRegularizer),e.depthwiseConstraint=Wk(this.depthwiseRegularizer),e}}]),n}(HS);function rC(e,t,n,r){if(Array.isArray(e)){if(null!=t||null!=n)throw new mk("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function a(e){return null==e||Array.isArray(e)?e:[e]}return{inputs:e,initialState:t=a(t),constants:n=a(n)}}function aC(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return vp((function(){var u=t.shape.length;if(u<3)throw new mk("Input should be at least 3D, but is ".concat(u,"D."));var c=[1,0].concat(fx(2,u));if(t=Rm(t,c),null!=i)throw new vk("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=a&&((a=a.asType("bool").asType("float32")).rank===u-1&&(a=vd(a,-1)),a=Rm(a,c)),r&&(t=cm(t,0),null!=a&&(a=cm(a,0)));var l,h,f=[],p=n,d=t.shape[0],m=Am(t);null!=a&&(h=Am(a));for(var v,g=function(t){var n=m[t],r=vp((function(){return e(n,p)}));if(null==a)l=r[0],p=r[1];else{var i=vp((function(){var e=h[t],n=em(e).sub(e);return{output:r[0].mul(e).add(p[0].mul(n)),newStates:p.map((function(t,a){return r[1][a].mul(e).add(t.mul(n))}))}}));l=i.output,p=i.newStates}s&&f.push(l)},y=0;y<d;++y)g(y);if(s){v=Sm(f,1)}return[l,v,p]}))}nC.className="DepthwiseConv2D",fp(nC);var iC=function(e){h(n,e);var t=g(n);function n(e){var r,a;if(s(this,n),r=t.call(this,e),null==e.cell)throw new mk("cell property is missing for the constructor of RNN.");if(null==(a=Array.isArray(e.cell)?new pC({cells:e.cell}):e.cell).stateSize)throw new mk("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return r.cell=a,r.returnSequences=null!=e.returnSequences&&e.returnSequences,r.returnState=null!=e.returnState&&e.returnState,r.goBackwards=null!=e.goBackwards&&e.goBackwards,r._stateful=null!=e.stateful&&e.stateful,r.unroll=null!=e.unroll&&e.unroll,r.supportsMasking=!0,r.inputSpec=[new fw({ndim:3})],r.stateSpec=null,r.states_=null,r.numConstants=null,r.keptStates=[],r}return c(n,[{key:"getStates",value:function(){return null==this.states_?fx(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map((function(e){return null})):this.states_}},{key:"setStates",value:function(e){this.states_=e}},{key:"computeOutputShape",value:function(e){rw(e)&&(e=e[0]);var t=this.cell.stateSize;Array.isArray(t)||(t=[t]);var n,r=t[0];if(n=this.returnSequences?[e[0],e[1],r]:[e[0],r],this.returnState){var a,i=[],o=zo(t);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.push([e[0],s])}}catch(ZJ){o.e(ZJ)}finally{o.f()}return[n].concat(i)}return n}},{key:"computeMask",value:function(e,t){var n=this;return vp((function(){Array.isArray(t)&&(t=t[0]);var e=n.returnSequences?t:null;if(n.returnState){var r=n.states.map((function(e){return null}));return[e].concat(r)}return e}))}},{key:"states",get:function(){if(null==this.states_){for(var e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[],n=0;n<e;++n)t.push(null);return t}return this.states_},set:function(e){this.states_=e}},{key:"build",value:function(e){if(null!=this.numConstants)throw new vk("Constants support is not implemented in RNN yet.");rw(e)&&(e=e[0]);var t=this.stateful?e[0]:null,n=e.slice(2);this.inputSpec[0]=new fw({shape:[t,null].concat(Fn(n))});var r,a=[e[0]].concat(e.slice(2));if(this.cell.build(a),r=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!$o(this.stateSpec.map((function(e){return e.shape[e.shape.length-1]})),r))throw new mk("An initialState was passed that is not compatible with "+"cell.stateSize. Received stateSpec=".concat(this.stateSpec,"; ")+"However cell.stateSize is ".concat(this.cell.stateSize))}else this.stateSpec=r.map((function(e){return new fw({shape:[null,e]})}));this.stateful&&this.resetStates()}},{key:"resetStates",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];vp((function(){if(!t.stateful)throw new pk("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=t.inputSpec[0].shape[0];if(null==r)throw new mk("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==t.states_)Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(e){return Jd([r,e])})):t.states_=[Jd([r,t.cell.stateSize])];else if(null==e)gp(t.states_),null!=t.keptStates&&(gp(t.keptStates),t.keptStates=[]),Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(e){return Jd([r,e])})):t.states_[0]=Jd([r,t.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==t.states_.length)throw new mk("Layer ".concat(t.name," expects ").concat(t.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));!0===n?t.keptStates.push(t.states_.slice()):gp(t.states_);for(var a=0;a<t.states_.length;++a){var i=e[a],o=Array.isArray(t.cell.stateSize)?t.cell.stateSize[a]:t.cell.stateSize,s=[r,o];if(!$o(i.shape,s))throw new mk("State ".concat(a," is incompatible with layer ").concat(t.name,": ")+"expected shape=".concat(s,", received shape=").concat(i.shape));t.states_[a]=i}}t.states_=t.states_.map((function(e){return yp(e.clone())}))}))}},{key:"apply",value:function(e,t){var r=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});var i=rC(e,r,a,this.numConstants);e=i.inputs,r=i.initialState,a=i.constants;var o=[],s=[];if(null!=r){t.initialState=r,o=o.concat(r),this.stateSpec=[];var u,c=zo(r);try{for(c.s();!(u=c.n()).done;){var l=u.value;this.stateSpec.push(new fw({shape:l.shape}))}}catch(ZJ){c.e(ZJ)}finally{c.f()}s=s.concat(this.stateSpec)}if(null!=a&&(t.constants=a,o=o.concat(a),this.numConstants=a.length),o[0]instanceof pw){var h=[e].concat(o),p=this.inputSpec.concat(s),d=this.inputSpec;this.inputSpec=p;var m=Rw(f(n.prototype),"apply",this).call(this,h,t);return this.inputSpec=d,m}return Rw(f(n.prototype),"apply",this).call(this,e,t)}},{key:"call",value:function(e,t){var n=this;return vp((function(){var r=null==t?null:t.mask,a=null==t?null:t.training,i=null==t?null:t.initialState;e=iw(e),null==i&&(i=n.stateful?n.states_:n.getInitialState(e));var o=Array.isArray(n.cell.stateSize)?n.cell.stateSize.length:1;if(i.length!==o)throw new mk("RNN Layer has ".concat(o," state(s) but was passed ")+"".concat(i.length," initial state(s)."));n.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var s={training:a},u=aC((function(e,t){var r=n.cell.call([e].concat(t),s);return[r[0],r.slice(1)]}),e,i,n.goBackwards,r,null,n.unroll,n.returnSequences),c=u[0],l=u[1],h=u[2];n.stateful&&n.resetStates(h,a);var f=n.returnSequences?l:c;return n.returnState?[f].concat(h):f}))}},{key:"getInitialState",value:function(e){var t=this;return vp((function(){var n=Jd(e.shape);return n=dx(n=Nd(n,[1,2])),Array.isArray(t.cell.stateSize)?t.cell.stateSize.map((function(e){return e>1?xx(n,[1,e]):n})):t.cell.stateSize>1?[xx(n,[1,t.cell.stateSize])]:[n]}))}},{key:"trainableWeights",get:function(){return this.trainable?this.cell.trainableWeights:[]}},{key:"nonTrainableWeights",get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}},{key:"setFastWeightInitDuringBuild",value:function(e){Rw(f(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)}},{key:"getConfig",value:function(){var e=Rw(f(n.prototype),"getConfig",this).call(this),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(t.numConstants=this.numConstants);var r=this.cell.getConfig();return this.getClassName()===n.className&&(t.cell={className:this.cell.getClassName(),config:r}),Object.assign({},r,e,t)}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.cell,a=Ow(r,n);return new e(Object.assign(t,{cell:a}))}}]),n}(gw);iC.className="RNN",fp(iC);var oC=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n)}(gw),sC=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=e.units,Rk(r.units,"units"),r.activation=SS(null==e.activation?r.DEFAULT_ACTIVATION:e.activation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=Jx(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=Jx(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=Jx(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=PS(e.kernelRegularizer),r.recurrentRegularizer=PS(e.recurrentRegularizer),r.biasRegularizer=PS(e.biasRegularizer),r.kernelConstraint=Hk(e.kernelConstraint),r.recurrentConstraint=Hk(e.recurrentConstraint),r.biasConstraint=Hk(e.biasConstraint),r.dropout=lx([1,hx([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=lx([1,hx([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return c(n,[{key:"build",value:function(e){e=ow(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return vp((function(){if(2!==e.length)throw new mk("SimpleRNNCell expects 2 input Tensors, got ".concat(e.length,"."));var r=e[1];e=e[0];var a,i=null!=t.training&&t.training;0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=dC({ones:function(){return em(e)},rate:n.dropout,training:i})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=dC({ones:function(){return em(r)},rate:n.recurrentDropout,training:i}));var o=n.dropoutMask,s=n.recurrentDropoutMask;a=_x(null!=o?Id(e,o):e,n.kernel.read()),null!=n.bias&&(a=Ex(a,n.bias.read())),null!=s&&(r=Id(r,s));var u=Sp(a,_x(r,n.recurrentKernel.read()));return null!=n.activation&&(u=n.activation.apply(u)),[u,u]}))}},{key:"getConfig",value:function(){var e=Rw(f(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:wS(this.activation),useBias:this.useBias,kernelInitializer:$x(this.kernelInitializer),recurrentInitializer:$x(this.recurrentInitializer),biasInitializer:$x(this.biasInitializer),kernelRegularizer:AS(this.kernelRegularizer),recurrentRegularizer:AS(this.recurrentRegularizer),biasRegularizer:AS(this.biasRegularizer),activityRegularizer:AS(this.activityRegularizer),kernelConstraint:Wk(this.kernelConstraint),recurrentConstraint:Wk(this.recurrentConstraint),biasConstraint:Wk(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign({},e,t)}}]),n}(oC);sC.className="SimpleRNNCell",fp(sC);var uC=function(e){h(n,e);var t=g(n);function n(e){return s(this,n),e.cell=new sC(e),t.call(this,e)}return c(n,[{key:"call",value:function(e,t){var r=this;return vp((function(){null!=r.cell.dropoutMask&&(gp(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(gp(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return Rw(f(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}}],[{key:"fromConfig",value:function(e,t){return new e(t)}}]),n}(iC);uC.className="SimpleRNN",fp(uC);var cC=function(e){h(n,e);var t=g(n);function n(e){var r;if(s(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new mk("GRUCell does not support reset_after parameter set to true.");return r.units=e.units,Rk(r.units,"units"),r.activation=SS(void 0===e.activation?r.DEFAULT_ACTIVATION:e.activation),r.recurrentActivation=SS(void 0===e.recurrentActivation?r.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=Jx(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=Jx(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=Jx(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=PS(e.kernelRegularizer),r.recurrentRegularizer=PS(e.recurrentRegularizer),r.biasRegularizer=PS(e.biasRegularizer),r.kernelConstraint=Hk(e.kernelConstraint),r.recurrentConstraint=Hk(e.recurrentConstraint),r.biasConstraint=Hk(e.biasConstraint),r.dropout=lx([1,hx([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=lx([1,hx([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.implementation=e.implementation,r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return c(n,[{key:"build",value:function(e){var t=(e=ow(e))[e.length-1];this.kernel=this.addWeight("kernel",[t,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return vp((function(){if(2!==e.length)throw new mk("GRUCell expects 2 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var r=null!=t.training&&t.training,a=e[1];e=e[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=dC({ones:function(){return em(e)},rate:n.dropout,training:r,count:3})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=dC({ones:function(){return em(a)},rate:n.recurrentDropout,training:r,count:3}));var i,o,s,u=n.dropoutMask,c=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(e=Id(e,u[0]));var l=_x(e,n.kernel.read());n.useBias&&(l=Ex(l,n.bias.read())),0<n.recurrentDropout&&n.recurrentDropout<1&&(a=Id(a,c[0]));var h=n.recurrentKernel.read(),f=Ct(xm(h,[2*n.units,n.units],h.rank-1),2),p=f[0],d=f[1],m=_x(a,p),v=Ct(xm(l,3,l.rank-1),3),g=v[0],y=v[1],b=v[2],k=Ct(xm(m,2,m.rank-1),2),x=k[0],w=k[1];i=n.recurrentActivation.apply(Sp(g,x)),o=n.recurrentActivation.apply(Sp(y,w));var _=_x(Id(o,a),d);s=n.activation.apply(Sp(b,_));var S=Sp(Id(i,a),Id(Sp(1,Yd(i)),s));return[S,S]}))}},{key:"getConfig",value:function(){var e=Rw(f(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:wS(this.activation),recurrentActivation:wS(this.recurrentActivation),useBias:this.useBias,kernelInitializer:$x(this.kernelInitializer),recurrentInitializer:$x(this.recurrentInitializer),biasInitializer:$x(this.biasInitializer),kernelRegularizer:AS(this.kernelRegularizer),recurrentRegularizer:AS(this.recurrentRegularizer),biasRegularizer:AS(this.biasRegularizer),activityRegularizer:AS(this.activityRegularizer),kernelConstraint:Wk(this.kernelConstraint),recurrentConstraint:Wk(this.recurrentConstraint),biasConstraint:Wk(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign({},e,t)}}]),n}(oC);cC.className="GRUCell",fp(cC);var lC=function(e){h(n,e);var t=g(n);function n(e){return s(this,n),0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new cC(e),t.call(this,e)}return c(n,[{key:"call",value:function(e,t){var r=this;return vp((function(){null!=r.cell.dropoutMask&&(gp(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(gp(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return Rw(f(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}}],[{key:"fromConfig",value:function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}]),n}(iC);lC.className="GRU",fp(lC);var hC=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=e.units,Rk(r.units,"units"),r.activation=SS(void 0===e.activation?r.DEFAULT_ACTIVATION:e.activation),r.recurrentActivation=SS(void 0===e.recurrentActivation?r.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=Jx(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=Jx(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=Jx(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.unitForgetBias=e.unitForgetBias,r.kernelRegularizer=PS(e.kernelRegularizer),r.recurrentRegularizer=PS(e.recurrentRegularizer),r.biasRegularizer=PS(e.biasRegularizer),r.kernelConstraint=Hk(e.kernelConstraint),r.recurrentConstraint=Hk(e.recurrentConstraint),r.biasConstraint=Hk(e.biasConstraint),r.dropout=lx([1,hx([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=lx([1,hx([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.implementation=e.implementation,r.stateSize=[r.units,r.units],r.dropoutMask=null,r.recurrentDropoutMask=null,r}return c(n,[{key:"build",value:function(e){var t,n,r=(e=ow(e))[e.length-1];if(this.kernel=this.addWeight("kernel",[r,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var a=this.biasInitializer,i=this.units;n=new(t=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"apply",value:function(e,t){var n=a.apply([i]),r=(new Ox).apply([i]),o=a.apply([2*i]);return kx(kx(n,r),o)}}]),n}(Dx),t.className="CustomInit",t)}else n=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,n,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}},{key:"call",value:function(e,t){var n=this;return vp((function(){var r=null!=t.training&&t.training;if(3!==e.length)throw new mk("LSTMCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var a=e[1],i=e[2];e=e[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=dC({ones:function(){return em(e)},rate:n.dropout,training:r,count:4})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=dC({ones:function(){return em(a)},rate:n.recurrentDropout,training:r,count:4}));var o,s,u,c,l=n.dropoutMask,h=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(e=Id(e,l[0]));var f=_x(e,n.kernel.read());0<n.recurrentDropout&&n.recurrentDropout<1&&(a=Id(a,h[0])),f=Sp(f,_x(a,n.recurrentKernel.read())),n.useBias&&(f=Ex(f,n.bias.read()));var p=Ct(xm(f,4,f.rank-1),4),d=p[0],m=p[1],v=p[2],g=p[3];o=n.recurrentActivation.apply(d),s=n.recurrentActivation.apply(m),u=Sp(Id(s,i),Id(o,n.activation.apply(v))),c=n.recurrentActivation.apply(g);var y=Id(c,n.activation.apply(u));return[y,y,u]}))}},{key:"getConfig",value:function(){var e=Rw(f(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:wS(this.activation),recurrentActivation:wS(this.recurrentActivation),useBias:this.useBias,kernelInitializer:$x(this.kernelInitializer),recurrentInitializer:$x(this.recurrentInitializer),biasInitializer:$x(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:AS(this.kernelRegularizer),recurrentRegularizer:AS(this.recurrentRegularizer),biasRegularizer:AS(this.biasRegularizer),activityRegularizer:AS(this.activityRegularizer),kernelConstraint:Wk(this.kernelConstraint),recurrentConstraint:Wk(this.recurrentConstraint),biasConstraint:Wk(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign({},e,t)}}]),n}(oC);hC.className="LSTMCell",fp(hC);var fC=function(e){h(n,e);var t=g(n);function n(e){return s(this,n),0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new hC(e),t.call(this,e)}return c(n,[{key:"call",value:function(e,t){var r=this;return vp((function(){null!=r.cell.dropoutMask&&(gp(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(gp(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return Rw(f(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}}],[{key:"fromConfig",value:function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}]),n}(iC);fC.className="LSTM",fp(fC);var pC=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).cells=e.cells,r}return c(n,[{key:"stateSize",get:function(){var e,t=[],n=zo(this.cells.slice().reverse());try{for(n.s();!(e=n.n()).done;){var r=e.value;Array.isArray(r.stateSize)?t.push.apply(t,Fn(r.stateSize)):t.push(r.stateSize)}}catch(ZJ){n.e(ZJ)}finally{n.f()}return t}},{key:"call",value:function(e,t){var n=this;return vp((function(){var r,a=e.slice(1),i=[],o=zo(n.cells.slice().reverse());try{for(o.s();!(r=o.n()).done;){var s=r.value;Array.isArray(s.stateSize)?i.push(a.splice(0,s.stateSize.length)):i.push(a.splice(0,1))}}catch(ZJ){o.e(ZJ)}finally{o.f()}i.reverse();for(var u,c=[],l=0;l<n.cells.length;++l){var h=n.cells[l];a=i[l],u=0===l?[e[0]].concat(a):[u[0]].concat(a),u=h.call(u,t),c.push(u.slice(1))}a=[];var f,p=zo(c.slice().reverse());try{for(p.s();!(f=p.n()).done;){var d,m=f.value;(d=a).push.apply(d,Fn(m))}}catch(ZJ){p.e(ZJ)}finally{p.f()}return[u[0]].concat(a)}))}},{key:"build",value:function(e){var t;rw(e)&&(e=e[0]),this.cells.forEach((function(n,r){rx("RNNCell_".concat(r),(function(){n.build(e),t=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,e=[e[0],t]}))})),this.built=!0}},{key:"getConfig",value:function(){var e=Rw(f(n.prototype),"getConfig",this).call(this),t={cells:this.cells.map((function(e){return{className:e.getClassName(),config:e.getConfig()}}))};return Object.assign({},e,t)}},{key:"trainableWeights",get:function(){if(!this.trainable)return[];var e,t=[],n=zo(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,Fn(r.trainableWeights))}}catch(ZJ){n.e(ZJ)}finally{n.f()}return t}},{key:"nonTrainableWeights",get:function(){var e,t=[],n=zo(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,Fn(r.nonTrainableWeights))}}catch(ZJ){n.e(ZJ)}finally{n.f()}if(!this.trainable){var a,i=[],o=zo(this.cells);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.push.apply(i,Fn(s.trainableWeights))}}catch(ZJ){o.e(ZJ)}finally{o.f()}return i.concat(t)}return t}},{key:"getWeights",value:function(){var e,t=[],n=zo(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,Fn(r.weights))}}catch(ZJ){n.e(ZJ)}finally{n.f()}return lw(t)}},{key:"setWeights",value:function(e){var t,n=[],r=zo(this.cells);try{for(r.s();!(t=r.n()).done;)for(var a=t.value,i=a.weights.length,o=e.splice(i),s=0;s<a.weights.length;++s)n.push([a.weights[s],o[s]])}catch(ZJ){r.e(ZJ)}finally{r.f()}hw(n)}}],[{key:"fromConfig",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=[],i=zo(t.cells);try{for(i.s();!(n=i.n()).done;){var o=n.value;a.push(Ow(o,r))}}catch(ZJ){i.e(ZJ)}finally{i.f()}return new e({cells:a})}}]),n}(oC);function dC(e){var t=e.ones,n=e.rate,r=e.training,a=void 0!==r&&r,i=e.count,o=void 0===i?1:i,s=function(){return Ax(t(),n)},u=function(){return Nx(s,t,a)};return!o||o<=1?yp(u().clone()):Array(o).fill(void 0).map(u).map((function(e){return yp(e.clone())}))}pC.className="StackedRNNCells",fp(pC);var mC=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},vC=function(e){h(n,e);var t=g(n);function n(e){var r;if(s(this,n),e.unroll)throw new vk("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new vk("It is not possible at the moment to stack convolutional cells.");return(r=t.call(this,e)).inputSpec=[new fw({ndim:5})],r}return c(n,[{key:"call",value:function(e,t){var r=this;return vp((function(){if(null!=r.cell.dropoutMask&&(gp(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(gp(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),t&&t.constants)throw new mk("ConvRNN2D cell does not support constants");var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return Rw(f(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}},{key:"computeOutputShape",value:function(e){var t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0]].concat(Fn(t.slice(2)))),this.returnState&&(t=[t].concat(Fn(Array(2).fill([e[0]].concat(Fn(t.slice(-3))))))),t}},{key:"getInitialState",value:function(e){var t=this;return vp((function(){var n=t.cell.stateSize,r=e.shape,a=t.computeSingleOutputShape(r),i=Jd([a[0]].concat(Fn(a.slice(2))));return Array.isArray(n)?Array(n.length).fill(i):[i]}))}},{key:"resetStates",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];vp((function(){if(!t.stateful)throw new pk("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=t.inputSpec[0].shape,a=t.computeSingleOutputShape(r),i=[a[0]].concat(Fn(a.slice(2)));if(null==r[0])throw new mk("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==t.getStates())Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(){return Jd(i)})):t.states_=[Jd(i)];else if(null==e)gp(t.states_),null!=t.keptStates&&(gp(t.keptStates),t.keptStates=[]),Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(){return Jd(i)})):t.states_[0]=Jd(i);else{if(Array.isArray(e)||(e=[e]),e.length!==t.states_.length)throw new mk("Layer ".concat(t.name," expects ").concat(t.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));n?t.keptStates.push(t.states_.slice()):gp(t.states_);for(var o=0;o<t.states_.length;++o){var s=e[o],u=i;if(!$o(s.shape,u))throw new mk("State ".concat(o," is incompatible with layer ").concat(t.name,": ")+"expected shape=".concat(u,", received shape=").concat(s.shape));t.states_[o]=s}}t.states_=t.states_.map((function(e){return yp(e.clone())}))}))}},{key:"computeSingleOutputShape",value:function(e){var t=this.cell,n=t.dataFormat,r=t.filters,a=t.kernelSize,i=t.padding,o=t.strides,s=t.dilationRate,u="channelsFirst"===n,c=e[u?3:2],l=e[u?4:3],h=BS(c,a[0],i,o[0],s[0]),f=BS(l,a[1],i,o[1],s[1]);return[].concat(Fn(e.slice(0,2)),Fn(u?[r,h,f]:[h,f,r]))}}]),n}(iC);vC.className="ConvRNN2D";var gC=function(e){h(n,e);var t=g(n);function n(e){var r;s(this,n);var a=e.filters,i=e.kernelSize,o=e.strides,u=e.padding,c=e.dataFormat,l=e.dilationRate;return(r=t.call(this,Object.assign({},e,{units:a}))).filters=a,Rk(r.filters,"filters"),r.kernelSize=zS(i,2,"kernelSize"),r.kernelSize.forEach((function(e){return Rk(e,"kernelSize")})),r.strides=zS(o||1,2,"strides"),r.strides.forEach((function(e){return Rk(e,"strides")})),r.padding=u||"valid",ex(r.padding),r.dataFormat=c||"channelsLast",Zk(r.dataFormat),r.dilationRate=zS(l||1,2,"dilationRate"),r.dilationRate.forEach((function(e){return Rk(e,"dilationRate")})),r}return c(n,[{key:"build",value:function(e){var t;e=ow(e);var n="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[n])throw new mk("The channel dimension of the input should be defined. "+"Found ".concat(e[n]));var r=e[n],a=this.kernelSize.concat([r,4*this.filters]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);var i=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",i,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){var o;if(this.unitForgetBias){var u=this.biasInitializer,l=this.filters;o=new(t=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"apply",value:function(e,t){return bx([u.apply([l]),Zd([l]),u.apply([2*l])])}}]),n}(Dx),t.className="CustomInit",t)}else o=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,o,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}},{key:"call",value:function(e,t){var n=this;return vp((function(){if(3!==e.length)throw new mk("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var r=t.training||!1,a=e[0],i=e[1],o=e[2];0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=dC({ones:function(){return em(a)},rate:n.dropout,training:r,count:4}));var s=n.dropoutMask,u=function(e,t,n){return t&&t[n]?Id(t[n],e):e},c=u(a,s,0),l=u(a,s,1),h=u(a,s,2),f=u(a,s,3);0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=dC({ones:function(){return em(i)},rate:n.recurrentDropout,training:r,count:4}));var p=n.recurrentDropoutMask,d=u(i,p,0),m=u(i,p,1),v=u(i,p,2),g=u(i,p,3),y=Ct(xm(n.kernel.read(),4,3),4),b=y[0],k=y[1],x=y[2],w=y[3],_=Ct(n.useBias?xm(n.bias.read(),4):[null,null,null,null],4),S=_[0],C=_[1],T=_[2],E=_[3];c=n.inputConv(c,b,S,n.padding),l=n.inputConv(l,k,C,n.padding),h=n.inputConv(h,x,T,n.padding),f=n.inputConv(f,w,E,n.padding);var I=Ct(xm(n.recurrentKernel.read(),4,3),4),A=I[0],N=I[1],P=I[2],M=I[3];d=n.recurrentConv(d,A),m=n.recurrentConv(m,N),v=n.recurrentConv(v,P),g=n.recurrentConv(g,M);var D=n.recurrentActivation.apply(Sp(c,d)),R=n.recurrentActivation.apply(Sp(l,m)),O=Sp(Id(R,o),Id(D,n.activation.apply(Sp(h,v)))),F=Id(n.recurrentActivation.apply(Sp(f,g)),n.activation.apply(O));return[F,F,O]}))}},{key:"getConfig",value:function(){var e=Rw(f(n.prototype),"getConfig",this).call(this),t=(e.units,mC(e,["units"])),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign({},t,r)}},{key:"inputConv",value:function(e,t,n,r){var a=rd(e,t,this.strides,r||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?Ex(a,n,this.dataFormat):a}},{key:"recurrentConv",value:function(e,t){return rd(e,t,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}]),n}(hC);gC.className="ConvLSTM2DCell",fp(gC);var yC=function(e){h(n,e);var t=g(n);function n(e){s(this,n);var r=new gC(e);return t.call(this,Object.assign({},e,{cell:r}))}return c(n,null,[{key:"fromConfig",value:function(e,t){return new e(t)}}]),n}(vC);yC.className="ConvLSTM2D",fp(yC);var bC=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).rate=Math.max(Math.min(e.rate,1),0),r.noiseShape=e.noiseShape,r.seed=e.seed,r.supportsMasking=!0,r}return c(n,[{key:"getNoiseShape",value:function(e){if(null==this.noiseShape)return this.noiseShape;for(var t=e.shape,n=[],r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?t[r]:this.noiseShape[r]);return n}},{key:"call",value:function(e,t){var n=this;return vp((function(){n.invokeCallHook(e,t);var r=iw(e);if(0<n.rate&&n.rate<1){var a=null!=t.training&&t.training,i=n.getNoiseShape(r);return Nx((function(){return Ax(r,n.rate,i,n.seed)}),(function(){return r}),a)}return e}))}},{key:"getConfig",value:function(){var e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this)}}]),n}(gw);bC.className="Dropout",fp(bC);var kC=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).inputSpec=[{ndim:3}],r}return c(n,[{key:"getNoiseShape",value:function(e){var t=e.shape;return[t[0],1,t[2]]}}]),n}(bC);kC.className="SpatialDropout1D",fp(kC);var xC=function(e){h(n,e);var t=g(n);function n(e){var r;if(s(this,n),(r=t.call(this,e)).activation=null,r.useBias=!0,r.kernel=null,r.bias=null,r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){var a=null;null!=e.batchSize&&(a=e.batchSize),r.batchInputShape=[a,e.inputDim]}return r.units=e.units,Rk(r.units,"units"),r.activation=SS(e.activation),null!=e.useBias&&(r.useBias=e.useBias),r.kernelInitializer=Jx(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.biasInitializer=Jx(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelConstraint=Hk(e.kernelConstraint),r.biasConstraint=Hk(e.biasConstraint),r.kernelRegularizer=PS(e.kernelRegularizer),r.biasRegularizer=PS(e.biasRegularizer),r.activityRegularizer=PS(e.activityRegularizer),r.supportsMasking=!0,r.inputSpec=[{minNDim:2}],r}return c(n,[{key:"build",value:function(e){var t=(e=ow(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:ot({},-1,t)}],this.built=!0}},{key:"computeOutputShape",value:function(e){var t=(e=ow(e)).slice();return t[t.length-1]=this.units,t}},{key:"call",value:function(e,t){var n=this;return vp((function(){n.invokeCallHook(e,t);var r,a=iw(e),i=Fk(n.activation.getClassName());return null!=i?r=_x(a,n.kernel.read(),i,n.bias?n.bias.read():null):(r=_x(a,n.kernel.read()),null!=n.bias&&(r=Ex(r,n.bias.read())),null!=n.activation&&(r=n.activation.apply(r))),r}))}},{key:"getConfig",value:function(){var e={units:this.units,activation:wS(this.activation),useBias:this.useBias,kernelInitializer:$x(this.kernelInitializer),biasInitializer:$x(this.biasInitializer),kernelRegularizer:AS(this.kernelRegularizer),biasRegularizer:AS(this.biasRegularizer),activityRegularizer:AS(this.activityRegularizer),kernelConstraint:Wk(this.kernelConstraint),biasConstraint:Wk(this.biasConstraint)},t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gw);xC.className="Dense",fp(xC);var wC=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),e=e||{},(r=t.call(this,e)).inputSpec=[{minNDim:3}],r.dataFormat=e.dataFormat,r}return c(n,[{key:"computeOutputShape",value:function(e){var t,n=zo((e=ow(e)).slice(1));try{for(n.s();!(t=n.n()).done;){if(null==t.value)throw new mk('The shape of the input to "Flatten" is not fully defined '+"(got ".concat(e.slice(1),"). Make sure to pass a complete ")+'"input_shape" or "batch_input_shape" argument to the first layer in your model.')}}catch(ZJ){n.e(ZJ)}finally{n.f()}return[e[0],ux(e,1)]}},{key:"call",value:function(e,t){var n=this;return vp((function(){n.invokeCallHook(e,t);var r=iw(e);if("channelsFirst"===n.dataFormat&&r.rank>1){for(var a=[0],i=2;i<r.rank;++i)a.push(i);a.push(1),r=r.transpose(a)}return function(e){if(e.rank<=1)throw new mk("batchFlatten requires a minimum rank of 2. Got rank: ".concat(e.rank,"."));var t=[e.shape[0],ux(e.shape,1)];return e.reshape(t)}(r)}))}},{key:"getConfig",value:function(){var e={};null!=this.dataFormat&&(e.dataFormat=this.dataFormat);var t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gw);wC.className="Flatten",fp(wC);var _C=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).supportsMasking=!0,r.activation=SS(e.activation),r}return c(n,[{key:"call",value:function(e,t){var n=this;return vp((function(){n.invokeCallHook(e,t);var r=iw(e);return n.activation.apply(r)}))}},{key:"getConfig",value:function(){var e={activation:wS(this.activation)},t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gw);_C.className="Activation",fp(_C);var SC=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).n=e.n,r.inputSpec=[{ndim:2}],r}return c(n,[{key:"computeOutputShape",value:function(e){return[e[0],this.n,e[1]]}},{key:"call",value:function(e,t){var n=this;return vp((function(){return e=iw(e),t=e,r=n.n,vp((function(){if(2!==t.shape.length)throw new mk("repeat() expects a rank-2 tensor, but received a "+"rank-".concat(t.shape.length," tensor."));return xx(dx(t,1),[1,r,1])}));var t,r}))}},{key:"getConfig",value:function(){var e={n:this.n},t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gw);SC.className="RepeatVector",fp(SC);var CC=function(e){h(n,e);var t=g(n);function n(e){var r;s(this,n),(r=t.call(this,e)).targetShape=e.targetShape;for(var a=0;a<r.targetShape.length;++a)r.isUnknown(r.targetShape[a])&&(r.targetShape[a]=null);return r}return c(n,[{key:"isUnknown",value:function(e){return e<0||null==e}},{key:"fixUnknownDimension",value:function(e,t){for(var n="Total size of new array must be unchanged.",r=t.slice(),a=1,i=null,o=0;o<r.length;++o){var s=r[o];if(this.isUnknown(s)){if(null!==i)throw new mk("Can only specifiy one unknown dimension.");i=o}else a*=s}var u=ux(e);if(null!==i){if(0===a||u%a!==0)throw new mk(n);r[i]=u/a}else if(u!==a)throw new mk(n);return r}},{key:"computeOutputShape",value:function(e){for(var t=!1,n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}},{key:"call",value:function(e,t){var n=this;return vp((function(){n.invokeCallHook(e,t);var r=iw(e),a=r.shape,i=a.slice(0,1).concat(n.fixUnknownDimension(a.slice(1),n.targetShape));return r.reshape(i)}))}},{key:"getConfig",value:function(){var e={targetShape:this.targetShape},t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gw);CC.className="Reshape",fp(CC);var TC=function(e){h(n,e);var t=g(n);function n(e){var r;if(s(this,n),r=t.call(this,e),null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+"".concat(e.dims," instead."));var a=fx(1,e.dims.length+1);if(!$o(e.dims.slice().sort(),a))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");return r.dims=e.dims,r.dimsIncludingBatch=[0].concat(r.dims),r.inputSpec=[new fw({ndim:r.dims.length+1})],r}return c(n,[{key:"computeOutputShape",value:function(e){var t=(e=ow(e)).slice();return this.dims.forEach((function(n,r){t[r+1]=e[n]})),t}},{key:"call",value:function(e,t){return Rm(iw(e),this.dimsIncludingBatch)}},{key:"getConfig",value:function(){var e={dims:this.dims},t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gw);TC.className="Permute",fp(TC);var EC=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,null==e?{}:e)).supportsMasking=!0,r.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0,r}return c(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=Rw(f(n.prototype),"getConfig",this).call(this),t={maskValue:this.maskValue};return Object.assign(t,e),t}},{key:"computeMask",value:function(e,t){var n=iw(e);return Tp(Qd(n,this.maskValue),-1)}},{key:"call",value:function(e,t){var n=this;return vp((function(){n.invokeCallHook(e,t);var r=iw(e),a=Tp(Qd(r,n.maskValue),-1,!0);return r.mul(a.asType(r.dtype))}))}}]),n}(gw);EC.className="Masking",fp(EC);var IC=function(e){h(n,e);var t=g(n);function n(e){var r;if(s(this,n),(r=t.call(this,e)).embeddings=null,r.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){var a=null;null!=e.batchSize&&(a=e.batchSize),null==e.inputLength?r.batchInputShape=[a,null]:r.batchInputShape=[a].concat(wk(e.inputLength))}return r.inputDim=e.inputDim,Rk(r.inputDim,"inputDim"),r.outputDim=e.outputDim,Rk(r.outputDim,"outputDim"),r.embeddingsInitializer=Jx(e.embeddingsInitializer||r.DEFAULT_EMBEDDINGS_INITIALIZER),r.embeddingsRegularizer=PS(e.embeddingsRegularizer),r.activityRegularizer=PS(e.activityRegularizer),r.embeddingsConstraint=Hk(e.embeddingsConstraint),r.maskZero=e.maskZero,r.supportsMasking=e.maskZero,r.inputLength=e.inputLength,r}return c(n,[{key:"build",value:function(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}},{key:"warnOnIncompatibleInputShape",value:function(e){}},{key:"computeMask",value:function(e,t){var n=this;return vp((function(){return n.maskZero?(e=iw(e),Qd(e,Dm(e))):null}))}},{key:"computeOutputShape",value:function(e){if(e=ow(e),null==this.inputLength)return[].concat(Fn(e),[this.outputDim]);var t=wk(this.inputLength);if(t.length!==e.length-1)throw new mk('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));for(var n=0,r=0;r<t.length;++r){var a=t[r],i=e[r+1];if(null!=a&&null!=i&&a!==i)throw new mk('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));null==a&&(t[n]=i),n++}return[e[0]].concat(Fn(t),[this.outputDim])}},{key:"call",value:function(e,t){var n=this;return vp((function(){n.invokeCallHook(e,t);var r=iw(e);return"int32"!==r.dtype&&(r=px(r,"int32")),Sx(n.embeddings.read(),r.as1D()).reshape(ow(n.computeOutputShape(r.shape)))}))}},{key:"getConfig",value:function(){var e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:$x(this.embeddingsInitializer),embeddingsRegularizer:AS(this.embeddingsRegularizer),activityRegularizer:AS(this.activityRegularizer),embeddingsConstraint:Wk(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gw);IC.className="Embedding",fp(IC);var AC=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,e||{})).supportsMasking=!0,r}return c(n,[{key:"mergeFunction",value:function(e){throw new vk}},{key:"computeElementwiseOpOutputShape",value:function(e,t){if(null==e||null==t)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(0===t.length)return e;for(var n=e.slice(0,e.length-t.length),r=0;r<t.length;++r){var a=e[e.length-t.length+r],i=t[r];if(null==a||null==i||a<0||i<0)n.push(null);else if(1===a)n.push(i);else if(1===i)n.push(a);else{if(a!==i)throw new mk("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(a)}}return n}},{key:"build",value:function(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[ow(e)]),e.length<2)throw new mk("A merge layer should be called on an Array of at least 2 inputs."+" Got ".concat(e.length," input(s)."));var t,n=[],r=zo(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;null!=a&&null!==a[0]&&n.push(a[0])}}catch(ZJ){r.e(ZJ)}finally{r.f()}if((n=Nk(n)).length>1)throw new mk("Can not merge tensors with different batch sizes. "+"Got tensors with shapes: ".concat(JSON.stringify(e),"."));for(var i=null==e[0]?null:e[0].slice(1),o=1;o<e.length;++o){var s=null==e[o]?null:e[o].slice(1);i=this.computeElementwiseOpOutputShape(i,s)}var u=e.map((function(e){return e.length}));-1===e.indexOf(null)&&1===Nk(u).length?this.reshapeRequired=!1:this.reshapeRequired=!0}},{key:"call",value:function(e,t){var n=this;return vp((function(){if(n.reshapeRequired){var t=[],r=e.map((function(e){return e.rank}));if(-1===r.indexOf(null)){var a,i=hx(r),o=zo(e);try{for(o.s();!(a=o.n()).done;){for(var s=a.value,u=s.rank,c=0;c<i-u;++c)s=dx(s,1);t.push(s)}}catch(ZJ){o.e(ZJ)}finally{o.f()}return n.mergeFunction(t)}var l,h=!1,f=zo(e);try{for(f.s();!(l=f.n()).done;){var p=l.value,d=p.rank;if(null==d){var m=p.shape,v=m[0],g=m.slice(1).concat([v]),y=p.reshape([v].concat(ux(m.slice(1))));y=(y=Rm(y,[1,0])).reshape(g),t.push(y),h=!0}else if(d>1){var b=fx(1,d).concat([0]);t.push(Rm(p,b)),h=!0}else t.push(p)}}catch(ZJ){f.e(ZJ)}finally{f.f()}var k=n.mergeFunction(t),x=k.rank;if(h)if(null==x){var w=k.shape,_=w[w.length-1],S=[_].concat(w.slice(0,w.length-1));k=Rm(k.reshape([-1,_]),[1,0]).reshape(S)}else if(x>1){var C=[x-1].concat(fx(0,x-1));k=Rm(k,C)}return k}return n.mergeFunction(e)}))}},{key:"computeOutputShape",value:function(e){var t;t=null==e[0]?null:e[0].slice(1);for(var n=1;n<e.length;++n){var r=null==e[n]?null:e[n].slice(1);t=this.computeElementwiseOpOutputShape(t,r)}var a,i=[],o=zo(e);try{for(o.s();!(a=o.n()).done;){var s=a.value;null!=s&&null!==s[0]&&i.push(s[0])}}catch(ZJ){o.e(ZJ)}finally{o.f()}return t=1===(i=Nk(i)).length?i.concat(t):[null].concat(t)}},{key:"computeMask",value:function(e,t){return vp((function(){if(null==t)return null;if(!Array.isArray(t))throw new mk("`mask` should be an Array");if(!Array.isArray(e))throw new mk("`inputs` should be an Array");if(t.length!==e.length)throw new mk("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths "+"(".concat(e.length," vs ").concat(t.length,")"));if(t.every((function(e){return null==e})))return null;for(var n=(t=t.map((function(e){return null==e?e:vd(e,0)})))[0],r=1;r<t.length-1;++r)n=Md(n,t[r]);return n}))}}]),n}(gw),NC=function(e){h(n,e);var t=g(n);function n(e){return s(this,n),t.call(this,e)}return c(n,[{key:"mergeFunction",value:function(e){return vp((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=Sp(t,e[n]);return t}))}}]),n}(AC);NC.className="Add",fp(NC);var PC=function(e){h(n,e);var t=g(n);function n(e){return s(this,n),t.call(this,e)}return c(n,[{key:"mergeFunction",value:function(e){return vp((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=Id(t,e[n]);return t}))}}]),n}(AC);PC.className="Multiply",fp(PC);var MC=function(e){h(n,e);var t=g(n);function n(e){return s(this,n),t.call(this,e)}return c(n,[{key:"mergeFunction",value:function(e){return vp((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=Sp(t,e[n]);return Id(1/e.length,t)}))}}]),n}(AC);MC.className="Average",fp(MC);var DC=function(e){h(n,e);var t=g(n);function n(e){return s(this,n),t.call(this,e)}return c(n,[{key:"mergeFunction",value:function(e){return vp((function(){for(var t=e[0],n=1;n<e.length;++n)t=Fd(t,e[n]);return t}))}}]),n}(AC);DC.className="Maximum",fp(DC);var RC=function(e){h(n,e);var t=g(n);function n(e){return s(this,n),t.call(this,e)}return c(n,[{key:"mergeFunction",value:function(e){return vp((function(){for(var t=e[0],n=1;n<e.length;++n)t=Bd(t,e[n]);return t}))}}]),n}(AC);RC.className="Minimum",fp(RC);var OC=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).DEFAULT_AXIS=-1,null==e&&(e={}),r.axis=null==e.axis?r.DEFAULT_AXIS:e.axis,r.supportsMasking=!0,r.reshapeRequired=!1,r}return c(n,[{key:"build",value:function(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new mk("A `Concatenate` layer should be called on a list of at least 2 inputs");var t,n=!0,r=zo(e);try{for(r.s();!(t=r.n()).done;){if(null!=t.value){n=!1;break}}}catch(ZJ){r.e(ZJ)}finally{r.f()}if(!n){for(var a=[],i=0;i<e.length;++i){var o=e[i].slice();o.splice(this.axis,1);var s,u=!1,c=zo(a);try{for(c.s();!(s=c.n()).done;){if($o(s.value,o)){u=!0;break}}}catch(ZJ){c.e(ZJ)}finally{c.f()}u||a.push(o)}if(a.length>1)throw new mk("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}}},{key:"mergeFunction",value:function(e){var t=this;return vp((function(){return bx(e,t.axis)}))}},{key:"computeOutputShape",value:function(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new mk("A `Concatenate` layer should be called on a list of inputs.");var t,n=e,r=n[0].slice(),a=this.axis<0?r.length+this.axis:this.axis,i=zo(n.slice(1));try{for(i.s();!(t=i.n()).done;){var o=t.value;if(null==r[a]||null==o[a]){r[a]=null;break}r[a]+=o[a]}}catch(ZJ){i.e(ZJ)}finally{i.f()}return r}},{key:"computeMask",value:function(e,t){var n=this;if(null==t)return null;if(!Array.isArray(t))throw new mk("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new mk("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new mk("Mismatch in the length of mask (".concat(t.length,") ")+"and the legnth of inputs (".concat(e.length,")"));return vp((function(){var r=!0;if(t.forEach((function(e){null==e||(r=!1)})),r)return null;for(var a=[],i=0;i<e.length;++i)null==t[i]?a.push(em(e[i]).asType("bool")):t[i].rank<e[i].rank?a.push(vd(t[i],-1)):a.push(t[i]);var o=Jp(a,n.axis);return Cp(o,-1,!1)}))}},{key:"getConfig",value:function(){var e={axis:this.axis},t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(AC);function FC(e,t){for(;e<0;)e+=t;return e}OC.className="Concatenate",fp(OC);var LC=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).axes=e.axes,r.normalize=null!=e.normalize&&e.normalize,r.supportsMasking=!0,r.reshapeRequired=!1,r}return c(n,[{key:"build",value:function(e){Ho(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var t=e[0],n=e[1];if(t.length>3||n.length>3)throw new vk("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(t,n);if(t[r[0]]!==n[r[1]])throw new mk("Dimension incompatibility: "+"".concat(t[r[0]]," !== ").concat(n[r[1]]))}},{key:"mergeFunction",value:function(e){if(2!==e.length)throw new mk("A `Dot` layer must be called on exactly 2 inputs, "+"but received ".concat(e.length," input(s)."));var t,n=e[0],r=e[1];return t=Array.isArray(this.axes)?this.axes.map((function(t,n){return FC(t,e[n].shape.length)})):[FC(this.axes,n.shape.length),FC(this.axes,r.shape.length)],this.normalize&&(n=Fw(n,t[0]),r=Fw(r,t[1])),function(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new vk("batchDot is not implemented for tensors of 4D or higher rank yet");if(Ho(e.shape.length>=2,(function(){return"batchDot requires the rank of x to be >= 2, "+"but got ".concat(e.shape.length)})),Ho(e.shape.length>=2,(function(){return"batchDot requires the rank of y to be >= 2, "+"but got ".concat(t.shape.length)})),"number"===typeof n&&(n=[n,n]),"complex64"===e.dtype||"complex64"===t.dtype)throw new vk("batchDot is not implemented for complex64-type Tensors yet.");var r=e.shape.length,a=t.shape.length;null==n&&(n=[r-1,a-2]);var i=n;return vp((function(){var n,o;if(r>a){n=r-a;for(var s=[],u=0;u<n;++u)s.push(1);t=t.reshape(t.shape.concat(s))}else if(a>r){n=a-r;for(var c=[],l=0;l<n;++l)c.push(1);e=e.reshape(e.shape.concat(c))}else n=0;if(2===e.shape.length&&2===t.shape.length)o=i[0]===i[1]?e.mul(t).sum(i[0]):e.transpose([1,0]).mul(t).sum(i[1]);else{var h=i[0]!==e.shape.length-1,f=i[1]===t.shape.length-1;o=e.matMul(t,h,f)}if(n>0){for(var p,d=[],m=p=r>a?r+a-3:r-1;m<p+n;++m)d.push(m);o=o.squeeze(d)}return 1===o.shape.length&&(o=o.expandDims(1)),o}))}(n,r,t)}},{key:"interpretAxes",value:function(e,t){return Array.isArray(this.axes)?this.axes:[FC(this.axes,e.length),FC(this.axes,t.length)]}},{key:"computeOutputShape",value:function(e){Ho(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new vk("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(t,n);t.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);var a=t.concat(n);return 1===a.length&&a.push(1),a}},{key:"computeMask",value:function(e,t){return null}},{key:"getConfig",value:function(){var e={axes:this.axes,normalize:this.normalize},t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(AC);LC.className="Dot",fp(LC);var zC=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).supportsMasking=!0,r.stddev=e.stddev,r}return c(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=Rw(f(n.prototype),"getConfig",this).call(this),t={stddev:this.stddev};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return vp((function(){n.invokeCallHook(e,t);var r=iw(e);return Nx((function(){return wx(r.shape,0,n.stddev).add(r)}),(function(){return r}),t.training||!1)}))}}]),n}(gw);zC.className="GaussianNoise",fp(zC);var BC=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).supportsMasking=!0,r.rate=e.rate,r}return c(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=Rw(f(n.prototype),"getConfig",this).call(this),t={rate:this.rate};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return vp((function(){n.invokeCallHook(e,t);var r=iw(e);if(n.rate>0&&n.rate<1){return Nx((function(){var e=Math.sqrt(n.rate/(1-n.rate));return r.mul(wx(r.shape,1,e))}),(function(){return r}),t.training||!1)}return r}))}}]),n}(gw);BC.className="GaussianDropout",fp(BC);var VC=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).supportsMasking=!0,r.rate=e.rate,r.noiseShape=e.noiseShape,r}return c(n,[{key:"_getNoiseShape",value:function(e){return this.noiseShape||iw(e).shape}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=Rw(f(n.prototype),"getConfig",this).call(this),t={rate:this.rate};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return vp((function(){if(n.rate<1&&n.rate>0){var r=n._getNoiseShape(e);return Nx((function(){var t=iw(e),a=-1.7580993408473766,i=_d(sm(r),n.rate);i=px(i,"float32");var o=Math.pow((1-n.rate)*(1+n.rate*Math.pow(a,2)),-.5),s=-o*a*n.rate;return t.mul(i).add(i.add(-1).mul(a)).mul(o).add(s)}),(function(){return iw(e)}),t.training||!1)}return e}))}}]),n}(gw);function jC(e,t,n,r,a){var i,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.001;if(2===e.rank)i=Xp(e,t,n,r,a,o);else if(3===e.rank)i=Yp(e,t,n,r,a,o);else{if(4!==e.rank)throw new vk("batchNormalization is not implemented for array of rank ".concat(e.rank," ")+"yet");i=Qp(e,t,n,r,a,o)}return i}function qC(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return vp((function(){var i=Xd(e,r),o=i.mean,s=i.variance;return[jC(e,o,s,n,t,a),o,s]}))}function GC(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return vp((function(){var i,o=Xd(e,r),s=o.mean,u=o.variance,c=[],l=zo(fx(0,e.rank));try{for(l.s();!(i=l.n()).done;){var h=i.value;-1!==r.indexOf(h)?c.push(1):c.push(e.shape[h])}}catch(ZJ){l.e(ZJ)}finally{l.f()}var f=s.reshape(c),p=u.reshape(c),d=null==t?null:t.reshape(c),m=null==n?null:n.reshape(c);return[jC(e,f,p,m,d,a),s,u]}))}VC.className="AlphaDropout",fp(VC);var WC=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),null==e&&(e={}),(r=t.call(this,e)).supportsMasking=!0,r.axis=null==e.axis?-1:e.axis,r.momentum=null==e.momentum?.99:e.momentum,r.epsilon=null==e.epsilon?.001:e.epsilon,r.center=null==e.center||e.center,r.scale=null==e.scale||e.scale,r.betaInitializer=Jx(e.betaInitializer||"zeros"),r.gammaInitializer=Jx(e.gammaInitializer||"ones"),r.movingMeanInitializer=Jx(e.movingMeanInitializer||"zeros"),r.movingVarianceInitializer=Jx(e.movingVarianceInitializer||"ones"),r.betaConstraint=Hk(e.betaConstraint),r.gammaConstraint=Hk(e.gammaConstraint),r.betaRegularizer=PS(e.betaRegularizer),r.gammaRegularizer=PS(e.gammaRegularizer),r}return c(n,[{key:"build",value:function(e){e=ow(e);var t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(null==n)throw new mk("Axis ".concat(t," of input tensor should have a defined dimension but ")+"the layer received an input with shape "+"".concat(JSON.stringify(e),"."));this.inputSpec=[new fw({ndim:e.length,axes:ot({},t,n)})];var r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}},{key:"call",value:function(e,t){var n=this;return vp((function(){var r=null!=t.training&&t.training,a=iw(e),i=a.shape,o=i.length,s=fx(0,o),u=n.axis>=0?n.axis:n.axis+o;s.splice(u,1);var c=yk(1,o);c[u]=i[u];var l=s.slice();l.sort();var h=!$o(l,fx(0,o).slice(0,o-1));if(!r)return function(){if(h){var e=n.movingMean.read().reshape(c),t=n.movingVariance.read().reshape(c),r=n.center?n.beta.read().reshape(c):null,i=n.scale?n.gamma.read().reshape(c):null;return jC(a,e,t,r,i,n.epsilon)}return jC(a,n.movingMean.read(),n.movingVariance.read(),null==n.beta?null:n.beta.read(),null==n.gamma?null:n.gamma.read(),n.epsilon)}();var f=function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return $o(r.slice().sort(),fx(0,e.rank-1))?qC(e,t,n,r,a):GC(e,t,n,r,a)}(a,n.gamma.read(),n.beta.read(),s,n.epsilon),p=Ct(f,3),d=p[0],m=p[1],v=p[2],g=function(e,t,n){vp((function(){var r=1-n,a=e.read(),i=a.sub(t).mul(r);e.write(a.sub(i))}))};return g(n.movingMean,m,n.momentum),g(n.movingVariance,v,n.momentum),d}))}},{key:"getConfig",value:function(){var e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:$x(this.betaInitializer),gammaInitializer:$x(this.gammaInitializer),movingMeanInitializer:$x(this.movingMeanInitializer),movingVarianceInitializer:$x(this.movingVarianceInitializer),betaRegularizer:AS(this.betaRegularizer),gammaRegularizer:AS(this.gammaRegularizer),betaConstraint:Wk(this.betaConstraint),gammaConstraint:Wk(this.gammaConstraint)},t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gw);WC.className="BatchNormalization",fp(WC);var UC=function(e){h(n,e);var t=g(n);function n(e){var r;if(s(this,n),null==e&&(e={}),(r=t.call(this,e)).axis=null==e.axis?-1:e.axis,"number"===typeof r.axis){if(!Number.isInteger(r.axis))throw new Error("Expected axis to be an integer, but received ".concat(r.axis))}else{if(!Array.isArray(r.axis))throw new Error("Expected axis to be an integer or an array of integers, "+"but received ".concat(JSON.stringify(r.axis)));var a,i=zo(r.axis);try{for(i.s();!(a=i.n()).done;){var o=a.value;if(!Number.isInteger(o))throw new Error("Expected axis to be an array of integers, "+"but received ".concat(JSON.stringify(r.axis)))}}catch(ZJ){i.e(ZJ)}finally{i.f()}}return r.epsilon=null==e.epsilon?.001:e.epsilon,r.center=null==e.center||e.center,r.scale=null==e.scale||e.scale,r.betaInitializer=Jx(e.betaInitializer||"zeros"),r.gammaInitializer=Jx(e.gammaInitializer||"ones"),r.betaRegularizer=PS(e.betaRegularizer),r.gammaRegularizer=PS(e.gammaRegularizer),r.supportsMasking=!0,r}return c(n,[{key:"build",value:function(e){var t=(e=ow(e)).length;"number"===typeof this.axis&&(this.axis=[this.axis]);for(var n=0;n<this.axis.length;++n)this.axis[n]<0&&(this.axis[n]+=t);var r,a=zo(this.axis);try{for(a.s();!(r=a.n()).done;){var i=r.value;if(i<0||i>=t)throw new Error("Invalid axis: ".concat(i))}}catch(ZJ){a.e(ZJ)}finally{a.f()}if(this.axis.length!==Nk(this.axis).length)throw new Error("Found duplicate axes in: ".concat(this.axis));var o=this.axis.map((function(t){return e[t]}));this.scale?this.gamma=this.addWeight("gamma",o,"float32",this.gammaInitializer,this.gammaRegularizer,true):this.gamma=null,this.center?this.beta=this.addWeight("beta",o,"float32",this.betaInitializer,this.betaRegularizer,true):this.beta=null,this.built=!0}},{key:"call",value:function(e,t){var n=this,r=iw(e),a=r.shape,i=a.length;return vp((function(){var e,t=Xd(r,n.axis,!0),o=t.mean,s=t.variance,u=yk(1,i),c=zo(n.axis);try{for(c.s();!(e=c.n()).done;){var l=e.value;u[l]=a[l]}}catch(ZJ){c.e(ZJ)}finally{c.f()}for(var h=function(e){return null!=e&&e.shape.length!==i&&n.axis!==[i-1]?e.reshape(u):e},f=h(n.gamma.read()),p=h(n.beta.read()),d=[],m=[],v=0;v<i;++v)-1!==n.axis.indexOf(v)?(d.push(a[v]),m.push(1)):(d.push(1),m.push(a[v]));return o=o.tile(d),s=s.tile(d),f=f.tile(m),p=p.tile(m),jC(r,o,s,p,f,n.epsilon)}))}},{key:"getConfig",value:function(){var e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:$x(this.betaInitializer),gammaInitializer:$x(this.gammaInitializer),betaRegularizer:AS(this.betaRegularizer),gammaRegularizer:AS(this.gammaRegularizer)},t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gw);UC.className="LayerNormalization",fp(UC);var HC=function(e){h(n,e);var t=g(n);function n(e){var r;if(s(this,n),null==e&&(e={}),(r=t.call(this,e)).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)r.padding=[[1,1],[1,1]];else if("number"===typeof e.padding)r.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new mk("ZeroPadding2D expects padding to be a length-2 array, but "+"received a length-".concat(e.padding.length," array."));var a,i;if("number"===typeof e.padding[0])a=[e.padding[0],e.padding[0]],i=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new mk("ZeroPadding2D expects height padding to be a length-2 array, "+"but received a length-".concat(e.padding[0].length," array."));if(a=e.padding[0],2!==e.padding[1].length)throw new mk("ZeroPadding2D expects width padding to be a length-2 array, "+"but received a length-".concat(e.padding[1].length," array."));i=e.padding[1]}r.padding=[a,i]}return r.inputSpec=[new fw({ndim:4})],r}return c(n,[{key:"computeOutputShape",value:function(e){var t,n;return e=ow(e),"channelsFirst"===this.dataFormat?(t=null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],t,n]):(t=null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],t,n,e[3]])}},{key:"call",value:function(e,t){var n=this;return vp((function(){return function(e,t,n){return vp((function(){if(4!==e.rank)throw new mk("temporalPadding expects input tensor to be 4-D, but received a "+"".concat(e.rank,"-D tensor."));if(null==t&&(t=[[1,1],[1,1]]),2!==t.length||2!==t[0].length||2!==t[1].length)throw new mk("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==n&&(n="channelsLast"),"channelsLast"!==n&&"channelsFirst"!==n)throw new mk("Unknown data format: ".concat(n,". ")+"Supported data formats are 'channelsLast' and 'channelsFirst.");var r;return r="channelsFirst"===n?[[0,0],[0,0],t[0],t[1]]:[[0,0],t[0],t[1],[0,0]],tm(e,r)}))}(iw(e),n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var e={padding:this.padding,dataFormat:this.dataFormat},t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gw);function KC(e,t,n,r,a,i){return vp((function(){var o;Zk(a),tx(i),ex(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),e=jS(e,a);var s="same"===r?"same":"valid";return o="max"===i?Rd(e,t,n,s):Wp(e,t,n,s),"channelsFirst"===a&&(o=Rm(o,[0,3,1,2])),o}))}function XC(e,t,n,r,a,i){return vp((function(){var o;Zk(a),tx(i),ex(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),e=qS(e,a);var s="same"===r?"same":"valid";return o="max"===i?Od(e,t,n,s):Up(e,t,n,s),"channelsFirst"===a&&(o=Rm(o,[0,4,1,2,3])),o}))}HC.className="ZeroPadding2D",fp(HC);var YC=function(e){h(n,e);var t=g(n);function n(e){var r;if(s(this,n),null==e.poolSize&&(e.poolSize=2),r=t.call(this,e),"number"===typeof e.poolSize)r.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||1!==e.poolSize.length||"number"!==typeof e.poolSize[0])throw new mk("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.poolSize)));r.poolSize=e.poolSize}if(Rk(r.poolSize,"poolSize"),null==e.strides)r.strides=r.poolSize;else if("number"===typeof e.strides)r.strides=[e.strides];else{if(!Array.isArray(e.strides)||1!==e.strides.length||"number"!==typeof e.strides[0])throw new mk("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.strides)));r.strides=e.strides}return Rk(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,ex(r.padding),r.inputSpec=[new fw({ndim:3})],r}return c(n,[{key:"computeOutputShape",value:function(e){var t=BS((e=ow(e))[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}},{key:"call",value:function(e,t){var n=this;return vp((function(){n.invokeCallHook(e,t),e=dx(iw(e),2);var r=n.poolingFunction(iw(e),[n.poolSize[0],1],[n.strides[0],1],n.padding,"channelsLast");return _m(r,[2])}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gw),QC=function(e){h(n,e);var t=g(n);function n(e){return s(this,n),t.call(this,e)}return c(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return Zk(a),ex(r),KC(e,t,n,r,a,"max")}}]),n}(YC);QC.className="MaxPooling1D",fp(QC);var $C=function(e){h(n,e);var t=g(n);function n(e){return s(this,n),t.call(this,e)}return c(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return Zk(a),ex(r),KC(e,t,n,r,a,"avg")}}]),n}(YC);$C.className="AveragePooling1D",fp($C);var JC=function(e){h(n,e);var t=g(n);function n(e){var r;if(s(this,n),null==e.poolSize&&(e.poolSize=[2,2]),(r=t.call(this,e)).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)r.strides=r.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new mk("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+"".concat(e.strides.length,"."));r.strides=e.strides}else r.strides=[e.strides,e.strides];return Rk(r.poolSize,"poolSize"),Rk(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Zk(r.dataFormat),ex(r.padding),r.inputSpec=[new fw({ndim:4})],r}return c(n,[{key:"computeOutputShape",value:function(e){e=ow(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2];return t=BS(t,this.poolSize[0],this.padding,this.strides[0]),n=BS(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}},{key:"call",value:function(e,t){var n=this;return vp((function(){return n.invokeCallHook(e,t),n.poolingFunction(iw(e),n.poolSize,n.strides,n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gw),ZC=function(e){h(n,e);var t=g(n);function n(e){return s(this,n),t.call(this,e)}return c(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return Zk(a),ex(r),KC(e,t,n,r,a,"max")}}]),n}(JC);ZC.className="MaxPooling2D",fp(ZC);var eT=function(e){h(n,e);var t=g(n);function n(e){return s(this,n),t.call(this,e)}return c(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return Zk(a),ex(r),KC(e,t,n,r,a,"avg")}}]),n}(JC);eT.className="AveragePooling2D",fp(eT);var tT=function(e){h(n,e);var t=g(n);function n(e){var r;if(s(this,n),null==e.poolSize&&(e.poolSize=[2,2,2]),(r=t.call(this,e)).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],null==e.strides)r.strides=r.poolSize;else if(Array.isArray(e.strides)){if(3!==e.strides.length)throw new mk("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+"".concat(e.strides.length,"."));r.strides=e.strides}else r.strides=[e.strides,e.strides,e.strides];return Rk(r.poolSize,"poolSize"),Rk(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Zk(r.dataFormat),ex(r.padding),r.inputSpec=[new fw({ndim:5})],r}return c(n,[{key:"computeOutputShape",value:function(e){e=ow(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[4]:e[3];return t=BS(t,this.poolSize[0],this.padding,this.strides[0]),n=BS(n,this.poolSize[1],this.padding,this.strides[1]),r=BS(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n,r]:[e[0],t,n,r,e[4]]}},{key:"call",value:function(e,t){var n=this;return vp((function(){return n.invokeCallHook(e,t),n.poolingFunction(iw(e),n.poolSize,n.strides,n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gw),nT=function(e){h(n,e);var t=g(n);function n(e){return s(this,n),t.call(this,e)}return c(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return Zk(a),ex(r),XC(e,t,n,r,a,"max")}}]),n}(tT);nT.className="MaxPooling3D",fp(nT);var rT=function(e){h(n,e);var t=g(n);function n(e){return s(this,n),t.call(this,e)}return c(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return Zk(a),ex(r),XC(e,t,n,r,a,"avg")}}]),n}(tT);rT.className="AveragePooling3D",fp(rT);var aT=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).inputSpec=[new fw({ndim:3})],r}return c(n,[{key:"computeOutputShape",value:function(e){return[e[0],e[2]]}},{key:"call",value:function(e,t){throw new vk}}]),n}(gw),iT=function(e){h(n,e);var t=g(n);function n(e){return s(this,n),t.call(this,e||{})}return c(n,[{key:"call",value:function(e,t){return vp((function(){var t=iw(e);return Ld(t,1)}))}}]),n}(aT);iT.className="GlobalAveragePooling1D",fp(iT);var oT=function(e){h(n,e);var t=g(n);function n(e){return s(this,n),t.call(this,e||{})}return c(n,[{key:"call",value:function(e,t){return vp((function(){var t=iw(e);return Ed(t,1)}))}}]),n}(aT);oT.className="GlobalMaxPooling1D",fp(oT);var sT=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Zk(r.dataFormat),r.inputSpec=[new fw({ndim:4})],r}return c(n,[{key:"computeOutputShape",value:function(e){return"channelsLast"===this.dataFormat?[e[0],e[3]]:[e[0],e[1]]}},{key:"call",value:function(e,t){throw new vk}},{key:"getConfig",value:function(){var e={dataFormat:this.dataFormat},t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gw),uT=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"call",value:function(e,t){var n=this;return vp((function(){var t=iw(e);return"channelsLast"===n.dataFormat?Ld(t,[1,2]):Ld(t,[2,3])}))}}]),n}(sT);uT.className="GlobalAveragePooling2D",fp(uT);var cT=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"call",value:function(e,t){var n=this;return vp((function(){var t=iw(e);return"channelsLast"===n.dataFormat?Ed(t,[1,2]):Ed(t,[2,3])}))}}]),n}(sT);cT.className="GlobalMaxPooling2D",fp(cT);var lT=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).layer=e.layer,r}return c(n,[{key:"build",value:function(e){this.built=!0}},{key:"trainable",get:function(){return null!=this.layer&&this.layer.trainable},set:function(e){null!=this.layer&&(this.layer.trainable=e)}},{key:"trainableWeights",get:function(){return this.layer.trainableWeights}},{key:"nonTrainableWeights",get:function(){return this.layer.nonTrainableWeights}},{key:"updates",get:function(){return this.layer._updates}},{key:"losses",get:function(){return this.layer.losses}},{key:"getWeights",value:function(){return this.layer.getWeights()}},{key:"setWeights",value:function(e){this.layer.setWeights(e)}},{key:"getConfig",value:function(){var e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"setFastWeightInitDuringBuild",value:function(e){Rw(f(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.layer,a=Ow(r,n);delete t.layer;var i={layer:a};return Object.assign(i,t),new e(i)}}]),n}(gw),hT=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).supportsMasking=!0,r}return c(n,[{key:"build",value:function(e){if((e=ow(e)).length<3)throw new mk("TimeDistributed layer expects an input shape >= 3D, but received "+"input shape ".concat(JSON.stringify(e)));this.inputSpec=[{shape:e}];var t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),Rw(f(n.prototype),"build",this).call(this,e)}},{key:"computeOutputShape",value:function(e){var t=[(e=ow(e))[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),r=e[1];return[n[0],r].concat(n.slice(1))}},{key:"call",value:function(e,t){var n=this;return vp((function(){return aC((function(e,r){return[iw(n.layer.call(e,t)),[]]}),e=iw(e),[],!1,null,null,!1,!0)[1]}))}}]),n}(lT);hT.className="TimeDistributed",fp(hT);var fT=function(e){h(n,e);var t=g(n);function n(e){var r;s(this,n),r=t.call(this,e);var a=e.layer.getConfig(),i={};i.className=e.layer.getClassName(),i.config=a,r.forwardLayer=Ow(i),a.goBackwards=!0!==a.goBackwards;var o,u={};if(u.className=e.layer.getClassName(),u.config=a,r.backwardLayer=Ow(u),r.forwardLayer.name="forward_"+r.forwardLayer.name,r.backwardLayer.name="backward_"+r.backwardLayer.name,r.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,o=r.mergeMode,Mk($k,"BidirectionalMergeMode",o),e.weights)throw new vk("weights support is not implemented for Bidirectional layer yet.");return r._stateful=e.layer.stateful,r.returnSequences=e.layer.returnSequences,r.returnState=e.layer.returnState,r.supportsMasking=!0,r._trainable=!0,r.inputSpec=e.layer.inputSpec,r.numConstants=null,r}return c(n,[{key:"trainable",get:function(){return this._trainable},set:function(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)}},{key:"getWeights",value:function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}},{key:"setWeights",value:function(e){var t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}},{key:"computeOutputShape",value:function(e){var t,n,r,a=this.forwardLayer.computeOutputShape(e);return Array.isArray(a)&&Array.isArray(a[0])||(a=[a]),this.returnState?(r=a.slice(1),t=a[0]):t=a[0],"concat"===this.mergeMode?(t[t.length-1]*=2,n=[t]):n=null==this.mergeMode?[t,t.slice()]:[t],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[t].concat(r).concat(r.slice()):xk(n)}},{key:"apply",value:function(e,t){var r=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});var i=rC(e,r,a,this.numConstants);if(e=i.inputs,r=i.initialState,a=i.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(null==r||0===r.length)&&null==a)return Rw(f(n.prototype),"apply",this).call(this,e,t);var o=[],s=[];if(null!=r){var u=r.length;if(u%2>0)throw new mk("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=r,o.push.apply(o,Fn(r));var c=r.map((function(e){return new fw({shape:e.shape})}));this.forwardLayer.stateSpec=c.slice(0,u/2),this.backwardLayer.stateSpec=c.slice(u/2),s.push.apply(s,Fn(c))}if(null!=a)throw new vk("Support for constants in Bidirectional layers is not implemented yet.");for(var l=o[0]instanceof pw,h=0,p=o;h<p.length;h++){if(p[h]instanceof pw!==l)throw new mk("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors")}if(l){var d=[e].concat(o),m=this.inputSpec.concat(s),v=this.inputSpec;this.inputSpec=m;var g=Rw(f(n.prototype),"apply",this).call(this,d,t);return this.inputSpec=v,g}return Rw(f(n.prototype),"apply",this).call(this,e,t)}},{key:"call",value:function(e,t){var n=this;return vp((function(){var r,a,i,o,s=t.initialState;if(null==s)r=n.forwardLayer.call(e,t),a=n.backwardLayer.call(e,t);else{var u=s.slice(0,s.length/2),c=s.slice(s.length/2);r=n.forwardLayer.call(e,Object.assign(t,{initialState:u})),a=n.backwardLayer.call(e,Object.assign(t,{initialState:c}))}return n.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(a.slice(1))),r=r[0],a=a[0]),n.returnSequences&&(a=cm(a,1)),"concat"===n.mergeMode?o=bx([r,a]):"sum"===n.mergeMode?o=Sp(r,a):"ave"===n.mergeMode?o=Id(.5,Sp(r,a)):"mul"===n.mergeMode?o=Id(r,a):null==n.mergeMode&&(o=[r,a]),n.returnState?null==n.mergeMode?o.concat(i):[o].concat(i):o}))}},{key:"resetStates",value:function(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}},{key:"build",value:function(e){var t=this;rx(this.forwardLayer.name,(function(){t.forwardLayer.build(e)})),rx(this.backwardLayer.name,(function(){t.backwardLayer.build(e)})),this.built=!0}},{key:"computeMask",value:function(e,t){var n;if(Array.isArray(t)&&(t=t[0]),n=this.returnSequences?null==this.mergeMode?[t,t]:t:null==this.mergeMode?[null,null]:null,this.returnState){var r=this.forwardLayer.states.map((function(e){return null}));return Array.isArray(n)?n.concat(r).concat(r):[n].concat(r).concat(r)}return n}},{key:"trainableWeights",get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}},{key:"nonTrainableWeights",get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}},{key:"setFastWeightInitDuringBuild",value:function(e){Rw(f(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)}},{key:"getConfig",value:function(){var e={mergeMode:this.mergeMode},t=Rw(f(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"fromConfig",value:function(e,t){var n=Ow(t.layer);if(delete t.layer,null!=t.numConstants)throw new vk("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var r=t;return r.layer=n,new e(r)}}]),n}(lT);function pT(e){return new XS(e)}function dT(e){return new _C(e)}function mT(e){return new xC(e)}function vT(e){return new WC(e)}function gT(e){return new ZC(e)}function yT(e){return new fC(e)}fT.className="Bidirectional",fp(fT);var bT,kT;!function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"}(bT||(bT={})),function(e){!function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(kT||(kT={}));var xT=__webpack_require__(6699);function wT(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;if(null==e)return null;if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);var a=t(e);if(a.recurse&&null!==a.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(a.recurse){if(TT(e)){var i=Array.isArray(e)?[]:{};for(var o in r.add(e),e){var s=e[o],u=wT(s,t,n,r);i[o]=u}return r.delete(e),i}throw new Error("Can't recurse into non-iterable type: ".concat(e))}return n.set(e,a.value),a.value}function _T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:CT;return ST(e,t)}function ST(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set,r=e[0];if(n.has(r))throw new Error("Circular references are not supported.");var a=t(e);if(a.recurse&&null!==a.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(a.recurse){if(TT(r)){var i=Array.isArray(r)?[]:{};n.add(r);var o=function(r){var a=ST(e.map((function(e){return e[r]})),t,n);i[r]=a};for(var s in r)o(s);return n.delete(r),i}throw new Error("Can't recurse into non-iterable type: ".concat(r))}return a.value}function CT(e){return null===e?null:TT(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}function TT(e){return null!=e&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||"object"===typeof e&&!(e instanceof Xl))}function ET(e){return function(e,t){return wT(e,t)}(e,IT)}function IT(e){return e instanceof Xl?{value:e.clone(),recurse:!1}:TT(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}var AT=function(){function e(t){if(s(this,e),this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}return c(e,[{key:"wrap",value:function(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}},{key:"get",value:function(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}},{key:"set",value:function(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}},{key:"length",value:function(){var e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}},{key:"isFull",value:function(){return this.length()===this.capacity}},{key:"isEmpty",value:function(){return 0===this.length()}},{key:"push",value:function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}},{key:"pushAll",value:function(e){var t,n=zo(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.push(r)}}catch(ZJ){n.e(ZJ)}finally{n.f()}}},{key:"pop",value:function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var e=this.get(this.end);return this.set(this.end,void 0),e}},{key:"unshift",value:function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}},{key:"shift",value:function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}},{key:"shuffleExcise",value:function(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}}]),e}(),NT=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.call(this,n.INITIAL_CAPACITY)}return c(n,[{key:"isFull",value:function(){return!1}},{key:"push",value:function(e){Rw(f(n.prototype),"isFull",this).call(this)&&this.expand(),Rw(f(n.prototype),"push",this).call(this,e)}},{key:"unshift",value:function(e){Rw(f(n.prototype),"isFull",this).call(this)&&this.expand(),Rw(f(n.prototype),"unshift",this).call(this,e)}},{key:"expand",value:function(){for(var e=2*this.capacity,t=new Array(e),n=this.length(),r=0;r<n;r++)t[r]=this.get(this.wrap(this.begin+r));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}]),n}(AT);function PT(e){return new FT(e)}function MT(e,t){return new KT(e,t)}NT.INITIAL_CAPACITY=32;var DT,RT=function(){function e(){s(this,e)}return c(e,[{key:"toArray",value:function(){var e=_(x().mark((function e(){var t,n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,this.next();case 3:n=e.sent;case 4:if(n.done){e.next=11;break}return t.push(n.value),e.next=8,this.next();case 8:n=e.sent,e.next=4;break;case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toArrayForTest",value:function(){var e=_(x().mark((function e(){var t,n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.prefetch(100),n=[],e.next=4,t.next();case 4:r=e.sent;case 5:if(r.done){e.next=12;break}return n.push(r.value),e.next=9,t.next();case 9:r=e.sent,e.next=5;break;case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resolveFully",value:function(){var e=_(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.next();case 2:t=e.sent;case 3:if(t.done){e.next=9;break}return e.next=6,this.next();case 6:t=e.sent,e.next=3;break;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resolveWhile",value:function(){var e=_(x().mark((function e(t){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.next();case 2:n=e.sent,r=t(n.value);case 4:if(n.done||!r){e.next=11;break}return e.next=7,this.next();case 7:n=e.sent,r=t(n.value),e.next=4;break;case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleErrors",value:function(e){return new GT(this,e)}},{key:"filter",value:function(e){return new jT(this,e)}},{key:"map",value:function(e){return new qT(this,e)}},{key:"mapAsync",value:function(e){return new WT(this,e)}},{key:"serialMapAsync",value:function(e){return new WT(this,e).serial()}},{key:"flatmap",value:function(e){return new HT(this,e)}},{key:"forEachAsync",value:function(){var e=_(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.map(t).resolveFully());case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"serialForEach",value:function(){var e=_(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.serialMapAsync(t).resolveWhile((function(e){return!0===e})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"rowMajorBatch",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new VT(this,e,t)}},{key:"columnMajorBatch",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:CT,r=this.rowMajorBatch(e,t);return r.map((function(e){return _T(e,n)}))}},{key:"concatenate",value:function(e,t){return new KT(new OT([this,e]),t)}},{key:"take",value:function(e){return e<0||null==e?this:new BT(this,e)}},{key:"skip",value:function(e){return e<0||null==e?this:new zT(this,e)}},{key:"prefetch",value:function(e){return new XT(this,e)}},{key:"shuffle",value:function(e,t){return new YT(this,e,t)}},{key:"serial",value:function(){return new LT(this)}}]),e}(),OT=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this)).items=e,r.trav=0,r}return c(n,[{key:"summary",value:function(){return"Array of ".concat(this.items.length," items")}},{key:"next",value:function(){var e=_(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.trav>=this.items.length)){e.next=2;break}return e.abrupt("return",{value:null,done:!0});case 2:return t=this.items[this.trav],this.trav++,e.abrupt("return",{value:ET(t),done:!1});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(RT),FT=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this)).nextFn=e,r}return c(n,[{key:"summary",value:function(){return"Function call"}},{key:"next",value:function(){var e=_(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",this.nextFn());case 4:throw e.prev=4,e.t0=e.catch(0),e.t0.message="Error thrown while iterating through a dataset: ".concat(e.t0.message),e.t0;case 8:case"end":return e.stop()}}),e,this,[[0,4]])})));return function(){return e.apply(this,arguments)}}()}]),n}(RT),LT=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this)).upstream=e,r.lastRead=Promise.resolve({value:null,done:!1}),r}return c(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Serial")}},{key:"next",value:function(){var e=_(x().mark((function e(){var t=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=_(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.upstream.next());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(RT),zT=function(e){h(n,e);var t=g(n);function n(e,r){var a;return s(this,n),(a=t.call(this)).upstream=e,a.maxCount=r,a.count=0,a.lastRead=Promise.resolve({value:null,done:!1}),a}return c(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Skip")}},{key:"next",value:function(){var e=_(x().mark((function e(){var t=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=_(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.count++<this.maxCount)){e.next=9;break}return e.next=3,this.upstream.next();case 3:if(!(t=e.sent).done){e.next=6;break}return e.abrupt("return",t);case 6:gp(t.value),e.next=0;break;case 9:return e.abrupt("return",this.upstream.next());case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(RT),BT=function(e){h(n,e);var t=g(n);function n(e,r){var a;return s(this,n),(a=t.call(this)).upstream=e,a.maxCount=r,a.count=0,a}return c(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Take")}},{key:"next",value:function(){var e=_(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.count++>=this.maxCount)){e.next=2;break}return e.abrupt("return",{value:null,done:!0});case 2:return e.abrupt("return",this.upstream.next());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(RT),VT=function(e){h(n,e);var t=g(n);function n(e,r){var a,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return s(this,n),(a=t.call(this)).upstream=e,a.batchSize=r,a.enableSmallLastBatch=i,a.lastRead=Promise.resolve({value:null,done:!1}),a}return c(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> RowMajorBatch")}},{key:"next",value:function(){var e=_(x().mark((function e(){var t=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=_(x().mark((function e(){var t,n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[];case 1:if(!(t.length<this.batchSize)){e.next=12;break}return e.next=4,this.upstream.next();case 4:if(!(n=e.sent).done){e.next=9;break}if(!(this.enableSmallLastBatch&&t.length>0)){e.next=8;break}return e.abrupt("return",{value:t,done:!1});case 8:return e.abrupt("return",{value:null,done:!0});case 9:t.push(n.value),e.next=1;break;case 12:return e.abrupt("return",{value:t,done:!1});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(RT),jT=function(e){h(n,e);var t=g(n);function n(e,r){var a;return s(this,n),(a=t.call(this)).upstream=e,a.predicate=r,a.lastRead=Promise.resolve({value:null,done:!1}),a}return c(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Filter")}},{key:"next",value:function(){var e=_(x().mark((function e(){var t=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=_(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,this.upstream.next();case 3:if(!(t=e.sent).done&&!this.predicate(t.value)){e.next=6;break}return e.abrupt("return",t);case 6:gp(t.value),e.next=0;break;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(RT),qT=function(e){h(n,e);var t=g(n);function n(e,r){var a;return s(this,n),(a=t.call(this)).upstream=e,a.transform=r,a}return c(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Map")}},{key:"next",value:function(){var e=_(x().mark((function e(){var t,n,r,a,i,o,s;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:n=oh(t.value),r=this.transform(t.value),a=oh(r),i=zo(n);try{for(i.s();!(o=i.n()).done;)ih(s=o.value,a)||s.dispose()}catch(ZJ){i.e(ZJ)}finally{i.f()}return e.abrupt("return",{value:r,done:!1});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(RT),GT=function(e){h(n,e);var t=g(n);function n(e,r){var a;return s(this,n),(a=t.call(this)).upstream=e,a.handler=r,a.count=0,a.lastRead=Promise.resolve({value:null,done:!1}),a}return c(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> handleErrors")}},{key:"next",value:function(){var e=_(x().mark((function e(){var t=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=_(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,this.upstream.next();case 4:return e.abrupt("return",e.sent);case 7:if(e.prev=7,e.t0=e.catch(1),this.handler(e.t0)){e.next=11;break}return e.abrupt("return",{value:null,done:!0});case 11:e.next=0;break;case 13:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(){return e.apply(this,arguments)}}()}]),n}(RT),WT=function(e){h(n,e);var t=g(n);function n(e,r){var a;return s(this,n),(a=t.call(this)).upstream=e,a.transform=r,a}return c(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> AsyncMap")}},{key:"next",value:function(){var e=_(x().mark((function e(){var t,n,r,a,i,o,s;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:return n=oh(t.value),e.next=8,this.transform(t.value);case 8:r=e.sent,a=oh(r),i=zo(n);try{for(i.s();!(o=i.n()).done;)ih(s=o.value,a)||s.dispose()}catch(ZJ){i.e(ZJ)}finally{i.f()}return e.abrupt("return",{value:r,done:!1});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(RT),UT=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.call(this)).outputQueue=new NT,e.lastRead=Promise.resolve({value:null,done:!1}),e}return c(n,[{key:"next",value:function(){var e=_(x().mark((function e(){var t=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=_(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.outputQueue.length()){e.next=7;break}return e.next=3,this.pump();case 3:if(e.sent){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:e.next=0;break;case 7:return e.abrupt("return",{value:this.outputQueue.shift(),done:!1});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(RT),HT=function(e){h(n,e);var t=g(n);function n(e,r){var a;return s(this,n),(a=t.call(this)).upstream=e,a.transform=r,a}return c(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Flatmap")}},{key:"pump",value:function(){var e=_(x().mark((function e(){var t,n,r,a,i,o,s;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",!1);case 5:n=oh(t.value),r=this.transform(t.value),a=oh(r),this.outputQueue.pushAll(r),i=zo(n);try{for(i.s();!(o=i.n()).done;)ih(s=o.value,a)||s.dispose()}catch(ZJ){i.e(ZJ)}finally{i.f()}return e.abrupt("return",!0);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(UT),KT=function(e){h(n,e);var t=g(n);function n(e,r){var a;return s(this,n),(a=t.call(this)).baseErrorHandler=r,a.lastRead=null,a.iterator=null,a.moreIterators=e,a}return c(n,[{key:"summary",value:function(){return"".concat("TODO: fill in upstream of chained summaries"," -> Chained")}},{key:"next",value:function(){var e=_(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.readFromChain(this.lastRead),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"readFromChain",value:function(){var e=_(x().mark((function e(t){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:if(null!=this.iterator){e.next=10;break}return e.next=5,this.moreIterators.next();case 5:if(!(n=e.sent).done){e.next=8;break}return e.abrupt("return",{value:null,done:!0});case 8:this.iterator=n.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler));case 10:return e.next=12,this.iterator.next();case 12:if(!(r=e.sent).done){e.next=16;break}return this.iterator=null,e.abrupt("return",this.readFromChain(t));case 16:return e.abrupt("return",r);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(RT);!function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"}(DT||(DT={}));var XT=function(e){h(n,e);var t=g(n);function n(e,r){var a;return s(this,n),(a=t.call(this)).upstream=e,a.bufferSize=r,a.buffer=new AT(r),a}return c(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Prefetch")}},{key:"refill",value:function(){for(;!this.buffer.isFull();){var e=this.upstream.next();this.buffer.push(e)}}},{key:"next",value:function(){return this.refill(),this.buffer.shift()}}]),n}(RT),YT=function(e){h(n,e);var t=g(n);function n(e,r,a){var i;return s(this,n),(i=t.call(this,e,r)).upstream=e,i.windowSize=r,i.upstreamExhausted=!1,i.random=xT.alea(a||ql().toString()),i.lastRead=Promise.resolve({value:null,done:!1}),i}return c(n,[{key:"next",value:function(){var e=_(x().mark((function e(){var t=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"randomInt",value:function(e){return Math.floor(this.random()*e)}},{key:"chooseIndex",value:function(){return this.randomInt(this.buffer.length())}},{key:"serialNext",value:function(){var e=_(x().mark((function e(){var t,n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.upstreamExhausted||this.refill();case 1:if(this.buffer.isEmpty()){e.next=14;break}return t=this.chooseIndex(),e.next=5,this.buffer.shuffleExcise(t);case 5:if(!(n=e.sent).done){e.next=10;break}this.upstreamExhausted=!0,e.next=12;break;case 10:return this.refill(),e.abrupt("return",n);case 12:e.next=1;break;case 14:return e.abrupt("return",{value:null,done:!0});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(XT),QT=function(){function e(){s(this,e),this.size=null}return c(e,[{key:"batch",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this;return Ho(e>0,(function(){return"batchSize needs to be positive, but it is\n      ".concat(e)})),t=this.size===1/0||null==this.size?this.size:n?Math.ceil(this.size/e):Math.floor(this.size/e),$T(_(x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.iterator();case 2:return t.abrupt("return",t.sent.columnMajorBatch(e,n,JT));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"concatenate",value:function(e){var t,n=this;return t=this.size===1/0||e.size===1/0?1/0:null!=this.size&&null!=e.size?this.size+e.size:null,$T(_(x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.t0=t.sent,t.next=5,e.iterator();case 5:return t.t1=t.sent,t.abrupt("return",t.t0.concatenate.call(t.t0,t.t1));case 7:case"end":return t.stop()}}),t)}))),t)}},{key:"filter",value:function(e){var t,n=this;return t=this.size===1/0?1/0:null,$T(_(x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.filter((function(t){return vp((function(){return e(t)}))})));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"forEachAsync",value:function(){var e=_(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iterator();case 2:return e.abrupt("return",e.sent.forEachAsync(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"map",value:function(e){var t=this;return $T(_(x().mark((function n(){return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.map((function(t){return vp((function(){return e(t)}))})));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"mapAsync",value:function(e){var t=this;return $T(_(x().mark((function n(){return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.mapAsync(e));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"prefetch",value:function(e){if(null==e)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var t=this;return $T(_(x().mark((function n(){return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.prefetch(e));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"repeat",value:function(e){var t,n=this;return t=null!=this.size&&e>0?this.size*e:0===e?0:null!=this.size&&(void 0===e||e<0)?1/0:null,$T(_(x().mark((function t(){var r;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=PT(_(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.iterator();case 2:return e.t0=e.sent,e.abrupt("return",{value:e.t0,done:!1});case 4:case"end":return e.stop()}}),e)})))),t.abrupt("return",MT(r.take(e)));case 2:case"end":return t.stop()}}),t)}))),t)}},{key:"skip",value:function(e){var t,n=this;return t=null!=this.size&&e>=0&&this.size>=e?this.size-e:null!=this.size&&(this.size<e||void 0===e||e<0)?0:null,$T(_(x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.skip(e));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"shuffle",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==e||e<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting "+"bufferSize to the dataset size (".concat(this.size," elements)"));var r=this,a=xT.alea(t||ql().toString());return $T(_(x().mark((function t(){var i;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=a.int32(),n&&(i+=a.int32()),t.next=4,r.iterator();case 4:return t.abrupt("return",t.sent.shuffle(e,i.toString()));case 5:case"end":return t.stop()}}),t)}))),this.size)}},{key:"take",value:function(e){var t,n=this;return t=null!=this.size&&this.size>e?e:null!=this.size&&this.size<=e?this.size:null,$T(_(x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.take(e));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"toArray",value:function(){var e=_(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.size!==1/0){e.next=2;break}throw new Error("Can not convert infinite data stream to array.");case 2:return e.next=4,this.iterator();case 4:return e.abrupt("return",e.sent.toArray());case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toArrayForTest",value:function(){var e=_(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.size!==1/0){e.next=2;break}throw new Error("Can not convert infinite data stream to array.");case 2:return e.next=4,this.iterator();case 4:return e.abrupt("return",e.sent.toArrayForTest());case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function $T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new(function(n){h(a,n);var r=g(a);function a(){var e;return s(this,a),(e=r.apply(this,arguments)).size=t,e}return c(a,[{key:"iterator",value:function(){var t=_(x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e());case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}]),a}(QT))}function JT(e){return null===e?null:function(e){return null==e||null===(t=e)||"object"!==typeof t&&"function"!==typeof t||Array.isArray(e)||"object"===typeof e&&e instanceof Xl||us(e);var t}(e[0])?{value:function(e){if(0===e.length)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof Xl?Sm(e):Ch(e)}(e),recurse:!1}:{value:null,recurse:!0}}QT.MAX_BUFFER_SIZE=1e4;Symbol("out"),Symbol("field"),Symbol("quote"),Symbol("quoteafterquote"),Symbol("quoteinquote");function ZT(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&Ho("complex64"!==e.dtype,(function(){return"".concat(t," does not support complex64 tensors in the CPU backend.")}))}))}var eE=yg,tE=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.call(this)).blockSize=48,e.firstUse=!0,e.data=new Bo(m(e),dp()),e}return c(n,[{key:"write",value:function(e,t,n){this.firstUse&&(this.firstUse=!1,Is().get("IS_NODE")&&lg("\n============================\nHi there \ud83d\udc4b. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));var r={};return this.data.set(r,{values:e,dtype:n,refCount:1}),r}},{key:"makeTensorInfo",value:function(e,t,n){var r;if("string"===t&&null!=n&&n.length>0&&ls(n[0])){var a=n.map((function(e){return Gl(e)}));r=this.write(a,e,t)}else r=this.write(n,e,t);return{dataId:r,shape:e,dtype:t}}},{key:"incRef",value:function(e){this.data.get(e).refCount++}},{key:"decRef",value:function(e){this.data.has(e)&&this.data.get(e).refCount--}},{key:"move",value:function(e,t,n,r){this.data.set(e,{values:t,dtype:r,refCount:1})}},{key:"numDataIds",value:function(){return this.data.numDataIds()}},{key:"read",value:function(){var e=_(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.readSync(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readSync",value:function(e){var t=this.data.get(e),n=t.dtype,r=t.complexTensorInfos;return"complex64"===n?hg(this.readSync(r.real.dataId),this.readSync(r.imag.dataId)):this.data.get(e).values}},{key:"bufferSync",value:function(e){var t=this.readSync(e.dataId),n=t;if("string"===e.dtype)try{n=t.map((function(e){return Wl(e)}))}catch(r){throw new Error("Failed to decode encoded string bytes into utf-8")}return If(e.shape,e.dtype,n)}},{key:"makeOutput",value:function(e,t,n){var r=this.write(e,t,n);return dp().makeTensorFromDataId(r,t,n,this)}},{key:"disposeData",value:function(e){if(this.data.has(e)){var t=this.data.get(e).complexTensorInfos;null!=t&&(this.disposeData(t.real.dataId),this.disposeData(t.imag.dataId)),this.data.delete(e)}}},{key:"disposeIntermediateTensorInfo",value:function(e){var t=e.dataId;if(this.data.has(t)){var n=this.data.get(t);n.refCount--,n.refCount<1&&this.disposeData(t)}}},{key:"time",value:function(){var e=_(x().mark((function e(t){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ql(),t(),r=ql()-n,e.abrupt("return",{kernelMs:r});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"memory",value:function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}},{key:"where",value:function(e){ZT([e],"where");var t=this.readSync(e.dataId);return eE(e.shape,t)}},{key:"dispose",value:function(){}},{key:"floatPrecision",value:function(){return 32}},{key:"epsilon",value:function(){return Rw(f(n.prototype),"epsilon",this).call(this)}}]),n}(Vo);function nE(e,t,n){return function(r){var a=r.inputs,i=r.attrs,o=r.backend,s=a.x;if(ZT(s,e),"string"===s.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");for(var u=o,c=u.data.get(s.dataId).values,l=Qo(s.shape),h=n||s.dtype,f=os(h,l),p=0;p<l;++p)f[p]=t(c[p],i);return u.makeTensorInfo(s.shape,h,f)}}function rE(e,t,n){return function(r){var a=r.inputs,i=r.attrs,o=r.backend,s=a.x;if(ZT(s,e),"string"===s.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");var u=o,c=u.data.get(s.dataId).values,l=n||s.dtype,h=t(c,l,i);return u.makeTensorInfo(s.shape,l,h)}}bp("cpu",(function(){return new tE}),1);var aE=nE(Tu,(function(e){return e>=0?e:Math.exp(e)-1})),iE={kernelName:Tu,backendName:"cpu",kernelFunc:aE};function oE(e){var t=e.inputs,n=e.backend,r=t.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var sE={kernelName:Gu,backendName:"cpu",kernelFunc:oE};function uE(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.alpha;ZT([a],"leakyRelu");for(var o=Qo(a.shape),s=n.data.get(a.dataId).values,u=is("float32",o),c=0;c<s.length;c++)u[c]=s[c]<0?i*s[c]:s[c];return n.makeTensorInfo(a.shape,"float32",u)}var cE={kernelName:Yu,backendName:"cpu",kernelFunc:uE};function lE(e){return function(t,n,r,a,i){var o=dd(t,n),s=o.length,u=ms(o),c=is(i,Qo(o)),l=t.length,h=n.length,f=ms(t),p=ms(n),d=fd(t,o),m=fd(n,o);if(d.length+m.length===0)for(var v=0;v<c.length;++v)c[v]=e(r[v%r.length],a[v%a.length]);else for(var g=function(t){var n=_s(t,s,u),i=n.slice(-l);d.forEach((function(e){return i[e]=0}));var o=ws(i,l,f),v=n.slice(-h);m.forEach((function(e){return v[e]=0}));var g=ws(v,h,p);c[t]=e(r[o],a[g])},y=0;y<c.length;++y)g(y);return[c,o]}}var hE=lE((function(e,t){return e<0?t*e:e}));function fE(e){var t=e.inputs,n=e.backend,r=t.x,a=t.alpha;ZT([r,a],"prelu");var i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=Ct(hE(r.shape,a.shape,i,o,r.dtype),2),u=s[0],c=s[1];return n.makeTensorInfo(c,r.dtype,u)}var pE={kernelName:Nc,backendName:"cpu",kernelFunc:fE},dE=nE(Oc,(function(e){return Math.max(0,e)})),mE={kernelName:Oc,backendName:"cpu",kernelFunc:dE},vE=nE(jc,(function(e){return Math.min(Math.max(0,e),6)})),gE={kernelName:jc,backendName:"cpu",kernelFunc:vE};function yE(e,t,n,r,a){if("linear"===n)return oE({inputs:{x:t},backend:e});if("relu"===n)return dE({inputs:{x:t},backend:e});if("elu"===n)return aE({inputs:{x:t},backend:e});if("relu6"===n)return vE({inputs:{x:t},backend:e});if("prelu"===n)return fE({inputs:{x:t,alpha:r},backend:e});if("leakyrelu"===n)return uE({inputs:{x:t},backend:e,attrs:{alpha:a}});throw new Error("Activation ".concat(n," has not been implemented for the CPU backend."))}function bE(e){var t=e.inputs,n=e.backend,r=t.real,a=t.imag,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=n.makeTensorInfo(r.shape,"complex64");return n.data.get(s.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(a.shape,"float32",o)},s}var kE={kernelName:ru,backendName:"cpu",kernelFunc:bE};function xE(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"float32";if("complex64"===n){var r=xE(e,t,"float32"),a=xE(e,t,"float32");return bE({inputs:{real:r,imag:a},backend:e})}var i=bs(Qo(t),n);return e.makeTensorInfo(t,n,i)}function wE(e){var t=e.inputs,n=e.backend,r=t.input,a=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}var _E={kernelName:Dc,backendName:"cpu",kernelFunc:wE};function SE(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.dtype;if("complex64"===i){if("complex64"===a.dtype)return oE({inputs:{x:a},backend:n});var o=xE(n,a.shape,a.dtype),s=SE({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),u=bE({inputs:{real:s,imag:o},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}if("complex64"===a.dtype){var c=wE({inputs:{input:a},backend:n}),l=SE({inputs:{x:c},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(c),l}if(!ss(a.dtype,i)){var h=oE({inputs:{x:a},backend:n});return{dataId:h.dataId,shape:h.shape,dtype:i}}if("int32"===i){var f=n.data.get(a.dataId).values,p=Int32Array.from(f);return n.makeTensorInfo(a.shape,"int32",p)}if("bool"===i){var d=n.data.get(a.dataId).values,m=jl([0],a.dtype),v=Ct(lE((function(e,t){return e!==t?1:0}))(a.shape,[],d,m,"bool"),2),g=v[0],y=v[1];return n.makeTensorInfo(y,"bool",g)}throw new Error("Error in Cast: failed to cast ".concat(a.dtype," to ").concat(i))}var CE={kernelName:eu,backendName:"cpu",kernelFunc:SE};function TE(e,t,n,r){return null==n?function(n){var a=n.inputs,i=n.backend,o=a.a,s=a.b,u=i;ZT([o,s],e);var c=u.data.get(o.dataId).values,l=u.data.get(s.dataId).values,h=r||o.dtype,f=Ct(t(o.shape,s.shape,c,l,h),2),p=f[0],d=f[1];return u.makeTensorInfo(d,h,p)}:function(e){var a=e.inputs,i=e.backend,o=a.a,s=a.b,u=i;if("complex64"===o.dtype||"complex64"===s.dtype){var c=SE({inputs:{x:o},backend:u,attrs:{dtype:"complex64"}}),l=u.data.get(c.dataId),h=l.complexTensorInfos.real,f=l.complexTensorInfos.imag,p=u.data.get(h.dataId).values,d=u.data.get(f.dataId).values,m=SE({inputs:{x:s},backend:u,attrs:{dtype:"complex64"}}),v=u.data.get(m.dataId),g=v.complexTensorInfos.real,y=v.complexTensorInfos.imag,b=u.data.get(g.dataId).values,k=u.data.get(y.dataId).values,x=Ct(n(o.shape,s.shape,p,d,b,k),3),w=x[0],_=x[1],S=x[2],C=u.makeTensorInfo(S,"float32",w),T=u.makeTensorInfo(S,"float32",_),E=bE({inputs:{real:C,imag:T},backend:u});return u.disposeIntermediateTensorInfo(c),u.disposeIntermediateTensorInfo(m),u.disposeIntermediateTensorInfo(C),u.disposeIntermediateTensorInfo(T),E}var I=u.data.get(o.dataId).values,A=u.data.get(s.dataId).values,N=r||o.dtype,P=Ct(t(o.shape,s.shape,I,A,N),2),M=P[0],D=P[1];return u.makeTensorInfo(D,N,M)}}function EE(e){return function(t,n,r,a,i,o){var s=dd(t,n),u=Qo(s),c=s.length,l=ms(s),h=is("float32",u),f=is("float32",u),p=fd(t,s),d=fd(n,s),m=hg(r,a),v=hg(i,o),g=t.length,y=ms(t),b=n.length,k=ms(n);if(p.length+d.length===0)for(var x=0;x<h.length;x++){var w=x%m.length,_=x%v.length,S=e(m[2*w],m[2*w+1],v[2*_],v[2*_+1]);h[x]=S.real,f[x]=S.imag}else for(var C=function(t){var n=_s(t,c,l),r=n.slice(-g);p.forEach((function(e){return r[e]=0}));var a=ws(r,g,y),i=n.slice(-b);d.forEach((function(e){return i[e]=0}));var o=ws(i,b,k),s=e(m[2*a],m[2*a+1],v[2*o],v[2*o+1]);h[t]=s.real,f[t]=s.imag},T=0;T<h.length;T++)C(T);return[h,f,s]}}var IE=lE((function(e,t){return e+t})),AE=EE((function(e,t,n,r){return{real:e+n,imag:t+r}})),NE=TE(Fs,IE,AE),PE={kernelName:Fs,backendName:"cpu",kernelFunc:NE};function ME(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.shape,o=Qo(a.shape),s=ns(i,o),u=Qo(s);Ho(o===u,(function(){return"The new shape (".concat(s,") has ").concat(u," elements and the old ")+"shape (".concat(a.shape,") has ").concat(o," elements. The new shape and old ")+"shape must have the same number of elements."})),n.incRef(a.dataId);var c=n.data.get(a.dataId);if(null!=c.complexTensorInfos){var l=c.complexTensorInfos.real,h=c.complexTensorInfos.imag;l.shape=s,h.shape=s}return{dataId:a.dataId,shape:s,dtype:a.dtype}}var DE={kernelName:Fc,backendName:"cpu",kernelFunc:ME};function RE(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.a,i=t.b,o=r.transposeA,s=r.transposeB;ZT([a,i],"matMul");var u=a.shape.length,c=i.shape.length,l=o?a.shape[u-2]:a.shape[u-1],h=s?i.shape[c-1]:i.shape[c-2],f=o?a.shape[u-1]:a.shape[u-2],p=s?i.shape[c-2]:i.shape[c-1],d=a.shape.slice(0,-2),m=i.shape.slice(0,-2),v=Qo(d),g=Qo(m);Ho(u>=2&&c>=2&&(v===g||1===v||1===g),(function(){return"Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input "+"batch dimensions of (".concat(d,") and (").concat(m,").")}));var y=(v>g?a.shape.slice(0,-2):i.shape.slice(0,-2)).concat([f,p]);Ho(l===h,(function(){return"Error in matMul: inner shapes (".concat(l,") and (")+"".concat(h,") of Tensors with shapes ").concat(a.shape," and ")+"".concat(i.shape," and transposeA=").concat(o)+" and transposeB=".concat(s," must match.")}));for(var b=s?[g,p,h]:[g,h,p],k=ME({inputs:{x:a},backend:n,attrs:{shape:o?[v,l,f]:[v,f,l]}}),x=ME({inputs:{x:i},backend:n,attrs:{shape:b}}),w=o?k.shape[1]:k.shape[2],_=o?k.shape[2]:k.shape[1],S=s?x.shape[1]:x.shape[2],C=Math.max(v,g),T=n.data.get(k.dataId).values,E=n.data.get(x.dataId).values,I=ms(k.shape),A=ms(x.shape),N=Ct(o?[I[0],1,I[1]]:[I[0],I[1],1],3),P=N[0],M=N[1],D=N[2],R=Ct(s?[1,A[1],A[0]]:[A[1],1,A[0]],3),O=R[0],F=R[1],L=R[2],z=_*S,B=If([C,_,S],k.dtype),V=B.values,j=n.blockSize,q=0;q<C;q++)for(var G=0;G<_;G+=j)for(var W=0;W<S;W+=j)for(var U=0;U<w;U+=j)for(var H=Math.min(G+j,_),K=Math.min(W+j,S),X=Math.min(U+j,w),Y=G;Y<H;Y++)for(var Q=W;Q<K;Q++){for(var $=0,J=U;J<X;J++){var Z=Math.min(q,v-1)*P,ee=Math.min(q,g-1)*L;$+=T[Z+Y*M+J*D]*E[J*O+Q*F+ee]}V[q*z+(Y*S+Q)]+=$}return n.disposeIntermediateTensorInfo(k),n.disposeIntermediateTensorInfo(x),n.makeTensorInfo(y,B.dtype,B.values)}var OE={kernelName:$s,backendName:"cpu",kernelFunc:RE};var FE={kernelName:xl,backendName:"cpu",kernelFunc:function(e){var t,n,r,a=e.inputs,i=e.backend,o=e.attrs,s=a.a,u=a.b,c=a.bias,l=a.preluActivationWeights,h=o.transposeA,f=o.transposeB,p=o.activation,d=o.leakyreluAlpha,m=[];t=RE({inputs:{a:s,b:u},attrs:{transposeA:h,transposeB:f},backend:i}),c&&(n=NE({inputs:{a:t,b:c},backend:i}),m.push(t),t=n),p&&(r=yE(i,t,p,l,d),m.push(t),t=r);for(var v=0,g=m;v<g.length;v++){var y=g[v];i.disposeIntermediateTensorInfo(y)}return t}};function LE(e){for(var t=new Float32Array(e.length),n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}var zE={kernelName:Ds,backendName:"cpu",kernelFunc:function(e){var t=e.inputs.x,n=e.backend;ZT(t,"abs");var r=new Float32Array(Qo(t.shape));return r=LE(n.data.get(t.dataId).values),n.makeOutput(r,t.shape,"float32")}},BE=nE(Rs,(function(e){return Math.acos(e)})),VE={kernelName:Rs,backendName:"cpu",kernelFunc:BE},jE=nE(Os,(function(e){return Math.acosh(e)})),qE={kernelName:Os,backendName:"cpu",kernelFunc:jE};var GE={kernelName:Ls,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t;ZT(t,"addN");for(var a=r.map((function(e){return n.data.get(e.dataId).values})),i=If(r[0].shape,r[0].dtype),o=i.values,s=0;s<r.length;s++)for(var u=a[s],c=0;c<o.length;c++)o[c]+=u[c];return n.makeTensorInfo(i.shape,i.dtype,i.values)}};function WE(e,t,n,r,a){for(var i=t.length,o=Qo(t),s=ms(t),u=ms(a),c=is(n,Qo(a)),l=0;l<o;++l){for(var h=_s(l,i,s),f=new Array(h.length),p=0;p<f.length;p++)f[p]=h[r[p]];c[ws(f,i,u)]=e[l]}return c}function UE(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.perm;ZT(a,"transpose");for(var o=a.shape.length,s=new Array(o),u=0;u<s.length;u++)s[u]=a.shape[i[u]];var c=WE(r.data.get(a.dataId).values,a.shape,a.dtype,i,s);return{dataId:r.write(c,s,a.dtype),shape:s,dtype:a.dtype}}var HE={kernelName:dl,backendName:"cpu",kernelFunc:UE};var KE={kernelName:zs,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;ZT(a,"all");var s=rs(i,a.shape),u=s,c=Wd(u,a.shape.length),l=a;null!=c&&(l=UE({inputs:{x:a},backend:n,attrs:{perm:c}}),u=Hd(u.length,a.shape.length)),Gd("all",u,l.shape.length);for(var h=Ct(jd(l.shape,u),2),f=h[0],p=Qo(h[1]),d=bs(Qo(f),l.dtype),m=n.data.get(l.dataId).values,v=0;v<d.length;++v){for(var g=v*p,y=m[g],b=0;b<p;++b){var k=m[g+b];y=y&&k}d[v]=y}null!=c&&n.disposeIntermediateTensorInfo(l);var x=n.makeTensorInfo(f,l.dtype,d);if(o){var w=ME({inputs:{x:x},backend:n,attrs:{shape:qd(f,s)}});return n.disposeIntermediateTensorInfo(x),w}return x}};var XE={kernelName:Bs,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;ZT(a,"any");var s=rs(i,a.shape),u=s,c=Wd(u,a.shape.length),l=a;null!=c&&(l=UE({inputs:{x:a},backend:n,attrs:{perm:c}}),u=Hd(u.length,a.shape.length)),Gd("any",u,l.shape.length);for(var h=Ct(jd(l.shape,u),2),f=h[0],p=Qo(h[1]),d=bs(Qo(f),l.dtype),m=n.data.get(l.dataId).values,v=0;v<d.length;++v){for(var g=v*p,y=m[g],b=0;b<p;++b){var k=m[g+b];y=y||k}d[v]=y}null!=c&&n.disposeIntermediateTensorInfo(l);var x=n.makeTensorInfo(f,l.dtype,d);if(o){var w=ME({inputs:{x:x},backend:n,attrs:{shape:qd(f,s)}});return n.disposeIntermediateTensorInfo(x),w}return x}};var YE={kernelName:Vs,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis;ZT(a,"argMax");var o=rs(i,a.shape),s=Wd(o,a.shape.length),u=a,c=[];null!=s&&(u=UE({inputs:{x:a},backend:n,attrs:{perm:s}}),c.push(u),o=Hd(o.length,u.shape.length)),Gd("argMax",o=[o[0]],u.shape.length);for(var l=Ct(jd(u.shape,o),2),h=l[0],f=l[1],p=bs(Qo(h),"int32"),d=Qo(f),m=n.data.get(u.dataId).values,v=0;v<p.length;++v){for(var g=v*d,y=m[g],b=0,k=0;k<d;++k){var x=m[g+k];x>y&&(y=x,b=k)}p[v]=b}return c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(h,"int32",p)}};var QE={kernelName:js,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis;ZT(a,"argMin");var o=rs(i,a.shape),s=Wd(o,a.shape.length),u=a,c=[];null!=s&&(u=UE({inputs:{x:a},backend:n,attrs:{perm:s}}),c.push(u),o=Hd(o.length,u.shape.length)),Gd("argMin",o=[o[0]],u.shape.length);for(var l=Ct(jd(u.shape,o),2),h=l[0],f=l[1],p=bs(Qo(h),"int32"),d=Qo(f),m=n.data.get(u.dataId).values,v=0;v<p.length;++v){for(var g=v*d,y=m[g],b=0,k=0;k<d;++k){var x=m[g+k];x<y&&(y=x,b=k)}p[v]=b}return c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(h,"int32",p)}},$E=nE(qs,(function(e){return Math.asin(e)})),JE={kernelName:qs,backendName:"cpu",kernelFunc:$E},ZE=nE(Gs,(function(e){return Math.asinh(e)})),eI={kernelName:Gs,backendName:"cpu",kernelFunc:ZE},tI=nE(Ws,(function(e){return Math.atan(e)})),nI={kernelName:Ws,backendName:"cpu",kernelFunc:tI},rI=lE((function(e,t){return Math.atan2(e,t)})),aI=TE(Hs,rI),iI={kernelName:Hs,backendName:"cpu",kernelFunc:aI},oI=nE(Us,(function(e){return Math.atanh(e)})),sI={kernelName:Us,backendName:"cpu",kernelFunc:oI};function uI(e,t,n,r,a,i){for(var o=a.strideHeight,s=a.strideWidth,u=a.dilationHeight,c=a.dilationWidth,l=a.effectiveFilterHeight,h=a.effectiveFilterWidth,f=a.padInfo.top,p=a.padInfo.left,d="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=If(a.outShape,n),v=m.values,g=a.outShape[1]*a.outShape[2]*a.outShape[3],y=a.outShape[2]*a.outShape[3],b=a.outShape[3],k=0;k<a.batchSize;++k)for(var x=k*g,w=k*r[0],_=0;_<a.inChannels;++_)for(var S=0;S<a.outHeight;++S)for(var C=S*o-f,T=Math.max(0,C),E=Math.min(a.inHeight,l+C),I=x+S*y,A=0;A<a.outWidth;++A){for(var N=A*s-p,P=Math.max(0,N),M=Math.min(a.inWidth,h+N),D=d,R=0,O=0,F=T;F<E;F+=u){for(var L=w+F*r[1],z=P;z<M;z+=c){var B=e[L+z*r[2]+_];"max"===i&&B>D?D=B:"avg"===i&&(R+=B,O++)}if(isNaN(D))break}v[I+A*b+_]="avg"===i?R/O:D}return m}function cI(e,t,n,r){for(var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=If(r.outShape,"int32"),s=r.strideHeight,u=r.strideWidth,c=r.dilationHeight,l=r.dilationWidth,h=r.effectiveFilterHeight,f=r.effectiveFilterWidth,p=r.padInfo.top,d=r.padInfo.left,m=If(t,n,e),v=0;v<r.batchSize;++v)for(var g=0;g<r.inChannels;++g)for(var y=0;y<r.outHeight;++y){for(var b=y*s-p,k=b;k<0;)k+=c;for(var x=Math.min(r.inHeight,h+b),w=0;w<r.outWidth;++w){for(var _=w*u-d,S=_;S<0;)S+=l;for(var C=Math.min(r.inWidth,f+_),T=Number.NEGATIVE_INFINITY,E=-1,I=k;I<x;I+=c)for(var A=I-b,N=S;N<C;N+=l){var P=N-_,M=m.get(v,I,N,g);M>T&&(T=M,E=a?i?((v*r.inHeight+I)*r.inWidth+N)*r.inChannels+g:(I*r.inWidth+N)*r.inChannels+g:A*f+P)}o.set(E,v,y,w,g)}}return o}function lI(e,t,n,r,a,i){for(var o=a.strideDepth,s=a.strideHeight,u=a.strideWidth,c=a.dilationDepth,l=a.dilationHeight,h=a.dilationWidth,f=a.effectiveFilterDepth,p=a.effectiveFilterHeight,d=a.effectiveFilterWidth,m=a.padInfo.front,v=a.padInfo.top,g=a.padInfo.left,y="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=If(a.outShape,n),k=b.values,x=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],w=a.outShape[2]*a.outShape[3]*a.outShape[4],_=a.outShape[3]*a.outShape[4],S=a.outShape[4],C=0;C<a.batchSize;++C)for(var T=C*x,E=C*r[0],I=0;I<a.inChannels;++I)for(var A=0;A<a.outDepth;++A){for(var N=A*o-m,P=N;P<0;)P+=c;for(var M=Math.min(a.inDepth,f+N),D=T+A*w,R=0;R<a.outHeight;++R){for(var O=R*s-v,F=O;F<0;)F+=l;for(var L=Math.min(a.inHeight,p+O),z=D+R*_,B=0;B<a.outWidth;++B){for(var V=B*u-g,j=V;j<0;)j+=h;for(var q=Math.min(a.inWidth,d+V),G=z+B*S,W=y,U=0,H=0,K=P;K<M;K+=c){for(var X=E+K*r[1],Y=F;Y<L;Y+=l){for(var Q=X+Y*r[2],$=j;$<q;$+=h){var J=e[Q+$*r[3]+I];if("max"===i&&J>W?W=J:"avg"===i&&(U+=J,H++),isNaN(W))break}if(isNaN(W))break}if(isNaN(W))break}k[G+I]="avg"===i?U/H:W}}}return b}var hI={kernelName:Ks,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;ZT(a,"avgPool");var i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode;Ho(jp(o,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var c,l=Ap(a.shape,i,o,1,s,u);if(1===l.filterWidth&&1===l.filterHeight&&$o(l.inShape,l.outShape))c=oE({inputs:{x:a},backend:n});else{var h=n.data.get(a.dataId).values,f=ms(a.shape),p=uI(h,a.shape,a.dtype,f,l,"avg");c=n.makeTensorInfo(l.outShape,a.dtype,p.values)}return c}};var fI={kernelName:Ys,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode,c=r.dataFormat,l=r.dilations;ZT(a,"avgPool3d");var h=l;null==h&&(h=[1,1,1]);var f=Np(a.shape,i,o,h,s,u,c),p=lI(n.data.get(a.dataId).values,a.shape,a.dtype,ms(a.shape),f,"avg");return n.makeTensorInfo(p.shape,"float32",p.values)}};var pI={kernelName:Qs,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,s=r.strides,u=r.pad,c=r.dilations,l=r.dimRoundingMode;ZT([a,i],"avgPool3DGrad");for(var h=Np(i.shape,o,s,c,u,l),f=h.strideDepth,p=h.strideHeight,d=h.strideWidth,m=h.filterDepth,v=h.filterHeight,g=h.filterWidth,y=h.dilationDepth,b=h.dilationHeight,k=h.dilationWidth,x=h.effectiveFilterDepth,w=h.effectiveFilterHeight,_=h.effectiveFilterWidth,S=x-1-h.padInfo.front,C=_-1-h.padInfo.left,T=w-1-h.padInfo.top,E=If(i.shape,"float32"),I=1/(m*v*g),A=n.bufferSync(a),N=0;N<h.batchSize;++N)for(var P=0;P<h.inChannels;++P)for(var M=0;M<h.inDepth;++M)for(var D=0;D<h.inHeight;++D)for(var R=0;R<h.inWidth;++R){for(var O=M-S,F=D-T,L=R-C,z=0,B=0;B<x;B+=y){var V=(O+B)/f;if(!(V<0||V>=h.outDepth||Math.floor(V)!==V))for(var j=0;j<w;j+=b){var q=(F+j)/p;if(!(q<0||q>=h.outHeight||Math.floor(q)!==q))for(var G=0;G<_;G+=k){var W=(L+G)/d;if(!(W<0||W>=h.outWidth||Math.floor(W)!==W))z+=A.get(N,V,q,W,P)}}}E.set(z*I,N,M,D,R,P)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}};var dI={kernelName:Xs,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;ZT([a,i],"avgPoolGrad");for(var s=r.filterSize,u=r.strides,c=r.pad,l=Ap(o.shape,s,u,1,c),h=l.strideHeight,f=l.strideWidth,p=l.filterHeight,d=l.filterWidth,m=l.dilationHeight,v=l.dilationWidth,g=l.effectiveFilterHeight,y=l.effectiveFilterWidth,b=y-1-l.padInfo.left,k=g-1-l.padInfo.top,x=If(o.shape,"float32"),w=1/(p*d),_=n.data.get(a.dataId).values,S=If(a.shape,"float32",_),C=0;C<l.batchSize;++C)for(var T=0;T<l.inChannels;++T)for(var E=0;E<l.inHeight;++E)for(var I=0;I<l.inWidth;++I){for(var A=E-k,N=I-b,P=0,M=0;M<g;M+=m){var D=(A+M)/h;if(!(D<0||D>=l.outHeight||Math.floor(D)!==D))for(var R=0;R<y;R+=v){var O=(N+R)/f;if(!(O<0||O>=l.outWidth||Math.floor(O)!==O))P+=S.get(C,D,O,T)}}x.set(P*w,C,E,I,T)}return n.makeTensorInfo(x.shape,x.dtype,x.values)}};var mI={kernelName:zu,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.scale,o=t.offset,s=t.mean,u=t.variance;Ho(s.shape.length===u.shape.length,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),Ho(null==o||s.shape.length===o.shape.length,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),Ho(null==i||s.shape.length===i.shape.length,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),ZT([a,s,u,i,o],"batchNorm");var c=r.varianceEpsilon;null==c&&(c=.001);for(var l=n.data.get(a.dataId).values,h=n.data.get(s.dataId).values,f=n.data.get(u.dataId).values,p=i?n.data.get(i.dataId).values:new Float32Array([1]),d=o?n.data.get(o.dataId).values:new Float32Array([0]),m=new Float32Array(l.length),v=d.length,g=p.length,y=f.length,b=h.length,k=0,x=0,w=0,_=0,S=0;S<l.length;++S)m[S]=d[k++]+(l[S]-h[x++])*p[w++]/Math.sqrt(f[_++]+c),k>=v&&(k=0),x>=b&&(x=0),w>=g&&(w=0),_>=y&&(_=0);return n.makeTensorInfo(a.shape,a.dtype,m)}};function vI(e,t,n,r,a){var i=op(r,t,n),o=Qo(n),s=ms(r);if(i){var u=sp(t,s);return"string"===a?e.slice(u,u+o):e.subarray(u,u+o)}for(var c=If(r,a,"string"===a?gg(e):e),l=If(n,a),h=0;h<l.size;++h){var f=l.indexToLoc(h),p=f.map((function(e,n){return e+t[n]}));l.set.apply(l,[c.get.apply(c,Fn(p))].concat(Fn(f)))}return"string"===a?l.values.map((function(e){return Gl(e)})):l.values}function gI(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.begin,o=r.size;ZT(a,"slice");var s=Ct(up(a,i,o),2),u=s[0],c=s[1];Jf(a,u,c);var l=vI(n.data.get(a.dataId).values,u,c,a.shape,a.dtype);return n.makeTensorInfo(c,a.dtype,l)}var yI={kernelName:Xc,backendName:"cpu",kernelFunc:gI};var bI={kernelName:Js,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.crops;ZT([a],"batchToSpaceND");var s=i.reduce((function(e,t){return e*t})),u=Yv(a.shape,i,s),c=Qv(u.length,i.length),l=$v(a.shape,i,s),h=Jv(o,i.length),f=Zv(l,o,i.length),p=ME({inputs:{x:a},backend:n,attrs:{shape:u}}),d=UE({inputs:{x:p},backend:n,attrs:{perm:c}}),m=ME({inputs:{x:d},backend:n,attrs:{shape:l}}),v=gI({inputs:{x:m},backend:n,attrs:{begin:h,size:f}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(m),v}};function kI(e,t,n,r,a){for(var i=Qo(r),o=bs(a,n),s=0;s<e.length;s++){var u=e[s];if(u<0)throw new Error("Input x must be non-negative!");u>=a||(o[u]+=i>0?t[s]:1)}return o}function xI(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e.shape[0],i=e.shape[1],o=If([a,n],t.dtype),s=0;s<a;s++)for(var u=0;u<i;u++){var c=e.get(s,u);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(r?o.set(1,s,c):t.size>0?o.set(o.get(s,c)+t.get(s,u),s,c):o.set(o.get(s,c)+1,s,c))}return o}var wI={kernelName:Zs,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=kI(n.data.get(a.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,s)}};function _I(e){return function(t,n,r){for(var a=is(n,t.length),i=0;i<t.length;++i)a[i]=e(t[i],r);return a}}var SI=_I((function(e){return Math.ceil(e)})),CI=rE(tu,SI),TI={kernelName:tu,backendName:"cpu",kernelFunc:CI},EI=nE(nu,(function(e,t){var n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e})),II={kernelName:nu,backendName:"cpu",kernelFunc:EI},AI={kernelName:au,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs.x,n=e.backend,r=new Float32Array(Qo(t.shape)),a=n.data.get(t.dataId),i=a.complexTensorInfos.real,o=a.complexTensorInfos.imag,s=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values,c=0;c<s.length;c++){var l=s[c],h=u[c];r[c]=Math.hypot(l,h)}return n.makeOutput(r,t.shape,"float32")}};function NI(e,t,n,r){var a=os(n,Qo(t));if(r&&"string"!==n){var i=0;e.forEach((function(e){var t=Qo(e.shape);a.set(e.vals,i),i+=t}))}else{var o=0;e.forEach((function(e){for(var r="string"===n?gg(e.vals):e.vals,i=0,s=0;s<e.shape[0];++s)for(var u=s*t[1]+o,c=0;c<e.shape[1];++c)a[u+c]=r[i++];o+=e.shape[1]}))}return a}function PI(e){var t=e.inputs,n=e.backend,r=t.input,a=n.data.get(r.dataId).complexTensorInfos.imag,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}var MI={kernelName:Uu,backendName:"cpu",kernelFunc:PI};function DI(e){var t=e.inputs,n=e.backend,r=rs(e.attrs.axis,t[0].shape)[0],a=Hv(t.map((function(e){return e.shape})),r);if(0===Qo(a))return n.makeTensorInfo(a,t[0].dtype,[]);var i=t.filter((function(e){return Qo(e.shape)>0}));if(1===i.length)return oE({inputs:{x:i[0]},backend:n});if(Uv(i.map((function(e){return e.shape})),r),"complex64"===i[0].dtype){var o=i.map((function(e){return wE({inputs:{input:e},backend:n})})),s=i.map((function(e){return PI({inputs:{input:e},backend:n})})),u=DI({inputs:o,backend:n,attrs:{axis:r}}),c=DI({inputs:s,backend:n,attrs:{axis:r}}),l=bE({inputs:{real:u,imag:c},backend:n});return o.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),s.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),l}var h=i.map((function(e){var t=Qo(e.shape.slice(r));return ME({inputs:{x:e},backend:n,attrs:{shape:[-1,t]}})})),f=h.map((function(e){return{vals:n.data.get(e.dataId).values,shape:e.shape}}));a=Hv(h.map((function(e){return e.shape})),1);var p=1===h[0].shape[0],d=NI(f,a,t[0].dtype,p),m=Hv(i.map((function(e){return e.shape})),r),v=n.makeTensorInfo(m,t[0].dtype,d);return h.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),v}var RI={kernelName:iu,backendName:"cpu",kernelFunc:DI};function OI(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dataFormat,c=r.dilations,l=r.dimRoundingMode;ZT([a,i],"conv2d");for(var h=qp(u),f=Pp(a.shape,i.shape,o,c,s,l,!1,h),p=f.filterHeight,d=f.filterWidth,m=f.dilationHeight,v=f.dilationWidth,g=f.padInfo.left,y=f.padInfo.top,b="channelsLast"===f.dataFormat,k=new Ul(f.outShape,a.dtype),x=ms(a.shape),w=ms(i.shape),_=x[0],S=b?x[1]:x[2],C=b?x[2]:1,T=b?1:x[1],E=k.strides[0],I=b?k.strides[1]:k.strides[2],A=b?k.strides[2]:1,N=b?1:k.strides[1],P=n.data.get(a.dataId).values,M=n.data.get(i.dataId).values,D=k.values,R=0;R<f.batchSize;++R)for(var O=R*_,F=R*E,L=0;L<f.outHeight;++L)for(var z=F+L*I,B=L*f.strideHeight-y,V=0;V<p;++V){var j=B+V*m;if(!(j<0||j>=f.inHeight))for(var q=V*w[0],G=O+j*S,W=0;W<f.outWidth;++W)for(var U=z+W*A,H=W*f.strideWidth-g,K=0;K<d;++K){var X=H+K*v;if(!(X<0||X>=f.inWidth))for(var Y=G+X*C,Q=q+K*w[1],$=0;$<f.inChannels;++$){for(var J=P[Y+$*T],Z=0;Z<f.outChannels;++Z)D[U+Z*N]+=J*M[Q+Z];Q+=f.outChannels}}}return n.makeTensorInfo(k.shape,k.dtype,D)}var FI={kernelName:ou,backendName:"cpu",kernelFunc:OI};var LI={kernelName:su,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.pad,u=r.dataFormat,c=r.dimRoundingMode,l=r.filterShape;ZT([a,i],"conv2dBackpropFilter");for(var h=qp(u),f=Pp(a.shape,l,o,1,s,c,!1,h),p=f.strideHeight,d=f.strideWidth,m=f.filterHeight,v=f.filterWidth,g="channelsLast"===f.dataFormat,y=new Ul(f.filterShape,"float32"),b=f.padInfo.left,k=f.padInfo.top,x=n.data.get(a.dataId).values,w=n.data.get(i.dataId).values,_=new Ul(a.shape,a.dtype,x),S=new Ul(i.shape,i.dtype,w),C=0;C<m;++C)for(var T=Math.max(0,Math.ceil((k-C)/p)),E=Math.min(f.outHeight,(f.inHeight+k-C)/p),I=0;I<v;++I)for(var A=Math.max(0,Math.ceil((b-I)/d)),N=Math.min(f.outWidth,(f.inWidth+b-I)/d),P=0;P<f.inChannels;++P)for(var M=0;M<f.outChannels;++M){for(var D=0,R=0;R<f.batchSize;++R)for(var O=T;O<E;++O)for(var F=C+O*p-k,L=A;L<N;++L){var z=I+L*d-b;D+=g?_.get(R,F,z,P)*S.get(R,O,L,M):_.get(R,P,F,z)*S.get(R,M,O,L)}y.set(D,C,I,P,M)}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};var zI={kernelName:uu,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.inputShape,s=r.strides,u=r.pad,c=r.dataFormat,l=r.dimRoundingMode;ZT([a,i],"conv2dBackpropInput");var h=ms(i.shape),f=ms(a.shape),p=qp(c),d=Pp(o,i.shape,s,1,u,l,!1,p),m=new Ul(d.inShape,"float32"),v=m.values,g=n.data.get(a.dataId).values,y=n.data.get(i.dataId).values,b=Ct(h,3),k=b[0],x=b[1],w=b[2],_=d.batchSize,S=d.filterHeight,C=d.filterWidth,T=d.inChannels,E=d.inHeight,I=d.inWidth,A=d.outChannels,N=d.outHeight,P=d.outWidth,M=d.strideHeight,D=d.strideWidth;p=d.dataFormat;for(var R=S-1-d.padInfo.top,O=C-1-d.padInfo.left,F="channelsLast"===p,L=m.strides[0],z=F?m.strides[1]:m.strides[2],B=F?m.strides[2]:1,V=F?1:m.strides[1],j=f[0],q=F?f[1]:f[2],G=F?f[2]:1,W=F?1:f[1],U=0;U<_;++U)for(var H=0;H<T;++H)for(var K=0;K<E;++K)for(var X=K-R,Y=Math.max(0,Math.ceil(X/M)),Q=Math.min(N,(S+X)/M),$=0;$<I;++$){for(var J=$-O,Z=Math.max(0,Math.ceil(J/D)),ee=Math.min(P,(C+J)/D),te=0,ne=Y;ne<Q;++ne)for(var re=ne*M-X,ae=Z;ae<ee;++ae)for(var ie=j*U+q*ne+G*ae,oe=k*(S-1-re)+x*(C-1-(ae*D-J))+w*H,se=0;se<A;++se){te+=g[ie+W*se]*y[oe+se]}v[L*U+z*K+B*$+V*H]=te}return n.makeTensorInfo(m.shape,m.dtype,m.values)}};var BI={kernelName:cu,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations;ZT([a,i],"conv3d");for(var c=Mp(a.shape,i.shape,o,u,s),l=c.filterDepth,h=c.filterHeight,f=c.filterWidth,p=c.dilationDepth,d=c.dilationHeight,m=c.dilationWidth,v=c.padInfo,g=v.front,y=v.left,b=v.top,k=new Ul(c.outShape,a.dtype),x=n.data.get(a.dataId).values,w=n.data.get(i.dataId).values,_=k.values,S=ms(a.shape),C=ms(i.shape),T=0;T<c.batchSize;++T)for(var E=T*S[0],I=T*k.strides[0],A=0;A<c.outDepth;++A)for(var N=I+A*k.strides[1],P=A*c.strideDepth-g,M=0;M<l;++M){var D=P+M*p;if(!(D<0||D>=c.inDepth))for(var R=M*C[0],O=E+D*S[1],F=0;F<c.outHeight;++F)for(var L=N+F*k.strides[2],z=F*c.strideHeight-b,B=0;B<h;++B){var V=z+B*d;if(!(V<0||V>=c.inHeight))for(var j=R+B*C[1],q=O+V*S[2],G=0;G<c.outWidth;++G)for(var W=L+G*c.outChannels,U=G*c.strideWidth-y,H=0;H<f;++H){var K=U+H*m;if(!(K<0||K>=c.inWidth))for(var X=j+H*C[2],Y=q+K*c.inChannels,Q=X,$=0;$<c.inChannels;++$){for(var J=x[Y+$],Z=0;Z<c.outChannels;++Z)_[W+Z]+=J*w[Q+Z];Q+=c.outChannels}}}}return n.makeTensorInfo(k.shape,k.dtype,k.values)}};var VI={kernelName:lu,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.pad,u=r.filterShape;ZT([a,i],"conv3dBackpropFilterV2");for(var c=ms(a.shape),l=ms(i.shape),h=Mp(a.shape,u,o,1,s),f=h.strideDepth,p=h.strideHeight,d=h.strideWidth,m=h.filterDepth,v=h.filterHeight,g=h.filterWidth,y=new Ul(h.filterShape,"float32"),b=y.values,k=Ct(y.strides,4),x=k[0],w=k[1],_=k[2],S=k[3],C=n.data.get(i.dataId).values,T=Ct(l,4),E=T[0],I=T[1],A=T[2],N=T[3],P=n.data.get(a.dataId).values,M=Ct(c,4),D=M[0],R=M[1],O=M[2],F=M[3],L=h.padInfo.front,z=h.padInfo.left,B=h.padInfo.top,V=0;V<m;++V)for(var j=Math.max(0,Math.ceil((L-V)/f)),q=Math.min(h.outDepth,(h.inDepth+L-V)/f),G=V*x,W=0;W<v;++W)for(var U=Math.max(0,Math.ceil((B-W)/p)),H=Math.min(h.outHeight,(h.inHeight+B-W)/p),K=W*w+G,X=0;X<g;++X)for(var Y=Math.max(0,Math.ceil((z-X)/d)),Q=Math.min(h.outWidth,(h.inWidth+z-X)/d),$=X*_+K,J=0;J<h.inChannels;++J)for(var Z=J*S+$,ee=0;ee<h.outChannels;++ee){for(var te=0,ne=0;ne<h.batchSize;++ne)for(var re=ne*D,ae=ne*E,ie=j;ie<q;++ie)for(var oe=(V+ie*f-L)*R+re,se=ie*I+ae,ue=U;ue<H;++ue)for(var ce=(W+ue*p-B)*O+oe,le=ue*A+se,he=Y;he<Q;++he){var fe=he*N+le;te+=P[(X+he*d-z)*F+ce+J]*C[fe+ee]}b[Z+ee]=te}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};var jI={kernelName:hu,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.pad,s=r.strides,u=r.inputShape;ZT([a],"conv3dBackpropInputV2");for(var c=ms(a.shape),l=ms(i.shape),h=Mp(u,i.shape,s,1,o),f=new Ul(h.inShape,"float32"),p=f.values,d=Ct(f.strides,4),m=d[0],v=d[1],g=d[2],y=d[3],b=n.data.get(a.dataId).values,k=Ct(c,4),x=k[0],w=k[1],_=k[2],S=k[3],C=n.data.get(i.dataId).values,T=Ct(l,4),E=T[0],I=T[1],A=T[2],N=T[3],P=h.batchSize,M=h.filterDepth,D=h.filterHeight,R=h.filterWidth,O=h.inChannels,F=h.inDepth,L=h.inHeight,z=h.inWidth,B=h.outChannels,V=h.outDepth,j=h.outHeight,q=h.outWidth,G=h.strideDepth,W=h.strideHeight,U=h.strideWidth,H=M-1-h.padInfo.front,K=D-1-h.padInfo.top,X=R-1-h.padInfo.left,Y=0;Y<P;++Y)for(var Q=0;Q<O;++Q)for(var $=0;$<F;++$)for(var J=$-H,Z=Math.max(0,Math.ceil(J/G)),ee=Math.min(V,(M+J)/G),te=0;te<L;++te)for(var ne=te-K,re=Math.max(0,Math.ceil(ne/W)),ae=Math.min(j,(D+ne)/W),ie=0;ie<z;++ie){for(var oe=ie-X,se=Math.max(0,Math.ceil(oe/U)),ue=Math.min(q,(R+oe)/U),ce=0,le=Z;le<ee;++le)for(var he=le*G-J,fe=re;fe<ae;++fe)for(var pe=fe*W-ne,de=se;de<ue;++de)for(var me=x*Y+w*le+_*fe+S*de,ve=E*(M-1-he)+I*(D-1-pe)+A*(R-1-(de*U-oe))+N*Q,ge=0;ge<B;++ge){ce+=b[me+ge]*C[ve+ge]}p[m*Y+v*$+g*te+y*ie+Q]=ce}return n.makeTensorInfo(f.shape,f.dtype,f.values)}},qI=nE(fu,(function(e){return Math.cos(e)})),GI={kernelName:fu,backendName:"cpu",kernelFunc:qI},WI=nE(pu,(function(e){return Math.cosh(e)})),UI={kernelName:pu,backendName:"cpu",kernelFunc:WI};var HI={kernelName:mu,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=t.boxes,o=t.boxInd,s=r.cropSize,u=r.method,c=r.extrapolationValue,l=Ct(a.shape,4),h=l[0],f=l[1],p=l[2],d=l[3],m=i.shape[0],v=Ct(s,2),g=v[0],y=v[1],b=If([m,g,y,d],"float32"),k=n.data.get(i.dataId).values,x=n.data.get(o.dataId).values,w=n.data.get(a.dataId).values,_=ms(a.shape),S=ms(b.shape),C=0;C<m;C++){var T=4*C,E=k[T],I=k[T+1],A=k[T+2],N=k[T+3],P=x[C];if(!(P>=h))for(var M=g>1?(A-E)*(f-1)/(g-1):0,D=y>1?(N-I)*(p-1)/(y-1):0,R=0;R<g;R++){var O=g>1?E*(f-1)+R*M:.5*(E+A)*(f-1);if(O<0||O>f-1)for(var F=0;F<y;F++)for(var L=0;L<d;L++){var z=L+F*S[2]+R*S[1]+C*S[0];b.values[z]=c}else if("bilinear"===u)for(var B=Math.floor(O),V=Math.ceil(O),j=O-B,q=0;q<y;q++){var G=y>1?I*(p-1)+q*D:.5*(I+N)*(p-1);if(G<0||G>p-1)for(var W=0;W<d;W++){var U=W+q*S[2]+R*S[1]+C*S[0];b.values[U]=c}else for(var H=Math.floor(G),K=Math.ceil(G),X=G-H,Y=0;Y<d;Y++){var Q=Y+H*_[2]+B*_[1]+P*_[0],$=w[Q],J=w[Q=Y+K*_[2]+B*_[1]+P*_[0]],Z=w[Q=Y+H*_[2]+V*_[1]+P*_[0]],ee=$+(J-$)*X,te=Z+(w[Q=Y+K*_[2]+V*_[1]+P*_[0]]-Z)*X;Q=Y+q*S[2]+R*S[1]+C*S[0],b.values[Q]=ee+(te-ee)*j}}else for(var ne=0;ne<y;++ne){var re=y>1?I*(p-1)+ne*D:.5*(I+N)*(p-1);if(re<0||re>p-1)for(var ae=0;ae<d;ae++){var ie=ae+ne*S[2]+R*S[1]+C*S[0];b.values[ie]=c}else for(var oe=Math.round(re),se=Math.round(O),ue=0;ue<d;ue++){var ce=ue+oe*_[2]+se*_[1]+P*_[0],le=ue+ne*S[2]+R*S[1]+C*S[0];b.values[le]=w[ce]}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}};var KI={kernelName:du,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,s=r.reverse;ZT(a,"cumsum");var u=Wd([i],a.shape.length),c=a;null!=u&&(c=UE({inputs:{x:a},backend:n,attrs:{perm:u}}));var l=Hd(1,a.shape.length)[0];if(l!==c.shape.length-1)throw new Error("backend.cumsum in CPU expects an inner-most "+"axis=".concat(c.shape.length-1," but got axis=").concat(l));for(var h=nh(c.dtype,"int32"),f=bs(Qo(c.shape),h),p=n.data.get(c.dataId).values,d=c.shape[c.shape.length-1],m=s?function(e,t){return e+d-t-1}:function(e,t){return e+t},v=0;v<p.length;v+=d)for(var g=0;g<d;g++){var y=m(v,g);if(0===g)f[y]=o?0:p[y];else{var b=m(v,g-1);f[y]=o?p[b]+f[b]:p[y]+f[b]}}var k=n.makeTensorInfo(c.shape,h,f);if(null!=u){var x=UE({inputs:{x:k},backend:n,attrs:{perm:Ud(u)}});return n.disposeIntermediateTensorInfo(k),n.disposeIntermediateTensorInfo(c),x}return k}};var XI={kernelName:vu,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=r.binaryOutput;if(1===a.shape.length){var u=kI(n.data.get(a.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}if(2===a.shape.length){var c=xI(n.bufferSync(a),n.bufferSync(i),o,s);return n.makeTensorInfo(c.shape,i.dtype,c.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}};var YI={kernelName:gu,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockSize,o=r.dataFormat;Ho("NHWC"===o,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got ".concat(o)})),Ho(i>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: ".concat(i)}));for(var s=a.shape[0],u=a.shape[1],c=a.shape[2],l=a.shape[3],h=u*i,f=c*i,p=l/(i*i),d=n.data.get(a.dataId).values,m=new Float32Array(s*h*f*p),v=0,g=0;g<s;++g)for(var y=0;y<h;++y)for(var b=Math.floor(y/i),k=y%i,x=0;x<f;++x)for(var w=Math.floor(x/i),_=(k*i+x%i)*p,S=0;S<p;++S){var C=S+_+l*(w+c*(b+u*g));m[v++]=d[C]}return n.makeTensorInfo([s,h,f,p],a.dtype,m)}};function QI(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations,c=r.dimRoundingMode;ZT([a,i],"depthwiseConv2DNative");var l=ms(a.shape),h=ms(i.shape),f=u;null==f&&(f=[1,1]),Ho(jp(o,f),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(o," and dilations '").concat(f,"'")}));for(var p=Pp(a.shape,i.shape,o,f,s,c,!0),d=p.filterHeight,m=p.filterWidth,v=p.dilationHeight,g=p.dilationWidth,y=p.padInfo,b=y.left,k=y.top,x=p.outChannels/p.inChannels,w=new Ul(p.outShape,a.dtype),_=n.data.get(a.dataId).values,S=n.data.get(i.dataId).values,C=w.values,T=0;T<p.batchSize;++T)for(var E=T*l[0],I=T*w.strides[0],A=0;A<p.outHeight;++A)for(var N=I+A*w.strides[1],P=A*p.strideHeight-b,M=0;M<d;++M){var D=P+M*v;if(!(D<0||D>=p.inHeight))for(var R=M*h[0],O=E+D*l[1],F=0;F<p.outWidth;++F)for(var L=N+F*w.strides[2],z=F*p.strideWidth-k,B=0;B<m;++B){var V=z+B*g;if(!(V<0||V>=p.inWidth))for(var j=R+B*h[1],q=O+V*p.inChannels,G=L,W=j,U=0;U<p.inChannels;++U){for(var H=_[q+U],K=0;K<x;++K)C[G+K]+=H*S[W+K];G+=x,W+=x}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}var $I={kernelName:yu,backendName:"cpu",kernelFunc:QI};var JI={kernelName:bu,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.dilations,u=r.pad,c=r.dimRoundingMode,l=r.filterShape;ZT([a,i],"depthwiseConv2dNativeBackpropFilter");for(var h=Pp(a.shape,l,o,s,u,c,!0),f=h.strideHeight,p=h.strideWidth,d=h.filterHeight,m=h.filterWidth,v=new Ul(h.filterShape,"float32"),g=h.padInfo.left,y=h.padInfo.top,b=h.outChannels/h.inChannels,k=n.data.get(a.dataId).values,x=new Ul(a.shape,a.dtype,k),w=n.data.get(i.dataId).values,_=new Ul(i.shape,i.dtype,w),S=0;S<d;++S)for(var C=Math.max(0,Math.ceil((y-S)/f)),T=Math.min(h.outHeight,(h.inHeight+y-S)/f),E=0;E<m;++E)for(var I=Math.max(0,Math.ceil((g-E)/p)),A=Math.min(h.outWidth,(h.inWidth+g-E)/p),N=0;N<h.outChannels;++N){for(var P=Math.trunc(N/b),M=N%b,D=0,R=0;R<h.batchSize;++R)for(var O=C;O<T;++O)for(var F=S+O*f-y,L=I;L<A;++L){var z=E+L*p-g;D+=x.get(R,F,z,P)*_.get(R,O,L,N)}v.set(D,S,E,P,M)}return n.makeTensorInfo(v.shape,v.dtype,v.values)}};var ZI={kernelName:ku,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.strides,s=r.dilations,u=r.pad,c=r.dimRoundingMode,l=r.inputShape;ZT([a,i],"depthwiseConv2DNativeBackpropInput");for(var h=ms(a.shape),f=ms(i.shape),p=Pp(l,i.shape,o,s,u,c,!0),d=new Ul(p.inShape,"float32"),m=d.values,v=Ct(d.strides,3),g=v[0],y=v[1],b=v[2],k=n.data.get(a.dataId).values,x=Ct(h,3),w=x[0],_=x[1],S=x[2],C=n.data.get(i.dataId).values,T=Ct(f,3),E=T[0],I=T[1],A=T[2],N=p.batchSize,P=p.filterHeight,M=p.filterWidth,D=p.inChannels,R=p.inHeight,O=p.inWidth,F=p.outChannels,L=p.outHeight,z=p.outWidth,B=p.strideHeight,V=p.strideWidth,j=P-1-p.padInfo.top,q=M-1-p.padInfo.left,G=F/D,W=0;W<N;++W)for(var U=0;U<D;++U)for(var H=0;H<R;++H)for(var K=H-j,X=Math.max(0,Math.ceil(K/B)),Y=Math.min(L,(P+K)/B),Q=0;Q<O;++Q){for(var $=Q-q,J=Math.max(0,Math.ceil($/V)),Z=Math.min(z,(M+$)/V),ee=0,te=X;te<Y;++te)for(var ne=te*B-K,re=J;re<Z;++re)for(var ae=w*W+_*te+S*re,ie=E*(P-1-ne)+I*(M-1-(re*V-$))+A*U,oe=0;oe<G;++oe){ee+=k[ae+(U*G+oe)]*C[ie+oe]}m[g*W+y*H+b*Q+U]=ee}return n.makeTensorInfo(d.shape,d.dtype,d.values)}};var eA={kernelName:xu,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=t.x,a=Qo(r.shape),i=n.data.get(r.dataId).values,o=If([a,a],r.dtype),s=o.values,u=0;u<i.length;u++)s[u*a+u]=i[u];var c=[].concat(Fn(r.shape),Fn(r.shape));return n.makeTensorInfo(c,o.dtype,o.values)}},tA={kernelName:wu,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations,c=n,l=c.data.get(a.dataId).values,h=a.shape.length,f=c.data.get(i.dataId).values,p=i.shape.length,d=Ip(a.shape,i.shape,o,s,"NHWC",u),m=d.batchSize,v=d.inHeight,g=d.inWidth,y=d.inChannels,b=d.outHeight,k=d.outWidth,x=d.padInfo,w=d.strideHeight,_=d.strideWidth,S=d.filterHeight,C=d.filterWidth,T=d.dilationHeight,E=d.dilationWidth,I=d.outShape,A=Qo(I),N=I.length,P=os(a.dtype,A),M=0;M<m;++M)for(var D=0;D<b;++D)for(var R=D*w-x.top,O=0;O<k;++O)for(var F=O*_-x.left,L=0;L<y;++L){for(var z=Number.MIN_SAFE_INTEGER,B=0;B<S;++B){var V=R+B*T;if(V>=0&&V<v)for(var j=0;j<C;++j){var q=F+j*E;if(q>=0&&q<g){var G=ws([M,V,q,L],h,ms(a.shape)),W=ws([B,j,L],p,ms(i.shape)),U=l[G]+f[W];U>z&&(z=U)}}}P[ws([M,D,O,L],N,ms(I))]=z}return{dataId:c.write(jl(P,a.dtype),I,a.dtype),shape:I,dtype:a.dtype}}},nA={kernelName:Su,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.dy,s=r.strides,u=r.pad,c=r.dilations,l=n,h=gs(a.shape,l.data.get(a.dataId).values),f=gs(i.shape,l.data.get(i.dataId).values),p=Ip(a.shape,i.shape,s,u,"NHWC",c),d=p.batchSize,m=p.inHeight,v=p.inWidth,g=p.inChannels,y=p.outHeight,b=p.outWidth,k=p.padInfo,x=p.strideHeight,w=p.strideWidth,_=p.filterHeight,S=p.filterWidth,C=p.dilationHeight,T=p.dilationWidth,E=p.outShape;Ho(o.rank===E.length,(function(){return"Error in ".concat(Su,", dy ")+"must have the same rank as output ".concat(E.length,", but got ")+"".concat(o.rank)}));for(var I=gs(E,l.data.get(o.dataId).values),A=ks(i.shape,i.dtype),N=0;N<d;++N)for(var P=0;P<y;++P)for(var M=P*x-k.top,D=0;D<b;++D)for(var R=D*w-k.left,O=0;O<g;++O){for(var F=Number.MIN_SAFE_INTEGER,L=0,z=0,B=0;B<_;++B){var V=M+B*C;if(V>=0&&V<m)for(var j=0;j<S;++j){var q=R+j*T;if(q>=0&&q<v){var G=h[N][V][q][O]+f[B][j][O];G>F&&(F=G,L=B,z=j)}}}A[L][z][O]+=I[N][P][D][O]}return{dataId:l.write(jl(A,a.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},rA={kernelName:_u,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.dy,s=r.strides,u=r.pad,c=r.dilations,l=n,h=gs(a.shape,l.data.get(a.dataId).values),f=gs(i.shape,l.data.get(i.dataId).values),p=Ip(a.shape,i.shape,s,u,"NHWC",c),d=p.batchSize,m=p.inHeight,v=p.inWidth,g=p.inChannels,y=p.outHeight,b=p.outWidth,k=p.padInfo,x=p.strideHeight,w=p.strideWidth,_=p.filterHeight,S=p.filterWidth,C=p.dilationHeight,T=p.dilationWidth,E=p.outShape;Ho(o.rank===E.length,(function(){return"Error in ".concat(_u,", dy ")+"must have the same rank as output ".concat(E.length,", but got ")+"".concat(o.rank)}));for(var I=gs(E,l.data.get(o.dataId).values),A=ks(a.shape,a.dtype),N=0;N<d;++N)for(var P=0;P<y;++P)for(var M=P*x-k.top,D=0;D<b;++D)for(var R=D*w-k.left,O=0;O<g;++O){for(var F=Number.MIN_SAFE_INTEGER,L=M<0?0:M,z=R<0?0:R,B=0;B<_;++B){var V=M+B*C;if(V>=0&&V<m)for(var j=0;j<S;++j){var q=R+j*T;if(q>=0&&q<v){var G=h[N][V][q][O]+f[B][j][O];G>F&&(F=G,L=V,z=q)}}}A[N][L][z][O]+=I[N][P][D][O]}return{dataId:l.write(jl(A,a.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}};var aA={kernelName:Eu,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.dy,a=t.y;ZT([r,a],"eluGrad");for(var i=new Float32Array(Qo(a.shape)),o=n.data.get(a.dataId).values,s=n.data.get(r.dataId).values,u=0;u<o.length;++u){var c=o[u];i[u]=c>=1?s[u]:s[u]*(c+1)}return n.makeTensorInfo(a.shape,"float32",i)}},iA=lE((function(e,t){return e===t?1:0})),oA=TE(Au,iA,null,"bool"),sA={kernelName:Au,backendName:"cpu",kernelFunc:oA},uA=nE(Iu,(function(e){var t=Math.sign(e),n=Math.abs(e),r=1/(1+.3275911*n);return t*(1-((((1.061405429*r-1.453152027)*r+1.421413741)*r-.284496736)*r+.254829592)*r*Math.exp(-n*n))})),cA={kernelName:Iu,backendName:"cpu",kernelFunc:uA},lA=_I((function(e){return Math.exp(e)})),hA=rE(Nu,lA),fA={kernelName:Nu,backendName:"cpu",kernelFunc:hA};function pA(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.input,i=r.dim,o=a.shape.length,s=a.shape.slice(),u=i;return i<0&&(Ho(-(o+1)<=i,(function(){return"Axis must be in the interval [".concat(-(o+1),", ").concat(o,"]")})),u=o+i+1),s.splice(u,0,1),ME({inputs:{x:a},backend:n,attrs:{shape:s}})}var dA={kernelName:Pu,backendName:"cpu",kernelFunc:pA},mA=_I((function(e){return Math.expm1(e)})),vA=rE(Mu,mA),gA={kernelName:Mu,backendName:"cpu",kernelFunc:vA},yA=lE((function(e,t){return e*t})),bA=EE((function(e,t,n,r){return{real:e*n-t*r,imag:e*r+t*n}})),kA=TE(bc,yA,bA),xA={kernelName:bc,backendName:"cpu",kernelFunc:kA},wA=lE((function(e,t){return e/t})),_A=TE(Cu,wA),SA={kernelName:Cu,backendName:"cpu",kernelFunc:_A},CA=lE((function(e,t){return e-t})),TA=EE((function(e,t,n,r){return{real:e-n,imag:t-r}})),EA=TE(sl,CA,TA),IA={kernelName:sl,backendName:"cpu",kernelFunc:EA};function AA(e,t,n){for(var r=e.shape,a=r[0],i=r[1],o=n.data.get(e.dataId),s=o.complexTensorInfos.real,u=o.complexTensorInfos.imag,c=[a,i],l=Qo(c),h=is("float32",l),f=is("float32",l),p=0;p<a;p++){for(var d=gI({inputs:{x:s},backend:n,attrs:{begin:[p,0],size:[1,i]}}),m=gI({inputs:{x:u},backend:n,attrs:{begin:[p,0],size:[1,i]}}),v=bE({inputs:{real:d,imag:m},backend:n}),g=NA(v,t,n),y=hg(g.real,g.imag),b=0;b<i;b++){var k=fg(y,b);h[p*i+b]=k.real,f[p*i+b]=k.imag}n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v)}var x=n.makeTensorInfo(c,"float32",h),w=n.makeTensorInfo(c,"float32",f),_=bE({inputs:{real:x,imag:w},backend:n});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(w),_}function NA(e,t,n){var r=Qo(e.shape),a=n.data.get(e.dataId),i=n.data.get(a.complexTensorInfos.real.dataId).values,o=n.data.get(a.complexTensorInfos.imag.dataId).values;if(0===((g=r)&g-1)){var s=PA(i,o,r,t,n),u=[e.shape[0],e.shape[1]];if(t){var c=n.makeTensorInfo(u,"float32",s.real),l=n.makeTensorInfo(u,"float32",s.imag),h=n.makeTensorInfo([],"float32",Vl(r,"float32")),f=oE({inputs:{x:h},backend:n}),p=SA.kernelFunc({inputs:{a:c,b:h},backend:n}),d=SA.kernelFunc({inputs:{a:l,b:f},backend:n}),m=n.data.get(p.dataId).values,v=n.data.get(d.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(d),{real:m,imag:v}}return s}var g,y=function(e,t,n){for(var r=new Float32Array(2*t),a=0;a<t;a++){for(var i=0,o=0,s=0;s<t;s++){var u=dg(a*s,t,n),c=fg(e,s);i+=c.real*u.real-c.imag*u.imag,o+=c.real*u.imag+c.imag*u.real}n&&(i/=t,o/=t),pg(r,i,o,a)}return r}(hg(i,o),r,t);return function(e){for(var t=new Float32Array(e.length/2),n=new Float32Array(e.length/2),r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}(y)}function PA(e,t,n,r,a){if(1===n)return{real:e,imag:t};var i=hg(e,t),o=n/2,s=function(e){for(var t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=0;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}(i),u=s.real,c=s.imag,l=[u.length],h=a.makeTensorInfo(l,"float32",u),f=a.makeTensorInfo(l,"float32",c),p=bE({inputs:{real:h,imag:f},backend:a}),d=function(e){for(var t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=2;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}(i),m=d.real,v=d.imag,g=[m.length],y=a.makeTensorInfo(g,"float32",m),b=a.makeTensorInfo(g,"float32",v),k=bE({inputs:{real:y,imag:b},backend:a}),x=PA(u,c,o,r,a),w=x.real,_=x.imag,S=[w.length],C=a.makeTensorInfo(S,"float32",w),T=a.makeTensorInfo(S,"float32",_),E=bE({inputs:{real:C,imag:T},backend:a}),I=PA(m,v,o,r,a),A=I.real,N=I.imag,P=[A.length],M=a.makeTensorInfo(P,"float32",A),D=a.makeTensorInfo(P,"float32",N),R=bE({inputs:{real:M,imag:D},backend:a}),O=function(e,t){for(var n=new Float32Array(e/2),r=new Float32Array(e/2),a=0;a<Math.ceil(e/2);a++){var i=(t?2:-2)*Math.PI*(a/e);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}(n,r),F=[O.real.length],L=a.makeTensorInfo(F,"float32",O.real),z=a.makeTensorInfo(F,"float32",O.imag),B=bE({inputs:{real:L,imag:z},backend:a}),V=kA({inputs:{a:B,b:R},backend:a}),j=NE({inputs:{a:E,b:V},backend:a}),q=EA({inputs:{a:E,b:V},backend:a}),G=wE({inputs:{input:j},backend:a}),W=wE({inputs:{input:q},backend:a}),U=PI({inputs:{input:j},backend:a}),H=PI({inputs:{input:q},backend:a}),K=DI({inputs:[G,W],backend:a,attrs:{axis:0}}),X=DI({inputs:[U,H],backend:a,attrs:{axis:0}}),Y=a.data.get(K.dataId).values,Q=a.data.get(X.dataId).values;return a.disposeIntermediateTensorInfo(h),a.disposeIntermediateTensorInfo(f),a.disposeIntermediateTensorInfo(p),a.disposeIntermediateTensorInfo(y),a.disposeIntermediateTensorInfo(b),a.disposeIntermediateTensorInfo(k),a.disposeIntermediateTensorInfo(C),a.disposeIntermediateTensorInfo(T),a.disposeIntermediateTensorInfo(E),a.disposeIntermediateTensorInfo(M),a.disposeIntermediateTensorInfo(D),a.disposeIntermediateTensorInfo(R),a.disposeIntermediateTensorInfo(L),a.disposeIntermediateTensorInfo(z),a.disposeIntermediateTensorInfo(B),a.disposeIntermediateTensorInfo(V),a.disposeIntermediateTensorInfo(j),a.disposeIntermediateTensorInfo(q),a.disposeIntermediateTensorInfo(G),a.disposeIntermediateTensorInfo(U),a.disposeIntermediateTensorInfo(W),a.disposeIntermediateTensorInfo(H),a.disposeIntermediateTensorInfo(K),a.disposeIntermediateTensorInfo(X),{real:Y,imag:Q}}var MA={kernelName:Du,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.input,a=Qo(r.shape),i=r.shape[r.shape.length-1],o=ME({inputs:{x:r},backend:n,attrs:{shape:[a/i,i]}}),s=AA(o,!1,n),u=ME({inputs:{x:s},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}};function DA(e){var t=e.backend,n=e.attrs,r=n.shape,a=n.value,i=n.dtype||fs(a),o=os(i,Qo(r));return function(e,t,n){e.fill(t)}(o,a),t.makeTensorInfo(r,i,o)}var RA={kernelName:Ru,backendName:"cpu",kernelFunc:DA};var OA={kernelName:Ou,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=(e.attrs,e.backend),r=t.image,a=n,i=is(r.dtype,Qo(r.shape)),o=Ct(r.shape,4),s=o[0],u=o[1],c=o[2],l=o[3],h=a.data.get(r.dataId).values,f=0;f<s;f++)for(var p=f*c*u*l,d=0;d<u;d++)for(var m=d*(c*l),v=0;v<c;v++)for(var g=v*l,y=0;y<l;y++){var b=[s,d,v,y][2],k=Math.round(c-b),x=p+m+g+y,w=h[x];if(k>=0&&k<c)w=h[p+m+k*l+y];i[x]=w}return{dataId:a.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},FA=_I((function(e){return Math.floor(e)})),LA=rE(Fu,FA),zA={kernelName:Fu,backendName:"cpu",kernelFunc:LA},BA=lE((function(e,t){return Math.floor(e/t)})),VA=TE(Lu,BA,null,"int32"),jA={kernelName:Lu,backendName:"cpu",kernelFunc:VA};var qA={kernelName:wl,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,s=t.preluActivationWeights,u=r.strides,c=r.pad,l=r.dataFormat,h=r.dilations,f=r.dimRoundingMode,p=r.activation,d=r.leakyreluAlpha,m=OI({inputs:{x:a,filter:i},backend:n,attrs:{strides:u,pad:c,dataFormat:l,dilations:h,dimRoundingMode:f}});if(o){var v=m;m=NE({inputs:{a:m,b:o},backend:n}),n.disposeIntermediateTensorInfo(v)}if(p){var g=m;m=yE(n,m,p,s,d),n.disposeIntermediateTensorInfo(g)}return m}};var GA={kernelName:_l,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,s=t.preluActivationWeights,u=r.strides,c=r.pad,l=r.dataFormat,h=r.dilations,f=r.dimRoundingMode,p=r.activation,d=r.leakyreluAlpha,m=QI({inputs:{x:a,filter:i},backend:n,attrs:{strides:u,pad:c,dataFormat:l,dilations:h,dimRoundingMode:f}});if(o){var v=m;m=NE({inputs:{a:m,b:o},backend:n}),n.disposeIntermediateTensorInfo(v)}if(p){var g=m;m=yE(n,m,p,s,d),n.disposeIntermediateTensorInfo(g)}return m}};var WA={kernelName:Vu,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.params,a=t.indices,i=Qo(r.shape),o=a.shape,s=o[o.length-1],u=Ct(eg(r,a),4),c=u[0],l=u[1],h=u[2],f=u[3];if(0===l)return n.makeTensorInfo(c,r.dtype,[]);for(var p=If([l,h],r.dtype),d=n.data.get(a.dataId).values,m=n.data.get(r.dataId).values,v=0;v<l;v++){for(var g=[],y=0,b=0;b<s;b++){var k=d[v*s+b];y+=k*f[b],g.push(k)}if(y<0||y>=i/h)throw new Error("Invalid indices: ".concat(g," does not index into ").concat(r.shape));for(var x=0;x<h;x++)p.values[v*h+x]=m[y*h+x]}return n.makeTensorInfo(c,p.dtype,p.values)}};function UA(e,t,n){for(var r=If(n,e.dtype),a=0;a<r.size;++a){var i=r.indexToLoc(a).slice(),o=i[0],s=i[2],u=t.locToIndex([o,s]);i[2]=t.values[u];var c=e.locToIndex(i);r.values[a]=e.values[c]}return r}var HA={kernelName:Bu,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.indices,o=r.axis,s=r.batchDims;ZT([a,i],"gatherV2");var u=s;null==s&&(u=0);var c=Qo(i.shape),l=vg(a,i,rs(o,a.shape)[0],u),h=ME({inputs:{x:a},backend:n,attrs:{shape:[l.batchSize,l.outerSize,l.dimSize,l.sliceSize]}}),f=ME({inputs:{x:i},backend:n,attrs:{shape:[l.batchSize,c/l.batchSize]}}),p=[l.batchSize,l.outerSize,c/l.batchSize,l.sliceSize],d=n.bufferSync(f),m=UA(n.bufferSync(h),d,p);return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.makeTensorInfo(l.outputShape,m.dtype,m.values)}},KA=lE((function(e,t){return e>t?1:0})),XA=TE(ju,KA,null,"bool"),YA={kernelName:ju,backendName:"cpu",kernelFunc:XA},QA=lE((function(e,t){return e>=t?1:0})),$A=TE(qu,QA,null,"bool"),JA={kernelName:qu,backendName:"cpu",kernelFunc:$A};var ZA={kernelName:Wu,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.input,a=Qo(r.shape),i=r.shape[r.shape.length-1],o=ME({inputs:{x:r},backend:n,attrs:{shape:[a/i,i]}}),s=AA(o,!0,n),u=ME({inputs:{x:s},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}},eN=nE(Hu,(function(e){return Number.isFinite(e)?1:0}),"bool"),tN={kernelName:Hu,backendName:"cpu",kernelFunc:eN},nN=nE(Ku,(function(e){return Math.abs(e)===1/0?1:0}),"bool"),rN={kernelName:Ku,backendName:"cpu",kernelFunc:nN},aN=nE(Xu,(function(e){return Number.isNaN(e)?1:0}),"bool"),iN={kernelName:Xu,backendName:"cpu",kernelFunc:aN},oN=lE((function(e,t){return e<t?1:0})),sN=TE(Qu,oN,null,"bool"),uN={kernelName:Qu,backendName:"cpu",kernelFunc:sN},cN=lE((function(e,t){return e<=t?1:0})),lN=TE($u,cN,null,"bool"),hN={kernelName:$u,backendName:"cpu",kernelFunc:lN};function fN(e,t,n){var r=(t-e)/(n-1),a=bs(n,"float32");a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+r;return a}var pN={kernelName:Ju,backendName:"cpu",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=fN(n.start,n.stop,n.num);return t.makeTensorInfo([r.length],"float32",r)}},dN=_I((function(e){return Math.log(e)})),mN=rE(Zu,dN),vN={kernelName:Zu,backendName:"cpu",kernelFunc:mN},gN=nE(ec,(function(e){return Math.log1p(e)})),yN={kernelName:ec,backendName:"cpu",kernelFunc:gN},bN=lE((function(e,t){return e&&t})),kN=TE(tc,bN,null,"bool"),xN={kernelName:tc,backendName:"cpu",kernelFunc:kN},wN=nE(nc,(function(e){return e?0:1}),"bool"),_N={kernelName:nc,backendName:"cpu",kernelFunc:wN},SN=lE((function(e,t){return e||t})),CN=TE(rc,SN,null,"bool"),TN={kernelName:rc,backendName:"cpu",kernelFunc:CN};var EN={kernelName:ac,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.depthRadius,o=r.bias,s=r.alpha,u=r.beta;ZT(a,"LRN");var c=a.shape[3],l=c-1,h=n.data.get(a.dataId).values,f=Qo(a.shape),p=new Float32Array(f);function d(e){for(var t=e%c,n=e-t+Math.max(0,t-i),r=e-t+Math.min(t+i,l),a=0;n<=r;n++){var o=h[n];a+=o*o}return a}for(var m=0;m<f;m++){var v=d(m),g=h[m]*Math.pow(o+s*v,-u);p[m]=g}return n.makeTensorInfo(a.shape,a.dtype,p)}};var IN={kernelName:ic,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.y,o=t.dy,s=r.depthRadius,u=r.bias,c=r.alpha,l=r.beta;ZT(o,"LRNGrad");for(var h=Qo(o.shape),f=o.shape[3],p=n.data.get(o.dataId).values,d=n.data.get(a.dataId).values,m=n.data.get(i.dataId).values,v=new Float32Array(h),g=h,y=0;y<g;y++){for(var b=y%f,k=y-b+Math.max(0,b-s),x=y-b+Math.min(f,b+s+1),w=0,_=k;_<x;_++)w+=Math.pow(d[_],2);w=c*w+u;for(var S=k;S<x;S++){var C=-2*c*l*d[S]*m[y]/w;y===S&&(C+=Math.pow(w,-l)),C*=p[y],v[S]+=C}}return n.makeTensorInfo(o.shape,a.dtype,v)}};function AN(e,t,n,r){for(var a=is(r,Qo(n)),i=0;i<a.length;++i){for(var o=i*t,s=e[o],u=0;u<t;++u){var c=e[o+u];c>s&&(s=c)}a[i]=s}return a}function NN(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reductionIndices,o=r.keepDims,s=n,u=a.shape,c=u.length,l=rs(i,u),h=l,f=Wd(h,c),p=s.data.get(a.dataId).values;if(null!=f){for(var d=new Array(c),m=0;m<d.length;m++)d[m]=u[f[m]];p=WE(p,u,a.dtype,f,d),h=Hd(h.length,c),u=d}ZT(a,"max"),Gd("max",h,c);var v=Ct(jd(u,h),2),g=v[0],y=AN(p,Qo(v[1]),g,a.dtype),b=s.write(y,g,a.dtype),k=g;o&&(k=d=qd(g,l));return{dataId:b,shape:k,dtype:a.dtype}}var PN={kernelName:oc,backendName:"cpu",kernelFunc:NN},MN=lE((function(e,t){return Math.max(e,t)})),DN=TE(sc,MN),RN={kernelName:sc,backendName:"cpu",kernelFunc:DN};var ON={kernelName:uc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;ZT(a,"maxPool");var i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode;Ho(jp(o,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var c,l=Ap(a.shape,i,o,1,s,u);if(1===l.filterWidth&&1===l.filterHeight&&$o(l.inShape,l.outShape))c=oE({inputs:{x:a},backend:n});else{var h=n.data.get(a.dataId).values,f=ms(a.shape),p=uI(h,a.shape,a.dtype,f,l,"max");c=n.makeTensorInfo(l.outShape,a.dtype,p.values)}return c}};var FN={kernelName:lc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode,c=r.dataFormat,l=r.dilations;ZT(a,"maxPool3d");var h=l;null==h&&(h=[1,1,1]);var f=Np(a.shape,i,o,h,s,u,c),p=lI(n.data.get(a.dataId).values,a.shape,a.dtype,ms(a.shape),f,"max");return n.makeTensorInfo(p.shape,"float32",p.values)}};var LN={kernelName:hc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,s=r.strides,u=r.pad,c=r.dilations,l=r.dimRoundingMode;ZT([a,i],"maxPool3DGrad");for(var h=Np(i.shape,o,s,c,u,l),f=function(e,t){for(var n=If(t.outShape,"int32"),r=t.strideDepth,a=t.strideHeight,i=t.strideWidth,o=t.dilationDepth,s=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterDepth,l=t.effectiveFilterHeight,h=t.effectiveFilterWidth,f=t.padInfo.front,p=t.padInfo.top,d=t.padInfo.left,m=0;m<t.batchSize;++m)for(var v=0;v<t.inChannels;++v)for(var g=0;g<t.outDepth;++g){for(var y=g*r-f,b=y;b<0;)b+=o;for(var k=Math.min(t.inDepth,c+y),x=0;x<t.outHeight;++x){for(var w=x*a-p,_=w;_<0;)_+=s;for(var S=Math.min(t.inHeight,l+w),C=0;C<t.outWidth;++C){for(var T=C*i-d,E=T;E<0;)E+=u;for(var I=Math.min(t.inWidth,h+T),A=Number.NEGATIVE_INFINITY,N=-1,P=b;P<k;P+=o)for(var M=P-y,D=_;D<S;D+=s)for(var R=D-w,O=E;O<I;O+=u){var F=O-T,L=e.get(m,P,D,O,v);L>=A&&(A=L,N=M*l*h+R*l+F)}n.set(N,m,g,x,C,v)}}}return n}(n.bufferSync(i),h),p=h.strideDepth,d=h.strideHeight,m=h.strideWidth,v=h.dilationDepth,g=h.dilationHeight,y=h.dilationWidth,b=h.effectiveFilterDepth,k=h.effectiveFilterHeight,x=h.effectiveFilterWidth,w=b-1-h.padInfo.front,_=x-1-h.padInfo.left,S=k-1-h.padInfo.top,C=If(i.shape,"float32"),T=n.bufferSync(a),E=0;E<h.batchSize;++E)for(var I=0;I<h.inChannels;++I)for(var A=0;A<h.inDepth;++A)for(var N=0;N<h.inHeight;++N)for(var P=0;P<h.inWidth;++P){for(var M=A-w,D=N-S,R=P-_,O=0,F=0;F<b;F+=v){var L=(M+F)/p;if(!(L<0||L>=h.outDepth||Math.floor(L)!==L))for(var z=0;z<k;z+=g){var B=(D+z)/d;if(!(B<0||B>=h.outHeight||Math.floor(B)!==B))for(var V=0;V<x;V+=y){var j=(R+V)/m;if(!(j<0||j>=h.outWidth||Math.floor(j)!==j)){var q=b*k*x-1-f.get(E,L,B,j,I)===F*k*x+z*x+V?1:0;if(0!==q)O+=T.get(E,L,B,j,I)*q}}}}C.set(O,E,A,N,P,I)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}};var zN={kernelName:cc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;ZT([i,t.output],"maxPoolGrad");for(var s=r.filterSize,u=r.strides,c=r.pad,l=r.dimRoundingMode,h=Ap(o.shape,s,u,1,c,l),f=n.data.get(o.dataId).values,p=If(h.outShape,o.dtype,cI(f,o.shape,o.dtype,h).values),d=h.strideHeight,m=h.strideWidth,v=h.dilationHeight,g=h.dilationWidth,y=h.effectiveFilterHeight,b=h.effectiveFilterWidth,k=b-1-h.padInfo.left,x=y-1-h.padInfo.top,w=If(o.shape,"float32"),_=n.data.get(a.dataId).values,S=If(a.shape,"float32",_),C=0;C<h.batchSize;++C)for(var T=0;T<h.inChannels;++T)for(var E=0;E<h.inHeight;++E)for(var I=0;I<h.inWidth;++I){for(var A=E-x,N=I-k,P=0,M=0;M<y;M+=v){var D=(A+M)/d;if(!(D<0||D>=h.outHeight||Math.floor(D)!==D))for(var R=0;R<b;R+=g){var O=(N+R)/m;if(!(O<0||O>=h.outWidth||Math.floor(O)!==O)){var F=y*b-1-p.get(C,D,O,T)===M*b+R?1:0;if(0!==F)P+=S.get(C,D,O,T)*F}}}w.set(P,C,E,I,T)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}};var BN={kernelName:fc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.filterSize,o=n.strides,s=n.pad,u=n.includeBatchInIndex,c=r;ZT(a,"MaxPoolWithArgmax");var l=c.data.get(a.dataId).values,h=Ap(a.shape,i,o,[1,1],s),f=function(e,t,n,r,a){var i=uI(e,0,n,ms(t),a,"max"),o=cI(e,t,n,a,!0,r);return[i.values,o.values]}(l,a.shape,a.dtype,u,h),p=Ct(f,2),d=p[0],m=p[1],v=c.write(d,h.outShape,a.dtype),g=c.write(m,h.outShape,a.dtype);return[{dataId:v,shape:h.outShape,dtype:a.dtype},{dataId:g,shape:h.outShape,dtype:"int32"}]}};function VN(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.axis,s=a.keepDims;ZT(i,"sum");var u=(t="bool"===i.dtype?SE({inputs:{x:i},backend:r,attrs:{dtype:"int32"}}):oE({inputs:{x:i},backend:r})).shape.length,c=rs(o,t.shape),l=Wd(c,u),h=c,f=t;null!=l&&(f=UE({inputs:{x:t},backend:r,attrs:{perm:l}}),h=Hd(h.length,u)),Gd("sum",h,f.shape.length);for(var p=Ct(jd(f.shape,h),2),d=p[0],m=p[1],v=xE(r,d,nh(f.dtype,"int32")),g=Qo(m),y=r.data.get(v.dataId).values,b=r.data.get(f.dataId).values,k=0;k<y.length;++k){for(var x=k*g,w=0,_=0;_<g;++_)w+=b[x+_];y[k]=w}if(s){var S=v;v=ME({inputs:{x:v},backend:r,attrs:{shape:qd(v.shape,c)}}),r.disposeIntermediateTensorInfo(S)}return r.disposeIntermediateTensorInfo(t),null!=l&&r.disposeIntermediateTensorInfo(f),v}var jN={kernelName:tl,backendName:"cpu",kernelFunc:VN};var qN={kernelName:pc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,s=rs(i,a.shape),u=Qo(jd(a.shape,s)[1]),c=[],l=n.makeTensorInfo([],"float32",new Float32Array([u]));c.push(l);var h=SE({inputs:{x:a},backend:n,attrs:{dtype:"float32"}});c.push(h);var f=_A({inputs:{a:h,b:l},backend:n});c.push(f);var p=VN({inputs:{x:f},backend:n,attrs:{axis:i,keepDims:o}});return c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),p}};var GN={kernelName:dc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;ZT(a,"min");var s=rs(i,a.shape),u=s,c=Wd(u,a.shape.length),l=a;null!=c&&(l=UE({inputs:{x:a},backend:n,attrs:{perm:c}}),u=Hd(u.length,a.shape.length)),Gd("min",u,l.shape.length);for(var h=Ct(jd(l.shape,u),2),f=h[0],p=Qo(h[1]),d=bs(Qo(f),l.dtype),m=n.data.get(l.dataId).values,v=0;v<d.length;++v){for(var g=v*p,y=m[g],b=0;b<p;++b){var k=m[g+b];k<y&&(y=k)}d[v]=y}null!=c&&n.disposeIntermediateTensorInfo(l);var x=n.makeTensorInfo(f,l.dtype,d);if(o){var w=ME({inputs:{x:x},backend:n,attrs:{shape:qd(f,s)}});return n.disposeIntermediateTensorInfo(x),w}return x}},WN=lE((function(e,t){return Math.min(e,t)})),UN=TE(mc,WN),HN={kernelName:mc,backendName:"cpu",kernelFunc:UN};var KN={kernelName:vc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.mode;ZT(a,"mirrorPad");for(var s=i.map((function(e,t){return e[0]+a.shape[t]+e[1]})),u=i.map((function(e){return e[0]})),c=i.map((function(e,t){return e[0]+a.shape[t]})),l="reflect"===o?0:1,h=n.data.get(a.dataId).values,f=a.shape.length,p=ms(a.shape),d=Qo(s),m=s.length,v=ms(s),g=is(a.dtype,d),y=0;y<d;y++){for(var b=_s(y,m,v),k=0;k<m;k++)b[k]<u[k]?b[k]=2*u[k]-b[k]-l:b[k]>=c[k]&&(b[k]=2*(c[k]-1)-b[k]+l);b=b.map((function(e,t){return e-u[t]}));var x=ws(b,f,p);g[y]=h[x]}return{dataId:n.write(g,s,a.dtype),shape:s,dtype:a.dtype}}},XN=lE((function(e,t){var n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t})),YN=TE(gc,XN),QN={kernelName:gc,backendName:"cpu",kernelFunc:YN},$N=__webpack_require__(8598);function JN(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.dim,o=a.shape.length,s=i;if(-1===s&&(s=o-1),s!==o-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(o," and dim was ").concat(s));var u=rs([s],a.shape),c=NN({inputs:{x:a},backend:n,attrs:{reductionIndices:u,keepDims:!1}}),l=qd(c.shape,u),h=ME({inputs:{x:c},backend:n,attrs:{shape:l}}),f=EA({inputs:{a:a,b:h},backend:n}),p=hA({inputs:{x:f},backend:n}),d=VN({inputs:{x:p},backend:n,attrs:{axis:u,keepDims:!1}}),m=ME({inputs:{x:d},backend:n,attrs:{shape:l}}),v=_A({inputs:{a:p,b:m},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(m),v}var ZN={kernelName:al,backendName:"cpu",kernelFunc:JN};var eP={kernelName:yc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.numSamples,o=r.seed,s=r.normalized;ZT(a,"multinomial");for(var u=s?a:JN({inputs:{logits:a},backend:n,attrs:{dim:-1}}),c=u.shape[0],l=u.shape[1],h=n.data.get(u.dataId).values,f=[c,i],p=bs(Qo(f),"int32"),d=0;d<c;++d){var m=d*l,v=new Float32Array(l-1);v[0]=h[m];for(var g=1;g<v.length;++g)v[g]=v[g-1]+h[m+g];for(var y=$N.alea(o.toString()),b=d*i,k=0;k<i;++k){var x=y();p[b+k]=v.length;for(var w=0;w<v.length;w++)if(x<v[w]){p[b+k]=w;break}}}return s||n.disposeIntermediateTensorInfo(u),n.makeTensorInfo(f,"int32",p)}};function tP(e,t,n){var r=Vl(-1,n);return yA([],t,r,e,n)}var nP={kernelName:kc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x;ZT(r,"neg");var a=Ct(tP(n.data.get(r.dataId).values,r.shape,r.dtype),2),i=a[0],o=a[1];return n.makeTensorInfo(o,r.dtype,i)}},rP=sv;var aP={kernelName:wc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold;ZT(a,"NonMaxSuppression");var c=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,h=rP(c,l,o,s,u).selectedIndices;return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}},iP=uv;var oP={kernelName:_c,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.padToMaxOutputSize;ZT(a,"NonMaxSuppressionPadded");var l=n.data.get(a.dataId).values,h=n.data.get(i.dataId).values,f=iP(l,h,o,s,u,c),p=f.selectedIndices,d=f.validOutputs;return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([d]))]}},sP=cv;var uP={kernelName:Sc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.softNmsSigma;ZT(a,"NonMaxSuppressionWithScore");var l=n.data.get(a.dataId).values,h=n.data.get(i.dataId).values,f=sP(l,h,o,s,u,c),p=f.selectedIndices,d=f.selectedScores;return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([d.length],"float32",new Float32Array(d))]}},cP=lE((function(e,t){return e!==t?1:0})),lP=TE(xc,cP,null,"bool"),hP={kernelName:xc,backendName:"cpu",kernelFunc:lP};var fP={kernelName:Tc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=r.depth,o=r.onValue,s=r.offValue;ZT(a,"oneHot");var u=Qo(a.shape),c=new Float32Array(u*i);c.fill(s);for(var l=n.data.get(a.dataId).values,h=0;h<u;++h)l[h]>=0&&l[h]<i&&(c[h*i+l[h]]=o);return n.makeTensorInfo([].concat(Fn(a.shape),[i]),"int32",c)}};function pP(e){var t=e.inputs,n=e.backend,r=t.x;if("string"===r.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===r.dtype){var a=wE({inputs:{input:r},backend:n}),i=pP({inputs:{x:a},backend:n}),o=PI({inputs:{input:r},backend:n}),s=pP({inputs:{x:o},backend:n}),u=bE({inputs:{real:i,imag:s},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}return DA({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}var dP={kernelName:yl,backendName:"cpu",kernelFunc:pP};var mP={kernelName:Cc,backendName:"cpu",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n.x;if("string"===a.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===a.dtype){var i=wE({inputs:{input:a},backend:r}),o=e({inputs:{x:i},backend:r}),s=PI({inputs:{input:a},backend:r}),u=pP({inputs:{x:s},backend:r}),c=bE({inputs:{real:o,imag:u},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(u),c}return DA({backend:r,attrs:{shape:a.shape,value:1,dtype:a.dtype}})}};function vP(e){var t=e.inputs,n=e.backend,r=e.attrs.axis;if(1===t.length)return pA({inputs:{input:t[0]},backend:n,attrs:{dim:r}});var a=t[0].shape,i=t[0].dtype;t.forEach((function(e){Ko(a,e.shape,"All tensors passed to stack must have matching shapes"),Ho(i===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=[],s=DI({inputs:t.map((function(e){var t=pA({inputs:{input:e},backend:n,attrs:{dim:r}});return o.push(t),t})),backend:n,attrs:{axis:r}});return o.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),s}var gP={kernelName:Ec,backendName:"cpu",kernelFunc:vP};var yP={kernelName:Ic,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.constantValue;ZT(a,"pad");var s=i.map((function(e,t){return e[0]+a.shape[t]+e[1]})),u=i.map((function(e){return e[0]})),c=n.data.get(a.dataId).values,l=Qo(a.shape),h=a.shape.length,f=ms(a.shape),p=Qo(s),d=s.length,m=ms(s),v=is(a.dtype,p);0!==o&&v.fill(o);for(var g=0;g<l;g++){v[ws(_s(g,h,f).map((function(e,t){return e+u[t]})),d,m)]=c[g]}return{dataId:n.write(v,s,a.dtype),shape:s,dtype:a.dtype}}},bP=lE((function(e,t){return Math.pow(e,t)})),kP=TE(Ac,bP),xP={kernelName:Ac,backendName:"cpu",kernelFunc:kP};function wP(e,t,n,r){for(var a=Ct(jd(e,r),2),i=a[0],o=a[1],s=nh(t,"int32"),u=bs(Qo(i),s),c=Qo(o),l=0;l<u.length;++l){for(var h=l*c,f=1,p=0;p<c;++p)f*=n[h+p];u[l]=f}return{outVals:u,outShape:i,outDtype:s}}var _P={kernelName:Pc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;ZT(a,"prod");var s=a.shape.length,u=rs(i,a.shape),c=Wd(u,s),l=u,h=a,f=[];null!=c&&(h=UE({inputs:{x:a},backend:n,attrs:{perm:c}}),f.push(h),l=Hd(l.length,s));var p=n.data.get(h.dataId).values,d=wP(h.shape,h.dtype,p,l),m=d.outVals,v=d.outShape,g=d.outDtype,y=v;return o&&(y=qd(v,u)),f.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(y,g,m)}};function SP(e,t,n,r){if(e===t||e<t&&n<0||t<e&&n>1)return bs(0,r);var a=bs(Math.abs(Math.ceil((t-e)/n)),r);t<e&&1===n&&(n=-1),a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+n;return a}var CP={kernelName:Mc,backendName:"cpu",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.dtype,o=SP(r,a,n.step,i);return t.makeTensorInfo([o.length],i,o)}},TP=nE(Rc,(function(e){return 1/e})),EP={kernelName:Rc,backendName:"cpu",kernelFunc:TP};var IP={kernelName:Bc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,s=r.size;ZT(a,"resizeBilinear");for(var u=ms(a.shape),c=Ct(s,2),l=c[0],h=c[1],f=Ct(a.shape,4),p=f[0],d=f[1],m=f[2],v=f[3],g=n.data.get(a.dataId).values,y=new Float32Array(Qo([p,l,h,v])),b=[i&&l>1?d-1:d,i&&h>1?m-1:m],k=[i&&l>1?l-1:l,i&&h>1?h-1:h],x=0,w=b[0]/k[0],_=b[1]/k[1],S=0;S<p;S++)for(var C=0;C<l;C++){var T=void 0;T=o?w*(C+.5)-.5:w*C;for(var E=Math.max(0,Math.floor(T)),I=T-E,A=Math.min(d-1,Math.ceil(T)),N=S*u[0]+E*u[1],P=S*u[0]+A*u[1],M=0;M<h;M++){var D=void 0;D=o?_*(M+.5)-.5:_*M;for(var R=Math.max(0,Math.floor(D)),O=D-R,F=Math.min(m-1,Math.ceil(D)),L=N+R*u[2],z=P+R*u[2],B=N+F*u[2],V=P+F*u[2],j=0;j<v;j++){var q=g[L+j],G=g[z+j],W=q+(g[B+j]-q)*O,U=W+(G+(g[V+j]-G)*O-W)*I;y[x++]=U}}}return n.makeTensorInfo([p,l,h,v],"float32",y)}};var AP={kernelName:Vc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners;ZT([i,a],"resizeBilinearGrad");for(var s=ms(a.shape),u=Ct(a.shape,4),c=u[0],l=u[1],h=u[2],f=u[3],p=Ct(i.shape,3),d=p[1],m=p[2],v=new Float32Array(c*l*h*f),g=[o&&d>1?l-1:l,o&&m>1?h-1:h],y=[o&&d>1?d-1:d,o&&m>1?m-1:m],b=g[0]/y[0],k=g[1]/y[1],x=n.data.get(i.dataId).values,w=0,_=0;_<c;_++)for(var S=_*s[0],C=0;C<d;C++)for(var T=C*b,E=Math.floor(T),I=Math.min(Math.ceil(T),l-1),A=S+E*s[1],N=S+I*s[1],P=T-E,M=1-P,D=0;D<m;D++)for(var R=D*k,O=Math.floor(R),F=Math.min(Math.ceil(R),h-1),L=R-O,z=1-L,B=A+O*s[2],V=A+F*s[2],j=N+O*s[2],q=N+F*s[2],G=M*z,W=M*L,U=P*z,H=P*L,K=0;K<f;K++){var X=x[w++];v[B+K]+=X*G,v[V+K]+=X*W,v[j+K]+=X*U,v[q+K]+=X*H}return n.makeTensorInfo([c,h,l,f],"float32",v)}};var NP={kernelName:Lc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,s=r.size;ZT(a,"resizeNearestNeighbor");for(var u=ms(a.shape),c=Ct(s,2),l=c[0],h=c[1],f=Ct(a.shape,4),p=f[0],d=f[1],m=f[2],v=f[3],g=n.data.get(a.dataId).values,y=new Float32Array(p*l*h*v),b=[i&&l>1?d-1:d,i&&h>1?m-1:m],k=[i&&l>1?l-1:l,i&&h>1?h-1:h],x=b[0]/k[0],w=b[1]/k[1],_=0,S=0;S<p;S++)for(var C=S*u[0],T=0;T<l;T++){var E=o?x*(T+.5):x*T,I=Math.min(d-1,i?Math.round(E):Math.floor(E));o&&(I=Math.max(0,I));for(var A=C+I*u[1],N=0;N<h;N++){var P=o?w*(N+.5):w*N,M=Math.min(m-1,i?Math.round(P):Math.floor(P));o&&(M=Math.max(0,M));for(var D=A+M*u[2],R=0;R<v;R++){var O=g[D+R];y[_++]=O}}}return n.makeTensorInfo([p,l,h,v],a.dtype,y)}};var PP={kernelName:zc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners;ZT([i,a],"resizeNearestNeighborGrad");for(var s=ms(a.shape),u=ms(i.shape),c=Ct(a.shape,4),l=c[0],h=c[1],f=c[2],p=c[3],d=Ct(i.shape,3),m=d[1],v=d[2],g=new Float32Array(l*h*f*p),y=n.data.get(i.dataId).values,b=[o&&m>1?h-1:h,o&&v>1?f-1:f],k=[o&&m>1?m-1:m,o&&v>1?v-1:v],x=b[0]/k[0],w=b[1]/k[1],_=1/x,S=1/w,C=2*Math.ceil(_)+2,T=2*Math.ceil(S)+2,E=0;E<l;E++)for(var I=E*s[0],A=0;A<h;A++)for(var N=I+A*s[1],P=Math.floor(A*_),M=Math.floor(P-C/2),D=0;D<f;D++)for(var R=N+D*s[2],O=Math.floor(D*S),F=Math.floor(O-T/2),L=0;L<p;L++){for(var z=0,B=0;B<C;B++){var V=B+M;if(!(V<0||V>=m)){var j=I+V*u[1],q=V*x;if(A===Math.min(h-1,o?Math.round(q):Math.floor(q)))for(var G=0;G<T;G++){var W=G+F;if(!(W<0||W>=v)){var U=j+W*u[2],H=W*w;D===Math.min(f-1,o?Math.round(H):Math.floor(H))&&(z+=y[U+L])}}}}g[R+L]=z}return n.makeTensorInfo(a.shape,a.dtype,g)}};var MP={kernelName:qc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.dims;ZT(a,"reverse");var o=a.shape.length,s=rs(i,a.shape);if(0===o)return oE({inputs:{x:a},backend:n});for(var u=new Ul(a.shape,a.dtype),c=n.bufferSync(a),l=function(e){var t=u.indexToLoc(e),n=t.slice();s.forEach((function(e){return n[e]=a.shape[e]-1-n[e]})),u.set.apply(u,[c.get.apply(c,Fn(n))].concat(Fn(t)))},h=0;h<u.size;h++)l(h);return n.makeTensorInfo(u.shape,u.dtype,u.values)}},DP={kernelName:kl,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,i=n.radians,o=n.fillValue,s=n.center,u=r,c=is(a.dtype,Qo(a.shape)),l=Ct(a.shape,4),h=l[0],f=l[1],p=l[2],d=l[3],m=Ct(Xv(s,f,p),2),v=m[0],g=m[1],y=Math.sin(i),b=Math.cos(i),k=u.data.get(a.dataId).values,x=0;x<h;x++)for(var w=x*p*f*d,_=0;_<f;_++)for(var S=_*(p*d),C=0;C<p;C++)for(var T=C*d,E=0;E<d;E++){var I=[h,_,C,E],A=I[2],N=I[1],P=(A-v)*b-(N-g)*y,M=(A-v)*y+(N-g)*b;P=Math.round(P+v),M=Math.round(M+g);var D=o;if("number"!==typeof o&&(D=3===E?255:o[E]),P>=0&&P<p&&M>=0&&M<f)D=k[w+M*(p*d)+P*d+E];c[w+S+T+E]=D}return{dataId:u.write(c,a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},RP=nE(Gc,(function(e){var t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1})),OP={kernelName:Gc,backendName:"cpu",kernelFunc:RP},FP=_I((function(e){return 1/Math.sqrt(e)})),LP=rE(Wc,FP),zP={kernelName:Wc,backendName:"cpu",kernelFunc:LP};function BP(e,t,n,r,a,i,o,s,u,c){var l=[r/a,a],h=e.values,f=t.values;if(0===r)return If(n,t.dtype);var p=If(l,t.dtype);p.values.fill(u);for(var d=0;d<i;d++){for(var m=[],v=0,g=0;g<o;g++){var y=h[d*o+g];m.push(y),v+=y*s[g]}if(v<0||v>=r/a)throw new Error("Invalid indices: ".concat(m," does not index into ").concat(n));for(var b=0;b<a;b++)c?p.values[v*a+b]+=f[d*a+b]:p.values[v*a+b]=0===t.rank?f[0]:f[d*a+b]}return p}var VP={kernelName:Uc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=t.updates,o=r.shape,s=tg(0,a,o),u=s.sliceRank,c=s.numUpdates,l=s.sliceSize,h=s.strides,f=s.outputSize,p=BP(n.bufferSync(a),n.bufferSync(i),o,f,l,c,u,h,0,!0);return n.makeTensorInfo(o,p.dtype,p.values)}};var jP={kernelName:Hc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.condition,a=t.t,i=t.e;ZT([r,a,i],"select");for(var o=r.shape.length,s=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,l=nh(a.dtype,i.dtype),h=bs(Qo(a.shape),l),f=0,p=0===o||o>1||1===a.shape.length?1:Qo(a.shape.slice(1)),d=0;d<s.length;d++)for(var m=0;m<p;m++)1===s[d]?h[f++]=u[d]:h[f++]=c[d];return n.makeTensorInfo(a.shape,l,h)}},qP=nE(Kc,(function(e){return e>=0?1.0507009873554805*e:1.7580993408473768*(Math.exp(e)-1)})),GP={kernelName:Kc,backendName:"cpu",kernelFunc:qP},WP=nE(Jc,(function(e){return 1/(1+Math.exp(-e))})),UP={kernelName:Jc,backendName:"cpu",kernelFunc:WP},HP=nE($c,(function(e){return e<0?-1:e>0?1:0})),KP={kernelName:$c,backendName:"cpu",kernelFunc:HP},XP=nE(Yc,(function(e){return Math.sin(e)})),YP={kernelName:Yc,backendName:"cpu",kernelFunc:XP},QP=nE(Qc,(function(e){return Math.sinh(e)})),$P={kernelName:Qc,backendName:"cpu",kernelFunc:QP},JP=Math.log(1.1920928955078125e-7)+2,ZP=nE(Zc,(function(e){var t=e>-JP,n=e<JP,r=Math.exp(e);return n?r:t?e:Math.log(1+r)})),eM={kernelName:Zc,backendName:"cpu",kernelFunc:ZP};var tM={kernelName:nl,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.paddings;ZT([a],"spaceToBatchND");var s=Qo(i),u=[[0,0]];u.push.apply(u,Fn(o));for(var c=1+i.length;c<a.shape.length;++c)u.push([0,0]);var l=yP.kernelFunc({inputs:{x:a},backend:n,attrs:{paddings:u,constantValue:0}}),h=Yv(l.shape,i,s,!1),f=Qv(h.length,i.length,!1),p=$v(l.shape,i,s,!1),d=ME({inputs:{x:l},backend:n,attrs:{shape:h}}),m=UE({inputs:{x:d},backend:n,attrs:{perm:f}}),v=ME({inputs:{x:m},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(m),v}};var nM={kernelName:ul,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.sparseIndices,i=t.sparseValues,o=t.defaultValue,s=r.outputShape,u=tg(0,a,s),c=u.sliceRank,l=u.numUpdates,h=u.sliceSize,f=u.strides,p=u.outputSize,d=BP(n.bufferSync(a),n.bufferSync(i),s,p,h,l,c,f,n.data.get(o.dataId).values[0],!1);return n.makeTensorInfo(s,d.dtype,d.values)}};var rM={kernelName:rl,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.numOrSizeSplits,o=rs(r.axis,a.shape)[0],s=mg(a,i,o),u=new Array(a.shape.length).fill(0),c=a.shape.slice();return s.map((function(e){var t=Fn(c);t[o]=e;var r=gI({inputs:{x:a},backend:n,attrs:{begin:u,size:t}});return u[o]+=e,r}))}},aM=nE(el,(function(e){return Math.sqrt(e)})),iM={kernelName:el,backendName:"cpu",kernelFunc:aM},oM={kernelName:ol,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n;ZT(r,"square");for(var i=a.data.get(r.dataId).values,o=new Float32Array(i.length),s=0;s<i.length;++s){var u=i[s];o[s]=u*u}return{dataId:a.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},sM=lE((function(e,t){var n=e-t;return n*n})),uM=TE(il,sM),cM={kernelName:il,backendName:"cpu",kernelFunc:uM},lM=nE(bl,(function(e,t){var n=t;return isNaN(e)?NaN:e>0?1:n.alpha})),hM={kernelName:bl,backendName:"cpu",kernelFunc:lM};function fM(e,t,n,r){for(var a=If(e,t.dtype),i=0;i<a.size;i++){for(var o=a.indexToLoc(i),s=new Array(o.length),u=0;u<s.length;u++)s[u]=o[u]*n[u]+r[u];a.set.apply(a,[t.get.apply(t,s)].concat(Fn(o)))}return a}var pM={kernelName:cl,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.begin,o=r.end,s=r.strides,u=r.beginMask,c=r.endMask,l=r.ellipsisMask,h=r.newAxisMask,f=r.shrinkAxisMask;ZT(a,"stridedSlice");var p,d=cp(a.shape,i,o,s,u,c,l,h,f),m=d.nonStrided,v=d.$begin,g=d.$strides,y=d.size,b=d.newShape,k=d.outShape,x=ME({inputs:{x:a},backend:n,attrs:{shape:b}});if(m){var w=gI({inputs:{x:x},backend:n,attrs:{begin:v,size:y}});p=ME({inputs:{x:w},backend:n,attrs:{shape:k}}),n.disposeIntermediateTensorInfo(w)}else if(k.some((function(e){return 0===e})))p=n.makeTensorInfo(k,a.dtype,[]);else{var _=fM(k,n.bufferSync(x),g,v);p=n.makeTensorInfo(_.shape,_.dtype,_.values)}var S=ME({inputs:{x:p},backend:n,attrs:{shape:k}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(p),S}},dM=nE(ll,(function(e){return Math.tan(e)})),mM={kernelName:ll,backendName:"cpu",kernelFunc:dM},vM=nE(hl,(function(e){return Math.tanh(e)}));function gM(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];for(var a=If(n,e.dtype),i=0;i<a.values.length;++i){for(var o=a.indexToLoc(i),s=new Array(e.rank),u=0;u<s.length;u++)s[u]=o[u]%e.shape[u];var c=e.locToIndex(s);a.values[i]=e.values[c]}return a}var yM={kernelName:fl,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reps;ZT(a,"tile");var o=gM(n.bufferSync(a),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}};function bM(e,t,n,r,a){for(var i=t[t.length-1],o=e.length/i,s=i,u=is(n,o*r),c=is("int32",o*r),l=0;l<o;l++){for(var h=l*s,f=e.subarray(h,h+s),p=[],d=0;d<f.length;d++)p.push({value:f[d],index:d});p.sort((function(e,t){return t.value-e.value}));for(var m=l*r,v=u.subarray(m,m+r),g=c.subarray(m,m+r),y=0;y<r;y++)v[y]=p[y].value,g[y]=p[y].index}var b=t.slice();return b[b.length-1]=r,[If(b,n,u),If(b,"int32",c)]}var kM={kernelName:pl,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.k;r.sorted,ZT(a,"topk");var o=Ct(bM(n.data.get(a.dataId).values,a.shape,a.dtype,i),2),s=o[0],u=o[1];return[n.makeTensorInfo(s.shape,s.dtype,s.values),n.makeTensorInfo(u.shape,u.dtype,u.values)]}};function xM(e,t,n,r){for(var a=rs(t,n)[0],i=[1,n[0],1],o=0;o<a;o++)i[0]*=n[o];i[1]=n[a];for(var s=a+1;s<n.length;s++)i[2]*=n[s];for(var u={},c=new Int32Array(n[a]),l=new Ul(i,r,e),h=[],f=1===i[0]&&1===i[2],p=0;p<n[a];p++){var d=void 0;if(f)d=e[p].toString();else{for(var m=[],v=0;v<i[0];v++)for(var g=0;g<i[2];g++)m.push(l.get(v,p,g));d=m.join(",")}if(void 0!==u[d])c[p]=u[d];else{var y=Object.keys(u).length;u[d]=y,c[p]=y,h.push(p)}}var b=i.slice();b[1]=Object.keys(u).length;var k=new Ul(b,r);h.forEach((function(e,t){for(var n=0;n<i[0];n++)for(var r=0;r<i[2];r++)k.set(l.get(n,e,r),n,t,r)}));var x=n.slice();return x[a]=b[1],{outputValues:k.values,outputShape:x,indices:c}}var wM={kernelName:ml,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.axis,i=t.x;ZT(i,"unique");var o=xM(r.data.get(i.dataId).values,a,i.shape,i.dtype),s=o.outputValues,u=o.outputShape,c=o.indices;return[r.makeTensorInfo(u,i.dtype,s),r.makeTensorInfo([c.length],"int32",c)]}};var _M={kernelName:vl,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.value,i=r.axis;i<0&&(i+=a.shape.length);for(var o=a.shape.length,s=a.shape[i],u=new Array(o-1),c=0,l=0;l<o;l++)l!==i&&(u[c++]=a.shape[l]);var h=new Array(o).fill(0),f=a.shape.slice();f[i]=1;for(var p=new Array(s),d=0;d<p.length;d++){h[i]=d;var m=gI({inputs:{x:a},backend:n,attrs:{begin:h,size:f}});p[d]=ME({inputs:{x:m},backend:n,attrs:{shape:u}}),n.disposeIntermediateTensorInfo(m)}return p}};for(var SM={kernelName:gl,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.segmentIds,o=r.numSegments;ZT(a,"unsortedSegmentSum");for(var s=[],u=[],c=a.shape.length-i.shape.length,l=i,h=0;h<c;++h){var f=pA({inputs:{input:l},backend:n,attrs:{dim:h+1}});l=f,u.push(f)}for(var p=0;p<o;++p){var d=Vl(p,"int32"),m=n.makeTensorInfo([],"int32",d),v=oA({inputs:{a:m,b:l},backend:n}),g=SE({inputs:{x:v},backend:n,attrs:{dtype:"float32"}}),y=kA({inputs:{a:g,b:a},backend:n}),b=VN({inputs:{x:y},backend:n,attrs:{axis:0,keepDims:!1}});s.push(b),u.push(m),u.push(v),u.push(g),u.push(y),u.push(b)}var k=vP({inputs:s,backend:n,attrs:{axis:0}});return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),k}},CM=0,TM=[FE,zE,VE,qE,PE,GE,KE,XE,YE,QE,JE,eI,nI,iI,sI,hI,fI,pI,dI,OE,mI,bI,wI,CE,TI,II,kE,AI,RI,LI,zI,FI,VI,jI,BI,GI,UI,HI,KI,XI,YI,$I,JI,ZI,eA,tA,rA,nA,SA,iE,aA,sA,cA,fA,dA,gA,MA,RA,OA,zA,jA,qA,GA,WA,HA,YA,JA,sE,ZA,MI,tN,rN,iN,cE,uN,hN,pN,vN,yN,xN,_N,TN,EN,IN,RN,ON,FN,LN,zN,BN,PN,qN,GN,HN,KN,QN,eP,xA,nP,aP,oP,uP,hP,fP,mP,gP,yP,xP,pE,_P,CP,_E,EP,mE,gE,DE,IP,AP,NP,PP,MP,DP,OP,zP,VP,jP,GP,UP,KP,YP,$P,yI,ZN,eM,tM,nM,rM,iM,oM,cM,hM,pM,IA,jN,mM,{kernelName:hl,backendName:"cpu",kernelFunc:vM},yM,kM,HE,wM,_M,SM,dP];CM<TM.length;CM++){Il(TM[CM])}var EM,IM,AM,NM={},PM={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function MM(e){if(!(e in NM)){var t=function(e){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var t=function(e){if("undefined"!==typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!==typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e);if(t.addEventListener("webglcontextlost",(function(t){t.preventDefault(),delete NM[e]}),!1),1===e)return t.getContext("webgl",PM)||t.getContext("experimental-webgl",PM);return t.getContext("webgl2",PM)}(e);if(null===t)return console.log("Could not get context for WebGL version",e),null;NM[e]=t}var n=NM[e];return n.isContextLost()?(delete NM[e],MM(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),NM[e])}function DM(e,t){return[t,e]}function RM(e){var t=Qo(e);return Zo(Math.ceil(t/4))}function OM(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function FM(e,t){var n,r,a,i,o,s,u,c,l,h=e;return 2===Is().getNumber("WEBGL_VERSION")?(n=h.R32F,r=h.R16F,a=h.RGBA16F,i=h.RGBA32F,o=h.RED,s=4,u=1,c=h.HALF_FLOAT,l=h.FLOAT):(n=e.RGBA,r=e.RGBA,a=e.RGBA,i=h.RGBA,o=e.RGBA,s=4,u=4,c=null!=t?t.HALF_FLOAT_OES:null,l=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:c,textureTypeFloat:l}}function LM(e,t){var n=t();return Is().getBool("DEBUG")&&function(e){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+function(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(t)}}(e,t))}(e),n}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(EM||(EM={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(IM||(IM={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(AM||(AM={}));function zM(e){return!!(Is().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function BM(e,t){return JM(e,(function(){return e.getExtension(t)}),'Extension "'+t+'" not supported on this browser.')}function VM(e,t){var n=JM(e,(function(){return e.createShader(e.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(LM(e,(function(){return e.shaderSource(n,t)})),LM(e,(function(){return e.compileShader(n)})),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw function(e,t){var n=GM.exec(t);if(null==n)return console.log("Couldn't parse line number in error: ".concat(t)),void console.log(e);for(var r=+n[1],a=e.split("\n"),i=a.length.toString().length+2,o=a.map((function(e,t){return es((t+1).toString(),i)+e})),s=0,u=0;u<o.length;u++)s=Math.max(o[u].length,s);var c=o.slice(0,r-1),l=o.slice(r-1,r),h=o.slice(r);console.log(c.join("\n")),console.log(t.split("\n")[0]),console.log("%c ".concat(es(l[0],s)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join("\n"))}(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}var jM,qM,GM=/ERROR: [0-9]+:([0-9]+):/g;function WM(e,t){if(LM(e,(function(){return e.validateProgram(t)})),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function UM(e,t,n,r,a,i,o){var s=e.getAttribLocation(t,n);return-1!==s&&(LM(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),LM(e,(function(){return e.vertexAttribPointer(s,a,e.FLOAT,!1,i,o)})),LM(e,(function(){return e.enableVertexAttribArray(s)})),!0)}function HM(e,t,n){return JM(e,(function(){return e.getUniformLocation(t,n)}),'uniform "'+n+'" not present in program.')}function KM(e,t,n){return e.getUniformLocation(t,n)}function XM(e,t,n,r){LM(e,(function(){return function(e,t,n){ZM(e,n),LM(e,(function(){return e.activeTexture(e.TEXTURE0+n)})),LM(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)}))}(e,t,r)})),LM(e,(function(){return e.uniform1i(n,r)}))}function YM(e,t,n){LM(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)})),LM(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}))}function QM(e,t){LM(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,t)})),LM(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}))}function $M(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(t)}}(e,t))}function JM(e,t,n){var r=LM(e,(function(){return t()}));if(null==r)throw new Error(n);return r}function ZM(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){var a="[gl.TEXTURE0, gl.TEXTURE".concat(n,"]");throw new Error("textureUnit must be in ".concat(a,"."))}}function eD(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return Qo(e.slice(0,e.length-t))}function tD(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function nD(e){var t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[eD(e)].concat(Fn(tD(e)))),t}function rD(e){return e%2===0}function aD(e,t){if($o(e=e.slice(-2),t=t.slice(-2)))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r)return!0;if(rD(n)&&rD(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&rD(e[0])&&rD(t[0])}function iD(e,t){return null!=e.getExtension(t)}function oD(e){try{if(null!=MM(e))return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function sD(e){if(0===e)return!1;var t=MM(e);if(1!==e){if(iD(t,"EXT_color_buffer_float"))return uD(t);var n="EXT_color_buffer_half_float";if(iD(t,n)){var r=t.getExtension(n);return function(e,t){var n=FM(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);var a=1,i=1;e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,a,i,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);var s=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(o),s}(t,r)}return!1}return!!iD(t,"OES_texture_float")&&(!!iD(t,"WEBGL_color_buffer_float")&&uD(t))}function uD(e){var t=FM(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),a}function cD(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&Ho("complex64"!==e.dtype,(function(){return"".concat(t," does not support complex64 tensors ")+"in the WebGL backend."}))}))}var lD=Is();function hD(){var e,t,n,r,a,i,o,s,u,c;return 2===Is().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",a="texture",i="outputColor",o="out vec4 outputColor;",s="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",u="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",a="texture2D",i="gl_FragColor",o="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:a,output:i,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:u,defineRound:c}}function fD(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",r=ms(t);return r.map((function(t,a){var i="int ".concat(e[a]," = ").concat(n," / ").concat(t),o=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * ").concat(t):"index -= ".concat(e[a]," * ").concat(t);return"".concat(i,"; ").concat(o,";")})).join("")}function pD(e){var t=ms(e).map((function(e){return e.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(t[0]," + coords.y * ").concat(t[1]," + coords.z;\n  }\n")}lD.registerFlag("HAS_WEBGL",(function(){return lD.getNumber("WEBGL_VERSION")>0})),lD.registerFlag("WEBGL_VERSION",(function(){return oD(2)?2:oD(1)?1:0})),lD.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(function(){return!1})),lD.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===lD.get("WEBGL_VERSION")})),lD.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),lD.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),lD.registerFlag("WEBGL_PACK",(function(){return lD.getBool("HAS_WEBGL")})),lD.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return lD.getBool("WEBGL_PACK")})),lD.registerFlag("WEBGL_PACK_CLIP",(function(){return lD.getBool("WEBGL_PACK")})),lD.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),lD.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return lD.getBool("WEBGL_PACK")})),lD.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return lD.getBool("WEBGL_PACK")})),lD.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return lD.getBool("WEBGL_PACK")})),lD.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return lD.getBool("WEBGL_PACK")})),lD.registerFlag("WEBGL_PACK_REDUCE",(function(){return lD.getBool("WEBGL_PACK")})),lD.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return lD.getBool("WEBGL_PACK")})),lD.registerFlag("WEBGL_CONV_IM2COL",(function(){return lD.getBool("WEBGL_PACK")})),lD.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return function(e){if(null==jM){var t=MM(e);jM=t.getParameter(t.MAX_TEXTURE_SIZE)}return jM}(lD.getNumber("WEBGL_VERSION"))})),lD.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return function(e){if(null==qM){var t=MM(e);qM=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,qM)}(lD.getNumber("WEBGL_VERSION"))})),lD.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var e=lD.getNumber("WEBGL_VERSION");return 0===e?0:function(e){if(0===e)return 0;var t=MM(e);return iD(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:iD(t,"EXT_disjoint_timer_query")?1:0}(e)})),lD.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return lD.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!dh()})),lD.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return function(e){if(0===e)return!1;var t=MM(e);if(1===e){if(!iD(t,"OES_texture_float"))return!1}else if(!iD(t,"EXT_color_buffer_float"))return!1;return uD(t)}(lD.getNumber("WEBGL_VERSION"))})),lD.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!lD.getBool("WEBGL_FORCE_F16_TEXTURES")&&lD.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),lD.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return sD(lD.getNumber("WEBGL_VERSION"))})),lD.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return 2===(e=lD.getNumber("WEBGL_VERSION"))&&null!=MM(e).fenceSync;var e})),lD.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return lD.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),lD.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(function(){return-1}),(function(e){if(e<0&&-1!==e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never "+"delete) or at least 0, but got ".concat(e,"."))}));var dD="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",mD=c((function e(t){s(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=EM.DENSE;var n=RM(t),r=hD();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(fD(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(").concat(n[0],", ").concat(n[1],"));\n        int index = 4 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(r.output," = result;\n      }\n    ")})),vD=c((function e(t){s(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=EM.DENSE;var n=RM(t),r=hD();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(fD(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(").concat(n[0],", ").concat(n[1],"));\n        int index = 4 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(r.output," = result;\n      }\n    ")})),gD=c((function e(t){s(this,e),this.variableNames=["A"],this.outTexUsage=IM.DOWNLOAD;var n=hD();this.outputShape=t,this.userCode="\n      ".concat(dD,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(n.output," = encode_float(x);\n      }\n    ")})),yD=c((function e(t){s(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=IM.DOWNLOAD;var n=hD();this.outputShape=t,this.userCode="\n      ".concat(dD,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(n.output," = encode_float(x);\n      }\n    ")})),bD=c((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];s(this,e),this.variableNames=["A"];var a=hD(),i=Ct(n,2),o=i[0],u=i[1];this.outputShape=t;var c="result";r&&(c="floor(result * 255. + 0.5)"),this.userCode="\n      ".concat(pD(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n\n        int r = flatIndex / ").concat(u,";\n        int c = imod(flatIndex, ").concat(u,");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2(").concat(u,".0, ").concat(o,".0);\n        vec4 values = ").concat(a.texture2D,"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        ").concat(a.output," = vec4(").concat(c,", 0., 0., 0.);\n      }\n    ")})),kD=c((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];s(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var a=hD(),i=Ct(n,2),o=i[0],u=i[1];this.outputShape=t;var c="",l="result";r&&(l="floor(result * 255. + 0.5)");for(var h=0;h<=1;h++)for(var f=0;f<=1;f++){var p=2*h+f;c+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(f," < ").concat(t[2],") {\n            localCoords[2] += ").concat(f,";\n            if(localCoords[1] + ").concat(h," < ").concat(t[1],") {\n              localCoords[1] += ").concat(h,";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / ").concat(u,";\n              c = imod(flatIndex, ").concat(u,");\n              uv = (vec2(c, r) + halfCR) / vec2(").concat(u,".0, ").concat(o,".0);\n              values = ").concat(a.texture2D,"(A, uv);\n\n              if(offset == 0) {\n                result[").concat(p,"] = values[0];\n              } else if(offset == 1) {\n                result[").concat(p,"] = values[1];\n              } else if(offset == 2) {\n                result[").concat(p,"] = values[2];\n              } else {\n                result[").concat(p,"] = values[3];\n              }\n            }\n          }\n        ")}this.userCode="\n      ".concat(pD(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        ").concat(c,"\n\n        ").concat(a.output," = ").concat(l,";\n      }\n    ")}));function xD(e){var t=hD();return function(e,t){var n=JM(e,(function(){return e.createShader(e.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(LM(e,(function(){return e.shaderSource(n,t)})),LM(e,(function(){return e.compileShader(n)})),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(e,"".concat(t.version,"\n    precision highp float;\n    ").concat(t.attribute," vec3 clipSpacePos;\n    ").concat(t.attribute," vec2 uv;\n    ").concat(t.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}function wD(e){return function(e,t){var n=JM(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return LM(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),LM(e,(function(){return e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function _D(e){return function(e,t){var n=JM(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return LM(e,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)})),LM(e,(function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}(e,new Uint16Array([0,1,2,2,1,3]))}function SD(e,t,n,r,a,i){!function(e,t){var n=Is().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="[".concat(e,"x").concat(t,"]");throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n){var a="[".concat(e,"x").concat(t,"]"),i="[".concat(n,"x").concat(n,"]");throw new Error("Requested texture size "+a+" greater than WebGL maximum on this browser / GPU "+i+".")}}(t,n);var o=function(e){return JM(e,(function(){return e.createTexture()}),"Unable to create WebGLTexture.")}(e),s=e.TEXTURE_2D;return LM(e,(function(){return e.bindTexture(s,o)})),LM(e,(function(){return e.texParameteri(s,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)})),LM(e,(function(){return e.texParameteri(s,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)})),LM(e,(function(){return e.texParameteri(s,e.TEXTURE_MIN_FILTER,e.NEAREST)})),LM(e,(function(){return e.texParameteri(s,e.TEXTURE_MAG_FILTER,e.NEAREST)})),LM(e,(function(){return e.texImage2D(s,0,r,t,n,0,a,i,null)})),LM(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)})),o}function CD(e){return e.internalFormatFloat}function TD(e){return e.internalFormatHalfFloat}function ED(e){return e.downloadTextureFormat}function ID(e){return e.internalFormatPackedFloat}function AD(e){return e.internalFormatPackedHalfFloat}function ND(e,t,n,r,a,i,o,s){var u=e,c=new Float32Array(function(e,t){var n=Ct(OM(e,t),2);return n[0]*n[1]*4}(i,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}var PD=function(){function e(t){s(this,e),this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=Is().getNumber("WEBGL_VERSION");null!=t?(this.gl=t,function(e,t){NM[e]=t}(n,t)):this.gl=MM(n);var r="WEBGL_color_buffer_float",a="EXT_color_buffer_half_float";if(1===Is().getNumber("WEBGL_VERSION")){var i="OES_texture_half_float";if(this.textureFloatExtension=BM(this.gl,"OES_texture_float"),iD(this.gl,i))this.textureHalfFloatExtension=BM(this.gl,i);else if(Is().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),iD(this.gl,a))this.colorBufferHalfFloatExtension=BM(this.gl,a);else if(Is().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",iD(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!iD(this.gl,a))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(a)}this.vertexBuffer=wD(this.gl),this.indexBuffer=_D(this.gl),this.framebuffer=function(e){return JM(e,(function(){return e.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=FM(this.gl,this.textureHalfFloatExtension)}return c(e,[{key:"debug",get:function(){return Is().getBool("DEBUG")}},{key:"dispose",value:function(){var e=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;LM(t,(function(){return t.finish()})),LM(t,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),LM(t,(function(){return t.deleteFramebuffer(e.framebuffer)})),LM(t,(function(){return t.bindBuffer(t.ARRAY_BUFFER,null)})),LM(t,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)})),LM(t,(function(){return t.deleteBuffer(e.indexBuffer)})),this.disposed=!0}}},{key:"createFloat32MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=Ct(DM(t,n),2);return SD(e,a[0],a[1],CD(r),r.textureFormatFloat,e.FLOAT)}(this.gl,e,t,this.textureConfig)}},{key:"createFloat16MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=Ct(DM(t,n),2);return SD(e,a[0],a[1],TD(r),r.textureFormatFloat,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}},{key:"createUnsignedBytesMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=Ct(DM(t,n),2);return SD(e,a[0],a[1],ED(r),e.RGBA,e.UNSIGNED_BYTE)}(this.gl,e,t,this.textureConfig)}},{key:"uploadPixelDataToTexture",value:function(e,t){this.throwIfDisposed(),function(e,t,n){LM(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),n.data instanceof Uint8Array?LM(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)})):LM(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)})),LM(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,e,t)}},{key:"uploadDenseMatrixToTexture",value:function(e,t,n,r){this.throwIfDisposed(),function(e,t,n,r,a,i){var o,s,u;LM(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),a instanceof Uint8Array?(o=new Uint8Array(n*r*4),s=e.UNSIGNED_BYTE,u=e.RGBA):(o=new Float32Array(n*r*4),s=e.FLOAT,u=i.internalFormatPackedFloat),o.set(a),LM(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,u,n,r,0,e.RGBA,s,o)})),LM(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,e,t,n,r,this.textureConfig)}},{key:"createFloat16PackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=Ct(OM(t,n),2);return SD(e,a[0],a[1],AD(r),e.RGBA,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}},{key:"createPackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=Ct(OM(t,n),2);return SD(e,a[0],a[1],ID(r),e.RGBA,e.FLOAT)}(this.gl,e,t,this.textureConfig)}},{key:"deleteMatrixTexture",value:function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(QM(this.gl,this.framebuffer),this.outputTexture=null),LM(this.gl,(function(){return t.gl.deleteTexture(e)}))}},{key:"downloadByteEncodedFloatMatrixFromOutputTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n,r){var a=Ct(DM(t,n),2),i=a[0],o=a[1],s=new Uint8Array(t*n*4);return LM(e,(function(){return e.readPixels(0,0,i,o,r.downloadTextureFormat,e.UNSIGNED_BYTE,s)})),new Float32Array(s.buffer)}(r.gl,t,n,r.textureConfig)}))}},{key:"downloadPackedMatrixFromBuffer",value:function(e,t,n,r,a,i){return ND(this.gl,e,0,0,0,a,i,this.textureConfig)}},{key:"downloadFloat32MatrixFromBuffer",value:function(e,t){return function(e,t,n){var r=e,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}(this.gl,e,t)}},{key:"createBufferFromTexture",value:function(e,t,n){this.bindTextureToFrameBuffer(e);var r=function(e,t,n,r){var a=e.createBuffer();LM(e,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,a)}));var i=16*t*n;return LM(e,(function(){return e.bufferData(e.PIXEL_PACK_BUFFER,i,e.STREAM_READ)})),LM(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)})),LM(e,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)})),a}(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}},{key:"createAndWaitForFence",value:function(){var e=this.createFence(this.gl);return this.pollFence(e)}},{key:"createFence",value:function(e){var t,n,r=this;if(Is().getBool("WEBGL_FENCE_API_ENABLED")){var a=e,i=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=function(){var e=a.clientWaitSync(i,0,0);return e===a.ALREADY_SIGNALED||e===a.CONDITION_SATISFIED},t=i}else Is().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(t,Is().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:t,isFencePassed:n}}},{key:"downloadMatrixFromPackedTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n){var r=new Float32Array(t*n*4);return LM(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)})),r}(r.gl,t,n)}))}},{key:"createProgram",value:function(e){this.throwIfDisposed();var t=this.gl,n=VM(t,e),r=xD(t),a=function(e){return JM(e,(function(){return e.createProgram()}),"Unable to create WebGLProgram.")}(t);return LM(t,(function(){return t.attachShader(a,r)})),LM(t,(function(){return t.attachShader(a,n)})),function(e,t){if(LM(e,(function(){return e.linkProgram(t)})),!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}(t,a),this.debug&&WM(t,a),this.vertexAttrsAreBound||(this.setProgram(a),this.vertexAttrsAreBound=function(e,t,n){return LM(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),UM(e,t,"clipSpacePos",n,3,20,0)&&UM(e,t,"uv",n,2,20,12)}(t,this.program,this.vertexBuffer)),a}},{key:"deleteProgram",value:function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&LM(this.gl,(function(){return t.gl.deleteProgram(e)}))}},{key:"setProgram",value:function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&WM(this.gl,this.program),LM(this.gl,(function(){return t.gl.useProgram(e)}))}},{key:"getUniformLocation",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?HM(this.gl,e,t):KM(this.gl,e,t)}},{key:"getAttributeLocation",value:function(e,t){var n=this;return this.throwIfDisposed(),LM(this.gl,(function(){return n.gl.getAttribLocation(e,t)}))}},{key:"getUniformLocationNoThrow",value:function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}},{key:"setInputMatrixTexture",value:function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),XM(this.gl,e,t,n)}},{key:"setOutputMatrixTexture",value:function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}},{key:"setOutputPackedMatrixTexture",value:function(e,t,n){this.throwIfDisposed();var r=Ct(OM(t,n),2),a=r[0],i=r[1];this.setOutputMatrixTextureDriver(e,a,i)}},{key:"setOutputMatrixWriteRegion",value:function(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}},{key:"setOutputPackedMatrixWriteRegion",value:function(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}},{key:"debugValidate",value:function(){null!=this.program&&WM(this.gl,this.program),$M(this.gl)}},{key:"executeProgram",value:function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),LM(e,(function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}))}},{key:"blockUntilAllProgramsCompleted",value:function(){var e=this;this.throwIfDisposed(),LM(this.gl,(function(){return e.gl.finish()}))}},{key:"getQueryTimerExtension",value:function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=BM(this.gl,2===Is().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}},{key:"getQueryTimerExtensionWebGL2",value:function(){return this.getQueryTimerExtension()}},{key:"getQueryTimerExtensionWebGL1",value:function(){return this.getQueryTimerExtension()}},{key:"beginQuery",value:function(){if(2===Is().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),a=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,a),a}},{key:"endQuery",value:function(){if(2!==Is().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}}},{key:"waitForQueryAndGetTime",value:function(){var e=_(x().mark((function e(t){var n=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ts((function(){return n.disposed||n.isQueryAvailable(t,Is().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}));case 2:return e.abrupt("return",this.getQueryTime(t,Is().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getQueryTime",value:function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}},{key:"isQueryAvailable",value:function(e,t){if(0===t)return!0;if(2===t){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}var i=this.getQueryTimerExtensionWebGL1(),o=i.getQueryObjectEXT(e,i.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),o&&!this.disjoint}},{key:"pollFence",value:function(e){var t=this;return new Promise((function(n){t.addItemToPoll((function(){return e.isFencePassed()}),(function(){return n()}))}))}},{key:"pollItems",value:function(){for(var e=function(e){for(var t=0;t<e.length;++t){if(!e[t]())break}return t-1}(this.itemsToPoll.map((function(e){return e.isDoneFn}))),t=0;t<=e;++t){(0,this.itemsToPoll[t].resolveFn)()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}},{key:"addItemToPoll",value:function(e,t){var n=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||ts((function(){return n.pollItems(),0===n.itemsToPoll.length}))}},{key:"bindTextureToFrameBuffer",value:function(e){this.throwIfDisposed(),YM(this.gl,e,this.framebuffer),this.debug&&$M(this.gl)}},{key:"unbindTextureToFrameBuffer",value:function(){null!=this.outputTexture?(YM(this.gl,this.outputTexture,this.framebuffer),this.debug&&$M(this.gl)):QM(this.gl,this.framebuffer)}},{key:"downloadMatrixDriver",value:function(e,t){this.bindTextureToFrameBuffer(e);var n=t();return this.unbindTextureToFrameBuffer(),n}},{key:"setOutputMatrixTextureDriver",value:function(e,t,n){this.throwIfDisposed();var r=this.gl;YM(r,e,this.framebuffer),this.debug&&$M(r),this.outputTexture=e,LM(r,(function(){return r.viewport(0,0,t,n)})),LM(r,(function(){return r.scissor(0,0,t,n)}))}},{key:"setOutputMatrixWriteRegionDriver",value:function(e,t,n,r){var a=this;this.throwIfDisposed(),LM(this.gl,(function(){return a.gl.scissor(e,t,n,r)}))}},{key:"throwIfDisposed",value:function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}},{key:"throwIfNoProgram",value:function(){if(null==this.program)throw new Error("No GPU program is currently set.")}}]),e}();var MD=fd;function DD(e,t,n,r){var a=[];e.forEach((function(e){var t=Qo(e.shapeInfo.logicalShape);e.shapeInfo.isUniform?a.push("uniform float ".concat(e.name).concat(t>1?"[".concat(t,"]"):"",";")):(a.push("uniform sampler2D ".concat(e.name,";")),a.push("uniform int offset".concat(e.name,";")))}));var i,o,s=a.join("\n"),u=e.map((function(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="";r+=n?OD(e):RD(e);var a=e.shapeInfo.logicalShape,i=t.logicalShape;a.length<=i.length&&(r+=n?qD(e,t):GD(e,t));return r}(e,t,r)})).join("\n"),c=t.texShape,l=hD(),h=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(e.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(l),f=function(e){return"".concat(e.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(e.varyingFs," vec2 resultUV;\n    ").concat(e.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(e.defineSpecialNaN,"\n    ").concat(e.defineSpecialInf,"\n    ").concat(e.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(FD,"\n    ").concat(LD,"\n    ").concat(zD,"\n  ")}(l);return t.isPacked?(i=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(1===n[0])return"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(n[1],".0);\n      }\n    ");if(1===n[1])return"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(n[0],".0);\n      }\n    ");return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n      return 2 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n    }\n  ")}(0,t);case 2:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if($o(e,t))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(n[0],", ").concat(n[1],"));\n      }\n    ");var r=Math.ceil(e[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(e,t);case 3:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[2]/2),a=r*Math.ceil(e[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n\n      int b = index / ").concat(a,";\n      index -= b * ").concat(a,";\n\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(e,t);default:return function(e,t){for(var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[e.length-1]/2),a=r*Math.ceil(e[e.length-2]/2),i=a,o="",s="b, r, c",u=2;u<e.length-1;u++)i*=e[e.length-u-1],o="\n      int b".concat(u," = index / ").concat(i,";\n      index -= b").concat(u," * ").concat(i,";\n    ")+o,s="b".concat(u,", ")+s;return"\n    ivec".concat(e.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(n[0],", ").concat(n[1],"));\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n\n      ").concat(o,"\n\n      int b = index / ").concat(a,";\n      index -= b * ").concat(a,";\n\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec").concat(e.length,"(").concat(s,");\n    }\n  ")}(e,t)}}(t.logicalShape,c),o=function(e){return"\n    void setOutput(vec4 val) {\n      ".concat(e.output," = val;\n    }\n  ")}(l)):(i=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){if(1===t[0])return"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(t[1],".0);\n      }\n    ");if(1===t[1])return"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(t[0],".0);\n      }\n    ");return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      return resTexRC.x * ").concat(t[1]," + resTexRC.y;\n    }\n  ")}(0,t);case 2:return function(e,t){if($o(e,t))return"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(t[0],", ").concat(t[1],"));\n      }\n    ");if(1===e[1])return"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ");if(1===e[0])return"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ");return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      int r = index / ").concat(e[1],";\n      int c = index - r * ").concat(e[1],";\n      return ivec2(r, c);\n    }\n  ")}(e,t);case 3:return function(e,t){var n=fD(["r","c","d"],e);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}(e,t);case 4:return function(e,t){var n=fD(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(n,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(e,t);case 5:return function(e,t){var n=fD(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(t[0],",\n                             ").concat(t[1],"));\n\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(e,t);case 6:return function(e,t){var n=fD(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(e,t);default:throw new Error("".concat(e.length,"-D output sampling is not yet supported"))}}(t.logicalShape,c),o=function(e){return"\n    void setOutput(float val) {\n      ".concat(e.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(l)),r&&(f+=BD),[f,h,o,s,i,u,n].join("\n")}function RD(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"float ".concat(n,"() {return ").concat(t,";}");var r=Ct(e.shapeInfo.texShape,2),a=r[0],i=r[1];if(1===a&&1===i)return"\n      float ".concat(n,"() {\n        return sampleTexture(").concat(t,", halfCR);\n      }\n    ");var o=Ct(e.shapeInfo.texShape,2),s=o[0],u=o[1],c=VD(t);return"\n    float ".concat(n,"() {\n      vec2 uv = uvFromFlat(").concat(s,", ").concat(u,", ").concat(c,");\n      return sampleTexture(").concat(t,", uv);\n    }\n  ")}(e);case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"\n      float ".concat(n,"(int index) {\n        ").concat(jD(e),"\n      }\n    ");var r=e.shapeInfo.texShape,a=r[0],i=r[1];if(1===i&&1===a)return"\n      float ".concat(n,"(int index) {\n        return sampleTexture(").concat(t,", halfCR);\n      }\n    ");var o=VD(t);if(1===i)return"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(o,") + 0.5) / ").concat(a,".0);\n        return sampleTexture(").concat(t,", uv);\n      }\n    ");if(1===a)return"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(o,") + 0.5) / ").concat(i,".0, 0.5);\n        return sampleTexture(").concat(t,", uv);\n      }\n    ");return"\n    float ".concat(n,"(int index) {\n      vec2 uv = uvFromFlat(").concat(a,", ").concat(i,", index + ").concat(o,");\n      return sampleTexture(").concat(t,", uv);\n    }\n  ")}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape;if(null!=a&&$o(t,a)){var i=a[0],o=a[1];return"\n    float ".concat(r,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(o,".0, ").concat(i,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}var s=as(t),u=s.newShape,c=s.keptDims,l=u;if(l.length<t.length){var h=UD(e,l),f=["row","col"];return"\n      ".concat(RD(h),"\n      float ").concat(r,"(int row, int col) {\n        return ").concat(r,"(").concat(HD(f,c),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(t[1],", 1)));\n        ").concat(jD(e),"\n      }\n    ");var p=a[0],d=a[1],m=VD(n);if(1===d)return"\n    float ".concat(r,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(m,"), vec3(").concat(t[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(p,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");if(1===p)return"\n    float ".concat(r,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(m,"), vec3(").concat(t[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(d,".0, 0.5);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");return"\n  float ".concat(r,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(t[1]," + col + ").concat(m,";\n    vec2 uv = uvFromFlat(").concat(p,", ").concat(d,", index);\n    return sampleTexture(").concat(n,", uv);\n  }\n")}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[1]*t[2],i=t[2],o=as(t),s=o.newShape,u=o.keptDims,c=s;if(c.length<t.length){var l=UD(e,c),h=["row","col","depth"];return"\n        ".concat(RD(l),"\n        float ").concat(r,"(int row, int col, int depth) {\n          return ").concat(r,"(").concat(HD(h,u),");\n        }\n      ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(a,", ").concat(i,", 1)));\n        ").concat(jD(e),"\n      }\n    ");var f=e.shapeInfo.texShape,p=f[0],d=f[1],m=e.shapeInfo.flatOffset;if(d===a&&null==m)return"\n        float ".concat(r,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(i,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(d,".0, ").concat(p,".0);\n          return sampleTexture(").concat(n,", uv);\n        }\n      ");if(d===i&&null==m)return"\n    float ".concat(r,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(t[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(d,".0, ").concat(p,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");var v=VD(n);return"\n      float ".concat(r,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(a," + col * ").concat(i," + depth + ").concat(v,";\n        vec2 uv = uvFromFlat(").concat(p,", ").concat(d,", index);\n        return sampleTexture(").concat(n,", uv);\n      }\n  ")}(e);case 4:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[3],i=t[2]*a,o=t[1]*i,s=as(t),u=s.newShape,c=s.keptDims;if(u.length<t.length){var l=UD(e,u),h=["row","col","depth","depth2"];return"\n      ".concat(RD(l),"\n      float ").concat(r,"(int row, int col, int depth, int depth2) {\n        return ").concat(r,"(").concat(HD(h,c),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(o,", ").concat(i,", ").concat(a,", 1)));\n        ").concat(jD(e),"\n      }\n    ");var f=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,d=p[0],m=p[1];if(m===o&&null==f)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(i,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(m,".0, ").concat(d,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(m===a&&null==f)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(t[1]*t[2],", ").concat(t[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(m,".0, ").concat(d,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var v=VD(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(o," + col * ").concat(i," +\n          depth * ").concat(a," + depth2;\n      vec2 uv = uvFromFlat(").concat(d,", ").concat(m,", index + ").concat(v,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);case 5:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[4],i=t[3]*a,o=t[2]*i,s=t[1]*o,u=as(t),c=u.newShape,l=u.keptDims;if(c.length<t.length){var h=UD(e,c),f=["row","col","depth","depth2","depth3"];return"\n      ".concat(RD(h),"\n      float ").concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(r,"(").concat(HD(f,l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(s,", ").concat(o,", ").concat(i,", ").concat(a,")) +\n          depth3;\n        ").concat(jD(e),"\n      }\n    ");var p=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,m=d[0],v=d[1];if(v===s&&null==p)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(o,", ").concat(i,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(v,".0, ").concat(m,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(v===a&&null==p)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3],",\n               ").concat(t[2]*t[3],", ").concat(t[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(v,".0, ").concat(m,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var g=VD(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(s," + col * ").concat(o," + depth * ").concat(i," +\n          depth2 * ").concat(a," + depth3 + ").concat(g,";\n      vec2 uv = uvFromFlat(").concat(m,", ").concat(v,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);case 6:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=as(t),i=a.newShape,o=a.keptDims;if(i.length<t.length){var s=UD(e,i),u=["row","col","depth","depth2","depth3","depth4"];return"\n      ".concat(RD(s),"\n      float ").concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(r,"(").concat(HD(u,o),");\n      }\n    ")}var c=t[5],l=t[4]*c,h=t[3]*l,f=t[2]*h,p=t[1]*f;if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(p,", ").concat(f,", ").concat(h,", ").concat(l,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(c,", 1)));\n        ").concat(jD(e),"\n      }\n    ");var d=e.shapeInfo.flatOffset,m=e.shapeInfo.texShape,v=m[0],g=m[1];if(g===p&&null==d)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(f,", ").concat(h,", ").concat(l,", ").concat(c,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(g,".0, ").concat(v,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(g===c&&null==d)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3]*t[4],",\n               ").concat(t[2]*t[3]*t[4],",\n               ").concat(t[3]*t[4],",\n               ").concat(t[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(g,".0, ").concat(v,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var y=VD(n);return"\n    float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(p," + col * ").concat(f," + depth * ").concat(h," +\n          depth2 * ").concat(l," + depth3 * ").concat(c," + depth4 + ").concat(y,";\n      vec2 uv = uvFromFlat(").concat(v,", ").concat(g,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);default:throw new Error("".concat(t.length,"-D input sampling")+" is not yet supported")}}function OD(e){switch(e.shapeInfo.logicalShape.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=hD();return"\n    vec4 ".concat(n,"() {\n      return ").concat(r.texture2D,"(").concat(t,", halfCR);\n    }\n  ")}(e);case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=e.shapeInfo.texShape,a=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],i=hD();return"\n    vec4 ".concat(n,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(a[0],", ").concat(a[1],", index);\n      return ").concat(i.texture2D,"(").concat(t,", uv);\n    }\n  ")}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=a[0],o=a[1],s=hD();if(null!=a&&$o(t,a))return"\n      vec4 ".concat(r,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(o,".0, ").concat(i,".0);\n\n        return ").concat(s.texture2D,"(").concat(n,", uv);\n      }\n    ");var u=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=Math.ceil(t[1]/2);return"\n    vec4 ".concat(r,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(c,", ").concat(u[0],", ").concat(u[1],", row, col);\n      return ").concat(s.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(1===t[0]){var o=[1,2],s=UD(e,t.slice(1)),u=["b","row","col"];return"\n        ".concat(OD(s),"\n        vec4 ").concat(r,"(int b, int row, int col) {\n          return ").concat(r,"(").concat(HD(u,o),");\n        }\n      ")}var c=i[0],l=i[1],h=Math.ceil(t[2]/2),f=h*Math.ceil(t[1]/2),p=hD();return"\n    vec4 ".concat(r,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(c,", ").concat(l,", ").concat(f,", ").concat(h,", b, row, col);\n      return ").concat(p.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e);default:return function(e){for(var t=e.shapeInfo.logicalShape,n=t.length,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],s=o[0],u=o[1],c=Math.ceil(t[n-1]/2),l=c*Math.ceil(t[n-2]/2),h="int b, int row, int col",f="b * ".concat(l," + (row / 2) * ").concat(c," + (col / 2)"),p=2;p<n-1;p++)h="int b".concat(p,", ")+h,l*=t[n-p-1],f="b".concat(p," * ").concat(l," + ")+f;var d=hD();return"\n    vec4 ".concat(a,"(").concat(h,") {\n      int index = ").concat(f,";\n      int texR = index / ").concat(u,";\n      int texC = index - texR * ").concat(u,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(u,", ").concat(s,");\n      return ").concat(d.texture2D,"(").concat(r,", uv);\n    }\n  ")}(e)}}var FD="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",LD="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",zD="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",BD="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function VD(e){return"offset".concat(e)}function jD(e){var t=e.name,n=Qo(e.shapeInfo.logicalShape);return n<2?"return ".concat(t,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(t,"[i];\n      }\n    }\n  ")}function qD(e,t){var n,r=e.name,a=r.charAt(0).toUpperCase()+r.slice(1),i="get"+a+"AtOutCoords",o=e.shapeInfo.logicalShape.length,s=t.logicalShape.length,u=MD(e.shapeInfo.logicalShape,t.logicalShape),c=WD(s),l=s-o,h=["x","y","z","w","u","v"];n=0===o?"":s<2&&u.length>=1?"coords = 0;":u.map((function(e){return"coords.".concat(h[e+l]," = 0;")})).join("\n");var f="";f=s<2&&o>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords.".concat(h[t+l])})).join(", ");var p="return outputValue;",d=1===Qo(e.shapeInfo.logicalShape),m=1===Qo(t.logicalShape);if(1!==o||d||m){if(d&&!m)p=1===s?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(u.length){var v=o-2,g=o-1;u.indexOf(v)>-1&&u.indexOf(g)>-1?p="return vec4(outputValue.x);":u.indexOf(v)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":u.indexOf(g)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}}else p="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(i,"() {\n      ").concat(c," coords = getOutputCoords();\n      ").concat(n,"\n      vec4 outputValue = get").concat(a,"(").concat(f,");\n      ").concat(p,"\n    }\n  ")}function GD(e,t){var n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=t.texShape,o=e.shapeInfo.texShape,s=e.shapeInfo.logicalShape.length,u=t.logicalShape.length;if(!e.shapeInfo.isUniform&&s===u&&null==e.shapeInfo.flatOffset&&$o(o,i))return"\n      float ".concat(a,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");var c,l=WD(u),h=MD(e.shapeInfo.logicalShape,t.logicalShape),f=u-s,p=["x","y","z","w","u","v"];c=0===s?"":u<2&&h.length>=1?"coords = 0;":h.map((function(e){return"coords.".concat(p[e+f]," = 0;")})).join("\n");var d="";return d=u<2&&s>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords.".concat(p[t+f])})).join(", "),"\n    float ".concat(a,"() {\n      ").concat(l," coords = getOutputCoords();\n      ").concat(c,"\n      return get").concat(r,"(").concat(d,");\n    }\n  ")}function WD(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank ".concat(e," is not yet supported"))}function UD(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function HD(e,t){return t.map((function(t){return e[t]})).join(", ")}function KD(e,t,n,r){var a=t.userCode,i=n.map((function(e,n){var r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}})),o=i.map((function(e){return e.shapeInfo})),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},u=DD(i,s,a,t.packedInputs),c=e.createProgram(u),l=null,h=e.getUniformLocation(c,"NAN",!1);1===Is().getNumber("WEBGL_VERSION")&&(l=e.getUniformLocation(c,"INFINITY",!1));for(var f={},p=0;p<t.variableNames.length;p++){var d=t.variableNames[p];f[d]=e.getUniformLocation(c,d,false),f["offset".concat(d)]=e.getUniformLocation(c,"offset".concat(d),false)}return{program:t,source:u,webGLProgram:c,uniformLocations:f,inShapeInfos:o,outShapeInfo:s,infLoc:l,nanLoc:h}}function XD(e,t){if(e.length!==t.length)throw Error("Binary was compiled with ".concat(e.length," inputs, but ")+"was executed with ".concat(t.length," inputs"));e.forEach((function(e,n){var r=e.logicalShape,a=t[n],i=a.shape;if(!$o(r,i))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(r," and ").concat(i," must match"));if(!e.isUniform||!a.isUniform){var o=e.texShape,s=a.isUniform?null:a.texData.texShape;if(!$o(o,s))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(o," and ").concat(s," must match"))}}))}function YD(e,t,n,r,a){XD(t.inShapeInfos,n),XD([t.outShapeInfo],[r]);var i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(i,o[0],o[1]):e.setOutputMatrixTexture(i,o[0],o[1]),e.setProgram(t.webGLProgram),1===Is().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN),n.forEach((function(n,r){var a=t.program.variableNames[r],i=t.uniformLocations[a],o=t.uniformLocations["offset".concat(a)];if(null!=i)if(n.isUniform)if(Qo(n.shape)<2)e.gl.uniform1f(i,n.uniformValues[0]);else{var s=n.uniformValues;s instanceof Float32Array||(s=new Float32Array(s)),e.gl.uniform1fv(i,s)}else null!=n.texData.slice&&null!=o&&e.gl.uniform1i(o,n.texData.slice.flatOffset),e.setInputMatrixTexture(n.texData.texture,i,r)})),null!=a&&a(e,t.webGLProgram),e.executeProgram()}function QD(e,t,n){var r="";t.concat(n).forEach((function(e){var t=null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0,n=e.isUniform?"uniform":e.texData.texShape;r+="".concat(e.shape,"_").concat(n,"_").concat(t)}));var a=e.userCode,i=e.constructor.name;return i+="_"+r+"_"+a}var $D=IE,JD=kI,ZD=xI,eR=SI,tR=NI,nR=lA,rR=mA,aR=FA,iR=UA,oR=KA,sR=oN,uR=fN,cR=dN,lR=AN,hR=MN,fR=WN,pR=yA,dR=tP,mR=wP,vR=SP,gR=FP,yR=LE,bR=vI,kR=fM,xR=CA,wR=gM,_R=bM,SR=WE,CR=xM;function TR(e,t){return["x","y","z","w","u","v"].slice(0,t).map((function(t){return"".concat(e,".").concat(t)}))}function ER(e,t){return 1===t?[e]:TR(e,t)}var IR=c((function e(t){s(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;var n=t.length;if(0===n)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var r=ER("rc",n),a=WD(n),i=function(e,t,n){if(1===e)return"rc > ".concat(t[0]);for(var r="",a=e-2;a<e;a++)r+="".concat(n[a]," >= ").concat(t[a]),a<e-1&&(r+="||");return r}(n,t,r),o=function(e,t,n,r){if(1===e)return"";var a=r.slice(-2);return"\n    int r = ".concat(a[0],";\n    int c = ").concat(a[1],";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= ").concat(t,";\n    bool rEdge = rp1 >= ").concat(n,";\n  ")}(n,t[t.length-1],t[t.length-2],r),u=function(e,t){var n=e.length,r=function(e,t){for(var n=[],r=0;r<=1;r++)for(var a=0;a<=1;a++){for(var i="".concat(0===r?"r":"rp1",", ").concat(0===a?"c":"cp1"),o=2;o<e;o++)i="".concat(t[t.length-1-o],",")+i;n.push(i)}return n}(n,t);if(1===n)return"getA(rc),\n            rc + 1 >= ".concat(e[0]," ? 0. : getA(rc + 1),\n            0, 0");return"getA(".concat(r[0],"),\n          cEdge ? 0. : getA(").concat(r[1],"),\n          rEdge ? 0. : getA(").concat(r[2],"),\n          rEdge || cEdge ? 0. : getA(").concat(r[3],")")}(t,r);this.userCode="\n        void main() {\n          ".concat(a," rc = getOutputCoords();\n\n          if(").concat(i,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(o,"\n\n            setOutput(vec4(").concat(u,"));\n          }\n        }\n      ")}}));var AR=c((function e(t,n){s(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var r="",a=0;a<4;a++){var i="thisRC = rc;";a%2===1&&(i+="thisRC.z += 1;"),a>1&&(i+="thisRC.y += 1;"),r+="\n        ".concat(i,"\n        ").concat(a>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(a,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(a>0?"}":"","\n      ")}this.userCode="\n      ".concat(function(e){var t=fD(["r","c","d"],e);return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(t,"\n      return ivec3(r, c, d);\n    }\n  ")}(n),"\n      ").concat(pD(t),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(t[1],";\n        int cols = ").concat(t[2],";\n\n        ").concat(r,"\n\n        setOutput(result);\n      }\n    ")}));var NR=function(){function e(t){s(this,e),this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return c(e,[{key:"acquireTexture",value:function(e,t,n){var r=MR(t,n),a=DR(e,r,n);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);var i,o=PR(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();var s=this.freeTextures[a].shift();return this.usedTextures[a].push(s),s}return r===AM.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===AM.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===AM.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===AM.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===AM.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(i),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),i}},{key:"releaseTexture",value:function(e,t,n,r){if(null!=this.freeTextures){var a=MR(n,r),i=DR(t,a,r);i in this.freeTextures||(this.freeTextures[i]=[]);var o=PR(t,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),s=Is().get("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==s&&this._numBytesAllocated>s?(this.gpgpu.deleteMatrixTexture(e),this._numBytesAllocated-=o):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;var u=this.usedTextures[i],c=u.indexOf(e);if(c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u.splice(c,1),this.log()}}},{key:"log",value:function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(e,")"));var t=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*t),"%)"))}}},{key:"numBytesAllocated",get:function(){return this._numBytesAllocated}},{key:"numBytesFree",get:function(){return this._numBytesFree}},{key:"getNumUsedTextures",value:function(){return this.numUsedTextures}},{key:"getNumFreeTextures",value:function(){return this.numFreeTextures}},{key:"dispose",value:function(){var e=this;if(null!=this.freeTextures){for(var t in this.freeTextures)this.freeTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));for(var n in this.usedTextures)this.usedTextures[n].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}]),e}();function PR(e,t,n,r,a){var i,o=function(e,t){switch(e){case AM.PACKED_2X2_FLOAT32:return ID(t);case AM.PACKED_2X2_FLOAT16:return AD(t);case AM.UNPACKED_FLOAT32:return CD(t);case AM.UNPACKED_FLOAT16:return TD(t);case AM.PACKED_4X1_UNSIGNED_BYTE:return ED(t);default:throw new Error("Unknown physical texture type ".concat(e))}}(t,r);if(a){var s=Ct(OM(e[0],e[1]),2);i=s[0]*s[1]}else{var u=Ct(DM(e[0],e[1]),2);i=u[0]*u[1]}var c=function(e,t){var n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;throw new Error("Unknown internal format ".concat(t))}(n,o);return i*c}function MR(e,t){if(e===IM.UPLOAD)return AM.PACKED_2X2_FLOAT32;if(e===IM.RENDER||null==e)return function(e){return Is().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?AM.PACKED_2X2_FLOAT32:AM.UNPACKED_FLOAT32:e?AM.PACKED_2X2_FLOAT16:AM.UNPACKED_FLOAT16}(t);if(e===IM.DOWNLOAD||e===IM.PIXELS)return AM.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(e))}function DR(e,t,n){return"".concat(e[0],"_").concat(e[1],"_").concat(t,"_").concat(n)}var RR=c((function e(t,n){s(this,e),this.variableNames=["A"],this.outputShape=t,this.userCode="\n      float unaryOperation(float x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")})),OR="if (isnan(x)) return x;",FR="return x;",LR="return abs(x);";var zR="return (x >= 0.0) ? x : (exp(x) - 1.0);",BR=OR+"\n  return (x < 0.0) ? 0.0 : x;\n",VR=OR+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",jR="return x;",qR="return x;",GR="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",WR="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",UR="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",HR=c((function e(t,n){s(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")})),KR=c((function e(t){s(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;var n=t.length,r=ER("rc",n),a=WD(n),i=function(e,t){if(1===e)return"rc";for(var n="",r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(n,r),o=r.slice(-2),u=n<=1?"rc":"vec2(".concat(o.join(","),")");this.userCode="\n      void main() {\n        ".concat(a," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(i,");\n\n        setOutput(getChannel(packedInput, ").concat(u,"));\n      }\n    ")})),XR=yg,YR={};var QR=function(e){h(n,e);var t=g(n);function n(e){var r,a;if(s(this,n),(r=t.call(this)).pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.warnedAboutMemory=!1,r.warnedAboutCPUBackend=!1,r.pendingDeletes=0,r.disposed=!1,!Is().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==e){var i=MM(Is().getNumber("WEBGL_VERSION"));r.binaryCache=((a=Is().getNumber("WEBGL_VERSION"))in YR||(YR[a]={}),YR[a]),r.gpgpu=new PD(i),r.canvas=i.canvas,r.gpgpuCreatedLocally=!0}else r.gpgpu=e,r.binaryCache={},r.gpgpuCreatedLocally=!1,r.canvas=e.gl.canvas;return r.textureManager=new NR(r.gpgpu),r.numMBBeforeWarning=null==Is().global.screen?1024:Is().global.screen.height*Is().global.screen.width*window.devicePixelRatio*600/1024/1024,r.texData=new Bo(m(r),dp()),r}return c(n,[{key:"numDataIds",value:function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes}},{key:"write",value:function(e,t,n){if((Is().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Is().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:IM.UPLOAD,refCount:1,complexParentRefCount:0}),r}},{key:"incRef",value:function(e){this.texData.get(e).refCount++}},{key:"decRef",value:function(e){this.texData.has(e)&&this.texData.get(e).refCount--}},{key:"decComplexRef",value:function(e){if(this.texData.has(e)){var t=this.texData.get(e);t.complexParentRefCount>0&&t.refCount--}}},{key:"move",value:function(e,t,n,r){if(Is().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:IM.UPLOAD,refCount:1,complexParentRefCount:0})}},{key:"disposeIntermediateTensorInfo",value:function(e){var t=e.dataId;if(this.texData.has(t)){var n=this.texData.get(t);n.refCount--,n.refCount<1&&this.disposeData(t)}}},{key:"readSync",value:function(e){var t=this.texData.get(e),n=t.values,r=t.dtype,a=t.complexTensorInfos,i=t.slice,o=t.shape,s=t.isPacked;if(null!=i){var u;u=s?new HR(o,jR):new RR(o,jR);var c=this.runWebGLProgram(u,[{dataId:e,shape:o,dtype:r}],r),l=this.readSync(c.dataId);return this.disposeIntermediateTensorInfo(c),l}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;var h,f,p=null!=this.activeTimers;(p&&(h=ql()),"complex64"===r)?f=hg(this.readSync(a.real.dataId),this.readSync(a.imag.dataId)):f=this.getValuesFromTexture(e);return p&&(this.downloadWaitMs+=ql()-h),this.convertAndCacheOnCPU(e,f)}},{key:"read",value:function(){var e=_(x().mark((function e(t){var n,r,a,i,o,s,u,c,l,h,f,p,d,m,v,g,y,b,k,w,_,S;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.pendingRead.has(t)){e.next=3;break}return n=this.pendingRead.get(t),e.abrupt("return",new Promise((function(e){return n.push(e)})));case 3:if(r=this.texData.get(t),a=r.values,i=r.shape,o=r.slice,s=r.dtype,u=r.complexTensorInfos,c=r.isPacked,null==o){e.next=11;break}return l=c?new HR(i,jR):new RR(i,jR),h=this.runWebGLProgram(l,[{dataId:t,shape:i,dtype:s}],s),f=this.read(h.dataId),this.disposeIntermediateTensorInfo(h),e.abrupt("return",f);case 11:if(null==a){e.next=13;break}return e.abrupt("return",this.convertAndCacheOnCPU(t));case 13:if(Is().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")||2!==Is().getNumber("WEBGL_VERSION")){e.next=15;break}throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");case 15:if(p=null,"complex64"!==s&&Is().get("WEBGL_BUFFER_SUPPORTED")&&(d=this.decode(t),v=this.texData.get(d.dataId),p=(m=this.gpgpu).createBufferFromTexture.apply(m,[v.texture].concat(Fn(RM(i))))),this.pendingRead.set(t,[]),"complex64"===s){e.next=21;break}return e.next=21,this.gpgpu.createAndWaitForFence();case 21:if("complex64"!==s){e.next=30;break}return e.next=24,Promise.all([this.read(u.real.dataId),this.read(u.imag.dataId)]);case 24:y=e.sent,b=y[0],k=y[1],g=hg(b,k),e.next=31;break;case 30:null==p?g=this.getValuesFromTexture(t):(w=Qo(i),g=this.gpgpu.downloadFloat32MatrixFromBuffer(p,w));case 31:return null!=d&&this.disposeIntermediateTensorInfo(d),_=this.convertAndCacheOnCPU(t,g),S=this.pendingRead.get(t),this.pendingRead.delete(t),S.forEach((function(e){return e(_)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t),this.pendingDeletes--),e.abrupt("return",_);case 38:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"bufferSync",value:function(e){var t=this.readSync(e.dataId),n=t;if("string"===e.dtype)try{n=t.map((function(e){return Wl(e)}))}catch(r){throw new Error("Failed to decode encoded string bytes into utf-8")}return If(e.shape,e.dtype,n)}},{key:"checkNumericalProblems",value:function(e){if(null!=e)for(var t=0;t<e.length;t++){var n=e[t];if(!zM(n)){if(Is().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value ".concat(n," cannot be represented on this device."))}}}},{key:"getValuesFromTexture",value:function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,a=t.isPacked,i=Qo(n);if(Is().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var o,s=this.decode(e),u=this.texData.get(s.dataId),c=(o=this.gpgpu).downloadMatrixFromPackedTexture.apply(o,[u.texture].concat(Fn(RM(n)))).subarray(0,i);return this.disposeIntermediateTensorInfo(s),c}var l=Is().getBool("WEBGL_PACK")&&!0===a,h=l?nD(n):n,f=l?new yD(h):new gD(h),p=this.runWebGLProgram(f,[{shape:h,dtype:r,dataId:e}],"float32"),d=this.texData.get(p.dataId),m=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(d.texture,d.texShape[0],d.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(p),m}},{key:"time",value:function(){var e=_(x().mark((function e(t){var n,r,a,i,o,s,u;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.activeTimers,r=[],a=!1,null==this.programTimersStack?(this.programTimersStack=r,a=!0):this.activeTimers.push(r),this.activeTimers=r,t(),i=Yo(this.activeTimers.map((function(e){return e.query}))).filter((function(e){return null!=e})),o=Yo(this.activeTimers.map((function(e){return e.name}))).filter((function(e){return null!=e})),this.activeTimers=n,a&&(this.programTimersStack=null),s={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},!(Is().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){e.next=19;break}return e.next=14,Promise.all(i);case 14:u=e.sent,s.kernelMs=Uo(u),s.getExtraProfileInfo=function(){return u.map((function(e,t){return{name:o[t],ms:e}})).map((function(e){return"".concat(e.name,": ").concat(e.ms)})).join(", ")},e.next=20;break;case 19:s.kernelMs={error:"WebGL query timers are not supported in this environment."};case 20:return this.uploadWaitMs=0,this.downloadWaitMs=0,e.abrupt("return",s);case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"memory",value:function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}},{key:"startTimer",value:function(){return Is().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:ql(),endMs:null}}},{key:"endTimer",value:function(e){return Is().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=ql(),e)}},{key:"getQueryTime",value:function(){var e=_(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Is().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){e.next=2;break}return e.abrupt("return",this.gpgpu.waitForQueryAndGetTime(t));case 2:return n=t,e.abrupt("return",n.endMs-n.startMs);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"disposeData",value:function(e){if(!this.pendingDisposal.has(e)){if(this.pendingRead.has(e))return this.pendingDisposal.add(e),void this.pendingDeletes++;if(this.texData.has(e))if(this.texData.get(e).complexParentRefCount>0)this.texData.get(e).refCount--;else{this.releaseGPUData(e);var t=this.texData.get(e).complexTensorInfos;null!=t&&(this.texData.get(t.real.dataId).complexParentRefCount--,this.disposeIntermediateTensorInfo(t.real),this.texData.get(t.imag.dataId).complexParentRefCount--,this.disposeIntermediateTensorInfo(t.imag)),this.texData.delete(e)}}}},{key:"releaseGPUData",value:function(e){var t=this.texData.get(e),n=t.texture,r=t.dtype,a=t.texShape,i=t.usage,o=t.isPacked,s=t.slice,u=s&&s.origDataId||e,c=this.dataRefCount.get(u);c>1?this.dataRefCount.set(u,c-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(a,r),this.textureManager.releaseTexture(n,a,i,o)));var l=this.texData.get(e);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null}},{key:"getTexture",value:function(e){return this.uploadToGPU(e),this.texData.get(e).texture}},{key:"getDataInfo",value:function(e){return this.texData.get(e)}},{key:"getCPUBackend",value:function(){return Is().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=dp().findBackend("cpu")),this.cpuBackend):null}},{key:"shouldExecuteOnCPU",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:128,r=this.getCPUBackend();return Is().getBool("IS_TEST")||this.warnedAboutCPUBackend||null!=r||(console.warn("Your application contains ops that are small enough to be executed on the CPU backend, however the CPU backend cannot be found. Consider importing the CPU backend (@tensorflow/tfjs-backend-cpu) for better performance."),this.warnedAboutCPUBackend=!0),null!=r&&e.every((function(e){return null==t.texData.get(e.dataId).texture&&Qo(e.shape)<n}))}},{key:"getGPGPUContext",value:function(){return this.gpgpu}},{key:"where",value:function(e){lg("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var t=e.dataSync();return XR(e.shape,t)}},{key:"packedUnaryOp",value:function(e,t,n){var r=new HR(e.shape,t);return this.compileAndRun(r,[e],n)}},{key:"abs",value:function(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){var t=yR(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,t)}if(Is().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,LR,e.dtype);var n=new RR(e.shape,LR);return this.compileAndRun(n,[e])}},{key:"makeTensorInfo",value:function(e,t,n){var r;if("string"===t&&null!=n&&n.length>0&&ls(n[0])){var a=n.map((function(e){return Gl(e)}));r=this.write(a,e,t)}else r=this.write(n,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}},{key:"makeOutput",value:function(e,t,n){var r=this.makeTensorInfo(e,t,n).dataId;return dp().makeTensorFromDataId(r,e,t,this)}},{key:"unpackTensor",value:function(e){var t=new KR(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}},{key:"packTensor",value:function(e){var t=new IR(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}},{key:"packedReshape",value:function(e,t){var n=[eD(e.shape)].concat(Fn(tD(e.shape))),r={dtype:e.dtype,shape:n,dataId:e.dataId},a=[eD(t)].concat(Fn(tD(t))),i=new AR(a,n),o=this.runWebGLProgram(i,[r],e.dtype,null,!0);return{dataId:o.dataId,shape:t,dtype:o.dtype}}},{key:"decode",value:function(e){var t,n=this.texData.get(e),r=n.isPacked,a=n.shape,i=n.dtype,o=nD(a);t=r?new vD(o):new mD(o);return{dtype:i,shape:a,dataId:this.runWebGLProgram(t,[{shape:o,dtype:i,dataId:e}],i,null,!0).dataId}}},{key:"runWebGLProgram",value:function(e,t,n,r){var a=this,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=this.makeTensorInfo(e.outputShape,n),s=this.texData.get(o.dataId);if(e.packedOutput&&(s.isPacked=!0),e.outPackingScheme===EM.DENSE){var u=RM(e.outputShape);s.texShape=u.map((function(e){return 2*e}))}if(null!=e.outTexUsage&&(s.usage=e.outTexUsage),0===Qo(o.shape))return s.values=is(o.dtype,0),o;var c=[],l=t.map((function(t){if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=a.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&Qo(t.shape)<=Is().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}else if(!!n.isPacked!==!!e.packedInputs)t=n.isPacked?a.unpackTensor(t):a.packTensor(t),c.push(t),n=a.texData.get(t.dataId);else if(n.isPacked&&!aD(n.shape,t.shape)){var r=t,i=t.shape;t.shape=n.shape,t=a.packedReshape(t,i),c.push(t),n=a.texData.get(t.dataId),r.shape=i}return a.uploadToGPU(t.dataId),{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(o.dataId);var h,f={shape:o.shape,texData:s,isUniform:!1},p=QD(e,l,f),d=this.getAndSaveBinary(p,(function(){return KD(a.gpgpu,e,l,f)})),m=null!=this.activeTimers;if(m&&(h=this.startTimer()),YD(this.gpgpu,d,l,f,r),c.forEach((function(e){return a.disposeIntermediateTensorInfo(e)})),m&&(h=this.endTimer(h),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(h)})),!Is().getBool("WEBGL_LAZILY_UNPACK")&&s.isPacked&&!1===i){var v=this.unpackTensor(o);return this.disposeIntermediateTensorInfo(o),v}return o}},{key:"compileAndRun",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];n=n||t[0].dtype;var i=this.runWebGLProgram(e,t,n,r,a);return dp().makeTensorFromDataId(i.dataId,i.shape,i.dtype)}},{key:"getAndSaveBinary",value:function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}},{key:"getTextureManager",value:function(){return this.textureManager}},{key:"dispose",value:function(){var e=this;if(!this.disposed){if(!Is().getBool("IS_TEST"))Object.keys(this.binaryCache).forEach((function(t){e.gpgpu.deleteProgram(e.binaryCache[t].webGLProgram),delete e.binaryCache[t]}));this.textureManager.dispose(),null!=this.canvas&&"undefined"!==typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}},{key:"floatPrecision",value:function(){var e=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=vp((function(){if(!Is().get("WEBGL_RENDER_FLOAT32_ENABLED")){var t=Is().getBool("DEBUG");Is().set("DEBUG",!1);var n=e.abs(xp(1e-8)).dataSync()[0];if(Is().set("DEBUG",t),n>0)return 32}return 16}))),this.floatPrecisionValue}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"uploadToGPU",value:function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,a=t.values,i=t.texture,o=t.usage,s=t.isPacked;if(null==i){var u,c=null!=this.activeTimers;c&&(u=ql());var l=t.texShape;if(null==l&&(l=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Is().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(n*=2,1===(e=e.map((function(t,n){return n>=e.length-2?Wo(e[n]):e[n]}))).length&&(e=[2,e[0]])),2!==e.length){var r=as(e);e=r.newShape}var a=Qo(e);if(e.length<=1&&a<=n)return[1,a];if(2===e.length&&e[0]<=n&&e[1]<=n)return e;if(3===e.length&&e[0]*e[1]<=n&&e[2]<=n)return[e[0]*e[1],e[2]];if(3===e.length&&e[0]<=n&&e[1]*e[2]<=n)return[e[0],e[1]*e[2]];if(4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n)return[e[0]*e[1]*e[2],e[3]];if(4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n)return[e[0],e[1]*e[2]*e[3]];if(t){var i=eD(e),o=2,s=2;if(e.length){var u=Ct(tD(e),2);o=u[0],s=u[1]}return Zo(a=i*(o/2)*(s/2)).map((function(e){return 2*e}))}return Zo(a)}(n,s),t.texShape=l),null!=a){var h,f=nD(n),p=l[1],d=l[0],m=a instanceof Uint8Array;if(s){var v=Ct(OM(l[0],l[1]),2);p=v[0],d=v[1],h=new kD(f,[d,p],m)}else h=new bD(f,[d,p],m);var g=this.makeTensorInfo([d,p],r);this.texData.get(g.dataId).usage=m?IM.PIXELS:IM.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(g.dataId),p,d,a);var y=this.runWebGLProgram(h,[g],r,null,!0),b=this.texData.get(y.dataId);t.texture=b.texture,t.texShape=b.texShape,t.isPacked=b.isPacked,t.usage=b.usage,this.disposeIntermediateTensorInfo(g),this.texData.delete(y.dataId),t.values=null,c&&(this.uploadWaitMs+=ql()-u)}else{var k=this.acquireTexture(l,o,r,s);t.texture=k}}}},{key:"convertAndCacheOnCPU",value:function(e,t){var n=this.texData.get(e),r=n.dtype;return this.releaseGPUData(e),null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){for(var n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length),r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}throw new Error("Unknown dtype ".concat(t))}(t,r)),n.values}},{key:"acquireTexture",value:function(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(a," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,r)}},{key:"computeBytes",value:function(e,t){return e[0]*e[1]*cs(t)}}]),n}(Vo);mh()&&bp("webgl",(function(){return new QR}),2);var $R=c((function e(t,n,r){s(this,e),this.variableNames=["A","B"],this.outputShape=dd(n,r),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")})),JR=c((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];s(this,e),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=dd(n,r);var i=this.outputShape.length,o="";if(a)if(0===i||1===Qo(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{var u=WD(i);if(o="\n          ".concat(u," coords = getOutputCoords();\n        "),1===i)o+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{var c=ER("coords",i);o+="\n            bool nextRowOutOfBounds =\n              (".concat(c[i-2]," + 1) >= ").concat(this.outputShape[i-2],";\n            bool nextColOutOfBounds =\n              (").concat(c[i-1]," + 1) >= ").concat(this.outputShape[i-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(o,"\n\n        setOutput(result);\n      }\n    ")}));function ZR(e){var t=e.inputs,n=e.backend,r=t.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var eO={kernelName:Gu,backendName:"webgl",kernelFunc:ZR};function tO(e){var t=e.inputs,n=e.backend,r=t.real,a=t.imag,i=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(i.dataId),s=ZR({inputs:{x:r},backend:n});n.texData.get(s.dataId).complexParentRefCount++;var u=ZR({inputs:{x:a},backend:n});return n.texData.get(u.dataId).complexParentRefCount++,o.complexTensorInfos={real:s,imag:u},i}var nO={kernelName:ru,backendName:"webgl",kernelFunc:tO},rO="return (a < 0.) ? b * a : a;",aO="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";var iO={kernelName:Yu,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.alpha,o=n.makeTensorInfo([],"float32",Vl(i,"float32")),s=Is().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new JR(aO,a.shape,o.shape):new $R(rO,a.shape,o.shape),u=n.runWebGLProgram(s,[a,o],a.dtype);return n.disposeIntermediateTensorInfo(o),u}},oO="return (a < 0.) ? b * a : a;",sO="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";var uO={kernelName:Nc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=t.alpha,i=Is().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new JR(sO,r.shape,a.shape):new $R(oO,r.shape,a.shape);return n.runWebGLProgram(i,[r,a],r.dtype)}};function cO(e){var t=e.opSnippet,n=e.packedOpSnippet,r=e.cpuKernelImpl,a=e.dtype;return function(e){var i,o=e.inputs,s=e.backend,u=o.x,c=s,l=a||u.dtype;if(c.shouldExecuteOnCPU([u])&&null!=r){var h=c.texData.get(u.dataId),f=r(h.values,l);return c.makeTensorInfo(u.shape,l,f)}return i=Is().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new HR(u.shape,n):new RR(u.shape,t),c.runWebGLProgram(i,[u],l)}}function lO(e){var t=e.opSnippet,n=e.packedOpSnippet,r=e.checkOutOfBounds,a=void 0!==r&&r,i=e.supportsComplex,o=void 0!==i&&i,s=e.cpuKernelImpl,u=e.dtype;return function(e){var r=e.inputs,i=e.backend,c=r.a,l=r.b,h=i;if(o&&"complex64"===c.dtype){var f=h.texData.get(c.dataId),p=h.texData.get(l.dataId),d=[[f.complexTensorInfos.real,p.complexTensorInfos.real],[f.complexTensorInfos.imag,p.complexTensorInfos.imag]].map((function(e){var n=Ct(e,2),r=n[0],a=n[1],i={dataId:r.dataId,dtype:r.dtype,shape:c.shape},o={dataId:a.dataId,dtype:a.dtype,shape:l.shape},s=new $R(t,c.shape,l.shape);return h.runWebGLProgram(s,[i,o],nh(r.dtype,a.dtype))})),m=Ct(d,2),v=m[0],g=m[1],y=tO({inputs:{real:v,imag:g},backend:h});return h.disposeIntermediateTensorInfo(v),h.disposeIntermediateTensorInfo(g),y}var b,k=u||nh(c.dtype,l.dtype);if(h.shouldExecuteOnCPU([c,l])&&null!=s){var x=h.texData.get(c.dataId),w=h.texData.get(l.dataId),_=Ct(s(c.shape,l.shape,x.values,w.values,k),2),S=_[0],C=_[1],T=h.makeTensorInfo(C,k);return h.texData.get(T.dataId).values=S,T}return b=Is().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new JR(n,c.shape,l.shape,a):new $R(t,c.shape,l.shape),h.runWebGLProgram(b,[c,l],k)}}function hO(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===e)return t?qR:FR;if("relu"===e)return t?WR:BR;if("elu"===e)return t?GR:zR;if("relu6"===e)return t?UR:VR;if("prelu"===e)return t?sO:oO;if("leakyrelu"===e)return t?aO:rO;throw new Error("Activation ".concat(e," has not been implemented for the WebGL backend."))}var fO=c((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,c=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]&&arguments[8];s(this,e),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r;var h=a?t[1]:t[2],f=Math.ceil(h/2),p=a?"i * 2, rc.y":"rc.y, i * 2",d=i?"rc.z, i * 2":"i * 2, rc.z",m=a?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],v=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],g="",y="";u&&(g=c?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(u,"\n        }"):l?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(u,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(u,"\n        }"),y="result = activation(result);");var b=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),c&&this.variableNames.push("preluActivationWeights"),l&&this.variableNames.push("leakyreluAlpha");var k="rc.x",x="rc.x";t[0]<n[0]?k="int(min(float(rc.x), ".concat(t[0]-1,".))"):n[0]<t[0]&&(x="int(min(float(rc.x), ".concat(n[0]-1,".))")),this.userCode="\n      ".concat(g,"\n\n      const float sharedDimension = ").concat(f,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < ").concat(f,"; i++) {\n          int batchA = ").concat(k,";\n          int batchB = ").concat(x,";\n          vec4 a = getMatrixA(batchA, ").concat(p,");\n          vec4 b = getMatrixB(batchB, ").concat(d,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(m[0]," * ").concat(v[0],");\n          result += (").concat(m[1]," * ").concat(v[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(b,"\n\n        ").concat(y,"\n\n        setOutput(result);\n      }\n    ")})),pO="return areal * breal - aimag * bimag;",dO="return areal * bimag + aimag * breal;",mO=c((function e(t,n,r){s(this,e),this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=dd(n,r),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")})),vO="return a * b;";function gO(e){var t,n=e.inputs,r=e.backend,a=n.a,i=n.b,o=nh(a.dtype,i.dtype);if("complex64"===a.dtype){var s=r.texData.get(a.dataId),u=r.texData.get(i.dataId),c=new mO(pO,a.shape,i.shape),l=new mO(dO,a.shape,i.shape),h=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:a.shape},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:a.shape},{dataId:u.complexTensorInfos.real.dataId,dtype:u.complexTensorInfos.real.dtype,shape:i.shape},{dataId:u.complexTensorInfos.imag.dataId,dtype:u.complexTensorInfos.imag.dtype,shape:i.shape}],f=r.runWebGLProgram(c,h,"float32"),p=r.runWebGLProgram(l,h,"float32"),d=tO({inputs:{real:f,imag:p},backend:r});return r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(p),d}if(r.shouldExecuteOnCPU([a,i])){var m=r.texData.get(a.dataId),v=r.texData.get(i.dataId),g=Ct(pR(a.shape,i.shape,m.values,v.values,o),2),y=g[0],b=g[1],k=r.makeTensorInfo(b,o);return r.texData.get(k.dataId).values=y,k}return t=Is().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new JR(vO,a.shape,i.shape):new $R(vO,a.shape,i.shape),r.runWebGLProgram(t,[a,i],o)}var yO={kernelName:bc,backendName:"webgl",kernelFunc:gO};function bO(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.shape,o=n,s=Qo(a.shape),u=ns(i,s),c=Qo(u);Ho(s===c,(function(){return"The new shape (".concat(u,") has ").concat(c," elements and the old ")+"shape (".concat(a.shape,") has ").concat(s," elements. The new shape and old ")+"shape must have the same number of elements."}));var l=o.texData.get(a.dataId);return!l.isPacked||aD(a.shape,u)||null!==l.texture&&aD(l.shape,u)?(o.incRef(a.dataId),{dataId:a.dataId,shape:u,dtype:a.dtype}):function(e,t,n){var r=[eD(e.shape)].concat(Fn(tD(e.shape))),a={dtype:e.dtype,shape:r,dataId:e.dataId},i=[eD(t)].concat(Fn(tD(t))),o=new AR(i,r),s=n.runWebGLProgram(o,[a],e.dtype,null,!0);return{dataId:s.dataId,shape:t,dtype:s.dtype}}(a,u,o)}var kO={kernelName:Fc,backendName:"webgl",kernelFunc:bO},xO=c((function e(t,n){s(this,e),this.variableNames=["x"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.outSize;this.outputShape=[a,o];var u=4*Math.floor(r/4),c=r%4,l="sumValue += dot(values, ones);";if(null!=n){var h=1/n;l="sumValue += dot(values * ".concat(Jo(h)?h.toPrecision(2):h,", ones);")}var f="";i%r>0&&(f="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(f,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(u,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(u,";\n        if (").concat(1===c,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(2===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(3===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(l,"\n        }\n        setOutput(sumValue);\n      }\n    ")})),wO=c((function e(t,n){s(this,e),this.variableNames=["x"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.outSize;this.outputShape=[a,o];var u="0.0",c="";"prod"===n?u="1.0":"min"===n?(u="1.0 / 1e-20",c="min"):"max"===n&&(u="-1.0 / 1e-20",c="max");var l="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===n?l="sumValue":"prod"===n?l="prodValue":"all"===n?l="allValue":"any"===n&&(l="anyValue");var h=4*Math.floor(r/4),f=r%4,p="\n      if (".concat("sum"===n,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===n,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(c,"(values, minMaxValue);\n      }\n    "),d="vec4";"all"===n?(u="1.0",p="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",d="bvec4"):"any"===n&&(u="0.0",p="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",d="bvec4");var m="";i%r>0&&(m="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(u,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(m,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        vec4 minMaxValue = vec4(").concat(u,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(h,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(p,"\n        }\n\n        int inIdx = inOffset + ").concat(h,";\n        if (").concat(1===f,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(p,"\n        } else if (").concat(2===f,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(p,"\n        } else if (").concat(3===f,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(p,"\n        }\n        setOutput(").concat(l,");\n      }\n    ")}));function _O(e,t,n,r){for(var a=function(e){for(var t=[];0===t.length||1!==t[t.length-1].outSize;){var n=t.length?t[t.length-1].outSize:e[1],r=Kv(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}(e.shape),i=e,o=0;o<a.length;o++){var s,u=a[o],c=u.inSize,l=u.windowSize,h=u.outSize,f=void 0;f="mean"===n?0===o?new xO({windowSize:l,inSize:c,batchSize:e.shape[0],outSize:h},c):new xO({windowSize:l,inSize:c,batchSize:e.shape[0],outSize:h}):new wO({windowSize:l,inSize:c,batchSize:e.shape[0],outSize:h},n),s=i,i=r.runWebGLProgram(f,[i],t),s.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(s)}return i}var SO=c((function e(t,n){s(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];this.outputShape=r,this.rank=r.length;var i=WD(this.rank),o=function(e){var t=e.length;if(t>6)throw Error("Transpose for rank ".concat(t," is not yet supported"));for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t),a=0;a<e.length;a++)r[e[a]]=n[a];return r.join()}(n);this.userCode="\n    void main() {\n      ".concat(i," resRC = getOutputCoords();\n      setOutput(getA(").concat(o,"));\n    }\n    ")}));var CO=c((function e(t,n){s(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));for(var i=WD(this.rank),o=TR("rc",this.rank),u=new Array(this.rank),c=0;c<n.length;c++)u[n[c]]=o[c];var l="vec2(".concat(u.slice(-2).join(),")"),h="++".concat(o[this.rank-1]," < ").concat(r[this.rank-1]),f="getChannel(getA(".concat(u.join(),"), ").concat(l,")");this.userCode="\n    void main() {\n      ".concat(i," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(f,";\n      if(").concat(h,") {\n        result[1] = ").concat(f,";\n      }\n      --").concat(o[this.rank-1],";\n      if(++").concat(o[this.rank-2]," < ").concat(r[this.rank-2],") {\n        result[2] = ").concat(f,";\n        if(").concat(h,") {\n          result[3] = ").concat(f,";\n        }\n      }\n      setOutput(result);\n    }\n    ")}));function TO(e,t,n){var r=Is().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new CO(e.shape,t):new SO(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}function EO(e){var t=e.inputs,n=e.backend,r=e.attrs;return function(e,t,n,r){var a=t,i=e.shape.length,o=rs(a,e.shape),s=o,u=Wd(s,i),c=null!=u,l=e;c&&(l=TO(e,u,r),s=Hd(s.length,i)),Gd("sum",s,i);var h=Ct(jd(l.shape,s),2),f=h[0],p=h[1],d=f;n&&(d=qd(f,o));var m=Qo(p),v=bO({inputs:{x:l},attrs:{shape:[Qo(e.shape)/m,m]},backend:r}),g=_O(v,rh(e.dtype),"sum",r),y=bO({inputs:{x:g},attrs:{shape:d},backend:r});return r.disposeIntermediateTensorInfo(v),r.disposeIntermediateTensorInfo(g),c&&r.disposeIntermediateTensorInfo(l),y}(t.x,r.axis,r.keepDims,n)}var IO={kernelName:tl,backendName:"webgl",kernelFunc:EO};function AO(e){for(var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.perm,s=r,u=i.shape.length,c=new Array(u),l=0;l<c.length;l++)c[l]=i.shape[o[l]];if(s.shouldExecuteOnCPU([i])){var h=s.texData.get(i.dataId).values,f=SR(h,i.shape,i.dtype,o,c);t=s.makeTensorInfo(c,i.dtype),s.texData.get(t.dataId).values=f}else t=TO(i,o,s);return t}var NO={kernelName:dl,backendName:"webgl",kernelFunc:AO};function PO(e){var t=e.a,n=e.b,r=e.transposeA,a=e.transposeB,i=e.backend,o=e.bias,s=void 0===o?null:o,u=e.preluActivationWeights,c=void 0===u?null:u,l=e.leakyreluAlpha,h=void 0===l?0:l,f=e.activation,p=void 0===f?null:f,d=t.shape.length,m=n.shape.length,v=r?t.shape[d-2]:t.shape[d-1],g=a?n.shape[m-1]:n.shape[m-2],y=r?t.shape[d-1]:t.shape[d-2],b=a?n.shape[m-2]:n.shape[m-1],k=t.shape.slice(0,-2),x=n.shape.slice(0,-2),w=Qo(k),_=Qo(x);Ho(d>=2&&m>=2&&(w===_||1===w||1===_),(function(){return"Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input "+"batch dimensions of (".concat(k,") and (").concat(x,").")}));var S=(w>_?t.shape.slice(0,-2):n.shape.slice(0,-2)).concat([y,b]);Ho(v===g,(function(){return"Error in matMul: inner shapes (".concat(v,") and (")+"".concat(g,") of Tensors with shapes ").concat(t.shape," and ")+"".concat(n.shape," and transposeA=").concat(r)+" and transposeB=".concat(a," must match.")}));var C,T=r?[w,v,y]:[w,y,v],E=a?[_,b,g]:[_,g,b],I=bO({inputs:{x:t},backend:i,attrs:{shape:T}}),A=bO({inputs:{x:n},backend:i,attrs:{shape:E}}),N=[I,A],P=Math.max(w,_),M=r?I.shape[1]:I.shape[2],D=null!=s,R=null!=c,O="leakyrelu"===p,F=null!=p?hO(p,!0):null;if((1===y||1===b)&&M>1e3&&!1===(D||R||O||null!=F)){var L=I,z=A;r&&(L=AO({inputs:{x:I},backend:i,attrs:{perm:[0,2,1]}}),N.push(L)),a&&(z=AO({inputs:{x:A},backend:i,attrs:{perm:[0,2,1]}}),N.push(z));var B=1===b,V=L;1!==b&&(V=bO({inputs:{x:L},backend:i,attrs:{shape:[P,M,1]}}),N.push(V));var j=1===b?2:1,q=z;B&&(q=bO({inputs:{x:z},backend:i,attrs:{shape:[P,1,M]}}),N.push(q));var G=gO({inputs:{a:V,b:q},backend:i});C=EO({inputs:{x:G},backend:i,attrs:{axis:j,keepDims:!0}}),N.push(G)}else{var W=nh(t.dtype,n.dtype),U=new fO(T,E,[P,y,b],r,a,D,F,R,O),H=[I,A];if(null!=s&&H.push(s),R&&H.push(c),O){var K=i.makeTensorInfo([],"float32",Vl(h,"float32"));H.push(K),N.push(K)}C=i.runWebGLProgram(U,H,W)}var X=bO({inputs:{x:C},backend:i,attrs:{shape:S}});N.push(C);for(var Y=0,Q=N;Y<Q.length;Y++){var $=Q[Y];i.disposeIntermediateTensorInfo($)}return X}var MO={kernelName:xl,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.a,i=t.b,o=t.bias,s=t.preluActivationWeights,u=r.transposeA,c=r.transposeB,l=r.activation;return PO({a:a,b:i,transposeA:u,transposeB:c,backend:n,bias:o,preluActivationWeights:s,leakyreluAlpha:r.leakyreluAlpha,activation:l})}},DO="return abs(x);";var RO={kernelName:Ds,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=n.x;if(r.shouldExecuteOnCPU([a])&&"complex64"!==a.dtype){var i=r.texData.get(a.dataId),o=yR(i.values);return r.makeTensorInfo(a.shape,a.dtype,o)}return t=Is().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new HR(a.shape,DO):new RR(a.shape,DO),r.runWebGLProgram(t,[a],a.dtype)}},OO=cO({opSnippet:"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),FO={kernelName:Rs,backendName:"webgl",kernelFunc:OO},LO=cO({opSnippet:"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),zO={kernelName:Os,backendName:"webgl",kernelFunc:LO},BO="return a + b;",VO=lO({opSnippet:BO,packedOpSnippet:BO,supportsComplex:!0,cpuKernelImpl:$D}),jO={kernelName:Fs,backendName:"webgl",kernelFunc:VO},qO=c((function e(t,n){s(this,e),this.outputShape=[],this.outputShape=t,this.variableNames=n.map((function(e,t){return"T".concat(t)}));var r=[];this.variableNames.forEach((function(e){r.push("float v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        float result = ").concat(a,";\n        setOutput(result);\n      }\n    ")})),GO=c((function e(t,n){s(this,e),this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=n.map((function(e,t){return"T".concat(t)}));var r=[];this.variableNames.forEach((function(e){r.push("vec4 v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        vec4 result = ").concat(a,";\n        setOutput(result);\n      }\n    ")}));var WO={kernelName:Ls,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n;if(1===a.length)return ZR({inputs:{x:a[0]},backend:r});if(a.length>Is().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var i=Math.floor(a.length/2),o=e({inputs:a.slice(0,i),backend:r}),s=e({inputs:a.slice(i),backend:r});return e({inputs:[o,s],backend:r})}var u=a.map((function(e){return e.dtype})).reduce((function(e,t){return nh(e,t)})),c=a.map((function(e){return e.shape})),l=Is().getBool("WEBGL_PACK")?new GO(a[0].shape,c):new qO(a[0].shape,c);return r.runWebGLProgram(l,a,u)}};var UO={kernelName:zs,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,s=a.shape.length,u=rs(i,a.shape),c=u,l=Wd(c,s),h=a;null!=l&&(h=AO({inputs:{x:a},backend:n,attrs:{perm:l}}),c=Hd(c.length,s)),Gd("all",c,s);var f,p=Ct(jd(h.shape,c),2),d=p[0],m=bO({inputs:{x:h},backend:n,attrs:{shape:[-1,Qo(p[1])]}}),v=_O(m,m.dtype,"all",n);return f=bO(o?{inputs:{x:v},backend:n,attrs:{shape:qd(d,u)}}:{inputs:{x:v},backend:n,attrs:{shape:d}}),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),null!=l&&n.disposeIntermediateTensorInfo(h),f}};var HO={kernelName:Bs,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,s=a.shape.length,u=rs(i,a.shape),c=u,l=Wd(c,s),h=a;null!=l&&(h=AO({inputs:{x:a},backend:n,attrs:{perm:l}}),c=Hd(c.length,s)),Gd("any",c,s);var f,p=Ct(jd(h.shape,c),2),d=p[0],m=bO({inputs:{x:h},backend:n,attrs:{shape:[-1,Qo(p[1])]}}),v=_O(m,m.dtype,"any",n);return f=bO(o?{inputs:{x:v},backend:n,attrs:{shape:qd(d,u)}}:{inputs:{x:v},backend:n,attrs:{shape:d}}),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),null!=l&&n.disposeIntermediateTensorInfo(h),f}},KO=c((function e(t,n,r){s(this,e),this.variableNames=["A"];var a=t.windowSize,i=t.batchSize,o=t.outSize;r||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];var u="max"===n?">":"<",c=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(a,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          int inIdx = ").concat(c,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(u," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")})),XO=c((function e(t,n,r,a){s(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,Ho(t.length>2,(function(){return"Packed arg".concat(r.charAt(0).toUpperCase()+r.slice(1)," supports only inputs with rank above 2.")}));var i=t[t.length-1],o=Math.ceil(i/n);this.outputShape=t.slice(0,-1),o>1&&this.outputShape.push(o),a||this.variableNames.push("bestIndicesA");var u,c,l=this.outputShape,h=l.length,f=WD(h),p=ER("coords",h);if(1===o){var d=WD(c=h+1);u="\n        ".concat(d," sourceLocR = ").concat(d,"(").concat(p.join(),", 0);\n        ++").concat(p[h-1],";\n        ").concat(d," sourceLocG = ").concat(d,"(").concat(p.join(),", 0);\n        ++").concat(p[h-2],";\n        ").concat(d," sourceLocA = ").concat(d,"(").concat(p.join(),", 0);\n        --").concat(p[h-1],";\n        ").concat(d," sourceLocB = ").concat(d,"(").concat(p.join(),", 0);\n        --").concat(p[h-2],";")}else c=h,u="\n        ".concat(f," sourceLocR = coords;\n        ++").concat(p[h-1],";\n        ").concat(f," sourceLocG = coords;\n        ++").concat(p[h-2],";\n        ").concat(f," sourceLocA = coords;\n        --").concat(p[h-1],";\n        ").concat(f," sourceLocB = coords;\n        --").concat(p[h-2],";");var m=["x","y","z","w","u","v"].slice(0,c),v="."+m[c-1],g=m.map((function(e){return"int "+e})),y=ER("sourceLocR",c-1).concat("inIdx.r"),b=ER("sourceLocG",c-1).concat("inIdx.g"),k=ER("sourceLocB",c-1).concat("inIdx.b"),x=ER("sourceLocA",c-1).concat("inIdx.a"),w="max"===r?"greaterThan":"lessThan",_=a?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(y.join(),"),\n                             getBestIndicesAChannel(").concat(b.join(),"),\n                             getBestIndicesAChannel(").concat(k.join(),"),\n                             getBestIndicesAChannel(").concat(x.join(),")));"),S="vec4(\n            getAChannel(".concat(y.join(),"),\n            hasNextCol ? getAChannel(").concat(b.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(k.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(x.join(),") : 0.)"),C=a?"":"\n      float getBestIndicesAChannel(".concat(g.join(),") {\n        return getChannel(getBestIndicesA(").concat(m.join(),"),\n                                          vec2(").concat(m.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(g.join(),") {\n        return getChannel(getA(").concat(m.join(),"),\n                               vec2(").concat(m.slice(-2).join(),"));\n      }\n      ").concat(C,"\n      void main() {\n        ").concat(f," coords = getOutputCoords();\n        bool hasNextCol = ").concat(p[h-1]," < ").concat(l[h-1]-1,";\n        bool hasNextRow = ").concat(p[h-2]," < ").concat(l[h-2]-1,";\n        ").concat(u,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(v,", sourceLocG").concat(v,",\n          sourceLocB").concat(v,", sourceLocA").concat(v,") * ").concat(n,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(S,";\n\n        for (int i = 0; i < ").concat(n,"; i++) {\n          inIdx = srcIdx;\n          ").concat(_,"\n          vec4 candidate = ").concat(S,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(w,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")}));function YO(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=t.shape[0],i=t.shape[1];null!=r&&(a=r.shape[0],i=r.shape[1]);var o=Kv(i),s={windowSize:o,inSize:i,batchSize:a,outSize:Math.ceil(i/o)},u=new KO(s,n,null==r),c=[t];null!=r&&c.push(r);var l=e.runWebGLProgram(u,c,"int32");if(1===l.shape[1])return l;var h=YO(e,t,n,l);return e.disposeIntermediateTensorInfo(l),h}function QO(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=null!=r?r.shape:t.shape,i=a[a.length-1],o=Kv(i),s=new XO(a,o,n,null==r),u=null==r?[t]:[t,r],c=e.runWebGLProgram(s,u,"int32");if(c.shape.length===t.shape.length){var l=QO(e,t,n,c);return e.disposeIntermediateTensorInfo(c),l}return c}function $O(e,t,n,r){var a=[n];if(Gd("arg"+r.charAt(0).toUpperCase()+r.slice(1),a,t.shape.length),!Is().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){var i=[],o=Ct(jd(t.shape,a),2),s=o[0],u=Qo(o[1]),c=bO({inputs:{x:t},backend:e,attrs:{shape:[-1,u]}});i.push(c);var l=YO(e,c,r);i.push(l);var h=bO({inputs:{x:l},backend:e,attrs:{shape:s}});return i.forEach((function(t){return e.disposeIntermediateTensorInfo(t)})),h}return QO(e,t,r)}var JO={kernelName:Vs,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=rs(r.axis,a.shape),o=Wd(i,a.shape.length),s=a,u=[];null!=o&&(s=AO({inputs:{x:a},backend:n,attrs:{perm:o}}),u.push(s),i=Hd(i.length,s.shape.length)),Gd("argMax",[i[0]],s.shape.length);var c=$O(n,s,i[0],"max");return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),c}};var ZO={kernelName:js,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=rs(r.axis,a.shape),o=Wd(i,a.shape.length),s=a,u=[];null!=o&&(s=AO({inputs:{x:a},backend:n,attrs:{perm:o}}),u.push(s),i=Hd(i.length,s.shape.length)),Gd("argMin",[i[0]],s.shape.length);var c=$O(n,s,i[0],"min");return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),c}},eF=cO({opSnippet:"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),tF={kernelName:qs,backendName:"webgl",kernelFunc:eF},nF=cO({opSnippet:"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));"}),rF={kernelName:Gs,backendName:"webgl",kernelFunc:nF},aF=cO({opSnippet:"if (isnan(x)) return x;\n  return atan(x);\n"}),iF={kernelName:Ws,backendName:"webgl",kernelFunc:aF},oF=lO({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),sF={kernelName:Hs,backendName:"webgl",kernelFunc:oF},uF=cO({opSnippet:"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),cF={kernelName:Us,backendName:"webgl",kernelFunc:uF},lF=c((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(s(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=t.filterWidth,u=t.strideHeight,c=t.strideWidth,l=t.dilationHeight,h=t.dilationWidth,f=t.effectiveFilterHeight,p=t.effectiveFilterWidth,d=t.padInfo.top,m=t.padInfo.left;this.outputShape=t.outShape;var v="avg"===n,g="((batch  * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),y="(xR * ".concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),b="0.0";if(v||(b="-1.0 / 1e-20"),r){var k=">=";this.userCode="\n        const ivec2 strides = ivec2(".concat(u,", ").concat(c,");\n        const ivec2 pads = ivec2(").concat(d,", ").concat(m,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(f,";\n              wR += ").concat(l,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(p,";\n                wC += ").concat(h,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(k," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(a?i?g:y:"wR * ".concat(p," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ")}else{var x="max",w="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(w="avgValue / count");var _=4*Math.floor(o/4),S=o%4,C="\n      if (".concat(v,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat(x,"(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(u,", ").concat(c,");\n      const ivec2 pads = ivec2(").concat(d,", ").concat(m,");\n      const float initializationValue = ").concat(b,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(b,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(f,";\n            wR += ").concat(l,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(_,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(h,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(h,", d),\n              getValue(batch, xR, xC + 2 * ").concat(h,", d),\n              getValue(batch, xR, xC + 3 * ").concat(h,", d)\n            );\n\n            ").concat(C,"\n          }\n\n          int xC = xCCorner + ").concat(_,";\n          if (").concat(1===S,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(C,"\n          } else if (").concat(2===S,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(h,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(C,"\n          } else if (").concat(3===S,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(h,", d),\n              getValue(batch, xR, xC + 2 * ").concat(h,", d),\n              initializationValue\n            );\n\n            ").concat(C,"\n          }\n        }\n        setOutput(").concat(w,");\n      }\n    ")}})),hF=c((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(s(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=t.filterWidth,u=t.strideDepth,c=t.strideHeight,l=t.strideWidth,h=t.dilationDepth,f=t.dilationHeight,p=t.dilationWidth,d=t.effectiveFilterDepth,m=t.effectiveFilterHeight,v=t.effectiveFilterWidth,g=t.padInfo.front,y=t.padInfo.top,b=t.padInfo.left;this.outputShape=t.outShape;var k="avg"===n,x="0.0";if(k||(x="-1.0 / 1e-20"),r){var w=">=";this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(u,", ").concat(c,", ").concat(l,");\n        const ivec3 pads = ivec3(").concat(g,", ").concat(y,", ").concat(b,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(d,";\n              wD += ").concat(h,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(m,";\n                wR += ").concat(f,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(v,";\n                  wC += ").concat(p,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(w," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(a?i?"(((batch * ".concat(t.inDepth," + xD) * ").concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"((xD * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"wD * ".concat(m," * ").concat(v," +\n                      wR * ").concat(v," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ")}else{var _="max",S="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(S="avgValue / count");var C=4*Math.floor(o/4),T=o%4,E="\n      if (".concat(k,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat(_,"(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(u,", ").concat(c,", ").concat(l,");\n      const ivec3 pads = ivec3(").concat(g,", ").concat(y,", ").concat(b,");\n      const float initializationValue = ").concat(x,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(x,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(d,";\n            wD += ").concat(h,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(m,";\n            wR += ").concat(f,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(C,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(p,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(p,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(p,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(p,", ch)\n              );\n\n              ").concat(E,"\n            }\n\n            int xC = xCCorner + ").concat(C,";\n            if (").concat(1===T,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(E,"\n            } else if (").concat(2===T,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(p,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(E,"\n            } else if (").concat(3===T,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(p,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(p,", ch),\n                initializationValue\n              );\n\n              ").concat(E,"\n            }\n          }\n          setOutput(").concat(S,");\n        }\n      }\n    ")}}));var fF={kernelName:Ks,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;cD(a,"avgPool");var i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode;Ho(jp(o,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var c=Ap(a.shape,i,o,1,s,u);if(1===c.filterWidth&&1===c.filterHeight&&$o(c.inShape,c.outShape))return ZR({inputs:{x:a},backend:n});var l=new lF(c,"avg",!1);return n.runWebGLProgram(l,[a],"float32")}};var pF={kernelName:Ys,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode,c=r.dataFormat,l=Np(a.shape,i,o,[1,1,1],s,u,c),h=new hF(l,"avg",!1);return n.runWebGLProgram(h,[a],"float32")}},dF=c((function e(t){s(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterHeight,l=t.effectiveFilterWidth,h=c-1-t.padInfo.top,f=l-1-t.padInfo.left,p=1/(n*r);this.userCode="\n      const ivec2 pads = ivec2(".concat(h,", ").concat(f,");\n      const float avgMultiplier = float(").concat(p,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(c,";\n            wR += ").concat(o,") {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(l,";\n            wC+= ").concat(u,") {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),mF=c((function e(t){s(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.filterDepth,r=t.filterHeight,a=t.filterWidth,i=t.strideDepth,o=t.strideHeight,u=t.strideWidth,c=t.dilationDepth,l=t.dilationHeight,h=t.dilationWidth,f=t.effectiveFilterDepth,p=t.effectiveFilterHeight,d=t.effectiveFilterWidth,m=f-1-t.padInfo.front,v=p-1-t.padInfo.top,g=d-1-t.padInfo.left,y=1/(n*r*a);this.userCode="\n      const ivec3 pads = ivec3(".concat(m,", ").concat(v,", ").concat(g,");\n      const float avgMultiplier = float(").concat(y,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(f,";\n            wD += ").concat(c,") {\n          float dyD = float(dyDCorner + wD) / ").concat(i,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(p,";\n              wR += ").concat(l,") {\n            float dyR = float(dyRCorner + wR) / ").concat(o,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(d,";\n                wC += ").concat(h,") {\n              float dyC = float(dyCCorner + wC) / ").concat(u,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var vF={kernelName:Qs,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,s=r.strides,u=r.pad,c=r.dimRoundingMode,l=Np(i.shape,o,s,[1,1,1],u,c),h=new mF(l);return n.runWebGLProgram(h,[a],i.dtype)}};var gF={kernelName:Xs,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;cD([a,i],"avgPoolGrad");var s=r.filterSize,u=r.strides,c=r.pad,l=Ap(o.shape,s,u,1,c),h=new dF(l);return n.runWebGLProgram(h,[a],o.dtype)}};var yF={kernelName:$s,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;return PO({a:t.a,b:t.b,transposeA:r.transposeA,transposeB:r.transposeB,backend:n})}},bF=c((function e(t,n,r,a,i,o){s(this,e),this.outputShape=[],this.variableNames=["x","mean","variance"],dd(t,n),dd(t,r);var u="0.0";null!=a&&(dd(t,a),this.variableNames.push("offset"),u="getOffsetAtOutCoords()");var c="1.0";null!=i&&(dd(t,i),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(u,";\n        float scale = ").concat(c,";\n        float inv = scale * inversesqrt(variance + float(").concat(o,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")})),kF=c((function e(t,n,r,a,i,o){s(this,e),this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],dd(t,n),dd(t,r);var u="vec4(0.0)";null!=a&&(dd(t,a),this.variableNames.push("offset"),u="getOffsetAtOutCoords()");var c="vec4(1.0)";null!=i&&(dd(t,i),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = ".concat(u,";\n        vec4 scale = ").concat(c,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(o,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")})),xF={kernelName:zu,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.mean,o=t.variance,s=t.offset,u=t.scale;Ho(i.shape.length===o.shape.length,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),Ho(null==s||i.shape.length===s.shape.length,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),Ho(null==u||i.shape.length===u.shape.length,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var c=r.varianceEpsilon;null==c&&(c=.001);var l=[a,i,o],h=null;null!=s&&(h=s.shape,l.push(s));var f=null;null!=u&&(f=u.shape,l.push(u));var p=Is().getBool("WEBGL_PACK_NORMALIZATION")?new kF(a.shape,i.shape,o.shape,h,f,c):new bF(a.shape,i.shape,o.shape,h,f,c);return n.runWebGLProgram(p,l,l[0].dtype)}},wF=function(){function e(t){s(this,e),this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n,r=WD(this.rank),a="uniform int start[".concat(this.rank,"];"),i=function(e){if(1===e)return"sourceLoc";if(e<=6)return _F.slice(0,e).map((function(e){return"sourceLoc."+e})).join(",");throw Error("Slicing for rank ".concat(e," is not yet supported"))}(this.rank),o=t.map((function(e,t){return"sourceLoc.".concat(_F[t]," = start[").concat(t,"] + coords.").concat(_F[t],";")}));n="\n        ".concat(r," sourceLoc;\n        ").concat(r," coords = getOutputCoords();\n        ").concat(o.join("\n"),"\n      "),this.userCode="\n      ".concat(a,"\n      void main() {\n        ").concat(n,"\n        setOutput(getSource(").concat(i,"));\n      }\n    ")}return c(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;if(e.length!==this.rank)throw Error("The rank (".concat(this.rank,") of the program must match the ")+"length of start (".concat(e.length,")"));return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}}}]),e}(),_F=["x","y","z","w","u","v"];var SF=function(){function e(t){s(this,e),this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var n=WD(this.rank),r=ER("coords",this.rank),a=ER("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2(".concat(a.slice(-2).join(),")"),o="getChannel(getSource(".concat(a.join(),"), ").concat(i,")"),u="\n      result.x = ".concat(o,";\n      if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n        ++").concat(a[this.rank-1],";\n        result.y = ").concat(o,";\n        --").concat(a[this.rank-1],";\n      }\n    "),c=1===this.rank?"":"\n      --".concat(r[this.rank-1],";\n      if (++").concat(r[this.rank-2]," < ").concat(t[this.rank-2],") {\n        ++").concat(a[this.rank-2],";\n        result.z = ").concat(o,";\n        if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n          ++").concat(a[this.rank-1],";\n          result.w = ").concat(o,";\n        }\n      }\n    "),l=this.rank<=4?"sourceLoc = coords +\n            ".concat(n,"(").concat(t.map((function(e,t){return"start[".concat(t,"]")})).join(),");"):t.map((function(e,t){return"".concat(a[t]," = ").concat(r[t]," + start[").concat(t,"];")})).join("\n");this.userCode="\n      uniform int start[".concat(this.rank,"];\n      void main() {\n        ").concat(n," coords = getOutputCoords();\n        ").concat(n," sourceLoc;\n        ").concat(l,"\n        vec4 result = vec4(0.);\n        ").concat(u,"\n        ").concat(c,"\n        setOutput(result);\n      }\n    ")}return c(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;if(e.length!==this.rank)throw Error("The rank (".concat(this.rank,") of the program must match the ")+"length of start (".concat(e.length,")"));return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}}}]),e}();function CF(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=Ct(up(a,r.begin,r.size),2),o=i[0],s=i[1];if(Jf(a,o,s),0===Qo(s))return n.makeTensorInfo(s,a.dtype,[]);if(n.shouldExecuteOnCPU([a])||"string"===a.dtype){var u=n.texData.get(a.dataId),c=bR(u.values,o,s,a.shape,a.dtype);return n.makeTensorInfo(s,a.dtype,c)}var l=n.texData.get(a.dataId).isPacked,h=op(a.shape,o,s);if(l||!h){var f=Is().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new SF(s):new wF(s),p=f.getCustomSetupFunc(o);return n.runWebGLProgram(f,[a],a.dtype,p)}return n.uploadToGPU(a.dataId),function(e,t,n,r){var a=r.texData.get(e.dataId),i=r.makeTensorInfo(n,e.dtype),o=r.texData.get(i.dataId);Object.assign(o,a),o.complexParentRefCount=0,o.refCount=1,o.shape=n,o.dtype=e.dtype;var s=sp(t,ms(e.shape));a.slice&&(s+=a.slice.flatOffset),o.slice={flatOffset:s,origDataId:a.slice&&a.slice.origDataId||e.dataId};var u=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,u+1),i}(a,o,s,n)}var TF={kernelName:Xc,backendName:"webgl",kernelFunc:CF},EF={kernelName:Js,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.crops;Ho(a.shape.length<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var s=i.reduce((function(e,t){return e*t})),u=Yv(a.shape,i,s),c=Qv(u.length,i.length),l=$v(a.shape,i,s),h=Jv(o,i.length),f=Zv(l,o,i.length),p=[],d=bO({inputs:{x:a},backend:n,attrs:{shape:u}}),m=AO({inputs:{x:d},backend:n,attrs:{perm:c}}),v=bO({inputs:{x:m},backend:n,attrs:{shape:l}}),g=CF({inputs:{x:v},backend:n,attrs:{begin:h,size:f}});return p.push(d),p.push(m),p.push(v),p.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),g}};var IF={kernelName:Zs,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=n.readSync(a.dataId),u=n.readSync(i.dataId),c=JD(s,u,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}},AF=lO({opSnippet:"return float(a != b);",dtype:"bool"}),NF={kernelName:xc,backendName:"webgl",kernelFunc:AF};function PF(e){var t=e.inputs,n=e.backend,r=t.input;return ZR({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}var MF={kernelName:Dc,backendName:"webgl",kernelFunc:PF};var DF={kernelName:eu,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=t.attrs,i=n.x,o=a.dtype;if("complex64"===o){if("complex64"===i.dtype)return ZR({inputs:{x:i},backend:r});var s=Jd(i.shape),u=e({inputs:{x:i},backend:r,attrs:{dtype:"float32"}}),c=tO({inputs:{real:u,imag:s},backend:r});return s.dispose(),r.disposeIntermediateTensorInfo(u),c}if("complex64"===i.dtype){var l=PF({inputs:{input:i},backend:r}),h=e({inputs:{x:l},backend:r,attrs:{dtype:o}});return r.disposeIntermediateTensorInfo(l),h}if(!ss(i.dtype,o)){var f=ZR({inputs:{x:i},backend:r});return{dataId:f.dataId,shape:f.shape,dtype:o}}if("int32"===o)return function(e,t){var n=new RR(e.shape,"return float(int(x));"),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(i,r);if("bool"===o){var p=r.makeTensorInfo([],"bool",is("bool",1)),d=AF({inputs:{a:i,b:p},backend:r});return r.disposeIntermediateTensorInfo(p),d}throw new Error("Error in Cast: failed to cast ".concat(i.dtype," to ").concat(o))}},RF="return ceil(x);",OF=cO({opSnippet:RF,packedOpSnippet:RF,cpuKernelImpl:eR}),FF={kernelName:tu,backendName:"webgl",kernelFunc:OF},LF=function(){function e(t){s(this,e),this.variableNames=["A"],this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return c(e,[{key:"getCustomSetupFunc",value:function(e,t){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}}}]),e}(),zF=function(){function e(t){s(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return c(e,[{key:"getCustomSetupFunc",value:function(e,t){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}}}]),e}();var BF={kernelName:nu,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.clipValueMin,s=a.clipValueMax,u=(t=Is().getBool("WEBGL_PACK_CLIP")?new zF(i.shape):new LF(i.shape)).getCustomSetupFunc(o,s);return r.runWebGLProgram(t,[i],i.dtype,u)}},VF=c((function e(t){s(this,e),this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}));function jF(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}var qF={kernelName:au,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n.texData.get(r.dataId),i=new VF(r.shape),o=[jF(r,a.complexTensorInfos.real),jF(r,a.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}},GF=c((function e(t){s(this,e),this.outputShape=[],this.outputShape=Hv(t,1),this.variableNames=t.map((function(e,t){return"T".concat(t)}));var n=new Array(t.length-1);n[0]=t[0][1];for(var r=1;r<n.length;r++)n[r]=n[r-1]+t[r][1];for(var a=["if (yC < ".concat(n[0],") setOutput(getT0(yR, yC));")],i=1;i<n.length;i++){var o=n[i-1];a.push("else if (yC < ".concat(n[i],") ")+"setOutput(getT".concat(i,"(yR, yC-").concat(o,"));"))}var u=n.length,c=n[n.length-1];a.push("else setOutput(getT".concat(u,"(yR, yC-").concat(c,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(a.join("\n        "),"\n      }\n    ")})),WF=c((function e(t,n){s(this,e),this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Hv(t,n);var r=this.outputShape,a=r.length,i=WD(a),o=ER("coords",a),u=["x","y","z","w","u","v"].slice(0,a);this.variableNames=t.map((function(e,t){return"T".concat(t)}));var c=new Array(t.length-1);c[0]=t[0][n];for(var l=1;l<c.length;l++)c[l]=c[l-1]+t[l][n];for(var h=u[n],f=u.slice(-2),p=u.join(),d="if (".concat(h," < ").concat(c[0],") {\n        return getChannel(\n            getT0(").concat(p,"), vec2(").concat(f.join(),"));\n        }"),m=1;m<c.length;m++){var v=c[m-1];d+="\n        if (".concat(h," < ").concat(c[m],"  && ").concat(h," >= ").concat(c[m-1],") {\n          return getChannel(\n            getT").concat(m,"(").concat(UF(u,h,v),"),\n            vec2(").concat(UF(f,h,v),"));\n        }")}var g=c.length,y=c[c.length-1];d+="\n        return getChannel(\n          getT".concat(g,"(").concat(UF(u,h,y),"),\n          vec2(").concat(UF(f,h,y),"));"),this.userCode="\n      float getValue(".concat(u.map((function(e){return"int "+e})),") {\n        ").concat(d,"\n      }\n\n      void main() {\n        ").concat(i," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(o,"), 0., 0., 0.);\n\n        ").concat(o[a-1]," = ").concat(o[a-1]," + 1;\n        if (").concat(o[a-1]," < ").concat(r[a-1],") {\n          result.g = getValue(").concat(o,");\n        }\n\n        ").concat(o[a-2]," = ").concat(o[a-2]," + 1;\n        if (").concat(o[a-2]," < ").concat(r[a-2],") {\n          result.a = getValue(").concat(o,");\n        }\n\n        ").concat(o[a-1]," = ").concat(o[a-1]," - 1;\n        if (").concat(o[a-2]," < ").concat(r[a-2]," &&\n            ").concat(o[a-1]," < ").concat(r[a-1],") {\n          result.b = getValue(").concat(o,");\n        }\n        setOutput(result);\n      }\n    ")}));function UF(e,t,n){var r=e.indexOf(t);return e.map((function(e,t){return t===r?"".concat(e," - ").concat(n):e})).join()}function HF(e){var t=e.inputs,n=e.backend,r=t.input;return ZR({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}var KF={kernelName:Uu,backendName:"webgl",kernelFunc:HF};function XF(e,t,n){var r=e[0].dtype;if("complex64"===r){var a=e.map((function(e){return PF({inputs:{input:e},backend:n})})),i=e.map((function(e){return HF({inputs:{input:e},backend:n})})),o=XF(a,t,n),s=XF(i,t,n),u=tO({inputs:{real:o,imag:s},backend:n});return a.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),i.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}if("string"===r){var c=YF(e,t,n),l=c.tensors2D,h=c.outShape,f=l.map((function(e){return{vals:n.readSync(e.dataId),shape:e.shape}})),p=1===l[0].shape[0],d=tR(f,h,r,p),m=Hv(e.map((function(e){return e.shape})),t),v=n.makeTensorInfo(m,r,d);return l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),v}if(e.length>Is().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var g=Math.floor(e.length/2),y=XF(e.slice(0,g),t,n),b=XF(e.slice(g),t,n),k=XF([y,b],t,n);return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),k}if(Is().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].shape.length>1){var x=new WF(e.map((function(e){return e.shape})),t);return n.runWebGLProgram(x,e,r)}var w=YF(e,t,n),_=w.tensors2D,S=w.outShape,C=new GF(_.map((function(e){return e.shape}))),T=n.runWebGLProgram(C,_,r);_.forEach((function(e){return n.disposeIntermediateTensorInfo(e)}));var E=bO({inputs:{x:T},attrs:{shape:S},backend:n});return n.disposeIntermediateTensorInfo(T),E}function YF(e,t,n){var r=Hv(e.map((function(e){return e.shape})),t);return{tensors2D:e.map((function(e){return bO({inputs:{x:e},attrs:{shape:[-1,Qo(e.shape.slice(t))]},backend:n})})),outShape:r}}function QF(e){var t=e.inputs,n=e.backend,r=rs(e.attrs.axis,t[0].shape)[0],a=Hv(t.map((function(e){return e.shape})),r);if(0===Qo(a))return n.makeTensorInfo(a,t[0].dtype,[]);var i=t.filter((function(e){return Qo(e.shape)>0}));return 1===i.length?ZR({inputs:{x:i[0]},backend:n}):(Uv(i.map((function(e){return e.shape})),r),XF(i,r,n))}var $F={kernelName:iu,backendName:"webgl",kernelFunc:QF},JF=c((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];s(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.padInfo.top,u=t.padInfo.left,c=t.strideHeight,l=t.strideWidth,h=t.dilationHeight,f=t.dilationWidth,p=t.filterHeight,d=t.filterWidth,m=4*Math.floor(t.inChannels/4),v=t.inChannels%4,g="channelsLast"===t.dataFormat,y=g?1:2,b=g?2:3,k=g?3:1,x="",w="";r&&(x=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),w="result = activation(result);");var _=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(x,"\n\n      const ivec2 strides = ivec2(").concat(c,", ").concat(l,");\n      const ivec2 pads = ivec2(").concat(o,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(k,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(y,"], coords[").concat(b,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(p,"; wR++) {\n          int xR = xRCorner + wR * ").concat(h,";\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(d,"; wC++) {\n            int xC = xCCorner + wC * ").concat(f,";\n\n            if (xC < 0 || xC >= ").concat(t.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(m,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(g,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===v,") {\n\n              if (").concat(g,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(m,") *\n                    getW(wR, wC, ").concat(m,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(m,", xR, xC) *\n                    getW(wR, wC, ").concat(m,", d2);\n              }\n\n            } else if (").concat(2===v,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(m,", d2),\n                getW(wR, wC, ").concat(m," + 1, d2)\n              );\n\n              if (").concat(g,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(m,"),\n                  getX(batch, xR, xC, ").concat(m," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(m,", xR, xC),\n                  getX(batch, ").concat(m," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===v,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(m,", d2),\n                getW(wR, wC, ").concat(m," + 1, d2),\n                getW(wR, wC, ").concat(m," + 2, d2)\n              );\n\n              if (").concat(g,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(m,"),\n                  getX(batch, xR, xC, ").concat(m," + 1),\n                  getX(batch, xR, xC, ").concat(m," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(m,", xR, xC),\n                  getX(batch, ").concat(m," + 1, xR, xC),\n                  getX(batch, ").concat(m," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(_,"\n        ").concat(w,"\n        setOutput(result);\n      }\n    ")})),ZF=c((function e(t){s(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.padInfo.front,r=t.padInfo.top,a=t.padInfo.left,i=t.strideDepth,o=t.strideHeight,u=t.strideWidth,c=t.dilationDepth,l=t.dilationHeight,h=t.dilationWidth,f=t.filterDepth,p=t.filterHeight,d=t.filterWidth,m=4*Math.floor(t.inChannels/4),v=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(i,", ").concat(o,", ").concat(u,");\n      const ivec3 pads = ivec3(").concat(n,", ").concat(r,", ").concat(a,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(f,"; wF++) {\n          int xF = xFCorner + wF * ").concat(c,";\n\n          if (xF < 0 || xF >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(p,"; wR++) {\n            int xR = xRCorner + wR * ").concat(l,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(d,"; wC++) {\n              int xC = xCCorner + wC * ").concat(h,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(m,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===v,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(m,") *\n                  getW(wF, wR, wC, ").concat(m,", d2);\n              } else if (").concat(2===v,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(m,"),\n                  getX(batch, xF, xR, xC, ").concat(m," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(m,", d2),\n                  getW(wF, wR, wC, ").concat(m," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===v,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(m,"),\n                  getX(batch, xF, xR, xC, ").concat(m," + 1),\n                  getX(batch, xF, xR, xC, ").concat(m," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(m,", d2),\n                  getW(wF, wR, wC, ").concat(m," + 1, d2),\n                  getW(wF, wR, wC, ").concat(m," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),eL=c((function e(t,n,r){s(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var a=r.filterWidth,i=r.inChannels,o=r.strideWidth,u=r.strideHeight,c=r.padInfo,l=r.outWidth,h=r.dilationWidth,f=r.dilationHeight,p=r.dataFormat,d=c.left,m=c.top,v=i*a,g=hD(),y="channelsLast"===p,b=y?0:1,k=y?1:2,x="",w=0;w<=1;w++)for(var _=0;_<=1;_++)x+="\n          blockIndex = rc.y + ".concat(_,";\n          pos = rc.x + ").concat(w,";\n\n          if(blockIndex < ").concat(t[1]," && pos < ").concat(t[0],") {\n            offsetY = int(blockIndex / (").concat(l,")) * ").concat(u," - ").concat(m,";\n            d0 = offsetY + ").concat(f," * (pos / ").concat(v,");\n\n            if(d0 < ").concat(n[b]," && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), ").concat(l,".) * ").concat(o,". - ").concat(d,".);\n              d1 = offsetX + ").concat(h," * (int(mod(float(pos), ").concat(v,".) / ").concat(i,".));\n\n              if(d1 < ").concat(n[k]," && d1 >= 0) {\n\n                ch = int(mod(float(pos), ").concat(i,".));\n\n                if (").concat(y,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*w+_,"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*w+_,"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(x,"\n\n        ").concat(g.output," = result;\n      }\n    ")}));function tL(e){var t,n=e.x,r=e.filter,a=e.convInfo,i=e.backend,o=e.bias,s=void 0===o?null:o,u=e.preluActivationWeights,c=void 0===u?null:u,l=e.leakyreluAlpha,h=void 0===l?0:l,f=e.activation,p=void 0===f?null:f,d=n.shape,m=i.texData.get(n.dataId),v=a.inChannels,g=d[0]*d[1]*d[2],y=a.outChannels,b="channelsLast"===a.dataFormat,k=[],x=(1===g||1===y)&&v>1e3,w=d[2]%2!==0&&!!m.isPacked;if(!x&&Is().getBool("WEBGL_LAZILY_UNPACK")&&Is().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&w){var _=b?d[0]*d[1]*(d[2]+1):d[0]*d[2]*(d[3]+1),S={dataId:n.dataId,shape:[1,_,a.inChannels],dtype:n.dtype},C=m.shape;m.shape=m.shape.slice(),m.shape[m.shape.length-2]++,Ho(aD(m.shape,S.shape),(function(){return"packed reshape ".concat(m.shape," to ").concat(S.shape," isn't free")}));var T=bO({inputs:{x:r},backend:i,attrs:{shape:[1,a.inChannels,a.outChannels]}});k.push(T);var E=PO({a:S,b:T,backend:i,transposeA:false,transposeB:false,bias:s,activation:p,preluActivationWeights:c,leakyreluAlpha:h}),I=i.texData.get(E.dataId);Ho(I.isPacked,(function(){return"batchMatMul result is expected to be packed"})),m.shape=C,I.shape=a.outShape,(t=ZR({inputs:{x:E},backend:i})).shape=a.outShape,k.push(E)}else{var A=bO({inputs:{x:n},backend:i,attrs:{shape:[1,b?d[0]*d[1]*d[2]:d[0]*d[2]*d[3],a.inChannels]}}),N=bO({inputs:{x:r},backend:i,attrs:{shape:[1,a.inChannels,a.outChannels]}}),P=PO({a:A,b:N,transposeA:false,transposeB:false,backend:i,bias:s,activation:p,preluActivationWeights:c,leakyreluAlpha:h});t=bO({inputs:{x:P},backend:i,attrs:{shape:a.outShape}}),k.push(A),k.push(N),k.push(P)}for(var M=0,D=k;M<D.length;M++){var R=D[M];i.disposeIntermediateTensorInfo(R)}return t}function nL(e){var t=e.x,n=e.filter,r=e.convInfo,a=e.backend,i=e.bias,o=void 0===i?null:i,s=e.preluActivationWeights,u=void 0===s?null:s,c=e.leakyreluAlpha,l=void 0===c?0:c,h=e.activation,f=void 0===h?null:h,p=r.filterWidth,d=r.filterHeight,m=r.inChannels,v=r.outWidth,g=r.outHeight,y="channelsLast"===r.dataFormat,b=p*d*m,k=g*v,x=[b,k],w=[],_=bO({inputs:{x:t},backend:a,attrs:{shape:t.shape.slice(1)}}),S=bO({inputs:{x:n},backend:a,attrs:{shape:[1,b,Qo(n.shape)/b]}});w.push(_),w.push(S);var C=new eL(x,_.shape,r),T=a.runWebGLProgram(C,[_],"float32"),E=bO({inputs:{x:T},backend:a,attrs:{shape:[1,x[0],x[1]]}});w.push(T),w.push(E);var I=null!=o,A=null!=u,N="leakyrelu"===f,P=f?hO(f,!0):null,M=new fO(E.shape,S.shape,[1,k,r.outChannels],!0,!1,I,P,A,N),D=[E,S];if(o&&D.push(o),A&&D.push(u),N){var R=a.makeTensorInfo([],"float32",Vl(l,"float32"));D.push(R),w.push(R)}var O=a.runWebGLProgram(M,D,"float32"),F=bO({inputs:{x:O},backend:a,attrs:{shape:y?[1,g,v,r.outChannels]:[1,r.outChannels,g,v]}});w.push(O);for(var L=0,z=w;L<z.length;L++){var B=z[L];a.disposeIntermediateTensorInfo(B)}return F}var rL={kernelName:ou,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=n.filter,s=a.strides,u=a.pad,c=a.dataFormat,l=a.dilations,h=a.dimRoundingMode,f=qp(c),p=Pp(i.shape,o.shape,s,l,u,h,!1,f);if(1!==p.filterHeight||1!==p.filterWidth||1!==p.dilationHeight||1!==p.dilationWidth||1!==p.strideHeight||1!==p.strideWidth||"SAME"!==p.padInfo.type&&"VALID"!==p.padInfo.type)if(Is().getBool("WEBGL_CONV_IM2COL")&&1===i.shape[0])t=nL({x:i,filter:o,convInfo:p,backend:r});else{var d=new JF(p);t=r.runWebGLProgram(d,[i,o],"float32")}else t=tL({x:i,filter:o,convInfo:p,backend:r});var m=bO({inputs:{x:t},backend:r,attrs:{shape:p.outShape}});return r.disposeIntermediateTensorInfo(t),m}},aL=c((function e(t){s(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideHeight,r=t.strideWidth,a=t.padInfo.top,i=t.padInfo.left,o="channelsLast"===t.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(r," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              if (").concat(o,") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),iL=c((function e(t){s(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o="channelsLast"===t.dataFormat,u=n-1-t.padInfo.top,c=r-1-t.padInfo.left,l=o?1:2,h=o?2:3,f=o?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(u,", ").concat(c,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(f,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(l,"], coords[").concat(h,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n\n              if (").concat(o,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),oL=c((function e(t){s(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideDepth,r=t.strideHeight,a=t.strideWidth,i=t.padInfo.front,o=t.padInfo.top,u=t.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(t.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(n," - ").concat(i,";\n\n            if (xF < 0 || xF >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(r," - ").concat(o,";\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(a," - ").concat(u,";\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),sL=c((function e(t){s(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterDepth,r=t.filterHeight,a=t.filterWidth,i=t.strideDepth,o=t.strideHeight,u=t.strideWidth,c=n-1-t.padInfo.front,l=r-1-t.padInfo.top,h=a-1-t.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(c,", ").concat(l,", ").concat(h,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(n,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(i,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(t.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(n," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(r,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(o,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(r," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(a,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(u,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(a," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var uL={kernelName:su,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.pad,u=r.dataFormat,c=r.dimRoundingMode,l=r.filterShape,h=qp(u),f=Pp(a.shape,l,o,1,s,c,!1,h),p=new aL(f);return n.runWebGLProgram(p,[a,i],"float32")}};var cL={kernelName:uu,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.inputShape,s=r.strides,u=r.pad,c=r.dataFormat,l=r.dimRoundingMode,h=qp(c),f=Pp(o,i.shape,s,1,u,l,!1,h),p=new iL(f);return n.runWebGLProgram(p,[a,i],"float32")}};var lL={kernelName:cu,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations,c=Mp(a.shape,i.shape,o,u,s),l=new ZF(c);return n.runWebGLProgram(l,[a,i],"float32")}};var hL={kernelName:lu,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.pad,u=r.filterShape,c=Mp(a.shape,u,o,1,s),l=new oL(c);return n.runWebGLProgram(l,[a,i],"float32")}};var fL={kernelName:hu,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.pad,s=r.strides,u=Mp(r.inputShape,i.shape,s,1,o),c=new sL(u);return n.runWebGLProgram(c,[a,i],"float32")}},pL=cO({opSnippet:"if (isnan(x)) return x;\n  return cos(x);\n"}),dL={kernelName:fu,backendName:"webgl",kernelFunc:pL},mL=cO({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),vL={kernelName:pu,backendName:"webgl",kernelFunc:mL},gL=c((function e(t,n,r,a,i){s(this,e),this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=Ct(t,4),u=o[0],c=o[1],l=o[2],h=o[3],f=Ct(n,1)[0],p=Ct(r,2),d=p[0],m=p[1];this.outputShape=[f,d,m,h];var v="bilinear"===a?1:0,g="".concat(c-1,".0"),y="".concat(l-1,".0"),b=Ct(d>1?["".concat((c-1)/(d-1)),"(y2-y1) * height_ratio","y1*".concat(g," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(g)],3),k=b[0],x=b[1],w=b[2],_=Ct(m>1?["".concat((l-1)/(m-1)),"(x2-x1) * width_ratio","x1*".concat(y," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(y)],3),S=_[0],C=_[1],T=_[2];this.userCode="\n      const float height_ratio = float(".concat(k,");\n      const float width_ratio = float(").concat(S,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(u,") {\n          return;\n        }\n\n        float height_scale = ").concat(x,";\n        float width_scale = ").concat(C,";\n\n        float in_y = ").concat(w,";\n        if( in_y < 0.0 || in_y > ").concat(g," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n        float in_x = ").concat(T,";\n        if( in_x < 0.0 || in_x > ").concat(y," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(v," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")})),yL={kernelName:mu,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=t.boxes,o=t.boxInd,s=r.cropSize,u=r.method,c=r.extrapolationValue,l=new gL(a.shape,i.shape,s,u,c);return n.runWebGLProgram(l,[a,i,o],"float32")}},bL=function(){function e(t,n,r){s(this,e),this.variableNames=["x"],this.outputShape=t;var a=t.length,i=n?"0.0":"getX(".concat(kL(a,"coords"),")"),o=t[t.length-1],u="",c="";n?(u=r?"end != ".concat(o-1):"end != 0",c=r?"end + 1":"end - 1"):(u=r?"end + pow2 < ".concat(o):"end >= pow2",c=r?"end + pow2":"end - pow2"),this.userCode="\n      uniform float index;\n      void main() {\n        ".concat(WD(a)," coords = getOutputCoords();\n        int end = ").concat(xL(a,"coords"),";\n        float val = ").concat(i,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(u,") {\n          int idx = ").concat(c,";\n          ").concat(xL(a,"coords")," = idx;\n          val += getX(").concat(kL(a,"coords"),");\n        }\n        setOutput(val);\n      }\n    ")}return c(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.index&&(t.index=n.getUniformLocation(r,"index")),n.gl.uniform1f(t.index,e)}}}]),e}();function kL(e,t){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".x, ").concat(t,".y");if(3===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z");if(4===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z, ").concat(t,".w");throw Error("Cumulative sum for rank ".concat(e," is not yet supported"))}function xL(e,t){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".y");if(3===e)return"".concat(t,".z");if(4===e)return"".concat(t,".w");throw Error("Cumulative sum for rank ".concat(e," is not yet supported"))}var wL={kernelName:du,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,s=r.reverse,u=a.shape.length,c=Wd([i],u),l=a;null!=c&&(l=AO({inputs:{x:a},backend:n,attrs:{perm:c}}));var h=Hd(1,u)[0];if(h!==u-1)throw new Error("WebGL cumsum shader expects an inner-most axis=".concat(a.shape.length-1," ")+"but got axis=".concat(i));for(var f=l.shape[h],p=ZR({inputs:{x:l},backend:n}),d=0;d<=Math.ceil(Math.log2(f))-1;d++){var m=new bL(l.shape,!1,s),v=m.getCustomSetupFunc(d),g=p;p=n.runWebGLProgram(m,[p],p.dtype,v),n.disposeIntermediateTensorInfo(g)}if(o){var y=new bL(l.shape,o,s),b=p;p=n.runWebGLProgram(y,[p],p.dtype),n.disposeIntermediateTensorInfo(b)}if(null!=c){var k=AO({inputs:{x:p},backend:n,attrs:{perm:Ud(c)}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(l),k}return p}};var _L={kernelName:vu,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=r.binaryOutput;if(1===a.shape.length){var u=n.readSync(a.dataId),c=n.readSync(i.dataId),l=JD(u,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,l)}if(2===a.shape.length){var h=n.bufferSync(a),f=n.bufferSync(i),p=ZD(h,f,o,s);return n.makeTensorInfo(p.shape,i.dtype,p.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}},SL=function(){function e(t,n,r){s(this,e),this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(n,";\n      int offset_h = imod(h, ").concat(n,");\n      int in_w = w / ").concat(n,";\n      int offset_w = imod(w, ").concat(n,");\n      int offset_d = (offset_h * ").concat(n," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}return c(e,[{key:"getHeightCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}},{key:"getWidthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}},{key:"getDepthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}},{key:"getOutputDepthSize",value:function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}},{key:"getInputSamplingString",value:function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}]),e}();var CL={kernelName:gu,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockSize,o=r.dataFormat;Ho(i>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: ".concat(i)}));var s=a.shape[0],u="NHWC"===o?a.shape[1]:a.shape[2],c="NHWC"===o?a.shape[2]:a.shape[3],l="NHWC"===o?a.shape[3]:a.shape[1],h=u*i,f=c*i,p=l/(i*i),d=new SL("NHWC"===o?[s,h,f,p]:[s,p,h,f],i,o);return n.runWebGLProgram(d,[a],a.dtype)}},TL=c((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];s(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.inHeight,u=t.inWidth,c=t.padInfo.top,l=t.padInfo.left,h=t.strideHeight,f=t.strideWidth,p=t.dilationHeight,d=t.dilationWidth,m=t.filterHeight,v=t.filterWidth,g=t.outChannels/t.inChannels,y="",b="";r&&(y=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),b="result = activation(result);");var k=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(y,"\n\n      const ivec2 strides = ivec2(").concat(h,", ").concat(f,");\n      const ivec2 pads = ivec2(").concat(c,", ").concat(l,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(g,";\n        int q = d2 - d1 * ").concat(g,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(m,"; wR++) {\n          int xR = xRCorner + wR * ").concat(p,";\n\n          if (xR < 0 || xR >= ").concat(o,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(v,"; wC++) {\n            int xC = xCCorner + wC * ").concat(d,";\n\n            if (xC < 0 || xC >= ").concat(u,") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(k,"\n        ").concat(b,"\n        setOutput(result);\n      }\n    ")})),EL=c((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];s(this,e),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;for(var o=t.inHeight,u=t.inWidth,c=t.padInfo.top,l=t.padInfo.left,h=t.strideHeight,f=t.strideWidth,p=t.dilationHeight,d=t.dilationWidth,m=t.filterHeight,v=t.filterWidth,g=v,y="int xR; int xC; int xCOffset;",b=0;b<m;b++)for(var k=0;k<v;k++)y+="\n          vec4 xTexelR".concat(b,"C").concat(2*k," = vec4(0.);\n          vec4 wR").concat(b,"C").concat(k," = vec4(0.);\n          vec4 xR").concat(b,"C").concat(k," = vec4(0.);");for(var x=0;x<m;x++)for(var w=0;w<g;w++){var _=2*w;if(y+="\n          xR = xRCorner + ".concat(x*p,";\n          xC = xCCorner + ").concat(_*d,";\n        "),1===f){if(_<v&&(y+=l%2===1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < ".concat(o," && xCOffset >= 0 && xCOffset < ").concat(u,") {\n                  xTexelR").concat(x,"C").concat(_," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ").concat(u,") {\n                    xTexelR").concat(x,"C").concat(_,".zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR").concat(x,"C").concat(_," = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < ").concat(o," && xCOffset >= 0 && xCOffset < ").concat(u,") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ").concat(u,") {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR").concat(x,"C").concat(_," = vec4(previous.zw, xTexelR").concat(x,"C").concat(_,".xy);\n                } else {\n                  xR").concat(x,"C").concat(_," = vec4(0, 0, xTexelR").concat(x,"C").concat(_,".xy);\n                }\n              "):"\n                if(xR >= 0 && xR < ".concat(o," && xC >= 0 && xC < ").concat(u,") {\n                  xTexelR").concat(x,"C").concat(_," = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR").concat(x,"C").concat(_," = vec4(0.);\n                }\n\n                xR").concat(x,"C").concat(_," = xTexelR").concat(x,"C").concat(_,";\n              "),_+1<v)){var S=l%2===0?Wo(d):d;d%2===0&&l%2===1||d%2!==0&&l%2!==1?(y+="\n                  xCOffset = xC + ".concat(l%2," + ").concat(S,";\n\n                  if(xR >= 0 && xR < ").concat(o," &&\n                    xCOffset >= 0 && xCOffset < ").concat(u,") {\n                    xTexelR").concat(x,"C").concat(_+2," = getX(batch, xR, xCOffset, d1);\n                  }\n                "),d>1&&(y+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < ".concat(o," &&\n                      xCOffset >= 0 && xCOffset < ").concat(u,") {\n                      xTexelR").concat(x,"C").concat(_," = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR").concat(x,"C").concat(_," = vec4(0.);\n                    }\n                  ")),y+="\n                  xR".concat(x,"C").concat(_+1," = vec4(\n                    xTexelR").concat(x,"C").concat(_,".zw, xTexelR").concat(x,"C").concat(_+2,".xy);\n                ")):y+="\n                  xCOffset = xC + ".concat(S,";\n\n                  if(xR >= 0 && xR < ").concat(o," &&\n                    xCOffset >= 0 && xCOffset < ").concat(u,") {\n                    xTexelR").concat(x,"C").concat(_+2," = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR").concat(x,"C").concat(_+1," = xTexelR").concat(x,"C").concat(_+2,";\n                ")}}else _<v&&(y+="\n              if(xR >= 0 && xR < ".concat(o,") {\n            "),l%2===1?(y+="\n                xCOffset = xC + 1 - ".concat(f,";\n                if(xCOffset >= 0 && xCOffset < ").concat(u,") {\n                  xTexelR").concat(x,"C").concat(_," = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR").concat(x,"C").concat(_," = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < ").concat(u,") {\n                  xTexelR").concat(x,"C").concat(_+2," = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR").concat(x,"C").concat(_+2," = vec4(0.);\n                }\n\n                xR").concat(x,"C").concat(_," = vec4(\n                  xTexelR").concat(x,"C").concat(_,".zw, xTexelR").concat(x,"C").concat(_+2,".zw);\n              "),_+1<v&&(y+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + ".concat(f,";\n                  if(xCOffset >= 0 && xCOffset < ").concat(u,") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR").concat(x,"C").concat(_+1," = vec4(xTexelR").concat(x,"C").concat(_+2,".xy, final.xy);\n                "))):(y+="\n                if(xC >= 0 && xC < ".concat(u,") {\n                  xTexelR").concat(x,"C").concat(_," = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR").concat(x,"C").concat(_," = vec4(0.);\n                }\n\n                xCOffset = xC + ").concat(f,";\n                if(xCOffset >= 0 && xCOffset < ").concat(u,") {\n                  xTexelR").concat(x,"C").concat(_+2," = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR").concat(x,"C").concat(_+2," = vec4(0.);\n                }\n\n                xR").concat(x,"C").concat(_," = vec4(\n                  xTexelR").concat(x,"C").concat(_,".xy, xTexelR").concat(x,"C").concat(_+2,".xy);\n              "),_+1<v&&(y+="\n                  xR".concat(x,"C").concat(_+1," = vec4(\n                    xTexelR").concat(x,"C").concat(_,".zw, xTexelR").concat(x,"C").concat(_+2,".zw);\n                "))),y+="}");_<v&&(y+="\n            vec4 wTexelR".concat(x,"C").concat(_," = getW(").concat(x,", ").concat(_,", d1, q);\n            wR").concat(x,"C").concat(_," = vec4(wTexelR").concat(x,"C").concat(_,".xz, wTexelR").concat(x,"C").concat(_,".xz);\n          "),_+1<v&&(y+="\n              vec4 wTexelR".concat(x,"C").concat(_+1," = getW(").concat(x,", ").concat(_+1,", d1, q);\n              wR").concat(x,"C").concat(_+1," =\n                vec4(wTexelR").concat(x,"C").concat(_+1,".xz, wTexelR").concat(x,"C").concat(_+1,".xz);")))}for(var C=0;C<m;C++)for(var T=0;T<v;T++)y+="dotProd += xR".concat(C,"C").concat(T," * wR").concat(C,"C").concat(T,";");var E="",I="";r&&(E=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(r,"\n        }"),I="result = activation(result);");var A=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(E,"\n\n      const ivec2 strides = ivec2(").concat(h,", ").concat(f,");\n      const ivec2 pads = ivec2(").concat(c,", ").concat(l,");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        ").concat(y,"\n\n        vec4 result = dotProd;\n        ").concat(A,"\n        ").concat(I,"\n        setOutput(result);\n      }\n    ")}));var IL={kernelName:yu,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,s=r.pad,u=r.dilations,c=r.dimRoundingMode,l=u;null==l&&(l=[1,1]),Ho(jp(o,l),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(o," and dilations '").concat(l,"'")}));var h,f=Pp(a.shape,i.shape,o,l,s,c,!0);return h=Is().getBool("WEBGL_PACK_DEPTHWISECONV")&&f.strideWidth<=2&&f.outChannels/f.inChannels===1?new EL(f):new TL(f),n.runWebGLProgram(h,[a,i],"float32")}},AL=c((function e(t){s(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideHeight,r=t.strideWidth,a=t.padInfo.top,i=t.padInfo.left,o=t.outChannels/t.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(o," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(r," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),NL=c((function e(t){s(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o=n-1-t.padInfo.top,u=r-1-t.padInfo.left,c=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(c,"; dm++) {\n              int d2 = d1 * ").concat(c," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var PL={kernelName:bu,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,s=r.dilations,u=r.pad,c=r.dimRoundingMode,l=r.filterShape,h=Pp(a.shape,l,o,s,u,c,!0),f=new AL(h);return n.runWebGLProgram(f,[a,i],"float32")}};var ML={kernelName:ku,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.strides,s=r.dilations,u=r.pad,c=r.dimRoundingMode,l=Pp(r.inputShape,i.shape,o,s,u,c,!0),h=new NL(l);return n.runWebGLProgram(h,[a,i],"float32")}},DL=c((function e(t){s(this,e),this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}));var RL={kernelName:xu,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=[].concat(Fn(r.shape),Fn(r.shape)),i=Qo(r.shape),o=bO({inputs:{x:r},backend:n,attrs:{shape:[i]}}),s=new DL(i),u=n.runWebGLProgram(s,[o],o.dtype),c=bO({inputs:{x:u},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),c}},OL=c((function e(t){s(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.inHeight,r=t.inWidth,a=t.padInfo,i=t.strideHeight,o=t.strideWidth,u=t.filterHeight,c=t.filterWidth,l=t.dilationHeight,h=t.dilationWidth,f=a.top,p=a.left;this.userCode="\n      const ivec2 strides = ivec2(".concat(i,", ").concat(o,");\n      const ivec2 pads = ivec2(").concat(f,", ").concat(p,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(u,"; h++) {\n          int hIn = hBeg + h * ").concat(l,";\n\n          if (hIn >= 0 && hIn < ").concat(n,") {\n            for (int w = 0; w < ").concat(c,"; w++) {\n              int wIn = wBeg + w * ").concat(h,";\n\n              if (wIn >= 0 && wIn < ").concat(r,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")}));var FL={kernelName:wu,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=n.filter,s=a.strides,u=a.pad,c=a.dilations,l=Ip(i.shape,o.shape,s,u,"NHWC",c),h=new OL(l),f=bO({inputs:{x:t=r.runWebGLProgram(h,[i,o],"float32")},backend:r,attrs:{shape:l.outShape}});return r.disposeIntermediateTensorInfo(t),f}},LL=cO({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),zL={kernelName:Tu,backendName:"webgl",kernelFunc:LL},BL={kernelName:Eu,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.dy,a=t.y,i=Is().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new JR("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",r.shape,a.shape):new $R("return (b >= 1.0) ? a : a * (b + 1.0);",r.shape,a.shape);return n.runWebGLProgram(i,[r,a],r.dtype)}},VL=lO({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool"}),jL={kernelName:Au,backendName:"webgl",kernelFunc:VL},qL=cO({opSnippet:'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(ag,";\n  float a1 = ").concat(ig,";\n  float a2 = ").concat(og,";\n  float a3 = ").concat(sg,";\n  float a4 = ").concat(ug,";\n  float a5 = ").concat(cg,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n")}),GL={kernelName:Iu,backendName:"webgl",kernelFunc:qL},WL="return exp(x);",UL=cO({opSnippet:WL,packedOpSnippet:WL,cpuKernelImpl:nR}),HL={kernelName:Nu,backendName:"webgl",kernelFunc:UL};function KL(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.dim,i=t.input,o=i.shape.length,s=i.shape.slice(),u=a;return a<0&&(Ho(-(o+1)<=a,(function(){return"Axis must be in the interval [".concat(-(o+1),", ").concat(o,"]")})),u=o+a+1),s.splice(u,0,1),bO({inputs:{x:i},backend:r,attrs:{shape:s}})}var XL={kernelName:Pu,backendName:"webgl",kernelFunc:KL},YL="return exp(x) - 1.0;",QL=cO({opSnippet:YL,packedOpSnippet:YL,cpuKernelImpl:rR}),$L={kernelName:Mu,backendName:"webgl",kernelFunc:QL},JL=c((function e(t,n,r){s(this,e),this.variableNames=["real","imag"];var a=n[1];this.outputShape=n;var i,o=r?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),u=r?"".concat(a,".0"):"1.0";if("real"===t)i="return real * expR - imag * expI;";else{if("imag"!==t)throw new Error('FFT component must be either "real" or "imag", got '.concat(t,"."));i="return real * expI + imag * expR;"}this.userCode="\n      const float exponentMultiplier = ".concat(o,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(i,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(a,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(u,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")}));function ZL(e,t,n){var r=n.texData.get(e.dataId),a=Qo(e.shape),i=e.shape[e.shape.length-1],o=bO({inputs:{x:e},backend:n,attrs:{shape:[a/i,i]}}),s=o.shape,u=new JL("real",s,t),c=new JL("imag",s,t),l=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:s},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:s}],h=n.runWebGLProgram(u,l,"float32"),f=n.runWebGLProgram(c,l,"float32"),p=tO({inputs:{real:h,imag:f},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f);var d=bO({inputs:{x:p},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(p),d}var ez={kernelName:Du,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend;return ZL(t.input,!1,n)}},tz=function(){function e(t,n){s(this,e),this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return c(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.valueLoc&&(t.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(t.valueLoc,e)}}}]),e}();function nz(e){var t=e.backend,n=e.attrs,r=n.shape,a=n.value,i=n.dtype;if("string"===(i=i||fs(a))){var o=os(i,Qo(r));return o.fill(a),t.makeTensorInfo(r,i,o)}var s=new tz(r,a),u=s.getCustomSetupFunc(a);return t.runWebGLProgram(s,[],i,u)}var rz,az={kernelName:Ru,backendName:"webgl",kernelFunc:nz},iz=c((function e(t){s(this,e),this.variableNames=["Image"],this.outputShape=[];var n=t[2];this.outputShape=t,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(n," - x;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(n,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")})),oz={kernelName:Ou,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.image,a=n,i=new iz(r.shape);return a.runWebGLProgram(i,[r],r.dtype)}},sz="return floor(x);",uz=cO({opSnippet:sz,packedOpSnippet:sz,cpuKernelImpl:aR}),cz={kernelName:Fu,backendName:"webgl",kernelFunc:uz},lz=lO({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),hz={kernelName:Lu,backendName:"webgl",kernelFunc:lz},fz=c((function e(t){s(this,e),this.variableNames=["A"];var n=hD(),r=Ct(t,2),a=r[0],i=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(i,".0, ").concat(a,".0);\n\n        vec4 values = ").concat(n.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")})),pz=c((function e(t){s(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var n=hD(),r=Ct(t,2),a=r[0],i=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(i,".0, ").concat(a,".0);\n            vec4 values = ").concat(n.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")})),dz={kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.pixels,i=r.numChannels,o="undefined"!==typeof HTMLVideoElement&&a instanceof HTMLVideoElement,s="undefined"!==typeof HTMLImageElement&&a instanceof HTMLImageElement,u="undefined"!==typeof ImageBitmap&&a instanceof ImageBitmap,c=Ct(o?[a.videoWidth,a.videoHeight]:[a.width,a.height],2),l=c[0],h=c[1],f=[h,l],p=[h,l,i];(s||o||u)&&(null==rz&&(rz=document.createElement("canvas").getContext("2d")),rz.canvas.width=l,rz.canvas.height=h,rz.drawImage(a,0,0,l,h),a=rz.canvas);var d=n.makeTensorInfo(f,"int32");n.texData.get(d.dataId).usage=IM.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(d.dataId),a);var m=Is().getBool("WEBGL_PACK")?new pz(p):new fz(p),v=n.runWebGLProgram(m,[d],"int32");return n.disposeData(d.dataId),v}};var mz={kernelName:wl,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=n.filter,s=n.bias,u=n.preluActivationWeights,c=a.strides,l=a.pad,h=a.dataFormat,f=a.dilations,p=a.dimRoundingMode,d=a.activation,m=a.leakyreluAlpha,v=qp(h),g=Pp(i.shape,o.shape,c,f,l,p,!1,v),y=[];if(1!==g.filterHeight||1!==g.filterWidth||1!==g.dilationHeight||1!==g.dilationWidth||1!==g.strideHeight||1!==g.strideWidth||"SAME"!==g.padInfo.type&&"VALID"!==g.padInfo.type)if(Is().getBool("WEBGL_CONV_IM2COL")&&1===i.shape[0])t=nL({x:i,filter:o,convInfo:g,backend:r,bias:s,activation:d,preluActivationWeights:u,leakyreluAlpha:m});else{var b=null!=s,k=null!=u,x="leakyrelu"===d,w=d?hO(d,!1):null,_=new JF(g,b,w,k,x),S=[i,o];if(s&&S.push(s),u&&S.push(u),x){var C=r.makeTensorInfo([],"float32",Vl(m,"float32"));S.push(C),y.push(C)}t=r.runWebGLProgram(_,S,"float32")}else t=tL({x:i,filter:o,convInfo:g,backend:r,bias:s,activation:d,preluActivationWeights:u,leakyreluAlpha:m});var T=bO({inputs:{x:t},backend:r,attrs:{shape:g.outShape}});return y.push(t),y.forEach((function(e){return r.disposeIntermediateTensorInfo(e)})),T}};var vz={kernelName:_l,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,s=t.preluActivationWeights,u=r.strides,c=r.pad,l=r.dilations,h=r.dimRoundingMode,f=r.activation,p=r.leakyreluAlpha,d=[],m=l;null==m&&(m=[1,1]),Ho(jp(u,m),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(u," and dilations '").concat(m,"'")}));var v,g=Pp(a.shape,i.shape,u,m,c,h,!0),y=Is().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,b=f?hO(f,y):null,k=[a,i],x=null!=o,w=null!=s,_="leakyrelu"===f;if(x&&k.push(o),w&&k.push(s),_){var S=n.makeTensorInfo([],"float32",Vl(p,"float32"));k.push(S),d.push(S)}v=y?new EL(g,x,b,w,_):new TL(g,x,b,w,_);var C=n.runWebGLProgram(v,k,"float32");return d.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),C}},gz=c((function e(t,n,r){s(this,e),this.sliceDim=t,this.strides=n,this.variableNames=["x","indices"],this.outputShape=r;var a=WD(n.length),i=WD(r.length),o=this.sliceDim>1?"strides[j]":"strides";this.userCode="\n        ".concat(a," strides = ").concat(a,"(").concat(this.strides,");\n         void main() {\n          ").concat(i," coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < ").concat(this.sliceDim,"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * ").concat(o,";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      ")}));var yz={kernelName:Vu,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.params,a=t.indices,i=a.shape,o=i[i.length-1],s=Ct(eg(r,a),4),u=s[0],c=s[1],l=s[2],h=s[3],f=bO({inputs:{x:a},backend:n,attrs:{shape:[c,o]}}),p=bO({inputs:{x:r},backend:n,attrs:{shape:[Qo(r.shape)/l,l]}}),d=new gz(o,h,[c,l]),m=n.runWebGLProgram(d,[p,f],p.dtype),v=bO({inputs:{x:m},backend:n,attrs:{shape:u}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),v}},bz=c((function e(t,n){s(this,e),this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;var r=WD(this.rank),a=function(e,t){for(var n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[],a=0;a<e.length;a++)2===a?r.push("int(getIndices(resRC.x, resRC.z))"):r.push("".concat(n[a]));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(r," resRC = getOutputCoords();\n        setOutput(getA(").concat(a,"));\n      }\n    ")}));var kz={kernelName:Bu,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.indices,o=r.axis,s=r.batchDims,u=vg(a,i,rs(o,a.shape)[0],s),c=Qo(i.shape),l=[],h=bO({inputs:{x:a},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),f=bO({inputs:{x:i},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});l.push(h),l.push(f);var p=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([a,i])||"string"===a.dtype){var d=n.bufferSync(f),m=n.bufferSync(h),v=iR(m,d,p);return l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(u.outputShape,v.dtype,v.values)}var g=new bz(h.shape,p),y=n.runWebGLProgram(g,[h,f],h.dtype);l.push(y);var b=bO({inputs:{x:y},backend:n,attrs:{shape:u.outputShape}});return l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),b}},xz=lO({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:oR,dtype:"bool"}),wz={kernelName:ju,backendName:"webgl",kernelFunc:xz},_z=lO({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool"}),Sz={kernelName:qu,backendName:"webgl",kernelFunc:_z};var Cz={kernelName:Wu,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend;return ZL(t.input,!0,n)}},Tz=cO({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),Ez={kernelName:Hu,backendName:"webgl",kernelFunc:Tz},Iz=cO({opSnippet:"return float(isinf(x));",dtype:"bool"}),Az={kernelName:Ku,backendName:"webgl",kernelFunc:Iz},Nz=cO({opSnippet:"return float(isnan(x));",dtype:"bool"}),Pz={kernelName:Xu,backendName:"webgl",kernelFunc:Nz},Mz=lO({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:sR,dtype:"bool"}),Dz={kernelName:Qu,backendName:"webgl",kernelFunc:Mz},Rz=lO({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",dtype:"bool"}),Oz={kernelName:$u,backendName:"webgl",kernelFunc:Rz};var Fz={kernelName:Ju,backendName:"webgl",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.num,o=uR(r,a,i);return t.makeTensorInfo([o.length],"float32",o)}},Lz=cO({opSnippet:"if (x < 0.0) return NAN;\n  return log(x);",packedOpSnippet:"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:cR}),zz={kernelName:Zu,backendName:"webgl",kernelFunc:Lz},Bz=cO({opSnippet:"return log(1.0 + x);"}),Vz={kernelName:ec,backendName:"webgl",kernelFunc:Bz},jz=lO({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),qz={kernelName:tc,backendName:"webgl",kernelFunc:jz},Gz=cO({opSnippet:"return float(!(x >= 1.0));"}),Wz={kernelName:nc,backendName:"webgl",kernelFunc:Gz},Uz=lO({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),Hz={kernelName:rc,backendName:"webgl",kernelFunc:Uz},Kz=c((function e(t,n,r,a,i){s(this,e),this.variableNames=["x"],this.outputShape=[];var o,u=n,c=t[3]-1;this.outputShape=t;var l="float(".concat(r,") + float(").concat(a,") * sum");o=.5===i?"inversesqrt(".concat(l,")"):1===i?"1.0/(".concat(l,")"):"exp(log(".concat(l,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(u,"; j <= ").concat(u,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(c,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(o,";\n        setOutput(val);\n      }\n    ")})),Xz=c((function e(t,n,r,a,i){s(this,e),this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var o,u=n,c=t[3]-1;this.outputShape=t;var l="float(".concat(r,") + float(").concat(a,") * sum");o=.5===i?"inversesqrt(".concat(l,")"):1===i?"1.0/(".concat(l,")"):"exp(log(".concat(l,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(u,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(u,"; j <= ").concat(u,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(c,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(o,";\n        setOutput(result);\n      }\n    ")})),Yz={kernelName:ac,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.depthRadius,o=r.bias,s=r.alpha,u=r.beta,c=Is().getBool("WEBGL_PACK_NORMALIZATION")?new Xz(a.shape,i,o,s,u):new Kz(a.shape,i,o,s,u);return n.runWebGLProgram(c,[a],a.dtype)}},Qz=c((function e(t,n,r,a,i){s(this,e),this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=n,this.bias=r,this.alpha=a,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(n,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(n," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(a,") * norm + float(").concat(r,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(a,")\n                * float(").concat(i,")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(i,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")})),$z={kernelName:ic,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.y,o=t.dy,s=r.depthRadius,u=r.bias,c=r.alpha,l=r.beta,h=new Qz(a.shape,s,u,c,l);return n.runWebGLProgram(h,[a,i,o],a.dtype)}};function Jz(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reductionIndices,o=r.keepDims,s=a.shape.length,u=rs(i,a.shape),c=u,l=Wd(c,s),h=null!=l,f=n.shouldExecuteOnCPU([a]),p=a;if(h){if(f){for(var d=n.texData.get(p.dataId).values,m=new Array(s),v=0;v<m.length;v++)m[v]=a.shape[l[v]];var g=SR(d,a.shape,a.dtype,l,m);p=n.makeTensorInfo(m,a.dtype),n.texData.get(p.dataId).values=g}else p=TO(a,l,n);c=Hd(c.length,s)}Gd("max",c,s);var y,b=Ct(jd(p.shape,c),2),k=b[0],x=b[1],w=k;if(o&&(w=qd(k,u)),f){d=n.texData.get(p.dataId).values;var _=lR(d,Qo(x),w,a.dtype);y=n.makeTensorInfo(w,a.dtype),n.texData.get(y.dataId).values=_}else y=function(e,t,n,r){var a=Qo(t),i=bO({inputs:{x:e},attrs:{shape:[Qo(e.shape)/a,a]},backend:r}),o=_O(i,e.dtype,"max",r),s=bO({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),s}(p,x,w,n);return h&&n.disposeIntermediateTensorInfo(p),y}var Zz={kernelName:oc,backendName:"webgl",kernelFunc:Jz},eB=lO({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:hR}),tB={kernelName:sc,backendName:"webgl",kernelFunc:eB};var nB={kernelName:uc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;cD(a,"maxPool");var i=r.filterSize,o=r.strides,s=r.pad,u=r.dimRoundingMode;Ho(jp(o,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var c=Ap(a.shape,i,o,1,s,u);if(1===c.filterWidth&&1===c.filterHeight&&$o(c.inShape,c.outShape))return ZR({inputs:{x:a},backend:n});var l=new lF(c,"max",!1);return n.runWebGLProgram(l,[a],a.dtype)}};var rB={kernelName:lc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,s=r.pad,u=r.dataFormat,c=r.dimRoundingMode,l=Np(a.shape,i,o,[1,1,1],s,c,u),h=new hF(l,"max",!1);return n.runWebGLProgram(h,[a],a.dtype)}},aB=c((function e(t){s(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.strideHeight,r=t.strideWidth,a=t.dilationHeight,i=t.effectiveFilterHeight,o=t.effectiveFilterWidth,u=i-1-t.padInfo.top,c=o-1-t.padInfo.left,l=i*o-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(u,", ").concat(c,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(i,";\n          wR += ").concat(a,") {\n          float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(o,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(l," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(o," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),iB=c((function e(t){s(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.strideDepth,r=t.strideHeight,a=t.strideWidth,i=t.dilationDepth,o=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterDepth,l=t.effectiveFilterHeight,h=t.effectiveFilterWidth,f=c-1-t.padInfo.front,p=l-1-t.padInfo.top,d=h-1-t.padInfo.left,m=c*l*h-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(f,", ").concat(p,", ").concat(d,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(c,";\n           wD += ").concat(i,") {\n          float dyD = float(dyDCorner + wD) / ").concat(n,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(l,";\n              wR += ").concat(o,") {\n            float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(h,";\n                wC += ").concat(u,") {\n              float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(m," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(l," * ").concat(h," +\n                  wR * ").concat(h," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var oB={kernelName:hc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,s=r.strides,u=r.pad,c=r.dimRoundingMode,l=Np(i.shape,o,s,[1,1,1],u,c),h=new hF(l,"max",!0),f=n.runWebGLProgram(h,[i],i.dtype),p=new iB(l),d=n.runWebGLProgram(p,[a,f],i.dtype);return n.disposeIntermediateTensorInfo(f),d}};var sB={kernelName:cc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;cD([i,t.output],"maxPoolGrad");var s=r.filterSize,u=r.strides,c=r.pad,l=r.dimRoundingMode,h=Ap(o.shape,s,u,1,c,l),f=new lF(h,"max",!0),p=n.runWebGLProgram(f,[o],o.dtype),d=new aB(h),m=n.runWebGLProgram(d,[a,p],o.dtype);return n.disposeIntermediateTensorInfo(p),m}};var uB={kernelName:fc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.filterSize,o=n.strides,s=n.pad,u=n.includeBatchInIndex,c=r;Ho(4===a.shape.length,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(a.shape.length,".")}));var l=[1,1];Ho(jp(o,l),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(l,"'")}));var h=Ap(a.shape,i,o,l,s),f=function(e,t,n,r){var a=new lF(n,"max",!1),i=r.runWebGLProgram(a,[e],"float32");return a=new lF(n,"max",!0,!0,t),[i,r.runWebGLProgram(a,[e],"float32")]}(a,u,h,c),p=Ct(f,2);return[p[0],p[1]]}};var cB={kernelName:pc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.keepDims,o=n.axis,s=r,u=a.shape.length,c=rs(o,a.shape),l=c,h=Wd(l,u),f=null!=h,p=s.shouldExecuteOnCPU([a]),d=[],m=a;if(f){if(p){for(var v=s.texData.get(m.dataId).values,g=new Array(u),y=0;y<g.length;y++)g[y]=a.shape[h[y]];var b=SR(v,a.shape,a.dtype,h,g);m=s.makeTensorInfo(g,a.dtype),s.texData.get(m.dataId).values=b}else m=TO(a,h,s);d.push(m),l=Hd(l.length,u)}Gd("sum",l,u);var k=Ct(jd(m.shape,l),2),x=k[0],w=k[1],_=x;i&&(_=qd(x,c));for(var S=function(e,t,n,r){var a=Qo(t),i=bO({inputs:{x:e},attrs:{shape:[Qo(e.shape)/a,a]},backend:r}),o=_O(i,"float32","mean",r),s=bO({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),s}(m,w,_,s),C=0,T=d;C<T.length;C++){y=T[C];s.disposeIntermediateTensorInfo(y)}return S}};var lB={kernelName:dc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,s=a.shape.length,u=rs(i,a.shape),c=u,l=Wd(c,s),h=a;null!=l&&(h=AO({inputs:{x:a},backend:n,attrs:{perm:l}}),c=Hd(c.length,a.shape.length)),Gd("min",c,s);var f,p=Ct(jd(h.shape,c),2),d=p[0],m=bO({inputs:{x:h},backend:n,attrs:{shape:[-1,Qo(p[1])]}}),v=_O(m,m.dtype,"min",n);return f=bO(o?{inputs:{x:v},backend:n,attrs:{shape:qd(d,u)}}:{inputs:{x:v},backend:n,attrs:{shape:d}}),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),null!=l&&n.disposeIntermediateTensorInfo(h),f}},hB=lO({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:fR}),fB={kernelName:mc,backendName:"webgl",kernelFunc:hB},pB=c((function e(t,n,r){s(this,e),this.variableNames=["x"],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=WD(a),o=n.map((function(e){return e[0]})).join(","),u=n.map((function(e,n){return e[0]+t[n]})).join(","),c=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a),l="reflect"===r?0:1;this.userCode=1!==a?"\n      ".concat(i," start = ").concat(i,"(").concat(o,");\n      ").concat(i," end = ").concat(i,"(").concat(u,");\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(a,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(l,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(l,";\n          }\n        }\n        ").concat(i," coords = outC - start;\n        setOutput(getX(").concat(c,"));\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(u,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(l,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(l,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ")})),dB=c((function e(t,n,r){s(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=WD(a),o=n.map((function(e){return e[0]})).join(","),u=n.map((function(e,n){return e[0]+t[n]})).join(","),c=ER("rc",a),l=ER("source",a),h="".concat(c[a-1]," < ").concat(this.outputShape[a-1]),f=1===a?"source":"vec2(".concat(l.slice(-2).join(),")"),p="reflect"===r?0:1,d="";if(1===a){var m="\n        ".concat(i," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(p,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(p,";\n        }\n        source -= start;\n      ");d="\n        ".concat(i," rc = outputLoc;\n        ").concat(m,"\n        result[0] = getChannel(getX(").concat(l.join(),"), ").concat(f,");\n        ").concat(c[a-1]," += 1;\n        if(").concat(h,") {\n          ").concat(m,"\n          result[1] = getChannel(getX(").concat(l.join(),"), ").concat(f,");\n        }\n      ")}else{var v="\n        ".concat(i," source = rc;\n        ").concat(i," lt = ").concat(i,"(lessThan(source, start));\n        ").concat(i," gte = ").concat(i,"(greaterThanEqual(source, end));\n        ").concat(i," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(p,") +\n                gte * ((end - 1) * 2 - source + ").concat(p,");\n        source -= start;\n      ");d="\n        ".concat(i," rc = outputLoc;\n        ").concat(v,"\n        result[0] = getChannel(getX(").concat(l.join(),"), ").concat(f,");\n        ").concat(c[a-1]," += 1;\n        if(").concat(h,") {\n          ").concat(v,"\n          result[1] = getChannel(getX(").concat(l.join(),"), ").concat(f,");\n        }\n        rc = outputLoc;\n        ").concat(c[a-2]," += 1;\n        if(").concat(c[a-2]," < ").concat(this.outputShape[a-2],") {\n          ").concat(v,"\n          result[2] = getChannel(getX(").concat(l.join(),"), ").concat(f,");\n          ").concat(c[a-1]," += 1;\n          if(").concat(h,") {\n            ").concat(v,"\n            result[3] = getChannel(getX(").concat(l.join(),"), ").concat(f,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(o,");\n      const ").concat(i," end = ").concat(i,"(").concat(u,");\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(d,"\n        setOutput(result);\n      }\n    ")})),mB={kernelName:vc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.mode,s=Is().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new dB(a.shape,i,o):new pB(a.shape,i,o);return n.runWebGLProgram(s,[a],a.dtype)}},vB=lO({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),gB={kernelName:gc,backendName:"webgl",kernelFunc:vB},yB=function(){function e(t,n,r){s(this,e),this.variableNames=["probs"],this.outputShape=[t,r],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(n-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(n-1,"));\n      }\n    ")}return c(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.seedLoc&&(t.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(t.seedLoc,e)}}}]),e}(),bB=lO({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),kB={kernelName:Cu,backendName:"webgl",kernelFunc:bB},xB="return a - b;",wB=lO({opSnippet:xB,packedOpSnippet:xB,supportsComplex:!0,cpuKernelImpl:xR}),_B={kernelName:sl,backendName:"webgl",kernelFunc:wB};function SB(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=rs([r.dim],a.shape),o=Jz({inputs:{x:a},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),s=qd(o.shape,i),u=bO({inputs:{x:o},backend:n,attrs:{shape:s}}),c=wB({inputs:{a:a,b:u},backend:n}),l=UL({inputs:{x:c},backend:n}),h=EO({inputs:{x:l},backend:n,attrs:{axis:i,keepDims:!1}}),f=bO({inputs:{x:h},backend:n,attrs:{shape:s}}),p=bB({inputs:{a:l,b:f},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),p}var CB={kernelName:al,backendName:"webgl",kernelFunc:SB};var TB={kernelName:yc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.numSamples,o=r.seed,s=r.normalized,u=s?a:SB({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),c=u.shape[0],l=u.shape[1],h=new yB(c,l,i),f=h.getCustomSetupFunc(o),p=n.runWebGLProgram(h,[u],"int32",f);return s||n.disposeIntermediateTensorInfo(u),p}},EB="return -x;";var IB={kernelName:kc,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=n.x;if(r.shouldExecuteOnCPU([a])){var i=r.texData.get(a.dataId),o=Ct(dR(i.values,a.shape,a.dtype),2),s=o[0],u=o[1];return r.makeTensorInfo(u,a.dtype,s)}return t=Is().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new HR(a.shape,EB):new RR(a.shape,EB),r.runWebGLProgram(t,[a],a.dtype)}},AB=sv;var NB={kernelName:wc,backendName:"webgl",kernelFunc:function(e){lg("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=n.readSync(a.dataId),l=n.readSync(i.dataId),h=AB(c,l,o,s,u).selectedIndices;return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}},PB=uv;var MB={kernelName:_c,backendName:"webgl",kernelFunc:function(e){lg("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.padToMaxOutputSize,l=n.readSync(a.dataId),h=n.readSync(i.dataId),f=PB(l,h,o,s,u,c),p=f.selectedIndices,d=f.validOutputs;return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([d]))]}},DB=cv;var RB={kernelName:Sc,backendName:"webgl",kernelFunc:function(e){lg("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.softNmsSigma,l=n.readSync(a.dataId),h=n.readSync(i.dataId),f=DB(l,h,o,s,u,c),p=f.selectedIndices,d=f.selectedScores;return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([d.length],"float32",new Float32Array(d))]}},OB=c((function e(t,n,r,a){s(this,e),this.variableNames=["indices"],this.outputShape=[t,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(a,"), float(").concat(r,"),\n                      float(index == coords.y)));\n      }\n    ")})),FB={kernelName:Tc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=r.depth,o=r.onValue,s=r.offValue,u=Qo(a.shape),c=new OB(u,i,o,s),l=bO({inputs:{x:a},backend:n,attrs:{shape:[u]}}),h=n.runWebGLProgram(c,[l],a.dtype);n.disposeIntermediateTensorInfo(l);var f=bO({inputs:{x:h},backend:n,attrs:{shape:[].concat(Fn(a.shape),[i])}});return n.disposeIntermediateTensorInfo(h),f}};function LB(e){var t=e.inputs,n=e.backend,r=t.x;if("complex64"===r.dtype){var a=PF({inputs:{input:r},backend:n}),i=LB({inputs:{x:a},backend:n}),o=HF({inputs:{input:r},backend:n}),s=LB({inputs:{x:o},backend:n}),u=tO({inputs:{real:i,imag:s},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}return nz({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}var zB={kernelName:yl,backendName:"webgl",kernelFunc:LB};var BB={kernelName:Cc,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n.x;if("string"===a.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===a.dtype){var i=PF({inputs:{input:a},backend:r}),o=e({inputs:{x:i},backend:r}),s=HF({inputs:{input:a},backend:r}),u=LB({inputs:{x:s},backend:r}),c=tO({inputs:{real:o,imag:u},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(u),c}return nz({attrs:{shape:a.shape,dtype:a.dtype,value:1},backend:r})}};var VB={kernelName:Ec,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.axis;if(1===t.length)return KL({inputs:{input:t[0]},backend:n,attrs:{dim:r}});var a=t[0].shape,i=t[0].dtype;t.forEach((function(e){Ko(a,e.shape,"All tensors passed to stack must have matching shapes"),Ho(i===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=[],s=QF({inputs:t.map((function(e){var t=KL({inputs:{input:e},backend:n,attrs:{dim:r}});return o.push(t),t})),backend:n,attrs:{axis:r}});return o.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),s}},jB=c((function e(t,n,r){s(this,e),this.variableNames=["x"],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=WD(a),o=n.map((function(e){return e[0]})).join(","),u=n.map((function(e,n){return e[0]+t[n]})).join(","),c=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);this.userCode=1!==a?"\n      ".concat(i," start = ").concat(i,"(").concat(o,");\n      ").concat(i," end = ").concat(i,"(").concat(u,");\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float(").concat(r,"));\n        } else {\n          ").concat(i," coords = outC - start;\n          setOutput(getX(").concat(c,"));\n        }\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(u,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float(").concat(r,"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")})),qB=c((function e(t,n,r){s(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));for(var a=t.length,i=WD(a),o=n.map((function(e){return e[0]})).join(","),u=n.map((function(e,n){return e[0]+t[n]})).join(","),c=ER("rc",a),l=ER("source",a),h="".concat(c[a-1]," < ").concat(this.outputShape[a-1]),f=1===a?"source":"vec2(".concat(l.slice(-2).join(),")"),p=["".concat(i," rc = outputLoc;"),"".concat(c[a-1]," += 1;\n       if(").concat(h,") {\n      "),1===a?"":"}\n       rc = outputLoc;\n       ".concat(c[a-2]," += 1;\n       if(").concat(c[a-2]," < ").concat(this.outputShape[a-2],") {"),1===a?"":"  ".concat(c[a-1]," += 1;\n         if(").concat(h,") {")],d=1===a?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",m="",v=0,g=1===a?2:4;v<g;v++)m+="\n        ".concat(p[v],"\n        if (").concat(d,") {\n          result[").concat(v,"] = float(").concat(r,");\n        } else {\n          ").concat(i," source = rc - start;\n          result[").concat(v,"] = getChannel(getX(").concat(l.join(),"), ").concat(f,");\n        }\n      ");m+=1===a?"} ":"}}",this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(o,");\n      const ").concat(i," end = ").concat(i,"(").concat(u,");\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(m,"\n        setOutput(result);\n      }\n    ")})),GB=function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.constantValue,s=Is().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new qB(a.shape,i,o):new jB(a.shape,i,o);return n.runWebGLProgram(s,[a],a.dtype)},WB={kernelName:Ic,backendName:"webgl",kernelFunc:GB},UB=lO({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),HB={kernelName:Ac,backendName:"webgl",kernelFunc:UB};var KB={kernelName:Pc,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.axis,s=a.keepDims,u=i.shape.length,c=[],l=rs(o,i.shape),h=l,f=Wd(h,u),p=i;if(null!=f&&(p=AO({inputs:{x:i},backend:r,attrs:{perm:f}}),h=Hd(h.length,u),c.push(p)),Gd("prod",h,u),r.shouldExecuteOnCPU([p])){var d=r.texData.get(p.dataId).values,m=mR(p.shape,p.dtype,d,h),v=m.outVals,g=m.outShape,y=m.outDtype;t=r.makeTensorInfo(g,y,v)}else{var b=Ct(jd(p.shape,h),2),k=b[0],x=Qo(b[1]),w=bO({inputs:{x:p},backend:r,attrs:{shape:[-1,x]}}),_=_O(w,rh(i.dtype),"prod",r);t=bO({inputs:{x:_},backend:r,attrs:{shape:k}}),c.push(w),c.push(_)}if(s){c.push(t);var S=qd(t.shape,l);t=bO({inputs:{x:t},backend:r,attrs:{shape:S}})}return c.forEach((function(e){return r.disposeIntermediateTensorInfo(e)})),t}},XB=function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.step,o=n.dtype,s=vR(r,a,i,o);return t.makeTensorInfo([s.length],o,s)},YB={kernelName:Mc,backendName:"webgl",kernelFunc:XB},QB=cO({opSnippet:"return 1.0 / x;"}),$B={kernelName:Rc,backendName:"webgl",kernelFunc:QB},JB=cO({opSnippet:"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),ZB={kernelName:Oc,backendName:"webgl",kernelFunc:JB},eV=cO({opSnippet:"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),tV={kernelName:jc,backendName:"webgl",kernelFunc:eV},nV=c((function e(t,n,r,a,i){s(this,e),this.variableNames=["A"],this.outputShape=[];var o=Ct(t,4),u=o[0],c=o[1],l=o[2],h=o[3];this.outputShape=[u,n,r,h];var f,p=[a&&n>1?c-1:c,a&&r>1?l-1:l],d=[a&&n>1?n-1:n,a&&r>1?r-1:r];f=i?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(p[0]/d[0],",\n          ").concat(p[1]/d[1],");\n      const vec2 inputShapeRC = vec2(").concat(c,".0, ").concat(l,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(f,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")})),rV=c((function e(t,n,r,a,i){s(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=Ct(t,4),u=o[0],c=o[1],l=o[2],h=o[3];this.outputShape=[u,n,r,h];var f,p=[a&&n>1?c-1:c,a&&r>1?l-1:l],d=[a&&n>1?n-1:n,a&&r>1?r-1:r];f=i?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(p[0]/d[0],",\n          ").concat(p[1]/d[1],",\n          ").concat(p[1]/d[1],");\n      const vec3 inputShapeRC = vec3(").concat(c,".0, ").concat(l,".0,\n                                     ").concat(l,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(f,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(h-1,";\n        bool hasNextRow = coords.z < ").concat(r-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")}));var aV={kernelName:Bc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,s=Ct(r.size,2),u=s[0],c=s[1],l=Is().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new rV(a.shape,u,c,i,o):new nV(a.shape,u,c,i,o);return n.runWebGLProgram(l,[a],"float32")}},iV=c((function e(t,n,r){s(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;var a=Ct(n,3),i=a[1],o=a[2],u=Ct(t,3),c=u[1],l=u[2],h=[r&&c>1?i-1:i,r&&l>1?o-1:o],f=[r&&c>1?c-1:c,r&&l>1?l-1:l],p=h[0]/f[0],d=h[1]/f[1],m=1/p,v=1/d,g=2*Math.ceil(m)+2,y=2*Math.ceil(v)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(p,");\n        const float widthScale = float(").concat(d,");\n\n        const float invHeightScale = float(").concat(m,");\n        const float invWidthScale = float(").concat(v,");\n\n        const int winHeight = int(").concat(g,");\n        const int winWidth = int(").concat(y,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(c,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(l,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(i-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(o-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}));var oV={kernelName:Vc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners,s=new iV(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}},sV=c((function e(t,n,r,a,i){s(this,e),this.variableNames=["A"],this.outputShape=[];var o=Ct(t,4),u=o[0],c=o[1],l=o[2],h=o[3];this.outputShape=[u,n,r,h];var f,p=[a&&n>1?c-1:c,a&&r>1?l-1:l],d=[a&&n>1?n-1:n,a&&r>1?r-1:r],m=a?"0.5":"0.0";f=i?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(p[0]/d[0],",\n          ").concat(p[1]/d[1],");\n      const vec2 inputShapeRC = vec2(").concat(c,".0, ").concat(l,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(f,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(m,")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")}));var uV={kernelName:Lc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,s=Ct(r.size,2),u=s[0],c=s[1],l=new sV(a.shape,u,c,i,o);return n.runWebGLProgram(l,[a],a.dtype)}},cV=c((function e(t,n,r){s(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;var a=Ct(n,3),i=a[1],o=a[2],u=Ct(t,3),c=u[1],l=u[2],h=[r&&c>1?i-1:i,r&&l>1?o-1:o],f=[r&&c>1?c-1:c,r&&l>1?l-1:l],p=h[0]/f[0],d=h[1]/f[1],m=1/p,v=1/d,g=2*Math.ceil(m)+2,y=2*Math.ceil(v)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(p,");\n        const float widthScale = float(").concat(d,");\n\n        const float invHeightScale = float(").concat(m,");\n        const float invWidthScale = float(").concat(v,");\n\n        const int winHeight = int(").concat(g,");\n        const int winWidth = int(").concat(y,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(c,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(l,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(h[0],") *\n                (float(dyR) / float(").concat(f[0],"));\n\n            float sourceFracCol =\n                float(").concat(h[1],") *\n                  (float(dyC) / float(").concat(f[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(i,") - 1),\n                ").concat(r," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(o,") - 1),\n                ").concat(r," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}));var lV={kernelName:zc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners,s=new cV(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}},hV=c((function e(t,n){s(this,e),this.variableNames=["x"];var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));if(this.outputShape=t,1!==r){var a=t.map((function(e,r){return function(e){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - coords[").concat(e,"] - 1"):"coords[".concat(e,"]")}(r)})).join(","),i=WD(r);this.userCode="\n      void main() {\n        ".concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(a,"));\n      }\n    ")}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(t[0]," - coord - 1));\n        }\n      ")})),fV=c((function e(t,n){s(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));this.outputShape=t;var a=ER("rc",r),i="".concat(a[r-1]," + 1 < ").concat(this.outputShape[r-1]),o="".concat(a[r-2]," + 1 < ").concat(this.outputShape[r-2]),u=WD(r);function c(e){var r=t.map((function(r,a){return function(e,r){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - ").concat(r[e]," - 1"):"".concat(r[e])}(a,e)})),a=r.join(","),i=r.slice(-2).join(",");return"getChannel(getX(".concat(a,"), vec2(").concat(i,"))")}this.userCode=1===r?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(t[0]," - rc - 1),\n            ").concat(t[0]," - rc - 1);\n          if(").concat(i,"){\n              result.g = getChannel(getX(").concat(t[0]," - (rc  + 1) - 1),\n                ").concat(t[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(u," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(function(e){return c(e)}(a.slice()),";\n          if(").concat(i,"){\n            result.g = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",c(e)}(a.slice()),";\n          }\n          if(").concat(o,") {\n            result.b = ").concat(function(e){return e[r-2]="("+e[r-2]+" + 1)",c(e)}(a.slice()),";\n            if(").concat(i,") {\n              result.a = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",e[r-2]="("+e[r-2]+" + 1)",c(e)}(a.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")}));var pV={kernelName:qc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.dims,o=a.shape.length,s=rs(i,a.shape);if(0===o)return ZR({inputs:{x:a},backend:n});var u=Is().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new fV(a.shape,s):new hV(a.shape,s);return n.runWebGLProgram(u,[a],a.dtype)}},dV=c((function e(t,n,r,a){s(this,e),this.variableNames=["Image"],this.outputShape=[];var i=t[1],o=t[2],u=Math.sin(n).toFixed(3),c=Math.cos(n).toFixed(3);this.outputShape=t;var l=Ct(Xv(a,i,o),2),h=l[0],f=l[1],p=h.toFixed(3),d=f.toFixed(3),m="";m="number"===typeof r?"float outputValue = ".concat(r.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(r.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - ".concat(p,") * ").concat(c," - (float(y) - ").concat(d,") * ").concat(u,";\n          float coordYFloat = (float(x) - ").concat(p,") * ").concat(u," + (float(y) - ").concat(d,") * ").concat(c,";\n          int coordX = int(round(coordXFloat + ").concat(p,"));\n          int coordY = int(round(coordYFloat + ").concat(d,"));\n          ").concat(m,"\n          if(coordX >= 0 && coordX < ").concat(o," && coordY >= 0 && coordY < ").concat(i,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")})),mV={kernelName:kl,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,i=n.radians,o=n.fillValue,s=n.center,u=r,c=new dV(a.shape,i,o,s);return u.runWebGLProgram(c,[a],a.dtype)}},vV=cO({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),gV={kernelName:Gc,backendName:"webgl",kernelFunc:vV},yV=cO({opSnippet:"return inversesqrt(x);",cpuKernelImpl:gR}),bV={kernelName:Wc,backendName:"webgl",kernelFunc:yV},kV=c((function e(t,n,r,a,i,o){s(this,e),this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var u=WD(i.length),c=WD(o.length),l="";1===r?l="i":2===r&&(l="i, j");var h="getIndices(".concat(l,")"),f="";1===a?f="i":2===a&&(f="i, coords[1]");var p="getUpdates(".concat(f,")"),d=n>1?"strides[j]":"strides";this.userCode="\n        ".concat(u," strides = ").concat(u,"(").concat(i,");\n\n        void main() {\n          ").concat(c," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(t,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(n,"; j++) {\n              int index = round(").concat(h,");\n              flattenedIndex += index * ").concat(d,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(p,";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      ")}));var xV={kernelName:Uc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=t.updates,o=r.shape,s=tg(0,a,o),u=s.sliceRank,c=s.numUpdates,l=s.sliceSize,h=s.strides,f=s.outputSize,p=[f/l,l];if(0===f)return n.makeTensorInfo(o,a.dtype);var d=bO({inputs:{x:a},backend:n,attrs:{shape:[c,u]}}),m=bO({inputs:{x:i},backend:n,attrs:{shape:[c,l]}}),v=n.makeTensorInfo([],"float32",new Float32Array([0])),g=new kV(c,u,d.shape.length,m.shape.length,h,p),y=n.runWebGLProgram(g,[m,d,v],m.dtype),b=bO({inputs:{x:y},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(v),b}},wV=c((function e(t,n,r){var a,i;if(s(this,e),this.variableNames=["c","a","b"],this.outputShape=n,r>4)throw Error("Where for rank ".concat(r," is not yet supported"));if(1===r)i="resRC",a="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],u=[],c=[],l=0;l<n.length;l++)c.push("".concat(o[l])),l<t&&u.push("".concat(o[l]));a=u.join(),i=c.join()}var h=WD(r);this.userCode="\n      void main() {\n        ".concat(h," resRC = getOutputCoords();\n        float cVal = getC(").concat(a,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(i,"));\n        } else {\n          setOutput(getB(").concat(i,"));\n        }\n      }\n    ")}));var _V={kernelName:Hc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.condition,a=t.t,i=t.e,o=new wV(r.shape.length,a.shape,a.shape.length);return n.runWebGLProgram(o,[r,a,i],nh(a.dtype,i.dtype))}},SV=cO({opSnippet:"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(ng,";\n  float scale = ").concat(rg,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n")}),CV={kernelName:Kc,backendName:"webgl",kernelFunc:SV},TV=cO({opSnippet:"return 1.0 / (1.0 + exp(-1.0 * x));"}),EV={kernelName:Jc,backendName:"webgl",kernelFunc:TV},IV=cO({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),AV={kernelName:$c,backendName:"webgl",kernelFunc:IV},NV=cO({opSnippet:"if (isnan(x)) return x;\n  return sin(x);\n"}),PV={kernelName:Yc,backendName:"webgl",kernelFunc:NV},MV=cO({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),DV={kernelName:Qc,backendName:"webgl",kernelFunc:MV},RV=cO({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),OV={kernelName:Zc,backendName:"webgl",kernelFunc:RV},FV={kernelName:nl,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.paddings;Ho(a.shape.length<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var s=i.reduce((function(e,t){return e*t})),u=[[0,0]];u.push.apply(u,Fn(o));for(var c=1+i.length;c<a.shape.length;++c)u.push([0,0]);var l=[],h=GB({inputs:{x:a},backend:n,attrs:{paddings:u,constantValue:0}}),f=Yv(h.shape,i,s,!1),p=Qv(f.length,i.length,!1),d=$v(h.shape,i,s,!1),m=bO({inputs:{x:h},backend:n,attrs:{shape:f}}),v=AO({inputs:{x:m},backend:n,attrs:{perm:p}}),g=bO({inputs:{x:v},backend:n,attrs:{shape:d}});return l.push(h),l.push(m),l.push(v),l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),g}};var LV={kernelName:ul,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.sparseIndices,i=t.sparseValues,o=t.defaultValue,s=r.outputShape,u=tg(0,a,s),c=u.sliceRank,l=u.numUpdates,h=u.strides,f=u.outputSize,p=new kV(l,c,a.shape.length,i.shape.length,h,[f,1],!1),d=n.runWebGLProgram(p,[i,a,o],i.dtype),m=bO({inputs:{x:d},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(d),m}};var zV={kernelName:rl,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.numOrSizeSplits,o=rs(r.axis,a.shape)[0],s=mg(a,i,o),u=a.shape.length,c=new Array(u).fill(0),l=a.shape.slice();return s.map((function(e){var t=Fn(l);t[o]=e;var r=CF({inputs:{x:a},backend:n,attrs:{begin:c,size:t}});return c[o]+=e,r}))}},BV=cO({opSnippet:"return sqrt(x);"}),VV={kernelName:el,backendName:"webgl",kernelFunc:BV},jV={kernelName:ol,backendName:"webgl",kernelFunc:cO({opSnippet:"return x * x;"})},qV="return (a - b) * (a - b);",GV=lO({opSnippet:qV,packedOpSnippet:qV}),WV={kernelName:il,backendName:"webgl",kernelFunc:GV};var UV={kernelName:bl,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=OR+"\n    return x > 0.0 ? 1.0 : float(".concat(n.alpha,");\n  "),o=new RR(a.shape,i);return r.runWebGLProgram(o,[a],a.dtype)}},HV=c((function e(t,n,r){s(this,e),this.variableNames=["x"],this.outputShape=r;var a=r.length,i=WD(r.length),o=WD(r.length),u="";if(1===a)u="coords * strides + begin";else{var c=0;u=r.map((function(e,t){return c++,1===r.length?"coords * strides[".concat(t,"] + begin[").concat(t,"]"):"coords[".concat(c-1,"] * strides[").concat(t,"] + begin[").concat(t,"]")})).join(",")}this.userCode="\n      ".concat(i," begin = ").concat(i,"(").concat(t,");\n      ").concat(i," strides = ").concat(i,"(").concat(n,");\n\n      void main() {\n        ").concat(o," coords = getOutputCoords();\n        setOutput(getX(").concat(u,"));\n      }\n    ")}));var KV={kernelName:cl,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.begin,s=a.end,u=a.strides,c=a.beginMask,l=a.endMask,h=a.ellipsisMask,f=a.newAxisMask,p=a.shrinkAxisMask,d=cp(i.shape,o,s,u,c,l,h,f,p),m=d.nonStrided,v=d.$begin,g=d.$strides,y=d.size,b=d.newShape,k=d.outShape,x=bO({inputs:{x:i},backend:r,attrs:{shape:b}});if(m){var w=CF({inputs:{x:x},backend:r,attrs:{begin:v,size:y}});t=bO({inputs:{x:w},backend:r,attrs:{shape:k}}),r.disposeIntermediateTensorInfo(w)}else if(k.some((function(e){return 0===e})))t=r.makeTensorInfo(k,i.dtype,[]);else{if(r.shouldExecuteOnCPU([x])){var _=r.texData.get(x.dataId).values,S=If(x.shape,x.dtype,_),C=kR(k,S,g,v);t=r.makeTensorInfo(k,x.dtype,C.values)}else{var T=new HV(v,g,k);t=r.runWebGLProgram(T,[x],x.dtype)}}var E=bO({inputs:{x:t},backend:r,attrs:{shape:k}});return r.disposeIntermediateTensorInfo(x),r.disposeIntermediateTensorInfo(t),E}},XV=cO({opSnippet:"return tan(x);"}),YV={kernelName:ll,backendName:"webgl",kernelFunc:XV},QV=cO({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),$V={kernelName:hl,backendName:"webgl",kernelFunc:QV},JV=c((function e(t,n){s(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[a]*n[a];this.outputShape=r,this.rank=r.length;var i=WD(this.rank),o=function(e){var t=e.length;if(t>5)throw Error("Tile for rank ".concat(t," is not yet supported"));if(1===t)return"imod(resRC, ".concat(e[0],")");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],a=0;a<e.length;a++)r.push("imod(".concat(n[a],", ").concat(e[a],")"));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(i," resRC = getOutputCoords();\n        setOutput(getA(").concat(o,"));\n      }\n    ")}));function ZV(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reps;if("string"===a.dtype){var o=n.readSync(a.dataId).map((function(e){return Wl(e)})),s=If(a.shape,a.dtype,o),u=wR(s,i);return n.makeTensorInfo(u.shape,u.dtype,u.values)}var c=new JV(a.shape,i);return n.runWebGLProgram(c,[a],a.dtype)}var ej={kernelName:fl,backendName:"webgl",kernelFunc:ZV};var tj={kernelName:pl,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.k,o=r.sorted,s=n.readSync(a.dataId),u=Ct(_R(s,a.shape,a.dtype,i,o),2),c=u[0],l=u[1];return[n.makeTensorInfo(c.shape,c.dtype,c.values),n.makeTensorInfo(l.shape,l.dtype,l.values)]}};var nj={kernelName:ml,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.axis,i=t.x;cD(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");var o=r.readSync(i.dataId),s=CR(o,a,i.shape,i.dtype),u=s.outputValues,c=s.outputShape,l=s.indices;return[r.makeTensorInfo(c,i.dtype,u),r.makeTensorInfo([l.length],"int32",l)]}};var rj={kernelName:vl,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.value,i=r.axis;i<0&&(i+=a.shape.length);for(var o=a,s=o.shape.length,u=a.shape[i],c=new Array(s-1),l=0,h=0;h<s;h++)h!==i&&(c[l++]=o.shape[h]);var f=[],p=new Array(s).fill(0),d=o.shape.slice();d[i]=1;for(var m=new Array(u),v=0;v<m.length;v++){p[i]=v;var g=CF({inputs:{x:o},backend:n,attrs:{begin:p,size:d}}),y=bO({inputs:{x:g},backend:n,attrs:{shape:c}});m[v]=y,f.push(g)}return f.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),m}},aj=c((function e(t,n){s(this,e),this.variableNames=["x","segmentIds"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.numSegments,u=o*Math.ceil(i/r);this.outputShape=[a,u];var c=4*Math.floor(r/4),l=r%4,h="\n        sumValue += dot(values, segFilter);\n    ",f="";i%r>0&&(f="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      "));var p="";i%r>0&&(p="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat("0.0",";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(f,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(p,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(o,")) * float(").concat(r,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(o,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(c,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(h,"\n        }\n\n        int inIdx = inOffset + ").concat(c,";\n        if (").concat(1===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(h,"\n        } else if (").concat(2===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(h,"\n        } else if (").concat(3===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(h,"\n        }\n        setOutput(").concat("sumValue",");\n      }\n    ")}));for(var ij={kernelName:gl,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.segmentIds,o=r.numSegments,s=a.shape.length,u=[],c=0,l=Wd([c],s),h=a;null!=l&&(h=AO({inputs:{x:a},backend:n,attrs:{perm:l}}),u.push(h),c=Hd(1,s)[0]);var f=function(e,t,n){for(var r=[],a=e.length,i=0;i<a;i++)i!==t?r.push(e[i]):r.push(n);return r}(h.shape,c,o),p=Qo([h.shape[c]]),d=bO({inputs:{x:h},backend:n,attrs:{shape:[-1,p]}});u.push(d);var m=function e(t,r,a,i,o){var s=t.shape[0],c=t.shape[1],l=function(e,t){var n,r=!1;for(e<=30?(n=e,r=!0):n=ds(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=ds(e,n+1);return n}(c,o),h=new aj({windowSize:l,inSize:c,batchSize:s,numSegments:o},r),f=n.compileAndRun(h,[t,a],i);if(u.push(f),f.shape[1]===o)return f;var p=XB({backend:n,attrs:{start:0,stop:o,step:1,dtype:"float32"}}),d=ZV({inputs:{x:p},backend:n,attrs:{reps:[c/l]}});return u.push(p),u.push(d),e(f,r,d,i,o)}(d,"unsortedSegmentSum",i,rh(a.dtype),o),v=bO({inputs:{x:m},backend:n,attrs:{shape:f}}),g=v;if(null!=l){u.push(v);var y=Ud(l);g=AO({inputs:{x:g},backend:n,attrs:{perm:y}})}return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),g}},oj=0,sj=[Yz,$z,MO,RO,FO,zO,jO,WO,UO,HO,JO,ZO,tF,rF,sF,iF,cF,pF,fF,vF,gF,yF,xF,EF,IF,DF,FF,BF,qF,nO,$F,uL,cL,rL,hL,fL,lL,dL,vL,yL,wL,_L,CL,PL,ML,IL,RL,FL,zL,BL,jL,GL,HL,XL,$L,ez,az,oz,cz,hz,dz,mz,vz,yz,kz,wz,Sz,eO,Cz,KF,Ez,Az,Pz,iO,Dz,Oz,Fz,Vz,zz,qz,Wz,Hz,Zz,rB,nB,oB,sB,uB,tB,cB,lB,fB,mB,gB,TB,yO,IB,NB,MB,RB,NF,FB,BB,VB,WB,HB,uO,KB,YB,MF,kB,$B,tV,ZB,kO,aV,oV,uV,lV,pV,mV,gV,bV,xV,_V,CV,EV,AV,PV,DV,TF,CB,OV,FV,LV,zV,VV,jV,WV,UV,KV,_B,IO,YV,$V,ej,tj,NO,nj,rj,ij,zB];oj<sj.length;oj++){Il(sj[oj])}var uj="C C# Db D D# Eb E F F# Gb G G# Ab A A# Bb B".split(" "),cj=function(e){return"string"!==typeof e?uj.slice():uj.filter((function(t){var n=t[1]||" ";return-1!==e.indexOf(n)}))},lj=(cj(" #"),cj(" b"),/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/);var hj=Object.freeze({pc:null,name:null,step:null,alt:null,oct:null,octStr:null,chroma:null,midi:null,freq:null}),fj=[0,2,4,5,7,9,11],pj=function(e,t){return void 0===t&&(t={}),function(n){return t[n]||(t[n]=e(n))}}((function(e){var t=function(e){"string"!==typeof e&&(e="");var t=lj.exec(e);return[t[1].toUpperCase(),t[2].replace(/x/g,"##"),t[3],t[4]]}(e);if(""===t[0]||""!==t[3])return hj;var n=t[0],r=t[1],a=t[2],i={letter:n,acc:r,octStr:a,pc:n+r,name:n+r+a,step:(n.charCodeAt(0)+3)%7,alt:"b"===r[0]?-r.length:r.length,oct:a.length?+a:null,chroma:0,midi:null,freq:null};return i.chroma=(fj[i.step]+i.alt+120)%12,i.midi=null!==i.oct?fj[i.step]+i.alt+12*(i.oct+1):null,i.freq=dj(i.midi),Object.freeze(i)})),dj=function(e,t){return void 0===t&&(t=440),"number"===typeof e?Math.pow(2,(e-69)/12)*t:null};Math.log(2),Math.log(440);var mj=new RegExp("^([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})|(AA|A|P|M|m|d|dd)([-+]?\\d+)$"),vj=[0,2,4,5,7,9,11],gj="PMMPPMM",yj=("1P 2m 2M 3m 3M 4P 5P 6m 6M 7m 7M 8P".split(" "),Object.freeze({name:null,num:null,q:null,step:null,alt:null,dir:null,type:null,simple:null,semitones:null,chroma:null,oct:null})),bj=function(e){return(Math.abs(e)-1)%7},kj=function(e){var t=function(e){var t=mj.exec(""+e);return null===t?null:t[1]?[t[1],t[2]]:[t[4],t[3]]}(e);if(null===t)return yj;var n,r,a={num:0,q:"d",name:"",type:"M",step:0,dir:-1,simple:1,alt:0,oct:0,semitones:0,chroma:0,ic:0};return a.num=+t[0],a.q=t[1],a.step=bj(a.num),a.type=gj[a.step],"M"===a.type&&"P"===a.q?yj:(a.name=""+a.num+a.q,a.dir=a.num<0?-1:1,a.simple=8===a.num||-8===a.num?a.num:a.dir*(a.step+1),a.alt=(n=a.type,"M"===(r=a.q)&&"M"===n||"P"===r&&"P"===n?0:"m"===r&&"M"===n?-1:/^A+$/.test(r)?r.length:/^d+$/.test(r)?"P"===n?-r.length:-r.length-1:null),a.oct=Math.floor((Math.abs(a.num)-1)/7),a.semitones=a.dir*(vj[a.step]+a.alt+12*a.oct),a.chroma=(a.dir*(vj[a.step]+a.alt)%12+12)%12,Object.freeze(a))},xj={};function wj(e){return"string"!==typeof e?yj:xj[e]||(xj[e]=kj(e))}"P m M m M P d P m M m M".split(" ");var _j=[0,2,4,-1,1,3,5],Sj=_j.map((function(e){return Math.floor(7*e/12)}));var Cj=function(e){return function(e,t){return void 0===t&&(t={}),function(n){return t[n]||(t[n]=e(n))}}((function(t){var n=e(t);return null===n.name?null:function(e){var t=e.step,n=e.alt,r=e.oct,a=e.dir;void 0===a&&(a=1);var i=_j[t]+7*n;return null===r?[a*i]:[a*i,a*(r-Sj[t]-4*n)]}(n)}))};Cj(pj),Cj(wj);var Tj=JSON.parse('{"chromatic":["1P 2m 2M 3m 3M 4P 4A 5P 6m 6M 7m 7M"],"lydian":["1P 2M 3M 4A 5P 6M 7M"],"major":["1P 2M 3M 4P 5P 6M 7M",["ionian"]],"mixolydian":["1P 2M 3M 4P 5P 6M 7m",["dominant"]],"dorian":["1P 2M 3m 4P 5P 6M 7m"],"aeolian":["1P 2M 3m 4P 5P 6m 7m",["minor"]],"phrygian":["1P 2m 3m 4P 5P 6m 7m"],"locrian":["1P 2m 3m 4P 5d 6m 7m"],"melodic minor":["1P 2M 3m 4P 5P 6M 7M"],"melodic minor second mode":["1P 2m 3m 4P 5P 6M 7m"],"lydian augmented":["1P 2M 3M 4A 5A 6M 7M"],"lydian dominant":["1P 2M 3M 4A 5P 6M 7m",["lydian b7"]],"melodic minor fifth mode":["1P 2M 3M 4P 5P 6m 7m",["hindu","mixolydian b6M"]],"locrian #2":["1P 2M 3m 4P 5d 6m 7m",["half-diminished"]],"altered":["1P 2m 3m 3M 5d 6m 7m",["super locrian","diminished whole tone","pomeroy"]],"harmonic minor":["1P 2M 3m 4P 5P 6m 7M"],"phrygian dominant":["1P 2m 3M 4P 5P 6m 7m",["spanish","phrygian major"]],"half-whole diminished":["1P 2m 3m 3M 4A 5P 6M 7m",["dominant diminished"]],"diminished":["1P 2M 3m 4P 5d 6m 6M 7M",["whole-half diminished"]],"major pentatonic":["1P 2M 3M 5P 6M",["pentatonic"]],"lydian pentatonic":["1P 3M 4A 5P 7M",["chinese"]],"mixolydian pentatonic":["1P 3M 4P 5P 7m",["indian"]],"locrian pentatonic":["1P 3m 4P 5d 7m",["minor seven flat five pentatonic"]],"minor pentatonic":["1P 3m 4P 5P 7m"],"minor six pentatonic":["1P 3m 4P 5P 6M"],"minor hexatonic":["1P 2M 3m 4P 5P 7M"],"flat three pentatonic":["1P 2M 3m 5P 6M",["kumoi"]],"flat six pentatonic":["1P 2M 3M 5P 6m"],"major flat two pentatonic":["1P 2m 3M 5P 6M"],"whole tone pentatonic":["1P 3M 5d 6m 7m"],"ionian pentatonic":["1P 3M 4P 5P 7M"],"lydian #5P pentatonic":["1P 3M 4A 5A 7M"],"lydian dominant pentatonic":["1P 3M 4A 5P 7m"],"minor #7M pentatonic":["1P 3m 4P 5P 7M"],"super locrian pentatonic":["1P 3m 4d 5d 7m"],"in-sen":["1P 2m 4P 5P 7m"],"iwato":["1P 2m 4P 5d 7m"],"hirajoshi":["1P 2M 3m 5P 6m"],"kumoijoshi":["1P 2m 4P 5P 6m"],"pelog":["1P 2m 3m 5P 6m"],"vietnamese 1":["1P 3m 4P 5P 6m"],"vietnamese 2":["1P 3m 4P 5P 7m"],"prometheus":["1P 2M 3M 4A 6M 7m"],"prometheus neopolitan":["1P 2m 3M 4A 6M 7m"],"ritusen":["1P 2M 4P 5P 6M"],"scriabin":["1P 2m 3M 5P 6M"],"piongio":["1P 2M 4P 5P 6M 7m"],"major blues":["1P 2M 3m 3M 5P 6M"],"minor blues":["1P 3m 4P 5d 5P 7m",["blues"]],"composite blues":["1P 2M 3m 3M 4P 5d 5P 6M 7m"],"augmented":["1P 2A 3M 5P 5A 7M"],"augmented heptatonic":["1P 2A 3M 4P 5P 5A 7M"],"dorian #4":["1P 2M 3m 4A 5P 6M 7m"],"lydian diminished":["1P 2M 3m 4A 5P 6M 7M"],"whole tone":["1P 2M 3M 4A 5A 7m"],"leading whole tone":["1P 2M 3M 4A 5A 7m 7M"],"lydian minor":["1P 2M 3M 4A 5P 6m 7m"],"locrian major":["1P 2M 3M 4P 5d 6m 7m",["arabian"]],"neopolitan":["1P 2m 3m 4P 5P 6m 7M"],"neopolitan minor":["1P 2m 3m 4P 5P 6m 7M"],"neopolitan major":["1P 2m 3m 4P 5P 6M 7M",["dorian b2"]],"neopolitan major pentatonic":["1P 3M 4P 5d 7m"],"romanian minor":["1P 2M 3m 5d 5P 6M 7m"],"double harmonic lydian":["1P 2m 3M 4A 5P 6m 7M"],"harmonic major":["1P 2M 3M 4P 5P 6m 7M"],"double harmonic major":["1P 2m 3M 4P 5P 6m 7M",["gypsy"]],"egyptian":["1P 2M 4P 5P 7m"],"hungarian minor":["1P 2M 3m 4A 5P 6m 7M"],"hungarian major":["1P 2A 3M 4A 5P 6M 7m"],"oriental":["1P 2m 3M 4P 5d 6M 7m"],"spanish heptatonic":["1P 2m 3m 3M 4P 5P 6m 7m"],"flamenco":["1P 2m 3m 3M 4A 5P 7m"],"balinese":["1P 2m 3m 4P 5P 6m 7M"],"todi raga":["1P 2m 3m 4A 5P 6m 7M"],"malkos raga":["1P 3m 4P 6m 7m"],"kafi raga":["1P 3m 3M 4P 5P 6M 7m 7M"],"purvi raga":["1P 2m 3M 4P 4A 5P 6m 7M"],"persian":["1P 2m 3M 4P 5d 6m 7M"],"bebop":["1P 2M 3M 4P 5P 6M 7m 7M"],"bebop dominant":["1P 2M 3M 4P 5P 6M 7m 7M"],"bebop minor":["1P 2M 3m 3M 4P 5P 6M 7m"],"bebop major":["1P 2M 3M 4P 5P 5A 6M 7M"],"bebop locrian":["1P 2m 3m 4P 5d 5P 6m 7m"],"minor bebop":["1P 2M 3m 4P 5P 6m 7m 7M"],"mystery #1":["1P 2m 3M 5d 6m 7m"],"enigmatic":["1P 2m 3M 5d 6m 7m 7M"],"minor six diminished":["1P 2M 3m 4P 5P 6m 6M 7M"],"ionian augmented":["1P 2M 3M 4P 5A 6M 7M"],"lydian #9":["1P 2m 3M 4A 5P 6M 7M"],"ichikosucho":["1P 2M 3M 4P 5d 5P 6M 7M"],"six tone symmetric":["1P 2m 3M 4P 5A 6M"]}'),Ej=JSON.parse('{"4":["1P 4P 7m 10m",["quartal"]],"5":["1P 5P"],"7":["1P 3M 5P 7m",["Dominant","Dom"]],"9":["1P 3M 5P 7m 9M",["79"]],"11":["1P 5P 7m 9M 11P"],"13":["1P 3M 5P 7m 9M 13M",["13_"]],"64":["5P 8P 10M"],"M":["1P 3M 5P",["Major",""]],"M#5":["1P 3M 5A",["augmented","maj#5","Maj#5","+","aug"]],"M#5add9":["1P 3M 5A 9M",["+add9"]],"M13":["1P 3M 5P 7M 9M 13M",["maj13","Maj13"]],"M13#11":["1P 3M 5P 7M 9M 11A 13M",["maj13#11","Maj13#11","M13+4","M13#4"]],"M6":["1P 3M 5P 13M",["6"]],"M6#11":["1P 3M 5P 6M 11A",["M6b5","6#11","6b5"]],"M69":["1P 3M 5P 6M 9M",["69"]],"M69#11":["1P 3M 5P 6M 9M 11A"],"M7#11":["1P 3M 5P 7M 11A",["maj7#11","Maj7#11","M7+4","M7#4"]],"M7#5":["1P 3M 5A 7M",["maj7#5","Maj7#5","maj9#5","M7+"]],"M7#5sus4":["1P 4P 5A 7M"],"M7#9#11":["1P 3M 5P 7M 9A 11A"],"M7add13":["1P 3M 5P 6M 7M 9M"],"M7b5":["1P 3M 5d 7M"],"M7b6":["1P 3M 6m 7M"],"M7b9":["1P 3M 5P 7M 9m"],"M7sus4":["1P 4P 5P 7M"],"M9":["1P 3M 5P 7M 9M",["maj9","Maj9"]],"M9#11":["1P 3M 5P 7M 9M 11A",["maj9#11","Maj9#11","M9+4","M9#4"]],"M9#5":["1P 3M 5A 7M 9M",["Maj9#5"]],"M9#5sus4":["1P 4P 5A 7M 9M"],"M9b5":["1P 3M 5d 7M 9M"],"M9sus4":["1P 4P 5P 7M 9M"],"Madd9":["1P 3M 5P 9M",["2","add9","add2"]],"Maj7":["1P 3M 5P 7M",["maj7","M7"]],"Mb5":["1P 3M 5d"],"Mb6":["1P 3M 13m"],"Msus2":["1P 2M 5P",["add9no3","sus2"]],"Msus4":["1P 4P 5P",["sus","sus4"]],"Maddb9":["1P 3M 5P 9m"],"11b9":["1P 5P 7m 9m 11P"],"13#11":["1P 3M 5P 7m 9M 11A 13M",["13+4","13#4"]],"13#9":["1P 3M 5P 7m 9A 13M",["13#9_"]],"13#9#11":["1P 3M 5P 7m 9A 11A 13M"],"13b5":["1P 3M 5d 6M 7m 9M"],"13b9":["1P 3M 5P 7m 9m 13M"],"13b9#11":["1P 3M 5P 7m 9m 11A 13M"],"13no5":["1P 3M 7m 9M 13M"],"13sus4":["1P 4P 5P 7m 9M 13M",["13sus"]],"69#11":["1P 3M 5P 6M 9M 11A"],"7#11":["1P 3M 5P 7m 11A",["7+4","7#4","7#11_","7#4_"]],"7#11b13":["1P 3M 5P 7m 11A 13m",["7b5b13"]],"7#5":["1P 3M 5A 7m",["+7","7aug","aug7"]],"7#5#9":["1P 3M 5A 7m 9A",["7alt","7#5#9_","7#9b13_"]],"7#5b9":["1P 3M 5A 7m 9m"],"7#5b9#11":["1P 3M 5A 7m 9m 11A"],"7#5sus4":["1P 4P 5A 7m"],"7#9":["1P 3M 5P 7m 9A",["7#9_"]],"7#9#11":["1P 3M 5P 7m 9A 11A",["7b5#9"]],"7#9#11b13":["1P 3M 5P 7m 9A 11A 13m"],"7#9b13":["1P 3M 5P 7m 9A 13m"],"7add6":["1P 3M 5P 7m 13M",["67","7add13"]],"7b13":["1P 3M 7m 13m"],"7b5":["1P 3M 5d 7m"],"7b6":["1P 3M 5P 6m 7m"],"7b9":["1P 3M 5P 7m 9m"],"7b9#11":["1P 3M 5P 7m 9m 11A",["7b5b9"]],"7b9#9":["1P 3M 5P 7m 9m 9A"],"7b9b13":["1P 3M 5P 7m 9m 13m"],"7b9b13#11":["1P 3M 5P 7m 9m 11A 13m",["7b9#11b13","7b5b9b13"]],"7no5":["1P 3M 7m"],"7sus4":["1P 4P 5P 7m",["7sus"]],"7sus4b9":["1P 4P 5P 7m 9m",["susb9","7susb9","7b9sus","7b9sus4","phryg"]],"7sus4b9b13":["1P 4P 5P 7m 9m 13m",["7b9b13sus4"]],"9#11":["1P 3M 5P 7m 9M 11A",["9+4","9#4","9#11_","9#4_"]],"9#11b13":["1P 3M 5P 7m 9M 11A 13m",["9b5b13"]],"9#5":["1P 3M 5A 7m 9M",["9+"]],"9#5#11":["1P 3M 5A 7m 9M 11A"],"9b13":["1P 3M 7m 9M 13m"],"9b5":["1P 3M 5d 7m 9M"],"9no5":["1P 3M 7m 9M"],"9sus4":["1P 4P 5P 7m 9M",["9sus"]],"m":["1P 3m 5P"],"m#5":["1P 3m 5A",["m+","mb6"]],"m11":["1P 3m 5P 7m 9M 11P",["_11"]],"m11A 5":["1P 3m 6m 7m 9M 11P"],"m11b5":["1P 3m 7m 12d 2M 4P",["h11","_11b5"]],"m13":["1P 3m 5P 7m 9M 11P 13M",["_13"]],"m6":["1P 3m 4P 5P 13M",["_6"]],"m69":["1P 3m 5P 6M 9M",["_69"]],"m7":["1P 3m 5P 7m",["minor7","_","_7"]],"m7#5":["1P 3m 6m 7m"],"m7add11":["1P 3m 5P 7m 11P",["m7add4"]],"m7b5":["1P 3m 5d 7m",["half-diminished","h7","_7b5"]],"m9":["1P 3m 5P 7m 9M",["_9"]],"m9#5":["1P 3m 6m 7m 9M"],"m9b5":["1P 3m 7m 12d 2M",["h9","-9b5"]],"mMaj7":["1P 3m 5P 7M",["mM7","_M7"]],"mMaj7b6":["1P 3m 5P 6m 7M",["mM7b6"]],"mM9":["1P 3m 5P 7M 9M",["mMaj9","-M9"]],"mM9b6":["1P 3m 5P 6m 7M 9M",["mMaj9b6"]],"mb6M7":["1P 3m 6m 7M"],"mb6b9":["1P 3m 6m 9m"],"o":["1P 3m 5d",["mb5","dim"]],"o7":["1P 3m 5d 13M",["diminished","m6b5","dim7"]],"o7M7":["1P 3m 5d 6M 7M"],"oM7":["1P 3m 5d 7M"],"sus24":["1P 2M 4P 5P",["sus4add9"]],"+add#9":["1P 3M 5A 9A"],"madd4":["1P 3m 4P 5P"],"madd9":["1P 3m 5P 9M"]}'),Ij=function(e){return function(e){return pj(e).chroma}(e)||function(e){return wj(e).chroma}(e)||0};function Aj(e){if(Pj(e))return e;if(!Array.isArray(e))return"";var t=[0,0,0,0,0,0,0,0,0,0,0,0];return e.map(Ij).forEach((function(e){t[e]=1})),t.join("")}var Nj=/^[01]{12}$/;function Pj(e){return Nj.test(e)}"1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M".split(" ");var Mj=function(e){var t=Object.keys(e).sort(),n=[],r=[],a=function(e,t,a){n[e]=t,r[a]=r[a]||[],r[a].push(e)};t.forEach((function(t){var n=e[t][0].split(" "),r=e[t][1],i=Aj(n);a(t,n,i),r&&r.forEach((function(e){return a(e,n,i)}))}));var i=Object.keys(n).sort(),o=function(e){return n[e]};return o.names=function(e){return"string"===typeof e?(r[e]||[]).slice():(!0===e?i:t).slice()},o},Dj=Mj(Tj),Rj=Mj(Ej),Oj=(function(e,t){var n=function(n){return e(n)||t(n)};n.names=function(n){return e.names(n).concat(t.names(n))}}(Dj,Rj),Object.freeze({name:null,intervals:[],names:[],chroma:null,setnum:null}));Dj.names;Rj.names;var Fj=Object.freeze({name:null,names:[],intervals:[],chroma:null,setnum:null});!function(e,t){void 0===t&&(t={})}((function(e){var t=Rj(e);if(!t)return Fj;var n={intervals:t,name:e};return n.chroma=Aj(t),n.setnum=parseInt(n.chroma,2),n.names=Rj.names(n.chroma),n}));var Lj,zj=120,Bj=[0,1,2,3,4,5,6,7,8,10,11,12,13,14,15],Vj=[[36,35],[38,27,28,31,32,33,34,37,39,40,56,65,66,75,85],[42,44,54,68,69,70,71,73,78,80],[46,67,72,74,79,81],[45,29,41,61,64,84],[48,47,60,63,77,86,87],[50,30,43,62,76,83],[49,55,57,58],[51,52,53,59,82]];!function(e){e[e.Major=0]="Major",e[e.Minor=1]="Minor",e[e.Augmented=2]="Augmented",e[e.Diminished=3]="Diminished",e[e.Other=4]="Other"}(Lj||(Lj={}));Error,Error;var jj=__webpack_require__(5842).tensorflow.magenta.NoteSequence;var qj=function(){if("undefined"!==typeof globalThis)return globalThis;if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof __webpack_require__.g)return __webpack_require__.g;throw new Error("cannot find the global object")}(),Gj=(qj.fetch.bind(qj),qj.performance,qj.navigator,!!qj.webkitOfflineAudioContext),Wj="undefined"!==typeof qj.WorkerGlobalScope;var Uj,Hj="undefined"!==typeof __webpack_require__.g&&"undefined"!==typeof __webpack_require__.g.process,Kj=Hj?__webpack_require__(5359):window.fetch.bind(window),Xj=Hj?__webpack_require__(6075):window.performance;Hj?__webpack_require__(4309):window.navigator;!function(e){e[e.NONE=0]="NONE",e[e.WARN=5]="WARN",e[e.INFO=10]="INFO",e[e.DEBUG=20]="DEBUG"}(Uj||(Uj={}));function Yj(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Magenta.js",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;if(0===n)throw Error("Logging level cannot be NONE.");if(10>=n){var r=5===n?console.warn:console.log;r("%c ".concat(t," "),"background:magenta; color:white",e)}}function Qj(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Magenta.js",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,a=(Xj.now()-t)/1e3;Yj("".concat(e," in ").concat(a.toPrecision(3),"s"),n,r)}Error,Error,Error;var $j=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),r=t.call(this,e),Object.setPrototypeOf(m(r),(this instanceof n?this.constructor:void 0).prototype),r}return c(n)}(fk(Error)),Jj=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),r=t.call(this,e),Object.setPrototypeOf(m(r),(this instanceof n?this.constructor:void 0).prototype),r}return c(n)}(fk(Error));function Zj(e){return jj.decode(jj.encode(e).finish())}function eq(e){return e.controlChanges.concat(e.textAnnotations)}function tq(e){if(e.tempos&&0!==e.tempos.length){if(e.tempos.sort((function(e,t){return e.time-t.time})),0!==e.tempos[0].time&&e.tempos[0].qpm!==zj)throw new $j("NoteSequence has an implicit tempo change from initial "+"".concat(zj," qpm to ")+"".concat(e.tempos[0].qpm," qpm at ").concat(e.tempos[0].time," seconds."));for(var t=1;t<e.tempos.length;t++)if(e.tempos[t].qpm!==e.tempos[0].qpm)throw new $j("NoteSequence has at least one tempo change from "+"".concat(e.tempos[0].qpm," qpm to ").concat(e.tempos[t].qpm)+"qpm at ".concat(e.tempos[t].time," seconds."))}}function nq(e){return e.quantizationInfo&&(e.quantizationInfo.stepsPerQuarter>0||e.quantizationInfo.stepsPerSecond>0)}function rq(e,t){!function(e){if(!function(e){return e.quantizationInfo&&e.quantizationInfo.stepsPerQuarter>0}(e))throw new Jj("NoteSequence ".concat(e.id," is not quantized or is quantized based on absolute timing"))}(e),tq(e);var n=Zj(e);t?n.tempos&&n.tempos.length>0?n.tempos[0].qpm=t:n.tempos.push(jj.Tempo.create({time:0,qpm:t})):t=e.tempos&&e.tempos.length>0?n.tempos[0].qpm:zj;var r=function(e){return e/n.quantizationInfo.stepsPerQuarter*(60/t)};return n.totalTime=r(n.totalQuantizedSteps),n.notes.forEach((function(e){e.startTime=r(e.quantizedStartStep),e.endTime=r(e.quantizedEndStep),n.totalTime=Math.max(n.totalTime,e.endTime),delete e.quantizedStartStep,delete e.quantizedEndStep})),eq(n).forEach((function(e){e.time=r(e.time)})),delete n.totalQuantizedSteps,delete n.quantizationInfo,n}var aq="14.7.77",iq=__webpack_require__(8667),oq=new WeakSet,sq=new WeakMap,uq=new WeakMap,cq=new WeakMap,lq=new WeakMap,hq=new WeakMap,fq=new WeakMap,pq=new WeakMap,dq=new WeakMap,mq=new WeakMap,vq={construct:function(){return vq}},gq=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,yq=function(e,t){for(var n=[],r=e.replace(/^[\s]+/,""),a=r.match(gq);null!==a;){var i=a[1].slice(1,-1),o=a[0].replace(/([\s]+)?;?$/,"").replace(i,new URL(i,t).toString());n.push(o),a=(r=r.slice(a[0].length).replace(/^[\s]+/,"")).match(gq)}return[n.join(";"),r]},bq=function(e){if(void 0!==e&&!Array.isArray(e))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},kq=function(e){if(!function(e){try{new new Proxy(e,vq)}catch(t){return!1}return!0}(e))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===e.prototype||"object"!==typeof e.prototype)throw new TypeError("The given value for processorCtor should have a prototype.")},xq=function(e,t){var n=e.get(t);if(void 0===n)throw new Error("A value with the given key could not be found.");return n},wq=function(e,t){var n=Array.from(e).filter(t);if(n.length>1)throw Error("More than one element was found.");if(0===n.length)throw Error("No element was found.");var r=Ct(n,1)[0];return e.delete(r),r},_q=function(e,t,n,r){var a=xq(e,t),i=wq(a,(function(e){return e[0]===n&&e[1]===r}));return 0===a.size&&e.delete(t),i},Sq=function(e){return xq(fq,e)},Cq=function(e){if(oq.has(e))throw new Error("The AudioNode is already stored.");oq.add(e),Sq(e).forEach((function(e){return e(!0)}))},Tq=function(e){return"port"in e},Eq=function(e){if(!oq.has(e))throw new Error("The AudioNode is not stored.");oq.delete(e),Sq(e).forEach((function(e){return e(!1)}))},Iq=function(e,t){!Tq(e)&&t.every((function(e){return 0===e.size}))&&Eq(e)};function Aq(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Nq(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Aq(Object(n),!0).forEach((function(t){ot(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Aq(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Pq={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},Mq=function(e,t){return e.context===t},Dq=function(e){try{e.copyToChannel(new Float32Array(1),0,-1)}catch(t){return!1}return!0},Rq=function(){return new DOMException("","IndexSizeError")},Oq=function(e){var t;e.getChannelData=(t=e.getChannelData,function(n){try{return t.call(e,n)}catch(ZJ){if(12===ZJ.code)throw Rq();throw ZJ}})},Fq={numberOfChannels:1},Lq=-34028234663852886e22,zq=-Lq,Bq=function(e){return oq.has(e)},Vq={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},jq=function(e){return xq(sq,e)},qq=function(e){return xq(cq,e)},Gq=function e(t,n){jq(t).activeInputs.forEach((function(r){return r.forEach((function(r){var a=Ct(r,1)[0];n.includes(t)||e(a,[].concat(Fn(n),[t]))}))}));var r,a=zo(function(e){return"playbackRate"in e}(t)?[t.playbackRate]:Tq(t)?Array.from(t.parameters.values()):function(e){return"frequency"in e&&"gain"in e}(t)?[t.Q,t.detune,t.frequency,t.gain]:function(e){return"offset"in e}(t)?[t.offset]:function(e){return!("frequency"in e)&&"gain"in e}(t)?[t.gain]:function(e){return"detune"in e&&"frequency"in e}(t)?[t.detune,t.frequency]:function(e){return"pan"in e}(t)?[t.pan]:[]);try{for(a.s();!(r=a.n()).done;){var i=r.value,o=qq(i);void 0!==o&&o.activeInputs.forEach((function(t){var r=Ct(t,1)[0];return e(r,n)}))}}catch(ZJ){a.e(ZJ)}finally{a.f()}Bq(t)&&Eq(t)},Wq=function(e){Gq(e.destination,[])},Uq=function(e){return void 0===e||"number"===typeof e||"string"===typeof e&&("balanced"===e||"interactive"===e||"playback"===e)},Hq=function(e){return"context"in e},Kq=function(e){return Hq(e[0])},Xq=function(e,t,n,r){var a,i=zo(e);try{for(i.s();!(a=i.n()).done;){if(n(a.value)){if(r)return!1;throw Error("The set contains at least one similar element.")}}}catch(ZJ){i.e(ZJ)}finally{i.f()}return e.add(t),!0},Yq=function(e,t,n,r){var a=Ct(n,2),i=a[0],o=a[1];Xq(e,[t,i,o],(function(e){return e[0]===t&&e[1]===i}),r)},Qq=function(e,t,n){var r=Ct(t,3),a=r[0],i=r[1],o=r[2],s=e.get(a);void 0===s?e.set(a,new Set([[i,o]])):Xq(s,[i,o],(function(e){return e[0]===i}),n)},$q=function(e){return"inputs"in e},Jq=function(e,t,n,r){if($q(t)){var a=t.inputs[r];return e.connect(a,n,0),[a,n,0]}return e.connect(t,n,r),[t,n,r]},Zq=function(e,t,n){var r,a=zo(e);try{for(a.s();!(r=a.n()).done;){var i=r.value;if(i[0]===t&&i[1]===n)return e.delete(i),i}}catch(ZJ){a.e(ZJ)}finally{a.f()}return null},eG=function(e,t){if(!Sq(e).delete(t))throw new Error("Missing the expected event listener.")},tG=function(e,t,n){var r=xq(e,t),a=wq(r,(function(e){return e[0]===n}));return 0===r.size&&e.delete(t),a},nG=function(e,t,n,r){$q(t)?e.disconnect(t.inputs[r],n,0):e.disconnect(t,n,r)},rG=function(e){return xq(uq,e)},aG=function(e){return xq(lq,e)},iG=function(e){return pq.has(e)},oG=function(e){return!oq.has(e)},sG=function(e,t){return new Promise((function(n){if(null!==t)n(!0);else{var r=e.createScriptProcessor(256,1,1),a=e.createGain(),i=e.createBuffer(1,2,44100),o=i.getChannelData(0);o[0]=1,o[1]=1;var s=e.createBufferSource();s.buffer=i,s.loop=!0,s.connect(r).connect(e.destination),s.connect(a),s.disconnect(a),r.onaudioprocess=function(t){var a=t.inputBuffer.getChannelData(0);Array.prototype.some.call(a,(function(e){return 1===e}))?n(!0):n(!1),s.stop(),r.onaudioprocess=null,s.disconnect(r),r.disconnect(e.destination)},s.start()}}))},uG=function(e,t){var n,r=new Map,a=zo(e);try{for(a.s();!(n=a.n()).done;){var i,o=zo(n.value);try{for(o.s();!(i=o.n()).done;){var s=i.value,u=r.get(s);r.set(s,void 0===u?1:u+1)}}catch(ZJ){o.e(ZJ)}finally{o.f()}}}catch(ZJ){a.e(ZJ)}finally{a.f()}r.forEach((function(e,n){return t(n,e)}))},cG=function(e){return"context"in e},lG=function(e){var t,n,r=new Map;e.connect=(t=e.connect.bind(e),function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=cG(e)?t(e,n,a):t(e,n),o=r.get(e);return void 0===o?r.set(e,[{input:a,output:n}]):o.every((function(e){return e.input!==a||e.output!==n}))&&o.push({input:a,output:n}),i}),e.disconnect=(n=e.disconnect,function(t,a,i){if(n.apply(e),void 0===t)r.clear();else if("number"===typeof t){var o,s=zo(r);try{for(s.s();!(o=s.n()).done;){var u=Ct(o.value,2),c=u[0],l=u[1].filter((function(e){return e.output!==t}));0===l.length?r.delete(c):r.set(c,l)}}catch(ZJ){s.e(ZJ)}finally{s.f()}}else if(r.has(t))if(void 0===a)r.delete(t);else{var h=r.get(t);if(void 0!==h){var f=h.filter((function(e){return e.output!==a&&(e.input!==i||void 0===i)}));0===f.length?r.delete(t):r.set(t,f)}}var p,d=zo(r);try{var m=function(){var t=Ct(p.value,2),n=t[0];t[1].forEach((function(t){cG(n)?e.connect(n,t.output,t.input):e.connect(n,t.output)}))};for(d.s();!(p=d.n()).done;)m()}catch(ZJ){d.e(ZJ)}finally{d.f()}})},hG=function(e,t,n,r){var a=qq(t),i=a.activeInputs,o=a.passiveInputs,s=jq(e).outputs,u=Sq(e),c=function(a){var s=rG(e),u=aG(t);if(a){var c=tG(o,e,n);Yq(i,e,c,!1),r||iG(e)||s.connect(u,n)}else{var l=function(e,t,n){return wq(e,(function(e){return e[0]===t&&e[1]===n}))}(i,e,n);Qq(o,l,!1),r||iG(e)||s.disconnect(u,n)}};return!!Xq(s,[t,n],(function(e){return e[0]===t&&e[1]===n}),!0)&&(u.add(c),Bq(e)?Yq(i,e,[n,c],!0):Qq(o,[e,n,c],!0),!0)},fG=function(e,t,n,r,a){var i=function(e,t,n,r){var a=jq(t),i=a.activeInputs,o=a.passiveInputs,s=Zq(i[r],e,n);return null===s?[_q(o,e,n,r)[2],!1]:[s[2],!0]}(e,n,r,a),o=Ct(i,2),s=o[0],u=o[1];if(null!==s&&(eG(e,s),!u||t||iG(e)||nG(rG(e),rG(n),r,a)),Bq(n)){var c=jq(n).activeInputs;Iq(n,c)}},pG=function(e,t,n,r){var a=function(e,t,n){var r=qq(t),a=r.activeInputs,i=r.passiveInputs,o=Zq(a,e,n);return null===o?[tG(i,e,n)[1],!1]:[o[2],!0]}(e,n,r),i=Ct(a,2),o=i[0],s=i[1];null!==o&&(eG(e,o),!s||t||iG(e)||rG(e).disconnect(aG(n),r))},dG=function(){function e(t){s(this,e),this._map=new Map(t)}return c(e,[{key:"size",get:function(){return this._map.size}},{key:"entries",value:function(){return this._map.entries()}},{key:"forEach",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._map.forEach((function(r,a){return e.call(n,r,a,t)}))}},{key:"get",value:function(e){return this._map.get(e)}},{key:"has",value:function(e){return this._map.has(e)}},{key:"keys",value:function(){return this._map.keys()}},{key:"values",value:function(){return this._map.values()}}]),e}(),mG={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function vG(e,t,n,r,a){if("function"===typeof e.copyFromChannel)0===t[n].byteLength&&(t[n]=new Float32Array(128)),e.copyFromChannel(t[n],r,a);else{var i=e.getChannelData(r);if(0===t[n].byteLength)t[n]=i.slice(a,a+128);else{var o=new Float32Array(i.buffer,a*Float32Array.BYTES_PER_ELEMENT,128);t[n].set(o)}}}var gG=function(e,t,n,r,a){"function"===typeof e.copyToChannel?0!==t[n].byteLength&&e.copyToChannel(t[n],r,a):0!==t[n].byteLength&&e.getChannelData(r).set(t[n],a)},yG=function(e,t){for(var n=[],r=0;r<e;r+=1){for(var a=[],i="number"===typeof t?t:t[r],o=0;o<i;o+=1)a.push(new Float32Array(128));n.push(a)}return n},bG=function(e,t){var n=xq(mq,e),r=rG(t);return xq(n,r)},kG=function(){var e=_(x().mark((function e(t,n,r,a,i,o,s){var u,c,l,h,f,p,d,m,v,g,y;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=null===n?128*Math.ceil(t.context.length/128):n.length,c=a.channelCount*a.numberOfInputs,l=i.reduce((function(e,t){return e+t}),0),h=0===l?null:r.createBuffer(l,u,r.sampleRate),void 0!==o){e.next=6;break}throw new Error("Missing the processor constructor.");case 6:return f=jq(t),e.next=9,bG(r,t);case 9:p=e.sent,d=yG(a.numberOfInputs,a.channelCount),m=yG(a.numberOfOutputs,i),v=Array.from(t.parameters.keys()).reduce((function(e,t){return Nq(Nq({},e),{},ot({},t,new Float32Array(128)))}),{}),g=function(e){if(a.numberOfInputs>0&&null!==n)for(var u=0;u<a.numberOfInputs;u+=1)for(var l=0;l<a.channelCount;l+=1)vG(n,d[u],l,l,e);void 0!==o.parameterDescriptors&&null!==n&&o.parameterDescriptors.forEach((function(t,r){var a=t.name;vG(n,v,a,c+r,e)}));for(var g=0;g<a.numberOfInputs;g+=1)for(var y=0;y<i[g];y+=1)0===m[g][y].byteLength&&(m[g][y]=new Float32Array(128));try{var b=d.map((function(e,t){return 0===f.activeInputs[t].size?[]:e})),k=s(e/r.sampleRate,r.sampleRate,(function(){return p.process(b,m,v)}));if(null!==h)for(var x=0,w=0;x<a.numberOfOutputs;x+=1){for(var _=0;_<i[x];_+=1)gG(h,m[x],_,w+_,e);w+=i[x]}if(!k)return"break"}catch(S){return t.dispatchEvent(new ErrorEvent("processorerror",{colno:S.colno,filename:S.filename,lineno:S.lineno,message:S.message})),"break"}},y=0;case 15:if(!(y<u)){e.next=22;break}if("break"!==g(y)){e.next=19;break}return e.abrupt("break",22);case 19:y+=128,e.next=15;break;case 22:return e.abrupt("return",h);case 23:case"end":return e.stop()}}),e)})));return function(t,n,r,a,i,o,s){return e.apply(this,arguments)}}(),xG={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},wG={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},_G={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},SG={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},CG={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},TG=function(e){var t=new MessageChannel,n=t.port1,r=t.port2;return new Promise((function(t){var a=function(){r.onmessage=null,n.close(),r.close(),t()};r.onmessage=function(){return a()};try{n.postMessage(e,[e])}finally{a()}}))},EG={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},IG=function(e,t,n){var r=t[n];if(void 0===r)throw e();return r},AG={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},NG={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},PG=function(){return new DOMException("","InvalidStateError")},MG=function(){return new DOMException("","InvalidAccessError")},DG={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},RG=function(e,t,n,r,a,i,o,s,u,c,l){for(var h=c.length,f=s,p=0;p<h;p+=1){for(var d=n[0]*c[p],m=1;m<a;m+=1){var v=f-m&u-1;d+=n[m]*i[v],d-=e[m]*o[v]}for(var g=a;g<r;g+=1)d+=n[g]*i[f-g&u-1];for(var y=a;y<t;y+=1)d-=e[y]*o[f-y&u-1];i[f]=c[p],o[f]=d,f=f+1&u-1,l[p]=d}return f},OG=function(e,t,n,r){var a=n instanceof Float64Array?n:new Float64Array(n),i=r instanceof Float64Array?r:new Float64Array(r),o=a.length,s=i.length,u=Math.min(o,s);if(1!==a[0]){for(var c=0;c<o;c+=1)i[c]/=a[0];for(var l=1;l<s;l+=1)a[l]/=a[0]}for(var h=new Float32Array(32),f=new Float32Array(32),p=t.createBuffer(e.numberOfChannels,e.length,e.sampleRate),d=e.numberOfChannels,m=0;m<d;m+=1){var v=e.getChannelData(m),g=p.getChannelData(m);h.fill(0),f.fill(0),RG(a,o,i,s,u,h,f,0,32,v,g)}return p},FG=function(){var e=_(x().mark((function e(t,n,r,a,i,o,s,u,c,l,h,f,p,d,m,v){var g;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t(n,n)&&t(r,r)&&t(i,i)&&t(o,o)&&t(u,u)&&t(c,c)&&t(l,l)&&t(h,h)&&t(f,f)&&t(p,p)&&t(d,d))){e.next=5;break}return e.next=3,Promise.all([t(a,a),t(s,s),t(m,m),t(v,v)]);case 3:return g=e.sent,e.abrupt("return",g.every((function(e){return e})));case 5:return e.abrupt("return",!1);case 6:case"end":return e.stop()}}),e)})));return function(t,n,r,a,i,o,s,u,c,l,h,f,p,d,m,v){return e.apply(this,arguments)}}(),LG={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},zG=function(e){var t=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{var n=e.decodeAudioData(t.buffer,(function(){}));return void 0!==n&&(n.catch((function(){})),!0)}catch(r){}return!1},BG={numberOfChannels:1},VG=function(e,t,n){var r=t[n];void 0!==r&&r!==e[n]&&(e[n]=r)},jG=function(e,t){VG(e,t,"channelCount"),VG(e,t,"channelCountMode"),VG(e,t,"channelInterpretation")},qG=function(e){return"function"===typeof e.getFloatTimeDomainData},GG=function(e,t,n){var r=t[n];void 0!==r&&r!==e[n].value&&(e[n].value=r)},WG=function(e){e.start=function(t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2?arguments[2]:void 0;if("number"===typeof a&&a<0||r<0||n<0)throw new RangeError("The parameters can't be negative.");t.call(e,n,r,a)}}(e.start)},UG=function(e){var t;e.stop=(t=e.stop,function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(n<0)throw new RangeError("The parameter can't be negative.");t.call(e,n)})},HG=function(e,t){return null===e?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(e*t)))))},KG=function(e){return new Promise((function(t,n){var r=new MessageChannel,a=r.port1,i=r.port2;a.onmessage=function(e){var n=e.data;a.close(),i.close(),t(n)},a.onmessageerror=function(e){var t=e.data;a.close(),i.close(),n(t)},i.postMessage(e)}))},XG=function(){var e=_(x().mark((function e(t,n){var r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,KG(n);case 2:return r=e.sent,e.abrupt("return",new t(r));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),YG=function(e,t){var n=e.createBiquadFilter();return jG(n,t),GG(n,t,"Q"),GG(n,t,"detune"),GG(n,t,"frequency"),GG(n,t,"gain"),VG(n,t,"type"),n},QG=function(e,t){var n=e.createChannelSplitter(t.numberOfOutputs);return jG(n,t),function(e){var t=e.numberOfOutputs;Object.defineProperty(e,"channelCount",{get:function(){return t},set:function(e){if(e!==t)throw PG()}}),Object.defineProperty(e,"channelCountMode",{get:function(){return"explicit"},set:function(e){if("explicit"!==e)throw PG()}}),Object.defineProperty(e,"channelInterpretation",{get:function(){return"discrete"},set:function(e){if("discrete"!==e)throw PG()}})}(n),n};function $G(e,t){if(null==e)return{};var n,r,a=C(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var JG=function(e,t){return e.connect=t.connect.bind(t),e.disconnect=t.disconnect.bind(t),e},ZG=["offset"],eW=function(e,t){var n=e.createDelay(t.maxDelayTime);return jG(n,t),GG(n,t,"delayTime"),n},tW=function(e,t){var n=e.createGain();return jG(n,t),GG(n,t,"gain"),n};function nW(e,t){var n=t[0]*t[0]+t[1]*t[1];return[(e[0]*t[0]+e[1]*t[1])/n,(e[1]*t[0]-e[0]*t[1])/n]}function rW(e,t){for(var n,r,a=[0,0],i=e.length-1;i>=0;i-=1)r=t,(a=[(n=a)[0]*r[0]-n[1]*r[1],n[0]*r[1]+n[1]*r[0]])[0]+=e[i];return a}var aW,iW,oW,sW,uW,cW,lW=["coneInnerAngle","coneOuterAngle","coneOuterGain","distanceModel","maxDistance","orientationX","orientationY","orientationZ","panningModel","positionX","positionY","positionZ","refDistance","rolloffFactor"],hW=function(e,t,n,r){return e.createScriptProcessor(t,n,r)},fW=["channelCount","channelCountMode","pan"],pW=["curve","oversample"],dW=function(){return new DOMException("","NotSupportedError")},mW={numberOfChannels:1},vW={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},gW={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},yW={disableNormalization:!1},bW={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},kW=function(){return new DOMException("","UnknownError")},xW={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},wW=function(e,t,n){return void 0===e.copyFromChannel?e.getChannelData(n)[0]:(e.copyFromChannel(t,n),t[0])},_W=function(e){if(null===e)return!1;var t=e.length;return t%2!==0?0!==e[Math.floor(t/2)]:e[t/2-1]+e[t/2]!==0},SW=function(e,t,n,r){for(var a=e;!a.hasOwnProperty(t);)a=Object.getPrototypeOf(a);var i=Object.getOwnPropertyDescriptor(a,t),o=i.get,s=i.set;Object.defineProperty(e,t,{get:n(o),set:r(s)})},CW=function(e){var t=e.createOscillator();try{t.start(-1)}catch(ZJ){return ZJ instanceof RangeError}return!1},TW=function(e){var t=e.createBuffer(1,1,44100),n=e.createBufferSource();n.buffer=t,n.start(),n.stop();try{return n.stop(),!0}catch(r){return!1}},EW=function(e){var t=e.createOscillator();try{t.stop(-1)}catch(ZJ){return ZJ instanceof RangeError}return!1},IW=function(){try{new DOMException}catch(e){return!1}return!0},AW=function(){return new Promise((function(e){var t=new ArrayBuffer(0),n=new MessageChannel,r=n.port1,a=n.port2;r.onmessage=function(t){var n=t.data;return e(null!==n)},a.postMessage(t,[t])}))},NW=function(e,t){var n=t.createGain();e.connect(n);var r,a=(r=e.disconnect,function(){r.call(e,n),e.removeEventListener("ended",a)});e.addEventListener("ended",a),JG(e,n),e.stop=function(t){var r=!1;return function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(r)try{t.call(e,a)}catch(i){n.gain.setValueAtTime(0,a)}else t.call(e,a),r=!0}}(e.stop)},PW=function(e,t){return function(n){var r={value:e};return Object.defineProperties(n,{currentTarget:r,target:r}),"function"===typeof t?t.call(e,n):t.handleEvent.call(e,n)}},MW=function(e){return function(t,n,r,a){var i=Ct(r,3),o=i[0],s=i[1],u=i[2];e(t[s],[n,o,u],(function(e){return e[0]===n&&e[1]===o}),a)}}(Xq),DW=function(e){return function(t,n,r,a){var i=Ct(r,3),o=i[0],s=i[1],u=i[2],c=t.get(o);void 0===c?t.set(o,new Set([[s,n,u]])):e(c,[s,n,u],(function(e){return e[0]===s&&e[1]===n}),a)}}(Xq),RW=function(e){return function(t,n,r,a){return e(t[a],(function(e){return e[0]===n&&e[1]===r}))}}(wq),OW=new WeakMap,FW=function(e){return function(t){var n;return null!==(n=e.get(t))&&void 0!==n?n:0}}(OW),LW=(aW=new Map,iW=new WeakMap,function(e,t){var n=iW.get(e);if(void 0!==n)return n;var r=aW.get(e);if(void 0!==r)return r;try{var a=t();return a instanceof Promise?(aW.set(e,a),a.catch((function(){return!1})).then((function(t){return aW.delete(e),iW.set(e,t),t}))):(iW.set(e,a),a)}catch(i){return iW.set(e,!1),!1}}),zW="undefined"===typeof window?null:window,BW=function(e,t){return function(n,r){var a=n.createAnalyser();if(jG(a,r),!(r.maxDecibels>r.minDecibels))throw t();return VG(a,r,"fftSize"),VG(a,r,"maxDecibels"),VG(a,r,"minDecibels"),VG(a,r,"smoothingTimeConstant"),e(qG,(function(){return qG(a)}))||function(e){e.getFloatTimeDomainData=function(t){var n=new Uint8Array(t.length);e.getByteTimeDomainData(n);for(var r=Math.max(n.length,e.fftSize),a=0;a<r;a+=1)t[a]=.0078125*(n[a]-128);return t}}(a),a}}(LW,Rq),VW=function(e){return function(t){var n=e(t);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer}}(jq),jW=function(e,t,n){return function(){var r=_(x().mark((function r(a,i,o){var s;return x().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return s=e(a),r.next=3,Promise.all(s.activeInputs.map((function(e,r){return Array.from(e).map(function(){var e=_(x().mark((function e(s){var u,c,l,h,f,p;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=Ct(s,2),c=u[0],l=u[1],h=t(c),e.next=4,h.render(c,i);case 4:f=e.sent,p=a.context.destination,n(c)||a===p&&n(a)||f.connect(o,l,r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())})).reduce((function(e,t){return[].concat(Fn(e),Fn(t))}),[]));case 3:case"end":return r.stop()}}),r)})));return function(e,t,n){return r.apply(this,arguments)}}()}(jq,VW,iG),qW=function(e,t,n){return function(){var r=new WeakMap,a=function(){var a=_(x().mark((function a(i,o){var s,u;return x().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return s=t(i),Mq(s,o)||(u={channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,fftSize:s.fftSize,maxDecibels:s.maxDecibels,minDecibels:s.minDecibels,smoothingTimeConstant:s.smoothingTimeConstant},s=e(o,u)),r.set(o,s),a.next=6,n(i,o,s);case 6:return a.abrupt("return",s);case 7:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}();return{render:function(e,t){var n=r.get(t);return void 0!==n?Promise.resolve(n):a(e,t)}}}}(BW,rG,jW),GW=(oW=hq,function(e){var t=oW.get(e);if(void 0===t)throw PG();return t}),WW=function(e){return null===e?null:e.hasOwnProperty("OfflineAudioContext")?e.OfflineAudioContext:e.hasOwnProperty("webkitOfflineAudioContext")?e.webkitOfflineAudioContext:null}(zW),UW=function(e){return function(t){return null!==e&&t instanceof e}}(WW),HW=new WeakMap,KW=function(e){return function(){function t(e){s(this,t),this._nativeEventTarget=e,this._listeners=new WeakMap}return c(t,[{key:"addEventListener",value:function(t,n,r){if(null!==n){var a=this._listeners.get(n);void 0===a&&(a=e(this,n),"function"===typeof n&&this._listeners.set(n,a)),this._nativeEventTarget.addEventListener(t,a,r)}}},{key:"dispatchEvent",value:function(e){return this._nativeEventTarget.dispatchEvent(e)}},{key:"removeEventListener",value:function(e,t,n){var r=null===t?void 0:this._listeners.get(t);this._nativeEventTarget.removeEventListener(e,void 0===r?null:r,n)}}]),t}()}(PW),XW=function(e){return null===e?null:e.hasOwnProperty("AudioContext")?e.AudioContext:e.hasOwnProperty("webkitAudioContext")?e.webkitAudioContext:null}(zW),YW=function(e){return function(t){return null!==e&&t instanceof e}}(XW),QW=function(e){return function(t){return null!==e&&"function"===typeof e.AudioNode&&t instanceof e.AudioNode}}(zW),$W=function(e){return function(t){return null!==e&&"function"===typeof e.AudioParam&&t instanceof e.AudioParam}}(zW),JW=function(e){return null===e?null:e.hasOwnProperty("AudioWorkletNode")?e.AudioWorkletNode:null}(zW),ZW=function(e,t,n,r,a,i,o,u,l,f,p,d,v,y,b,k){return function(f){h(w,f);var x=g(w);function w(t,r,a,i){var o;s(this,w),(o=x.call(this,a))._context=t,o._nativeAudioNode=a;var u=p(t);return d(u)&&!0!==n(sG,(function(){return sG(u,k)}))&&lG(a),uq.set(m(o),a),fq.set(m(o),new Set),"closed"!==t.state&&r&&Cq(m(o)),e(m(o),i,a),o}return c(w,[{key:"channelCount",get:function(){return this._nativeAudioNode.channelCount},set:function(e){this._nativeAudioNode.channelCount=e}},{key:"channelCountMode",get:function(){return this._nativeAudioNode.channelCountMode},set:function(e){this._nativeAudioNode.channelCountMode=e}},{key:"channelInterpretation",get:function(){return this._nativeAudioNode.channelInterpretation},set:function(e){this._nativeAudioNode.channelInterpretation=e}},{key:"context",get:function(){return this._context}},{key:"numberOfInputs",get:function(){return this._nativeAudioNode.numberOfInputs}},{key:"numberOfOutputs",get:function(){return this._nativeAudioNode.numberOfOutputs}},{key:"connect",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(n<0||n>=this._nativeAudioNode.numberOfOutputs)throw a();var u=p(this._context),c=b(u);if(v(e)||y(e))throw i();if(Hq(e)){var h=rG(e);try{var f,d=Jq(this._nativeAudioNode,h,n,s),m=oG(this);if(c||m)(f=this._nativeAudioNode).disconnect.apply(f,Fn(d));"closed"!==this.context.state&&!m&&oG(e)&&Cq(e)}catch(ZJ){if(12===ZJ.code)throw i();throw ZJ}var g=t(this,e,n,s,c);if(g){var k=l([this],e);uG(k,r(c))}return e}var x=aG(e);if("playbackRate"===x.name&&1024===x.maxValue)throw o();try{this._nativeAudioNode.connect(x,n),(c||oG(this))&&this._nativeAudioNode.disconnect(x,n)}catch(ZJ){if(12===ZJ.code)throw i();throw ZJ}var w=hG(this,e,n,c);if(w){var _=l([this],e);uG(_,r(c))}}},{key:"disconnect",value:function(e,t,n){var r,o=p(this._context),s=b(o);if(void 0===e)r=function(e,t){var n,r=jq(e),a=[],i=zo(r.outputs);try{for(i.s();!(n=i.n()).done;){var o=n.value;Kq(o)?fG.apply(void 0,[e,t].concat(Fn(o))):pG.apply(void 0,[e,t].concat(Fn(o))),a.push(o[0])}}catch(ZJ){i.e(ZJ)}finally{i.f()}return r.outputs.clear(),a}(this,s);else if("number"===typeof e){if(e<0||e>=this.numberOfOutputs)throw a();r=function(e,t,n){var r,a=jq(e),i=[],o=zo(a.outputs);try{for(o.s();!(r=o.n()).done;){var s=r.value;s[1]===n&&(Kq(s)?fG.apply(void 0,[e,t].concat(Fn(s))):pG.apply(void 0,[e,t].concat(Fn(s))),i.push(s[0]),a.outputs.delete(s))}}catch(ZJ){o.e(ZJ)}finally{o.f()}return i}(this,s,e)}else{if(void 0!==t&&(t<0||t>=this.numberOfOutputs))throw a();if(Hq(e)&&void 0!==n&&(n<0||n>=e.numberOfInputs))throw a();if(r=function(e,t,n,r,a){var i=jq(e);return Array.from(i.outputs).filter((function(e){return e[0]===n&&(void 0===r||e[1]===r)&&(void 0===a||e[2]===a)})).map((function(n){return Kq(n)?fG.apply(void 0,[e,t].concat(Fn(n))):pG.apply(void 0,[e,t].concat(Fn(n))),i.outputs.delete(n),n[0]}))}(this,s,e,t,n),0===r.length)throw i()}var c,h=zo(r);try{for(h.s();!(c=h.n()).done;){var f=c.value,d=l([this],f);uG(d,u)}}catch(ZJ){h.e(ZJ)}finally{h.f()}}}]),w}(f)}((sW=sq,function(e,t,n){for(var r=[],a=0;a<n.numberOfInputs;a+=1)r.push(new Set);sW.set(e,{activeInputs:r,outputs:new Set,passiveInputs:new WeakMap,renderer:t})}),function(e,t,n,r,a,i,o,s,u,c,l,h,f){var p=new WeakMap;return function(d,m,v,g,y){var b=i(m),k=b.activeInputs,x=b.passiveInputs,w=i(d).outputs,_=s(d),S=function(i){var s=u(m),c=u(d);if(i){var b=_q(x,d,v,g);e(k,d,b,!1),y||h(d)||n(c,s,v,g),f(m)&&Cq(m)}else{var w=r(k,d,v,g);t(x,g,w,!1),y||h(d)||a(c,s,v,g);var _=o(m);if(0===_)l(m)&&Iq(m,k);else{var S=p.get(m);void 0!==S&&clearTimeout(S),p.set(m,setTimeout((function(){l(m)&&Iq(m,k)}),1e3*_))}}};return!!c(w,[m,v,g],(function(e){return e[0]===m&&e[1]===v&&e[2]===g}),!0)&&(_.add(S),l(d)?e(k,d,[v,g,S],!0):t(x,g,[d,v,S],!0),!0)}}(MW,DW,Jq,RW,nG,jq,FW,Sq,rG,Xq,Bq,iG,oG),LW,function(e,t,n,r,a,i){return function(o){return function(s,u){var c=e.get(s);if(void 0===c){if(!o&&i(s)){var l,h=r(s),f=zo(n(s).outputs);try{for(f.s();!(l=f.n()).done;){var p=l.value;if(Kq(p)){var d=r(p[0]);t(h,d,p[1],p[2])}else{var m=a(p[0]);h.disconnect(m,p[1])}}}catch(ZJ){f.e(ZJ)}finally{f.f()}}e.set(s,u)}else e.set(s,c+u)}}}(pq,nG,jq,rG,aG,Bq),Rq,MG,dW,function(e,t,n,r,a,i,o,s){return function(u,c){var l=t.get(u);if(void 0===l)throw new Error("Missing the expected cycle count.");var h=i(u.context),f=s(h);if(l===c){if(t.delete(u),!f&&o(u)){var p,d=r(u),m=zo(n(u).outputs);try{for(m.s();!(p=m.n()).done;){var v=p.value;if(Kq(v)){var g=r(v[0]);e(d,g,v[1],v[2])}else{var y=a(v[0]);d.connect(y,v[1])}}}catch(ZJ){m.e(ZJ)}finally{m.f()}}}else t.set(u,l-c)}}(Jq,pq,jq,rG,aG,GW,Bq,UW),function(e,t,n){return function r(a,i){var o=Hq(i)?i:n(e,i);if(function(e){return"delayTime"in e}(o))return[];if(a[0]===o)return[a];if(a.includes(o))return[];var s=t(o).outputs;return Array.from(s).map((function(e){return r([].concat(Fn(a),[o]),e[0])})).reduce((function(e,t){return e.concat(t)}),[])}}(HW,jq,xq),KW,GW,YW,QW,$W,UW,JW),eU=function(e,t,n,r,a,i){return function(e){h(u,e);var o=g(u);function u(e,n){var c;s(this,u);var l=a(e),h=Nq(Nq({},Pq),n),f=r(l,h),p=i(l)?t():null;return(c=o.call(this,e,!1,f,p))._nativeAnalyserNode=f,c}return c(u,[{key:"fftSize",get:function(){return this._nativeAnalyserNode.fftSize},set:function(e){this._nativeAnalyserNode.fftSize=e}},{key:"frequencyBinCount",get:function(){return this._nativeAnalyserNode.frequencyBinCount}},{key:"maxDecibels",get:function(){return this._nativeAnalyserNode.maxDecibels},set:function(e){var t=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=e,!(e>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=t,n()}},{key:"minDecibels",get:function(){return this._nativeAnalyserNode.minDecibels},set:function(e){var t=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=e,!(this._nativeAnalyserNode.maxDecibels>e))throw this._nativeAnalyserNode.minDecibels=t,n()}},{key:"smoothingTimeConstant",get:function(){return this._nativeAnalyserNode.smoothingTimeConstant},set:function(e){this._nativeAnalyserNode.smoothingTimeConstant=e}},{key:"getByteFrequencyData",value:function(e){this._nativeAnalyserNode.getByteFrequencyData(e)}},{key:"getByteTimeDomainData",value:function(e){this._nativeAnalyserNode.getByteTimeDomainData(e)}},{key:"getFloatFrequencyData",value:function(e){this._nativeAnalyserNode.getFloatFrequencyData(e)}},{key:"getFloatTimeDomainData",value:function(e){this._nativeAnalyserNode.getFloatTimeDomainData(e)}}]),u}(e)}(ZW,qW,Rq,BW,GW,UW),tU=new WeakSet,nU=function(e){return null===e?null:e.hasOwnProperty("AudioBuffer")?e.AudioBuffer:null}(zW),rU=(uW=new Uint32Array(1),function(e){return uW[0]=e,uW[0]}),aU=function(e,t){return function(n){n.copyFromChannel=function(r,a){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=e(i),s=e(a);if(s>=n.numberOfChannels)throw t();for(var u=n.length,c=n.getChannelData(s),l=r.length,h=o<0?-o:0;h+o<u&&h<l;h+=1)r[h]=c[h+o]},n.copyToChannel=function(r,a){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=e(i),s=e(a);if(s>=n.numberOfChannels)throw t();for(var u=n.length,c=n.getChannelData(s),l=r.length,h=o<0?-o:0;h+o<u&&h<l;h+=1)c[h+o]=r[h]}}}(rU,Rq),iU=function(e){return function(t){t.copyFromChannel=function(n){return function(r,a){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=e(i),s=e(a);if(o<t.length)return n.call(t,r,s,o)}}(t.copyFromChannel),t.copyToChannel=function(n){return function(r,a){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=e(i),s=e(a);if(o<t.length)return n.call(t,r,s,o)}}(t.copyToChannel)}}(rU),oU=function(e,t,n,r,a,i,o,u){var l=null;return function(h){function f(c){if(s(this,f),null===a)throw new Error("Missing the native OfflineAudioContext constructor.");var h=Nq(Nq({},Fq),c),p=h.length,d=h.numberOfChannels,m=h.sampleRate;null===l&&(l=new a(1,1,44100));var v=null!==r&&t(i,i)?new r({length:p,numberOfChannels:d,sampleRate:m}):l.createBuffer(d,p,m);if(0===v.numberOfChannels)throw n();return"function"!==typeof v.copyFromChannel?(o(v),Oq(v)):t(Dq,(function(){return Dq(v)}))||u(v),e.add(v),v}return c(f,null,[{key:Symbol.hasInstance,value:function(t){return null!==t&&"object"===typeof t&&Object.getPrototypeOf(t)===f.prototype||e.has(t)}}]),f}()}(tU,LW,dW,nU,WW,function(e){return function(){if(null===e)return!1;try{new e({length:1,sampleRate:44100})}catch(t){return!1}return!0}}(nU),aU,iU),sU=function(e){return function(t,n){var r=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(r).connect(t.destination);n.addEventListener("ended",(function e(){n.removeEventListener("ended",e),n.disconnect(r),r.disconnect()}))}}(tW),uU=function(e,t,n){return function(){var r=_(x().mark((function r(a,i,o){var s;return x().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return s=t(a),r.next=3,Promise.all(Array.from(s.activeInputs).map(function(){var t=_(x().mark((function t(r){var a,s,u,c,l;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=Ct(r,2),s=a[0],u=a[1],c=e(s),t.next=4,c.render(s,i);case 4:l=t.sent,n(s)||l.connect(o,u);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 3:case"end":return r.stop()}}),r)})));return function(e,t,n){return r.apply(this,arguments)}}()}(VW,qq,iG),cU=function(e){return function(t,n,r){return e(n,t,r)}}(uU),lU=function(e,t,n,r,a,i,o,s,u,c,l){return function(h,f){var p=h.createBufferSource();return jG(p,f),GG(p,f,"playbackRate"),VG(p,f,"buffer"),VG(p,f,"loop"),VG(p,f,"loopEnd"),VG(p,f,"loopStart"),t(n,(function(){return n(h)}))||function(e){e.start=function(t){var n=!1;return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;if(n)throw PG();t.call(e,r,a,i),n=!0}}(e.start)}(p),t(r,(function(){return r(h)}))||u(p),t(a,(function(){return a(h)}))||c(p,h),t(i,(function(){return i(h)}))||WG(p),t(o,(function(){return o(h)}))||l(p,h),t(s,(function(){return s(h)}))||UG(p),e(h,p),p}}(sU,LW,(function(e){var t=e.createBufferSource();t.start();try{t.start()}catch(n){return!0}return!1}),(function(e){var t=e.createBufferSource(),n=e.createBuffer(1,1,44100);t.buffer=n;try{t.start(0,1)}catch(r){return!1}return!0}),(function(e){var t=e.createBufferSource();t.start();try{t.stop()}catch(n){return!1}return!0}),CW,TW,EW,(function(e){e.start=function(t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2?arguments[2]:void 0,i=e.buffer,o=null===i?r:Math.min(i.duration,r);null!==i&&o>i.duration-.5/e.context.sampleRate?t.call(e,n,0,0):t.call(e,n,o,a)}}(e.start)}),function(e){return function(t,n){var r=n.createBuffer(1,1,44100);null===t.buffer&&(t.buffer=r),e(t,"buffer",(function(e){return function(){var n=e.call(t);return n===r?null:n}}),(function(e){return function(n){return e.call(t,null===n?r:n)}}))}}(SW),NW),hU=function(e,t){return function(n,r,a){return e(r).replay(a),t(r,n,a)}}(function(e){return function(t){var n=e(t);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer}}(qq),uU),fU=function(e,t,n,r,a){return function(){var i=new WeakMap,o=null,s=null,u=function(){var u=_(x().mark((function u(c,l){var h,f,p,d;return x().wrap((function(u){for(;;)switch(u.prev=u.next){case 0:if(h=n(c),(f=Mq(h,l))||(p={buffer:h.buffer,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,loop:h.loop,loopEnd:h.loopEnd,loopStart:h.loopStart,playbackRate:h.playbackRate.value},h=t(l,p),null!==o&&(d=h).start.apply(d,Fn(o)),null!==s&&h.stop(s)),i.set(l,h),f){u.next=9;break}return u.next=7,r(l,c.playbackRate,h.playbackRate);case 7:u.next=11;break;case 9:return u.next=11,e(l,c.playbackRate,h.playbackRate);case 11:return u.next=13,a(c,l,h);case 13:return u.abrupt("return",h);case 14:case"end":return u.stop()}}),u)})));return function(e,t){return u.apply(this,arguments)}}();return{set start(e){o=e},set stop(e){s=e},render:function(e,t){var n=i.get(t);return void 0!==n?Promise.resolve(n):u(e,t)}}}}(cU,lU,rG,hU,jW),pU=function(e,t,n,r,a,i,o,s,u,c,l,h,f){return function(p,d,m){var v=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,g=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,y=new iq.AutomationEventList(m.defaultValue),b=d?r(y):null,k={get defaultValue(){return m.defaultValue},get maxValue(){return null===v?m.maxValue:v},get minValue(){return null===g?m.minValue:g},get value(){return m.value},set value(e){m.value=e,k.setValueAtTime(e,p.context.currentTime)},cancelAndHoldAtTime:function(e){if("function"===typeof m.cancelAndHoldAtTime)null===b&&y.flush(p.context.currentTime),y.add(a(e)),m.cancelAndHoldAtTime(e);else{var t=Array.from(y).pop();null===b&&y.flush(p.context.currentTime),y.add(a(e));var n=Array.from(y).pop();m.cancelScheduledValues(e),t!==n&&void 0!==n&&("exponentialRampToValue"===n.type?m.exponentialRampToValueAtTime(n.value,n.endTime):"linearRampToValue"===n.type?m.linearRampToValueAtTime(n.value,n.endTime):"setValue"===n.type?m.setValueAtTime(n.value,n.startTime):"setValueCurve"===n.type&&m.setValueCurveAtTime(n.values,n.startTime,n.duration))}return k},cancelScheduledValues:function(e){return null===b&&y.flush(p.context.currentTime),y.add(i(e)),m.cancelScheduledValues(e),k},exponentialRampToValueAtTime:function(e,t){if(0===e)throw new RangeError;if(!Number.isFinite(t)||t<0)throw new RangeError;return null===b&&y.flush(p.context.currentTime),y.add(o(e,t)),m.exponentialRampToValueAtTime(e,t),k},linearRampToValueAtTime:function(e,t){return null===b&&y.flush(p.context.currentTime),y.add(s(e,t)),m.linearRampToValueAtTime(e,t),k},setTargetAtTime:function(e,t,n){return null===b&&y.flush(p.context.currentTime),y.add(u(e,t,n)),m.setTargetAtTime(e,t,n),k},setValueAtTime:function(e,t){return null===b&&y.flush(p.context.currentTime),y.add(c(e,t)),m.setValueAtTime(e,t),k},setValueCurveAtTime:function(e,t,n){var r=e instanceof Float32Array?e:new Float32Array(e);if(null!==h&&"webkitAudioContext"===h.name){for(var a=t+n,i=p.context.sampleRate,o=Math.ceil(t*i),s=Math.floor(a*i),u=s-o,c=new Float32Array(u),d=0;d<u;d+=1){var v=(r.length-1)/n*((o+d)/i-t),g=Math.floor(v),x=Math.ceil(v);c[d]=g===x?r[g]:(1-(v-g))*r[g]+(1-(x-v))*r[x]}null===b&&y.flush(p.context.currentTime),y.add(l(c,t,n)),m.setValueCurveAtTime(c,t,n);var w=s/i;w<a&&f(k,c[c.length-1],w),f(k,r[r.length-1],a)}else null===b&&y.flush(p.context.currentTime),y.add(l(r,t,n)),m.setValueCurveAtTime(r,t,n);return k}};return n.set(k,m),t.set(k,p),e(k,b),k}}((cW=cq,function(e,t){cW.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})}),HW,lq,(function(e){return{replay:function(t){var n,r=zo(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;if("exponentialRampToValue"===a.type){var i=a.endTime,o=a.value;t.exponentialRampToValueAtTime(o,i)}else if("linearRampToValue"===a.type){var s=a.endTime,u=a.value;t.linearRampToValueAtTime(u,s)}else if("setTarget"===a.type){var c=a.startTime,l=a.target,h=a.timeConstant;t.setTargetAtTime(l,c,h)}else if("setValue"===a.type){var f=a.startTime,p=a.value;t.setValueAtTime(p,f)}else{if("setValueCurve"!==a.type)throw new Error("Can't apply an unknown automation.");var d=a.duration,m=a.startTime,v=a.values;t.setValueCurveAtTime(v,m,d)}}}catch(ZJ){r.e(ZJ)}finally{r.f()}}}}),iq.createCancelAndHoldAutomationEvent,iq.createCancelScheduledValuesAutomationEvent,iq.createExponentialRampToValueAutomationEvent,iq.createLinearRampToValueAutomationEvent,iq.createSetTargetAutomationEvent,iq.createSetValueAutomationEvent,iq.createSetValueCurveAutomationEvent,XW,(function e(t,n,r){try{t.setValueAtTime(n,r)}catch(ZJ){if(9!==ZJ.code)throw ZJ;e(t,n,r+1e-7)}})),dU=function(e,t,n,r,a,i,o,u){return function(e){h(f,e);var l=g(f);function f(e,r){var u;s(this,f);var c=i(e),h=Nq(Nq({},Vq),r),p=a(c,h),d=o(c),v=d?t():null;return(u=l.call(this,e,!1,p,v))._audioBufferSourceNodeRenderer=v,u._isBufferNullified=!1,u._isBufferSet=null!==h.buffer,u._nativeAudioBufferSourceNode=p,u._onended=null,u._playbackRate=n(m(u),d,p.playbackRate,zq,Lq),u}return c(f,[{key:"buffer",get:function(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer},set:function(e){if(this._nativeAudioBufferSourceNode.buffer=e,null!==e){if(this._isBufferSet)throw r();this._isBufferSet=!0}}},{key:"loop",get:function(){return this._nativeAudioBufferSourceNode.loop},set:function(e){this._nativeAudioBufferSourceNode.loop=e}},{key:"loopEnd",get:function(){return this._nativeAudioBufferSourceNode.loopEnd},set:function(e){this._nativeAudioBufferSourceNode.loopEnd=e}},{key:"loopStart",get:function(){return this._nativeAudioBufferSourceNode.loopStart},set:function(e){this._nativeAudioBufferSourceNode.loopStart=e}},{key:"onended",get:function(){return this._onended},set:function(e){var t="function"===typeof e?u(this,e):null;this._nativeAudioBufferSourceNode.onended=t;var n=this._nativeAudioBufferSourceNode.onended;this._onended=null!==n&&n===t?e:n}},{key:"playbackRate",get:function(){return this._playbackRate}},{key:"start",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;if(this._nativeAudioBufferSourceNode.start(t,n,r),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===r?[t,n]:[t,n,r]),"closed"!==this.context.state){Cq(this);var a=function t(){e._nativeAudioBufferSourceNode.removeEventListener("ended",t),Bq(e)&&Eq(e)};this._nativeAudioBufferSourceNode.addEventListener("ended",a)}}},{key:"stop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._nativeAudioBufferSourceNode.stop(e),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=e)}}]),f}(e)}(ZW,fU,pU,PG,lU,GW,UW,PW),mU=function(e,t,n,r,a,i,o,u){return function(e){h(f,e);var l=g(f);function f(e,n){var r;s(this,f);var c=i(e),h=o(c),p=a(c,n,h),d=h?t(u):null;return(r=l.call(this,e,!1,p,d))._isNodeOfNativeOfflineAudioContext=h,r._nativeAudioDestinationNode=p,r}return c(f,[{key:"channelCount",get:function(){return this._nativeAudioDestinationNode.channelCount},set:function(e){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(e>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=e}},{key:"channelCountMode",get:function(){return this._nativeAudioDestinationNode.channelCountMode},set:function(e){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=e}},{key:"maxChannelCount",get:function(){return this._nativeAudioDestinationNode.maxChannelCount}}]),f}(e)}(ZW,(function(e){var t=new WeakMap,n=function(){var n=_(x().mark((function n(r,a){var i;return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=a.destination,t.set(a,i),n.next=4,e(r,a,i);case 4:return n.abrupt("return",i);case 5:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}();return{render:function(e,r){var a=t.get(r);return void 0!==a?Promise.resolve(a):n(e,r)}}}),Rq,PG,function(e,t){return function(n,r,a){var i=n.destination;if(i.channelCount!==r)try{i.channelCount=r}catch(s){}a&&"explicit"!==i.channelCountMode&&(i.channelCountMode="explicit"),0===i.maxChannelCount&&Object.defineProperty(i,"maxChannelCount",{value:r});var o=e(n,{channelCount:r,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,gain:1});return t(o,"channelCount",(function(e){return function(){return e.call(o)}}),(function(e){return function(t){e.call(o,t);try{i.channelCount=t}catch(ZJ){if(t>i.maxChannelCount)throw ZJ}}})),t(o,"channelCountMode",(function(e){return function(){return e.call(o)}}),(function(e){return function(t){e.call(o,t),i.channelCountMode=t}})),t(o,"channelInterpretation",(function(e){return function(){return e.call(o)}}),(function(e){return function(t){e.call(o,t),i.channelInterpretation=t}})),Object.defineProperty(o,"maxChannelCount",{get:function(){return i.maxChannelCount}}),o.connect(i),o}}(tW,SW),GW,UW,jW),vU=function(e,t,n,r,a){return function(){var i=new WeakMap,o=function(){var o=_(x().mark((function o(s,u){var c,l,h;return x().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(c=n(s),(l=Mq(c,u))||(h={Q:c.Q.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,detune:c.detune.value,frequency:c.frequency.value,gain:c.gain.value,type:c.type},c=t(u,h)),i.set(u,c),l){o.next=15;break}return o.next=7,r(u,s.Q,c.Q);case 7:return o.next=9,r(u,s.detune,c.detune);case 9:return o.next=11,r(u,s.frequency,c.frequency);case 11:return o.next=13,r(u,s.gain,c.gain);case 13:o.next=23;break;case 15:return o.next=17,e(u,s.Q,c.Q);case 17:return o.next=19,e(u,s.detune,c.detune);case 19:return o.next=21,e(u,s.frequency,c.frequency);case 21:return o.next=23,e(u,s.gain,c.gain);case 23:return o.next=25,a(s,u,c);case 25:return o.abrupt("return",c);case 26:case"end":return o.stop()}}),o)})));return function(e,t){return o.apply(this,arguments)}}();return{render:function(e,t){var n=i.get(t);return void 0!==n?Promise.resolve(n):o(e,t)}}}}(cU,YG,rG,hU,jW),gU=function(e){return function(t,n){return e.set(t,n)}}(OW),yU=function(e,t,n,r,a,i,o,u){return function(e){h(f,e);var l=g(f);function f(e,r){var c;s(this,f);var h=i(e),p=Nq(Nq({},xG),r),d=a(h,p),v=o(h),g=v?n():null;return(c=l.call(this,e,!1,d,g))._Q=t(m(c),v,d.Q,zq,Lq),c._detune=t(m(c),v,d.detune,1200*Math.log2(zq),-1200*Math.log2(zq)),c._frequency=t(m(c),v,d.frequency,e.sampleRate/2,0),c._gain=t(m(c),v,d.gain,40*Math.log10(zq),Lq),c._nativeBiquadFilterNode=d,u(m(c),1),c}return c(f,[{key:"detune",get:function(){return this._detune}},{key:"frequency",get:function(){return this._frequency}},{key:"gain",get:function(){return this._gain}},{key:"Q",get:function(){return this._Q}},{key:"type",get:function(){return this._nativeBiquadFilterNode.type},set:function(e){this._nativeBiquadFilterNode.type=e}},{key:"getFrequencyResponse",value:function(e,t,n){try{this._nativeBiquadFilterNode.getFrequencyResponse(e,t,n)}catch(ZJ){if(11===ZJ.code)throw r();throw ZJ}if(e.length!==t.length||t.length!==n.length)throw r()}}]),f}(e)}(ZW,pU,vU,MG,YG,GW,UW,gU),bU=function(e,t){return function(n,r,a){var i,o,s=new Set;return n.connect=(i=n.connect,function(a){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=0===s.size;if(t(a))return i.call(n,a,o,u),e(s,[a,o,u],(function(e){return e[0]===a&&e[1]===o&&e[2]===u}),!0),c&&r(),a;i.call(n,a,o),e(s,[a,o],(function(e){return e[0]===a&&e[1]===o}),!0),c&&r()}),n.disconnect=(o=n.disconnect,function(e,r,i){var u=s.size>0;if(void 0===e)o.apply(n),s.clear();else if("number"===typeof e){o.call(n,e);var c,l=zo(s);try{for(l.s();!(c=l.n()).done;){var h=c.value;h[1]===e&&s.delete(h)}}catch(ZJ){l.e(ZJ)}finally{l.f()}}else{t(e)?o.call(n,e,r,i):o.call(n,e,r);var f,p=zo(s);try{for(p.s();!(f=p.n()).done;){var d=f.value;d[0]!==e||void 0!==r&&d[1]!==r||void 0!==i&&d[2]!==i||s.delete(d)}}catch(ZJ){p.e(ZJ)}finally{p.f()}}var m=0===s.size;u&&m&&a()}),n}}(Xq,QW),kU=function(e,t){return function(n,r){r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:function(){return 1},set:function(){throw e()}}),Object.defineProperty(r,"channelCountMode",{get:function(){return"explicit"},set:function(){throw e()}});var a=n.createBufferSource();t(r,(function(){for(var e=r.numberOfInputs,t=0;t<e;t+=1)a.connect(r,0,t)}),(function(){return a.disconnect(r)}))}}(PG,bU),xU=function(e,t){return function(n,r){var a=n.createChannelMerger(r.numberOfInputs);return null!==e&&"webkitAudioContext"===e.name&&t(n,a),jG(a,r),a}}(XW,kU),wU=function(e,t,n){return function(){var r=new WeakMap,a=function(){var a=_(x().mark((function a(i,o){var s,u;return x().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return s=t(i),Mq(s,o)||(u={channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,numberOfInputs:s.numberOfInputs},s=e(o,u)),r.set(o,s),a.next=6,n(i,o,s);case 6:return a.abrupt("return",s);case 7:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}();return{render:function(e,t){var n=r.get(t);return void 0!==n?Promise.resolve(n):a(e,t)}}}}(xU,rG,jW),_U=function(e,t,n,r,a){return function(e){h(o,e);var i=g(o);function o(e,u){s(this,o);var c=r(e),l=Nq(Nq({},wG),u),h=n(c,l),f=a(c)?t():null;return i.call(this,e,!1,h,f)}return c(o)}(e)}(ZW,wU,xU,GW,UW),SU=function(e,t,n){return function(){var r=new WeakMap,a=function(){var a=_(x().mark((function a(i,o){var s,u;return x().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return s=t(i),Mq(s,o)||(u={channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,numberOfOutputs:s.numberOfOutputs},s=e(o,u)),r.set(o,s),a.next=6,n(i,o,s);case 6:return a.abrupt("return",s);case 7:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}();return{render:function(e,t){var n=r.get(t);return void 0!==n?Promise.resolve(n):a(e,t)}}}}(QG,rG,jW),CU=function(e,t,n,r,a,i){return function(e){h(u,e);var o=g(u);function u(e,c){s(this,u);var l=r(e),h=i(Nq(Nq({},_G),c)),f=n(l,h),p=a(l)?t():null;return o.call(this,e,!1,f,p)}return c(u)}(e)}(ZW,SU,QG,GW,UW,(function(e){return Nq(Nq({},e),{},{channelCount:e.numberOfOutputs})})),TU=function(e,t,n,r){return function(a,i){var o=i.offset,s=$G(i,ZG),u=a.createBuffer(1,2,44100),c=t(a,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),l=n(a,Nq(Nq({},s),{},{gain:o})),h=u.getChannelData(0);h[0]=1,h[1]=1,c.buffer=u,c.loop=!0;var f={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(e){l.channelCount=e},get channelCountMode(){return l.channelCountMode},set channelCountMode(e){l.channelCountMode=e},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(e){l.channelInterpretation=e},get context(){return l.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get offset(){return l.gain},get onended(){return c.onended},set onended(e){c.onended=e},addEventListener:function(){return c.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent:function(){return c.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener:function(){return c.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},start:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;c.start.call(c,e)},stop:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;c.stop.call(c,e)}};return e(a,c),r(JG(f,l),(function(){return c.connect(l)}),(function(){return c.disconnect(l)}))}}(sU,lU,tW,bU),EU=function(e,t,n,r,a){return function(i,o){if(void 0===i.createConstantSource)return n(i,o);var s=i.createConstantSource();return jG(s,o),GG(s,o,"offset"),t(r,(function(){return r(i)}))||WG(s),t(a,(function(){return a(i)}))||UG(s),e(i,s),s}}(sU,LW,TU,CW,EW),IU=function(e,t,n,r,a){return function(){var i=new WeakMap,o=null,s=null,u=function(){var u=_(x().mark((function u(c,l){var h,f,p;return x().wrap((function(u){for(;;)switch(u.prev=u.next){case 0:if(h=n(c),(f=Mq(h,l))||(p={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,offset:h.offset.value},h=t(l,p),null!==o&&h.start(o),null!==s&&h.stop(s)),i.set(l,h),f){u.next=9;break}return u.next=7,r(l,c.offset,h.offset);case 7:u.next=11;break;case 9:return u.next=11,e(l,c.offset,h.offset);case 11:return u.next=13,a(c,l,h);case 13:return u.abrupt("return",h);case 14:case"end":return u.stop()}}),u)})));return function(e,t){return u.apply(this,arguments)}}();return{set start(e){o=e},set stop(e){s=e},render:function(e,t){var n=i.get(t);return void 0!==n?Promise.resolve(n):u(e,t)}}}}(cU,EU,rG,hU,jW),AU=function(e,t,n,r,a,i,o){return function(e){h(l,e);var u=g(l);function l(e,o){var c;s(this,l);var h=a(e),f=Nq(Nq({},SG),o),p=r(h,f),d=i(h),v=d?n():null;return(c=u.call(this,e,!1,p,v))._constantSourceNodeRenderer=v,c._nativeConstantSourceNode=p,c._offset=t(m(c),d,p.offset,zq,Lq),c._onended=null,c}return c(l,[{key:"offset",get:function(){return this._offset}},{key:"onended",get:function(){return this._onended},set:function(e){var t="function"===typeof e?o(this,e):null;this._nativeConstantSourceNode.onended=t;var n=this._nativeConstantSourceNode.onended;this._onended=null!==n&&n===t?e:n}},{key:"start",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this._nativeConstantSourceNode.start(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=t),"closed"!==this.context.state){Cq(this);var n=function t(){e._nativeConstantSourceNode.removeEventListener("ended",t),Bq(e)&&Eq(e)};this._nativeConstantSourceNode.addEventListener("ended",n)}}},{key:"stop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._nativeConstantSourceNode.stop(e),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=e)}}]),l}(e)}(ZW,pU,IU,EU,GW,UW,PW),NU=function(e,t){return function(n,r){var a=n.createConvolver();if(jG(a,r),r.disableNormalization===a.normalize&&(a.normalize=!r.disableNormalization),VG(a,r,"buffer"),r.channelCount>2)throw e();if(t(a,"channelCount",(function(e){return function(){return e.call(a)}}),(function(t){return function(n){if(n>2)throw e();return t.call(a,n)}})),"max"===r.channelCountMode)throw e();return t(a,"channelCountMode",(function(e){return function(){return e.call(a)}}),(function(t){return function(n){if("max"===n)throw e();return t.call(a,n)}})),a}}(dW,SW),PU=function(e,t,n){return function(){var r=new WeakMap,a=function(){var a=_(x().mark((function a(i,o){var s,u;return x().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(s=t(i),Mq(s,o)||(u={buffer:s.buffer,channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,disableNormalization:!s.normalize},s=e(o,u)),r.set(o,s),!$q(s)){a.next=9;break}return a.next=7,n(i,o,s.inputs[0]);case 7:a.next=11;break;case 9:return a.next=11,n(i,o,s);case 11:return a.abrupt("return",s);case 12:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}();return{render:function(e,t){var n=r.get(t);return void 0!==n?Promise.resolve(n):a(e,t)}}}}(NU,rG,jW),MU=function(e,t,n,r,a,i){return function(e){h(u,e);var o=g(u);function u(e,c){var l;s(this,u);var h=r(e),f=Nq(Nq({},CG),c),p=n(h,f),d=a(h)?t():null;return(l=o.call(this,e,!1,p,d))._isBufferNullified=!1,l._nativeConvolverNode=p,null!==f.buffer&&i(m(l),f.buffer.duration),l}return c(u,[{key:"buffer",get:function(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer},set:function(e){if(this._nativeConvolverNode.buffer=e,null===e&&null!==this._nativeConvolverNode.buffer){var t=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=t.createBuffer(1,1,44100),this._isBufferNullified=!0,i(this,0)}else this._isBufferNullified=!1,i(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}},{key:"normalize",get:function(){return this._nativeConvolverNode.normalize},set:function(e){this._nativeConvolverNode.normalize=e}}]),u}(e)}(ZW,PU,NU,GW,UW,gU),DU=function(e,t,n,r,a){return function(i){var o=new WeakMap,s=function(){var s=_(x().mark((function s(u,c){var l,h,f;return x().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(l=n(u),(h=Mq(l,c))||(f={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,delayTime:l.delayTime.value,maxDelayTime:i},l=t(c,f)),o.set(c,l),h){s.next=9;break}return s.next=7,r(c,u.delayTime,l.delayTime);case 7:s.next=11;break;case 9:return s.next=11,e(c,u.delayTime,l.delayTime);case 11:return s.next=13,a(u,c,l);case 13:return s.abrupt("return",l);case 14:case"end":return s.stop()}}),s)})));return function(e,t){return s.apply(this,arguments)}}();return{render:function(e,t){var n=o.get(t);return void 0!==n?Promise.resolve(n):s(e,t)}}}}(cU,eW,rG,hU,jW),RU=function(e,t,n,r,a,i,o){return function(e){h(l,e);var u=g(l);function l(e,c){var h;s(this,l);var f=a(e),p=Nq(Nq({},EG),c),d=r(f,p),v=i(f),g=v?n(p.maxDelayTime):null;return(h=u.call(this,e,!1,d,g))._delayTime=t(m(h),v,d.delayTime),o(m(h),p.maxDelayTime),h}return c(l,[{key:"delayTime",get:function(){return this._delayTime}}]),l}(e)}(ZW,pU,DU,eW,GW,UW,gU),OU=function(e){return function(t,n){var r=t.createDynamicsCompressor();if(jG(r,n),n.channelCount>2)throw e();if("max"===n.channelCountMode)throw e();return GG(r,n,"attack"),GG(r,n,"knee"),GG(r,n,"ratio"),GG(r,n,"release"),GG(r,n,"threshold"),r}}(dW),FU=function(e,t,n,r,a){return function(){var i=new WeakMap,o=function(){var o=_(x().mark((function o(s,u){var c,l,h;return x().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(c=n(s),(l=Mq(c,u))||(h={attack:c.attack.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,knee:c.knee.value,ratio:c.ratio.value,release:c.release.value,threshold:c.threshold.value},c=t(u,h)),i.set(u,c),l){o.next=17;break}return o.next=7,r(u,s.attack,c.attack);case 7:return o.next=9,r(u,s.knee,c.knee);case 9:return o.next=11,r(u,s.ratio,c.ratio);case 11:return o.next=13,r(u,s.release,c.release);case 13:return o.next=15,r(u,s.threshold,c.threshold);case 15:o.next=27;break;case 17:return o.next=19,e(u,s.attack,c.attack);case 19:return o.next=21,e(u,s.knee,c.knee);case 21:return o.next=23,e(u,s.ratio,c.ratio);case 23:return o.next=25,e(u,s.release,c.release);case 25:return o.next=27,e(u,s.threshold,c.threshold);case 27:return o.next=29,a(s,u,c);case 29:return o.abrupt("return",c);case 30:case"end":return o.stop()}}),o)})));return function(e,t){return o.apply(this,arguments)}}();return{render:function(e,t){var n=i.get(t);return void 0!==n?Promise.resolve(n):o(e,t)}}}}(cU,OU,rG,hU,jW),LU=function(e,t,n,r,a,i,o,u){return function(e){h(f,e);var l=g(f);function f(e,a){var c;s(this,f);var h=i(e),p=Nq(Nq({},AG),a),d=r(h,p),v=o(h),g=v?n():null;return(c=l.call(this,e,!1,d,g))._attack=t(m(c),v,d.attack),c._knee=t(m(c),v,d.knee),c._nativeDynamicsCompressorNode=d,c._ratio=t(m(c),v,d.ratio),c._release=t(m(c),v,d.release),c._threshold=t(m(c),v,d.threshold),u(m(c),.006),c}return c(f,[{key:"attack",get:function(){return this._attack}},{key:"channelCount",get:function(){return this._nativeDynamicsCompressorNode.channelCount},set:function(e){var t=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=e,e>2)throw this._nativeDynamicsCompressorNode.channelCount=t,a()}},{key:"channelCountMode",get:function(){return this._nativeDynamicsCompressorNode.channelCountMode},set:function(e){var t=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=e,"max"===e)throw this._nativeDynamicsCompressorNode.channelCountMode=t,a()}},{key:"knee",get:function(){return this._knee}},{key:"ratio",get:function(){return this._ratio}},{key:"reduction",get:function(){return"number"===typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}},{key:"release",get:function(){return this._release}},{key:"threshold",get:function(){return this._threshold}}]),f}(e)}(ZW,pU,FU,OU,dW,GW,UW,gU),zU=function(e,t,n,r,a){return function(){var i=new WeakMap,o=function(){var o=_(x().mark((function o(s,u){var c,l,h;return x().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(c=n(s),(l=Mq(c,u))||(h={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,gain:c.gain.value},c=t(u,h)),i.set(u,c),l){o.next=9;break}return o.next=7,r(u,s.gain,c.gain);case 7:o.next=11;break;case 9:return o.next=11,e(u,s.gain,c.gain);case 11:return o.next=13,a(s,u,c);case 13:return o.abrupt("return",c);case 14:case"end":return o.stop()}}),o)})));return function(e,t){return o.apply(this,arguments)}}();return{render:function(e,t){var n=i.get(t);return void 0!==n?Promise.resolve(n):o(e,t)}}}}(cU,tW,rG,hU,jW),BU=function(e,t,n,r,a,i){return function(e){h(u,e);var o=g(u);function u(e,c){var l;s(this,u);var h=a(e),f=Nq(Nq({},NG),c),p=r(h,f),d=i(h),v=d?n():null;return(l=o.call(this,e,!1,p,v))._gain=t(m(l),d,p.gain,zq,Lq),l}return c(u,[{key:"gain",get:function(){return this._gain}}]),u}(e)}(ZW,pU,zU,tW,GW,UW),VU=function(e,t,n,r){return function(a,i,o){var s=o.channelCount,u=o.channelCountMode,c=o.channelInterpretation,l=o.feedback,h=o.feedforward,f=HG(i,a.sampleRate),p=l instanceof Float64Array?l:new Float64Array(l),d=h instanceof Float64Array?h:new Float64Array(h),m=p.length,v=d.length,g=Math.min(m,v);if(0===m||m>20)throw r();if(0===p[0])throw t();if(0===v||v>20)throw r();if(0===d[0])throw t();if(1!==p[0]){for(var y=0;y<v;y+=1)d[y]/=p[0];for(var b=1;b<m;b+=1)p[b]/=p[0]}var k=n(a,f,s,s);k.channelCount=s,k.channelCountMode=u,k.channelInterpretation=c;for(var x=[],w=[],_=[],S=0;S<s;S+=1){x.push(0);var C=new Float32Array(32),T=new Float32Array(32);C.fill(0),T.fill(0),w.push(C),_.push(T)}k.onaudioprocess=function(e){for(var t=e.inputBuffer,n=e.outputBuffer,r=t.numberOfChannels,a=0;a<r;a+=1){var i=t.getChannelData(a),o=n.getChannelData(a);x[a]=RG(p,m,d,v,g,w[a],_[a],x[a],32,i,o)}};var E=a.sampleRate/2,I={get bufferSize(){return f},get channelCount(){return k.channelCount},set channelCount(e){k.channelCount=e},get channelCountMode(){return k.channelCountMode},set channelCountMode(e){k.channelCountMode=e},get channelInterpretation(){return k.channelInterpretation},set channelInterpretation(e){k.channelInterpretation=e},get context(){return k.context},get inputs(){return[k]},get numberOfInputs(){return k.numberOfInputs},get numberOfOutputs(){return k.numberOfOutputs},addEventListener:function(){return k.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent:function(){return k.dispatchEvent(arguments.length<=0?void 0:arguments[0])},getFrequencyResponse:function(t,n,r){if(t.length!==n.length||n.length!==r.length)throw e();for(var a=t.length,i=0;i<a;i+=1){var o=-Math.PI*(t[i]/E),s=[Math.cos(o),Math.sin(o)],u=nW(rW(d,s),rW(p,s));n[i]=Math.sqrt(u[0]*u[0]+u[1]*u[1]),r[i]=Math.atan2(u[1],u[0])}},removeEventListener:function(){return k.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}};return JG(I,k)}}(MG,PG,hW,dW),jU=function(e,t,n,r){return function(a){return e(zG,(function(){return zG(a)}))?Promise.resolve(e(r,r)).then((function(e){if(!e){var t=n(a,512,0,1);a.oncomplete=function(){t.onaudioprocess=null,t.disconnect()},t.onaudioprocess=function(){return a.currentTime},t.connect(a.destination)}return a.startRendering()})):new Promise((function(e){var n=t(a,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});a.oncomplete=function(t){n.disconnect(),e(t.renderedBuffer)},n.connect(a.destination),a.startRendering()}))}}(LW,tW,hW,function(e,t){return function(){if(null===t)return Promise.resolve(!1);var n=new t(1,1,44100),r=e(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise((function(e){n.oncomplete=function(){r.disconnect(),e(0!==n.currentTime)},n.startRendering()}))}}(tW,WW)),qU=function(e,t,n,r,a){return function(i,o){var s=new WeakMap,u=null,c=function(){var c=_(x().mark((function c(l,h){var f,p,d,m,v;return x().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(f=null,p=t(l),d=Mq(p,h),void 0===h.createIIRFilter?f=e(h,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):d||(p=h.createIIRFilter(o,i)),s.set(h,null===f?p:f),null===f){c.next=17;break}if(null!==u){c.next=11;break}if(null!==n){c.next=9;break}throw new Error("Missing the native OfflineAudioContext constructor.");case 9:m=new n(l.context.destination.channelCount,l.context.length,h.sampleRate),u=_(x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(l,m,m.destination);case 2:return e.next=4,a(m);case 4:return t=e.sent,e.abrupt("return",OG(t,h,i,o));case 6:case"end":return e.stop()}}),e)})))();case 11:return c.next=13,u;case 13:return v=c.sent,f.buffer=v,f.start(0),c.abrupt("return",f);case 17:return c.next=19,r(l,h,p);case 19:return c.abrupt("return",p);case 20:case"end":return c.stop()}}),c)})));return function(e,t){return c.apply(this,arguments)}}();return{render:function(e,t){var n=s.get(t);return void 0!==n?Promise.resolve(n):c(e,t)}}}}(lU,rG,WW,jW,jU),GU=function(e){return function(t,n,r){if(void 0===t.createIIRFilter)return e(t,n,r);var a=t.createIIRFilter(r.feedforward,r.feedback);return jG(a,r),a}}(VU),WU=function(e,t,n,r,a,i){return function(e){h(u,e);var o=g(u);function u(e,c){var l;s(this,u);var h=r(e),f=a(h),p=Nq(Nq({},DG),c),d=t(h,f?null:e.baseLatency,p),v=f?n(p.feedback,p.feedforward):null;return l=o.call(this,e,!1,d,v),function(e){var t;e.getFrequencyResponse=(t=e.getFrequencyResponse,function(n,r,a){if(n.length!==r.length||r.length!==a.length)throw MG();return t.call(e,n,r,a)})}(d),l._nativeIIRFilterNode=d,i(m(l),1),l}return c(u,[{key:"getFrequencyResponse",value:function(e,t,n){return this._nativeIIRFilterNode.getFrequencyResponse(e,t,n)}}]),u}(e)}(ZW,GU,qU,GW,UW,gU),UU=function(e,t,n,r,a,i,o,s){return function(u,c){var l=c.listener,h=void 0===l.forwardX?function(){var h=new Float32Array(1),f=t(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),p=o(c),d=!1,m=[0,0,-1,0,1,0],v=[0,0,0],g=function(){if(!d){d=!0;var e=r(c,256,9,0);e.onaudioprocess=function(e){var t=e.inputBuffer,n=[i(t,h,0),i(t,h,1),i(t,h,2),i(t,h,3),i(t,h,4),i(t,h,5)];n.some((function(e,t){return e!==m[t]}))&&(l.setOrientation.apply(l,n),m=n);var r=[i(t,h,6),i(t,h,7),i(t,h,8)];r.some((function(e,t){return e!==v[t]}))&&(l.setPosition.apply(l,r),v=r)},f.connect(e)}},y=function(e){return function(t){t!==m[e]&&(m[e]=t,l.setOrientation.apply(l,Fn(m)))}},b=function(e){return function(t){t!==v[e]&&(v[e]=t,l.setPosition.apply(l,Fn(v)))}},k=function(t,r,i){var o=n(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:r});o.connect(f,0,t),o.start(),Object.defineProperty(o.offset,"defaultValue",{get:function(){return r}});var l,h,d,m,v,y,b,k=e({context:u},p,o.offset,zq,Lq);return s(k,"value",(function(e){return function(){return e.call(k)}}),(function(e){return function(t){try{e.call(k,t)}catch(ZJ){if(9!==ZJ.code)throw ZJ}g(),p&&i(t)}})),k.cancelAndHoldAtTime=(l=k.cancelAndHoldAtTime,p?function(){throw a()}:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=l.apply(k,t);return g(),r}),k.cancelScheduledValues=(h=k.cancelScheduledValues,p?function(){throw a()}:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=h.apply(k,t);return g(),r}),k.exponentialRampToValueAtTime=(d=k.exponentialRampToValueAtTime,p?function(){throw a()}:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=d.apply(k,t);return g(),r}),k.linearRampToValueAtTime=(m=k.linearRampToValueAtTime,p?function(){throw a()}:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=m.apply(k,t);return g(),r}),k.setTargetAtTime=(v=k.setTargetAtTime,p?function(){throw a()}:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=v.apply(k,t);return g(),r}),k.setValueAtTime=(y=k.setValueAtTime,p?function(){throw a()}:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=y.apply(k,t);return g(),r}),k.setValueCurveAtTime=(b=k.setValueCurveAtTime,p?function(){throw a()}:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=b.apply(k,t);return g(),r}),k};return{forwardX:k(0,0,y(0)),forwardY:k(1,0,y(1)),forwardZ:k(2,-1,y(2)),positionX:k(6,0,b(0)),positionY:k(7,0,b(1)),positionZ:k(8,0,b(2)),upX:k(3,0,y(3)),upY:k(4,1,y(4)),upZ:k(5,0,y(5))}}():l,f=h.forwardX,p=h.forwardY,d=h.forwardZ,m=h.positionX,v=h.positionY,g=h.positionZ,y=h.upX,b=h.upY,k=h.upZ;return{get forwardX(){return f},get forwardY(){return p},get forwardZ(){return d},get positionX(){return m},get positionY(){return v},get positionZ(){return g},get upX(){return y},get upY(){return b},get upZ(){return k}}}}(pU,xU,EU,hW,dW,wW,UW,SW),HU=new WeakMap,KU=function(e,t,n,r,a,i){return function(n){h(u,n);var o=g(u);function u(n,i){var c;return s(this,u),(c=o.call(this,n))._nativeContext=n,hq.set(m(c),n),r(n)&&a.set(n,new Set),c._destination=new e(m(c),i),c._listener=t(m(c),n),c._onstatechange=null,c}return c(u,[{key:"currentTime",get:function(){return this._nativeContext.currentTime}},{key:"destination",get:function(){return this._destination}},{key:"listener",get:function(){return this._listener}},{key:"onstatechange",get:function(){return this._onstatechange},set:function(e){var t="function"===typeof e?i(this,e):null;this._nativeContext.onstatechange=t;var n=this._nativeContext.onstatechange;this._onstatechange=null!==n&&n===t?e:n}},{key:"sampleRate",get:function(){return this._nativeContext.sampleRate}},{key:"state",get:function(){return this._nativeContext.state}}]),u}(n)}(mU,UU,KW,UW,HU,PW),XU=function(e,t,n,r,a,i){return function(o,s){var u=o.createOscillator();return jG(u,s),GG(u,s,"detune"),GG(u,s,"frequency"),void 0!==s.periodicWave?u.setPeriodicWave(s.periodicWave):VG(u,s,"type"),t(n,(function(){return n(o)}))||WG(u),t(r,(function(){return r(o)}))||i(u,o),t(a,(function(){return a(o)}))||UG(u),e(o,u),u}}(sU,LW,CW,TW,EW,NW),YU=function(e,t,n,r,a){return function(){var i=new WeakMap,o=null,s=null,u=null,c=function(){var c=_(x().mark((function c(l,h){var f,p,d;return x().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(f=n(l),(p=Mq(f,h))||(d={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,detune:f.detune.value,frequency:f.frequency.value,periodicWave:null===o?void 0:o,type:f.type},f=t(h,d),null!==s&&f.start(s),null!==u&&f.stop(u)),i.set(h,f),p){c.next=11;break}return c.next=7,r(h,l.detune,f.detune);case 7:return c.next=9,r(h,l.frequency,f.frequency);case 9:c.next=15;break;case 11:return c.next=13,e(h,l.detune,f.detune);case 13:return c.next=15,e(h,l.frequency,f.frequency);case 15:return c.next=17,a(l,h,f);case 17:return c.abrupt("return",f);case 18:case"end":return c.stop()}}),c)})));return function(e,t){return c.apply(this,arguments)}}();return{set periodicWave(e){o=e},set start(e){s=e},set stop(e){u=e},render:function(e,t){var n=i.get(t);return void 0!==n?Promise.resolve(n):c(e,t)}}}}(cU,XU,rG,hU,jW),QU=function(e,t,n,r,a,i,o){return function(e){h(l,e);var u=g(l);function l(e,o){var c;s(this,l);var h=a(e),f=Nq(Nq({},vW),o),p=n(h,f),d=i(h),v=d?r():null,g=e.sampleRate/2;return(c=u.call(this,e,!1,p,v))._detune=t(m(c),d,p.detune,153600,-153600),c._frequency=t(m(c),d,p.frequency,g,-g),c._nativeOscillatorNode=p,c._onended=null,c._oscillatorNodeRenderer=v,null!==c._oscillatorNodeRenderer&&void 0!==f.periodicWave&&(c._oscillatorNodeRenderer.periodicWave=f.periodicWave),c}return c(l,[{key:"detune",get:function(){return this._detune}},{key:"frequency",get:function(){return this._frequency}},{key:"onended",get:function(){return this._onended},set:function(e){var t="function"===typeof e?o(this,e):null;this._nativeOscillatorNode.onended=t;var n=this._nativeOscillatorNode.onended;this._onended=null!==n&&n===t?e:n}},{key:"type",get:function(){return this._nativeOscillatorNode.type},set:function(e){this._nativeOscillatorNode.type=e,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}},{key:"setPeriodicWave",value:function(e){this._nativeOscillatorNode.setPeriodicWave(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=e)}},{key:"start",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this._nativeOscillatorNode.start(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=t),"closed"!==this.context.state){Cq(this);var n=function t(){e._nativeOscillatorNode.removeEventListener("ended",t),Bq(e)&&Eq(e)};this._nativeOscillatorNode.addEventListener("ended",n)}}},{key:"stop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._nativeOscillatorNode.stop(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=e)}}]),l}(e)}(ZW,pU,XU,YU,GW,UW,PW),$U=function(e){return function(t,n){var r=e(t,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),a=t.createBuffer(1,2,44100);return r.buffer=a,r.loop=!0,r.connect(n),r.start(),function(){r.stop(),r.disconnect(n)}}}(lU),JU=function(e,t,n,r,a){return function(i,o){var s=o.curve,u=o.oversample,c=$G(o,pW),l=i.createWaveShaper(),h=i.createWaveShaper();jG(l,c),jG(h,c);var f=n(i,Nq(Nq({},c),{},{gain:1})),p=n(i,Nq(Nq({},c),{},{gain:-1})),d=n(i,Nq(Nq({},c),{},{gain:1})),m=n(i,Nq(Nq({},c),{},{gain:-1})),v=null,g=!1,y=null,b={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(e){f.channelCount=e,p.channelCount=e,l.channelCount=e,d.channelCount=e,h.channelCount=e,m.channelCount=e},get channelCountMode(){return l.channelCountMode},set channelCountMode(e){f.channelCountMode=e,p.channelCountMode=e,l.channelCountMode=e,d.channelCountMode=e,h.channelCountMode=e,m.channelCountMode=e},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(e){f.channelInterpretation=e,p.channelInterpretation=e,l.channelInterpretation=e,d.channelInterpretation=e,h.channelInterpretation=e,m.channelInterpretation=e},get context(){return l.context},get curve(){return y},set curve(n){if(null!==n&&n.length<2)throw t();if(null===n)l.curve=n,h.curve=n;else{var a=n.length,o=new Float32Array(a+2-a%2),s=new Float32Array(a+2-a%2);o[0]=n[0],s[0]=-n[a-1];for(var u=Math.ceil((a+1)/2),c=(a+1)/2-1,p=1;p<u;p+=1){var d=p/u*c,m=Math.floor(d),b=Math.ceil(d);o[p]=m===b?n[m]:(1-(d-m))*n[m]+(1-(b-d))*n[b],s[p]=m===b?-n[a-1-m]:-(1-(d-m))*n[a-1-m]-(1-(b-d))*n[a-1-b]}o[u]=a%2===1?n[u-1]:(n[u-2]+n[u-1])/2,l.curve=o,h.curve=s}y=n,g&&(r(y)&&null===v?v=e(i,f):null!==v&&(v(),v=null))},get inputs(){return[f]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get oversample(){return l.oversample},set oversample(e){l.oversample=e,h.oversample=e},addEventListener:function(){return f.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent:function(){return f.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener:function(){return f.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}};null!==s&&(b.curve=s instanceof Float32Array?s:new Float32Array(s)),u!==b.oversample&&(b.oversample=u);return a(JG(b,d),(function(){f.connect(l).connect(d),f.connect(p).connect(h).connect(m).connect(d),g=!0,r(y)&&(v=e(i,f))}),(function(){f.disconnect(l),l.disconnect(d),f.disconnect(p),p.disconnect(h),h.disconnect(m),m.disconnect(d),g=!1,null!==v&&(v(),v=null)}))}}($U,PG,tW,_W,bU),ZU=function(e,t,n,r,a,i,o){return function(s,u){var c=s.createWaveShaper();if(null!==i&&"webkitAudioContext"===i.name&&void 0===s.createGain().gain.automationRate)return n(s,u);jG(c,u);var l=null===u.curve||u.curve instanceof Float32Array?u.curve:new Float32Array(u.curve);if(null!==l&&l.length<2)throw t();VG(c,{curve:l},"curve"),VG(c,u,"oversample");var h=null,f=!1;o(c,"curve",(function(e){return function(){return e.call(c)}}),(function(t){return function(n){return t.call(c,n),f&&(r(n)&&null===h?h=e(s,c):r(n)||null===h||(h(),h=null)),n}}));return a(c,(function(){f=!0,r(c.curve)&&(h=e(s,c))}),(function(){f=!1,null!==h&&(h(),h=null)}))}}($U,PG,JU,_W,bU,XW,SW),eH=function(e,t,n,r,a,i,o,s,u,c){return function(l,h){var f=h.coneInnerAngle,p=h.coneOuterAngle,d=h.coneOuterGain,m=h.distanceModel,v=h.maxDistance,g=h.orientationX,y=h.orientationY,b=h.orientationZ,k=h.panningModel,x=h.positionX,w=h.positionY,_=h.positionZ,S=h.refDistance,C=h.rolloffFactor,T=$G(h,lW),E=l.createPanner();if(T.channelCount>2)throw o();if("max"===T.channelCountMode)throw o();jG(E,T);var I={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},A=n(l,Nq(Nq({},I),{},{channelInterpretation:"speakers",numberOfInputs:6})),N=r(l,Nq(Nq({},T),{},{gain:1})),P=r(l,Nq(Nq({},I),{},{gain:1})),M=r(l,Nq(Nq({},I),{},{gain:0})),D=r(l,Nq(Nq({},I),{},{gain:0})),R=r(l,Nq(Nq({},I),{},{gain:0})),O=r(l,Nq(Nq({},I),{},{gain:0})),F=r(l,Nq(Nq({},I),{},{gain:0})),L=a(l,256,6,1),z=i(l,Nq(Nq({},I),{},{curve:new Float32Array([1,1]),oversample:"none"})),B=[g,y,b],V=[x,w,_],j=new Float32Array(1);L.onaudioprocess=function(e){var t=e.inputBuffer,n=[u(t,j,0),u(t,j,1),u(t,j,2)];n.some((function(e,t){return e!==B[t]}))&&(E.setOrientation.apply(E,n),B=n);var r=[u(t,j,3),u(t,j,4),u(t,j,5)];r.some((function(e,t){return e!==V[t]}))&&(E.setPosition.apply(E,r),V=r)},Object.defineProperty(M.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(D.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(R.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(O.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(F.gain,"defaultValue",{get:function(){return 0}});var q={get bufferSize(){},get channelCount(){return E.channelCount},set channelCount(e){if(e>2)throw o();N.channelCount=e,E.channelCount=e},get channelCountMode(){return E.channelCountMode},set channelCountMode(e){if("max"===e)throw o();N.channelCountMode=e,E.channelCountMode=e},get channelInterpretation(){return E.channelInterpretation},set channelInterpretation(e){N.channelInterpretation=e,E.channelInterpretation=e},get coneInnerAngle(){return E.coneInnerAngle},set coneInnerAngle(e){E.coneInnerAngle=e},get coneOuterAngle(){return E.coneOuterAngle},set coneOuterAngle(e){E.coneOuterAngle=e},get coneOuterGain(){return E.coneOuterGain},set coneOuterGain(e){if(e<0||e>1)throw t();E.coneOuterGain=e},get context(){return E.context},get distanceModel(){return E.distanceModel},set distanceModel(e){E.distanceModel=e},get inputs(){return[N]},get maxDistance(){return E.maxDistance},set maxDistance(e){if(e<0)throw new RangeError;E.maxDistance=e},get numberOfInputs(){return E.numberOfInputs},get numberOfOutputs(){return E.numberOfOutputs},get orientationX(){return P.gain},get orientationY(){return M.gain},get orientationZ(){return D.gain},get panningModel(){return E.panningModel},set panningModel(e){E.panningModel=e},get positionX(){return R.gain},get positionY(){return O.gain},get positionZ(){return F.gain},get refDistance(){return E.refDistance},set refDistance(e){if(e<0)throw new RangeError;E.refDistance=e},get rolloffFactor(){return E.rolloffFactor},set rolloffFactor(e){if(e<0)throw new RangeError;E.rolloffFactor=e},addEventListener:function(){return N.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent:function(){return N.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener:function(){return N.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}};f!==q.coneInnerAngle&&(q.coneInnerAngle=f),p!==q.coneOuterAngle&&(q.coneOuterAngle=p),d!==q.coneOuterGain&&(q.coneOuterGain=d),m!==q.distanceModel&&(q.distanceModel=m),v!==q.maxDistance&&(q.maxDistance=v),g!==q.orientationX.value&&(q.orientationX.value=g),y!==q.orientationY.value&&(q.orientationY.value=y),b!==q.orientationZ.value&&(q.orientationZ.value=b),k!==q.panningModel&&(q.panningModel=k),x!==q.positionX.value&&(q.positionX.value=x),w!==q.positionY.value&&(q.positionY.value=w),_!==q.positionZ.value&&(q.positionZ.value=_),S!==q.refDistance&&(q.refDistance=S),C!==q.rolloffFactor&&(q.rolloffFactor=C),1===B[0]&&0===B[1]&&0===B[2]||E.setOrientation.apply(E,Fn(B)),0===V[0]&&0===V[1]&&0===V[2]||E.setPosition.apply(E,Fn(V));return c(JG(q,E),(function(){N.connect(E),e(N,z,0,0),z.connect(P).connect(A,0,0),z.connect(M).connect(A,0,1),z.connect(D).connect(A,0,2),z.connect(R).connect(A,0,3),z.connect(O).connect(A,0,4),z.connect(F).connect(A,0,5),A.connect(L).connect(l.destination)}),(function(){N.disconnect(E),s(N,z,0,0),z.disconnect(P),P.disconnect(A),z.disconnect(M),M.disconnect(A),z.disconnect(D),D.disconnect(A),z.disconnect(R),R.disconnect(A),z.disconnect(O),O.disconnect(A),z.disconnect(F),F.disconnect(A),A.disconnect(L),L.disconnect(l.destination)}))}}(Jq,PG,xU,tW,hW,ZU,dW,nG,wW,bU),tH=function(e){return function(t,n){var r=t.createPanner();return void 0===r.orientationX?e(t,n):(jG(r,n),GG(r,n,"orientationX"),GG(r,n,"orientationY"),GG(r,n,"orientationZ"),GG(r,n,"positionX"),GG(r,n,"positionY"),GG(r,n,"positionZ"),VG(r,n,"coneInnerAngle"),VG(r,n,"coneOuterAngle"),VG(r,n,"coneOuterGain"),VG(r,n,"distanceModel"),VG(r,n,"maxDistance"),VG(r,n,"panningModel"),VG(r,n,"refDistance"),VG(r,n,"rolloffFactor"),r)}}(eH),nH=function(e,t,n,r,a,i,o,s,u,c){return function(){var l=new WeakMap,h=null,f=function(){var f=_(x().mark((function f(p,d){var m,v,g,y,b,k,w;return x().wrap((function(f){for(;;)switch(f.prev=f.next){case 0:if(m=null,v=i(p),g={channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation},y=Nq(Nq({},g),{},{coneInnerAngle:v.coneInnerAngle,coneOuterAngle:v.coneOuterAngle,coneOuterGain:v.coneOuterGain,distanceModel:v.distanceModel,maxDistance:v.maxDistance,panningModel:v.panningModel,refDistance:v.refDistance,rolloffFactor:v.rolloffFactor}),b=Mq(v,d),"bufferSize"in v?m=r(d,Nq(Nq({},g),{},{gain:1})):b||(k=Nq(Nq({},y),{},{orientationX:v.orientationX.value,orientationY:v.orientationY.value,orientationZ:v.orientationZ.value,positionX:v.positionX.value,positionY:v.positionY.value,positionZ:v.positionZ.value}),v=a(d,k)),l.set(d,null===m?v:m),null===m){f.next=12;break}return f.delegateYield(x().mark((function e(){var i,l,f,v,b,k,w,S,C,T,E,I,A,N;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==h){e.next=7;break}if(null!==o){e.next=3;break}throw new Error("Missing the native OfflineAudioContext constructor.");case 3:i=new o(6,p.context.length,d.sampleRate),(l=t(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6})).connect(i.destination),h=_(x().mark((function e(){var t,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([p.orientationX,p.orientationY,p.orientationZ,p.positionX,p.positionY,p.positionZ].map(function(){var e=_(x().mark((function e(t,r){var a;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===r?1:0}),e.next=3,s(i,t,a.offset);case 3:return e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 2:for(t=e.sent,r=0;r<6;r+=1)t[r].connect(l,0,r),t[r].start(0);return e.abrupt("return",c(i));case 5:case"end":return e.stop()}}),e)})))();case 7:return e.next=9,h;case 9:return f=e.sent,v=r(d,Nq(Nq({},g),{},{gain:1})),e.next=13,u(p,d,v);case 13:for(b=[],k=0;k<f.numberOfChannels;k+=1)b.push(f.getChannelData(k));for(w=[b[0][0],b[1][0],b[2][0]],S=[b[3][0],b[4][0],b[5][0]],C=r(d,Nq(Nq({},g),{},{gain:1})),T=a(d,Nq(Nq({},y),{},{orientationX:w[0],orientationY:w[1],orientationZ:w[2],positionX:S[0],positionY:S[1],positionZ:S[2]})),v.connect(C).connect(T.inputs[0]),T.connect(m),E=128;E<f.length;E+=128)I=[b[0][E],b[1][E],b[2][E]],A=[b[3][E],b[4][E],b[5][E]],(I.some((function(e,t){return e!==w[t]}))||A.some((function(e,t){return e!==S[t]})))&&(w=I,S=A,N=E/d.sampleRate,C.gain.setValueAtTime(0,N),C=r(d,Nq(Nq({},g),{},{gain:0})),T=a(d,Nq(Nq({},y),{},{orientationX:w[0],orientationY:w[1],orientationZ:w[2],positionX:S[0],positionY:S[1],positionZ:S[2]})),C.gain.setValueAtTime(1,N),v.connect(C).connect(T.inputs[0]),T.connect(m));return e.abrupt("return",{v:m});case 23:case"end":return e.stop()}}),e)}))(),"t0",9);case 9:if("object"!==typeof(w=f.t0)){f.next=12;break}return f.abrupt("return",w.v);case 12:if(b){f.next=27;break}return f.next=15,s(d,p.orientationX,v.orientationX);case 15:return f.next=17,s(d,p.orientationY,v.orientationY);case 17:return f.next=19,s(d,p.orientationZ,v.orientationZ);case 19:return f.next=21,s(d,p.positionX,v.positionX);case 21:return f.next=23,s(d,p.positionY,v.positionY);case 23:return f.next=25,s(d,p.positionZ,v.positionZ);case 25:f.next=39;break;case 27:return f.next=29,e(d,p.orientationX,v.orientationX);case 29:return f.next=31,e(d,p.orientationY,v.orientationY);case 31:return f.next=33,e(d,p.orientationZ,v.orientationZ);case 33:return f.next=35,e(d,p.positionX,v.positionX);case 35:return f.next=37,e(d,p.positionY,v.positionY);case 37:return f.next=39,e(d,p.positionZ,v.positionZ);case 39:if(!$q(v)){f.next=44;break}return f.next=42,u(p,d,v.inputs[0]);case 42:f.next=46;break;case 44:return f.next=46,u(p,d,v);case 46:return f.abrupt("return",v);case 47:case"end":return f.stop()}}),f)})));return function(e,t){return f.apply(this,arguments)}}();return{render:function(e,t){var n=l.get(t);return void 0!==n?Promise.resolve(n):f(e,t)}}}}(cU,xU,EU,tW,tH,rG,WW,hU,jW,jU),rH=function(e,t,n,r,a,i,o){return function(e){h(l,e);var u=g(l);function l(e,c){var h;s(this,l);var f=a(e),p=Nq(Nq({},gW),c),d=n(f,p),v=i(f),g=v?r():null;return(h=u.call(this,e,!1,d,g))._nativePannerNode=d,h._orientationX=t(m(h),v,d.orientationX,zq,Lq),h._orientationY=t(m(h),v,d.orientationY,zq,Lq),h._orientationZ=t(m(h),v,d.orientationZ,zq,Lq),h._positionX=t(m(h),v,d.positionX,zq,Lq),h._positionY=t(m(h),v,d.positionY,zq,Lq),h._positionZ=t(m(h),v,d.positionZ,zq,Lq),o(m(h),1),h}return c(l,[{key:"coneInnerAngle",get:function(){return this._nativePannerNode.coneInnerAngle},set:function(e){this._nativePannerNode.coneInnerAngle=e}},{key:"coneOuterAngle",get:function(){return this._nativePannerNode.coneOuterAngle},set:function(e){this._nativePannerNode.coneOuterAngle=e}},{key:"coneOuterGain",get:function(){return this._nativePannerNode.coneOuterGain},set:function(e){this._nativePannerNode.coneOuterGain=e}},{key:"distanceModel",get:function(){return this._nativePannerNode.distanceModel},set:function(e){this._nativePannerNode.distanceModel=e}},{key:"maxDistance",get:function(){return this._nativePannerNode.maxDistance},set:function(e){this._nativePannerNode.maxDistance=e}},{key:"orientationX",get:function(){return this._orientationX}},{key:"orientationY",get:function(){return this._orientationY}},{key:"orientationZ",get:function(){return this._orientationZ}},{key:"panningModel",get:function(){return this._nativePannerNode.panningModel},set:function(e){this._nativePannerNode.panningModel=e}},{key:"positionX",get:function(){return this._positionX}},{key:"positionY",get:function(){return this._positionY}},{key:"positionZ",get:function(){return this._positionZ}},{key:"refDistance",get:function(){return this._nativePannerNode.refDistance},set:function(e){this._nativePannerNode.refDistance=e}},{key:"rolloffFactor",get:function(){return this._nativePannerNode.rolloffFactor},set:function(e){this._nativePannerNode.rolloffFactor=e}}]),l}(e)}(ZW,pU,tH,nH,GW,UW,gU),aH=function(e){return function(t,n){var r=n.disableNormalization,a=n.imag,i=n.real,o=a instanceof Float32Array?a:new Float32Array(a),s=i instanceof Float32Array?i:new Float32Array(i),u=t.createPeriodicWave(s,o,{disableNormalization:r});if(Array.from(a).length<2)throw e();return u}}(Rq),iH=function(e,t,n,r){return function(a){function i(a,o){s(this,i);var u=t(a),c=r(Nq(Nq({},yW),o)),l=e(u,c);return n.add(l),l}return c(i,null,[{key:Symbol.hasInstance,value:function(e){return null!==e&&"object"===typeof e&&Object.getPrototypeOf(e)===i.prototype||n.has(e)}}]),i}()}(aH,GW,new WeakSet,(function(e){var t=e.imag,n=e.real;return Nq(Nq({},e),{},void 0===t?void 0===n?{imag:[0,0],real:[0,0]}:{imag:Array.from(n,(function(){return 0})),real:n}:void 0===n?{imag:t,real:Array.from(t,(function(){return 0}))}:{imag:t,real:n})})),oH=function(e,t,n,r,a,i){var o=16385,s=new Float32Array([1,1]),u=Math.PI/2,c={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},l=Nq(Nq({},c),{},{oversample:"none"}),h=function(e,i,h,f,p){if(1===i)return function(e,t,a,i){for(var h=new Float32Array(o),f=new Float32Array(o),p=0;p<o;p+=1){var d=p/16384*u;h[p]=Math.cos(d),f[p]=Math.sin(d)}var m=n(e,Nq(Nq({},c),{},{gain:0})),v=r(e,Nq(Nq({},l),{},{curve:h})),g=r(e,Nq(Nq({},l),{},{curve:s})),y=n(e,Nq(Nq({},c),{},{gain:0})),b=r(e,Nq(Nq({},l),{},{curve:f}));return{connectGraph:function(){t.connect(m),t.connect(void 0===g.inputs?g:g.inputs[0]),t.connect(y),g.connect(a),a.connect(void 0===v.inputs?v:v.inputs[0]),a.connect(void 0===b.inputs?b:b.inputs[0]),v.connect(m.gain),b.connect(y.gain),m.connect(i,0,0),y.connect(i,0,1)},disconnectGraph:function(){t.disconnect(m),t.disconnect(void 0===g.inputs?g:g.inputs[0]),t.disconnect(y),g.disconnect(a),a.disconnect(void 0===v.inputs?v:v.inputs[0]),a.disconnect(void 0===b.inputs?b:b.inputs[0]),v.disconnect(m.gain),b.disconnect(y.gain),m.disconnect(i,0,0),y.disconnect(i,0,1)}}}(e,h,f,p);if(2===i)return function(e,a,i,h){for(var f=new Float32Array(o),p=new Float32Array(o),d=new Float32Array(o),m=new Float32Array(o),v=Math.floor(8192.5),g=0;g<o;g+=1)if(g>v){var y=(g-v)/(16384-v)*u;f[g]=Math.cos(y),p[g]=Math.sin(y),d[g]=0,m[g]=1}else{var b=g/(16384-v)*u;f[g]=1,p[g]=0,d[g]=Math.cos(b),m[g]=Math.sin(b)}var k=t(e,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),x=n(e,Nq(Nq({},c),{},{gain:0})),w=r(e,Nq(Nq({},l),{},{curve:f})),_=n(e,Nq(Nq({},c),{},{gain:0})),S=r(e,Nq(Nq({},l),{},{curve:p})),C=r(e,Nq(Nq({},l),{},{curve:s})),T=n(e,Nq(Nq({},c),{},{gain:0})),E=r(e,Nq(Nq({},l),{},{curve:d})),I=n(e,Nq(Nq({},c),{},{gain:0})),A=r(e,Nq(Nq({},l),{},{curve:m}));return{connectGraph:function(){a.connect(k),a.connect(void 0===C.inputs?C:C.inputs[0]),k.connect(x,0),k.connect(_,0),k.connect(T,1),k.connect(I,1),C.connect(i),i.connect(void 0===w.inputs?w:w.inputs[0]),i.connect(void 0===S.inputs?S:S.inputs[0]),i.connect(void 0===E.inputs?E:E.inputs[0]),i.connect(void 0===A.inputs?A:A.inputs[0]),w.connect(x.gain),S.connect(_.gain),E.connect(T.gain),A.connect(I.gain),x.connect(h,0,0),T.connect(h,0,0),_.connect(h,0,1),I.connect(h,0,1)},disconnectGraph:function(){a.disconnect(k),a.disconnect(void 0===C.inputs?C:C.inputs[0]),k.disconnect(x,0),k.disconnect(_,0),k.disconnect(T,1),k.disconnect(I,1),C.disconnect(i),i.disconnect(void 0===w.inputs?w:w.inputs[0]),i.disconnect(void 0===S.inputs?S:S.inputs[0]),i.disconnect(void 0===E.inputs?E:E.inputs[0]),i.disconnect(void 0===A.inputs?A:A.inputs[0]),w.disconnect(x.gain),S.disconnect(_.gain),E.disconnect(T.gain),A.disconnect(I.gain),x.disconnect(h,0,0),T.disconnect(h,0,0),_.disconnect(h,0,1),I.disconnect(h,0,1)}}}(e,h,f,p);throw a()};return function(t,r){var o=r.channelCount,s=r.channelCountMode,u=r.pan,c=$G(r,fW);if("max"===s)throw a();var l=e(t,Nq(Nq({},c),{},{channelCount:1,channelCountMode:s,numberOfInputs:2})),f=n(t,Nq(Nq({},c),{},{channelCount:o,channelCountMode:s,gain:1})),p=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:u}),d=h(t,o,f,p,l),m=d.connectGraph,v=d.disconnectGraph;Object.defineProperty(p.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(p.gain,"maxValue",{get:function(){return 1}}),Object.defineProperty(p.gain,"minValue",{get:function(){return-1}});var g={get bufferSize(){},get channelCount(){return f.channelCount},set channelCount(e){if(f.channelCount!==e){y&&v();var n=h(t,e,f,p,l);m=n.connectGraph,v=n.disconnectGraph,y&&m()}f.channelCount=e},get channelCountMode(){return f.channelCountMode},set channelCountMode(e){if("clamped-max"===e||"max"===e)throw a();f.channelCountMode=e},get channelInterpretation(){return f.channelInterpretation},set channelInterpretation(e){f.channelInterpretation=e},get context(){return f.context},get inputs(){return[f]},get numberOfInputs(){return f.numberOfInputs},get numberOfOutputs(){return f.numberOfOutputs},get pan(){return p.gain},addEventListener:function(){return f.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent:function(){return f.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener:function(){return f.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}},y=!1;return i(JG(g,l),(function(){m(),y=!0}),(function(){v(),y=!1}))}}(xU,QG,tW,ZU,dW,bU),sH=function(e,t){return function(n,r){var a=r.channelCountMode;if("clamped-max"===a)throw t();if(void 0===n.createStereoPanner)return e(n,r);var i=n.createStereoPanner();return jG(i,r),GG(i,r,"pan"),Object.defineProperty(i,"channelCountMode",{get:function(){return a},set:function(e){if(e!==a)throw t()}}),i}}(oH,dW),uH=function(e,t,n,r,a){return function(){var i=new WeakMap,o=function(){var o=_(x().mark((function o(s,u){var c,l,h;return x().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(c=n(s),(l=Mq(c,u))||(h={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,pan:c.pan.value},c=t(u,h)),i.set(u,c),l){o.next=9;break}return o.next=7,r(u,s.pan,c.pan);case 7:o.next=11;break;case 9:return o.next=11,e(u,s.pan,c.pan);case 11:if(!$q(c)){o.next=16;break}return o.next=14,a(s,u,c.inputs[0]);case 14:o.next=18;break;case 16:return o.next=18,a(s,u,c);case 18:return o.abrupt("return",c);case 19:case"end":return o.stop()}}),o)})));return function(e,t){return o.apply(this,arguments)}}();return{render:function(e,t){var n=i.get(t);return void 0!==n?Promise.resolve(n):o(e,t)}}}}(cU,sH,rG,hU,jW),cH=function(e,t,n,r,a,i){return function(e){h(u,e);var o=g(u);function u(e,c){var l;s(this,u);var h=a(e),f=Nq(Nq({},bW),c),p=n(h,f),d=i(h),v=d?r():null;return(l=o.call(this,e,!1,p,v))._pan=t(m(l),d,p.pan),l}return c(u,[{key:"pan",get:function(){return this._pan}}]),u}(e)}(ZW,pU,sH,uH,GW,UW),lH=function(e,t,n){return function(){var r=new WeakMap,a=function(){var a=_(x().mark((function a(i,o){var s,u;return x().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(s=t(i),Mq(s,o)||(u={channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,curve:s.curve,oversample:s.oversample},s=e(o,u)),r.set(o,s),!$q(s)){a.next=9;break}return a.next=7,n(i,o,s.inputs[0]);case 7:a.next=11;break;case 9:return a.next=11,n(i,o,s);case 11:return a.abrupt("return",s);case 12:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}();return{render:function(e,t){var n=r.get(t);return void 0!==n?Promise.resolve(n):a(e,t)}}}}(ZU,rG,jW),hH=function(e,t,n,r,a,i,o){return function(e){h(l,e);var u=g(l);function l(e,t){var c;s(this,l);var h=a(e),f=Nq(Nq({},xW),t),p=n(h,f),d=i(h)?r():null;return(c=u.call(this,e,!0,p,d))._isCurveNullified=!1,c._nativeWaveShaperNode=p,o(m(c),1),c}return c(l,[{key:"curve",get:function(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve},set:function(e){if(null===e)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(e.length<2)throw t();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=e}}},{key:"oversample",get:function(){return this._nativeWaveShaperNode.oversample},set:function(e){this._nativeWaveShaperNode.oversample=e}}]),l}(e)}(ZW,PG,ZU,lH,GW,UW,gU),fH=function(e){return null!==e&&e.isSecureContext}(zW),pH=function(e){return function(t,n,r){Object.defineProperties(e,{currentFrame:{configurable:!0,get:function(){return Math.round(t*n)}},currentTime:{configurable:!0,get:function(){return t}}});try{return r()}finally{null!==e&&(delete e.currentFrame,delete e.currentTime)}}}(zW),dH=new WeakMap,mH=function(e,t){return function(n){var r=e.get(n);if(void 0!==r)return r;if(null===t)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new t(1,1,44100),e.set(n,r),r}}(dH,WW),vH=fH?function(e,t,n,r,a,i,o,u,l,h,f,p,d){var m=0;return function(v,g){var y=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{credentials:"omit"},b=f.get(v);if(void 0!==b&&b.has(g))return Promise.resolve();var k=h.get(v);if(void 0!==k){var x=k.get(g);if(void 0!==x)return x}var w=i(v),_=void 0===w.audioWorklet?a(g).then((function(e){var t=Ct(e,2),r=t[0],a=t[1],i=Ct(yq(r,a),2),o=i[0],s=i[1],u="".concat(o,";((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{").concat(s,"\n})})(window,'_AWGS')");return n(u)})).then((function(){var e=d._AWGS.pop();if(void 0===e)throw new SyntaxError;r(w.currentTime,w.sampleRate,(function(){return e(c((function e(){s(this,e)})),void 0,(function(e,n){if(""===e.trim())throw t();var r=dq.get(w);if(void 0!==r){if(r.has(e))throw t();kq(n),bq(n.parameterDescriptors),r.set(e,n)}else kq(n),bq(n.parameterDescriptors),dq.set(w,new Map([[e,n]]))}),w.sampleRate,void 0,void 0)}))})):Promise.all([a(g),Promise.resolve(e(p,p))]).then((function(e){var t=Ct(e,2),n=Ct(t[0],2),r=n[0],a=n[1],i=t[1],s=m+1;m=s;var c=Ct(yq(r,a),2),h=c[0],f=c[1],p=i?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}",d=i?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));",v=i?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));",g="".concat(h,";((AudioWorkletProcessor,registerProcessor)=>{").concat(f,"\n})(").concat(p,",(n,p)=>registerProcessor(n,class extends p{").concat(d,"process(i,o,p){").concat(v,"return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac").concat(s,"',class extends AudioWorkletProcessor{process(){return !1}})"),b=new Blob([g],{type:"application/javascript; charset=utf-8"}),k=URL.createObjectURL(b);return w.audioWorklet.addModule(k,y).then((function(){if(u(w))return w;var e=o(w);return e.audioWorklet.addModule(k,y).then((function(){return e}))})).then((function(e){if(null===l)throw new SyntaxError;try{new l(e,"__sac".concat(s))}catch(t){throw new SyntaxError}})).finally((function(){return URL.revokeObjectURL(k)}))}));return void 0===k?h.set(v,new Map([[g,_]])):k.set(g,_),_.then((function(){var e=f.get(v);void 0===e?f.set(v,new Set([g])):e.add(g)})).finally((function(){var e=h.get(v);void 0!==e&&e.delete(g)})),_}}(LW,dW,function(e){return function(t){return new Promise((function(n,r){if(null!==e){var a=e.document.head;if(null===a)r(new SyntaxError);else{var i=e.document.createElement("script"),o=new Blob([t],{type:"application/javascript"}),s=URL.createObjectURL(o),u=e.onerror,c=function(){e.onerror=u,URL.revokeObjectURL(s)};e.onerror=function(t,n,a,i,o){return n===s||n===e.location.href&&1===a&&1===i?(c(),r(o),!1):null!==u?u(t,n,a,i,o):void 0},i.onerror=function(){c(),r(new SyntaxError)},i.onload=function(){c(),n()},i.src=s,i.type="module",a.appendChild(i)}}else r(new SyntaxError)}))}}(zW),pH,function(e){return function(){var t=_(x().mark((function t(n){var r;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(n);case 3:if(!(r=t.sent).ok){t.next=10;break}return t.next=7,r.text();case 7:return t.t0=t.sent,t.t1=r.url,t.abrupt("return",[t.t0,t.t1]);case 10:t.next=14;break;case 12:t.prev=12,t.t2=t.catch(0);case 14:throw e();case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}()}((function(){return new DOMException("","AbortError")})),GW,mH,UW,JW,new WeakMap,new WeakMap,function(e,t){return _(x().mark((function n(){var r,a,i,o,s,u,c;return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!==e){n.next=2;break}return n.abrupt("return",!0);case 2:if(null!==t){n.next=4;break}return n.abrupt("return",!1);case 4:return r=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),a=new t(1,128,44100),i=URL.createObjectURL(r),o=!1,s=!1,n.prev=9,n.next=12,a.audioWorklet.addModule(i);case 12:return u=new e(a,"a",{numberOfOutputs:0}),c=a.createOscillator(),u.port.onmessage=function(){return o=!0},u.onprocessorerror=function(){return s=!0},c.connect(u),c.start(0),n.next=20,a.startRendering();case 20:n.next=24;break;case 22:n.prev=22,n.t0=n.catch(9);case 24:return n.prev=24,URL.revokeObjectURL(i),n.finish(24);case 27:return n.abrupt("return",o&&!s);case 28:case"end":return n.stop()}}),n,null,[[9,22,24,27]])})))}(JW,WW),zW):void 0,gH=function(e,t){return function(n){return e(n)||t(n)}}(YW,UW),yH=function(e,t,n,r,a,i,o,s,u,c,l){return function(h,f){var p=o(h)?h:i(h);if(a.has(f)){var d=n();return Promise.reject(d)}try{a.add(f)}catch(m){}return t(u,(function(){return u(p)}))?p.decodeAudioData(f).then((function(n){return TG(f).catch((function(){})),t(s,(function(){return s(n)}))||l(n),e.add(n),n})):new Promise((function(t,n){var a=function(){var e=_(x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,TG(f);case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}(),i=function(e){n(e),a()};try{p.decodeAudioData(f,(function(n){"function"!==typeof n.copyFromChannel&&(c(n),Oq(n)),e.add(n),a().then((function(){return t(n)}))}),(function(e){i(null===e?r():e)}))}catch(d){i(d)}}))}}(tU,LW,(function(){return new DOMException("","DataCloneError")}),(function(){return new DOMException("","EncodingError")}),new WeakSet,GW,gH,Dq,zG,aU,iU),bH=function(e,t,n,r,a,i,o,u,l,f,p,d,v,y,b,k,x,w,_,S){return function(b){h(T,b);var C=g(T);function T(t,n){var r;return s(this,T),(r=C.call(this,t,n))._nativeContext=t,r._audioWorklet=void 0===e?void 0:{addModule:function(t,n){return e(m(r),t,n)}},r}return c(T,[{key:"audioWorklet",get:function(){return this._audioWorklet}},{key:"createAnalyser",value:function(){return new t(this)}},{key:"createBiquadFilter",value:function(){return new a(this)}},{key:"createBuffer",value:function(e,t,r){return new n({length:t,numberOfChannels:e,sampleRate:r})}},{key:"createBufferSource",value:function(){return new r(this)}},{key:"createChannelMerger",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;return new i(this,{numberOfInputs:e})}},{key:"createChannelSplitter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;return new o(this,{numberOfOutputs:e})}},{key:"createConstantSource",value:function(){return new u(this)}},{key:"createConvolver",value:function(){return new l(this)}},{key:"createDelay",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return new p(this,{maxDelayTime:e})}},{key:"createDynamicsCompressor",value:function(){return new d(this)}},{key:"createGain",value:function(){return new v(this)}},{key:"createIIRFilter",value:function(e,t){return new y(this,{feedback:t,feedforward:e})}},{key:"createOscillator",value:function(){return new k(this)}},{key:"createPanner",value:function(){return new x(this)}},{key:"createPeriodicWave",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{disableNormalization:!1};return new w(this,Nq(Nq({},n),{},{imag:t,real:e}))}},{key:"createStereoPanner",value:function(){return new _(this)}},{key:"createWaveShaper",value:function(){return new S(this)}},{key:"decodeAudioData",value:function(e,t,n){return f(this._nativeContext,e).then((function(e){return"function"===typeof t&&t(e),e}),(function(e){throw"function"===typeof n&&n(e),e}))}}]),T}(b)}(vH,eU,oU,dU,yU,_U,CU,AU,MU,yH,RU,LU,BU,WU,KU,QU,rH,iH,cH,hH),kH=function(e,t,n,r){return function(e){h(i,e);var a=g(i);function i(e,o){var u;s(this,i);var c=n(e),l=t(c,o);if(r(c))throw TypeError();return(u=a.call(this,e,!0,l,null))._nativeMediaElementAudioSourceNode=l,u}return c(i,[{key:"mediaElement",get:function(){return this._nativeMediaElementAudioSourceNode.mediaElement}}]),i}(e)}(ZW,(function(e,t){return e.createMediaElementSource(t.mediaElement)}),GW,UW),xH=function(e,t,n,r){return function(e){h(i,e);var a=g(i);function i(e,o){var u;s(this,i);var c=n(e);if(r(c))throw new TypeError;var l=Nq(Nq({},LG),o),h=t(c,l);return(u=a.call(this,e,!1,h,null))._nativeMediaStreamAudioDestinationNode=h,u}return c(i,[{key:"stream",get:function(){return this._nativeMediaStreamAudioDestinationNode.stream}}]),i}(e)}(ZW,(function(e,t){var n=e.createMediaStreamDestination();return jG(n,t),1===n.numberOfOutputs&&Object.defineProperty(n,"numberOfOutputs",{get:function(){return 0}}),n}),GW,UW),wH=function(e,t,n,r){return function(e){h(i,e);var a=g(i);function i(e,o){var u;s(this,i);var c=n(e),l=t(c,o);if(r(c))throw new TypeError;return(u=a.call(this,e,!0,l,null))._nativeMediaStreamAudioSourceNode=l,u}return c(i,[{key:"mediaStream",get:function(){return this._nativeMediaStreamAudioSourceNode.mediaStream}}]),i}(e)}(ZW,(function(e,t){var n=t.mediaStream,r=n.getAudioTracks();r.sort((function(e,t){return e.id<t.id?-1:e.id>t.id?1:0}));var a=r.slice(0,1),i=e.createMediaStreamSource(new MediaStream(a));return Object.defineProperty(i,"mediaStream",{value:n}),i}),GW,UW),_H=function(e,t){return function(n,r){var a=r.mediaStreamTrack;if("function"===typeof n.createMediaStreamTrackSource)return n.createMediaStreamTrackSource(a);var i=new MediaStream([a]),o=n.createMediaStreamSource(i);if("audio"!==a.kind)throw e();if(t(n))throw new TypeError;return o}}(PG,UW),SH=function(e,t,n){return function(e){h(a,e);var r=g(a);function a(e,i){s(this,a);var o=n(e),u=t(o,i);return r.call(this,e,!0,u,null)}return c(a)}(e)}(ZW,_H,GW),CH=function(e,t,n,r,a,i,o,u,l){return function(e){h(p,e);var f=g(p);function p(){var e,t,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(s(this,p),null===l)throw new Error("Missing the native AudioContext constructor.");try{t=new l(a)}catch(ZJ){if(12===ZJ.code&&"sampleRate is not in range"===ZJ.message)throw n();throw ZJ}if(null===t)throw r();if(!Uq(a.latencyHint))throw new TypeError("The provided value '".concat(a.latencyHint,"' is not a valid enum value of type AudioContextLatencyCategory."));if(void 0!==a.sampleRate&&t.sampleRate!==a.sampleRate)throw n();e=f.call(this,t,2);var i=a.latencyHint,o=t,u=o.sampleRate;if(e._baseLatency="number"===typeof t.baseLatency?t.baseLatency:"balanced"===i?512/u:"interactive"===i||void 0===i?256/u:"playback"===i?1024/u:128*Math.max(2,Math.min(128,Math.round(i*u/128)))/u,e._nativeAudioContext=t,"webkitAudioContext"===l.name?(e._nativeGainNode=t.createGain(),e._nativeOscillatorNode=t.createOscillator(),e._nativeGainNode.gain.value=1e-37,e._nativeOscillatorNode.connect(e._nativeGainNode).connect(t.destination),e._nativeOscillatorNode.start()):(e._nativeGainNode=null,e._nativeOscillatorNode=null),e._state=null,"running"===t.state){e._state="suspended";var c=function n(){"suspended"===e._state&&(e._state=null),t.removeEventListener("statechange",n)};t.addEventListener("statechange",c)}return e}return c(p,[{key:"baseLatency",get:function(){return this._baseLatency}},{key:"state",get:function(){return null!==this._state?this._state:this._nativeAudioContext.state}},{key:"close",value:function(){var e=this;return"closed"===this.state?this._nativeAudioContext.close().then((function(){throw t()})):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then((function(){null!==e._nativeGainNode&&null!==e._nativeOscillatorNode&&(e._nativeOscillatorNode.stop(),e._nativeGainNode.disconnect(),e._nativeOscillatorNode.disconnect()),Wq(e)})))}},{key:"createMediaElementSource",value:function(e){return new a(this,{mediaElement:e})}},{key:"createMediaStreamDestination",value:function(){return new i(this)}},{key:"createMediaStreamSource",value:function(e){return new o(this,{mediaStream:e})}},{key:"createMediaStreamTrackSource",value:function(e){return new u(this,{mediaStreamTrack:e})}},{key:"resume",value:function(){var e=this;return"suspended"===this._state?new Promise((function(t,n){e._nativeAudioContext.addEventListener("statechange",(function r(){e._nativeAudioContext.removeEventListener("statechange",r),"running"===e._nativeAudioContext.state?t():e.resume().then(t,n)}))})):this._nativeAudioContext.resume().catch((function(e){if(void 0===e||15===e.code)throw t();throw e}))}},{key:"suspend",value:function(){return this._nativeAudioContext.suspend().catch((function(e){if(void 0===e)throw t();throw e}))}}]),p}(e)}(bH,PG,dW,kW,kH,xH,wH,SH,XW),TH=function(e){return function(t){var n=e.get(t);if(void 0===n)throw new Error("The context has no set of AudioWorkletNodes.");return n}}(HU),EH=function(e){return function(t,n){e(t).add(n)}}(TH),IH=function(e){return function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=t[r];if(void 0===i)throw e();return cG(n)?i.connect(n,0,a):i.connect(n,0)}}(Rq),AH=function(e){return function(t,n){e(t).delete(n)}}(TH),NH=function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return void 0===n?t.forEach((function(e){return e.disconnect()})):"number"===typeof n?IG(e,t,n).disconnect():cG(n)?void 0===r?t.forEach((function(e){return e.disconnect(n)})):void 0===a?IG(e,t,r).disconnect(n,0):IG(e,t,r).disconnect(n,0,a):void 0===r?t.forEach((function(e){return e.disconnect(n)})):IG(e,t,r).disconnect(n,0)}}(Rq),PH=new WeakMap,MH=function(e,t){return function(n){return t(e,n)}}(PH,xq),DH=function(e,t,n,r,a,i,o,s,u,c,l,h,f){return function(p,d,m,v){if(0===v.numberOfInputs&&0===v.numberOfOutputs)throw u();var g=Array.isArray(v.outputChannelCount)?v.outputChannelCount:Array.from(v.outputChannelCount);if(g.some((function(e){return e<1})))throw u();if(g.length!==v.numberOfOutputs)throw t();if("explicit"!==v.channelCountMode)throw u();var y=v.channelCount*v.numberOfInputs,b=g.reduce((function(e,t){return e+t}),0),k=void 0===m.parameterDescriptors?0:m.parameterDescriptors.length;if(y+k>6||b>6)throw u();for(var x=new MessageChannel,w=[],_=[],S=0;S<v.numberOfInputs;S+=1)w.push(o(p,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1})),_.push(a(p,{channelCount:v.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:v.channelCount}));var C=[];if(void 0!==m.parameterDescriptors){var T,E=zo(m.parameterDescriptors);try{var I=function(){var e=T.value,t=e.defaultValue,n=e.maxValue,r=e.minValue,a=e.name,o=i(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==v.parameterData[a]?v.parameterData[a]:void 0===t?0:t});Object.defineProperties(o.offset,{defaultValue:{get:function(){return void 0===t?0:t}},maxValue:{get:function(){return void 0===n?zq:n}},minValue:{get:function(){return void 0===r?Lq:r}}}),C.push(o)};for(E.s();!(T=E.n()).done;)I()}catch(ZJ){E.e(ZJ)}finally{E.f()}}for(var A=r(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,y+k)}),N=HG(d,p.sampleRate),P=s(p,N,y+k,Math.max(1,b)),M=a(p,{channelCount:Math.max(1,b),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,b)}),D=[],R=0;R<v.numberOfOutputs;R+=1)D.push(r(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:g[R]}));for(var O=0;O<v.numberOfInputs;O+=1){w[O].connect(_[O]);for(var F=0;F<v.channelCount;F+=1)_[O].connect(A,F,O*v.channelCount+F)}var L=new dG(void 0===m.parameterDescriptors?[]:m.parameterDescriptors.map((function(e,t){var n=e.name,r=C[t];return r.connect(A,0,y+t),r.start(0),[n,r.offset]})));A.connect(P);var z,B,V=v.channelInterpretation,j=null,q=0===v.numberOfOutputs?[P]:D,G={get bufferSize(){return N},get channelCount(){return v.channelCount},set channelCount(e){throw n()},get channelCountMode(){return v.channelCountMode},set channelCountMode(e){throw n()},get channelInterpretation(){return V},set channelInterpretation(e){var t,n=zo(w);try{for(n.s();!(t=n.n()).done;){t.value.channelInterpretation=e}}catch(ZJ){n.e(ZJ)}finally{n.f()}V=e},get context(){return P.context},get inputs(){return w},get numberOfInputs(){return v.numberOfInputs},get numberOfOutputs(){return v.numberOfOutputs},get onprocessorerror(){return j},set onprocessorerror(e){"function"===typeof j&&G.removeEventListener("processorerror",j),"function"===typeof(j="function"===typeof e?e:null)&&G.addEventListener("processorerror",j)},get parameters(){return L},get port(){return x.port2},addEventListener:function(){return P.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},connect:e.bind(null,q),disconnect:c.bind(null,q),dispatchEvent:function(){return P.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener:function(){return P.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}},W=new Map;x.port1.addEventListener=(z=x.port1.addEventListener,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if("message"===t[0]){var r="function"===typeof t[1]?t[1]:"object"===typeof t[1]&&null!==t[1]&&"function"===typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==r){var a=W.get(t[1]);void 0!==a?t[1]=a:(t[1]=function(e){l(p.currentTime,p.sampleRate,(function(){return r(e)}))},W.set(r,t[1]))}}return z.call(x.port1,t[0],t[1],t[2])}),x.port1.removeEventListener=(B=x.port1.removeEventListener,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if("message"===t[0]){var r=W.get(t[1]);void 0!==r&&(W.delete(t[1]),t[1]=r)}return B.call(x.port1,t[0],t[1],t[2])});var U=null;Object.defineProperty(x.port1,"onmessage",{get:function(){return U},set:function(e){"function"===typeof U&&x.port1.removeEventListener("message",U),"function"===typeof(U="function"===typeof e?e:null)&&(x.port1.addEventListener("message",U),x.port1.start())}}),m.prototype.port=x.port1;var H=null,K=function(e,t,n,r){var a=mq.get(e);void 0===a&&(a=new WeakMap,mq.set(e,a));var i=XG(n,r);return a.set(t,i),i}(p,G,m,v);K.then((function(e){return H=e}));var X=yG(v.numberOfInputs,v.channelCount),Y=yG(v.numberOfOutputs,g),Q=void 0===m.parameterDescriptors?[]:m.parameterDescriptors.reduce((function(e,t){var n=t.name;return Nq(Nq({},e),{},ot({},n,new Float32Array(128)))}),{}),$=!0,J=function(){v.numberOfOutputs>0&&P.disconnect(M);for(var e=0,t=0;e<v.numberOfOutputs;e+=1){for(var n=D[e],r=0;r<g[e];r+=1)M.disconnect(n,t+r,r);t+=g[e]}},Z=new Map;P.onaudioprocess=function(e){var t=e.inputBuffer,n=e.outputBuffer;null!==H&&function(){for(var e=h(G),r=function(r){for(var a=0;a<v.numberOfInputs;a+=1)for(var i=0;i<v.channelCount;i+=1)vG(t,X[a],i,i,r);void 0!==m.parameterDescriptors&&m.parameterDescriptors.forEach((function(e,n){var a=e.name;vG(t,Q,a,y+n,r)}));for(var o=0;o<v.numberOfInputs;o+=1)for(var s=0;s<g[o];s+=1)0===Y[o][s].byteLength&&(Y[o][s]=new Float32Array(128));try{var u=X.map((function(t,n){if(e[n].size>0)return Z.set(n,N/128),t;var r=Z.get(n);return void 0===r?[]:(t.every((function(e){return e.every((function(e){return 0===e}))}))&&(1===r?Z.delete(n):Z.set(n,r-1)),t)})),c=l(p.currentTime+r/p.sampleRate,p.sampleRate,(function(){return H.process(u,Y,Q)}));$=c;for(var h=0,f=0;h<v.numberOfOutputs;h+=1){for(var d=0;d<g[h];d+=1)gG(n,Y[h],d,f+d,r);f+=g[h]}}catch(E){$=!1,G.dispatchEvent(new ErrorEvent("processorerror",{colno:E.colno,filename:E.filename,lineno:E.lineno,message:E.message}))}if(!$){for(var b=0;b<v.numberOfInputs;b+=1){w[b].disconnect(_[b]);for(var k=0;k<v.channelCount;k+=1)_[r].disconnect(A,k,b*v.channelCount+k)}if(void 0!==m.parameterDescriptors)for(var x=m.parameterDescriptors.length,S=0;S<x;S+=1){var T=C[S];T.disconnect(A,0,y+S),T.stop()}return A.disconnect(P),P.onaudioprocess=null,ee?J():re(),"break"}},a=0;a<N;a+=128){if("break"===r(a))break}}()};var ee=!1,te=o(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),ne=function(){return P.connect(te).connect(p.destination)},re=function(){P.disconnect(te),te.disconnect()};return ne(),f(G,(function(){if($){re(),v.numberOfOutputs>0&&P.connect(M);for(var e=0,t=0;e<v.numberOfOutputs;e+=1){for(var n=D[e],r=0;r<g[e];r+=1)M.connect(n,t+r,r);t+=g[e]}}ee=!0}),(function(){$&&(ne(),J()),ee=!1}))}}(IH,Rq,PG,xU,QG,EU,tW,hW,dW,NH,pH,MH,bU),RH=function(e,t,n,r,a){return function(i,o,s,u,c,l){if(null!==s)try{var h=new s(i,u,l),f=new Map,p=null;if(Object.defineProperties(h,{channelCount:{get:function(){return l.channelCount},set:function(){throw e()}},channelCountMode:{get:function(){return"explicit"},set:function(){throw e()}},onprocessorerror:{get:function(){return p},set:function(e){"function"===typeof p&&h.removeEventListener("processorerror",p),"function"===typeof(p="function"===typeof e?e:null)&&h.addEventListener("processorerror",p)}}}),h.addEventListener=(v=h.addEventListener,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if("processorerror"===t[0]){var r="function"===typeof t[1]?t[1]:"object"===typeof t[1]&&null!==t[1]&&"function"===typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==r){var a=f.get(t[1]);void 0!==a?t[1]=a:(t[1]=function(e){"error"===e.type?(Object.defineProperties(e,{type:{value:"processorerror"}}),r(e)):r(new ErrorEvent(t[0],Nq({},e)))},f.set(r,t[1]))}}return v.call(h,"error",t[1],t[2]),v.call.apply(v,[h].concat(t))}),h.removeEventListener=(m=h.removeEventListener,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if("processorerror"===t[0]){var r=f.get(t[1]);void 0!==r&&(f.delete(t[1]),t[1]=r)}return m.call(h,"error",t[1],t[2]),m.call(h,t[0],t[1],t[2])}),0!==l.numberOfOutputs){var d=n(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});h.connect(d).connect(i.destination);return a(h,(function(){return d.disconnect()}),(function(){return d.connect(i.destination)}))}return h}catch(ZJ){if(11===ZJ.code)throw r();throw ZJ}var m,v;if(void 0===c)throw r();return function(e){var t=(new MessageChannel).port1;try{t.postMessage(e)}finally{t.close()}}(l),t(i,o,c,l)}}(PG,DH,tW,dW,bU),OH=function(e,t,n,r,a,i,o,s,u,c,l,h,f,p,d,m){return function(v,g,y){var b=new WeakMap,k=null,w=function(){var s=_(x().mark((function s(w,S){var C,T,E,I,A,N,P,M,D,R,O,F,L,z,B,V,j,q,G,W,U,H,K,X,Y,Q,$,J,Z,ee,te,ne,re;return x().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(C=l(w),T=null,E=Mq(C,S),I=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount),null===h){for(A=I.reduce((function(e,t){return e+t}),0),N=a(S,{channelCount:Math.max(1,A),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,A)}),P=[],M=0;M<w.numberOfOutputs;M+=1)P.push(r(S,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:I[M]}));(D=o(S,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})).connect=t.bind(null,P),D.disconnect=u.bind(null,P),T=[N,P,D]}else E||(C=new h(S,v));if(b.set(S,null===T?C:T[2]),null===T){s.next=41;break}if(null!==k){s.next=32;break}if(void 0!==y){s.next=10;break}throw new Error("Missing the processor constructor.");case 10:if(null!==f){s.next=12;break}throw new Error("Missing the native OfflineAudioContext constructor.");case 12:if(R=w.channelCount*w.numberOfInputs,O=void 0===y.parameterDescriptors?0:y.parameterDescriptors.length,F=R+O,L=function(){var e=_(x().mark((function e(){var t,n,s,u,c,l,h,v,y,b,k,C,T;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=new f(F,128*Math.ceil(w.context.length/128),S.sampleRate),n=[],s=[],u=0;u<g.numberOfInputs;u+=1)n.push(o(t,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),s.push(a(t,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));return e.next=6,Promise.all(Array.from(w.parameters.values()).map(function(){var e=_(x().mark((function e(n){var r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:n.value}),e.next=3,p(t,n,r.offset);case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 6:for(c=e.sent,l=r(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,R+O)}),h=0;h<g.numberOfInputs;h+=1)for(n[h].connect(s[h]),v=0;v<g.channelCount;v+=1)s[h].connect(l,v,h*g.channelCount+v);y=zo(c.entries());try{for(y.s();!(b=y.n()).done;)k=Ct(b.value,2),C=k[0],(T=k[1]).connect(l,0,R+C),T.start(0)}catch(ZJ){y.e(ZJ)}finally{y.f()}return l.connect(t.destination),e.next=14,Promise.all(n.map((function(e){return d(w,t,e)})));case 14:return e.abrupt("return",m(t));case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s.t0=kG,s.t1=w,0!==F){s.next=22;break}s.t2=null,s.next=25;break;case 22:return s.next=24,L();case 24:s.t2=s.sent;case 25:s.t3=s.t2,s.t4=S,s.t5=g,s.t6=I,s.t7=y,s.t8=c,k=(0,s.t0)(s.t1,s.t3,s.t4,s.t5,s.t6,s.t7,s.t8);case 32:return s.next=34,k;case 34:for(z=s.sent,B=n(S,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),V=Ct(T,3),j=V[0],q=V[1],G=V[2],null!==z&&(B.buffer=z,B.start(0)),B.connect(j),W=0,U=0;W<w.numberOfOutputs;W+=1){for(H=q[W],K=0;K<I[W];K+=1)j.connect(H,U+K,K);U+=I[W]}return s.abrupt("return",G);case 41:if(E){s.next=61;break}X=zo(w.parameters.entries()),s.prev=43,X.s();case 45:if((Y=X.n()).done){s.next=51;break}return Q=Ct(Y.value,2),$=Q[0],J=Q[1],s.next=49,p(S,J,C.parameters.get($));case 49:s.next=45;break;case 51:s.next=56;break;case 53:s.prev=53,s.t9=s.catch(43),X.e(s.t9);case 56:return s.prev=56,X.f(),s.finish(56);case 59:s.next=78;break;case 61:Z=zo(w.parameters.entries()),s.prev=62,Z.s();case 64:if((ee=Z.n()).done){s.next=70;break}return te=Ct(ee.value,2),ne=te[0],re=te[1],s.next=68,e(S,re,C.parameters.get(ne));case 68:s.next=64;break;case 70:s.next=75;break;case 72:s.prev=72,s.t10=s.catch(62),Z.e(s.t10);case 75:return s.prev=75,Z.f(),s.finish(75);case 78:return s.next=80,d(w,S,C);case 80:return s.abrupt("return",C);case 81:case"end":return s.stop()}}),s,null,[[43,53,56,59],[62,72,75,78]])})));return function(e,t){return s.apply(this,arguments)}}();return{render:function(e,t){s(t,e);var n=b.get(t);return void 0!==n?Promise.resolve(n):w(e,t)}}}}(cU,IH,lU,xU,QG,EU,tW,AH,NH,pH,rG,JW,WW,hU,jW,jU),FH=function(e){return function(t){return e.get(t)}}(dH),LH=function(e){return function(t,n){e.set(t,n)}}(PH),zH=fH?function(e,t,n,r,a,i,o,u,l,f,p,d,v,y){return function(t){h(k,t);var b=g(k);function k(t,c,h){var g,y;s(this,k);var x=u(t),w=l(x),_=p(Nq(Nq({},mG),h));v(_);var S=dq.get(x),C=null===S||void 0===S?void 0:S.get(c),T=w||"closed"!==x.state?x:null!==(y=o(x))&&void 0!==y?y:x,E=a(T,w?null:t.baseLatency,f,c,C,_),I=w?r(c,_,C):null;g=b.call(this,t,!0,E,I);var A=[];E.parameters.forEach((function(e,t){var r=n(m(g),w,e);A.push([t,r])})),g._nativeAudioWorkletNode=E,g._onprocessorerror=null,g._parameters=new dG(A),w&&e(x,m(g));var N=i(m(g)).activeInputs;return d(E,N),g}return c(k,[{key:"onprocessorerror",get:function(){return this._onprocessorerror},set:function(e){var t="function"===typeof e?y(this,e):null;this._nativeAudioWorkletNode.onprocessorerror=t;var n=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==n&&n===t?e:n}},{key:"parameters",get:function(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}},{key:"port",get:function(){return this._nativeAudioWorkletNode.port}}]),k}(t)}(EH,ZW,pU,OH,RH,jq,FH,GW,UW,JW,(function(e){return Nq(Nq({},e),{},{outputChannelCount:void 0!==e.outputChannelCount?e.outputChannelCount:1===e.numberOfInputs&&1===e.numberOfOutputs?[e.channelCount]:Array.from({length:e.numberOfOutputs},(function(){return 1}))})}),LH,(function(e){var t=new MessageChannel,n=t.port1,r=t.port2;try{n.postMessage(e)}finally{n.close(),r.close()}}),PW):void 0,BH=(function(e,t,n,r,a){}(PG,dW,kW,KU,XW),function(e,t){return function(n,r,a){if(null===t)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new t(n,r,a)}catch(ZJ){if("SyntaxError"===ZJ.name)throw e();throw ZJ}}}(dW,WW)),VH=function(e,t,n,r,a,i,o,s){return function(u,c){return n(u).render(u,c).then((function(){return Promise.all(Array.from(r(c)).map((function(e){return n(e).render(e,c)})))})).then((function(){return a(c)})).then((function(n){return"function"!==typeof n.copyFromChannel?(o(n),Oq(n)):t(i,(function(){return i(n)}))||s(n),e.add(n),n}))}}(tU,LW,VW,TH,jU,Dq,aU,iU),jH=(function(e,t,n,r,a){}(LW,PG,BH,KU,VH),function(e,t,n,r,a){return function(e){h(o,e);var i=g(o);function o(e,n,a){var u,c;if(s(this,o),"number"===typeof e&&void 0!==n&&void 0!==a)c={length:n,numberOfChannels:e,sampleRate:a};else{if("object"!==typeof e)throw new Error("The given parameters are not valid.");c=e}var l=Nq(Nq({},mW),c),h=l.length,f=l.numberOfChannels,p=l.sampleRate,d=r(f,h,p);return t(zG,(function(){return zG(d)}))||d.addEventListener("statechange",function(){var e=0;return function t(n){"running"===u._state&&(e>0?(d.removeEventListener("statechange",t),n.stopImmediatePropagation(),u._waitForThePromiseToSettle(n)):e+=1)}}()),(u=i.call(this,d,f))._length=h,u._nativeOfflineAudioContext=d,u._state=null,u}return c(o,[{key:"length",get:function(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}},{key:"state",get:function(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}},{key:"startRendering",value:function(){var e=this;return"running"===this._state?Promise.reject(n()):(this._state="running",a(this.destination,this._nativeOfflineAudioContext).finally((function(){e._state=null,Wq(e)})))}},{key:"_waitForThePromiseToSettle",value:function(e){var t=this;null===this._state?this._nativeOfflineAudioContext.dispatchEvent(e):setTimeout((function(){return t._waitForThePromiseToSettle(e)}))}}]),o}(e)}(bH,LW,PG,BH,VH)),qH=function(e,t){return function(n){var r=e.get(n);return t(r)||t(n)}}(hq,YW),GH=function(e,t){return function(n){return e.has(n)||t(n)}}(uq,QW),WH=function(e,t){return function(n){return e.has(n)||t(n)}}(lq,$W),UH=function(e,t){return function(n){var r=e.get(n);return t(r)||t(n)}}(hq,UW),HH=function(){return FG(LW,function(e){return function(){if(null===e)return!1;var t=new e(1,1,44100).createBuffer(1,1,44100);if(void 0===t.copyToChannel)return!0;var n=new Float32Array(2);try{t.copyFromChannel(n,0,0)}catch(r){return!1}return!0}}(WW),function(e){return function(){if(null===e)return!1;if(void 0!==e.prototype&&void 0!==e.prototype.close)return!0;var t=new e,n=void 0!==t.close;try{t.close()}catch(r){}return n}}(XW),function(e){return function(){if(null===e)return Promise.resolve(!1);var t=new e(1,1,44100);return new Promise((function(e){var n,r=!0,a=function(n){r&&(r=!1,t.startRendering(),e(n instanceof TypeError))};try{n=t.decodeAudioData(null,(function(){}),a)}catch(ZJ){a(ZJ)}void 0!==n&&n.catch(a)}))}}(WW),function(e){return function(){if(null===e)return!1;var t;try{t=new e({latencyHint:"balanced"})}catch(n){return!1}return t.close(),!0}}(XW),function(e){return function(){if(null===e)return!1;var t=new e(1,1,44100).createGain(),n=t.connect(t)===t;return t.disconnect(t),n}}(WW),function(e,t){return _(x().mark((function n(){var r,a,i,o,s,u,c;return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!==e){n.next=2;break}return n.abrupt("return",!0);case 2:if(null!==t){n.next=4;break}return n.abrupt("return",!1);case 4:return r=new Blob(['let c,p;class A extends AudioWorkletProcessor{constructor(){super();this.port.onmessage=(e)=>{p=e.data;p.onmessage=()=>{p.postMessage(c);p.close()};this.port.postMessage(0)}}process(){c=1}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),a=new MessageChannel,i=new t(1,128,44100),o=URL.createObjectURL(r),s=!1,n.prev=9,n.next=12,i.audioWorklet.addModule(o);case 12:return u=new e(i,"a",{numberOfOutputs:0}),c=i.createOscillator(),n.next=16,new Promise((function(e){u.port.onmessage=function(){return e()},u.port.postMessage(a.port2,[a.port2])}));case 16:return u.port.onmessage=function(){return s=!0},c.connect(u),c.start(0),n.next=21,i.startRendering();case 21:return n.next=23,new Promise((function(e){a.port1.onmessage=function(t){var n=t.data;return e(1===n)},a.port1.postMessage(0)}));case 23:s=n.sent,n.next=28;break;case 26:n.prev=26,n.t0=n.catch(9);case 28:return n.prev=28,a.port1.close(),URL.revokeObjectURL(o),n.finish(28);case 32:return n.abrupt("return",s);case 33:case"end":return n.stop()}}),n,null,[[9,26,28,32]])})))}(JW,WW),function(e){return function(){if(null===e)return!1;var t=new e(1,1,44100).createChannelMerger();if("max"===t.channelCountMode)return!0;try{t.channelCount=2}catch(n){return!0}return!1}}(WW),function(e){return function(){if(null===e)return!1;var t=new e(1,1,44100);return void 0===t.createConstantSource||t.createConstantSource().offset.maxValue!==Number.POSITIVE_INFINITY}}(WW),function(e){return function(){if(null===e)return!1;var t=new e(1,1,44100),n=t.createConvolver();n.buffer=t.createBuffer(1,1,t.sampleRate);try{n.buffer=t.createBuffer(1,1,t.sampleRate)}catch(r){return!1}return!0}}(WW),function(e){return function(){if(null===e)return!1;var t=new e(1,1,44100).createConvolver();try{t.channelCount=1}catch(n){return!1}return!0}}(WW),IW,function(e){return function(){return null!==e&&e.hasOwnProperty("isSecureContext")}}(zW),function(e){return function(){if(null===e)return!1;var t=new e;try{return t.createMediaStreamSource(new MediaStream),!1}catch(ZJ){return!0}finally{t.close()}}}(XW),function(e){return function(){if(null===e)return Promise.resolve(!1);var t=new e(1,1,44100);if(void 0===t.createStereoPanner)return Promise.resolve(!0);if(void 0===t.createConstantSource)return Promise.resolve(!0);var n=t.createConstantSource(),r=t.createStereoPanner();return n.channelCount=1,n.offset.value=1,r.channelCount=1,n.start(),n.connect(r).connect(t.destination),t.startRendering().then((function(e){return 1!==e.getChannelData(0)[0]}))}}(WW),AW)};function KH(e,t){if(!e)throw new Error(t)}function XH(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;if(!(t<=e&&e<=n))throw new RangeError("Value must be within [".concat(t,", ").concat(n,"], got: ").concat(e))}function YH(e){e.isOffline||"running"===e.state||ZH('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}var QH=console;function $H(e){QH=e}function JH(){var e;(e=QH).log.apply(e,arguments)}function ZH(){var e;(e=QH).warn.apply(e,arguments)}function eK(e){return"undefined"===typeof e}function tK(e){return!eK(e)}function nK(e){return"function"===typeof e}function rK(e){return"number"===typeof e}function aK(e){return"[object Object]"===Object.prototype.toString.call(e)&&e.constructor===Object}function iK(e){return"boolean"===typeof e}function oK(e){return Array.isArray(e)}function sK(e){return"string"===typeof e}function uK(e){return sK(e)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(e)}function cK(e){return new CH(e)}function lK(e,t,n){return new jH(e,t,n)}var hK="object"===typeof self?self:null,fK=hK&&(hK.hasOwnProperty("AudioContext")||hK.hasOwnProperty("webkitAudioContext"));function pK(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o}function dK(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(t){i(t)}}function s(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))}Object.create;Object.create;var mK=function(){function e(t,n,r){s(this,e),this._callback=t,this._type=n,this._updateInterval=r,this._createClock()}return c(e,[{key:"_createWorker",value:function(){var e=new Blob(["\n\t\t\t// the initial timeout time\n\t\t\tlet timeoutTime =  ".concat((1e3*this._updateInterval).toFixed(1),";\n\t\t\t// onmessage callback\n\t\t\tself.onmessage = function(msg){\n\t\t\t\ttimeoutTime = parseInt(msg.data);\n\t\t\t};\n\t\t\t// the tick function which posts a message\n\t\t\t// and schedules a new tick\n\t\t\tfunction tick(){\n\t\t\t\tsetTimeout(tick, timeoutTime);\n\t\t\t\tself.postMessage('tick');\n\t\t\t}\n\t\t\t// call tick initially\n\t\t\ttick();\n\t\t\t")],{type:"text/javascript"}),t=URL.createObjectURL(e),n=new Worker(t);n.onmessage=this._callback.bind(this),this._worker=n}},{key:"_createTimeout",value:function(){var e=this;this._timeout=setTimeout((function(){e._createTimeout(),e._callback()}),1e3*this._updateInterval)}},{key:"_createClock",value:function(){if("worker"===this._type)try{this._createWorker()}catch(e){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}},{key:"_disposeClock",value:function(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}},{key:"updateInterval",get:function(){return this._updateInterval},set:function(e){this._updateInterval=Math.max(e,128/44100),"worker"===this._type&&this._worker.postMessage(Math.max(1e3*e,1))}},{key:"type",get:function(){return this._type},set:function(e){this._disposeClock(),this._type=e,this._createClock()}},{key:"dispose",value:function(){this._disposeClock()}}]),e}();function vK(e){return WH(e)}function gK(e){return GH(e)}function yK(e){return UH(e)}function bK(e){return qH(e)}function kK(e){return e instanceof AudioBuffer}function xK(e,t){return"value"===e||vK(t)||gK(t)||kK(t)}function wK(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(!n.length)return e;var a=n.shift();if(aK(e)&&aK(a))for(var i in a)xK(i,a[i])?e[i]=a[i]:aK(a[i])?(e[i]||Object.assign(e,ot({},i,{})),wK(e[i],a[i])):Object.assign(e,ot({},i,a[i]));return wK.apply(void 0,[e].concat(n))}function _K(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3?arguments[3]:void 0,a={},i=Array.from(t);if(aK(i[0])&&r&&!Reflect.has(i[0],r)){var o=Object.keys(i[0]).some((function(t){return Reflect.has(e,t)}));o||(wK(a,ot({},r,i[0])),n.splice(n.indexOf(r),1),i.shift())}if(1===i.length&&aK(i[0]))wK(a,i[0]);else for(var s=0;s<n.length;s++)tK(i[s])&&(a[n[s]]=i[s]);return wK(e,a)}function SK(e,t){return eK(e)?t:e}function CK(e,t){return t.forEach((function(t){Reflect.has(e,t)&&delete e[t]})),e}var TK=function(){function e(){s(this,e),this.debug=!1,this._wasDisposed=!1}return c(e,[{key:"log",value:function(){if(this.debug||hK&&this.toString()===hK.TONE_DEBUG_CLASS){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];JH.apply(void 0,[this].concat(t))}}},{key:"dispose",value:function(){return this._wasDisposed=!0,this}},{key:"disposed",get:function(){return this._wasDisposed}},{key:"toString",value:function(){return this.name}}],[{key:"getDefaults",value:function(){return{}}}]),e}();TK.version=aq;var EK=1e-6;function IK(e,t){return e>t+EK}function AK(e,t){return IK(e,t)||PK(e,t)}function NK(e,t){return e+EK<t}function PK(e,t){return Math.abs(e-t)<EK}function MK(e,t,n){return Math.max(Math.min(e,n),t)}var DK=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this)).name="Timeline",e._timeline=[];var r=_K(n.getDefaults(),arguments,["memory"]);return e.memory=r.memory,e.increasing=r.increasing,e}return c(n,[{key:"length",get:function(){return this._timeline.length}},{key:"add",value:function(e){if(KH(Reflect.has(e,"time"),"Timeline: events must have a time attribute"),e.time=e.time.valueOf(),this.increasing&&this.length){var t=this._timeline[this.length-1];KH(AK(e.time,t.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(e)}else{var n=this._search(e.time);this._timeline.splice(n+1,0,e)}if(this.length>this.memory){var r=this.length-this.memory;this._timeline.splice(0,r)}return this}},{key:"remove",value:function(e){var t=this._timeline.indexOf(e);return-1!==t&&this._timeline.splice(t,1),this}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time",n=this._search(e,t);return-1!==n?this._timeline[n]:null}},{key:"peek",value:function(){return this._timeline[0]}},{key:"shift",value:function(){return this._timeline.shift()}},{key:"getAfter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time",n=this._search(e,t);return n+1<this._timeline.length?this._timeline[n+1]:null}},{key:"getBefore",value:function(e){var t=this._timeline.length;if(t>0&&this._timeline[t-1].time<e)return this._timeline[t-1];var n=this._search(e);return n-1>=0?this._timeline[n-1]:null}},{key:"cancel",value:function(e){if(this._timeline.length>1){var t=this._search(e);if(t>=0)if(PK(this._timeline[t].time,e)){for(var n=t;n>=0&&PK(this._timeline[n].time,e);n--)t=n;this._timeline=this._timeline.slice(0,t)}else this._timeline=this._timeline.slice(0,t+1);else this._timeline=[]}else 1===this._timeline.length&&AK(this._timeline[0].time,e)&&(this._timeline=[]);return this}},{key:"cancelBefore",value:function(e){var t=this._search(e);return t>=0&&(this._timeline=this._timeline.slice(t+1)),this}},{key:"previousEvent",value:function(e){var t=this._timeline.indexOf(e);return t>0?this._timeline[t-1]:null}},{key:"_search",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time";if(0===this._timeline.length)return-1;var n=0,r=this._timeline.length,a=r;if(r>0&&this._timeline[r-1][t]<=e)return r-1;for(;n<a;){var i=Math.floor(n+(a-n)/2),o=this._timeline[i],s=this._timeline[i+1];if(PK(o[t],e)){for(var u=i;u<this._timeline.length;u++){var c=this._timeline[u];if(!PK(c[t],e))break;i=u}return i}if(NK(o[t],e)&&IK(s[t],e))return i;IK(o[t],e)?a=i:n=i+1}return-1}},{key:"_iterate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._timeline.length-1;this._timeline.slice(t,n+1).forEach(e)}},{key:"forEach",value:function(e){return this._iterate(e),this}},{key:"forEachBefore",value:function(e,t){var n=this._search(e);return-1!==n&&this._iterate(t,0,n),this}},{key:"forEachAfter",value:function(e,t){var n=this._search(e);return this._iterate(t,n+1),this}},{key:"forEachBetween",value:function(e,t,n){var r=this._search(e),a=this._search(t);return-1!==r&&-1!==a?(this._timeline[r].time!==e&&(r+=1),this._timeline[a].time===t&&(a-=1),this._iterate(n,r,a)):-1===r&&this._iterate(n,0,a),this}},{key:"forEachFrom",value:function(e,t){for(var n=this._search(e);n>=0&&this._timeline[n].time>=e;)n--;return this._iterate(t,n+1),this}},{key:"forEachAtTime",value:function(e,t){var n=this._search(e);if(-1!==n&&PK(this._timeline[n].time,e)){for(var r=n,a=n;a>=0&&PK(this._timeline[a].time,e);a--)r=a;this._iterate((function(e){t(e)}),r,n)}return this}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._timeline=[],this}}],[{key:"getDefaults",value:function(){return{memory:1/0,increasing:!1}}}]),n}(TK),RK=[];function OK(e){RK.push(e)}var FK=[];function LK(e){FK.push(e)}function zK(e){FK.forEach((function(t){return t(e)}))}var BK=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.apply(this,arguments)).name="Emitter",e}return c(n,[{key:"on",value:function(e,t){var n=this;return e.split(/\W+/).forEach((function(e){eK(n._events)&&(n._events={}),n._events.hasOwnProperty(e)||(n._events[e]=[]),n._events[e].push(t)})),this}},{key:"once",value:function(e,t){var n=this;return this.on(e,(function r(){t.apply(void 0,arguments),n.off(e,r)})),this}},{key:"off",value:function(e,t){var n=this;return e.split(/\W+/).forEach((function(r){if(eK(n._events)&&(n._events={}),n._events.hasOwnProperty(e))if(eK(t))n._events[e]=[];else for(var a=n._events[e],i=a.length-1;i>=0;i--)a[i]===t&&a.splice(i,1)})),this}},{key:"emit",value:function(e){if(this._events&&this._events.hasOwnProperty(e)){for(var t=this._events[e].slice(0),n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];for(var i=0,o=t.length;i<o;i++)t[i].apply(this,r)}return this}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._events=void 0,this}}],[{key:"mixin",value:function(e){["on","once","off","emit"].forEach((function(t){var r=Object.getOwnPropertyDescriptor(n.prototype,t);Object.defineProperty(e.prototype,t,r)}))}}]),n}(TK),VK=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.apply(this,arguments)).isOffline=!1,e}return c(n,[{key:"toJSON",value:function(){return{}}}]),n}(BK),jK=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this)).name="Context",e._constants=new Map,e._timeouts=new DK,e._timeoutIds=0,e._initialized=!1,e.isOffline=!1,e._workletModules=new Map;var r=_K(n.getDefaults(),arguments,["context"]);return r.context?e._context=r.context:e._context=cK({latencyHint:r.latencyHint}),e._ticker=new mK(e.emit.bind(m(e),"tick"),r.clockSource,r.updateInterval),e.on("tick",e._timeoutLoop.bind(m(e))),e._context.onstatechange=function(){e.emit("statechange",e.state)},e._setLatencyHint(r.latencyHint),e.lookAhead=r.lookAhead,e}return c(n,[{key:"initialize",value:function(){var e;return this._initialized||(e=this,RK.forEach((function(t){return t(e)})),this._initialized=!0),this}},{key:"createAnalyser",value:function(){return this._context.createAnalyser()}},{key:"createOscillator",value:function(){return this._context.createOscillator()}},{key:"createBufferSource",value:function(){return this._context.createBufferSource()}},{key:"createBiquadFilter",value:function(){return this._context.createBiquadFilter()}},{key:"createBuffer",value:function(e,t,n){return this._context.createBuffer(e,t,n)}},{key:"createChannelMerger",value:function(e){return this._context.createChannelMerger(e)}},{key:"createChannelSplitter",value:function(e){return this._context.createChannelSplitter(e)}},{key:"createConstantSource",value:function(){return this._context.createConstantSource()}},{key:"createConvolver",value:function(){return this._context.createConvolver()}},{key:"createDelay",value:function(e){return this._context.createDelay(e)}},{key:"createDynamicsCompressor",value:function(){return this._context.createDynamicsCompressor()}},{key:"createGain",value:function(){return this._context.createGain()}},{key:"createIIRFilter",value:function(e,t){return this._context.createIIRFilter(e,t)}},{key:"createPanner",value:function(){return this._context.createPanner()}},{key:"createPeriodicWave",value:function(e,t,n){return this._context.createPeriodicWave(e,t,n)}},{key:"createStereoPanner",value:function(){return this._context.createStereoPanner()}},{key:"createWaveShaper",value:function(){return this._context.createWaveShaper()}},{key:"createMediaStreamSource",value:function(e){return KH(bK(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(e)}},{key:"createMediaElementSource",value:function(e){return KH(bK(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(e)}},{key:"createMediaStreamDestination",value:function(){return KH(bK(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}},{key:"decodeAudioData",value:function(e){return this._context.decodeAudioData(e)}},{key:"currentTime",get:function(){return this._context.currentTime}},{key:"state",get:function(){return this._context.state}},{key:"sampleRate",get:function(){return this._context.sampleRate}},{key:"listener",get:function(){return this.initialize(),this._listener},set:function(e){KH(!this._initialized,"The listener cannot be set after initialization."),this._listener=e}},{key:"transport",get:function(){return this.initialize(),this._transport},set:function(e){KH(!this._initialized,"The transport cannot be set after initialization."),this._transport=e}},{key:"draw",get:function(){return this.initialize(),this._draw},set:function(e){KH(!this._initialized,"Draw cannot be set after initialization."),this._draw=e}},{key:"destination",get:function(){return this.initialize(),this._destination},set:function(e){KH(!this._initialized,"The destination cannot be set after initialization."),this._destination=e}},{key:"createAudioWorkletNode",value:function(e,t){return function(e,t,n){return KH(tK(zH),"This node only works in a secure context (https or localhost)"),new zH(e,t,n)}(this.rawContext,e,t)}},{key:"addAudioWorkletModule",value:function(e,t){return dK(this,void 0,void 0,x().mark((function n(){return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return KH(tK(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(t)||this._workletModules.set(t,this.rawContext.audioWorklet.addModule(e)),n.next=4,this._workletModules.get(t);case 4:case"end":return n.stop()}}),n,this)})))}},{key:"workletsAreReady",value:function(){return dK(this,void 0,void 0,x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],this._workletModules.forEach((function(e){return t.push(e)})),e.next=4,Promise.all(t);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"updateInterval",get:function(){return this._ticker.updateInterval},set:function(e){this._ticker.updateInterval=e}},{key:"clockSource",get:function(){return this._ticker.type},set:function(e){this._ticker.type=e}},{key:"latencyHint",get:function(){return this._latencyHint}},{key:"_setLatencyHint",value:function(e){var t=0;if(this._latencyHint=e,sK(e))switch(e){case"interactive":t=.1;break;case"playback":t=.5;break;case"balanced":t=.25}this.lookAhead=t,this.updateInterval=t/2}},{key:"rawContext",get:function(){return this._context}},{key:"now",value:function(){return this._context.currentTime+this.lookAhead}},{key:"immediate",value:function(){return this._context.currentTime}},{key:"resume",value:function(){return bK(this._context)?this._context.resume():Promise.resolve()}},{key:"close",value:function(){return dK(this,void 0,void 0,x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!bK(this._context)){e.next=3;break}return e.next=3,this._context.close();case 3:this._initialized&&zK(this);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"getConstant",value:function(e){if(this._constants.has(e))return this._constants.get(e);for(var t=this._context.createBuffer(1,128,this._context.sampleRate),n=t.getChannelData(0),r=0;r<n.length;r++)n[r]=e;var a=this._context.createBufferSource();return a.channelCount=1,a.channelCountMode="explicit",a.buffer=t,a.loop=!0,a.start(0),this._constants.set(e,a),a}},{key:"dispose",value:function(){var e=this;return Rw(f(n.prototype),"dispose",this).call(this),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map((function(t){return e._constants[t].disconnect()})),this}},{key:"_timeoutLoop",value:function(){for(var e=this.now(),t=this._timeouts.peek();this._timeouts.length&&t&&t.time<=e;)t.callback(),this._timeouts.shift(),t=this._timeouts.peek()}},{key:"setTimeout",value:function(e,t){this._timeoutIds++;var n=this.now();return this._timeouts.add({callback:e,id:this._timeoutIds,time:n+t}),this._timeoutIds}},{key:"clearTimeout",value:function(e){var t=this;return this._timeouts.forEach((function(n){n.id===e&&t._timeouts.remove(n)})),this}},{key:"clearInterval",value:function(e){return this.clearTimeout(e)}},{key:"setInterval",value:function(e,t){var n=this,r=++this._timeoutIds;return function a(){var i=n.now();n._timeouts.add({callback:function(){e(),a()},id:r,time:i+t})}(),r}}],[{key:"getDefaults",value:function(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}}]),n}(VK),qK=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.apply(this,arguments)).lookAhead=0,e.latencyHint=0,e.isOffline=!1,e}return c(n,[{key:"createAnalyser",value:function(){return{}}},{key:"createOscillator",value:function(){return{}}},{key:"createBufferSource",value:function(){return{}}},{key:"createBiquadFilter",value:function(){return{}}},{key:"createBuffer",value:function(e,t,n){return{}}},{key:"createChannelMerger",value:function(e){return{}}},{key:"createChannelSplitter",value:function(e){return{}}},{key:"createConstantSource",value:function(){return{}}},{key:"createConvolver",value:function(){return{}}},{key:"createDelay",value:function(e){return{}}},{key:"createDynamicsCompressor",value:function(){return{}}},{key:"createGain",value:function(){return{}}},{key:"createIIRFilter",value:function(e,t){return{}}},{key:"createPanner",value:function(){return{}}},{key:"createPeriodicWave",value:function(e,t,n){return{}}},{key:"createStereoPanner",value:function(){return{}}},{key:"createWaveShaper",value:function(){return{}}},{key:"createMediaStreamSource",value:function(e){return{}}},{key:"createMediaElementSource",value:function(e){return{}}},{key:"createMediaStreamDestination",value:function(){return{}}},{key:"decodeAudioData",value:function(e){return Promise.resolve({})}},{key:"createAudioWorkletNode",value:function(e,t){return{}}},{key:"rawContext",get:function(){return{}}},{key:"addAudioWorkletModule",value:function(e,t){return dK(this,void 0,void 0,x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve());case 1:case"end":return e.stop()}}),e)})))}},{key:"resume",value:function(){return Promise.resolve()}},{key:"setTimeout",value:function(e,t){return 0}},{key:"clearTimeout",value:function(e){return this}},{key:"setInterval",value:function(e,t){return 0}},{key:"clearInterval",value:function(e){return this}},{key:"getConstant",value:function(e){return{}}},{key:"currentTime",get:function(){return 0}},{key:"state",get:function(){return{}}},{key:"sampleRate",get:function(){return 0}},{key:"listener",get:function(){return{}}},{key:"transport",get:function(){return{}}},{key:"draw",get:function(){return{}},set:function(e){}},{key:"destination",get:function(){return{}},set:function(e){}},{key:"now",value:function(){return 0}},{key:"immediate",value:function(){return 0}}]),n}(VK);function GK(e,t){oK(t)?t.forEach((function(t){return GK(e,t)})):Object.defineProperty(e,t,{enumerable:!0,writable:!1})}function WK(e,t){oK(t)?t.forEach((function(t){return WK(e,t)})):Object.defineProperty(e,t,{writable:!0})}var UK=function(){},HK=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this)).name="ToneAudioBuffer",e.onload=UK;var r=_K(n.getDefaults(),arguments,["url","onload","onerror"]);return e.reverse=r.reverse,e.onload=r.onload,r.url&&kK(r.url)||r.url instanceof n?e.set(r.url):sK(r.url)&&e.load(r.url).catch(r.onerror),e}return c(n,[{key:"sampleRate",get:function(){return this._buffer?this._buffer.sampleRate:QK().sampleRate}},{key:"set",value:function(e){var t=this;return e instanceof n?e.loaded?this._buffer=e.get():e.onload=function(){t.set(e),t.onload(t)}:this._buffer=e,this._reversed&&this._reverse(),this}},{key:"get",value:function(){return this._buffer}},{key:"load",value:function(e){return dK(this,void 0,void 0,x().mark((function t(){var r,a,i=this;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.load(e).then((function(e){i.set(e),i.onload(i)})),n.downloads.push(r),t.prev=2,t.next=5,r;case 5:return t.prev=5,a=n.downloads.indexOf(r),n.downloads.splice(a,1),t.finish(5);case 9:return t.abrupt("return",this);case 10:case"end":return t.stop()}}),t,this,[[2,,5,9]])})))}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._buffer=void 0,this}},{key:"fromArray",value:function(e){for(var t=oK(e)&&e[0].length>0,n=t?e.length:1,r=t?e[0].length:e.length,a=QK(),i=a.createBuffer(n,r,a.sampleRate),o=t||1!==n?e:[e],s=0;s<n;s++)i.copyToChannel(o[s],s);return this._buffer=i,this}},{key:"toMono",value:function(e){if(rK(e))this.fromArray(this.toArray(e));else{for(var t=new Float32Array(this.length),n=this.numberOfChannels,r=0;r<n;r++)for(var a=this.toArray(r),i=0;i<a.length;i++)t[i]+=a[i];t=t.map((function(e){return e/n})),this.fromArray(t)}return this}},{key:"toArray",value:function(e){if(rK(e))return this.getChannelData(e);if(1===this.numberOfChannels)return this.toArray(0);for(var t=[],n=0;n<this.numberOfChannels;n++)t[n]=this.getChannelData(n);return t}},{key:"getChannelData",value:function(e){return this._buffer?this._buffer.getChannelData(e):new Float32Array(0)}},{key:"slice",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.duration,r=Math.floor(e*this.sampleRate),a=Math.floor(t*this.sampleRate);KH(r<a,"The start time must be less than the end time");for(var i=a-r,o=QK().createBuffer(this.numberOfChannels,i,this.sampleRate),s=0;s<this.numberOfChannels;s++)o.copyToChannel(this.getChannelData(s).subarray(r,a),s);return new n(o)}},{key:"_reverse",value:function(){if(this.loaded)for(var e=0;e<this.numberOfChannels;e++)this.getChannelData(e).reverse();return this}},{key:"loaded",get:function(){return this.length>0}},{key:"duration",get:function(){return this._buffer?this._buffer.duration:0}},{key:"length",get:function(){return this._buffer?this._buffer.length:0}},{key:"numberOfChannels",get:function(){return this._buffer?this._buffer.numberOfChannels:0}},{key:"reverse",get:function(){return this._reversed},set:function(e){this._reversed!==e&&(this._reversed=e,this._reverse())}}],[{key:"getDefaults",value:function(){return{onerror:UK,onload:UK,reverse:!1}}},{key:"fromArray",value:function(e){return(new n).fromArray(e)}},{key:"fromUrl",value:function(e){return dK(this,void 0,void 0,x().mark((function t(){var r;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new n,t.next=3,r.load(e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))}},{key:"load",value:function(e){return dK(this,void 0,void 0,x().mark((function t(){var r,a,i,o,s,u,c,l,h,f;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=e.match(/\[([^\]\[]+\|.+)\]$/))){t.next=23;break}a=r[1].split("|"),i=a[0],o=zo(a),t.prev=5,o.s();case 7:if((s=o.n()).done){t.next=14;break}if(u=s.value,!n.supportsType(u)){t.next=12;break}return i=u,t.abrupt("break",14);case 12:t.next=7;break;case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(5),o.e(t.t0);case 19:return t.prev=19,o.f(),t.finish(19);case 22:e=e.replace(r[0],i);case 23:return c=""===n.baseUrl||n.baseUrl.endsWith("/")?n.baseUrl:n.baseUrl+"/",t.next=26,fetch(c+e);case 26:if((l=t.sent).ok){t.next=29;break}throw new Error("could not load url: ".concat(e));case 29:return t.next=31,l.arrayBuffer();case 31:return h=t.sent,t.next=34,QK().decodeAudioData(h);case 34:return f=t.sent,t.abrupt("return",f);case 36:case"end":return t.stop()}}),t,null,[[5,16,19,22]])})))}},{key:"supportsType",value:function(e){var t=e.split("."),n=t[t.length-1];return""!==document.createElement("audio").canPlayType("audio/"+n)}},{key:"loaded",value:function(){return dK(this,void 0,void 0,x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve();case 2:if(!n.downloads.length){e.next=7;break}return e.next=5,n.downloads[0];case 5:e.next=2;break;case 7:case"end":return e.stop()}}),e)})))}}]),n}(TK);HK.baseUrl="",HK.downloads=[];var KK=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.call(this,{clockSource:"offline",context:yK(arguments[0])?arguments[0]:lK(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:yK(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]})).name="OfflineContext",e._currentTime=0,e.isOffline=!0,e._duration=yK(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1],e}return c(n,[{key:"now",value:function(){return this._currentTime}},{key:"currentTime",get:function(){return this._currentTime}},{key:"_renderClock",value:function(e){return dK(this,void 0,void 0,x().mark((function t(){var n,r;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=0;case 1:if(!(this._duration-this._currentTime>=0)){t.next=11;break}if(this.emit("tick"),this._currentTime+=128/this.sampleRate,n++,r=Math.floor(this.sampleRate/128),!e||n%r!==0){t.next=9;break}return t.next=9,new Promise((function(e){return setTimeout(e,1)}));case 9:t.next=1;break;case 11:case"end":return t.stop()}}),t,this)})))}},{key:"render",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return dK(this,void 0,void 0,x().mark((function t(){var n;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.workletsAreReady();case 2:return t.next=4,this._renderClock(e);case 4:return t.next=6,this._context.startRendering();case 6:return n=t.sent,t.abrupt("return",new HK(n));case 8:case"end":return t.stop()}}),t,this)})))}},{key:"close",value:function(){return Promise.resolve()}}]),n}(jK),XK=new qK,YK=XK;function QK(){return YK===XK&&fK&&$K(new jK),YK}function $K(e){YK=bK(e)?new jK(e):yK(e)?new KK(e):e}function JK(){return YK.resume()}if(hK&&!hK.TONE_SILENCE_LOGGING){var ZK="v";"dev"===aq&&(ZK="");var eX=" * Tone.js ".concat(ZK).concat(aq," * ");console.log("%c".concat(eX),"background: #000; color: #fff")}function tX(e){return Math.pow(10,e/20)}function nX(e){return Math.log(e)/Math.LN10*20}function rX(e){return Math.pow(2,e/12)}var aX=440;function iX(e){return Math.round(oX(e))}function oX(e){return 69+12*Math.log2(e/aX)}function sX(e){return aX*Math.pow(2,(e-69)/12)}var uX=function(e){h(n,e);var t=g(n);function n(e,r,a){var i;return s(this,n),(i=t.call(this)).defaultUnits="s",i._val=r,i._units=a,i.context=e,i._expressions=i._getExpressions(),i}return c(n,[{key:"_getExpressions",value:function(){var e=this;return{hz:{method:function(t){return e._frequencyToUnits(parseFloat(t))},regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:function(t){return e._ticksToUnits(parseInt(t,10))},regexp:/^(\d+)i$/i},m:{method:function(t){return e._beatsToUnits(parseInt(t,10)*e._getTimeSignature())},regexp:/^(\d+)m$/i},n:{method:function(t,n){var r=parseInt(t,10),a="."===n?1.5:1;return 1===r?e._beatsToUnits(e._getTimeSignature())*a:e._beatsToUnits(4/r)*a},regexp:/^(\d+)n(\.?)$/i},number:{method:function(t){return e._expressions[e.defaultUnits].method.call(e,t)},regexp:/^(\d+(?:\.\d+)?)$/},s:{method:function(t){return e._secondsToUnits(parseFloat(t))},regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:function(t){return parseInt(t,10)/e.context.sampleRate},regexp:/^(\d+)samples$/},t:{method:function(t){var n=parseInt(t,10);return e._beatsToUnits(8/(3*Math.floor(n)))},regexp:/^(\d+)t$/i},tr:{method:function(t,n,r){var a=0;return t&&"0"!==t&&(a+=e._beatsToUnits(e._getTimeSignature()*parseFloat(t))),n&&"0"!==n&&(a+=e._beatsToUnits(parseFloat(n))),r&&"0"!==r&&(a+=e._beatsToUnits(parseFloat(r)/4)),a},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}},{key:"valueOf",value:function(){if(this._val instanceof n&&this.fromType(this._val),eK(this._val))return this._noArg();if(sK(this._val)&&eK(this._units)){for(var e in this._expressions)if(this._expressions[e].regexp.test(this._val.trim())){this._units=e;break}}else if(aK(this._val)){var t=0;for(var r in this._val)if(tK(this._val[r])){var a=this._val[r];t+=new this.constructor(this.context,r).valueOf()*a}return t}if(tK(this._units)){var i=this._expressions[this._units],o=this._val.toString().trim().match(i.regexp);return o?i.method.apply(this,o.slice(1)):i.method.call(this,this._val)}return sK(this._val)?parseFloat(this._val):this._val}},{key:"_frequencyToUnits",value:function(e){return 1/e}},{key:"_beatsToUnits",value:function(e){return 60/this._getBpm()*e}},{key:"_secondsToUnits",value:function(e){return e}},{key:"_ticksToUnits",value:function(e){return e*this._beatsToUnits(1)/this._getPPQ()}},{key:"_noArg",value:function(){return this._now()}},{key:"_getBpm",value:function(){return this.context.transport.bpm.value}},{key:"_getTimeSignature",value:function(){return this.context.transport.timeSignature}},{key:"_getPPQ",value:function(){return this.context.transport.PPQ}},{key:"fromType",value:function(e){switch(this._units=void 0,this.defaultUnits){case"s":this._val=e.toSeconds();break;case"i":this._val=e.toTicks();break;case"hz":this._val=e.toFrequency();break;case"midi":this._val=e.toMidi()}return this}},{key:"toFrequency",value:function(){return 1/this.toSeconds()}},{key:"toSamples",value:function(){return this.toSeconds()*this.context.sampleRate}},{key:"toMilliseconds",value:function(){return 1e3*this.toSeconds()}}]),n}(TK),cX=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.apply(this,arguments)).name="TimeClass",e}return c(n,[{key:"_getExpressions",value:function(){var e=this;return Object.assign(Rw(f(n.prototype),"_getExpressions",this).call(this),{now:{method:function(t){return e._now()+new e.constructor(e.context,t).valueOf()},regexp:/^\+(.+)/},quantize:{method:function(t){var r=new n(e.context,t).valueOf();return e._secondsToUnits(e.context.transport.nextSubdivision(r))},regexp:/^@(.+)/}})}},{key:"quantize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=new this.constructor(this.context,e).valueOf(),r=this.valueOf(),a=Math.round(r/n),i=a*n,o=i-r;return r+o*t}},{key:"toNotation",value:function(){for(var e=this,t=this.toSeconds(),r=["1m"],a=1;a<9;a++){var i=Math.pow(2,a);r.push(i+"n."),r.push(i+"n"),r.push(i+"t")}r.push("0");var o=r[0],s=new n(this.context,r[0]).toSeconds();return r.forEach((function(r){var a=new n(e.context,r).toSeconds();Math.abs(a-t)<Math.abs(s-t)&&(o=r,s=a)})),o}},{key:"toBarsBeatsSixteenths",value:function(){var e=this._beatsToUnits(1),t=this.valueOf()/e;t=parseFloat(t.toFixed(4));var n=Math.floor(t/this._getTimeSignature()),r=t%1*4;t=Math.floor(t)%this._getTimeSignature();var a=r.toString();return a.length>3&&(r=parseFloat(parseFloat(a).toFixed(3))),[n,t,r].join(":")}},{key:"toTicks",value:function(){var e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.round(t*this._getPPQ())}},{key:"toSeconds",value:function(){return this.valueOf()}},{key:"toMidi",value:function(){return iX(this.toFrequency())}},{key:"_now",value:function(){return this.context.now()}}]),n}(uX);function lX(e,t){return new cX(QK(),e,t)}var hX=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.apply(this,arguments)).name="Frequency",e.defaultUnits="hz",e}return c(n,[{key:"_getExpressions",value:function(){return Object.assign({},Rw(f(n.prototype),"_getExpressions",this).call(this),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method:function(e){return"midi"===this.defaultUnits?e:n.mtof(e)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method:function(e,t){var r=fX[e.toLowerCase()]+12*(parseInt(t,10)+1);return"midi"===this.defaultUnits?r:n.mtof(r)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method:function(e,t,n){var r=1;return e&&"0"!==e&&(r*=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&"0"!==t&&(r*=this._beatsToUnits(parseFloat(t))),n&&"0"!==n&&(r*=this._beatsToUnits(parseFloat(n)/4)),r}}})}},{key:"transpose",value:function(e){return new n(this.context,this.valueOf()*rX(e))}},{key:"harmonize",value:function(e){var t=this;return e.map((function(e){return t.transpose(e)}))}},{key:"toMidi",value:function(){return iX(this.valueOf())}},{key:"toNote",value:function(){var e=this.toFrequency(),t=Math.log2(e/n.A4),r=Math.round(12*t)+57,a=Math.floor(r/12);return a<0&&(r+=-12*a),pX[r%12]+a.toString()}},{key:"toSeconds",value:function(){return 1/Rw(f(n.prototype),"toSeconds",this).call(this)}},{key:"toTicks",value:function(){var e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.floor(t*this._getPPQ())}},{key:"_noArg",value:function(){return 0}},{key:"_frequencyToUnits",value:function(e){return e}},{key:"_ticksToUnits",value:function(e){return 1/(60*e/(this._getBpm()*this._getPPQ()))}},{key:"_beatsToUnits",value:function(e){return 1/Rw(f(n.prototype),"_beatsToUnits",this).call(this,e)}},{key:"_secondsToUnits",value:function(e){return 1/e}}],[{key:"A4",get:function(){return aX},set:function(e){!function(e){aX=e}(e)}},{key:"mtof",value:function(e){return sX(e)}},{key:"ftom",value:function(e){return iX(e)}}]),n}(cX),fX={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},pX=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function dX(e,t){return new hX(QK(),e,t)}var mX=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.apply(this,arguments)).name="TransportTime",e}return c(n,[{key:"_now",value:function(){return this.context.transport.seconds}}]),n}(cX);function vX(e,t){return new mX(QK(),e,t)}var gX=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),e=t.call(this);var r=_K(n.getDefaults(),arguments,["context"]);return e.defaultContext?e.context=e.defaultContext:e.context=r.context,e}return c(n,[{key:"now",value:function(){return this.context.currentTime+this.context.lookAhead}},{key:"immediate",value:function(){return this.context.currentTime}},{key:"sampleTime",get:function(){return 1/this.context.sampleRate}},{key:"blockTime",get:function(){return 128/this.context.sampleRate}},{key:"toSeconds",value:function(e){return new cX(this.context,e).toSeconds()}},{key:"toFrequency",value:function(e){return new hX(this.context,e).toFrequency()}},{key:"toTicks",value:function(e){return new mX(this.context,e).toTicks()}},{key:"_getPartialProperties",value:function(e){var t=this.get();return Object.keys(t).forEach((function(n){eK(e[n])&&delete t[n]})),t}},{key:"get",value:function(){var e=this,t=this.constructor.getDefaults();return Object.keys(t).forEach((function(r){if(Reflect.has(e,r)){var a=e[r];tK(a)&&tK(a.value)&&tK(a.setValueAtTime)?t[r]=a.value:a instanceof n?t[r]=a._getPartialProperties(t[r]):oK(a)||rK(a)||sK(a)||iK(a)?t[r]=a:delete t[r]}})),t}},{key:"set",value:function(e){var t=this;return Object.keys(e).forEach((function(r){Reflect.has(t,r)&&tK(t[r])&&(t[r]&&tK(t[r].value)&&tK(t[r].setValueAtTime)?t[r].value!==e[r]&&(t[r].value=e[r]):t[r]instanceof n?t[r].set(e[r]):t[r]=e[r])})),this}}],[{key:"getDefaults",value:function(){return{context:QK()}}}]),n}(TK),yX=function(e){h(n,e);var t=g(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"stopped";return s(this,n),(e=t.call(this)).name="StateTimeline",e._initial=r,e.setStateAtTime(e._initial,0),e}return c(n,[{key:"getValueAtTime",value:function(e){var t=this.get(e);return null!==t?t.state:this._initial}},{key:"setStateAtTime",value:function(e,t,n){return XH(t,0),this.add(Object.assign({},n,{state:e,time:t})),this}},{key:"getLastState",value:function(e,t){for(var n=this._search(t);n>=0;n--){var r=this._timeline[n];if(r.state===e)return r}}},{key:"getNextState",value:function(e,t){var n=this._search(t);if(-1!==n)for(var r=n;r<this._timeline.length;r++){var a=this._timeline[r];if(a.state===e)return a}}}]),n}(DK),bX=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["param","units","convert"]))).name="Param",e.overridden=!1,e._minOutput=1e-7;var r=_K(n.getDefaults(),arguments,["param","units","convert"]);for(KH(tK(r.param)&&(vK(r.param)||r.param instanceof n),"param must be an AudioParam");!vK(r.param);)r.param=r.param._param;return e._swappable=!!tK(r.swappable)&&r.swappable,e._swappable?(e.input=e.context.createGain(),e._param=r.param,e.input.connect(e._param)):e._param=e.input=r.param,e._events=new DK(1e3),e._initialValue=e._param.defaultValue,e.units=r.units,e.convert=r.convert,e._minValue=r.minValue,e._maxValue=r.maxValue,tK(r.value)&&r.value!==e._toType(e._initialValue)&&e.setValueAtTime(r.value,0),e}return c(n,[{key:"value",get:function(){var e=this.now();return this.getValueAtTime(e)},set:function(e){this.cancelScheduledValues(this.now()),this.setValueAtTime(e,this.now())}},{key:"minValue",get:function(){return tK(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}},{key:"maxValue",get:function(){return tK(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}},{key:"_is",value:function(e,t){return this.units===t}},{key:"_assertRange",value:function(e){return tK(this.maxValue)&&tK(this.minValue)&&XH(e,this._fromType(this.minValue),this._fromType(this.maxValue)),e}},{key:"_fromType",value:function(e){return this.convert&&!this.overridden?this._is(e,"time")?this.toSeconds(e):this._is(e,"decibels")?tX(e):this._is(e,"frequency")?this.toFrequency(e):e:this.overridden?0:e}},{key:"_toType",value:function(e){return this.convert&&"decibels"===this.units?nX(e):e}},{key:"setValueAtTime",value:function(e,t){var n=this.toSeconds(t),r=this._fromType(e);return KH(isFinite(r)&&isFinite(n),"Invalid argument(s) to setValueAtTime: ".concat(JSON.stringify(e),", ").concat(JSON.stringify(t))),this._assertRange(r),this.log(this.units,"setValueAtTime",e,n),this._events.add({time:n,type:"setValueAtTime",value:r}),this._param.setValueAtTime(r,n),this}},{key:"getValueAtTime",value:function(e){var t=Math.max(this.toSeconds(e),0),n=this._events.getAfter(t),r=this._events.get(t),a=this._initialValue;if(null===r)a=this._initialValue;else if("setTargetAtTime"!==r.type||null!==n&&"setValueAtTime"!==n.type)if(null===n)a=r.value;else if("linearRampToValueAtTime"===n.type||"exponentialRampToValueAtTime"===n.type){var i=r.value;if("setTargetAtTime"===r.type){var o=this._events.getBefore(r.time);i=null===o?this._initialValue:o.value}a="linearRampToValueAtTime"===n.type?this._linearInterpolate(r.time,i,n.time,n.value,t):this._exponentialInterpolate(r.time,i,n.time,n.value,t)}else a=r.value;else{var s,u=this._events.getBefore(r.time);s=null===u?this._initialValue:u.value,"setTargetAtTime"===r.type&&(a=this._exponentialApproach(r.time,s,r.value,r.constant,t))}return this._toType(a)}},{key:"setRampPoint",value:function(e){e=this.toSeconds(e);var t=this.getValueAtTime(e);return this.cancelAndHoldAtTime(e),0===this._fromType(t)&&(t=this._toType(this._minOutput)),this.setValueAtTime(t,e),this}},{key:"linearRampToValueAtTime",value:function(e,t){var n=this._fromType(e),r=this.toSeconds(t);return KH(isFinite(n)&&isFinite(r),"Invalid argument(s) to linearRampToValueAtTime: ".concat(JSON.stringify(e),", ").concat(JSON.stringify(t))),this._assertRange(n),this._events.add({time:r,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",e,r),this._param.linearRampToValueAtTime(n,r),this}},{key:"exponentialRampToValueAtTime",value:function(e,t){var n=this._fromType(e);n=PK(n,0)?this._minOutput:n,this._assertRange(n);var r=this.toSeconds(t);return KH(isFinite(n)&&isFinite(r),"Invalid argument(s) to exponentialRampToValueAtTime: ".concat(JSON.stringify(e),", ").concat(JSON.stringify(t))),this._events.add({time:r,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",e,r),this._param.exponentialRampToValueAtTime(n,r),this}},{key:"exponentialRampTo",value:function(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(e,n+this.toSeconds(t)),this}},{key:"linearRampTo",value:function(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(e,n+this.toSeconds(t)),this}},{key:"targetRampTo",value:function(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(e,n,t),this}},{key:"exponentialApproachValueAtTime",value:function(e,t,n){t=this.toSeconds(t),n=this.toSeconds(n);var r=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(e,t,r),this.cancelAndHoldAtTime(t+.9*n),this.linearRampToValueAtTime(e,t+n),this}},{key:"setTargetAtTime",value:function(e,t,n){var r=this._fromType(e);KH(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");var a=this.toSeconds(t);return this._assertRange(r),KH(isFinite(r)&&isFinite(a),"Invalid argument(s) to setTargetAtTime: ".concat(JSON.stringify(e),", ").concat(JSON.stringify(t))),this._events.add({constant:n,time:a,type:"setTargetAtTime",value:r}),this.log(this.units,"setTargetAtTime",e,a,n),this._param.setTargetAtTime(r,a,n),this}},{key:"setValueCurveAtTime",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;n=this.toSeconds(n),t=this.toSeconds(t);var a=this._fromType(e[0])*r;this.setValueAtTime(this._toType(a),t);for(var i=n/(e.length-1),o=1;o<e.length;o++){var s=this._fromType(e[o])*r;this.linearRampToValueAtTime(this._toType(s),t+o*i)}return this}},{key:"cancelScheduledValues",value:function(e){var t=this.toSeconds(e);return KH(isFinite(t),"Invalid argument to cancelScheduledValues: ".concat(JSON.stringify(e))),this._events.cancel(t),this._param.cancelScheduledValues(t),this.log(this.units,"cancelScheduledValues",t),this}},{key:"cancelAndHoldAtTime",value:function(e){var t=this.toSeconds(e),n=this._fromType(this.getValueAtTime(t));KH(isFinite(t),"Invalid argument to cancelAndHoldAtTime: ".concat(JSON.stringify(e))),this.log(this.units,"cancelAndHoldAtTime",t,"value="+n);var r=this._events.get(t),a=this._events.getAfter(t);return r&&PK(r.time,t)?a?(this._param.cancelScheduledValues(a.time),this._events.cancel(a.time)):(this._param.cancelAndHoldAtTime(t),this._events.cancel(t+this.sampleTime)):a&&(this._param.cancelScheduledValues(a.time),this._events.cancel(a.time),"linearRampToValueAtTime"===a.type?this.linearRampToValueAtTime(this._toType(n),t):"exponentialRampToValueAtTime"===a.type&&this.exponentialRampToValueAtTime(this._toType(n),t)),this._events.add({time:t,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,t),this}},{key:"rampTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1,n=arguments.length>2?arguments[2]:void 0;return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(e,t,n):this.linearRampTo(e,t,n),this}},{key:"apply",value:function(e){var t=this.context.currentTime;e.setValueAtTime(this.getValueAtTime(t),t);var n=this._events.get(t);if(n&&"setTargetAtTime"===n.type)for(var r=this._events.getAfter(n.time),a=r?r.time:t+2,i=(a-t)/10,o=t;o<a;o+=i)e.linearRampToValueAtTime(this.getValueAtTime(o),o);return this._events.forEachAfter(this.context.currentTime,(function(t){"cancelScheduledValues"===t.type?e.cancelScheduledValues(t.time):"setTargetAtTime"===t.type?e.setTargetAtTime(t.value,t.time,t.constant):e[t.type](t.value,t.time)})),this}},{key:"setParam",value:function(e){KH(this._swappable,"The Param must be assigned as 'swappable' in the constructor");var t=this.input;return t.disconnect(this._param),this.apply(e),this._param=e,t.connect(this._param),this}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._events.dispose(),this}},{key:"defaultValue",get:function(){return this._toType(this._param.defaultValue)}},{key:"_exponentialApproach",value:function(e,t,n,r,a){return n+(t-n)*Math.exp(-(a-e)/r)}},{key:"_linearInterpolate",value:function(e,t,n,r,a){return t+(a-e)/(n-e)*(r-t)}},{key:"_exponentialInterpolate",value:function(e,t,n,r,a){return t*Math.pow(r/t,(a-e)/(n-e))}}],[{key:"getDefaults",value:function(){return Object.assign(gX.getDefaults(),{convert:!0,units:"number"})}}]),n}(gX),kX=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.apply(this,arguments)).name="ToneAudioNode",e._internalChannels=[],e}return c(n,[{key:"numberOfInputs",get:function(){return tK(this.input)?vK(this.input)||this.input instanceof bX?1:this.input.numberOfInputs:0}},{key:"numberOfOutputs",get:function(){return tK(this.output)?this.output.numberOfOutputs:0}},{key:"_isAudioNode",value:function(e){return tK(e)&&(e instanceof n||gK(e))}},{key:"_getInternalNodes",value:function(){var e=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&e.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&e.push(this.output),e}},{key:"_setChannelProperties",value:function(e){this._getInternalNodes().forEach((function(t){t.channelCount=e.channelCount,t.channelCountMode=e.channelCountMode,t.channelInterpretation=e.channelInterpretation}))}},{key:"_getChannelProperties",value:function(){var e=this._getInternalNodes();KH(e.length>0,"ToneAudioNode does not have any internal nodes");var t=e[0];return{channelCount:t.channelCount,channelCountMode:t.channelCountMode,channelInterpretation:t.channelInterpretation}}},{key:"channelCount",get:function(){return this._getChannelProperties().channelCount},set:function(e){var t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCount:e}))}},{key:"channelCountMode",get:function(){return this._getChannelProperties().channelCountMode},set:function(e){var t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCountMode:e}))}},{key:"channelInterpretation",get:function(){return this._getChannelProperties().channelInterpretation},set:function(e){var t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelInterpretation:e}))}},{key:"connect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return wX(this,e,t,n),this}},{key:"toDestination",value:function(){return this.connect(this.context.destination),this}},{key:"toMaster",value:function(){return ZH("toMaster() has been renamed toDestination()"),this.toDestination()}},{key:"disconnect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return _X(this,e,t,n),this}},{key:"chain",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return xX.apply(void 0,[this].concat(t)),this}},{key:"fan",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach((function(t){return e.connect(t)})),this}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),tK(this.input)&&(this.input instanceof n?this.input.dispose():gK(this.input)&&this.input.disconnect()),tK(this.output)&&(this.output instanceof n?this.output.dispose():gK(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}]),n}(gX);function xX(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.shift();t.reduce((function(e,t){return e instanceof kX?e.connect(t):gK(e)&&wX(e,t),t}),r)}function wX(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;for(KH(tK(e),"Cannot connect from undefined node"),KH(tK(t),"Cannot connect to undefined node"),(t instanceof kX||gK(t))&&KH(t.numberOfInputs>0,"Cannot connect to node with no inputs"),KH(e.numberOfOutputs>0,"Cannot connect from node with no outputs");t instanceof kX||t instanceof bX;)tK(t.input)&&(t=t.input);for(;e instanceof kX;)tK(e.output)&&(e=e.output);vK(t)?e.connect(t,n):e.connect(t,n,r)}function _X(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(tK(t))for(;t instanceof kX;)t=t.input;for(;!gK(e);)tK(e.output)&&(e=e.output);vK(t)?e.disconnect(t,n):gK(t)?e.disconnect(t,n,r):e.disconnect()}var SX=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["gain","units"]))).name="Gain",e._gainNode=e.context.createGain(),e.input=e._gainNode,e.output=e._gainNode;var r=_K(n.getDefaults(),arguments,["gain","units"]);return e.gain=new bX({context:e.context,convert:r.convert,param:e._gainNode.gain,units:r.units,value:r.gain,minValue:r.minValue,maxValue:r.maxValue}),GK(m(e),"gain"),e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._gainNode.disconnect(),this.gain.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{convert:!0,gain:1,units:"gain"})}}]),n}(kX),CX=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).onended=UK,r._startTime=-1,r._stopTime=-1,r._timeout=-1,r.output=new SX({context:r.context,gain:0}),r._gainNode=r.output,r.getStateAtTime=function(e){var t=this.toSeconds(e);return-1!==this._startTime&&t>=this._startTime&&(-1===this._stopTime||t<=this._stopTime)?"started":"stopped"},r._fadeIn=e.fadeIn,r._fadeOut=e.fadeOut,r._curve=e.curve,r.onended=e.onended,r}return c(n,[{key:"_startGain",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;KH(-1===this._startTime,"Source cannot be started more than once");var n=this.toSeconds(this._fadeIn);return this._startTime=e+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,e),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(t,e+n):this._gainNode.gain.exponentialApproachValueAtTime(t,e,n)):this._gainNode.gain.setValueAtTime(t,e),this}},{key:"stop",value:function(e){return this.log("stop",e),this._stopGain(this.toSeconds(e)),this}},{key:"_stopGain",value:function(e){var t=this;KH(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();var n=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(e)+n,this._stopTime=Math.max(this._stopTime,this.context.currentTime),n>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,n,e):this._gainNode.gain.targetRampTo(0,n,e):(this._gainNode.gain.cancelAndHoldAtTime(e),this._gainNode.gain.setValueAtTime(0,e)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout((function(){var e="exponential"===t._curve?2*n:0;t._stopSource(t.now()+e),t._onended()}),this._stopTime-this.context.currentTime),this}},{key:"_onended",value:function(){var e=this;if(this.onended!==UK&&(this.onended(this),this.onended=UK,!this.context.isOffline)){var t=function(){return e.dispose()};"undefined"!==typeof window.requestIdleCallback?window.requestIdleCallback(t):setTimeout(t,1e3)}}},{key:"state",get:function(){return this.getStateAtTime(this.now())}},{key:"cancelStop",value:function(){return this.log("cancelStop"),KH(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._gainNode.disconnect(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:UK})}}]),n}(kX),TX=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["offset"]))).name="ToneConstantSource",e._source=e.context.createConstantSource();var r=_K(n.getDefaults(),arguments,["offset"]);return wX(e._source,e._gainNode),e.offset=new bX({context:e.context,convert:r.convert,param:e._source.offset,units:r.units,value:r.offset,minValue:r.minValue,maxValue:r.maxValue}),e}return c(n,[{key:"start",value:function(e){var t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._source.start(t),this}},{key:"_stopSource",value:function(e){this._source.stop(e)}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(CX.getDefaults(),{convert:!0,offset:1,units:"number"})}}]),n}(CX),EX=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["value","units"]))).name="Signal",e.override=!0;var r=_K(n.getDefaults(),arguments,["value","units"]);return e.output=e._constantSource=new TX({context:e.context,convert:r.convert,offset:r.value,units:r.units,minValue:r.minValue,maxValue:r.maxValue}),e._constantSource.start(0),e.input=e._param=e._constantSource.offset,e}return c(n,[{key:"connect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return IX(this,e,t,n),this}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._param.dispose(),this._constantSource.dispose(),this}},{key:"setValueAtTime",value:function(e,t){return this._param.setValueAtTime(e,t),this}},{key:"getValueAtTime",value:function(e){return this._param.getValueAtTime(e)}},{key:"setRampPoint",value:function(e){return this._param.setRampPoint(e),this}},{key:"linearRampToValueAtTime",value:function(e,t){return this._param.linearRampToValueAtTime(e,t),this}},{key:"exponentialRampToValueAtTime",value:function(e,t){return this._param.exponentialRampToValueAtTime(e,t),this}},{key:"exponentialRampTo",value:function(e,t,n){return this._param.exponentialRampTo(e,t,n),this}},{key:"linearRampTo",value:function(e,t,n){return this._param.linearRampTo(e,t,n),this}},{key:"targetRampTo",value:function(e,t,n){return this._param.targetRampTo(e,t,n),this}},{key:"exponentialApproachValueAtTime",value:function(e,t,n){return this._param.exponentialApproachValueAtTime(e,t,n),this}},{key:"setTargetAtTime",value:function(e,t,n){return this._param.setTargetAtTime(e,t,n),this}},{key:"setValueCurveAtTime",value:function(e,t,n,r){return this._param.setValueCurveAtTime(e,t,n,r),this}},{key:"cancelScheduledValues",value:function(e){return this._param.cancelScheduledValues(e),this}},{key:"cancelAndHoldAtTime",value:function(e){return this._param.cancelAndHoldAtTime(e),this}},{key:"rampTo",value:function(e,t,n){return this._param.rampTo(e,t,n),this}},{key:"value",get:function(){return this._param.value},set:function(e){this._param.value=e}},{key:"convert",get:function(){return this._param.convert},set:function(e){this._param.convert=e}},{key:"units",get:function(){return this._param.units}},{key:"overridden",get:function(){return this._param.overridden},set:function(e){this._param.overridden=e}},{key:"maxValue",get:function(){return this._param.maxValue}},{key:"minValue",get:function(){return this._param.minValue}},{key:"apply",value:function(e){return this._param.apply(e),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{convert:!0,units:"number",value:0})}}]),n}(kX);function IX(e,t,n,r){(t instanceof bX||vK(t)||t instanceof EX&&t.override)&&(t.cancelScheduledValues(0),t.setValueAtTime(0,0),t instanceof EX&&(t.overridden=!0)),wX(e,t,n,r)}var AX=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["value"]))).name="TickParam",e._events=new DK(1/0),e._multiplier=1;var r=_K(n.getDefaults(),arguments,["value"]);return e._multiplier=r.multiplier,e._events.cancel(0),e._events.add({ticks:0,time:0,type:"setValueAtTime",value:e._fromType(r.value)}),e.setValueAtTime(r.value,0),e}return c(n,[{key:"setTargetAtTime",value:function(e,t,n){t=this.toSeconds(t),this.setRampPoint(t);for(var r=this._fromType(e),a=this._events.get(t),i=Math.round(Math.max(1/n,1)),o=0;o<=i;o++){var s=n*o+t,u=this._exponentialApproach(a.time,a.value,r,n,s);this.linearRampToValueAtTime(this._toType(u),s)}return this}},{key:"setValueAtTime",value:function(e,t){var r=this.toSeconds(t);Rw(f(n.prototype),"setValueAtTime",this).call(this,e,t);var a=this._events.get(r),i=this._events.previousEvent(a),o=this._getTicksUntilEvent(i,r);return a.ticks=Math.max(o,0),this}},{key:"linearRampToValueAtTime",value:function(e,t){var r=this.toSeconds(t);Rw(f(n.prototype),"linearRampToValueAtTime",this).call(this,e,t);var a=this._events.get(r),i=this._events.previousEvent(a),o=this._getTicksUntilEvent(i,r);return a.ticks=Math.max(o,0),this}},{key:"exponentialRampToValueAtTime",value:function(e,t){t=this.toSeconds(t);for(var n=this._fromType(e),r=this._events.get(t),a=Math.round(Math.max(10*(t-r.time),1)),i=(t-r.time)/a,o=0;o<=a;o++){var s=i*o+r.time,u=this._exponentialInterpolate(r.time,r.value,t,n,s);this.linearRampToValueAtTime(this._toType(u),s)}return this}},{key:"_getTicksUntilEvent",value:function(e,t){if(null===e)e={ticks:0,time:0,type:"setValueAtTime",value:0};else if(eK(e.ticks)){var n=this._events.previousEvent(e);e.ticks=this._getTicksUntilEvent(n,e.time)}var r=this._fromType(this.getValueAtTime(e.time)),a=this._fromType(this.getValueAtTime(t)),i=this._events.get(t);return i&&i.time===t&&"setValueAtTime"===i.type&&(a=this._fromType(this.getValueAtTime(t-this.sampleTime))),.5*(t-e.time)*(r+a)+e.ticks}},{key:"getTicksAtTime",value:function(e){var t=this.toSeconds(e),n=this._events.get(t);return Math.max(this._getTicksUntilEvent(n,t),0)}},{key:"getDurationOfTicks",value:function(e,t){var n=this.toSeconds(t),r=this.getTicksAtTime(t);return this.getTimeOfTick(r+e)-n}},{key:"getTimeOfTick",value:function(e){var t=this._events.get(e,"ticks"),n=this._events.getAfter(e,"ticks");if(t&&t.ticks===e)return t.time;if(t&&n&&"linearRampToValueAtTime"===n.type&&t.value!==n.value){var r=this._fromType(this.getValueAtTime(t.time)),a=(this._fromType(this.getValueAtTime(n.time))-r)/(n.time-t.time),i=Math.sqrt(Math.pow(r,2)-2*a*(t.ticks-e)),o=(-r+i)/a;return(o>0?o:(-r-i)/a)+t.time}return t?0===t.value?1/0:t.time+(e-t.ticks)/t.value:e/this._initialValue}},{key:"ticksToTime",value:function(e,t){return this.getDurationOfTicks(e,t)}},{key:"timeToTicks",value:function(e,t){var n=this.toSeconds(t),r=this.toSeconds(e),a=this.getTicksAtTime(n);return this.getTicksAtTime(n+r)-a}},{key:"_fromType",value:function(e){return"bpm"===this.units&&this.multiplier?1/(60/e/this.multiplier):Rw(f(n.prototype),"_fromType",this).call(this,e)}},{key:"_toType",value:function(e){return"bpm"===this.units&&this.multiplier?e/this.multiplier*60:Rw(f(n.prototype),"_toType",this).call(this,e)}},{key:"multiplier",get:function(){return this._multiplier},set:function(e){var t=this.value;this._multiplier=e,this.cancelScheduledValues(0),this.setValueAtTime(t,0)}}],[{key:"getDefaults",value:function(){return Object.assign(bX.getDefaults(),{multiplier:1,units:"hertz",value:1})}}]),n}(bX),NX=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["value"]))).name="TickSignal";var r=_K(n.getDefaults(),arguments,["value"]);return e.input=e._param=new AX({context:e.context,convert:r.convert,multiplier:r.multiplier,param:e._constantSource.offset,units:r.units,value:r.value}),e}return c(n,[{key:"ticksToTime",value:function(e,t){return this._param.ticksToTime(e,t)}},{key:"timeToTicks",value:function(e,t){return this._param.timeToTicks(e,t)}},{key:"getTimeOfTick",value:function(e){return this._param.getTimeOfTick(e)}},{key:"getDurationOfTicks",value:function(e,t){return this._param.getDurationOfTicks(e,t)}},{key:"getTicksAtTime",value:function(e){return this._param.getTicksAtTime(e)}},{key:"multiplier",get:function(){return this._param.multiplier},set:function(e){this._param.multiplier=e}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._param.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(EX.getDefaults(),{multiplier:1,units:"hertz",value:1})}}]),n}(EX),PX=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["frequency"]))).name="TickSource",e._state=new yX,e._tickOffset=new DK;var r=_K(n.getDefaults(),arguments,["frequency"]);return e.frequency=new NX({context:e.context,units:r.units,value:r.frequency}),GK(m(e),"frequency"),e._state.setStateAtTime("stopped",0),e.setTicksAtTime(0,0),e}return c(n,[{key:"state",get:function(){return this.getStateAtTime(this.now())}},{key:"start",value:function(e,t){var n=this.toSeconds(e);return"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),tK(t)&&this.setTicksAtTime(t,n)),this}},{key:"stop",value:function(e){var t=this.toSeconds(e);if("stopped"===this._state.getValueAtTime(t)){var n=this._state.get(t);n&&n.time>0&&(this._tickOffset.cancel(n.time),this._state.cancel(n.time))}return this._state.cancel(t),this._state.setStateAtTime("stopped",t),this.setTicksAtTime(0,t),this}},{key:"pause",value:function(e){var t=this.toSeconds(e);return"started"===this._state.getValueAtTime(t)&&this._state.setStateAtTime("paused",t),this}},{key:"cancel",value:function(e){return e=this.toSeconds(e),this._state.cancel(e),this._tickOffset.cancel(e),this}},{key:"getTicksAtTime",value:function(e){var t=this,n=this.toSeconds(e),r=this._state.getLastState("stopped",n),a={state:"paused",time:n};this._state.add(a);var i=r,o=0;return this._state.forEachBetween(r.time,n+this.sampleTime,(function(e){var n=i.time,r=t._tickOffset.get(e.time);r&&r.time>=i.time&&(o=r.ticks,n=r.time),"started"===i.state&&"started"!==e.state&&(o+=t.frequency.getTicksAtTime(e.time)-t.frequency.getTicksAtTime(n)),i=e})),this._state.remove(a),o}},{key:"ticks",get:function(){return this.getTicksAtTime(this.now())},set:function(e){this.setTicksAtTime(e,this.now())}},{key:"seconds",get:function(){return this.getSecondsAtTime(this.now())},set:function(e){var t=this.now(),n=this.frequency.timeToTicks(e,t);this.setTicksAtTime(n,t)}},{key:"getSecondsAtTime",value:function(e){var t=this;e=this.toSeconds(e);var n=this._state.getLastState("stopped",e),r={state:"paused",time:e};this._state.add(r);var a=n,i=0;return this._state.forEachBetween(n.time,e+this.sampleTime,(function(e){var n=a.time,r=t._tickOffset.get(e.time);r&&r.time>=a.time&&(i=r.seconds,n=r.time),"started"===a.state&&"started"!==e.state&&(i+=e.time-n),a=e})),this._state.remove(r),i}},{key:"setTicksAtTime",value:function(e,t){return t=this.toSeconds(t),this._tickOffset.cancel(t),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(e,t),ticks:e,time:t}),this}},{key:"getStateAtTime",value:function(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)}},{key:"getTimeOfTick",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.now(),n=this._tickOffset.get(t),r=this._state.get(t),a=Math.max(n.time,r.time),i=this.frequency.getTicksAtTime(a)+e-n.ticks;return this.frequency.getTimeOfTick(i)}},{key:"forEachTickBetween",value:function(e,t,n){var r=this,a=this._state.get(e);this._state.forEachBetween(e,t,(function(t){a&&"started"===a.state&&"started"!==t.state&&r.forEachTickBetween(Math.max(a.time,e),t.time-r.sampleTime,n),a=t}));var i=null;if(a&&"started"===a.state){var o=Math.max(a.time,e),s=this.frequency.getTicksAtTime(o),u=s-this.frequency.getTicksAtTime(a.time),c=Math.ceil(u)-u;c=PK(c,1)?0:c;for(var l=this.frequency.getTimeOfTick(s+c);l<t;){try{n(l,Math.round(this.getTicksAtTime(l)))}catch(h){i=h;break}l+=this.frequency.getDurationOfTicks(1,l)}}if(i)throw i;return this}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign({frequency:1,units:"hertz"},gX.getDefaults())}}]),n}(gX),MX=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["callback","frequency"]))).name="Clock",e.callback=UK,e._lastUpdate=0,e._state=new yX("stopped"),e._boundLoop=e._loop.bind(m(e));var r=_K(n.getDefaults(),arguments,["callback","frequency"]);return e.callback=r.callback,e._tickSource=new PX({context:e.context,frequency:r.frequency,units:r.units}),e._lastUpdate=0,e.frequency=e._tickSource.frequency,GK(m(e),"frequency"),e._state.setStateAtTime("stopped",0),e.context.on("tick",e._boundLoop),e}return c(n,[{key:"state",get:function(){return this._state.getValueAtTime(this.now())}},{key:"start",value:function(e,t){YH(this.context);var n=this.toSeconds(e);return this.log("start",n),"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,t),n<this._lastUpdate&&this.emit("start",n,t)),this}},{key:"stop",value:function(e){var t=this.toSeconds(e);return this.log("stop",t),this._state.cancel(t),this._state.setStateAtTime("stopped",t),this._tickSource.stop(t),t<this._lastUpdate&&this.emit("stop",t),this}},{key:"pause",value:function(e){var t=this.toSeconds(e);return"started"===this._state.getValueAtTime(t)&&(this._state.setStateAtTime("paused",t),this._tickSource.pause(t),t<this._lastUpdate&&this.emit("pause",t)),this}},{key:"ticks",get:function(){return Math.ceil(this.getTicksAtTime(this.now()))},set:function(e){this._tickSource.ticks=e}},{key:"seconds",get:function(){return this._tickSource.seconds},set:function(e){this._tickSource.seconds=e}},{key:"getSecondsAtTime",value:function(e){return this._tickSource.getSecondsAtTime(e)}},{key:"setTicksAtTime",value:function(e,t){return this._tickSource.setTicksAtTime(e,t),this}},{key:"getTimeOfTick",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.now();return this._tickSource.getTimeOfTick(e,t)}},{key:"getTicksAtTime",value:function(e){return this._tickSource.getTicksAtTime(e)}},{key:"nextTickTime",value:function(e,t){var n=this.toSeconds(t),r=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(r+e,n)}},{key:"_loop",value:function(){var e=this,t=this._lastUpdate,n=this.now();this._lastUpdate=n,this.log("loop",t,n),t!==n&&(this._state.forEachBetween(t,n,(function(t){switch(t.state){case"started":var n=e._tickSource.getTicksAtTime(t.time);e.emit("start",t.time,n);break;case"stopped":0!==t.time&&e.emit("stop",t.time);break;case"paused":e.emit("pause",t.time)}})),this._tickSource.forEachTickBetween(t,n,(function(t,n){e.callback(t,n)})))}},{key:"getStateAtTime",value:function(e){var t=this.toSeconds(e);return this._state.getValueAtTime(t)}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(gX.getDefaults(),{callback:UK,frequency:1,units:"hertz"})}}]),n}(gX);BK.mixin(MX);var DX=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["delayTime","maxDelay"]))).name="Delay";var r=_K(n.getDefaults(),arguments,["delayTime","maxDelay"]),a=e.toSeconds(r.maxDelay);return e._maxDelay=Math.max(a,e.toSeconds(r.delayTime)),e._delayNode=e.input=e.output=e.context.createDelay(a),e.delayTime=new bX({context:e.context,param:e._delayNode.delayTime,units:"time",value:r.delayTime,minValue:0,maxValue:e.maxDelay}),GK(m(e),"delayTime"),e}return c(n,[{key:"maxDelay",get:function(){return this._maxDelay}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._delayNode.disconnect(),this.delayTime.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{delayTime:0,maxDelay:1})}}]),n}(kX);function RX(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:QK().sampleRate;return dK(this,void 0,void 0,x().mark((function a(){var i,o,s,u;return x().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return i=QK(),$K(o=new KK(n,t,r)),a.next=5,e(o);case 5:return s=o.render(),$K(i),a.next=9,s;case 9:return u=a.sent,a.abrupt("return",new HK(u));case 11:case"end":return a.stop()}}),a)})))}var OX=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this)).name="ToneAudioBuffers",e._buffers=new Map,e._loadingCount=0;var r=_K(n.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");return e.baseUrl=r.baseUrl,Object.keys(r.urls).forEach((function(t){e._loadingCount++;var n=r.urls[t];e.add(t,n,e._bufferLoaded.bind(m(e),r.onload),r.onerror)})),e}return c(n,[{key:"has",value:function(e){return this._buffers.has(e.toString())}},{key:"get",value:function(e){return KH(this.has(e),"ToneAudioBuffers has no buffer named: ".concat(e)),this._buffers.get(e.toString())}},{key:"_bufferLoaded",value:function(e){this._loadingCount--,0===this._loadingCount&&e&&e()}},{key:"loaded",get:function(){return Array.from(this._buffers).every((function(e){var t=Ct(e,2);t[0];return t[1].loaded}))}},{key:"add",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:UK,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:UK;return sK(t)?this._buffers.set(e.toString(),new HK(this.baseUrl+t,n,r)):this._buffers.set(e.toString(),new HK(t,n,r)),this}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._buffers.forEach((function(e){return e.dispose()})),this._buffers.clear(),this}}],[{key:"getDefaults",value:function(){return{baseUrl:"",onerror:UK,onload:UK,urls:{}}}}]),n}(TK),FX=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.apply(this,arguments)).name="MidiClass",e.defaultUnits="midi",e}return c(n,[{key:"_frequencyToUnits",value:function(e){return iX(Rw(f(n.prototype),"_frequencyToUnits",this).call(this,e))}},{key:"_ticksToUnits",value:function(e){return iX(Rw(f(n.prototype),"_ticksToUnits",this).call(this,e))}},{key:"_beatsToUnits",value:function(e){return iX(Rw(f(n.prototype),"_beatsToUnits",this).call(this,e))}},{key:"_secondsToUnits",value:function(e){return iX(Rw(f(n.prototype),"_secondsToUnits",this).call(this,e))}},{key:"toMidi",value:function(){return this.valueOf()}},{key:"toFrequency",value:function(){return sX(this.toMidi())}},{key:"transpose",value:function(e){return new n(this.context,this.toMidi()+e)}}]),n}(hX);function LX(e,t){return new FX(QK(),e,t)}var zX=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.apply(this,arguments)).name="Ticks",e.defaultUnits="i",e}return c(n,[{key:"_now",value:function(){return this.context.transport.ticks}},{key:"_beatsToUnits",value:function(e){return this._getPPQ()*e}},{key:"_secondsToUnits",value:function(e){return Math.floor(e/(60/this._getBpm())*this._getPPQ())}},{key:"_ticksToUnits",value:function(e){return e}},{key:"toTicks",value:function(){return this.valueOf()}},{key:"toSeconds",value:function(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}]),n}(mX);function BX(e,t){return new zX(QK(),e,t)}var VX=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.apply(this,arguments)).name="Draw",e.expiration=.25,e.anticipation=.008,e._events=new DK,e._boundDrawLoop=e._drawLoop.bind(m(e)),e._animationFrame=-1,e}return c(n,[{key:"schedule",value:function(e,t){return this._events.add({callback:e,time:this.toSeconds(t)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}},{key:"cancel",value:function(e){return this._events.cancel(this.toSeconds(e)),this}},{key:"_drawLoop",value:function(){for(var e=this.context.currentTime;this._events.length&&this._events.peek().time-this.anticipation<=e;){var t=this._events.shift();t&&e-t.time<=this.expiration&&t.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}]),n}(gX);OK((function(e){e.draw=new VX({context:e})})),LK((function(e){e.draw.dispose()}));var jX=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.apply(this,arguments)).name="IntervalTimeline",e._root=null,e._length=0,e}return c(n,[{key:"add",value:function(e){KH(tK(e.time),"Events must have a time property"),KH(tK(e.duration),"Events must have a duration parameter"),e.time=e.time.valueOf();var t=new qX(e.time,e.time+e.duration,e);for(null===this._root?this._root=t:this._root.insert(t),this._length++;null!==t;)t.updateHeight(),t.updateMax(),this._rebalance(t),t=t.parent;return this}},{key:"remove",value:function(e){if(null!==this._root){var t=[];this._root.search(e.time,t);for(var n=0,r=t;n<r.length;n++){var a=r[n];if(a.event===e){this._removeNode(a),this._length--;break}}}return this}},{key:"length",get:function(){return this._length}},{key:"cancel",value:function(e){var t=this;return this.forEachFrom(e,(function(e){return t.remove(e)})),this}},{key:"_setRoot",value:function(e){this._root=e,null!==this._root&&(this._root.parent=null)}},{key:"_replaceNodeInParent",value:function(e,t){null!==e.parent?(e.isLeftChild()?e.parent.left=t:e.parent.right=t,this._rebalance(e.parent)):this._setRoot(t)}},{key:"_removeNode",value:function(e){if(null===e.left&&null===e.right)this._replaceNodeInParent(e,null);else if(null===e.right)this._replaceNodeInParent(e,e.left);else if(null===e.left)this._replaceNodeInParent(e,e.right);else{var t,n=null;if(e.getBalance()>0)if(null===e.left.right)(t=e.left).right=e.right,n=t;else{for(t=e.left.right;null!==t.right;)t=t.right;t.parent&&(t.parent.right=t.left,n=t.parent,t.left=e.left,t.right=e.right)}else if(null===e.right.left)(t=e.right).left=e.left,n=t;else{for(t=e.right.left;null!==t.left;)t=t.left;t.parent&&(t.parent.left=t.right,n=t.parent,t.left=e.left,t.right=e.right)}null!==e.parent?e.isLeftChild()?e.parent.left=t:e.parent.right=t:this._setRoot(t),n&&this._rebalance(n)}e.dispose()}},{key:"_rotateLeft",value:function(e){var t=e.parent,n=e.isLeftChild(),r=e.right;r&&(e.right=r.left,r.left=e),null!==t?n?t.left=r:t.right=r:this._setRoot(r)}},{key:"_rotateRight",value:function(e){var t=e.parent,n=e.isLeftChild(),r=e.left;r&&(e.left=r.right,r.right=e),null!==t?n?t.left=r:t.right=r:this._setRoot(r)}},{key:"_rebalance",value:function(e){var t=e.getBalance();t>1&&e.left?e.left.getBalance()<0?this._rotateLeft(e.left):this._rotateRight(e):t<-1&&e.right&&(e.right.getBalance()>0?this._rotateRight(e.right):this._rotateLeft(e))}},{key:"get",value:function(e){if(null!==this._root){var t=[];if(this._root.search(e,t),t.length>0){for(var n=t[0],r=1;r<t.length;r++)t[r].low>n.low&&(n=t[r]);return n.event}}return null}},{key:"forEach",value:function(e){if(null!==this._root){var t=[];this._root.traverse((function(e){return t.push(e)})),t.forEach((function(t){t.event&&e(t.event)}))}return this}},{key:"forEachAtTime",value:function(e,t){if(null!==this._root){var n=[];this._root.search(e,n),n.forEach((function(e){e.event&&t(e.event)}))}return this}},{key:"forEachFrom",value:function(e,t){if(null!==this._root){var n=[];this._root.searchAfter(e,n),n.forEach((function(e){e.event&&t(e.event)}))}return this}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),null!==this._root&&this._root.traverse((function(e){return e.dispose()})),this._root=null,this}}]),n}(TK),qX=function(){function e(t,n,r){s(this,e),this._left=null,this._right=null,this.parent=null,this.height=0,this.event=r,this.low=t,this.high=n,this.max=this.high}return c(e,[{key:"insert",value:function(e){e.low<=this.low?null===this.left?this.left=e:this.left.insert(e):null===this.right?this.right=e:this.right.insert(e)}},{key:"search",value:function(e,t){e>this.max||(null!==this.left&&this.left.search(e,t),this.low<=e&&this.high>e&&t.push(this),this.low>e||null!==this.right&&this.right.search(e,t))}},{key:"searchAfter",value:function(e,t){this.low>=e&&(t.push(this),null!==this.left&&this.left.searchAfter(e,t)),null!==this.right&&this.right.searchAfter(e,t)}},{key:"traverse",value:function(e){e(this),null!==this.left&&this.left.traverse(e),null!==this.right&&this.right.traverse(e)}},{key:"updateHeight",value:function(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}},{key:"updateMax",value:function(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}},{key:"getBalance",value:function(){var e=0;return null!==this.left&&null!==this.right?e=this.left.height-this.right.height:null!==this.left?e=this.left.height+1:null!==this.right&&(e=-(this.right.height+1)),e}},{key:"isLeftChild",value:function(){return null!==this.parent&&this.parent.left===this}},{key:"left",get:function(){return this._left},set:function(e){this._left=e,null!==e&&(e.parent=this),this.updateHeight(),this.updateMax()}},{key:"right",get:function(){return this._right},set:function(e){this._right=e,null!==e&&(e.parent=this),this.updateHeight(),this.updateMax()}},{key:"dispose",value:function(){this.parent=null,this._left=null,this._right=null,this.event=null}}]),e}(),GX=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["volume"]))).name="Volume";var r=_K(n.getDefaults(),arguments,["volume"]);return e.input=e.output=new SX({context:e.context,gain:r.volume,units:"decibels"}),e.volume=e.output.gain,GK(m(e),"volume"),e._unmutedVolume=r.volume,e.mute=r.mute,e}return c(n,[{key:"mute",get:function(){return this.volume.value===-1/0},set:function(e){!this.mute&&e?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!e&&(this.volume.value=this._unmutedVolume)}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.input.dispose(),this.volume.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{mute:!1,volume:0})}}]),n}(kX),WX=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments))).name="Destination",e.input=new GX({context:e.context}),e.output=new SX({context:e.context}),e.volume=e.input.volume;var r=_K(n.getDefaults(),arguments);return xX(e.input,e.output,e.context.rawContext.destination),e.mute=r.mute,e._internalChannels=[e.input,e.context.rawContext.destination,e.output],e}return c(n,[{key:"mute",get:function(){return this.input.mute},set:function(e){this.input.mute=e}},{key:"chain",value:function(){this.input.disconnect();for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.unshift(this.input),t.push(this.output),xX.apply(void 0,t),this}},{key:"maxChannelCount",get:function(){return this.context.rawContext.destination.maxChannelCount}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.volume.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{mute:!1,volume:0})}}]),n}(kX);OK((function(e){e.destination=new WX({context:e})})),LK((function(e){e.destination.dispose()}));var UX=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this)).name="TimelineValue",r._timeline=new DK({memory:10}),r._initialValue=e,r}return c(n,[{key:"set",value:function(e,t){return this._timeline.add({value:e,time:t}),this}},{key:"get",value:function(e){var t=this._timeline.get(e);return t?t.value:this._initialValue}}]),n}(TK),HX=function(){function e(t,n){s(this,e),this.id=e._eventId++;var r=Object.assign(e.getDefaults(),n);this.transport=t,this.callback=r.callback,this._once=r.once,this.time=r.time}return c(e,[{key:"invoke",value:function(e){this.callback&&(this.callback(e),this._once&&this.transport.clear(this.id))}},{key:"dispose",value:function(){return this.callback=void 0,this}}],[{key:"getDefaults",value:function(){return{callback:UK,once:!1,time:0}}}]),e}();HX._eventId=0;var KX=function(e){h(n,e);var t=g(n);function n(e,r){var a;s(this,n),(a=t.call(this,e,r))._currentId=-1,a._nextId=-1,a._nextTick=a.time,a._boundRestart=a._restart.bind(m(a));var i=Object.assign(n.getDefaults(),r);return a.duration=new zX(e.context,i.duration).valueOf(),a._interval=new zX(e.context,i.interval).valueOf(),a._nextTick=i.time,a.transport.on("start",a._boundRestart),a.transport.on("loopStart",a._boundRestart),a.context=a.transport.context,a._restart(),a}return c(n,[{key:"invoke",value:function(e){this._createEvents(e),Rw(f(n.prototype),"invoke",this).call(this,e)}},{key:"_createEvents",value:function(e){var t=this.transport.getTicksAtTime(e);t>=this.time&&t>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new zX(this.context,this._nextTick).toSeconds()))}},{key:"_restart",value:function(e){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;var t=this.transport.getTicksAtTime(e);t>this.time&&(this._nextTick=this.time+Math.ceil((t-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new zX(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new zX(this.context,this._nextTick).toSeconds())}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}}],[{key:"getDefaults",value:function(){return Object.assign({},HX.getDefaults(),{duration:1/0,interval:1,once:!1})}}]),n}(HX),XX=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments))).name="Transport",e._loop=new UX(!1),e._loopStart=0,e._loopEnd=0,e._scheduledEvents={},e._timeline=new DK,e._repeatedEvents=new jX,e._syncedSignals=[],e._swingAmount=0;var r=_K(n.getDefaults(),arguments);return e._ppq=r.ppq,e._clock=new MX({callback:e._processTick.bind(m(e)),context:e.context,frequency:0,units:"bpm"}),e._bindClockEvents(),e.bpm=e._clock.frequency,e._clock.frequency.multiplier=r.ppq,e.bpm.setValueAtTime(r.bpm,0),GK(m(e),"bpm"),e._timeSignature=r.timeSignature,e._swingTicks=r.ppq/2,e}return c(n,[{key:"_processTick",value:function(e,t){if(this._loop.get(e)&&t>=this._loopEnd&&(this.emit("loopEnd",e),this._clock.setTicksAtTime(this._loopStart,e),t=this._loopStart,this.emit("loopStart",e,this._clock.getSecondsAtTime(e)),this.emit("loop",e)),this._swingAmount>0&&t%this._ppq!==0&&t%(2*this._swingTicks)!==0){var n=t%(2*this._swingTicks)/(2*this._swingTicks),r=Math.sin(n*Math.PI)*this._swingAmount;e+=new zX(this.context,2*this._swingTicks/3).toSeconds()*r}this._timeline.forEachAtTime(t,(function(t){return t.invoke(e)}))}},{key:"schedule",value:function(e,t){var n=new HX(this,{callback:e,time:new mX(this.context,t).toTicks()});return this._addEvent(n,this._timeline)}},{key:"scheduleRepeat",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,a=new KX(this,{callback:e,duration:new cX(this.context,r).toTicks(),interval:new cX(this.context,t).toTicks(),time:new mX(this.context,n).toTicks()});return this._addEvent(a,this._repeatedEvents)}},{key:"scheduleOnce",value:function(e,t){var n=new HX(this,{callback:e,once:!0,time:new mX(this.context,t).toTicks()});return this._addEvent(n,this._timeline)}},{key:"clear",value:function(e){if(this._scheduledEvents.hasOwnProperty(e)){var t=this._scheduledEvents[e.toString()];t.timeline.remove(t.event),t.event.dispose(),delete this._scheduledEvents[e.toString()]}return this}},{key:"_addEvent",value:function(e,t){return this._scheduledEvents[e.id.toString()]={event:e,timeline:t},t.add(e),e.id}},{key:"cancel",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=this.toTicks(t);return this._timeline.forEachFrom(n,(function(t){return e.clear(t.id)})),this._repeatedEvents.forEachFrom(n,(function(t){return e.clear(t.id)})),this}},{key:"_bindClockEvents",value:function(){var e=this;this._clock.on("start",(function(t,n){n=new zX(e.context,n).toSeconds(),e.emit("start",t,n)})),this._clock.on("stop",(function(t){e.emit("stop",t)})),this._clock.on("pause",(function(t){e.emit("pause",t)}))}},{key:"state",get:function(){return this._clock.getStateAtTime(this.now())}},{key:"start",value:function(e,t){var n;return tK(t)&&(n=this.toTicks(t)),this._clock.start(e,n),this}},{key:"stop",value:function(e){return this._clock.stop(e),this}},{key:"pause",value:function(e){return this._clock.pause(e),this}},{key:"toggle",value:function(e){return e=this.toSeconds(e),"started"!==this._clock.getStateAtTime(e)?this.start(e):this.stop(e),this}},{key:"timeSignature",get:function(){return this._timeSignature},set:function(e){oK(e)&&(e=e[0]/e[1]*4),this._timeSignature=e}},{key:"loopStart",get:function(){return new cX(this.context,this._loopStart,"i").toSeconds()},set:function(e){this._loopStart=this.toTicks(e)}},{key:"loopEnd",get:function(){return new cX(this.context,this._loopEnd,"i").toSeconds()},set:function(e){this._loopEnd=this.toTicks(e)}},{key:"loop",get:function(){return this._loop.get(this.now())},set:function(e){this._loop.set(e,this.now())}},{key:"setLoopPoints",value:function(e,t){return this.loopStart=e,this.loopEnd=t,this}},{key:"swing",get:function(){return this._swingAmount},set:function(e){this._swingAmount=e}},{key:"swingSubdivision",get:function(){return new zX(this.context,this._swingTicks).toNotation()},set:function(e){this._swingTicks=this.toTicks(e)}},{key:"position",get:function(){var e=this.now(),t=this._clock.getTicksAtTime(e);return new zX(this.context,t).toBarsBeatsSixteenths()},set:function(e){var t=this.toTicks(e);this.ticks=t}},{key:"seconds",get:function(){return this._clock.seconds},set:function(e){var t=this.now(),n=this._clock.frequency.timeToTicks(e,t);this.ticks=n}},{key:"progress",get:function(){if(this.loop){var e=this.now();return(this._clock.getTicksAtTime(e)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}},{key:"ticks",get:function(){return this._clock.ticks},set:function(e){if(this._clock.ticks!==e){var t=this.now();if("started"===this.state){var n=this._clock.getTicksAtTime(t),r=t+this._clock.frequency.getDurationOfTicks(Math.ceil(n)-n,t);this.emit("stop",r),this._clock.setTicksAtTime(e,r),this.emit("start",r,this._clock.getSecondsAtTime(r))}else this._clock.setTicksAtTime(e,t)}}},{key:"getTicksAtTime",value:function(e){return Math.round(this._clock.getTicksAtTime(e))}},{key:"getSecondsAtTime",value:function(e){return this._clock.getSecondsAtTime(e)}},{key:"PPQ",get:function(){return this._clock.frequency.multiplier},set:function(e){this._clock.frequency.multiplier=e}},{key:"nextSubdivision",value:function(e){if(e=this.toTicks(e),"started"!==this.state)return 0;var t=this.now(),n=e-this.getTicksAtTime(t)%e;return this._clock.nextTickTime(n,t)}},{key:"syncSignal",value:function(e,t){if(!t){var n=this.now();if(0!==e.getValueAtTime(n)){var r=1/(60/this.bpm.getValueAtTime(n)/this.PPQ);t=e.getValueAtTime(n)/r}else t=0}var a=new SX(t);return this.bpm.connect(a),a.connect(e._param),this._syncedSignals.push({initial:e.value,ratio:a,signal:e}),e.value=0,this}},{key:"unsyncSignal",value:function(e){for(var t=this._syncedSignals.length-1;t>=0;t--){var n=this._syncedSignals[t];n.signal===e&&(n.ratio.dispose(),n.signal.value=n.initial,this._syncedSignals.splice(t,1))}return this}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._clock.dispose(),WK(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(gX.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}}]),n}(gX);BK.mixin(XX),OK((function(e){e.transport=new XX({context:e})})),LK((function(e){e.transport.dispose()}));var YX=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).input=void 0,r._state=new yX("stopped"),r._synced=!1,r._scheduled=[],r._syncedStart=UK,r._syncedStop=UK,r._state.memory=100,r._state.increasing=!0,r._volume=r.output=new GX({context:r.context,mute:e.mute,volume:e.volume}),r.volume=r._volume.volume,GK(m(r),"volume"),r.onstop=e.onstop,r}return c(n,[{key:"state",get:function(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}},{key:"mute",get:function(){return this._volume.mute},set:function(e){this._volume.mute=e}},{key:"_clampToCurrentTime",value:function(e){return this._synced?e:Math.max(e,this.context.currentTime)}},{key:"start",value:function(e,t,n){var r=this,a=eK(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(a=this._clampToCurrentTime(a),this._synced||"started"!==this._state.getValueAtTime(a))if(this.log("start",a),this._state.setStateAtTime("started",a),this._synced){var i=this._state.get(a);i&&(i.offset=this.toSeconds(SK(t,0)),i.duration=n?this.toSeconds(n):void 0);var o=this.context.transport.schedule((function(e){r._start(e,t,n)}),a);this._scheduled.push(o),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>a&&this._syncedStart(this.now(),this.context.transport.seconds)}else YH(this.context),this._start(a,t,n);else KH(IK(a,this._state.get(a).time),"Start time must be strictly greater than previous start time"),this._state.cancel(a),this._state.setStateAtTime("started",a),this.log("restart",a),this.restart(a,t,n);return this}},{key:"stop",value:function(e){var t=eK(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(t=this._clampToCurrentTime(t),"started"===this._state.getValueAtTime(t)||tK(this._state.getNextState("started",t))){if(this.log("stop",t),this._synced){var n=this.context.transport.schedule(this._stop.bind(this),t);this._scheduled.push(n)}else this._stop(t);this._state.cancel(t),this._state.setStateAtTime("stopped",t)}return this}},{key:"restart",value:function(e,t,n){return e=this.toSeconds(e),"started"===this._state.getValueAtTime(e)&&(this._state.cancel(e),this._restart(e,t,n)),this}},{key:"sync",value:function(){var e=this;return this._synced||(this._synced=!0,this._syncedStart=function(t,n){if(n>0){var r=e._state.get(n);if(r&&"started"===r.state&&r.time!==n){var a,i=n-e.toSeconds(r.time);r.duration&&(a=e.toSeconds(r.duration)-i),e._start(t,e.toSeconds(r.offset)+i,a)}}},this._syncedStop=function(t){var n=e.context.transport.getSecondsAtTime(Math.max(t-e.sampleTime,0));"started"===e._state.getValueAtTime(n)&&e._stop(t)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}},{key:"unsync",value:function(){var e=this;return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach((function(t){return e.context.transport.clear(t)})),this._scheduled=[],this._state.cancel(0),this._stop(0),this}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.onstop=UK,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{mute:!1,onstop:UK,volume:0})}}]),n}(kX),QX=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["url","onload"]))).name="ToneBufferSource",e._source=e.context.createBufferSource(),e._internalChannels=[e._source],e._sourceStarted=!1,e._sourceStopped=!1;var r=_K(n.getDefaults(),arguments,["url","onload"]);return wX(e._source,e._gainNode),e._source.onended=function(){return e._stopSource()},e.playbackRate=new bX({context:e.context,param:e._source.playbackRate,units:"positive",value:r.playbackRate}),e.loop=r.loop,e.loopStart=r.loopStart,e.loopEnd=r.loopEnd,e._buffer=new HK(r.url,r.onload,r.onerror),e._internalChannels.push(e._source),e}return c(n,[{key:"fadeIn",get:function(){return this._fadeIn},set:function(e){this._fadeIn=e}},{key:"fadeOut",get:function(){return this._fadeOut},set:function(e){this._fadeOut=e}},{key:"curve",get:function(){return this._curve},set:function(e){this._curve=e}},{key:"start",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;KH(this.buffer.loaded,"buffer is either not set or not loaded");var a=this.toSeconds(e);this._startGain(a,r),t=this.loop?SK(t,this.loopStart):SK(t,0);var i=Math.max(this.toSeconds(t),0);if(this.loop){var o=this.toSeconds(this.loopEnd)||this.buffer.duration,s=this.toSeconds(this.loopStart),u=o-s;AK(i,o)&&(i=(i-s)%u+s),PK(i,this.buffer.duration)&&(i=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,NK(i,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(a,i)),tK(n)){var c=this.toSeconds(n);c=Math.max(c,0),this.stop(a+c)}return this}},{key:"_stopSource",value:function(e){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(e)),this._onended())}},{key:"loopStart",get:function(){return this._source.loopStart},set:function(e){this._source.loopStart=this.toSeconds(e)}},{key:"loopEnd",get:function(){return this._source.loopEnd},set:function(e){this._source.loopEnd=this.toSeconds(e)}},{key:"buffer",get:function(){return this._buffer},set:function(e){this._buffer.set(e)}},{key:"loop",get:function(){return this._source.loop},set:function(e){this._source.loop=e,this._sourceStarted&&this.cancelStop()}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(CX.getDefaults(),{url:new HK,loop:!1,loopEnd:0,loopStart:0,onload:UK,onerror:UK,playbackRate:1})}}]),n}(CX),$X=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["type"]))).name="Noise",e._source=null;var r=_K(n.getDefaults(),arguments,["type"]);return e._playbackRate=r.playbackRate,e.type=r.type,e._fadeIn=r.fadeIn,e._fadeOut=r.fadeOut,e}return c(n,[{key:"type",get:function(){return this._type},set:function(e){if(KH(e in eY,"Noise: invalid type: "+e),this._type!==e&&(this._type=e,"started"===this.state)){var t=this.now();this._stop(t),this._start(t)}}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(e){this._playbackRate=e,this._source&&(this._source.playbackRate.value=e)}},{key:"_start",value:function(e){var t=this,n=eY[this._type];this._source=new QX({url:n,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:function(){return t.onstop(t)},playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(e),Math.random()*(n.duration-.001))}},{key:"_stop",value:function(e){this._source&&(this._source.stop(this.toSeconds(e)),this._source=null)}},{key:"fadeIn",get:function(){return this._fadeIn},set:function(e){this._fadeIn=e,this._source&&(this._source.fadeIn=this._fadeIn)}},{key:"fadeOut",get:function(){return this._fadeOut},set:function(e){this._fadeOut=e,this._source&&(this._source.fadeOut=this._fadeOut)}},{key:"_restart",value:function(e){this._stop(e),this._start(e)}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._source&&this._source.disconnect(),this}}],[{key:"getDefaults",value:function(){return Object.assign(YX.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}}]),n}(YX),JX=220500,ZX={brown:null,pink:null,white:null},eY={get brown(){if(!ZX.brown){for(var e=[],t=0;t<2;t++){var n=new Float32Array(JX);e[t]=n;for(var r=0,a=0;a<JX;a++){var i=2*Math.random()-1;n[a]=(r+.02*i)/1.02,r=n[a],n[a]*=3.5}}ZX.brown=(new HK).fromArray(e)}return ZX.brown},get pink(){if(!ZX.pink){for(var e=[],t=0;t<2;t++){var n=new Float32Array(JX);e[t]=n;var r=void 0,a=void 0,i=void 0,o=void 0,s=void 0,u=void 0,c=void 0;r=a=i=o=s=u=c=0;for(var l=0;l<JX;l++){var h=2*Math.random()-1;r=.99886*r+.0555179*h,a=.99332*a+.0750759*h,i=.969*i+.153852*h,o=.8665*o+.3104856*h,s=.55*s+.5329522*h,u=-.7616*u-.016898*h,n[l]=r+a+i+o+s+u+c+.5362*h,n[l]*=.11,c=.115926*h}}ZX.pink=(new HK).fromArray(e)}return ZX.pink},get white(){if(!ZX.white){for(var e=[],t=0;t<2;t++){var n=new Float32Array(JX);e[t]=n;for(var r=0;r<JX;r++)n[r]=2*Math.random()-1}ZX.white=(new HK).fromArray(e)}return ZX.white}},tY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["volume"]))).name="UserMedia";var r=_K(n.getDefaults(),arguments,["volume"]);return e._volume=e.output=new GX({context:e.context,volume:r.volume}),e.volume=e._volume.volume,GK(m(e),"volume"),e.mute=r.mute,e}return c(n,[{key:"open",value:function(e){return dK(this,void 0,void 0,x().mark((function t(){var r,a,i,o;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return KH(n.supported,"UserMedia is not supported"),"started"===this.state&&this.close(),t.next=4,n.enumerateDevices();case 4:return r=t.sent,rK(e)?this._device=r[e]:(this._device=r.find((function(t){return t.label===e||t.deviceId===e})),!this._device&&r.length>0&&(this._device=r[0]),KH(tK(this._device),"No matching device ".concat(e))),a={audio:{echoCancellation:!1,sampleRate:this.context.sampleRate,noiseSuppression:!1,mozNoiseSuppression:!1}},this._device&&(a.audio.deviceId=this._device.deviceId),t.next=10,navigator.mediaDevices.getUserMedia(a);case 10:return i=t.sent,this._stream||(this._stream=i,wX(o=this.context.createMediaStreamSource(i),this.output),this._mediaStream=o),t.abrupt("return",this);case 13:case"end":return t.stop()}}),t,this)})))}},{key:"close",value:function(){return this._stream&&this._mediaStream&&(this._stream.getAudioTracks().forEach((function(e){e.stop()})),this._stream=void 0,this._mediaStream.disconnect(),this._mediaStream=void 0),this._device=void 0,this}},{key:"state",get:function(){return this._stream&&this._stream.active?"started":"stopped"}},{key:"deviceId",get:function(){return this._device?this._device.deviceId:void 0}},{key:"groupId",get:function(){return this._device?this._device.groupId:void 0}},{key:"label",get:function(){return this._device?this._device.label:void 0}},{key:"mute",get:function(){return this._volume.mute},set:function(e){this._volume.mute=e}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.close(),this._volume.dispose(),this.volume.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{mute:!1,volume:0})}},{key:"enumerateDevices",value:function(){return dK(this,void 0,void 0,x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.enumerateDevices();case 2:return t=e.sent,e.abrupt("return",t.filter((function(e){return"audioinput"===e.kind})));case 4:case"end":return e.stop()}}),e)})))}},{key:"supported",get:function(){return tK(navigator.mediaDevices)&&tK(navigator.mediaDevices.getUserMedia)}}]),n}(kX);function nY(e,t){return dK(this,void 0,void 0,x().mark((function n(){var r,a,i;return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t/e.context.sampleRate,a=new KK(1,r,e.context.sampleRate),new e.constructor(Object.assign(e.get(),{frequency:2/r,detune:0,context:a})).toDestination().start(0),n.next=6,a.render();case 6:return i=n.sent,n.abrupt("return",i.getChannelData(0));case 8:case"end":return n.stop()}}),n)})))}var rY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["frequency","type"]))).name="ToneOscillatorNode",e._oscillator=e.context.createOscillator(),e._internalChannels=[e._oscillator];var r=_K(n.getDefaults(),arguments,["frequency","type"]);return wX(e._oscillator,e._gainNode),e.type=r.type,e.frequency=new bX({context:e.context,param:e._oscillator.frequency,units:"frequency",value:r.frequency}),e.detune=new bX({context:e.context,param:e._oscillator.detune,units:"cents",value:r.detune}),GK(m(e),["frequency","detune"]),e}return c(n,[{key:"start",value:function(e){var t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._oscillator.start(t),this}},{key:"_stopSource",value:function(e){this._oscillator.stop(e)}},{key:"setPeriodicWave",value:function(e){return this._oscillator.setPeriodicWave(e),this}},{key:"type",get:function(){return this._oscillator.type},set:function(e){this._oscillator.type=e}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(CX.getDefaults(),{detune:0,frequency:440,type:"sine"})}}]),n}(CX),aY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["frequency","type"]))).name="Oscillator",e._oscillator=null;var r=_K(n.getDefaults(),arguments,["frequency","type"]);return e.frequency=new EX({context:e.context,units:"frequency",value:r.frequency}),GK(m(e),"frequency"),e.detune=new EX({context:e.context,units:"cents",value:r.detune}),GK(m(e),"detune"),e._partials=r.partials,e._partialCount=r.partialCount,e._type=r.type,r.partialCount&&"custom"!==r.type&&(e._type=e.baseType+r.partialCount.toString()),e.phase=r.phase,e}return c(n,[{key:"_start",value:function(e){var t=this,n=this.toSeconds(e),r=new rY({context:this.context,onended:function(){return t.onstop(t)}});this._oscillator=r,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(n)}},{key:"_stop",value:function(e){var t=this.toSeconds(e);this._oscillator&&this._oscillator.stop(t)}},{key:"_restart",value:function(e){var t=this.toSeconds(e);return this.log("restart",t),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(t),this}},{key:"syncFrequency",value:function(){return this.context.transport.syncSignal(this.frequency),this}},{key:"unsyncFrequency",value:function(){return this.context.transport.unsyncSignal(this.frequency),this}},{key:"_getCachedPeriodicWave",value:function(){var e=this;if("custom"===this._type)return n._periodicWaveCache.find((function(t){return t.phase===e._phase&&(n=t.partials,r=e._partials,n.length===r.length&&n.every((function(e,t){return r[t]===e})));var n,r}));var t=n._periodicWaveCache.find((function(t){return t.type===e._type&&t.phase===e._phase}));return this._partialCount=t?t.partialCount:this._partialCount,t}},{key:"type",get:function(){return this._type},set:function(e){this._type=e;var t=-1!==["sine","square","sawtooth","triangle"].indexOf(e);if(0===this._phase&&t)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=e);else{var r=this._getCachedPeriodicWave();if(tK(r)){var a=r.partials,i=r.wave;this._wave=i,this._partials=a,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{var o=Ct(this._getRealImaginary(e,this._phase),2),s=o[0],u=o[1],c=this.context.createPeriodicWave(s,u);this._wave=c,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),n._periodicWaveCache.push({imag:u,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:s,type:this._type,wave:this._wave}),n._periodicWaveCache.length>100&&n._periodicWaveCache.shift()}}}},{key:"baseType",get:function(){return this._type.replace(this.partialCount.toString(),"")},set:function(e){this.partialCount&&"custom"!==this._type&&"custom"!==e?this.type=e+this.partialCount:this.type=e}},{key:"partialCount",get:function(){return this._partialCount},set:function(e){XH(e,0);var t=this._type,n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(n&&(t=n[1]),"custom"!==this._type)this.type=0===e?t:t+e.toString();else{var r=new Float32Array(e);this._partials.forEach((function(e,t){return r[t]=e})),this._partials=Array.from(r),this.type=this._type}}},{key:"_getRealImaginary",value:function(e,t){var n=2048,r=new Float32Array(n),a=new Float32Array(n),i=1;if("custom"===e){if(i=this._partials.length+1,this._partialCount=this._partials.length,n=i,0===this._partials.length)return[r,a]}else{var o=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(e);o?(i=parseInt(o[2],10)+1,this._partialCount=parseInt(o[2],10),e=o[1],n=i=Math.max(i,2)):this._partialCount=0,this._partials=[]}for(var s=1;s<n;++s){var u=2/(s*Math.PI),c=void 0;switch(e){case"sine":c=s<=i?1:0,this._partials[s-1]=c;break;case"square":c=1&s?2*u:0,this._partials[s-1]=c;break;case"sawtooth":c=u*(1&s?1:-1),this._partials[s-1]=c;break;case"triangle":c=1&s?u*u*2*(s-1>>1&1?-1:1):0,this._partials[s-1]=c;break;case"custom":c=this._partials[s-1];break;default:throw new TypeError("Oscillator: invalid type: "+e)}0!==c?(r[s]=-c*Math.sin(t*s),a[s]=c*Math.cos(t*s)):(r[s]=0,a[s]=0)}return[r,a]}},{key:"_inverseFFT",value:function(e,t,n){for(var r=0,a=e.length,i=0;i<a;i++)r+=e[i]*Math.cos(i*n)+t[i]*Math.sin(i*n);return r}},{key:"getInitialValue",value:function(){for(var e=Ct(this._getRealImaginary(this._type,0),2),t=e[0],n=e[1],r=0,a=2*Math.PI,i=0;i<32;i++)r=Math.max(this._inverseFFT(t,n,i/32*a),r);return MK(-this._inverseFFT(t,n,this._phase)/r,-1,1)}},{key:"partials",get:function(){return this._partials.slice(0,this.partialCount)},set:function(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this.type="custom")}},{key:"phase",get:function(){return this._phase*(180/Math.PI)},set:function(e){this._phase=e*Math.PI/180,this.type=this._type}},{key:"asArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return dK(this,void 0,void 0,x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",nY(this,e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(YX.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}}]),n}(YX);aY._periodicWaveCache=[];var iY=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.call(this,Object.assign(_K(n.getDefaults(),arguments,["context"])))}return c(n,[{key:"connect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return IX(this,e,t,n),this}}]),n}(kX),oY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,Object.assign(_K(n.getDefaults(),arguments,["mapping","length"])))).name="WaveShaper",e._shaper=e.context.createWaveShaper(),e.input=e._shaper,e.output=e._shaper;var r=_K(n.getDefaults(),arguments,["mapping","length"]);return oK(r.mapping)||r.mapping instanceof Float32Array?e.curve=Float32Array.from(r.mapping):nK(r.mapping)&&e.setMap(r.mapping,r.length),e}return c(n,[{key:"setMap",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,n=new Float32Array(t),r=0,a=t;r<a;r++){var i=r/(a-1)*2-1;n[r]=e(i,r)}return this.curve=n,this}},{key:"curve",get:function(){return this._shaper.curve},set:function(e){this._shaper.curve=e}},{key:"oversample",get:function(){return this._shaper.oversample},set:function(e){KH(["none","2x","4x"].some((function(t){return t.includes(e)})),"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=e}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._shaper.disconnect(),this}}],[{key:"getDefaults",value:function(){return Object.assign(EX.getDefaults(),{length:1024})}}]),n}(iY),sY=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.apply(this,arguments)).name="AudioToGain",e._norm=new oY({context:e.context,mapping:function(e){return(e+1)/2}}),e.input=e._norm,e.output=e._norm,e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._norm.dispose(),this}}]),n}(iY),uY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,Object.assign(_K(n.getDefaults(),arguments,["value"])))).name="Multiply",e.override=!1;var r=_K(n.getDefaults(),arguments,["value"]);return e._mult=e.input=e.output=new SX({context:e.context,minValue:r.minValue,maxValue:r.maxValue}),e.factor=e._param=e._mult.gain,e.factor.setValueAtTime(r.value,0),e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._mult.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(EX.getDefaults(),{value:0})}}]),n}(EX),cY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["frequency","type","modulationType"]))).name="AMOscillator",e._modulationScale=new sY({context:e.context}),e._modulationNode=new SX({context:e.context});var r=_K(n.getDefaults(),arguments,["frequency","type","modulationType"]);return e._carrier=new aY({context:e.context,detune:r.detune,frequency:r.frequency,onstop:function(){return e.onstop(m(e))},phase:r.phase,type:r.type}),e.frequency=e._carrier.frequency,e.detune=e._carrier.detune,e._modulator=new aY({context:e.context,phase:r.phase,type:r.modulationType}),e.harmonicity=new uY({context:e.context,units:"positive",value:r.harmonicity}),e.frequency.chain(e.harmonicity,e._modulator.frequency),e._modulator.chain(e._modulationScale,e._modulationNode.gain),e._carrier.chain(e._modulationNode,e.output),GK(m(e),["frequency","detune","harmonicity"]),e}return c(n,[{key:"_start",value:function(e){this._modulator.start(e),this._carrier.start(e)}},{key:"_stop",value:function(e){this._modulator.stop(e),this._carrier.stop(e)}},{key:"_restart",value:function(e){this._modulator.restart(e),this._carrier.restart(e)}},{key:"type",get:function(){return this._carrier.type},set:function(e){this._carrier.type=e}},{key:"baseType",get:function(){return this._carrier.baseType},set:function(e){this._carrier.baseType=e}},{key:"partialCount",get:function(){return this._carrier.partialCount},set:function(e){this._carrier.partialCount=e}},{key:"modulationType",get:function(){return this._modulator.type},set:function(e){this._modulator.type=e}},{key:"phase",get:function(){return this._carrier.phase},set:function(e){this._carrier.phase=e,this._modulator.phase=e}},{key:"partials",get:function(){return this._carrier.partials},set:function(e){this._carrier.partials=e}},{key:"asArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return dK(this,void 0,void 0,x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",nY(this,e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(aY.getDefaults(),{harmonicity:1,modulationType:"square"})}}]),n}(YX),lY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["frequency","type","modulationType"]))).name="FMOscillator",e._modulationNode=new SX({context:e.context,gain:0});var r=_K(n.getDefaults(),arguments,["frequency","type","modulationType"]);return e._carrier=new aY({context:e.context,detune:r.detune,frequency:0,onstop:function(){return e.onstop(m(e))},phase:r.phase,type:r.type}),e.detune=e._carrier.detune,e.frequency=new EX({context:e.context,units:"frequency",value:r.frequency}),e._modulator=new aY({context:e.context,phase:r.phase,type:r.modulationType}),e.harmonicity=new uY({context:e.context,units:"positive",value:r.harmonicity}),e.modulationIndex=new uY({context:e.context,units:"positive",value:r.modulationIndex}),e.frequency.connect(e._carrier.frequency),e.frequency.chain(e.harmonicity,e._modulator.frequency),e.frequency.chain(e.modulationIndex,e._modulationNode),e._modulator.connect(e._modulationNode.gain),e._modulationNode.connect(e._carrier.frequency),e._carrier.connect(e.output),e.detune.connect(e._modulator.detune),GK(m(e),["modulationIndex","frequency","detune","harmonicity"]),e}return c(n,[{key:"_start",value:function(e){this._modulator.start(e),this._carrier.start(e)}},{key:"_stop",value:function(e){this._modulator.stop(e),this._carrier.stop(e)}},{key:"_restart",value:function(e){return this._modulator.restart(e),this._carrier.restart(e),this}},{key:"type",get:function(){return this._carrier.type},set:function(e){this._carrier.type=e}},{key:"baseType",get:function(){return this._carrier.baseType},set:function(e){this._carrier.baseType=e}},{key:"partialCount",get:function(){return this._carrier.partialCount},set:function(e){this._carrier.partialCount=e}},{key:"modulationType",get:function(){return this._modulator.type},set:function(e){this._modulator.type=e}},{key:"phase",get:function(){return this._carrier.phase},set:function(e){this._carrier.phase=e,this._modulator.phase=e}},{key:"partials",get:function(){return this._carrier.partials},set:function(e){this._carrier.partials=e}},{key:"asArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return dK(this,void 0,void 0,x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",nY(this,e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(aY.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}}]),n}(YX),hY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["frequency","width"]))).name="PulseOscillator",e._widthGate=new SX({context:e.context,gain:0}),e._thresh=new oY({context:e.context,mapping:function(e){return e<=0?-1:1}});var r=_K(n.getDefaults(),arguments,["frequency","width"]);return e.width=new EX({context:e.context,units:"audioRange",value:r.width}),e._triangle=new aY({context:e.context,detune:r.detune,frequency:r.frequency,onstop:function(){return e.onstop(m(e))},phase:r.phase,type:"triangle"}),e.frequency=e._triangle.frequency,e.detune=e._triangle.detune,e._triangle.chain(e._thresh,e.output),e.width.chain(e._widthGate,e._thresh),GK(m(e),["width","frequency","detune"]),e}return c(n,[{key:"_start",value:function(e){e=this.toSeconds(e),this._triangle.start(e),this._widthGate.gain.setValueAtTime(1,e)}},{key:"_stop",value:function(e){e=this.toSeconds(e),this._triangle.stop(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(0,e)}},{key:"_restart",value:function(e){this._triangle.restart(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(1,e)}},{key:"phase",get:function(){return this._triangle.phase},set:function(e){this._triangle.phase=e}},{key:"type",get:function(){return"pulse"}},{key:"baseType",get:function(){return"pulse"}},{key:"partials",get:function(){return[]}},{key:"partialCount",get:function(){return 0}},{key:"carrierType",set:function(e){this._triangle.type=e}},{key:"asArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return dK(this,void 0,void 0,x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",nY(this,e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(YX.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}}]),n}(YX),fY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["frequency","type","spread"]))).name="FatOscillator",e._oscillators=[];var r=_K(n.getDefaults(),arguments,["frequency","type","spread"]);return e.frequency=new EX({context:e.context,units:"frequency",value:r.frequency}),e.detune=new EX({context:e.context,units:"cents",value:r.detune}),e._spread=r.spread,e._type=r.type,e._phase=r.phase,e._partials=r.partials,e._partialCount=r.partialCount,e.count=r.count,GK(m(e),["frequency","detune"]),e}return c(n,[{key:"_start",value:function(e){e=this.toSeconds(e),this._forEach((function(t){return t.start(e)}))}},{key:"_stop",value:function(e){e=this.toSeconds(e),this._forEach((function(t){return t.stop(e)}))}},{key:"_restart",value:function(e){this._forEach((function(t){return t.restart(e)}))}},{key:"_forEach",value:function(e){for(var t=0;t<this._oscillators.length;t++)e(this._oscillators[t],t)}},{key:"type",get:function(){return this._type},set:function(e){this._type=e,this._forEach((function(t){return t.type=e}))}},{key:"spread",get:function(){return this._spread},set:function(e){if(this._spread=e,this._oscillators.length>1){var t=-e/2,n=e/(this._oscillators.length-1);this._forEach((function(e,r){return e.detune.value=t+n*r}))}}},{key:"count",get:function(){return this._oscillators.length},set:function(e){var t=this;if(XH(e,1),this._oscillators.length!==e){this._forEach((function(e){return e.dispose()})),this._oscillators=[];for(var n=0;n<e;n++){var r=new aY({context:this.context,volume:-6-1.1*e,type:this._type,phase:this._phase+n/e*360,partialCount:this._partialCount,onstop:0===n?function(){return t.onstop(t)}:UK});"custom"===this.type&&(r.partials=this._partials),this.frequency.connect(r.frequency),this.detune.connect(r.detune),r.detune.overridden=!1,r.connect(this.output),this._oscillators[n]=r}this.spread=this._spread,"started"===this.state&&this._forEach((function(e){return e.start()}))}}},{key:"phase",get:function(){return this._phase},set:function(e){var t=this;this._phase=e,this._forEach((function(e,n){return e.phase=t._phase+n/t.count*360}))}},{key:"baseType",get:function(){return this._oscillators[0].baseType},set:function(e){this._forEach((function(t){return t.baseType=e})),this._type=this._oscillators[0].type}},{key:"partials",get:function(){return this._oscillators[0].partials},set:function(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this._type="custom",this._forEach((function(t){return t.partials=e})))}},{key:"partialCount",get:function(){return this._oscillators[0].partialCount},set:function(e){this._partialCount=e,this._forEach((function(t){return t.partialCount=e})),this._type=this._oscillators[0].type}},{key:"asArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return dK(this,void 0,void 0,x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",nY(this,e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.frequency.dispose(),this.detune.dispose(),this._forEach((function(e){return e.dispose()})),this}}],[{key:"getDefaults",value:function(){return Object.assign(aY.getDefaults(),{count:3,spread:20,type:"sawtooth"})}}]),n}(YX),pY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["frequency","modulationFrequency"]))).name="PWMOscillator",e.sourceType="pwm",e._scale=new uY({context:e.context,value:2});var r=_K(n.getDefaults(),arguments,["frequency","modulationFrequency"]);return e._pulse=new hY({context:e.context,frequency:r.modulationFrequency}),e._pulse.carrierType="sine",e.modulationFrequency=e._pulse.frequency,e._modulator=new aY({context:e.context,detune:r.detune,frequency:r.frequency,onstop:function(){return e.onstop(m(e))},phase:r.phase}),e.frequency=e._modulator.frequency,e.detune=e._modulator.detune,e._modulator.chain(e._scale,e._pulse.width),e._pulse.connect(e.output),GK(m(e),["modulationFrequency","frequency","detune"]),e}return c(n,[{key:"_start",value:function(e){e=this.toSeconds(e),this._modulator.start(e),this._pulse.start(e)}},{key:"_stop",value:function(e){e=this.toSeconds(e),this._modulator.stop(e),this._pulse.stop(e)}},{key:"_restart",value:function(e){this._modulator.restart(e),this._pulse.restart(e)}},{key:"type",get:function(){return"pwm"}},{key:"baseType",get:function(){return"pwm"}},{key:"partials",get:function(){return[]}},{key:"partialCount",get:function(){return 0}},{key:"phase",get:function(){return this._modulator.phase},set:function(e){this._modulator.phase=e}},{key:"asArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return dK(this,void 0,void 0,x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",nY(this,e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(YX.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}}]),n}(YX),dY={am:cY,fat:fY,fm:lY,oscillator:aY,pulse:hY,pwm:pY},mY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["frequency","type"]))).name="OmniOscillator";var r=_K(n.getDefaults(),arguments,["frequency","type"]);return e.frequency=new EX({context:e.context,units:"frequency",value:r.frequency}),e.detune=new EX({context:e.context,units:"cents",value:r.detune}),GK(m(e),["frequency","detune"]),e.set(r),e}return c(n,[{key:"_start",value:function(e){this._oscillator.start(e)}},{key:"_stop",value:function(e){this._oscillator.stop(e)}},{key:"_restart",value:function(e){return this._oscillator.restart(e),this}},{key:"type",get:function(){var e=this,t="";return["am","fm","fat"].some((function(t){return e._sourceType===t}))&&(t=this._sourceType),t+this._oscillator.type},set:function(e){"fm"===e.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):"am"===e.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):"fat"===e.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(3)):"pwm"===e?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===e?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=e)}},{key:"partials",get:function(){return this._oscillator.partials},set:function(e){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=e)}},{key:"partialCount",get:function(){return this._oscillator.partialCount},set:function(e){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=e)}},{key:"set",value:function(e){return Reflect.has(e,"type")&&e.type&&(this.type=e.type),Rw(f(n.prototype),"set",this).call(this,e),this}},{key:"_createNewOscillator",value:function(e){var t=this;if(e!==this._sourceType){this._sourceType=e;var n=dY[e],r=this.now();if(this._oscillator){var a=this._oscillator;a.stop(r),this.context.setTimeout((function(){return a.dispose()}),this.blockTime)}this._oscillator=new n({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=function(){return t.onstop(t)},"started"===this.state&&this._oscillator.start(r)}}},{key:"phase",get:function(){return this._oscillator.phase},set:function(e){this._oscillator.phase=e}},{key:"sourceType",get:function(){return this._sourceType},set:function(e){var t="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(t=this._oscillator.type),"fm"===e?this.type="fm"+t:"am"===e?this.type="am"+t:"fat"===e?this.type="fat"+t:"oscillator"===e?this.type=t:"pulse"===e?this.type="pulse":"pwm"===e&&(this.type="pwm")}},{key:"_getOscType",value:function(e,t){return e instanceof dY[t]}},{key:"baseType",get:function(){return this._oscillator.baseType},set:function(e){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===e||"pwm"===e||(this._oscillator.baseType=e)}},{key:"width",get:function(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0}},{key:"count",get:function(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0},set:function(e){this._getOscType(this._oscillator,"fat")&&rK(e)&&(this._oscillator.count=e)}},{key:"spread",get:function(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0},set:function(e){this._getOscType(this._oscillator,"fat")&&rK(e)&&(this._oscillator.spread=e)}},{key:"modulationType",get:function(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0},set:function(e){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&sK(e)&&(this._oscillator.modulationType=e)}},{key:"modulationIndex",get:function(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0}},{key:"harmonicity",get:function(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0}},{key:"modulationFrequency",get:function(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0}},{key:"asArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return dK(this,void 0,void 0,x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",nY(this,e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(aY.getDefaults(),lY.getDefaults(),cY.getDefaults(),fY.getDefaults(),hY.getDefaults(),pY.getDefaults())}}]),n}(YX),vY=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.call(this,Object.assign(_K(n.getDefaults(),arguments,["value"])))).override=!1,e.name="Add",e._sum=new SX({context:e.context}),e.input=e._sum,e.output=e._sum,e.addend=e._param,xX(e._constantSource,e._sum),e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._sum.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(EX.getDefaults(),{value:0})}}]),n}(EX),gY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,Object.assign(_K(n.getDefaults(),arguments,["min","max"])))).name="Scale";var r=_K(n.getDefaults(),arguments,["min","max"]);return e._mult=e.input=new uY({context:e.context,value:r.max-r.min}),e._add=e.output=new vY({context:e.context,value:r.min}),e._min=r.min,e._max=r.max,e.input.connect(e.output),e}return c(n,[{key:"min",get:function(){return this._min},set:function(e){this._min=e,this._setRange()}},{key:"max",get:function(){return this._max},set:function(e){this._max=e,this._setRange()}},{key:"_setRange",value:function(){this._add.value=this._min,this._mult.value=this._max-this._min}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._add.dispose(),this._mult.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(iY.getDefaults(),{max:1,min:0})}}]),n}(iY),yY=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.call(this,Object.assign(_K(n.getDefaults(),arguments)))).name="Zero",e._gain=new SX({context:e.context}),e.output=e._gain,e.input=void 0,wX(e.context.getConstant(0),e._gain),e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),_X(this.context.getConstant(0),this._gain),this}}]),n}(iY),bY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["frequency","min","max"]))).name="LFO",e._stoppedValue=0,e._units="number",e.convert=!0,e._fromType=bX.prototype._fromType,e._toType=bX.prototype._toType,e._is=bX.prototype._is,e._clampValue=bX.prototype._clampValue;var r=_K(n.getDefaults(),arguments,["frequency","min","max"]);return e._oscillator=new aY(r),e.frequency=e._oscillator.frequency,e._amplitudeGain=new SX({context:e.context,gain:r.amplitude,units:"normalRange"}),e.amplitude=e._amplitudeGain.gain,e._stoppedSignal=new EX({context:e.context,units:"audioRange",value:0}),e._zeros=new yY({context:e.context}),e._a2g=new sY({context:e.context}),e._scaler=e.output=new gY({context:e.context,max:r.max,min:r.min}),e.units=r.units,e.min=r.min,e.max=r.max,e._oscillator.chain(e._amplitudeGain,e._a2g,e._scaler),e._zeros.connect(e._a2g),e._stoppedSignal.connect(e._a2g),GK(m(e),["amplitude","frequency"]),e.phase=r.phase,e}return c(n,[{key:"start",value:function(e){return e=this.toSeconds(e),this._stoppedSignal.setValueAtTime(0,e),this._oscillator.start(e),this}},{key:"stop",value:function(e){return e=this.toSeconds(e),this._stoppedSignal.setValueAtTime(this._stoppedValue,e),this._oscillator.stop(e),this}},{key:"sync",value:function(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}},{key:"unsync",value:function(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}},{key:"_setStoppedValue",value:function(){this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}},{key:"min",get:function(){return this._toType(this._scaler.min)},set:function(e){e=this._fromType(e),this._scaler.min=e}},{key:"max",get:function(){return this._toType(this._scaler.max)},set:function(e){e=this._fromType(e),this._scaler.max=e}},{key:"type",get:function(){return this._oscillator.type},set:function(e){this._oscillator.type=e,this._setStoppedValue()}},{key:"partials",get:function(){return this._oscillator.partials},set:function(e){this._oscillator.partials=e,this._setStoppedValue()}},{key:"phase",get:function(){return this._oscillator.phase},set:function(e){this._oscillator.phase=e,this._setStoppedValue()}},{key:"units",get:function(){return this._units},set:function(e){var t=this.min,n=this.max;this._units=e,this.min=t,this.max=n}},{key:"state",get:function(){return this._oscillator.state}},{key:"connect",value:function(e,t,n){return(e instanceof bX||e instanceof EX)&&(this.convert=e.convert,this.units=e.units),IX(this,e,t,n),this}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(aY.getDefaults(),{amplitude:1,frequency:"4n",max:1,min:0,type:"sine",units:"number"})}}]),n}(kX);function kY(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=new WeakMap;return function(r,a){Reflect.defineProperty(r,a,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(r){XH(r,e,t),n.set(this,r)}})}}function xY(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=new WeakMap;return function(r,a){Reflect.defineProperty(r,a,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(r){XH(this.toSeconds(r),e,t),n.set(this,r)}})}}var wY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["url","onload"]))).name="Player",e._activeSources=new Set;var r=_K(n.getDefaults(),arguments,["url","onload"]);return e._buffer=new HK({onload:e._onload.bind(m(e),r.onload),onerror:r.onerror,reverse:r.reverse,url:r.url}),e.autostart=r.autostart,e._loop=r.loop,e._loopStart=r.loopStart,e._loopEnd=r.loopEnd,e._playbackRate=r.playbackRate,e.fadeIn=r.fadeIn,e.fadeOut=r.fadeOut,e}return c(n,[{key:"load",value:function(e){return dK(this,void 0,void 0,x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._buffer.load(e);case 2:return this._onload(),t.abrupt("return",this);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"_onload",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:UK;e(),this.autostart&&this.start()}},{key:"_onSourceEnd",value:function(e){this.onstop(this),this._activeSources.delete(e),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}},{key:"start",value:function(e,t,r){return Rw(f(n.prototype),"start",this).call(this,e,t,r),this}},{key:"_start",value:function(e,t,n){t=this._loop?SK(t,this._loopStart):SK(t,0);var r=this.toSeconds(t),a=n;n=SK(n,Math.max(this._buffer.duration-r,0));var i=this.toSeconds(n);i/=this._playbackRate,e=this.toSeconds(e);var o=new QX({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(e+i),this._state.setStateAtTime("stopped",e+i,{implicitEnd:!0})),this._activeSources.add(o),this._loop&&eK(a)?o.start(e,r):o.start(e,r,i-this.toSeconds(this.fadeOut))}},{key:"_stop",value:function(e){var t=this.toSeconds(e);this._activeSources.forEach((function(e){return e.stop(t)}))}},{key:"restart",value:function(e,t,r){return Rw(f(n.prototype),"restart",this).call(this,e,t,r),this}},{key:"_restart",value:function(e,t,n){this._stop(e),this._start(e,t,n)}},{key:"seek",value:function(e,t){var n=this.toSeconds(t);if("started"===this._state.getValueAtTime(n)){var r=this.toSeconds(e);this._stop(n),this._start(n,r)}return this}},{key:"setLoopPoints",value:function(e,t){return this.loopStart=e,this.loopEnd=t,this}},{key:"loopStart",get:function(){return this._loopStart},set:function(e){this._loopStart=e,this.buffer.loaded&&XH(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach((function(t){t.loopStart=e}))}},{key:"loopEnd",get:function(){return this._loopEnd},set:function(e){this._loopEnd=e,this.buffer.loaded&&XH(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach((function(t){t.loopEnd=e}))}},{key:"buffer",get:function(){return this._buffer},set:function(e){this._buffer.set(e)}},{key:"loop",get:function(){return this._loop},set:function(e){if(this._loop!==e&&(this._loop=e,this._activeSources.forEach((function(t){t.loop=e})),e)){var t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(e){this._playbackRate=e;var t=this.now(),n=this._state.getNextState("stopped",t);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach((function(e){return e.cancelStop()}))),this._activeSources.forEach((function(n){n.playbackRate.setValueAtTime(e,t)}))}},{key:"reverse",get:function(){return this._buffer.reverse},set:function(e){this._buffer.reverse=e}},{key:"loaded",get:function(){return this._buffer.loaded}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._activeSources.forEach((function(e){return e.dispose()})),this._activeSources.clear(),this._buffer.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(YX.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:UK,onerror:UK,playbackRate:1,reverse:!1})}}]),n}(YX);pK([xY(0)],wY.prototype,"fadeIn",void 0),pK([xY(0)],wY.prototype,"fadeOut",void 0);var _Y=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["urls","onload"],"urls"))).name="Players",e.input=void 0,e._players=new Map;var r=_K(n.getDefaults(),arguments,["urls","onload"],"urls");return e._volume=e.output=new GX({context:e.context,volume:r.volume}),e.volume=e._volume.volume,GK(m(e),"volume"),e._buffers=new OX({urls:r.urls,onload:r.onload,baseUrl:r.baseUrl,onerror:r.onerror}),e.mute=r.mute,e._fadeIn=r.fadeIn,e._fadeOut=r.fadeOut,e}return c(n,[{key:"mute",get:function(){return this._volume.mute},set:function(e){this._volume.mute=e}},{key:"fadeIn",get:function(){return this._fadeIn},set:function(e){this._fadeIn=e,this._players.forEach((function(t){t.fadeIn=e}))}},{key:"fadeOut",get:function(){return this._fadeOut},set:function(e){this._fadeOut=e,this._players.forEach((function(t){t.fadeOut=e}))}},{key:"state",get:function(){return Array.from(this._players).some((function(e){var t=Ct(e,2);t[0];return"started"===t[1].state}))?"started":"stopped"}},{key:"has",value:function(e){return this._buffers.has(e)}},{key:"player",value:function(e){if(KH(this.has(e),"No Player with the name ".concat(e," exists on this object")),!this._players.has(e)){var t=new wY({context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,url:this._buffers.get(e)}).connect(this.output);this._players.set(e,t)}return this._players.get(e)}},{key:"loaded",get:function(){return this._buffers.loaded}},{key:"add",value:function(e,t,n){return KH(!this._buffers.has(e),"A buffer with that name already exists on this object"),this._buffers.add(e,t,n),this}},{key:"stopAll",value:function(e){return this._players.forEach((function(t){return t.stop(e)})),this}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._volume.dispose(),this.volume.dispose(),this._players.forEach((function(e){return e.dispose()})),this._buffers.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(YX.getDefaults(),{baseUrl:"",fadeIn:0,fadeOut:0,mute:!1,onload:UK,onerror:UK,urls:{},volume:0})}}]),n}(kX),SY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["url","onload"]))).name="GrainPlayer",e._loopStart=0,e._loopEnd=0,e._activeSources=[];var r=_K(n.getDefaults(),arguments,["url","onload"]);return e.buffer=new HK({onload:r.onload,onerror:r.onerror,reverse:r.reverse,url:r.url}),e._clock=new MX({context:e.context,callback:e._tick.bind(m(e)),frequency:1/r.grainSize}),e._playbackRate=r.playbackRate,e._grainSize=r.grainSize,e._overlap=r.overlap,e.detune=r.detune,e.overlap=r.overlap,e.loop=r.loop,e.playbackRate=r.playbackRate,e.grainSize=r.grainSize,e.loopStart=r.loopStart,e.loopEnd=r.loopEnd,e.reverse=r.reverse,e._clock.on("stop",e._onstop.bind(m(e))),e}return c(n,[{key:"_start",value:function(e,t,n){t=SK(t,0),t=this.toSeconds(t),e=this.toSeconds(e);var r=1/this._clock.frequency.getValueAtTime(e);this._clock.start(e,t/r),n&&this.stop(e+this.toSeconds(n))}},{key:"restart",value:function(e,t,r){return Rw(f(n.prototype),"restart",this).call(this,e,t,r),this}},{key:"_restart",value:function(e,t,n){this._stop(e),this._start(e,t,n)}},{key:"_stop",value:function(e){this._clock.stop(e)}},{key:"_onstop",value:function(e){this._activeSources.forEach((function(t){t.fadeOut=0,t.stop(e)})),this.onstop(this)}},{key:"_tick",value:function(e){var t=this,n=this._clock.getTicksAtTime(e),r=n*this._grainSize;if(this.log("offset",r),!this.loop&&r>this.buffer.duration)this.stop(e);else{var a=r<this._overlap?0:this._overlap,i=new QX({context:this.context,url:this.buffer,fadeIn:a,fadeOut:this._overlap,loop:this.loop,loopStart:this._loopStart,loopEnd:this._loopEnd,playbackRate:rX(this.detune/100)}).connect(this.output);i.start(e,this._grainSize*n),i.stop(e+this._grainSize/this.playbackRate),this._activeSources.push(i),i.onended=function(){var e=t._activeSources.indexOf(i);-1!==e&&t._activeSources.splice(e,1)}}}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(e){XH(e,.001),this._playbackRate=e,this.grainSize=this._grainSize}},{key:"loopStart",get:function(){return this._loopStart},set:function(e){this.buffer.loaded&&XH(this.toSeconds(e),0,this.buffer.duration),this._loopStart=this.toSeconds(e)}},{key:"loopEnd",get:function(){return this._loopEnd},set:function(e){this.buffer.loaded&&XH(this.toSeconds(e),0,this.buffer.duration),this._loopEnd=this.toSeconds(e)}},{key:"reverse",get:function(){return this.buffer.reverse},set:function(e){this.buffer.reverse=e}},{key:"grainSize",get:function(){return this._grainSize},set:function(e){this._grainSize=this.toSeconds(e),this._clock.frequency.setValueAtTime(this._playbackRate/this._grainSize,this.now())}},{key:"overlap",get:function(){return this._overlap},set:function(e){var t=this.toSeconds(e);XH(t,0),this._overlap=t}},{key:"loaded",get:function(){return this.buffer.loaded}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.buffer.dispose(),this._clock.dispose(),this._activeSources.forEach((function(e){return e.dispose()})),this}}],[{key:"getDefaults",value:function(){return Object.assign(YX.getDefaults(),{onload:UK,onerror:UK,overlap:.1,grainSize:.2,playbackRate:1,detune:0,loop:!1,loopStart:0,loopEnd:0,reverse:!1})}}]),n}(YX),CY=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.apply(this,arguments)).name="Abs",e._abs=new oY({context:e.context,mapping:function(e){return Math.abs(e)<.001?0:Math.abs(e)}}),e.input=e._abs,e.output=e._abs,e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._abs.dispose(),this}}]),n}(iY),TY=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.apply(this,arguments)).name="GainToAudio",e._norm=new oY({context:e.context,mapping:function(e){return 2*Math.abs(e)-1}}),e.input=e._norm,e.output=e._norm,e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._norm.dispose(),this}}]),n}(iY),EY=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.apply(this,arguments)).name="Negate",e._multiply=new uY({context:e.context,value:-1}),e.input=e._multiply,e.output=e._multiply,e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._multiply.dispose(),this}}]),n}(iY),IY=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.call(this,Object.assign(_K(n.getDefaults(),arguments,["value"])))).override=!1,e.name="Subtract",e._sum=new SX({context:e.context}),e.input=e._sum,e.output=e._sum,e._neg=new EY({context:e.context}),e.subtrahend=e._param,xX(e._constantSource,e._neg,e._sum),e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._neg.dispose(),this._sum.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(EX.getDefaults(),{value:0})}}]),n}(EX),AY=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.call(this,Object.assign(_K(n.getDefaults(),arguments)))).name="GreaterThanZero",e._thresh=e.output=new oY({context:e.context,length:127,mapping:function(e){return e<=0?0:1}}),e._scale=e.input=new uY({context:e.context,value:1e4}),e._scale.connect(e._thresh),e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._scale.dispose(),this._thresh.dispose(),this}}]),n}(iY),NY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,Object.assign(_K(n.getDefaults(),arguments,["value"])))).name="GreaterThan",e.override=!1;var r=_K(n.getDefaults(),arguments,["value"]);return e._subtract=e.input=new IY({context:e.context,value:r.value}),e._gtz=e.output=new AY({context:e.context}),e.comparator=e._param=e._subtract.subtrahend,GK(m(e),"comparator"),e._subtract.connect(e._gtz),e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._gtz.dispose(),this._subtract.dispose(),this.comparator.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(EX.getDefaults(),{value:0})}}]),n}(EX),PY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,Object.assign(_K(n.getDefaults(),arguments,["value"])))).name="Pow";var r=_K(n.getDefaults(),arguments,["value"]);return e._exponentScaler=e.input=e.output=new oY({context:e.context,mapping:e._expFunc(r.value),length:8192}),e._exponent=r.value,e}return c(n,[{key:"_expFunc",value:function(e){return function(t){return Math.pow(Math.abs(t),e)}}},{key:"value",get:function(){return this._exponent},set:function(e){this._exponent=e,this._exponentScaler.setMap(this._expFunc(this._exponent))}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._exponentScaler.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(iY.getDefaults(),{value:1})}}]),n}(iY),MY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,Object.assign(_K(n.getDefaults(),arguments,["min","max","exponent"])))).name="ScaleExp";var r=_K(n.getDefaults(),arguments,["min","max","exponent"]);return e.input=e._exp=new PY({context:e.context,value:r.exponent}),e._exp.connect(e._mult),e}return c(n,[{key:"exponent",get:function(){return this._exp.value},set:function(e){this._exp.value=e}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._exp.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(gY.getDefaults(),{exponent:1})}}]),n}(gY),DY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(EX.getDefaults(),arguments,["value","units"]))).name="SyncedSignal",e.override=!1;var r=_K(EX.getDefaults(),arguments,["value","units"]);return e._lastVal=r.value,e._synced=e.context.transport.scheduleRepeat(e._onTick.bind(m(e)),"1i"),e._syncedCallback=e._anchorValue.bind(m(e)),e.context.transport.on("start",e._syncedCallback),e.context.transport.on("pause",e._syncedCallback),e.context.transport.on("stop",e._syncedCallback),e._constantSource.disconnect(),e._constantSource.stop(0),e._constantSource=e.output=new TX({context:e.context,offset:r.value,units:r.units}).start(0),e.setValueAtTime(r.value,0),e}return c(n,[{key:"_onTick",value:function(e){var t=Rw(f(n.prototype),"getValueAtTime",this).call(this,this.context.transport.seconds);this._lastVal!==t&&(this._lastVal=t,this._constantSource.offset.setValueAtTime(t,e))}},{key:"_anchorValue",value:function(e){var t=Rw(f(n.prototype),"getValueAtTime",this).call(this,this.context.transport.seconds);this._lastVal=t,this._constantSource.offset.cancelAndHoldAtTime(e),this._constantSource.offset.setValueAtTime(t,e)}},{key:"getValueAtTime",value:function(e){var t=new mX(this.context,e).toSeconds();return Rw(f(n.prototype),"getValueAtTime",this).call(this,t)}},{key:"setValueAtTime",value:function(e,t){var r=new mX(this.context,t).toSeconds();return Rw(f(n.prototype),"setValueAtTime",this).call(this,e,r),this}},{key:"linearRampToValueAtTime",value:function(e,t){var r=new mX(this.context,t).toSeconds();return Rw(f(n.prototype),"linearRampToValueAtTime",this).call(this,e,r),this}},{key:"exponentialRampToValueAtTime",value:function(e,t){var r=new mX(this.context,t).toSeconds();return Rw(f(n.prototype),"exponentialRampToValueAtTime",this).call(this,e,r),this}},{key:"setTargetAtTime",value:function(e,t,r){var a=new mX(this.context,t).toSeconds();return Rw(f(n.prototype),"setTargetAtTime",this).call(this,e,a,r),this}},{key:"cancelScheduledValues",value:function(e){var t=new mX(this.context,e).toSeconds();return Rw(f(n.prototype),"cancelScheduledValues",this).call(this,t),this}},{key:"setValueCurveAtTime",value:function(e,t,r,a){var i=new mX(this.context,t).toSeconds();return r=this.toSeconds(r),Rw(f(n.prototype),"setValueCurveAtTime",this).call(this,e,i,r,a),this}},{key:"cancelAndHoldAtTime",value:function(e){var t=new mX(this.context,e).toSeconds();return Rw(f(n.prototype),"cancelAndHoldAtTime",this).call(this,t),this}},{key:"setRampPoint",value:function(e){var t=new mX(this.context,e).toSeconds();return Rw(f(n.prototype),"setRampPoint",this).call(this,t),this}},{key:"exponentialRampTo",value:function(e,t,r){var a=new mX(this.context,r).toSeconds();return Rw(f(n.prototype),"exponentialRampTo",this).call(this,e,t,a),this}},{key:"linearRampTo",value:function(e,t,r){var a=new mX(this.context,r).toSeconds();return Rw(f(n.prototype),"linearRampTo",this).call(this,e,t,a),this}},{key:"targetRampTo",value:function(e,t,r){var a=new mX(this.context,r).toSeconds();return Rw(f(n.prototype),"targetRampTo",this).call(this,e,t,a),this}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.context.transport.clear(this._synced),this.context.transport.off("start",this._syncedCallback),this.context.transport.off("pause",this._syncedCallback),this.context.transport.off("stop",this._syncedCallback),this._constantSource.dispose(),this}}]),n}(EX),RY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["attack","decay","sustain","release"]))).name="Envelope",e._sig=new EX({context:e.context,value:0}),e.output=e._sig,e.input=void 0;var r=_K(n.getDefaults(),arguments,["attack","decay","sustain","release"]);return e.attack=r.attack,e.decay=r.decay,e.sustain=r.sustain,e.release=r.release,e.attackCurve=r.attackCurve,e.releaseCurve=r.releaseCurve,e.decayCurve=r.decayCurve,e}return c(n,[{key:"value",get:function(){return this.getValueAtTime(this.now())}},{key:"_getCurve",value:function(e,t){if(sK(e))return e;var n;for(n in OY)if(OY[n][t]===e)return n;return e}},{key:"_setCurve",value:function(e,t,n){if(sK(n)&&Reflect.has(OY,n)){var r=OY[n];aK(r)?"_decayCurve"!==e&&(this[e]=r[t]):this[e]=r}else{if(!oK(n)||"_decayCurve"===e)throw new Error("Envelope: invalid curve: "+n);this[e]=n}}},{key:"attackCurve",get:function(){return this._getCurve(this._attackCurve,"In")},set:function(e){this._setCurve("_attackCurve","In",e)}},{key:"releaseCurve",get:function(){return this._getCurve(this._releaseCurve,"Out")},set:function(e){this._setCurve("_releaseCurve","Out",e)}},{key:"decayCurve",get:function(){return this._decayCurve},set:function(e){KH(["linear","exponential"].some((function(t){return t===e})),"Invalid envelope curve: ".concat(e)),this._decayCurve=e}},{key:"triggerAttack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.log("triggerAttack",e,t),e=this.toSeconds(e);var n=this.toSeconds(this.attack),r=n,a=this.toSeconds(this.decay),i=this.getValueAtTime(e);if(i>0){var o=1/r,s=1-i;r=s/o}if(r<this.sampleTime)this._sig.cancelScheduledValues(e),this._sig.setValueAtTime(t,e);else if("linear"===this._attackCurve)this._sig.linearRampTo(t,r,e);else if("exponential"===this._attackCurve)this._sig.targetRampTo(t,r,e);else{this._sig.cancelAndHoldAtTime(e);for(var u=this._attackCurve,c=1;c<u.length;c++)if(u[c-1]<=i&&i<=u[c]){(u=this._attackCurve.slice(c))[0]=i;break}this._sig.setValueCurveAtTime(u,e,r,t)}if(a&&this.sustain<1){var l=t*this.sustain,h=e+r;this.log("decay",h),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(l,a+h):this._sig.exponentialApproachValueAtTime(l,h,a)}return this}},{key:"triggerRelease",value:function(e){this.log("triggerRelease",e),e=this.toSeconds(e);var t=this.getValueAtTime(e);if(t>0){var n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,e):"linear"===this._releaseCurve?this._sig.linearRampTo(0,n,e):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,n,e):(KH(oK(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(e),this._sig.setValueCurveAtTime(this._releaseCurve,e,n,t))}return this}},{key:"getValueAtTime",value:function(e){return this._sig.getValueAtTime(e)}},{key:"triggerAttackRelease",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return t=this.toSeconds(t),this.triggerAttack(t,n),this.triggerRelease(t+this.toSeconds(e)),this}},{key:"cancel",value:function(e){return this._sig.cancelScheduledValues(this.toSeconds(e)),this}},{key:"connect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return IX(this,e,t,n),this}},{key:"asArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return dK(this,void 0,void 0,x().mark((function t(){var n,r,a,i,o,s,u,c;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e/this.context.sampleRate,r=new KK(1,n,this.context.sampleRate),a=this.toSeconds(this.attack)+this.toSeconds(this.decay),i=a+this.toSeconds(this.release),s=i+(o=.1*i),(u=new this.constructor(Object.assign(this.get(),{attack:n*this.toSeconds(this.attack)/s,decay:n*this.toSeconds(this.decay)/s,release:n*this.toSeconds(this.release)/s,context:r})))._sig.toDestination(),u.triggerAttackRelease(n*(a+o)/s,0),t.next=11,r.render();case 11:return c=t.sent,t.abrupt("return",c.getChannelData(0));case 13:case"end":return t.stop()}}),t,this)})))}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._sig.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}}]),n}(kX);pK([xY(0)],RY.prototype,"attack",void 0),pK([xY(0)],RY.prototype,"decay",void 0),pK([kY(0,1)],RY.prototype,"sustain",void 0),pK([xY(0)],RY.prototype,"release",void 0);var OY=function(){var e,t,n=128,r=[];for(e=0;e<n;e++)r[e]=Math.sin(e/127*(Math.PI/2));var a=[];for(e=0;e<127;e++){t=e/127;var i=Math.sin(t*(2*Math.PI)*6.4-Math.PI/2)+1;a[e]=i/10+.83*t}a[127]=1;var o=[];for(e=0;e<n;e++)o[e]=Math.ceil(e/127*5)/5;var s=[];for(e=0;e<n;e++)t=e/127,s[e]=.5*(1-Math.cos(Math.PI*t));var u,c=[];for(e=0;e<n;e++){t=e/127;var l=4*Math.pow(t,3)+.2,h=Math.cos(l*Math.PI*2*t);c[e]=Math.abs(h*(1-t))}function f(e){for(var t=new Array(e.length),n=0;n<e.length;n++)t[n]=1-e[n];return t}return{bounce:{In:f(c),Out:c},cosine:{In:r,Out:(u=r,u.slice(0).reverse())},exponential:"exponential",linear:"linear",ripple:{In:a,Out:f(a)},sine:{In:s,Out:f(s)},step:{In:o,Out:f(o)}}}(),FY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments)))._scheduledEvents=[],e._synced=!1,e._original_triggerAttack=e.triggerAttack,e._original_triggerRelease=e.triggerRelease;var r=_K(n.getDefaults(),arguments);return e._volume=e.output=new GX({context:e.context,volume:r.volume}),e.volume=e._volume.volume,GK(m(e),"volume"),e}return c(n,[{key:"sync",value:function(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}},{key:"_syncState",value:function(){var e=!1;return this._synced||(this._synced=!0,e=!0),e}},{key:"_syncMethod",value:function(e,t){var n=this,r=this["_original_"+e]=this[e];this[e]=function(){for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];var o=a[t],s=n.context.transport.schedule((function(e){a[t]=e,r.apply(n,a)}),o);n._scheduledEvents.push(s)}}},{key:"unsync",value:function(){var e=this;return this._scheduledEvents.forEach((function(t){return e.context.transport.clear(t)})),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}},{key:"triggerAttackRelease",value:function(e,t,n,r){var a=this.toSeconds(n),i=this.toSeconds(t);return this.triggerAttack(e,a,r),this.triggerRelease(a+i),this}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{volume:0})}}]),n}(kX),LY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),e=t.call(this,_K(n.getDefaults(),arguments));var r=_K(n.getDefaults(),arguments);return e.portamento=r.portamento,e.onsilence=r.onsilence,e}return c(n,[{key:"triggerAttack",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.log("triggerAttack",e,t,n);var r=this.toSeconds(t);return this._triggerEnvelopeAttack(r,n),this.setNote(e,r),this}},{key:"triggerRelease",value:function(e){this.log("triggerRelease",e);var t=this.toSeconds(e);return this._triggerEnvelopeRelease(t),this}},{key:"setNote",value:function(e,t){var n=this.toSeconds(t),r=e instanceof hX?e.toFrequency():e;if(this.portamento>0&&this.getLevelAtTime(n)>.05){var a=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(r,a,n)}else this.frequency.setValueAtTime(r,n);return this}}],[{key:"getDefaults",value:function(){return Object.assign(FY.getDefaults(),{detune:0,onsilence:UK,portamento:0})}}]),n}(FY);pK([xY(0)],LY.prototype,"portamento",void 0);var zY=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["attack","decay","sustain","release"]))).name="AmplitudeEnvelope",e._gainNode=new SX({context:e.context,gain:0}),e.output=e._gainNode,e.input=e._gainNode,e._sig.connect(e._gainNode.gain),e.output=e._gainNode,e.input=e._gainNode,e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._gainNode.dispose(),this}}]),n}(RY),BY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments))).name="Synth";var r=_K(n.getDefaults(),arguments);return e.oscillator=new mY(Object.assign({context:e.context,detune:r.detune,onstop:function(){return e.onsilence(m(e))}},r.oscillator)),e.frequency=e.oscillator.frequency,e.detune=e.oscillator.detune,e.envelope=new zY(Object.assign({context:e.context},r.envelope)),e.oscillator.chain(e.envelope,e.output),GK(m(e),["oscillator","frequency","detune","envelope"]),e}return c(n,[{key:"_triggerEnvelopeAttack",value:function(e,t){if(this.envelope.triggerAttack(e,t),this.oscillator.start(e),0===this.envelope.sustain){var n=this.toSeconds(this.envelope.attack),r=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+n+r)}}},{key:"_triggerEnvelopeRelease",value:function(e){this.envelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}},{key:"getLevelAtTime",value:function(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.oscillator.dispose(),this.envelope.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(LY.getDefaults(),{envelope:Object.assign(CK(RY.getDefaults(),Object.keys(kX.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(CK(mY.getDefaults(),[].concat(Fn(Object.keys(YX.getDefaults())),["frequency","detune"])),{type:"triangle"})})}}]),n}(LY),VY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments))).name="ModulationSynth";var r=_K(n.getDefaults(),arguments);return e._carrier=new BY({context:e.context,oscillator:r.oscillator,envelope:r.envelope,onsilence:function(){return e.onsilence(m(e))},volume:-10}),e._modulator=new BY({context:e.context,oscillator:r.modulation,envelope:r.modulationEnvelope,volume:-10}),e.oscillator=e._carrier.oscillator,e.envelope=e._carrier.envelope,e.modulation=e._modulator.oscillator,e.modulationEnvelope=e._modulator.envelope,e.frequency=new EX({context:e.context,units:"frequency"}),e.detune=new EX({context:e.context,value:r.detune,units:"cents"}),e.harmonicity=new uY({context:e.context,value:r.harmonicity,minValue:0}),e._modulationNode=new SX({context:e.context,gain:0}),GK(m(e),["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"]),e}return c(n,[{key:"_triggerEnvelopeAttack",value:function(e,t){this._carrier._triggerEnvelopeAttack(e,t),this._modulator._triggerEnvelopeAttack(e,t)}},{key:"_triggerEnvelopeRelease",value:function(e){return this._carrier._triggerEnvelopeRelease(e),this._modulator._triggerEnvelopeRelease(e),this}},{key:"getLevelAtTime",value:function(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._carrier.dispose(),this._modulator.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._modulationNode.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(LY.getDefaults(),{harmonicity:3,oscillator:Object.assign(CK(mY.getDefaults(),[].concat(Fn(Object.keys(YX.getDefaults())),["frequency","detune"])),{type:"sine"}),envelope:Object.assign(CK(RY.getDefaults(),Object.keys(kX.getDefaults())),{attack:.01,decay:.01,sustain:1,release:.5}),modulation:Object.assign(CK(mY.getDefaults(),[].concat(Fn(Object.keys(YX.getDefaults())),["frequency","detune"])),{type:"square"}),modulationEnvelope:Object.assign(CK(RY.getDefaults(),Object.keys(kX.getDefaults())),{attack:.5,decay:0,sustain:1,release:.5})})}}]),n}(LY),jY=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments))).name="AMSynth",e._modulationScale=new sY({context:e.context}),e.frequency.connect(e._carrier.frequency),e.frequency.chain(e.harmonicity,e._modulator.frequency),e.detune.fan(e._carrier.detune,e._modulator.detune),e._modulator.chain(e._modulationScale,e._modulationNode.gain),e._carrier.chain(e._modulationNode,e.output),e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._modulationScale.dispose(),this}}]),n}(VY),qY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["frequency","type"]))).name="BiquadFilter";var r=_K(n.getDefaults(),arguments,["frequency","type"]);return e._filter=e.context.createBiquadFilter(),e.input=e.output=e._filter,e.Q=new bX({context:e.context,units:"number",value:r.Q,param:e._filter.Q}),e.frequency=new bX({context:e.context,units:"frequency",value:r.frequency,param:e._filter.frequency}),e.detune=new bX({context:e.context,units:"cents",value:r.detune,param:e._filter.detune}),e.gain=new bX({context:e.context,units:"decibels",convert:!1,value:r.gain,param:e._filter.gain}),e.type=r.type,e}return c(n,[{key:"type",get:function(){return this._filter.type},set:function(e){KH(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(e),"Invalid filter type: ".concat(e)),this._filter.type=e}},{key:"getFrequencyResponse",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128,t=new Float32Array(e),n=0;n<e;n++){var r=Math.pow(n/e,2),a=19980*r+20;t[n]=a}var i=new Float32Array(e),o=new Float32Array(e),s=this.context.createBiquadFilter();return s.type=this.type,s.Q.value=this.Q.value,s.frequency.value=this.frequency.value,s.gain.value=this.gain.value,s.getFrequencyResponse(t,i,o),i}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}}]),n}(kX),GY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["frequency","type","rolloff"]))).name="Filter",e.input=new SX({context:e.context}),e.output=new SX({context:e.context}),e._filters=[];var r=_K(n.getDefaults(),arguments,["frequency","type","rolloff"]);return e._filters=[],e.Q=new EX({context:e.context,units:"positive",value:r.Q}),e.frequency=new EX({context:e.context,units:"frequency",value:r.frequency}),e.detune=new EX({context:e.context,units:"cents",value:r.detune}),e.gain=new EX({context:e.context,units:"decibels",convert:!1,value:r.gain}),e._type=r.type,e.rolloff=r.rolloff,GK(m(e),["detune","frequency","gain","Q"]),e}return c(n,[{key:"type",get:function(){return this._type},set:function(e){KH(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(e),"Invalid filter type: ".concat(e)),this._type=e,this._filters.forEach((function(t){return t.type=e}))}},{key:"rolloff",get:function(){return this._rolloff},set:function(e){var t=rK(e)?e:parseInt(e,10),n=[-12,-24,-48,-96],r=n.indexOf(t);KH(-1!==r,"rolloff can only be ".concat(n.join(", "))),r+=1,this._rolloff=t,this.input.disconnect(),this._filters.forEach((function(e){return e.disconnect()})),this._filters=new Array(r);for(var a=0;a<r;a++){var i=new qY({context:this.context});i.type=this._type,this.frequency.connect(i.frequency),this.detune.connect(i.detune),this.Q.connect(i.Q),this.gain.connect(i.gain),this._filters[a]=i}this._internalChannels=this._filters,xX.apply(void 0,[this.input].concat(Fn(this._internalChannels),[this.output]))}},{key:"getFrequencyResponse",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128,t=new qY({frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),n=new Float32Array(e).map((function(){return 1}));return this._filters.forEach((function(){t.getFrequencyResponse(e).forEach((function(e,t){return n[t]*=e}))})),t.dispose(),n}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._filters.forEach((function(e){e.dispose()})),WK(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})}}]),n}(kX),WY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["attack","decay","sustain","release"]))).name="FrequencyEnvelope";var r=_K(n.getDefaults(),arguments,["attack","decay","sustain","release"]);return e._octaves=r.octaves,e._baseFrequency=e.toFrequency(r.baseFrequency),e._exponent=e.input=new PY({context:e.context,value:r.exponent}),e._scale=e.output=new gY({context:e.context,min:e._baseFrequency,max:e._baseFrequency*Math.pow(2,e._octaves)}),e._sig.chain(e._exponent,e._scale),e}return c(n,[{key:"baseFrequency",get:function(){return this._baseFrequency},set:function(e){var t=this.toFrequency(e);XH(t,0),this._baseFrequency=t,this._scale.min=this._baseFrequency,this.octaves=this._octaves}},{key:"octaves",get:function(){return this._octaves},set:function(e){this._octaves=e,this._scale.max=this._baseFrequency*Math.pow(2,e)}},{key:"exponent",get:function(){return this._exponent.value},set:function(e){this._exponent.value=e}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._exponent.dispose(),this._scale.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(RY.getDefaults(),{baseFrequency:200,exponent:1,octaves:4})}}]),n}(RY),UY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments))).name="MonoSynth";var r=_K(n.getDefaults(),arguments);return e.oscillator=new mY(Object.assign(r.oscillator,{context:e.context,detune:r.detune,onstop:function(){return e.onsilence(m(e))}})),e.frequency=e.oscillator.frequency,e.detune=e.oscillator.detune,e.filter=new GY(Object.assign(r.filter,{context:e.context})),e.filterEnvelope=new WY(Object.assign(r.filterEnvelope,{context:e.context})),e.envelope=new zY(Object.assign(r.envelope,{context:e.context})),e.oscillator.chain(e.filter,e.envelope,e.output),e.filterEnvelope.connect(e.filter.frequency),GK(m(e),["oscillator","frequency","detune","filter","filterEnvelope","envelope"]),e}return c(n,[{key:"_triggerEnvelopeAttack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this.envelope.triggerAttack(e,t),this.filterEnvelope.triggerAttack(e),this.oscillator.start(e),0===this.envelope.sustain){var n=this.toSeconds(this.envelope.attack),r=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+n+r)}}},{key:"_triggerEnvelopeRelease",value:function(e){this.envelope.triggerRelease(e),this.filterEnvelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}},{key:"getLevelAtTime",value:function(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.oscillator.dispose(),this.envelope.dispose(),this.filterEnvelope.dispose(),this.filter.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(LY.getDefaults(),{envelope:Object.assign(CK(RY.getDefaults(),Object.keys(kX.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.9}),filter:Object.assign(CK(GY.getDefaults(),Object.keys(kX.getDefaults())),{Q:1,rolloff:-12,type:"lowpass"}),filterEnvelope:Object.assign(CK(WY.getDefaults(),Object.keys(kX.getDefaults())),{attack:.6,baseFrequency:200,decay:.2,exponent:2,octaves:3,release:2,sustain:.5}),oscillator:Object.assign(CK(mY.getDefaults(),Object.keys(YX.getDefaults())),{type:"sawtooth"})})}}]),n}(LY),HY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments))).name="DuoSynth";var r=_K(n.getDefaults(),arguments);return e.voice0=new UY(Object.assign(r.voice0,{context:e.context,onsilence:function(){return e.onsilence(m(e))}})),e.voice1=new UY(Object.assign(r.voice1,{context:e.context})),e.harmonicity=new uY({context:e.context,units:"positive",value:r.harmonicity}),e._vibrato=new bY({frequency:r.vibratoRate,context:e.context,min:-50,max:50}),e._vibrato.start(),e.vibratoRate=e._vibrato.frequency,e._vibratoGain=new SX({context:e.context,units:"normalRange",gain:r.vibratoAmount}),e.vibratoAmount=e._vibratoGain.gain,e.frequency=new EX({context:e.context,units:"frequency",value:440}),e.detune=new EX({context:e.context,units:"cents",value:r.detune}),e.frequency.connect(e.voice0.frequency),e.frequency.chain(e.harmonicity,e.voice1.frequency),e._vibrato.connect(e._vibratoGain),e._vibratoGain.fan(e.voice0.detune,e.voice1.detune),e.detune.fan(e.voice0.detune,e.voice1.detune),e.voice0.connect(e.output),e.voice1.connect(e.output),GK(m(e),["voice0","voice1","frequency","vibratoAmount","vibratoRate"]),e}return c(n,[{key:"getLevelAtTime",value:function(e){return e=this.toSeconds(e),this.voice0.envelope.getValueAtTime(e)+this.voice1.envelope.getValueAtTime(e)}},{key:"_triggerEnvelopeAttack",value:function(e,t){this.voice0._triggerEnvelopeAttack(e,t),this.voice1._triggerEnvelopeAttack(e,t)}},{key:"_triggerEnvelopeRelease",value:function(e){return this.voice0._triggerEnvelopeRelease(e),this.voice1._triggerEnvelopeRelease(e),this}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.voice0.dispose(),this.voice1.dispose(),this.frequency.dispose(),this.detune.dispose(),this._vibrato.dispose(),this.vibratoRate.dispose(),this._vibratoGain.dispose(),this.harmonicity.dispose(),this}}],[{key:"getDefaults",value:function(){return wK(LY.getDefaults(),{vibratoAmount:.5,vibratoRate:5,harmonicity:1.5,voice0:wK(CK(UY.getDefaults(),Object.keys(LY.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}}),voice1:wK(CK(UY.getDefaults(),Object.keys(LY.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}})})}}]),n}(LY),KY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments))).name="FMSynth";var r=_K(n.getDefaults(),arguments);return e.modulationIndex=new uY({context:e.context,value:r.modulationIndex}),e.frequency.connect(e._carrier.frequency),e.frequency.chain(e.harmonicity,e._modulator.frequency),e.frequency.chain(e.modulationIndex,e._modulationNode),e.detune.fan(e._carrier.detune,e._modulator.detune),e._modulator.connect(e._modulationNode.gain),e._modulationNode.connect(e._carrier.frequency),e._carrier.connect(e.output),e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.modulationIndex.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(VY.getDefaults(),{modulationIndex:10})}}]),n}(VY),XY=[1,1.483,1.932,2.546,2.63,3.897],YY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments))).name="MetalSynth",e._oscillators=[],e._freqMultipliers=[];var r=_K(n.getDefaults(),arguments);e.detune=new EX({context:e.context,units:"cents",value:r.detune}),e.frequency=new EX({context:e.context,units:"frequency"}),e._amplitude=new SX({context:e.context,gain:0}).connect(e.output),e._highpass=new GY({Q:0,context:e.context,type:"highpass"}).connect(e._amplitude);for(var a=0;a<XY.length;a++){var i=new lY({context:e.context,harmonicity:r.harmonicity,modulationIndex:r.modulationIndex,modulationType:"square",onstop:0===a?function(){return e.onsilence(m(e))}:UK,type:"square"});i.connect(e._highpass),e._oscillators[a]=i;var o=new uY({context:e.context,value:XY[a]});e._freqMultipliers[a]=o,e.frequency.chain(o,i.frequency),e.detune.connect(i.detune)}return e._filterFreqScaler=new gY({context:e.context,max:7e3,min:e.toFrequency(r.resonance)}),e.envelope=new RY({attack:r.envelope.attack,attackCurve:"linear",context:e.context,decay:r.envelope.decay,release:r.envelope.release,sustain:0}),e.envelope.chain(e._filterFreqScaler,e._highpass.frequency),e.envelope.connect(e._amplitude.gain),e._octaves=r.octaves,e.octaves=r.octaves,e}return c(n,[{key:"_triggerEnvelopeAttack",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.envelope.triggerAttack(e,n),this._oscillators.forEach((function(t){return t.start(e)})),0===this.envelope.sustain&&this._oscillators.forEach((function(n){n.stop(e+t.toSeconds(t.envelope.attack)+t.toSeconds(t.envelope.decay))})),this}},{key:"_triggerEnvelopeRelease",value:function(e){var t=this;return this.envelope.triggerRelease(e),this._oscillators.forEach((function(n){return n.stop(e+t.toSeconds(t.envelope.release))})),this}},{key:"getLevelAtTime",value:function(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}},{key:"modulationIndex",get:function(){return this._oscillators[0].modulationIndex.value},set:function(e){this._oscillators.forEach((function(t){return t.modulationIndex.value=e}))}},{key:"harmonicity",get:function(){return this._oscillators[0].harmonicity.value},set:function(e){this._oscillators.forEach((function(t){return t.harmonicity.value=e}))}},{key:"resonance",get:function(){return this._filterFreqScaler.min},set:function(e){this._filterFreqScaler.min=this.toFrequency(e),this.octaves=this._octaves}},{key:"octaves",get:function(){return this._octaves},set:function(e){this._octaves=e,this._filterFreqScaler.max=this._filterFreqScaler.min*Math.pow(2,e)}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._oscillators.forEach((function(e){return e.dispose()})),this._freqMultipliers.forEach((function(e){return e.dispose()})),this.frequency.dispose(),this.detune.dispose(),this._filterFreqScaler.dispose(),this._amplitude.dispose(),this.envelope.dispose(),this._highpass.dispose(),this}}],[{key:"getDefaults",value:function(){return wK(LY.getDefaults(),{envelope:Object.assign(CK(RY.getDefaults(),Object.keys(kX.getDefaults())),{attack:.001,decay:1.4,release:.2}),harmonicity:5.1,modulationIndex:32,octaves:1.5,resonance:4e3})}}]),n}(LY),QY=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments))).name="MembraneSynth",e.portamento=0;var r=_K(n.getDefaults(),arguments);return e.pitchDecay=r.pitchDecay,e.octaves=r.octaves,GK(m(e),["oscillator","envelope"]),e}return c(n,[{key:"setNote",value:function(e,t){var n=this.toSeconds(t),r=this.toFrequency(e instanceof hX?e.toFrequency():e),a=r*this.octaves;return this.oscillator.frequency.setValueAtTime(a,n),this.oscillator.frequency.exponentialRampToValueAtTime(r,n+this.toSeconds(this.pitchDecay)),this}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this}}],[{key:"getDefaults",value:function(){return wK(LY.getDefaults(),BY.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}}]),n}(BY);pK([kY(0)],QY.prototype,"octaves",void 0),pK([xY(0)],QY.prototype,"pitchDecay",void 0);var $Y=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments))).name="NoiseSynth";var r=_K(n.getDefaults(),arguments);return e.noise=new $X(Object.assign({context:e.context},r.noise)),e.envelope=new zY(Object.assign({context:e.context},r.envelope)),e.noise.chain(e.envelope,e.output),e}return c(n,[{key:"triggerAttack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e=this.toSeconds(e),this.envelope.triggerAttack(e,t),this.noise.start(e),0===this.envelope.sustain&&this.noise.stop(e+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay)),this}},{key:"triggerRelease",value:function(e){return e=this.toSeconds(e),this.envelope.triggerRelease(e),this.noise.stop(e+this.toSeconds(this.envelope.release)),this}},{key:"sync",value:function(){return this._syncState()&&(this._syncMethod("triggerAttack",0),this._syncMethod("triggerRelease",0)),this}},{key:"triggerAttackRelease",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return t=this.toSeconds(t),e=this.toSeconds(e),this.triggerAttack(t,n),this.triggerRelease(t+e),this}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.noise.dispose(),this.envelope.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(FY.getDefaults(),{envelope:Object.assign(CK(RY.getDefaults(),Object.keys(kX.getDefaults())),{decay:.1,sustain:0}),noise:Object.assign(CK($X.getDefaults(),Object.keys(YX.getDefaults())),{type:"white"})})}}]),n}(FY),JY=new Set;function ZY(e){JY.add(e)}function eQ(e,t){var n='registerProcessor("'.concat(e,'", ').concat(t,")");JY.add(n)}var tQ=function(e){h(n,e);var t=g(n);function n(e){var r;s(this,n),(r=t.call(this,e)).name="ToneAudioWorklet",r.workletOptions={},r.onprocessorerror=UK;var a=URL.createObjectURL(new Blob([Array.from(JY).join("\n")],{type:"text/javascript"})),i=r._audioWorkletName();return r._dummyGain=r.context.createGain(),r._dummyParam=r._dummyGain.gain,r.context.addAudioWorkletModule(a,i).then((function(){r.disposed||(r._worklet=r.context.createAudioWorkletNode(i,r.workletOptions),r._worklet.onprocessorerror=r.onprocessorerror.bind(m(r)),r.onReady(r._worklet))})),r}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._dummyGain.disconnect(),this._worklet&&(this._worklet.port.postMessage("dispose"),this._worklet.disconnect()),this}}]),n}(kX);ZY('\n\t/**\n\t * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. \n\t */\n\tclass ToneAudioWorkletProcessor extends AudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\t\n\t\t\tsuper(options);\n\t\t\t/**\n\t\t\t * If the processor was disposed or not. Keep alive until it\'s disposed.\n\t\t\t */\n\t\t\tthis.disposed = false;\n\t\t   \t/** \n\t\t\t * The number of samples in the processing block\n\t\t\t */\n\t\t\tthis.blockSize = 128;\n\t\t\t/**\n\t\t\t * the sample rate\n\t\t\t */\n\t\t\tthis.sampleRate = sampleRate;\n\n\t\t\tthis.port.onmessage = (event) => {\n\t\t\t\t// when it receives a dispose \n\t\t\t\tif (event.data === "dispose") {\n\t\t\t\t\tthis.disposed = true;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n');ZY("\n\t/**\n\t * Abstract class for a single input/output processor. \n\t * has a 'generate' function which processes one sample at a time\n\t */\n\tclass SingleIOProcessor extends ToneAudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(Object.assign(options, {\n\t\t\t\tnumberOfInputs: 1,\n\t\t\t\tnumberOfOutputs: 1\n\t\t\t}));\n\t\t\t/**\n\t\t\t * Holds the name of the parameter and a single value of that\n\t\t\t * parameter at the current sample\n\t\t\t * @type { [name: string]: number }\n\t\t\t */\n\t\t\tthis.params = {}\n\t\t}\n\n\t\t/**\n\t\t * Generate an output sample from the input sample and parameters\n\t\t * @abstract\n\t\t * @param input number\n\t\t * @param channel number\n\t\t * @param parameters { [name: string]: number }\n\t\t * @returns number\n\t\t */\n\t\tgenerate(){}\n\n\t\t/**\n\t\t * Update the private params object with the \n\t\t * values of the parameters at the given index\n\t\t * @param parameters { [name: string]: Float32Array },\n\t\t * @param index number\n\t\t */\n\t\tupdateParams(parameters, index) {\n\t\t\tfor (const paramName in parameters) {\n\t\t\t\tconst param = parameters[paramName];\n\t\t\t\tif (param.length > 1) {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][index];\n\t\t\t\t} else {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][0];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Process a single frame of the audio\n\t\t * @param inputs Float32Array[][]\n\t\t * @param outputs Float32Array[][]\n\t\t */\n\t\tprocess(inputs, outputs, parameters) {\n\t\t\tconst input = inputs[0];\n\t\t\tconst output = outputs[0];\n\t\t\t// get the parameter values\n\t\t\tconst channelCount = Math.max(input && input.length || 0, output.length);\n\t\t\tfor (let sample = 0; sample < this.blockSize; sample++) {\n\t\t\t\tthis.updateParams(parameters, sample);\n\t\t\t\tfor (let channel = 0; channel < channelCount; channel++) {\n\t\t\t\t\tconst inputSample = input && input.length ? input[channel][sample] : 0;\n\t\t\t\t\toutput[channel][sample] = this.generate(inputSample, channel, this.params);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn !this.disposed;\n\t\t}\n\t};\n");ZY("\n\t/**\n\t * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\n\t */\n\tclass DelayLine {\n\t\t\n\t\tconstructor(size, channels) {\n\t\t\tthis.buffer = [];\n\t\t\tthis.writeHead = []\n\t\t\tthis.size = size;\n\n\t\t\t// create the empty channels\n\t\t\tfor (let i = 0; i < channels; i++) {\n\t\t\t\tthis.buffer[i] = new Float32Array(this.size);\n\t\t\t\tthis.writeHead[i] = 0;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Push a value onto the end\n\t\t * @param channel number\n\t\t * @param value number\n\t\t */\n\t\tpush(channel, value) {\n\t\t\tthis.writeHead[channel] += 1;\n\t\t\tif (this.writeHead[channel] > this.size) {\n\t\t\t\tthis.writeHead[channel] = 0;\n\t\t\t}\n\t\t\tthis.buffer[channel][this.writeHead[channel]] = value;\n\t\t}\n\n\t\t/**\n\t\t * Get the recorded value of the channel given the delay\n\t\t * @param channel number\n\t\t * @param delay number delay samples\n\t\t */\n\t\tget(channel, delay) {\n\t\t\tlet readHead = this.writeHead[channel] - Math.floor(delay);\n\t\t\tif (readHead < 0) {\n\t\t\t\treadHead += this.size;\n\t\t\t}\n\t\t\treturn this.buffer[channel][readHead];\n\t\t}\n\t}\n");var nQ="feedback-comb-filter";eQ(nQ,'\n\tclass FeedbackCombFilterWorklet extends SingleIOProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\t\t\tthis.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\n\t\t}\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: "delayTime",\n\t\t\t\tdefaultValue: 0.1,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}, {\n\t\t\t\tname: "feedback",\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 0.9999,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, channel, parameters) {\n\t\t\tconst delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\n\t\t\tthis.delayLine.push(channel, input + delayedSample * parameters.feedback);\n\t\t\treturn delayedSample;\n\t\t}\n\t}\n');var rQ=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["delayTime","resonance"]))).name="FeedbackCombFilter";var r=_K(n.getDefaults(),arguments,["delayTime","resonance"]);return e.input=new SX({context:e.context}),e.output=new SX({context:e.context}),e.delayTime=new bX({context:e.context,value:r.delayTime,units:"time",minValue:0,maxValue:1,param:e._dummyParam,swappable:!0}),e.resonance=new bX({context:e.context,value:r.resonance,units:"normalRange",param:e._dummyParam,swappable:!0}),GK(m(e),["resonance","delayTime"]),e}return c(n,[{key:"_audioWorkletName",value:function(){return nQ}},{key:"onReady",value:function(e){xX(this.input,e,this.output);var t=e.parameters.get("delayTime");this.delayTime.setParam(t);var n=e.parameters.get("feedback");this.resonance.setParam(n)}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.input.dispose(),this.output.dispose(),this.delayTime.dispose(),this.resonance.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{delayTime:.1,resonance:.5})}}]),n}(tQ),aQ=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["frequency","type"]))).name="OnePoleFilter";var r=_K(n.getDefaults(),arguments,["frequency","type"]);return e._frequency=r.frequency,e._type=r.type,e.input=new SX({context:e.context}),e.output=new SX({context:e.context}),e._createFilter(),e}return c(n,[{key:"_createFilter",value:function(){var e=this,t=this._filter,n=this.toFrequency(this._frequency),r=1/(2*Math.PI*n);if("lowpass"===this._type){var a=1/(r*this.context.sampleRate),i=a-1;this._filter=this.context.createIIRFilter([a,0],[1,i])}else{var o=1/(r*this.context.sampleRate)-1;this._filter=this.context.createIIRFilter([1,-1],[1,o])}this.input.chain(this._filter,this.output),t&&this.context.setTimeout((function(){e.disposed||(e.input.disconnect(t),t.disconnect())}),this.blockTime)}},{key:"frequency",get:function(){return this._frequency},set:function(e){this._frequency=e,this._createFilter()}},{key:"type",get:function(){return this._type},set:function(e){this._type=e,this._createFilter()}},{key:"getFrequencyResponse",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128,t=new Float32Array(e),n=0;n<e;n++){var r=Math.pow(n/e,2),a=19980*r+20;t[n]=a}var i=new Float32Array(e),o=new Float32Array(e);return this._filter.getFrequencyResponse(t,i,o),i}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.input.dispose(),this.output.dispose(),this._filter.disconnect(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{frequency:880,type:"lowpass"})}}]),n}(kX),iQ=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["delayTime","resonance","dampening"]))).name="LowpassCombFilter";var r=_K(n.getDefaults(),arguments,["delayTime","resonance","dampening"]);return e._combFilter=e.output=new rQ({context:e.context,delayTime:r.delayTime,resonance:r.resonance}),e.delayTime=e._combFilter.delayTime,e.resonance=e._combFilter.resonance,e._lowpass=e.input=new aQ({context:e.context,frequency:r.dampening,type:"lowpass"}),e._lowpass.connect(e._combFilter),e}return c(n,[{key:"dampening",get:function(){return this._lowpass.frequency},set:function(e){this._lowpass.frequency=e}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._combFilter.dispose(),this._lowpass.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{dampening:3e3,delayTime:.1,resonance:.5})}}]),n}(kX),oQ=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments))).name="PluckSynth";var r=_K(n.getDefaults(),arguments);return e._noise=new $X({context:e.context,type:"pink"}),e.attackNoise=r.attackNoise,e._lfcf=new iQ({context:e.context,dampening:r.dampening,resonance:r.resonance}),e.resonance=r.resonance,e.release=r.release,e._noise.connect(e._lfcf),e._lfcf.connect(e.output),e}return c(n,[{key:"dampening",get:function(){return this._lfcf.dampening},set:function(e){this._lfcf.dampening=e}},{key:"triggerAttack",value:function(e,t){var n=this.toFrequency(e);t=this.toSeconds(t);var r=1/n;return this._lfcf.delayTime.setValueAtTime(r,t),this._noise.start(t),this._noise.stop(t+r*this.attackNoise),this._lfcf.resonance.cancelScheduledValues(t),this._lfcf.resonance.setValueAtTime(this.resonance,t),this}},{key:"triggerRelease",value:function(e){return this._lfcf.resonance.linearRampTo(0,this.release,e),this}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._noise.dispose(),this._lfcf.dispose(),this}}],[{key:"getDefaults",value:function(){return wK(FY.getDefaults(),{attackNoise:1,dampening:4e3,resonance:.7,release:1})}}]),n}(FY),sQ=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["voice","options"]))).name="PolySynth",e._availableVoices=[],e._activeVoices=[],e._voices=[],e._gcTimeout=-1,e._averageActiveVoices=0;var r=_K(n.getDefaults(),arguments,["voice","options"]);KH(!rK(r.voice),"DEPRECATED: The polyphony count is no longer the first argument.");var a=r.voice.getDefaults();e.options=Object.assign(a,r.options),e.voice=r.voice,e.maxPolyphony=r.maxPolyphony,e._dummyVoice=e._getNextAvailableVoice();var i=e._voices.indexOf(e._dummyVoice);return e._voices.splice(i,1),e._gcTimeout=e.context.setInterval(e._collectGarbage.bind(m(e)),1),e}return c(n,[{key:"activeVoices",get:function(){return this._activeVoices.length}},{key:"_makeVoiceAvailable",value:function(e){this._availableVoices.push(e);var t=this._activeVoices.findIndex((function(t){return t.voice===e}));this._activeVoices.splice(t,1)}},{key:"_getNextAvailableVoice",value:function(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){var e=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return e.connect(this.output),this._voices.push(e),e}ZH("Max polyphony exceeded. Note dropped.")}},{key:"_collectGarbage",value:function(){if(this._averageActiveVoices=Math.max(.95*this._averageActiveVoices,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){var e=this._availableVoices.shift(),t=this._voices.indexOf(e);this._voices.splice(t,1),this.context.isOffline||e.dispose()}}},{key:"_triggerAttack",value:function(e,t,n){var r=this;e.forEach((function(e){var a=new FX(r.context,e).toMidi(),i=r._getNextAvailableVoice();i&&(i.triggerAttack(e,t,n),r._activeVoices.push({midi:a,voice:i,released:!1}),r.log("triggerAttack",e,t))}))}},{key:"_triggerRelease",value:function(e,t){var n=this;e.forEach((function(e){var r=new FX(n.context,e).toMidi(),a=n._activeVoices.find((function(e){var t=e.midi,n=e.released;return t===r&&!n}));a&&(a.voice.triggerRelease(t),a.released=!0,n.log("triggerRelease",e,t))}))}},{key:"_scheduleEvent",value:function(e,t,n,r){var a=this;KH(!this.disposed,"Synth was already disposed"),n<=this.now()?"attack"===e?this._triggerAttack(t,n,r):this._triggerRelease(t,n):this.context.setTimeout((function(){a._scheduleEvent(e,t,n,r)}),n-this.now())}},{key:"triggerAttack",value:function(e,t,n){Array.isArray(e)||(e=[e]);var r=this.toSeconds(t);return this._scheduleEvent("attack",e,r,n),this}},{key:"triggerRelease",value:function(e,t){Array.isArray(e)||(e=[e]);var n=this.toSeconds(t);return this._scheduleEvent("release",e,n),this}},{key:"triggerAttackRelease",value:function(e,t,n,r){var a=this.toSeconds(n);if(this.triggerAttack(e,a,r),oK(t)){KH(oK(e),"If the duration is an array, the notes must also be an array");for(var i=0;i<e.length;i++){var o=t[Math.min(i,t.length-1)],s=this.toSeconds(o);KH(s>0,"The duration must be greater than 0"),this.triggerRelease(e[i],a+s)}}else{var u=this.toSeconds(t);KH(u>0,"The duration must be greater than 0"),this.triggerRelease(e,a+u)}return this}},{key:"sync",value:function(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}},{key:"set",value:function(e){var t=CK(e,["onsilence","context"]);return this.options=wK(this.options,t),this._voices.forEach((function(e){return e.set(t)})),this._dummyVoice.set(t),this}},{key:"get",value:function(){return this._dummyVoice.get()}},{key:"releaseAll",value:function(e){var t=this.toSeconds(e);return this._activeVoices.forEach((function(e){e.voice.triggerRelease(t)})),this}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._dummyVoice.dispose(),this._voices.forEach((function(e){return e.dispose()})),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}],[{key:"getDefaults",value:function(){return Object.assign(FY.getDefaults(),{maxPolyphony:32,options:{},voice:BY})}}]),n}(FY),uQ=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"))).name="Sampler",e._activeSources=new Map;var r=_K(n.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),a={};return Object.keys(r.urls).forEach((function(t){var n=parseInt(t,10);if(KH(uK(t)||rK(n)&&isFinite(n),"url key is neither a note or midi pitch: ".concat(t)),uK(t)){var i=new hX(e.context,t).toMidi();a[i]=r.urls[t]}else rK(n)&&isFinite(n)&&(a[n]=r.urls[n])})),e._buffers=new OX({urls:a,onload:r.onload,baseUrl:r.baseUrl,onerror:r.onerror}),e.attack=r.attack,e.release=r.release,e.curve=r.curve,e._buffers.loaded&&Promise.resolve().then(r.onload),e}return c(n,[{key:"_findClosest",value:function(e){for(var t=0;t<96;){if(this._buffers.has(e+t))return-t;if(this._buffers.has(e-t))return t;t++}throw new Error("No available buffers for note: ".concat(e))}},{key:"triggerAttack",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return this.log("triggerAttack",e,t,r),Array.isArray(e)||(e=[e]),e.forEach((function(e){var a=oX(new hX(n.context,e).toFrequency()),i=Math.round(a),o=a-i,s=n._findClosest(i),u=i-s,c=n._buffers.get(u),l=rX(s+o),h=new QX({url:c,context:n.context,curve:n.curve,fadeIn:n.attack,fadeOut:n.release,playbackRate:l}).connect(n.output);h.start(t,0,c.duration/l,r),oK(n._activeSources.get(i))||n._activeSources.set(i,[]),n._activeSources.get(i).push(h),h.onended=function(){if(n._activeSources&&n._activeSources.has(i)){var e=n._activeSources.get(i),t=e.indexOf(h);-1!==t&&e.splice(t,1)}}})),this}},{key:"triggerRelease",value:function(e,t){var n=this;return this.log("triggerRelease",e,t),Array.isArray(e)||(e=[e]),e.forEach((function(e){var r=new hX(n.context,e).toMidi();if(n._activeSources.has(r)&&n._activeSources.get(r).length){var a=n._activeSources.get(r);t=n.toSeconds(t),a.forEach((function(e){e.stop(t)})),n._activeSources.set(r,[])}})),this}},{key:"releaseAll",value:function(e){var t=this.toSeconds(e);return this._activeSources.forEach((function(e){for(;e.length;){e.shift().stop(t)}})),this}},{key:"sync",value:function(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}},{key:"triggerAttackRelease",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=this.toSeconds(n);return this.triggerAttack(e,i,a),oK(t)?(KH(oK(e),"notes must be an array when duration is array"),e.forEach((function(e,n){var a=t[Math.min(n,t.length-1)];r.triggerRelease(e,i+r.toSeconds(a))}))):this.triggerRelease(e,i+this.toSeconds(t)),this}},{key:"add",value:function(e,t,n){if(KH(uK(e)||isFinite(e),"note must be a pitch or midi: ".concat(e)),uK(e)){var r=new hX(this.context,e).toMidi();this._buffers.add(r,t,n)}else this._buffers.add(e,t,n);return this}},{key:"loaded",get:function(){return this._buffers.loaded}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._buffers.dispose(),this._activeSources.forEach((function(e){e.forEach((function(e){return e.dispose()}))})),this._activeSources.clear(),this}}],[{key:"getDefaults",value:function(){return Object.assign(FY.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:UK,onerror:UK,release:.1,urls:{}})}}]),n}(FY);pK([xY(0)],uQ.prototype,"attack",void 0),pK([xY(0)],uQ.prototype,"release",void 0);var cQ=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["callback","value"]))).name="ToneEvent",e._state=new yX("stopped"),e._startOffset=0;var r=_K(n.getDefaults(),arguments,["callback","value"]);return e._loop=r.loop,e.callback=r.callback,e.value=r.value,e._loopStart=e.toTicks(r.loopStart),e._loopEnd=e.toTicks(r.loopEnd),e._playbackRate=r.playbackRate,e._probability=r.probability,e._humanize=r.humanize,e.mute=r.mute,e._playbackRate=r.playbackRate,e._state.increasing=!0,e._rescheduleEvents(),e}return c(n,[{key:"_rescheduleEvents",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._state.forEachFrom(t,(function(t){var n;if("started"===t.state){-1!==t.id&&e.context.transport.clear(t.id);var r=t.time+Math.round(e.startOffset/e._playbackRate);if(!0===e._loop||rK(e._loop)&&e._loop>1){n=1/0,rK(e._loop)&&(n=e._loop*e._getLoopDuration());var a=e._state.getAfter(r);null!==a&&(n=Math.min(n,a.time-r)),n!==1/0&&(e._state.setStateAtTime("stopped",r+n+1,{id:-1}),n=new zX(e.context,n));var i=new zX(e.context,e._getLoopDuration());t.id=e.context.transport.scheduleRepeat(e._tick.bind(e),i,new zX(e.context,r),n)}else t.id=e.context.transport.schedule(e._tick.bind(e),new zX(e.context,r))}}))}},{key:"state",get:function(){return this._state.getValueAtTime(this.context.transport.ticks)}},{key:"startOffset",get:function(){return this._startOffset},set:function(e){this._startOffset=e}},{key:"probability",get:function(){return this._probability},set:function(e){this._probability=e}},{key:"humanize",get:function(){return this._humanize},set:function(e){this._humanize=e}},{key:"start",value:function(e){var t=this.toTicks(e);return"stopped"===this._state.getValueAtTime(t)&&(this._state.add({id:-1,state:"started",time:t}),this._rescheduleEvents(t)),this}},{key:"stop",value:function(e){this.cancel(e);var t=this.toTicks(e);if("started"===this._state.getValueAtTime(t)){this._state.setStateAtTime("stopped",t,{id:-1});var n=this._state.getBefore(t),r=t;null!==n&&(r=n.time),this._rescheduleEvents(r)}return this}},{key:"cancel",value:function(e){var t=this;e=SK(e,-1/0);var n=this.toTicks(e);return this._state.forEachFrom(n,(function(e){t.context.transport.clear(e.id)})),this._state.cancel(n),this}},{key:"_tick",value:function(e){var t=this.context.transport.getTicksAtTime(e);if(!this.mute&&"started"===this._state.getValueAtTime(t)){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){var n=.02;iK(this.humanize)||(n=this.toSeconds(this.humanize)),e+=(2*Math.random()-1)*n}this.callback(e,this.value)}}},{key:"_getLoopDuration",value:function(){return Math.round((this._loopEnd-this._loopStart)/this._playbackRate)}},{key:"loop",get:function(){return this._loop},set:function(e){this._loop=e,this._rescheduleEvents()}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(e){this._playbackRate=e,this._rescheduleEvents()}},{key:"loopEnd",get:function(){return new zX(this.context,this._loopEnd).toSeconds()},set:function(e){this._loopEnd=this.toTicks(e),this._loop&&this._rescheduleEvents()}},{key:"loopStart",get:function(){return new zX(this.context,this._loopStart).toSeconds()},set:function(e){this._loopStart=this.toTicks(e),this._loop&&this._rescheduleEvents()}},{key:"progress",get:function(){if(this._loop){var e=this.context.transport.ticks,t=this._state.get(e);if(null!==t&&"started"===t.state){var n=this._getLoopDuration();return(e-t.time)%n/n}return 0}return 0}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.cancel(),this._state.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(gX.getDefaults(),{callback:UK,humanize:!1,loop:!1,loopEnd:"1m",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})}}]),n}(gX),lQ=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["callback","interval"]))).name="Loop";var r=_K(n.getDefaults(),arguments,["callback","interval"]);return e._event=new cQ({context:e.context,callback:e._tick.bind(m(e)),loop:!0,loopEnd:r.interval,playbackRate:r.playbackRate,probability:r.probability}),e.callback=r.callback,e.iterations=r.iterations,e}return c(n,[{key:"start",value:function(e){return this._event.start(e),this}},{key:"stop",value:function(e){return this._event.stop(e),this}},{key:"cancel",value:function(e){return this._event.cancel(e),this}},{key:"_tick",value:function(e){this.callback(e)}},{key:"state",get:function(){return this._event.state}},{key:"progress",get:function(){return this._event.progress}},{key:"interval",get:function(){return this._event.loopEnd},set:function(e){this._event.loopEnd=e}},{key:"playbackRate",get:function(){return this._event.playbackRate},set:function(e){this._event.playbackRate=e}},{key:"humanize",get:function(){return this._event.humanize},set:function(e){this._event.humanize=e}},{key:"probability",get:function(){return this._event.probability},set:function(e){this._event.probability=e}},{key:"mute",get:function(){return this._event.mute},set:function(e){this._event.mute=e}},{key:"iterations",get:function(){return!0===this._event.loop?1/0:this._event.loop},set:function(e){this._event.loop=e===1/0||e}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._event.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(gX.getDefaults(),{interval:"4n",callback:UK,playbackRate:1,iterations:1/0,probability:1,mute:!1,humanize:!1})}}]),n}(gX),hQ=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["callback","events"]))).name="Part",e._state=new yX("stopped"),e._events=new Set;var r=_K(n.getDefaults(),arguments,["callback","events"]);return e._state.increasing=!0,r.events.forEach((function(t){oK(t)?e.add(t[0],t[1]):e.add(t)})),e}return c(n,[{key:"start",value:function(e,t){var n=this,r=this.toTicks(e);if("started"!==this._state.getValueAtTime(r)){t=SK(t,this._loop?this._loopStart:0),t=this._loop?SK(t,this._loopStart):SK(t,0);var a=this.toTicks(t);this._state.add({id:-1,offset:a,state:"started",time:r}),this._forEach((function(e){n._startNote(e,r,a)}))}return this}},{key:"_startNote",value:function(e,t,n){t-=n,this._loop?e.startOffset>=this._loopStart&&e.startOffset<this._loopEnd?(e.startOffset<n&&(t+=this._getLoopDuration()),e.start(new zX(this.context,t))):e.startOffset<this._loopStart&&e.startOffset>=n&&(e.loop=!1,e.start(new zX(this.context,t))):e.startOffset>=n&&e.start(new zX(this.context,t))}},{key:"startOffset",get:function(){return this._startOffset},set:function(e){var t=this;this._startOffset=e,this._forEach((function(e){e.startOffset+=t._startOffset}))}},{key:"stop",value:function(e){var t=this.toTicks(e);return this._state.cancel(t),this._state.setStateAtTime("stopped",t),this._forEach((function(t){t.stop(e)})),this}},{key:"at",value:function(e,t){for(var n=new mX(this.context,e).toTicks(),r=new zX(this.context,1).toSeconds(),a=this._events.values(),i=a.next();!i.done;){var o=i.value;if(Math.abs(n-o.startOffset)<r)return tK(t)&&(o.value=t),o;i=a.next()}return tK(t)?(this.add(e,t),this.at(e)):null}},{key:"add",value:function(e,t){e instanceof Object&&Reflect.has(e,"time")&&(e=(t=e).time);var n,r=this.toTicks(e);return t instanceof cQ?(n=t).callback=this._tick.bind(this):n=new cQ({callback:this._tick.bind(this),context:this.context,value:t}),n.startOffset=r,n.set({humanize:this.humanize,loop:this.loop,loopEnd:this.loopEnd,loopStart:this.loopStart,playbackRate:this.playbackRate,probability:this.probability}),this._events.add(n),this._restartEvent(n),this}},{key:"_restartEvent",value:function(e){var t=this;this._state.forEach((function(n){"started"===n.state?t._startNote(e,n.time,n.offset):e.stop(new zX(t.context,n.time))}))}},{key:"remove",value:function(e,t){var n=this;return aK(e)&&e.hasOwnProperty("time")&&(e=(t=e).time),e=this.toTicks(e),this._events.forEach((function(r){r.startOffset===e&&(eK(t)||tK(t)&&r.value===t)&&(n._events.delete(r),r.dispose())})),this}},{key:"clear",value:function(){return this._forEach((function(e){return e.dispose()})),this._events.clear(),this}},{key:"cancel",value:function(e){return this._forEach((function(t){return t.cancel(e)})),this._state.cancel(this.toTicks(e)),this}},{key:"_forEach",value:function(e){return this._events&&this._events.forEach((function(t){t instanceof n?t._forEach(e):e(t)})),this}},{key:"_setAll",value:function(e,t){this._forEach((function(n){n[e]=t}))}},{key:"_tick",value:function(e,t){this.mute||this.callback(e,t)}},{key:"_testLoopBoundries",value:function(e){this._loop&&(e.startOffset<this._loopStart||e.startOffset>=this._loopEnd)?e.cancel(0):"stopped"===e.state&&this._restartEvent(e)}},{key:"probability",get:function(){return this._probability},set:function(e){this._probability=e,this._setAll("probability",e)}},{key:"humanize",get:function(){return this._humanize},set:function(e){this._humanize=e,this._setAll("humanize",e)}},{key:"loop",get:function(){return this._loop},set:function(e){var t=this;this._loop=e,this._forEach((function(n){n.loopStart=t.loopStart,n.loopEnd=t.loopEnd,n.loop=e,t._testLoopBoundries(n)}))}},{key:"loopEnd",get:function(){return new zX(this.context,this._loopEnd).toSeconds()},set:function(e){var t=this;this._loopEnd=this.toTicks(e),this._loop&&this._forEach((function(n){n.loopEnd=e,t._testLoopBoundries(n)}))}},{key:"loopStart",get:function(){return new zX(this.context,this._loopStart).toSeconds()},set:function(e){var t=this;this._loopStart=this.toTicks(e),this._loop&&this._forEach((function(e){e.loopStart=t.loopStart,t._testLoopBoundries(e)}))}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(e){this._playbackRate=e,this._setAll("playbackRate",e)}},{key:"length",get:function(){return this._events.size}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.clear(),this}}],[{key:"getDefaults",value:function(){return Object.assign(cQ.getDefaults(),{events:[]})}}]),n}(cQ),fQ=x().mark(wQ),pQ=x().mark(_Q),dQ=x().mark(SQ),mQ=x().mark(TQ),vQ=x().mark(EQ),gQ=x().mark(IQ),yQ=x().mark(AQ),bQ=x().mark(NQ),kQ=x().mark(PQ),xQ=x().mark(MQ);function wQ(e){var t;return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t=0;case 1:if(!(t<e.length)){n.next=8;break}return t=CQ(t,e),n.next=5,e[t];case 5:t++,n.next=1;break;case 8:case"end":return n.stop()}}),fQ)}function _Q(e){var t;return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t=e.length-1;case 1:if(!(t>=0)){n.next=8;break}return t=CQ(t,e),n.next=5,e[t];case 5:t--,n.next=1;break;case 8:case"end":return n.stop()}}),pQ)}function SQ(e,t){return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.delegateYield(t(e),"t0",2);case 2:n.next=0;break;case 4:case"end":return n.stop()}}),dQ)}function CQ(e,t){return MK(e,0,t.length-1)}function TQ(e,t){var n;return x().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=t?0:e.length-1;case 1:return n=CQ(n,e),r.next=5,e[n];case 5:t?++n>=e.length-1&&(t=!1):--n<=0&&(t=!0),r.next=1;break;case 8:case"end":return r.stop()}}),mQ)}function EQ(e){var t,n;return x().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t=0,n=0;case 2:if(!(t<e.length)){r.next=10;break}return t=CQ(t,e),r.next=6,e[t];case 6:n++,t+=n%2?2:-1,r.next=2;break;case 10:case"end":return r.stop()}}),vQ)}function IQ(e){var t,n;return x().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t=e.length-1,n=0;case 2:if(!(t>=0)){r.next=10;break}return t=CQ(t,e),r.next=6,e[t];case 6:n++,t+=n%2?-2:1,r.next=2;break;case 10:case"end":return r.stop()}}),gQ)}function AQ(e){var t;return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=Math.floor(Math.random()*e.length),n.next=4,e[t];case 4:n.next=0;break;case 6:case"end":return n.stop()}}),yQ)}function NQ(e){var t,n,r,a;return x().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:for(t=[],n=0;n<e.length;n++)t.push(n);case 2:if(!(t.length>0)){i.next=9;break}return r=t.splice(Math.floor(t.length*Math.random()),1),a=CQ(r[0],e),i.next=7,e[a];case 7:i.next=2;break;case 9:case"end":return i.stop()}}),bQ)}function PQ(e){var t;return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t=Math.floor(Math.random()*e.length);case 1:return 0===t?t++:t===e.length-1||Math.random()<.5?t--:t++,n.next=5,e[t];case 5:n.next=1;break;case 7:case"end":return n.stop()}}),kQ)}function MQ(e){var t,n=arguments;return x().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t=n.length>1&&void 0!==n[1]?n[1]:"up",n.length>2&&void 0!==n[2]?n[2]:0,KH(e.length>0,"The array must have more than one value in it"),r.t0=t,r.next="up"===r.t0?6:"down"===r.t0?7:"upDown"===r.t0?8:"downUp"===r.t0?9:"alternateUp"===r.t0?10:"alternateDown"===r.t0?11:"random"===r.t0?12:"randomOnce"===r.t0?13:"randomWalk"===r.t0?14:15;break;case 6:return r.delegateYield(SQ(e,wQ),"t1",7);case 7:return r.delegateYield(SQ(e,_Q),"t2",8);case 8:return r.delegateYield(TQ(e,!0),"t3",9);case 9:return r.delegateYield(TQ(e,!1),"t4",10);case 10:return r.delegateYield(SQ(e,EQ),"t5",11);case 11:return r.delegateYield(SQ(e,IQ),"t6",12);case 12:return r.delegateYield(AQ(e),"t7",13);case 13:return r.delegateYield(SQ(e,NQ),"t8",14);case 14:return r.delegateYield(PQ(e),"t9",15);case 15:case"end":return r.stop()}}),xQ)}var DQ=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["callback","values","pattern"]))).name="Pattern";var r=_K(n.getDefaults(),arguments,["callback","values","pattern"]);return e.callback=r.callback,e._values=r.values,e._pattern=MQ(r.values,r.pattern),e._type=r.pattern,e}return c(n,[{key:"_tick",value:function(e){var t=this._pattern.next();this._value=t.value,this.callback(e,this._value)}},{key:"values",get:function(){return this._values},set:function(e){this._values=e,this.pattern=this._type}},{key:"value",get:function(){return this._value}},{key:"pattern",get:function(){return this._type},set:function(e){this._type=e,this._pattern=MQ(this._values,this._type)}}],[{key:"getDefaults",value:function(){return Object.assign(lQ.getDefaults(),{pattern:"up",values:[],callback:UK})}}]),n}(lQ),RQ=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["callback","events","subdivision"]))).name="Sequence",e._part=new hQ({callback:e._seqCallback.bind(m(e)),context:e.context}),e._events=[],e._eventsArray=[];var r=_K(n.getDefaults(),arguments,["callback","events","subdivision"]);return e._subdivision=e.toTicks(r.subdivision),e.events=r.events,e.loop=r.loop,e.loopStart=r.loopStart,e.loopEnd=r.loopEnd,e.playbackRate=r.playbackRate,e.probability=r.probability,e.humanize=r.humanize,e.mute=r.mute,e.playbackRate=r.playbackRate,e}return c(n,[{key:"_seqCallback",value:function(e,t){null!==t&&this.callback(e,t)}},{key:"events",get:function(){return this._events},set:function(e){this.clear(),this._eventsArray=e,this._events=this._createSequence(this._eventsArray),this._eventsUpdated()}},{key:"start",value:function(e,t){return this._part.start(e,t?this._indexTime(t):t),this}},{key:"stop",value:function(e){return this._part.stop(e),this}},{key:"subdivision",get:function(){return new zX(this.context,this._subdivision).toSeconds()}},{key:"_createSequence",value:function(e){var t=this;return new Proxy(e,{get:function(e,t){return e[t]},set:function(e,n,r){return sK(n)&&isFinite(parseInt(n,10))&&oK(r)?e[n]=t._createSequence(r):e[n]=r,t._eventsUpdated(),!0}})}},{key:"_eventsUpdated",value:function(){this._part.clear(),this._rescheduleSequence(this._eventsArray,this._subdivision,this.startOffset),this.loopEnd=this.loopEnd}},{key:"_rescheduleSequence",value:function(e,t,n){var r=this;e.forEach((function(e,a){var i=a*t+n;if(oK(e))r._rescheduleSequence(e,t/e.length,i);else{var o=new zX(r.context,i,"i").toSeconds();r._part.add(o,e)}}))}},{key:"_indexTime",value:function(e){return new zX(this.context,e*this._subdivision+this.startOffset).toSeconds()}},{key:"clear",value:function(){return this._part.clear(),this}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._part.dispose(),this}},{key:"loop",get:function(){return this._part.loop},set:function(e){this._part.loop=e}},{key:"loopStart",get:function(){return this._loopStart},set:function(e){this._loopStart=e,this._part.loopStart=this._indexTime(e)}},{key:"loopEnd",get:function(){return this._loopEnd},set:function(e){this._loopEnd=e,this._part.loopEnd=0===e?this._indexTime(this._eventsArray.length):this._indexTime(e)}},{key:"startOffset",get:function(){return this._part.startOffset},set:function(e){this._part.startOffset=e}},{key:"playbackRate",get:function(){return this._part.playbackRate},set:function(e){this._part.playbackRate=e}},{key:"probability",get:function(){return this._part.probability},set:function(e){this._part.probability=e}},{key:"progress",get:function(){return this._part.progress}},{key:"humanize",get:function(){return this._part.humanize},set:function(e){this._part.humanize=e}},{key:"length",get:function(){return this._part.length}}],[{key:"getDefaults",value:function(){return Object.assign(CK(cQ.getDefaults(),["value"]),{events:[],loop:!0,loopEnd:0,loopStart:0,subdivision:"8n"})}}]),n}(cQ),OQ=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,Object.assign(_K(n.getDefaults(),arguments,["fade"])))).name="CrossFade",e._panner=e.context.createStereoPanner(),e._split=e.context.createChannelSplitter(2),e._g2a=new TY({context:e.context}),e.a=new SX({context:e.context,gain:0}),e.b=new SX({context:e.context,gain:0}),e.output=new SX({context:e.context}),e._internalChannels=[e.a,e.b];var r=_K(n.getDefaults(),arguments,["fade"]);return e.fade=new EX({context:e.context,units:"normalRange",value:r.fade}),GK(m(e),"fade"),e.context.getConstant(1).connect(e._panner),e._panner.connect(e._split),e._panner.channelCount=1,e._panner.channelCountMode="explicit",wX(e._split,e.a.gain,0),wX(e._split,e.b.gain,1),e.fade.chain(e._g2a,e._panner.pan),e.a.connect(e.output),e.b.connect(e.output),e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{fade:.5})}}]),n}(kX),FQ=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).name="Effect",r._dryWet=new OQ({context:r.context}),r.wet=r._dryWet.fade,r.effectSend=new SX({context:r.context}),r.effectReturn=new SX({context:r.context}),r.input=new SX({context:r.context}),r.output=r._dryWet,r.input.fan(r._dryWet.a,r.effectSend),r.effectReturn.connect(r._dryWet.b),r.wet.setValueAtTime(e.wet,0),r._internalChannels=[r.effectReturn,r.effectSend],GK(m(r),"wet"),r}return c(n,[{key:"connectEffect",value:function(e){return this._internalChannels.push(e),this.effectSend.chain(e,this.effectReturn),this}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{wet:1})}}]),n}(kX),LQ=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).name="LFOEffect",r._lfo=new bY({context:r.context,frequency:e.frequency,amplitude:e.depth}),r.depth=r._lfo.amplitude,r.frequency=r._lfo.frequency,r.type=e.type,GK(m(r),["frequency","depth"]),r}return c(n,[{key:"start",value:function(e){return this._lfo.start(e),this}},{key:"stop",value:function(e){return this._lfo.stop(e),this}},{key:"sync",value:function(){return this._lfo.sync(),this}},{key:"unsync",value:function(){return this._lfo.unsync(),this}},{key:"type",get:function(){return this._lfo.type},set:function(e){this._lfo.type=e}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(FQ.getDefaults(),{frequency:1,type:"sine",depth:1})}}]),n}(FQ),zQ=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["frequency","baseFrequency","octaves"]))).name="AutoFilter";var r=_K(n.getDefaults(),arguments,["frequency","baseFrequency","octaves"]);return e.filter=new GY(Object.assign(r.filter,{context:e.context})),e.connectEffect(e.filter),e._lfo.connect(e.filter.frequency),e.octaves=r.octaves,e.baseFrequency=r.baseFrequency,e}return c(n,[{key:"baseFrequency",get:function(){return this._lfo.min},set:function(e){this._lfo.min=this.toFrequency(e),this.octaves=this._octaves}},{key:"octaves",get:function(){return this._octaves},set:function(e){this._octaves=e,this._lfo.max=this._lfo.min*Math.pow(2,e)}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.filter.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(LQ.getDefaults(),{baseFrequency:200,octaves:2.6,filter:{type:"lowpass",rolloff:-12,Q:1}})}}]),n}(LQ),BQ=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,Object.assign(_K(n.getDefaults(),arguments,["pan"])))).name="Panner",e._panner=e.context.createStereoPanner(),e.input=e._panner,e.output=e._panner;var r=_K(n.getDefaults(),arguments,["pan"]);return e.pan=new bX({context:e.context,param:e._panner.pan,value:r.pan,minValue:-1,maxValue:1}),e._panner.channelCount=r.channelCount,e._panner.channelCountMode="explicit",GK(m(e),"pan"),e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._panner.disconnect(),this.pan.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{pan:0,channelCount:1})}}]),n}(kX),VQ=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["frequency"]))).name="AutoPanner";var r=_K(n.getDefaults(),arguments,["frequency"]);return e._panner=new BQ({context:e.context,channelCount:r.channelCount}),e.connectEffect(e._panner),e._lfo.connect(e._panner.pan),e._lfo.min=-1,e._lfo.max=1,e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._panner.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(LQ.getDefaults(),{channelCount:1})}}]),n}(LQ),jQ=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["smoothing"]))).name="Follower";var r=_K(n.getDefaults(),arguments,["smoothing"]);return e._abs=e.input=new CY({context:e.context}),e._lowpass=e.output=new aQ({context:e.context,frequency:1/e.toSeconds(r.smoothing),type:"lowpass"}),e._abs.connect(e._lowpass),e._smoothing=r.smoothing,e}return c(n,[{key:"smoothing",get:function(){return this._smoothing},set:function(e){this._smoothing=e,this._lowpass.frequency=1/this.toSeconds(this.smoothing)}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._abs.dispose(),this._lowpass.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{smoothing:.05})}}]),n}(kX),qQ=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"]))).name="AutoWah";var r=_K(n.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"]);return e._follower=new jQ({context:e.context,smoothing:r.follower}),e._sweepRange=new MY({context:e.context,min:0,max:1,exponent:.5}),e._baseFrequency=e.toFrequency(r.baseFrequency),e._octaves=r.octaves,e._inputBoost=new SX({context:e.context}),e._bandpass=new GY({context:e.context,rolloff:-48,frequency:0,Q:r.Q}),e._peaking=new GY({context:e.context,type:"peaking"}),e._peaking.gain.value=r.gain,e.gain=e._peaking.gain,e.Q=e._bandpass.Q,e.effectSend.chain(e._inputBoost,e._follower,e._sweepRange),e._sweepRange.connect(e._bandpass.frequency),e._sweepRange.connect(e._peaking.frequency),e.effectSend.chain(e._bandpass,e._peaking,e.effectReturn),e._setSweepRange(),e.sensitivity=r.sensitivity,GK(m(e),["gain","Q"]),e}return c(n,[{key:"octaves",get:function(){return this._octaves},set:function(e){this._octaves=e,this._setSweepRange()}},{key:"follower",get:function(){return this._follower.smoothing},set:function(e){this._follower.smoothing=e}},{key:"baseFrequency",get:function(){return this._baseFrequency},set:function(e){this._baseFrequency=this.toFrequency(e),this._setSweepRange()}},{key:"sensitivity",get:function(){return nX(1/this._inputBoost.gain.value)},set:function(e){this._inputBoost.gain.value=1/tX(e)}},{key:"_setSweepRange",value:function(){this._sweepRange.min=this._baseFrequency,this._sweepRange.max=Math.min(this._baseFrequency*Math.pow(2,this._octaves),this.context.sampleRate/2)}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._follower.dispose(),this._sweepRange.dispose(),this._bandpass.dispose(),this._peaking.dispose(),this._inputBoost.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(FQ.getDefaults(),{baseFrequency:100,octaves:6,sensitivity:0,Q:2,gain:2,follower:.2})}}]),n}(FQ),GQ="bit-crusher";eQ(GQ,"\n\tclass BitCrusherWorklet extends SingleIOProcessor {\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: \"bits\",\n\t\t\t\tdefaultValue: 12,\n\t\t\t\tminValue: 1,\n\t\t\t\tmaxValue: 16,\n\t\t\t\tautomationRate: 'k-rate'\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, _channel, parameters) {\n\t\t\tconst step = Math.pow(0.5, parameters.bits - 1);\n\t\t\tconst val = step * Math.floor(input / step + 0.5);\n\t\t\treturn val;\n\t\t}\n\t}\n");var WQ=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["bits"]))).name="BitCrusher";var r=_K(n.getDefaults(),arguments,["bits"]);return e._bitCrusherWorklet=new UQ({context:e.context,bits:r.bits}),e.connectEffect(e._bitCrusherWorklet),e.bits=e._bitCrusherWorklet.bits,e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._bitCrusherWorklet.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(FQ.getDefaults(),{bits:4})}}]),n}(FQ),UQ=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments))).name="BitCrusherWorklet";var r=_K(n.getDefaults(),arguments);return e.input=new SX({context:e.context}),e.output=new SX({context:e.context}),e.bits=new bX({context:e.context,value:r.bits,units:"positive",minValue:1,maxValue:16,param:e._dummyParam,swappable:!0}),e}return c(n,[{key:"_audioWorkletName",value:function(){return GQ}},{key:"onReady",value:function(e){xX(this.input,e,this.output);var t=e.parameters.get("bits");this.bits.setParam(t)}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.input.dispose(),this.output.dispose(),this.bits.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(tQ.getDefaults(),{bits:12})}}]),n}(tQ),HQ=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["order"]))).name="Chebyshev";var r=_K(n.getDefaults(),arguments,["order"]);return e._shaper=new oY({context:e.context,length:4096}),e._order=r.order,e.connectEffect(e._shaper),e.order=r.order,e.oversample=r.oversample,e}return c(n,[{key:"_getCoefficient",value:function(e,t,n){return n.has(t)||(0===t?n.set(t,0):1===t?n.set(t,e):n.set(t,2*e*this._getCoefficient(e,t-1,n)-this._getCoefficient(e,t-2,n))),n.get(t)}},{key:"order",get:function(){return this._order},set:function(e){var t=this;this._order=e,this._shaper.setMap((function(n){return t._getCoefficient(n,e,new Map)}))}},{key:"oversample",get:function(){return this._shaper.oversample},set:function(e){this._shaper.oversample=e}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._shaper.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(FQ.getDefaults(),{order:1,oversample:"none"})}}]),n}(FQ),KQ=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["channels"]))).name="Split";var r=_K(n.getDefaults(),arguments,["channels"]);return e._splitter=e.input=e.output=e.context.createChannelSplitter(r.channels),e._internalChannels=[e._splitter],e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._splitter.disconnect(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{channels:2})}}]),n}(kX),XQ=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["channels"]))).name="Merge";var r=_K(n.getDefaults(),arguments,["channels"]);return e._merger=e.output=e.input=e.context.createChannelMerger(r.channels),e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._merger.disconnect(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{channels:2})}}]),n}(kX),YQ=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).name="StereoEffect",r.input=new SX({context:r.context}),r.input.channelCount=2,r.input.channelCountMode="explicit",r._dryWet=r.output=new OQ({context:r.context,fade:e.wet}),r.wet=r._dryWet.fade,r._split=new KQ({context:r.context,channels:2}),r._merge=new XQ({context:r.context,channels:2}),r.input.connect(r._split),r.input.connect(r._dryWet.a),r._merge.connect(r._dryWet.b),GK(m(r),["wet"]),r}return c(n,[{key:"connectEffectLeft",value:function(){var e;this._split.connect(arguments.length<=0?void 0:arguments[0],0,0),xX.apply(void 0,arguments),wX((e=arguments.length-1)<0||arguments.length<=e?void 0:arguments[e],this._merge,0,0)}},{key:"connectEffectRight",value:function(){var e;this._split.connect(arguments.length<=0?void 0:arguments[0],1,0),xX.apply(void 0,arguments),wX((e=arguments.length-1)<0||arguments.length<=e?void 0:arguments[e],this._merge,0,1)}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._dryWet.dispose(),this._split.dispose(),this._merge.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{wet:1})}}]),n}(kX),QQ=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).feedback=new EX({context:r.context,value:e.feedback,units:"normalRange"}),r._feedbackL=new SX({context:r.context}),r._feedbackR=new SX({context:r.context}),r._feedbackSplit=new KQ({context:r.context,channels:2}),r._feedbackMerge=new XQ({context:r.context,channels:2}),r._merge.connect(r._feedbackSplit),r._feedbackMerge.connect(r._split),r._feedbackSplit.connect(r._feedbackL,0,0),r._feedbackL.connect(r._feedbackMerge,0,0),r._feedbackSplit.connect(r._feedbackR,1,0),r._feedbackR.connect(r._feedbackMerge,0,1),r.feedback.fan(r._feedbackL.gain,r._feedbackR.gain),GK(m(r),["feedback"]),r}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.feedback.dispose(),this._feedbackL.dispose(),this._feedbackR.dispose(),this._feedbackSplit.dispose(),this._feedbackMerge.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(YQ.getDefaults(),{feedback:.5})}}]),n}(YQ),$Q=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["frequency","delayTime","depth"]))).name="Chorus";var r=_K(n.getDefaults(),arguments,["frequency","delayTime","depth"]);return e._depth=r.depth,e._delayTime=r.delayTime/1e3,e._lfoL=new bY({context:e.context,frequency:r.frequency,min:0,max:1}),e._lfoR=new bY({context:e.context,frequency:r.frequency,min:0,max:1,phase:180}),e._delayNodeL=new DX({context:e.context}),e._delayNodeR=new DX({context:e.context}),e.frequency=e._lfoL.frequency,GK(m(e),["frequency"]),e._lfoL.frequency.connect(e._lfoR.frequency),e.connectEffectLeft(e._delayNodeL),e.connectEffectRight(e._delayNodeR),e._lfoL.connect(e._delayNodeL.delayTime),e._lfoR.connect(e._delayNodeR.delayTime),e.depth=e._depth,e.type=r.type,e.spread=r.spread,e}return c(n,[{key:"depth",get:function(){return this._depth},set:function(e){this._depth=e;var t=this._delayTime*e;this._lfoL.min=Math.max(this._delayTime-t,0),this._lfoL.max=this._delayTime+t,this._lfoR.min=Math.max(this._delayTime-t,0),this._lfoR.max=this._delayTime+t}},{key:"delayTime",get:function(){return 1e3*this._delayTime},set:function(e){this._delayTime=e/1e3,this.depth=this._depth}},{key:"type",get:function(){return this._lfoL.type},set:function(e){this._lfoL.type=e,this._lfoR.type=e}},{key:"spread",get:function(){return this._lfoR.phase-this._lfoL.phase},set:function(e){this._lfoL.phase=90-e/2,this._lfoR.phase=e/2+90}},{key:"start",value:function(e){return this._lfoL.start(e),this._lfoR.start(e),this}},{key:"stop",value:function(e){return this._lfoL.stop(e),this._lfoR.stop(e),this}},{key:"sync",value:function(){return this._lfoL.sync(),this._lfoR.sync(),this}},{key:"unsync",value:function(){return this._lfoL.unsync(),this._lfoR.unsync(),this}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._lfoL.dispose(),this._lfoR.dispose(),this._delayNodeL.dispose(),this._delayNodeR.dispose(),this.frequency.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(QQ.getDefaults(),{frequency:1.5,delayTime:3.5,depth:.7,type:"sine",spread:180,feedback:0,wet:.5})}}]),n}(QQ),JQ=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["distortion"]))).name="Distortion";var r=_K(n.getDefaults(),arguments,["distortion"]);return e._shaper=new oY({context:e.context,length:4096}),e._distortion=r.distortion,e.connectEffect(e._shaper),e.distortion=r.distortion,e.oversample=r.oversample,e}return c(n,[{key:"distortion",get:function(){return this._distortion},set:function(e){this._distortion=e;var t=100*e,n=Math.PI/180;this._shaper.setMap((function(e){return Math.abs(e)<.001?0:(3+t)*e*20*n/(Math.PI+t*Math.abs(e))}))}},{key:"oversample",get:function(){return this._shaper.oversample},set:function(e){this._shaper.oversample=e}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._shaper.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(FQ.getDefaults(),{distortion:.4,oversample:"none"})}}]),n}(FQ),ZQ=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).name="FeedbackEffect",r._feedbackGain=new SX({context:r.context,gain:e.feedback,units:"normalRange"}),r.feedback=r._feedbackGain.gain,GK(m(r),"feedback"),r.effectReturn.chain(r._feedbackGain,r.effectSend),r}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._feedbackGain.dispose(),this.feedback.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(FQ.getDefaults(),{feedback:.125})}}]),n}(FQ),e$=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["delayTime","feedback"]))).name="FeedbackDelay";var r=_K(n.getDefaults(),arguments,["delayTime","feedback"]);return e._delayNode=new DX({context:e.context,delayTime:r.delayTime,maxDelay:r.maxDelay}),e.delayTime=e._delayNode.delayTime,e.connectEffect(e._delayNode),GK(m(e),"delayTime"),e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._delayNode.dispose(),this.delayTime.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(ZQ.getDefaults(),{delayTime:.25,maxDelay:1})}}]),n}(ZQ),t$=function(e){h(n,e);var t=g(n);function n(e){var r;s(this,n),(r=t.call(this,e)).name="PhaseShiftAllpass",r.input=new SX({context:r.context}),r.output=new SX({context:r.context}),r.offset90=new SX({context:r.context});return r._bank0=r._createAllPassFilterBank([.6923878,.9360654322959,.988229522686,.9987488452737]),r._bank1=r._createAllPassFilterBank([.4021921162426,.856171088242,.9722909545651,.9952884791278]),r._oneSampleDelay=r.context.createIIRFilter([0,1],[1,0]),xX.apply(void 0,[r.input].concat(Fn(r._bank0),[r._oneSampleDelay,r.output])),xX.apply(void 0,[r.input].concat(Fn(r._bank1),[r.offset90])),r}return c(n,[{key:"_createAllPassFilterBank",value:function(e){var t=this;return e.map((function(e){var n=[[e*e,0,-1],[1,0,-e*e]];return t.context.createIIRFilter(n[0],n[1])}))}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.input.dispose(),this.output.dispose(),this.offset90.dispose(),this._bank0.forEach((function(e){return e.disconnect()})),this._bank1.forEach((function(e){return e.disconnect()})),this._oneSampleDelay.disconnect(),this}}]),n}(kX),n$=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["frequency"]))).name="FrequencyShifter";var r=_K(n.getDefaults(),arguments,["frequency"]);e.frequency=new EX({context:e.context,units:"frequency",value:r.frequency,minValue:-e.context.sampleRate/2,maxValue:e.context.sampleRate/2}),e._sine=new rY({context:e.context,type:"sine"}),e._cosine=new aY({context:e.context,phase:-90,type:"sine"}),e._sineMultiply=new uY({context:e.context}),e._cosineMultiply=new uY({context:e.context}),e._negate=new EY({context:e.context}),e._add=new vY({context:e.context}),e._phaseShifter=new t$({context:e.context}),e.effectSend.connect(e._phaseShifter),e.frequency.fan(e._sine.frequency,e._cosine.frequency),e._phaseShifter.offset90.connect(e._cosineMultiply),e._cosine.connect(e._cosineMultiply.factor),e._phaseShifter.connect(e._sineMultiply),e._sine.connect(e._sineMultiply.factor),e._sineMultiply.connect(e._negate),e._cosineMultiply.connect(e._add),e._negate.connect(e._add.addend),e._add.connect(e.effectReturn);var a=e.immediate();return e._sine.start(a),e._cosine.start(a),e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.frequency.dispose(),this._add.dispose(),this._cosine.dispose(),this._cosineMultiply.dispose(),this._negate.dispose(),this._phaseShifter.dispose(),this._sine.dispose(),this._sineMultiply.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(FQ.getDefaults(),{frequency:0})}}]),n}(FQ),r$=[1557/44100,1617/44100,1491/44100,1422/44100,1277/44100,1356/44100,1188/44100,1116/44100],a$=[225,556,441,341],i$=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["roomSize","dampening"]))).name="Freeverb",e._combFilters=[],e._allpassFiltersL=[],e._allpassFiltersR=[];var r=_K(n.getDefaults(),arguments,["roomSize","dampening"]);return e.roomSize=new EX({context:e.context,value:r.roomSize,units:"normalRange"}),e._allpassFiltersL=a$.map((function(t){var n=e.context.createBiquadFilter();return n.type="allpass",n.frequency.value=t,n})),e._allpassFiltersR=a$.map((function(t){var n=e.context.createBiquadFilter();return n.type="allpass",n.frequency.value=t,n})),e._combFilters=r$.map((function(t,n){var a,i,o=new iQ({context:e.context,dampening:r.dampening,delayTime:t});n<r$.length/2?(a=e).connectEffectLeft.apply(a,[o].concat(Fn(e._allpassFiltersL))):(i=e).connectEffectRight.apply(i,[o].concat(Fn(e._allpassFiltersR)));return e.roomSize.connect(o.resonance),o})),GK(m(e),["roomSize"]),e}return c(n,[{key:"dampening",get:function(){return this._combFilters[0].dampening},set:function(e){this._combFilters.forEach((function(t){return t.dampening=e}))}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._allpassFiltersL.forEach((function(e){return e.disconnect()})),this._allpassFiltersR.forEach((function(e){return e.disconnect()})),this._combFilters.forEach((function(e){return e.dispose()})),this.roomSize.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(YQ.getDefaults(),{roomSize:.7,dampening:3e3})}}]),n}(YQ),o$=[.06748,.06404,.08212,.09004],s$=[.773,.802,.753,.733],u$=[347,113,37],c$=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["roomSize"]))).name="JCReverb",e._allpassFilters=[],e._feedbackCombFilters=[];var r=_K(n.getDefaults(),arguments,["roomSize"]);return e.roomSize=new EX({context:e.context,value:r.roomSize,units:"normalRange"}),e._scaleRoomSize=new gY({context:e.context,min:-.733,max:.197}),e._allpassFilters=u$.map((function(t){var n=e.context.createBiquadFilter();return n.type="allpass",n.frequency.value=t,n})),e._feedbackCombFilters=o$.map((function(t,n){var r,a,i=new rQ({context:e.context,delayTime:t});(e._scaleRoomSize.connect(i.resonance),i.resonance.value=s$[n],n<o$.length/2)?(r=e).connectEffectLeft.apply(r,Fn(e._allpassFilters).concat([i])):(a=e).connectEffectRight.apply(a,Fn(e._allpassFilters).concat([i]));return i})),e.roomSize.connect(e._scaleRoomSize),GK(m(e),["roomSize"]),e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._allpassFilters.forEach((function(e){return e.disconnect()})),this._feedbackCombFilters.forEach((function(e){return e.dispose()})),this.roomSize.dispose(),this._scaleRoomSize.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(YQ.getDefaults(),{roomSize:.5})}}]),n}(YQ),l$=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,e))._feedbackL.disconnect(),r._feedbackL.connect(r._feedbackMerge,0,1),r._feedbackR.disconnect(),r._feedbackR.connect(r._feedbackMerge,0,0),GK(m(r),["feedback"]),r}return c(n)}(QQ),h$=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["delayTime","feedback"]))).name="PingPongDelay";var r=_K(n.getDefaults(),arguments,["delayTime","feedback"]);return e._leftDelay=new DX({context:e.context,maxDelay:r.maxDelay}),e._rightDelay=new DX({context:e.context,maxDelay:r.maxDelay}),e._rightPreDelay=new DX({context:e.context,maxDelay:r.maxDelay}),e.delayTime=new EX({context:e.context,units:"time",value:r.delayTime}),e.connectEffectLeft(e._leftDelay),e.connectEffectRight(e._rightPreDelay,e._rightDelay),e.delayTime.fan(e._leftDelay.delayTime,e._rightDelay.delayTime,e._rightPreDelay.delayTime),e._feedbackL.disconnect(),e._feedbackL.connect(e._rightDelay),GK(m(e),["delayTime"]),e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._leftDelay.dispose(),this._rightDelay.dispose(),this._rightPreDelay.dispose(),this.delayTime.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(l$.getDefaults(),{delayTime:.25,maxDelay:1})}}]),n}(l$),f$=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["pitch"]))).name="PitchShift";var r=_K(n.getDefaults(),arguments,["pitch"]);e._frequency=new EX({context:e.context}),e._delayA=new DX({maxDelay:1,context:e.context}),e._lfoA=new bY({context:e.context,min:0,max:.1,type:"sawtooth"}).connect(e._delayA.delayTime),e._delayB=new DX({maxDelay:1,context:e.context}),e._lfoB=new bY({context:e.context,min:0,max:.1,type:"sawtooth",phase:180}).connect(e._delayB.delayTime),e._crossFade=new OQ({context:e.context}),e._crossFadeLFO=new bY({context:e.context,min:0,max:1,type:"triangle",phase:90}).connect(e._crossFade.fade),e._feedbackDelay=new DX({delayTime:r.delayTime,context:e.context}),e.delayTime=e._feedbackDelay.delayTime,GK(m(e),"delayTime"),e._pitch=r.pitch,e._windowSize=r.windowSize,e._delayA.connect(e._crossFade.a),e._delayB.connect(e._crossFade.b),e._frequency.fan(e._lfoA.frequency,e._lfoB.frequency,e._crossFadeLFO.frequency),e.effectSend.fan(e._delayA,e._delayB),e._crossFade.chain(e._feedbackDelay,e.effectReturn);var a=e.now();return e._lfoA.start(a),e._lfoB.start(a),e._crossFadeLFO.start(a),e.windowSize=e._windowSize,e}return c(n,[{key:"pitch",get:function(){return this._pitch},set:function(e){this._pitch=e;var t=0;e<0?(this._lfoA.min=0,this._lfoA.max=this._windowSize,this._lfoB.min=0,this._lfoB.max=this._windowSize,t=rX(e-1)+1):(this._lfoA.min=this._windowSize,this._lfoA.max=0,this._lfoB.min=this._windowSize,this._lfoB.max=0,t=rX(e)-1),this._frequency.value=t*(1.2/this._windowSize)}},{key:"windowSize",get:function(){return this._windowSize},set:function(e){this._windowSize=this.toSeconds(e),this.pitch=this._pitch}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._frequency.dispose(),this._delayA.dispose(),this._delayB.dispose(),this._lfoA.dispose(),this._lfoB.dispose(),this._crossFade.dispose(),this._crossFadeLFO.dispose(),this._feedbackDelay.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(ZQ.getDefaults(),{pitch:0,windowSize:.1,delayTime:0,feedback:0})}}]),n}(ZQ),p$=function(e){h(n,e);var t=g(n);function n(){var e,r,a;s(this,n),(a=t.call(this,_K(n.getDefaults(),arguments,["frequency","octaves","baseFrequency"]))).name="Phaser";var i=_K(n.getDefaults(),arguments,["frequency","octaves","baseFrequency"]);return a._lfoL=new bY({context:a.context,frequency:i.frequency,min:0,max:1}),a._lfoR=new bY({context:a.context,frequency:i.frequency,min:0,max:1,phase:180}),a._baseFrequency=a.toFrequency(i.baseFrequency),a._octaves=i.octaves,a.Q=new EX({context:a.context,value:i.Q,units:"positive"}),a._filtersL=a._makeFilters(i.stages,a._lfoL),a._filtersR=a._makeFilters(i.stages,a._lfoR),a.frequency=a._lfoL.frequency,a.frequency.value=i.frequency,(e=a).connectEffectLeft.apply(e,Fn(a._filtersL)),(r=a).connectEffectRight.apply(r,Fn(a._filtersR)),a._lfoL.frequency.connect(a._lfoR.frequency),a.baseFrequency=i.baseFrequency,a.octaves=i.octaves,a._lfoL.start(),a._lfoR.start(),GK(m(a),["frequency","Q"]),a}return c(n,[{key:"_makeFilters",value:function(e,t){for(var n=[],r=0;r<e;r++){var a=this.context.createBiquadFilter();a.type="allpass",this.Q.connect(a.Q),t.connect(a.frequency),n.push(a)}return n}},{key:"octaves",get:function(){return this._octaves},set:function(e){this._octaves=e;var t=this._baseFrequency*Math.pow(2,e);this._lfoL.max=t,this._lfoR.max=t}},{key:"baseFrequency",get:function(){return this._baseFrequency},set:function(e){this._baseFrequency=this.toFrequency(e),this._lfoL.min=this._baseFrequency,this._lfoR.min=this._baseFrequency,this.octaves=this._octaves}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.Q.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._filtersL.forEach((function(e){return e.disconnect()})),this._filtersR.forEach((function(e){return e.disconnect()})),this.frequency.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(YQ.getDefaults(),{frequency:.5,octaves:3,stages:10,Q:10,baseFrequency:350})}}]),n}(YQ),d$=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["decay"]))).name="Reverb",e._convolver=e.context.createConvolver(),e.ready=Promise.resolve();var r=_K(n.getDefaults(),arguments,["decay"]);return e._decay=r.decay,e._preDelay=r.preDelay,e.generate(),e.connectEffect(e._convolver),e}return c(n,[{key:"decay",get:function(){return this._decay},set:function(e){XH(e=this.toSeconds(e),.001),this._decay=e,this.generate()}},{key:"preDelay",get:function(){return this._preDelay},set:function(e){XH(e=this.toSeconds(e),0),this._preDelay=e,this.generate()}},{key:"generate",value:function(){return dK(this,void 0,void 0,x().mark((function e(){var t,n,r,a,i,o,s;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.ready,n=new KK(2,this._decay+this._preDelay,this.context.sampleRate),r=new $X({context:n}),a=new $X({context:n}),i=new XQ({context:n}),r.connect(i,0,0),a.connect(i,0,1),o=new SX({context:n}).toDestination(),i.connect(o),r.start(0),a.start(0),o.gain.setValueAtTime(0,0),o.gain.setValueAtTime(1,this._preDelay),o.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay),s=n.render(),this.ready=s.then(UK),e.next=18,t;case 18:return e.next=20,s;case 20:return this._convolver.buffer=e.sent.get(),e.abrupt("return",this);case 22:case"end":return e.stop()}}),e,this)})))}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._convolver.disconnect(),this}}],[{key:"getDefaults",value:function(){return Object.assign(FQ.getDefaults(),{decay:1.5,preDelay:.01})}}]),n}(FQ),m$=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments))).name="MidSideSplit",e._split=e.input=new KQ({channels:2,context:e.context}),e._midAdd=new vY({context:e.context}),e.mid=new uY({context:e.context,value:Math.SQRT1_2}),e._sideSubtract=new IY({context:e.context}),e.side=new uY({context:e.context,value:Math.SQRT1_2}),e._split.connect(e._midAdd,0),e._split.connect(e._midAdd.addend,1),e._split.connect(e._sideSubtract,0),e._split.connect(e._sideSubtract.subtrahend,1),e._midAdd.connect(e.mid),e._sideSubtract.connect(e.side),e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.mid.dispose(),this.side.dispose(),this._midAdd.dispose(),this._sideSubtract.dispose(),this._split.dispose(),this}}]),n}(kX),v$=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments))).name="MidSideMerge",e.mid=new SX({context:e.context}),e.side=new SX({context:e.context}),e._left=new vY({context:e.context}),e._leftMult=new uY({context:e.context,value:Math.SQRT1_2}),e._right=new IY({context:e.context}),e._rightMult=new uY({context:e.context,value:Math.SQRT1_2}),e._merge=e.output=new XQ({context:e.context}),e.mid.fan(e._left),e.side.connect(e._left.addend),e.mid.connect(e._right),e.side.connect(e._right.subtrahend),e._left.connect(e._leftMult),e._right.connect(e._rightMult),e._leftMult.connect(e._merge,0,0),e._rightMult.connect(e._merge,0,1),e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.mid.dispose(),this.side.dispose(),this._leftMult.dispose(),this._rightMult.dispose(),this._left.dispose(),this._right.dispose(),this}}]),n}(kX),g$=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).name="MidSideEffect",r._midSideMerge=new v$({context:r.context}),r._midSideSplit=new m$({context:r.context}),r._midSend=r._midSideSplit.mid,r._sideSend=r._midSideSplit.side,r._midReturn=r._midSideMerge.mid,r._sideReturn=r._midSideMerge.side,r.effectSend.connect(r._midSideSplit),r._midSideMerge.connect(r.effectReturn),r}return c(n,[{key:"connectEffectMid",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=this._midSend).chain.apply(e,n.concat([this._midReturn]))}},{key:"connectEffectSide",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=this._sideSend).chain.apply(e,n.concat([this._sideReturn]))}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this._midSend.dispose(),this._sideSend.dispose(),this._midReturn.dispose(),this._sideReturn.dispose(),this}}]),n}(FQ),y$=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["width"]))).name="StereoWidener";var r=_K(n.getDefaults(),arguments,["width"]);return e.width=new EX({context:e.context,value:r.width,units:"normalRange"}),GK(m(e),["width"]),e._twoTimesWidthMid=new uY({context:e.context,value:2}),e._twoTimesWidthSide=new uY({context:e.context,value:2}),e._midMult=new uY({context:e.context}),e._twoTimesWidthMid.connect(e._midMult.factor),e.connectEffectMid(e._midMult),e._oneMinusWidth=new IY({context:e.context}),e._oneMinusWidth.connect(e._twoTimesWidthMid),wX(e.context.getConstant(1),e._oneMinusWidth),e.width.connect(e._oneMinusWidth.subtrahend),e._sideMult=new uY({context:e.context}),e.width.connect(e._twoTimesWidthSide),e._twoTimesWidthSide.connect(e._sideMult.factor),e.connectEffectSide(e._sideMult),e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.width.dispose(),this._midMult.dispose(),this._sideMult.dispose(),this._twoTimesWidthMid.dispose(),this._twoTimesWidthSide.dispose(),this._oneMinusWidth.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(g$.getDefaults(),{width:.5})}}]),n}(g$),b$=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["frequency","depth"]))).name="Tremolo";var r=_K(n.getDefaults(),arguments,["frequency","depth"]);return e._lfoL=new bY({context:e.context,type:r.type,min:1,max:0}),e._lfoR=new bY({context:e.context,type:r.type,min:1,max:0}),e._amplitudeL=new SX({context:e.context}),e._amplitudeR=new SX({context:e.context}),e.frequency=new EX({context:e.context,value:r.frequency,units:"frequency"}),e.depth=new EX({context:e.context,value:r.depth,units:"normalRange"}),GK(m(e),["frequency","depth"]),e.connectEffectLeft(e._amplitudeL),e.connectEffectRight(e._amplitudeR),e._lfoL.connect(e._amplitudeL.gain),e._lfoR.connect(e._amplitudeR.gain),e.frequency.fan(e._lfoL.frequency,e._lfoR.frequency),e.depth.fan(e._lfoR.amplitude,e._lfoL.amplitude),e.spread=r.spread,e}return c(n,[{key:"start",value:function(e){return this._lfoL.start(e),this._lfoR.start(e),this}},{key:"stop",value:function(e){return this._lfoL.stop(e),this._lfoR.stop(e),this}},{key:"sync",value:function(){return this._lfoL.sync(),this._lfoR.sync(),this.context.transport.syncSignal(this.frequency),this}},{key:"unsync",value:function(){return this._lfoL.unsync(),this._lfoR.unsync(),this.context.transport.unsyncSignal(this.frequency),this}},{key:"type",get:function(){return this._lfoL.type},set:function(e){this._lfoL.type=e,this._lfoR.type=e}},{key:"spread",get:function(){return this._lfoR.phase-this._lfoL.phase},set:function(e){this._lfoL.phase=90-e/2,this._lfoR.phase=e/2+90}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._lfoL.dispose(),this._lfoR.dispose(),this._amplitudeL.dispose(),this._amplitudeR.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(YQ.getDefaults(),{frequency:10,type:"sine",depth:.5,spread:180})}}]),n}(YQ),k$=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["frequency","depth"]))).name="Vibrato";var r=_K(n.getDefaults(),arguments,["frequency","depth"]);return e._delayNode=new DX({context:e.context,delayTime:0,maxDelay:r.maxDelay}),e._lfo=new bY({context:e.context,type:r.type,min:0,max:r.maxDelay,frequency:r.frequency,phase:-90}).start().connect(e._delayNode.delayTime),e.frequency=e._lfo.frequency,e.depth=e._lfo.amplitude,e.depth.value=r.depth,GK(m(e),["frequency","depth"]),e.effectSend.chain(e._delayNode,e.effectReturn),e}return c(n,[{key:"type",get:function(){return this._lfo.type},set:function(e){this._lfo.type=e}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._delayNode.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(FQ.getDefaults(),{maxDelay:.005,frequency:5,depth:.1,type:"sine"})}}]),n}(FQ),x$=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["type","size"]))).name="Analyser",e._analysers=[],e._buffers=[];var r=_K(n.getDefaults(),arguments,["type","size"]);e.input=e.output=e._gain=new SX({context:e.context}),e._split=new KQ({context:e.context,channels:r.channels}),e.input.connect(e._split),XH(r.channels,1);for(var a=0;a<r.channels;a++)e._analysers[a]=e.context.createAnalyser(),e._split.connect(e._analysers[a],a,0);return e.size=r.size,e.type=r.type,e}return c(n,[{key:"getValue",value:function(){var e=this;return this._analysers.forEach((function(t,n){var r=e._buffers[n];"fft"===e._type?t.getFloatFrequencyData(r):"waveform"===e._type&&t.getFloatTimeDomainData(r)})),1===this.channels?this._buffers[0]:this._buffers}},{key:"size",get:function(){return this._analysers[0].frequencyBinCount},set:function(e){var t=this;this._analysers.forEach((function(n,r){n.fftSize=2*e,t._buffers[r]=new Float32Array(e)}))}},{key:"channels",get:function(){return this._analysers.length}},{key:"type",get:function(){return this._type},set:function(e){KH("waveform"===e||"fft"===e,"Analyser: invalid type: ".concat(e)),this._type=e}},{key:"smoothing",get:function(){return this._analysers[0].smoothingTimeConstant},set:function(e){this._analysers.forEach((function(t){return t.smoothingTimeConstant=e}))}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._analysers.forEach((function(e){return e.disconnect()})),this._split.dispose(),this._gain.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{size:1024,smoothing:.8,type:"fft",channels:1})}}]),n}(kX),w$=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments))).name="MeterBase",e.input=e.output=e._analyser=new x$({context:e.context,size:256,type:"waveform"}),e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._analyser.dispose(),this}}]),n}(kX),_$=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["smoothing"]))).name="Meter",e._rms=0;var r=_K(n.getDefaults(),arguments,["smoothing"]);return e.input=e.output=e._analyser=new x$({context:e.context,size:256,type:"waveform",channels:r.channels}),e.smoothing=r.smoothing,e.normalRange=r.normalRange,e}return c(n,[{key:"getLevel",value:function(){return ZH("'getLevel' has been changed to 'getValue'"),this.getValue()}},{key:"getValue",value:function(){var e=this,t=this._analyser.getValue(),n=(1===this.channels?[t]:t).map((function(t){var n=t.reduce((function(e,t){return e+t*t}),0),r=Math.sqrt(n/t.length);return e._rms=Math.max(r,e._rms*e.smoothing),e.normalRange?e._rms:nX(e._rms)}));return 1===this.channels?n[0]:n}},{key:"channels",get:function(){return this._analyser.channels}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._analyser.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(w$.getDefaults(),{smoothing:.8,normalRange:!1,channels:1})}}]),n}(w$),S$=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["size"]))).name="FFT";var r=_K(n.getDefaults(),arguments,["size"]);return e.normalRange=r.normalRange,e._analyser.type="fft",e.size=r.size,e}return c(n,[{key:"getValue",value:function(){var e=this;return this._analyser.getValue().map((function(t){return e.normalRange?tX(t):t}))}},{key:"size",get:function(){return this._analyser.size},set:function(e){this._analyser.size=e}},{key:"smoothing",get:function(){return this._analyser.smoothing},set:function(e){this._analyser.smoothing=e}},{key:"getFrequencyOfIndex",value:function(e){return KH(0<=e&&e<this.size,"index must be greater than or equal to 0 and less than ".concat(this.size)),e*this.context.sampleRate/(2*this.size)}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{normalRange:!1,size:1024,smoothing:.8})}}]),n}(w$),C$=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments))).name="DCMeter",e._analyser.type="waveform",e._analyser.size=256,e}return c(n,[{key:"getValue",value:function(){return this._analyser.getValue()[0]}}]),n}(w$),T$=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["size"]))).name="Waveform";var r=_K(n.getDefaults(),arguments,["size"]);return e._analyser.type="waveform",e.size=r.size,e}return c(n,[{key:"getValue",value:function(){return this._analyser.getValue()}},{key:"size",get:function(){return this._analyser.size},set:function(e){this._analyser.size=e}}],[{key:"getDefaults",value:function(){return Object.assign(w$.getDefaults(),{size:1024})}}]),n}(w$),E$=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["solo"]))).name="Solo";var r=_K(n.getDefaults(),arguments,["solo"]);return e.input=e.output=new SX({context:e.context}),n._allSolos.has(e.context)||n._allSolos.set(e.context,new Set),n._allSolos.get(e.context).add(m(e)),e.solo=r.solo,e}return c(n,[{key:"solo",get:function(){return this._isSoloed()},set:function(e){e?this._addSolo():this._removeSolo(),n._allSolos.get(this.context).forEach((function(e){return e._updateSolo()}))}},{key:"muted",get:function(){return 0===this.input.gain.value}},{key:"_addSolo",value:function(){n._soloed.has(this.context)||n._soloed.set(this.context,new Set),n._soloed.get(this.context).add(this)}},{key:"_removeSolo",value:function(){n._soloed.has(this.context)&&n._soloed.get(this.context).delete(this)}},{key:"_isSoloed",value:function(){return n._soloed.has(this.context)&&n._soloed.get(this.context).has(this)}},{key:"_noSolos",value:function(){return!n._soloed.has(this.context)||n._soloed.has(this.context)&&0===n._soloed.get(this.context).size}},{key:"_updateSolo",value:function(){this._isSoloed()||this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),n._allSolos.get(this.context).delete(this),this._removeSolo(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{solo:!1})}}]),n}(kX);E$._allSolos=new Map,E$._soloed=new Map;var I$=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["pan","volume"]))).name="PanVol";var r=_K(n.getDefaults(),arguments,["pan","volume"]);return e._panner=e.input=new BQ({context:e.context,pan:r.pan,channelCount:r.channelCount}),e.pan=e._panner.pan,e._volume=e.output=new GX({context:e.context,volume:r.volume}),e.volume=e._volume.volume,e._panner.connect(e._volume),e.mute=r.mute,GK(m(e),["pan","volume"]),e}return c(n,[{key:"mute",get:function(){return this._volume.mute},set:function(e){this._volume.mute=e}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}}]),n}(kX),A$=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["volume","pan"]))).name="Channel";var r=_K(n.getDefaults(),arguments,["volume","pan"]);return e._solo=e.input=new E$({solo:r.solo,context:e.context}),e._panVol=e.output=new I$({context:e.context,pan:r.pan,volume:r.volume,mute:r.mute,channelCount:r.channelCount}),e.pan=e._panVol.pan,e.volume=e._panVol.volume,e._solo.connect(e._panVol),GK(m(e),["pan","volume"]),e}return c(n,[{key:"solo",get:function(){return this._solo.solo},set:function(e){this._solo.solo=e}},{key:"muted",get:function(){return this._solo.muted||this.mute}},{key:"mute",get:function(){return this._panVol.mute},set:function(e){this._panVol.mute=e}},{key:"_getBus",value:function(e){return n.buses.has(e)||n.buses.set(e,new SX({context:this.context})),n.buses.get(e)}},{key:"send",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this._getBus(e),r=new SX({context:this.context,units:"decibels",gain:t});return this.connect(r),r.connect(n),r}},{key:"receive",value:function(e){return this._getBus(e).connect(this),this}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}}]),n}(kX);A$.buses=new Map;var N$=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments))).name="Mono",e.input=new SX({context:e.context}),e._merge=e.output=new XQ({channels:2,context:e.context}),e.input.connect(e._merge,0,0),e.input.connect(e._merge,0,1),e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._merge.dispose(),this.input.dispose(),this}}]),n}(kX),P$=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["lowFrequency","highFrequency"]))).name="MultibandSplit",e.input=new SX({context:e.context}),e.output=void 0,e.low=new GY({context:e.context,frequency:0,type:"lowpass"}),e._lowMidFilter=new GY({context:e.context,frequency:0,type:"highpass"}),e.mid=new GY({context:e.context,frequency:0,type:"lowpass"}),e.high=new GY({context:e.context,frequency:0,type:"highpass"}),e._internalChannels=[e.low,e.mid,e.high];var r=_K(n.getDefaults(),arguments,["lowFrequency","highFrequency"]);return e.lowFrequency=new EX({context:e.context,units:"frequency",value:r.lowFrequency}),e.highFrequency=new EX({context:e.context,units:"frequency",value:r.highFrequency}),e.Q=new EX({context:e.context,units:"positive",value:r.Q}),e.input.fan(e.low,e.high),e.input.chain(e._lowMidFilter,e.mid),e.lowFrequency.fan(e.low.frequency,e._lowMidFilter.frequency),e.highFrequency.fan(e.mid.frequency,e.high.frequency),e.Q.connect(e.low.Q),e.Q.connect(e._lowMidFilter.Q),e.Q.connect(e.mid.Q),e.Q.connect(e.high.Q),GK(m(e),["high","mid","low","highFrequency","lowFrequency"]),e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),WK(this,["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this._lowMidFilter.dispose(),this.mid.dispose(),this.high.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this.Q.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{Q:1,highFrequency:2500,lowFrequency:400})}}]),n}(kX),M$=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.apply(this,arguments)).name="Listener",e.positionX=new bX({context:e.context,param:e.context.rawContext.listener.positionX}),e.positionY=new bX({context:e.context,param:e.context.rawContext.listener.positionY}),e.positionZ=new bX({context:e.context,param:e.context.rawContext.listener.positionZ}),e.forwardX=new bX({context:e.context,param:e.context.rawContext.listener.forwardX}),e.forwardY=new bX({context:e.context,param:e.context.rawContext.listener.forwardY}),e.forwardZ=new bX({context:e.context,param:e.context.rawContext.listener.forwardZ}),e.upX=new bX({context:e.context,param:e.context.rawContext.listener.upX}),e.upY=new bX({context:e.context,param:e.context.rawContext.listener.upY}),e.upZ=new bX({context:e.context,param:e.context.rawContext.listener.upZ}),e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}}]),n}(kX);OK((function(e){e.listener=new M$({context:e})})),LK((function(e){e.listener.dispose()}));var D$=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["positionX","positionY","positionZ"]))).name="Panner3D";var r=_K(n.getDefaults(),arguments,["positionX","positionY","positionZ"]);return e._panner=e.input=e.output=e.context.createPanner(),e.panningModel=r.panningModel,e.maxDistance=r.maxDistance,e.distanceModel=r.distanceModel,e.coneOuterGain=r.coneOuterGain,e.coneOuterAngle=r.coneOuterAngle,e.coneInnerAngle=r.coneInnerAngle,e.refDistance=r.refDistance,e.rolloffFactor=r.rolloffFactor,e.positionX=new bX({context:e.context,param:e._panner.positionX,value:r.positionX}),e.positionY=new bX({context:e.context,param:e._panner.positionY,value:r.positionY}),e.positionZ=new bX({context:e.context,param:e._panner.positionZ,value:r.positionZ}),e.orientationX=new bX({context:e.context,param:e._panner.orientationX,value:r.orientationX}),e.orientationY=new bX({context:e.context,param:e._panner.orientationY,value:r.orientationY}),e.orientationZ=new bX({context:e.context,param:e._panner.orientationZ,value:r.orientationZ}),e}return c(n,[{key:"setPosition",value:function(e,t,n){return this.positionX.value=e,this.positionY.value=t,this.positionZ.value=n,this}},{key:"setOrientation",value:function(e,t,n){return this.orientationX.value=e,this.orientationY.value=t,this.orientationZ.value=n,this}},{key:"panningModel",get:function(){return this._panner.panningModel},set:function(e){this._panner.panningModel=e}},{key:"refDistance",get:function(){return this._panner.refDistance},set:function(e){this._panner.refDistance=e}},{key:"rolloffFactor",get:function(){return this._panner.rolloffFactor},set:function(e){this._panner.rolloffFactor=e}},{key:"distanceModel",get:function(){return this._panner.distanceModel},set:function(e){this._panner.distanceModel=e}},{key:"coneInnerAngle",get:function(){return this._panner.coneInnerAngle},set:function(e){this._panner.coneInnerAngle=e}},{key:"coneOuterAngle",get:function(){return this._panner.coneOuterAngle},set:function(e){this._panner.coneOuterAngle=e}},{key:"coneOuterGain",get:function(){return this._panner.coneOuterGain},set:function(e){this._panner.coneOuterGain=e}},{key:"maxDistance",get:function(){return this._panner.maxDistance},set:function(e){this._panner.maxDistance=e}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._panner.disconnect(),this.orientationX.dispose(),this.orientationY.dispose(),this.orientationZ.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:0,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1})}}]),n}(kX),R$=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments))).name="Recorder";var r=_K(n.getDefaults(),arguments);return e.input=new SX({context:e.context}),KH(n.supported,"Media Recorder API is not available"),e._stream=e.context.createMediaStreamDestination(),e.input.connect(e._stream),e._recorder=new MediaRecorder(e._stream.stream,{mimeType:r.mimeType}),e}return c(n,[{key:"mimeType",get:function(){return this._recorder.mimeType}},{key:"state",get:function(){return"inactive"===this._recorder.state?"stopped":"paused"===this._recorder.state?"paused":"started"}},{key:"start",value:function(){return dK(this,void 0,void 0,x().mark((function e(){var t,n=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return KH("started"!==this.state,"Recorder is already started"),t=new Promise((function(e){n._recorder.addEventListener("start",(function t(){n._recorder.removeEventListener("start",t,!1),e()}),!1)})),this._recorder.start(),e.next=5,t;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"stop",value:function(){return dK(this,void 0,void 0,x().mark((function e(){var t,n=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return KH("stopped"!==this.state,"Recorder is not started"),t=new Promise((function(e){n._recorder.addEventListener("dataavailable",(function t(r){n._recorder.removeEventListener("dataavailable",t,!1),e(r.data)}),!1)})),this._recorder.stop(),e.next=5,t;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"pause",value:function(){return KH("started"===this.state,"Recorder must be started"),this._recorder.pause(),this}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.input.dispose(),this._stream.disconnect(),this}}],[{key:"getDefaults",value:function(){return kX.getDefaults()}},{key:"supported",get:function(){return null!==hK&&Reflect.has(hK,"MediaRecorder")}}]),n}(kX),O$=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["threshold","ratio"]))).name="Compressor",e._compressor=e.context.createDynamicsCompressor(),e.input=e._compressor,e.output=e._compressor;var r=_K(n.getDefaults(),arguments,["threshold","ratio"]);return e.threshold=new bX({minValue:e._compressor.threshold.minValue,maxValue:e._compressor.threshold.maxValue,context:e.context,convert:!1,param:e._compressor.threshold,units:"decibels",value:r.threshold}),e.attack=new bX({minValue:e._compressor.attack.minValue,maxValue:e._compressor.attack.maxValue,context:e.context,param:e._compressor.attack,units:"time",value:r.attack}),e.release=new bX({minValue:e._compressor.release.minValue,maxValue:e._compressor.release.maxValue,context:e.context,param:e._compressor.release,units:"time",value:r.release}),e.knee=new bX({minValue:e._compressor.knee.minValue,maxValue:e._compressor.knee.maxValue,context:e.context,convert:!1,param:e._compressor.knee,units:"decibels",value:r.knee}),e.ratio=new bX({minValue:e._compressor.ratio.minValue,maxValue:e._compressor.ratio.maxValue,context:e.context,convert:!1,param:e._compressor.ratio,units:"positive",value:r.ratio}),GK(m(e),["knee","release","attack","ratio","threshold"]),e}return c(n,[{key:"reduction",get:function(){return this._compressor.reduction}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._compressor.disconnect(),this.attack.dispose(),this.release.dispose(),this.threshold.dispose(),this.ratio.dispose(),this.knee.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{attack:.003,knee:30,ratio:12,release:.25,threshold:-24})}}]),n}(kX),F$=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,Object.assign(_K(n.getDefaults(),arguments,["threshold","smoothing"])))).name="Gate";var r=_K(n.getDefaults(),arguments,["threshold","smoothing"]);return e._follower=new jQ({context:e.context,smoothing:r.smoothing}),e._gt=new NY({context:e.context,value:tX(r.threshold)}),e.input=new SX({context:e.context}),e._gate=e.output=new SX({context:e.context}),e.input.connect(e._gate),e.input.chain(e._follower,e._gt,e._gate.gain),e}return c(n,[{key:"threshold",get:function(){return nX(this._gt.value)},set:function(e){this._gt.value=tX(e)}},{key:"smoothing",get:function(){return this._follower.smoothing},set:function(e){this._follower.smoothing=e}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.input.dispose(),this._follower.dispose(),this._gt.dispose(),this._gate.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{smoothing:.1,threshold:-40})}}]),n}(kX),L$=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,Object.assign(_K(n.getDefaults(),arguments,["threshold"])))).name="Limiter";var r=_K(n.getDefaults(),arguments,["threshold"]);return e._compressor=e.input=e.output=new O$({context:e.context,ratio:20,attack:.003,release:.01,threshold:r.threshold}),e.threshold=e._compressor.threshold,GK(m(e),"threshold"),e}return c(n,[{key:"reduction",get:function(){return this._compressor.reduction}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._compressor.dispose(),this.threshold.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{threshold:-12})}}]),n}(kX),z$=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,Object.assign(_K(n.getDefaults(),arguments)))).name="MidSideCompressor";var r=_K(n.getDefaults(),arguments);return e._midSideSplit=e.input=new m$({context:e.context}),e._midSideMerge=e.output=new v$({context:e.context}),e.mid=new O$(Object.assign(r.mid,{context:e.context})),e.side=new O$(Object.assign(r.side,{context:e.context})),e._midSideSplit.mid.chain(e.mid,e._midSideMerge.mid),e._midSideSplit.side.chain(e.side,e._midSideMerge.side),GK(m(e),["mid","side"]),e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this.mid.dispose(),this.side.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},side:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10}})}}]),n}(kX),B$=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,Object.assign(_K(n.getDefaults(),arguments)))).name="MultibandCompressor";var r=_K(n.getDefaults(),arguments);return e._splitter=e.input=new P$({context:e.context,lowFrequency:r.lowFrequency,highFrequency:r.highFrequency}),e.lowFrequency=e._splitter.lowFrequency,e.highFrequency=e._splitter.highFrequency,e.output=new SX({context:e.context}),e.low=new O$(Object.assign(r.low,{context:e.context})),e.mid=new O$(Object.assign(r.mid,{context:e.context})),e.high=new O$(Object.assign(r.high,{context:e.context})),e._splitter.low.chain(e.low,e.output),e._splitter.mid.chain(e.mid,e.output),e._splitter.high.chain(e.high,e.output),GK(m(e),["high","mid","low","highFrequency","lowFrequency"]),e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._splitter.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.output.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{lowFrequency:250,highFrequency:2e3,low:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10},mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},high:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16}})}}]),n}(kX),V$=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["low","mid","high"]))).name="EQ3",e.output=new SX({context:e.context}),e._internalChannels=[];var r=_K(n.getDefaults(),arguments,["low","mid","high"]);return e.input=e._multibandSplit=new P$({context:e.context,highFrequency:r.highFrequency,lowFrequency:r.lowFrequency}),e._lowGain=new SX({context:e.context,gain:r.low,units:"decibels"}),e._midGain=new SX({context:e.context,gain:r.mid,units:"decibels"}),e._highGain=new SX({context:e.context,gain:r.high,units:"decibels"}),e.low=e._lowGain.gain,e.mid=e._midGain.gain,e.high=e._highGain.gain,e.Q=e._multibandSplit.Q,e.lowFrequency=e._multibandSplit.lowFrequency,e.highFrequency=e._multibandSplit.highFrequency,e._multibandSplit.low.chain(e._lowGain,e.output),e._multibandSplit.mid.chain(e._midGain,e.output),e._multibandSplit.high.chain(e._highGain,e.output),GK(m(e),["low","mid","high","lowFrequency","highFrequency"]),e._internalChannels=[e._multibandSplit],e}return c(n,[{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),WK(this,["low","mid","high","lowFrequency","highFrequency"]),this._multibandSplit.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this._lowGain.dispose(),this._midGain.dispose(),this._highGain.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.Q.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{high:0,highFrequency:2500,low:0,lowFrequency:400,mid:0})}}]),n}(kX),j$=function(e){h(n,e);var t=g(n);function n(){var e;s(this,n),(e=t.call(this,_K(n.getDefaults(),arguments,["url","onload"]))).name="Convolver",e._convolver=e.context.createConvolver();var r=_K(n.getDefaults(),arguments,["url","onload"]);return e._buffer=new HK(r.url,(function(t){e.buffer=t,r.onload()})),e.input=new SX({context:e.context}),e.output=new SX({context:e.context}),e._buffer.loaded&&(e.buffer=e._buffer),e.normalize=r.normalize,e.input.chain(e._convolver,e.output),e}return c(n,[{key:"load",value:function(e){return dK(this,void 0,void 0,x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._buffer.load(e);case 2:this.buffer=t.sent;case 3:case"end":return t.stop()}}),t,this)})))}},{key:"buffer",get:function(){return this._buffer.length?this._buffer:null},set:function(e){e&&this._buffer.set(e),this._convolver.buffer&&(this.input.disconnect(),this._convolver.disconnect(),this._convolver=this.context.createConvolver(),this.input.chain(this._convolver,this.output));var t=this._buffer.get();this._convolver.buffer=t||null}},{key:"normalize",get:function(){return this._convolver.normalize},set:function(e){this._convolver.normalize=e}},{key:"dispose",value:function(){return Rw(f(n.prototype),"dispose",this).call(this),this._buffer.dispose(),this._convolver.disconnect(),this}}],[{key:"getDefaults",value:function(){return Object.assign(kX.getDefaults(),{normalize:!0,onload:UK})}}]),n}(kX);function q$(){return QK().now()}function G$(){return QK().immediate()}var W$=QK().transport;function U$(){return QK().transport}var H$=QK().destination,K$=QK().destination;function X$(){return QK().destination}var Y$=QK().listener;function Q$(){return QK().listener}var $$=QK().draw;function J$(){return QK().draw}var Z$=QK();function eJ(){return HK.loaded()}var tJ=HK,nJ=OX,rJ=QX,aJ=__webpack_require__(1493);Error;function iJ(e){nq(e)&&(e=rq(e));var t=new aJ.Midi;t.fromJSON({header:{name:"",ppq:e.ticksPerQuarter||220,tempos:[],timeSignatures:[],keySignatures:[],meta:[]},tracks:[]});var n=Array.from(e.tempos||[]);0===n.length&&n.push({time:0,qpm:zj}),n.sort((function(e,t){return e.time-t.time}));for(var r=0,a=n;r<a.length;r++){var i=a[r];t.header.tempos.push({ticks:t.header.secondsToTicks(i.time),bpm:i.qpm}),t.header.update()}if(e.timeSignatures&&0!==e.timeSignatures.length){var o,s=zo(e.timeSignatures);try{for(s.s();!(o=s.n()).done;){var u=o.value;t.header.timeSignatures.push({ticks:t.header.secondsToTicks(u.time),timeSignature:[u.numerator,u.denominator]})}}catch(ZJ){s.e(ZJ)}finally{s.f()}}else t.header.timeSignatures.push({ticks:0,timeSignature:[4,4]});t.header.update();var c,l=new Map,h=zo(e.notes);try{for(h.s();!(c=h.n()).done;){var f=c.value,p=f.instrument?f.instrument:0,d=void 0===f.program?0:f.program,m=!!f.isDrum,v=JSON.stringify([p,d,m]);l.has(v)||l.set(v,{notes:[],controlChanges:[]}),l.get(v).notes.push(f)}}catch(ZJ){h.e(ZJ)}finally{h.f()}var g,y=zo(e.controlChanges);try{for(y.s();!(g=y.n()).done;){var b=g.value,k=b.instrument?b.instrument:0,x=void 0===b.program?0:b.program,w=!!b.isDrum,_=JSON.stringify([k,x,w]);l.has(_)||l.set(_,{notes:[],controlChanges:[]}),l.get(_).controlChanges.push(b)}}catch(ZJ){y.e(ZJ)}finally{y.f()}return l.forEach((function(e,n){var r=Ct(JSON.parse(n).slice(1),2),a=r[0],i=r[1],o=t.addTrack();o.channel=i?9:Bj[(t.tracks.length-1)%Bj.length],o.instrument.number=a;var s,u=zo(e.notes);try{for(u.s();!(s=u.n()).done;){var c=s.value,l=void 0===c.velocity?80:c.velocity;o.addNote({midi:c.pitch,time:c.startTime,duration:c.endTime-c.startTime,velocity:(l+1)/128})}}catch(ZJ){u.e(ZJ)}finally{u.f()}var h,f=zo(e.controlChanges);try{for(f.s();!(h=f.n()).done;){var p=h.value;o.addCC({number:p.controlNumber,value:p.controlValue,time:p.time})}}catch(ZJ){f.e(ZJ)}finally{f.f()}})),t.toArray()}function oJ(e,t){return e.quantizedStartStep<t.quantizedStartStep?-1:e.quantizedStartStep>t.quantizedStartStep?1:e.pitch<t.pitch?-1:1}var sJ=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1?arguments[1]:void 0;s(this,e),this.playClick=t,this.callbackObject=n,this.desiredQPM=void 0}return c(e,[{key:"setTempo",value:function(e){this.desiredQPM=e,"started"===W$.state&&(W$.bpm.value=e)}},{key:"makeClickSequence",value:function(e){for(var t=Zj(e),n=t.notes.map((function(e){return e.quantizedEndStep})),r=Math.max.apply(Math,Fn(n)),a=0;a<r;a+=4){var i={pitch:a%16===0?89:90,quantizedStartStep:a,isDrum:!0,quantizedEndStep:a+1};t.notes.push(i)}return t.notes.sort(oJ),t}},{key:"resumeContext",value:function(){Z$.resume()}},{key:"start",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if("started"===this.getPlayState())throw new Error("Cannot start playback; player is already playing.");if("paused"===this.getPlayState())throw new Error("Cannot `start()` a paused player; use `resume()`.");if("stopped"!==W$.state)throw new Error("Cannot start playback while `Tone.Transport` is in use.");this.resumeContext();var a=nq(e);if(this.playClick&&a&&(e=this.makeClickSequence(e)),t?W$.bpm.value=t:e.tempos&&e.tempos.length>0&&e.tempos[0].qpm>0?W$.bpm.value=e.tempos[0].qpm:W$.bpm.value=zj,a)e=rq(e,t);else if(t)throw new Error("Cannot specify a `qpm` for a non-quantized sequence.");var i=new hQ((function(e,t){n.currentPart===i&&(n.playNote(e,t),n.callbackObject&&$$.schedule((function(){n.callbackObject.run(t,e)}),e))}),e.notes.map((function(e){return[e.startTime,e]})));return this.currentPart=i,this.desiredQPM&&(W$.bpm.value=this.desiredQPM),this.currentPart.start(void 0,r),"started"!==W$.state&&W$.start(),new Promise((function(t){n.scheduledStop=W$.schedule((function(){n.stop(),t(),n.callbackObject&&n.callbackObject.stop()}),"+".concat(e.totalTime))}))}},{key:"stop",value:function(){this.isPlaying()&&(this.currentPart.stop(),W$.stop(),this.currentPart=null),W$.clear(this.scheduledStop),this.scheduledStop=void 0,this.desiredQPM=void 0}},{key:"pause",value:function(){if(!this.isPlaying())throw new Error("Cannot pause playback while the player is stopped.");W$.pause()}},{key:"resume",value:function(){if("paused"!==this.getPlayState())throw new Error('Cannot resume playback while "'.concat(this.getPlayState(),'".'));W$.start()}},{key:"seekTo",value:function(e){if(!this.isPlaying())throw new Error("Cannot seek while the player is stopped.");W$.seconds=e}},{key:"isPlaying",value:function(){return!!this.currentPart}},{key:"getPlayState",value:function(){return this.isPlaying()?W$.state:"stopped"}}]),e}(),uJ=function(){function e(){var t=this;s(this,e),this.DRUM_PITCH_TO_CLASS=new Map,this.kick=(new QY).toDestination(),this.tomLow=new QY({pitchDecay:.008,envelope:{attack:.01,decay:.5,sustain:0}}).toDestination(),this.tomMid=new QY({pitchDecay:.008,envelope:{attack:.01,decay:.5,sustain:0}}).toDestination(),this.tomHigh=new QY({pitchDecay:.008,envelope:{attack:.01,decay:.5,sustain:0}}).toDestination(),this.closedHihat=new YY({frequency:400,envelope:{attack:.001,decay:.1,release:.8},harmonicity:5.1,modulationIndex:32,resonance:4e3,octaves:1}).toDestination(),this.openHihat=new YY({frequency:400,envelope:{attack:.001,decay:.5,release:.8,sustain:1},harmonicity:5.1,modulationIndex:32,resonance:4e3,octaves:1}).toDestination(),this.ride=(new YY).toDestination(),this.crash=new YY({frequency:300,envelope:{attack:.001,decay:1,release:3},harmonicity:5.1,modulationIndex:64,resonance:4e3,octaves:1.5}).toDestination(),this.snare=new $Y({noise:{type:"white"},envelope:{attack:.005,decay:.05,sustain:.1,release:.4}}).toDestination(),this.loClick=new QY({pitchDecay:.008,envelope:{attack:.001,decay:.3,sustain:0}}).toDestination(),this.hiClick=new QY({pitchDecay:.008,envelope:{attack:.001,decay:.3,sustain:0}}).toDestination(),this.pitchPlayers=[function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t.kick.triggerAttackRelease("C2","8n",e,n)},function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t.snare.triggerAttackRelease("16n",e,n)},function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t.closedHihat.triggerAttack(e,.3,n)},function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t.openHihat.triggerAttack(e,.3,n)},function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return t.tomLow.triggerAttack("G3",e,n)},function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return t.tomMid.triggerAttack("C4",e,n)},function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return t.tomHigh.triggerAttack("F4",e,n)},function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t.crash.triggerAttack(e,1,n)},function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t.ride.triggerAttack(e,.5,n)},function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return t.loClick.triggerAttack("G5",e,n)},function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return t.hiClick.triggerAttack("C6",e,n)}];for(var n=function(e){Vj[e].forEach((function(n){t.DRUM_PITCH_TO_CLASS.set(n,e)}))},r=0;r<Vj.length;++r)n(r);this.DRUM_PITCH_TO_CLASS.set(89,9),this.DRUM_PITCH_TO_CLASS.set(90,10)}return c(e,[{key:"playNote",value:function(e,t,n){this.pitchPlayers[this.DRUM_PITCH_TO_CLASS.get(e)](t,n)}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),cJ=function(e){h(n,e);var t=g(n);function n(){var e;return s(this,n),(e=t.apply(this,arguments)).drumKit=uJ.getInstance(),e.bassSynth=new BY({volume:5,oscillator:{type:"triangle"}}).toDestination(),e.polySynth=(new sQ).toDestination(),e}return c(n,[{key:"playNote",value:function(e,t){var n=t.hasOwnProperty("velocity")?t.velocity/127:void 0;if(t.isDrum)this.drumKit.playNote(t.pitch,e,n);else{var r=dX(t.pitch,"midi").toFrequency(),a=t.endTime-t.startTime;this.getSynth(t.instrument,t.program).triggerAttackRelease(r,a,e,n)}}},{key:"getSynth",value:function(e,t){return void 0!==t&&t>=32&&t<=39?this.bassSynth:this.polySynth}}]),n}(sJ);cJ.tone=r;var lJ;__webpack_require__(6105);!function(e){e[e.PAGE=0]="PAGE",e[e.NOTE=1]="NOTE",e[e.BAR=2]="BAR"}(lJ||(lJ={}));/iPad|iPhone|iPod/.test(navigator.userAgent);var hJ,fJ;!function(e){e[e.None=0]="None",e[e.C=1]="C",e[e.Cs=2]="Cs",e[e.D=3]="D",e[e.Eb=4]="Eb",e[e.E=5]="E",e[e.F=6]="F",e[e.Fs=7]="Fs",e[e.G=8]="G",e[e.Ab=9]="Ab",e[e.A=10]="A",e[e.Bb=11]="Bb",e[e.B=12]="B"}(hJ||(hJ={})),function(e){e[e.None=0]="None",e[e.Maj=1]="Maj",e[e.Min=2]="Min",e[e.Aug=3]="Aug",e[e.Dim=4]="Dim",e[e.Seven=5]="Seven",e[e.Maj7=6]="Maj7",e[e.Min7=7]="Min7",e[e.Min7b5=8]="Min7b5"}(fJ||(fJ={}));var pJ=__webpack_require__(567),dJ=__webpack_require__(8383),mJ=__webpack_require__(6800),vJ=16e3,gJ=function(e){if(e=Gj?44100:e,Wj)throw new Error("Cannot use offline audio context in a web worker.");var t=qj.webkitOfflineAudioContext;return Gj?new t(1,e,e):new qj.OfflineAudioContext(1,e,e)}(vJ);function yJ(e){return bJ.apply(this,arguments)}function bJ(){return bJ=_(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Kj(t).then((function(e){return e.arrayBuffer()})).then((function(e){return gJ.decodeAudioData(e)})));case 1:case"end":return e.stop()}}),e)}))),bJ.apply(this,arguments)}function kJ(e){return xJ.apply(this,arguments)}function xJ(){return(xJ=_(x().mark((function e(t){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new FileReader,r=new Promise((function(e,r){n.onerror=function(){n.abort(),r(new DOMException("Something went wrong reading that file."))},n.onload=function(){e(n.result)},n.readAsArrayBuffer(t)})),e.abrupt("return",r.then((function(e){return gJ.decodeAudioData(e)})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function wJ(e,t){t.power||(t.power=2);var n=function(e,t){var n=t.nFft||2048,r=t.winLength||n,a=t.hopLength||Math.floor(r/4),i=function(e){for(var t=new Float32Array(e),n=0;n<e;n++)t[n]=.5*(1-Math.cos(2*Math.PI*n/(e-1)));return t}(r);i=function(e,t){if(e.length>t)throw new Error("Data is longer than length.");var n=Math.floor((t-e.length)/2),r=t-e.length-n;return AJ(e,[n,r])}(i,n);for(var o=function(e,t,n){for(var r=Math.floor((e.length-t)/n)+1,a=Array.from({length:r},(function(e,n){return new Float32Array(t)})),i=0;i<r;i++){var o=i*n,s=e.slice(o,o+t);a[i].set(s),s.length}return a}(e=function(e,t){for(var n=AJ(e,t),r=0;r<t;r++)n[r]=n[2*t-r],n[n.length-r-1]=n[n.length-2*t+r-1];return n}(e,Math.floor(n/2)),n,a),s=[],u=o.length,c=n+2,l=0;l<u;l++){var h=new Float32Array(c);s[l]=h}for(var f=0;f<u;f++){var p=NJ(IJ(o[f],i));s[f].set(p.slice(0,c))}return s}(e,t),r=function(e,t){var n=e.map((function(e){return function(e,t){return e.map((function(e){return Math.pow(e,t)}))}(function(e){for(var t=new Float32Array(e.length/2),n=0;n<e.length/2;n++)t[n]=Math.sqrt(e[2*n]*e[2*n]+e[2*n+1]*e[2*n+1]);return t}(e),t)})),r=e[0].length-1;return[n,r]}(n,t.power),a=Ct(r,2),i=a[0],o=a[1];t.nFft=o;var s=function(e){for(var t=e.fMin||0,n=e.fMax||e.sampleRate/2,r=e.nMels||128,a=e.nFft||2048,i=function(e,t){return PJ(0,e/2,Math.floor(1+t/2))}(e.sampleRate,a),o=function(e,t,n){var r=MJ(t),a=MJ(n);return PJ(r,a,e).map((function(e){return function(e){return 700*(Math.exp(e/1125)-1)}(e)}))}(r+2,t,n),s=function(e){for(var t=new Float32Array(e.length-1),n=0;n<e.length;n++)t[n]=e[n+1]-e[n];return t}(o),u=function(e,t){for(var n=[],r=0;r<e.length;r++)n[r]=new Float32Array(t.length);for(var a=0;a<e.length;a++)for(var i=0;i<t.length;i++)n[a][i]=e[a]-t[i];return n}(o,i),c=u[0].length,l=[],h=0;h<r;h++){l[h]=new Float32Array(c);for(var f=0;f<u[h].length;f++){var p=-u[h][f]/s[h],d=u[h+2][f]/s[h+1],m=Math.max(0,Math.min(p,d));l[h][f]=m}}for(var v=function(e){var t=2/(o[2+e]-o[e]);l[e]=l[e].map((function(e){return e*t}))},g=0;g<l.length;g++)v(g);return l}(t);return function(e,t){for(var n=[],r=0;r<e.length;r++)n[r]=EJ(e[r],t);return n}(i,s)}function _J(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:80,r=e.length,a=e[0].length,i=[],o=0;o<r;o++)i[o]=new Float32Array(a);for(var s=0;s<r;s++)for(var u=0;u<a;u++){var c=e[s][u];i[s][u]=10*Math.log10(Math.max(t,c))}if(n){if(n<0)throw new Error("topDb must be non-negative.");for(var l=0;l<r;l++)for(var h=DJ(i[l]),f=0;f<a;f++)i[l][f]=Math.max(i[l][f],h-n)}return i}function SJ(e){if(1===e.numberOfChannels)return e.getChannelData(0);if(2!==e.numberOfChannels)throw Error("".concat(e.numberOfChannels," channel audio is not supported."));for(var t=e.getChannelData(0),n=e.getChannelData(1),r=new Float32Array(e.length),a=0;a<e.length;++a)r[a]=(t[a]+n[a])/2;return r}function CJ(e){return TJ.apply(this,arguments)}function TJ(){return TJ=_(x().mark((function e(t){var n,r,a,i,o,s,u,c=arguments;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=c.length>1&&void 0!==c[1]?c[1]:vJ,t.sampleRate!==n){e.next=3;break}return e.abrupt("return",SJ(t));case 3:if(r=t.sampleRate,a=t.length*n/r,Gj){e.next=14;break}return i=new OfflineAudioContext(t.numberOfChannels,t.duration*n,n),(o=i.createBufferSource()).buffer=t,o.connect(i.destination),o.start(),e.abrupt("return",i.startRendering().then((function(e){return e.getChannelData(0)})));case 14:return Yj("Safari does not support WebAudio resampling, so this may be slow.","O&F",5),s=SJ(t),u=new Float32Array(a),mJ(dJ(u,[a]),dJ(s,[s.length])),e.abrupt("return",u);case 19:case"end":return e.stop()}}),e)}))),TJ.apply(this,arguments)}function EJ(e,t){if(e.length!==t[0].length)throw new Error("Each entry in filterbank should have dimensions "+"matching FFT. |mags| = ".concat(e.length,", ")+"|filterbank[0]| = ".concat(t[0].length,"."));for(var n=new Float32Array(t.length),r=0;r<t.length;r++){var a=IJ(e,t[r]);n[r]=a.reduce((function(e,t){return e+t}))}return n}function IJ(e,t){if(e.length!==t.length)return console.error("Buffer length ".concat(e.length," != window length ").concat(t.length,".")),null;for(var n=new Float32Array(e.length),r=0;r<e.length;r++)n[r]=t[r]*e[r];return n}function AJ(e,t){var n,r;if("object"===typeof t){var a=Ct(t,2);n=a[0],r=a[1]}else n=r=t;var i=new Float32Array(e.length+n+r);return i.set(e,n),i}function NJ(e){var t=new pJ(e.length),n=t.createComplexArray(),r=t.toComplexArray(e);return t.transform(n,r),n}function PJ(e,t,n){for(var r=(t-e)/(n-1),a=new Float32Array(n),i=0;i<n;i++)a[i]=e+r*i;return a}function MJ(e){return 1125*Math.log(1+e/700)}function DJ(e){return e.reduce((function(e,t){return Math.max(e,t)}))}var RJ=16e3,OJ=.032,FJ=88;function LJ(e){return zJ.apply(this,arguments)}function zJ(){return(zJ=_(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,CJ(t);case 2:return n=e.sent,e.abrupt("return",_J(wJ(n,{sampleRate:RJ,hopLength:512,nMels:229,nFft:2048,fMin:30})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function BJ(e,t){var n=Math.ceil(e.length/t),r=e.length%t,a=0;if(n>1&&r>0&&r<=3&&(n-=1,a=r,r=0),1===n)return Em(e).expandDims(0);var i,o=t+6,s=Em(e.slice(0,o)).expandDims(0),u=Em(e.slice(e.length-o)).expandDims(0);if(2===n)return Jp([s,u],0);i=r?Em(e).pad([[0,t-r],[0,0]]).as3D(n,t,-1):Em(e.slice(0,e.length-a)).as3D(n,t,-1);var c=dm(i,[0,t-3],[n-2,-1]),l=dm(i,[2,0],[-1,3]),h=Jp([c,i.slice(1,n-2),l],1);return Jp([s,h,u],0)}function VJ(e,t,n){return 1===e.shape[0]?e:vp((function(){var r=e.slice([0,0],[1,t]),a=n%t;a<=3&&(a+=t);var i=e.slice([e.shape[0]-1,e.shape[1]-a],[-1,-1]),o=[r,i];if(e.shape[0]>2){var s=e.shape[0]-2;o=[r,e.slice([1,3],[s,t]).as3D(1,s*t,-1),i]}return Jp(o,1)}))}function jJ(e,t,n){return qJ.apply(this,arguments)}function qJ(){return qJ=_(x().mark((function e(t,n,r){var a,i,o,s,u,c,l,h,f,p,d,m,v,g,y,b,k,w,_=arguments;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h=function(e,t,n){s[e]?c[e]||(l(e,t),s[e]=t+1,u[e]=n):(s[e]=t+1,u[e]=n)},l=function(e,t){o.notes.push(jj.Note.create({pitch:e+21,startTime:(s[e]-1)*OJ,endTime:t*OJ,velocity:u[e]})),s[e]=0},a=_.length>3&&void 0!==_[3]?_[3]:.5,i=_.length>4&&void 0!==_[4]?_[4]:.5,o=jj.create(),s=new Uint32Array(FJ),u=new Uint8Array(FJ),c=new Uint8Array(FJ),f=vp((function(){var e=wd(n,a),o=wd(t,i);return e=e.pad([[0,1],[0,0]]),o=o.pad([[0,1],[0,0]]),r=r.pad([[0,1],[0,0]]),[o=Dd(o,e),e,r]})),e.next=11,Promise.all(f.map((function(e){return e.data()})));case 11:for(p=e.sent,d=Ct(p,3),m=d[0],v=d[1],g=d[2],f.forEach((function(e){return e.dispose()})),y=t.shape[0],b=0;b<y+1;++b){for(k=0;k<FJ;++k)v[w=b*FJ+k]?h(k,b,g[w]):!m[w]&&s[k]&&l(k,b);c=v.slice(b*FJ,(b+1)*FJ)}return o.totalTime=y*OJ,e.abrupt("return",o);case 21:case"end":return e.stop()}}),e)}))),qJ.apply(this,arguments)}var GJ=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250;s(this,e),this.checkpointURL=t,this.chunkLength=n}return c(e,[{key:"initialize",value:function(){var e=_(x().mark((function e(){var t,n,r=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.dispose(),t=Xj.now(),e.next=4,Kj("".concat(this.checkpointURL,"/weights_manifest.json")).then((function(e){return e.json()})).then((function(e){return Bf(e,r.checkpointURL)}));case 4:n=e.sent,this.build(n),Object.keys(n).map((function(e){return n[e].dispose()})),this.initialized=!0,Qj("Initialized model",t,"O&F");case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dispose",value:function(){this.initialized&&(this.onsetsCnn.dispose(),this.onsetsRnn.dispose(),this.activationCnn.dispose(),this.frameRnn.dispose(),this.velocityCnn.dispose(),this.initialized=!1)}},{key:"isInitialized",value:function(){return this.initialized}},{key:"transcribeFromMelSpec",value:function(){var e=_(x().mark((function e(t){var n,r,a,i,o,s,u,c,l=this,h=arguments;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h.length>1&&void 0!==h[1]?h[1]:4,this.isInitialized()||this.initialize(),r=Xj.now(),Yj("Computing onsets, frames, and velocities...","O&F",20),a=vp((function(){var e=BJ(t,l.chunkLength);return l.processBatches(e,l.chunkLength,t.length,n)})),i=Ct(a,3),o=i[0],s=i[1],u=i[2],Yj("Converting to NoteSequence...","O&F",20),(c=jJ(o,s,u)).then((function(){o.dispose(),s.dispose(),u.dispose(),Qj("Transcribed from mel spec",r,"O&F")})),e.abrupt("return",c);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"transcribeFromAudioBuffer",value:function(){var e=_(x().mark((function e(t){var n,r,a,i=this,o=arguments;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:4,r=Xj.now(),(a=LJ(t)).then((function(){return Qj("Converted audio to mel spec",r,"O&F",20)})),e.abrupt("return",a.then((function(e){return i.transcribeFromMelSpec(e.map((function(e){return Array.from(e)}),n))})));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"transcribeFromAudioFile",value:function(){var e=_(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kJ(t);case 2:return n=e.sent,e.abrupt("return",this.transcribeFromAudioBuffer(n));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"transcribeFromAudioURL",value:function(){var e=_(x().mark((function e(t){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yJ(t);case 2:return n=e.sent,e.abrupt("return",this.transcribeFromAudioBuffer(n));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"processBatches",value:function(e,t,n,r){var a,i,o,s=this,u=function(e){return[s.onsetsCnn.predict(e,r),s.activationCnn.predict(e,r),s.velocityCnn.predict(e,r)]};if(1===e.shape[0]){var c=Ct(u(e.expandDims(-1)),3);a=c[0],i=c[1],o=c[2]}else{for(var l=u(e.expandDims(-1)),h=[],f=0;f<3;++f)h.push(VJ(l[f],t,n));a=h[0],i=h[1],o=h[2]}var p=this.onsetsRnn.predict(a,this.chunkLength);a.dispose();var d=td([p,i],-1);i.dispose();var m=this.frameRnn.predict(d,this.chunkLength),v=$p(o,0,1).mul(xp(80)).add(xp(10)).toInt();return o.dispose(),[m.squeeze(),p.squeeze(),v.squeeze()]}},{key:"build",value:function(e){var t=this;vp((function(){t.onsetsCnn=new WJ,t.onsetsCnn.setWeights(e,"onsets"),t.onsetsRnn=new UJ([null,t.onsetsCnn.outputShape[2]]),t.onsetsRnn.setWeights(e,"onsets","onset_probs"),t.activationCnn=new WJ("sigmoid"),t.activationCnn.setWeights(e,"frame","activation_probs"),t.frameRnn=new UJ([null,176]),t.frameRnn.setWeights(e,"frame","frame_probs"),t.velocityCnn=new WJ("linear"),t.velocityCnn.setWeights(e,"velocity","onset_velocities")}))}}]),e}(),WJ=function(){function e(t){s(this,e),this.nn=oS();var n={filters:48,kernelSize:[3,3],activation:"linear",useBias:!1,padding:"same",dilationRate:[1,1],inputShape:[null,229,1],trainable:!1},r={scale:!1,trainable:!1};this.nn.add(pT(n)),this.nn.add(vT(r)),this.nn.add(dT({activation:"relu"})),n.inputShape=null,this.nn.add(pT(n)),this.nn.add(vT(r)),this.nn.add(dT({activation:"relu"})),this.nn.add(gT({poolSize:[1,2],strides:[1,2]})),n.filters=96,this.nn.add(pT(n)),this.nn.add(vT(r)),this.nn.add(dT({activation:"relu"})),this.nn.add(gT({poolSize:[1,2],strides:[1,2]}));var a,i=this.nn.outputShape;this.nn.add((a={targetShape:[i[1],i[2]*i[3]]},new CC(a))),this.nn.add(mT({units:768,activation:"relu",trainable:!1})),t&&this.nn.add(mT({units:FJ,activation:t,trainable:!1})),this.outputShape=this.nn.outputShape}return c(e,[{key:"dispose",value:function(){this.nn.dispose()}},{key:"predict",value:function(e,t){return this.nn.predict(e,{batchSize:t})}},{key:"setWeights",value:function(e,t,n){function r(t){var n=e[t];if(void 0===n)throw Error("Variable not found: ".concat(t));return n}var a=[r("".concat(t,"/conv0/weights")),r("".concat(t,"/conv0/BatchNorm/beta")),r("".concat(t,"/conv0/BatchNorm/moving_mean")),r("".concat(t,"/conv0/BatchNorm/moving_variance")),r("".concat(t,"/conv1/weights")),r("".concat(t,"/conv1/BatchNorm/beta")),r("".concat(t,"/conv1/BatchNorm/moving_mean")),r("".concat(t,"/conv1/BatchNorm/moving_variance")),r("".concat(t,"/conv2/weights")),r("".concat(t,"/conv2/BatchNorm/beta")),r("".concat(t,"/conv2/BatchNorm/moving_mean")),r("".concat(t,"/conv2/BatchNorm/moving_variance")),r("".concat(t,"/fc_end/weights")),r("".concat(t,"/fc_end/biases"))];n&&(a=a.concat([r("".concat(t,"/").concat(n,"/weights")),r("".concat(t,"/").concat(n,"/biases"))])),this.nn.setWeights(a)}}]),e}(),UJ=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:384;function r(){var e=yT({inputShape:t,units:n,returnSequences:!0,recurrentActivation:"sigmoid",returnState:!0,kernelInitializer:"zeros",recurrentInitializer:"zeros",biasInitializer:"zeros",trainable:!1}),r=[sS({shape:t}),sS({shape:[n]}),sS({shape:[n]})];return iS({inputs:r,outputs:e.apply(r)})}s(this,e),this.dense=oS(),this.units=n,this.lstm=r(),this.dense.add(mT({inputShape:[null,n],units:FJ,activation:"sigmoid",trainable:!1}))}return c(e,[{key:"dispose",value:function(){this.lstm.dispose(),this.dense.dispose()}},{key:"setWeights",value:function(e,t,n){var r=this;function a(t){var n=e[t];if(void 0===n)throw Error("Variable not found: ".concat(t));return n}var i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=xm(e,4,-1),r=Ct(n,4),a=r[0],i=r[1],o=r[2],s=r[3];return Jp([a,o.add(xp(t)),i,s],-1)},o="cudnn_lstm/rnn/multi_rnn_cell/cell_0/cudnn_compatible_lstm_cell";!function(e){return e.setWeights((n=a("".concat(t,"/").concat(o,"/kernel")),xm(i(n),[n.shape[0]-r.units,r.units])).concat(i(a("".concat(t,"/").concat(o,"/bias")),1)));var n}(this.lstm),this.dense.setWeights([a("".concat(t,"/").concat(n,"/weights")),a("".concat(t,"/").concat(n,"/biases"))])}},{key:"predict",value:function(e,t){var n=this;return vp((function(){return n.predictImpl(e,t)}))}},{key:"predictImpl",value:function(e,t){for(var n=e.shape[1],r=Math.ceil(n/t),a=[Jd([1,this.units]),Jd([1,this.units])],i=[],o=0;o<r;++o){var s=e.slice([0,o*t],[-1,o<r-1?t:-1]),u=this.lstm.predict([s,a[0],a[1]]);i.push(this.dense.predict(u[0])),a=u.slice(1)}return 1===i.length?i[0]:td(i,1)}}]),e}();var HJ=__webpack_require__(6380),KJ=(__webpack_require__(7780),JSON.parse('{"v":"5.5.7","meta":{"g":"LottieFiles AE 0.1.20","a":"","k":"","d":"","tc":""},"fr":60,"ip":0,"op":173,"w":1000,"h":1000,"nm":"Music App Loader","ddd":0,"assets":[{"id":"comp_0","layers":[{"ddd":0,"ind":1,"ty":4,"nm":"Path 7","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[817.5,889.5,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"ef":[{"ty":5,"nm":"Glow","np":16,"mn":"ADBE Glo2","ix":1,"en":1,"ef":[{"ty":7,"nm":"Glow Based On","mn":"ADBE Glo2-0001","ix":1,"v":{"a":0,"k":2,"ix":1}},{"ty":0,"nm":"Glow Threshold","mn":"ADBE Glo2-0002","ix":2,"v":{"a":0,"k":255,"ix":2}},{"ty":0,"nm":"Glow Radius","mn":"ADBE Glo2-0003","ix":3,"v":{"a":0,"k":435,"ix":3}},{"ty":0,"nm":"Glow Intensity","mn":"ADBE Glo2-0004","ix":4,"v":{"a":0,"k":8.8,"ix":4}},{"ty":7,"nm":"Composite Original","mn":"ADBE Glo2-0005","ix":5,"v":{"a":0,"k":1,"ix":5}},{"ty":7,"nm":"Glow Operation","mn":"ADBE Glo2-0006","ix":6,"v":{"a":0,"k":3,"ix":6}},{"ty":7,"nm":"Glow Colors","mn":"ADBE Glo2-0007","ix":7,"v":{"a":0,"k":2,"ix":7}},{"ty":7,"nm":"Color Looping","mn":"ADBE Glo2-0008","ix":8,"v":{"a":0,"k":3,"ix":8}},{"ty":0,"nm":"Color Loops","mn":"ADBE Glo2-0009","ix":9,"v":{"a":0,"k":16.4,"ix":9}},{"ty":0,"nm":"Color Phase","mn":"ADBE Glo2-0010","ix":10,"v":{"a":0,"k":179,"ix":10}},{"ty":0,"nm":"A & B Midpoint","mn":"ADBE Glo2-0011","ix":11,"v":{"a":0,"k":0.638,"ix":11}},{"ty":2,"nm":"Color A","mn":"ADBE Glo2-0012","ix":12,"v":{"a":0,"k":[1,1,1,0],"ix":12}},{"ty":2,"nm":"Color B","mn":"ADBE Glo2-0013","ix":13,"v":{"a":0,"k":[0,0,0,0],"ix":13}},{"ty":7,"nm":"Glow Dimensions","mn":"ADBE Glo2-0014","ix":14,"v":{"a":0,"k":1,"ix":14}}]}],"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[1.4,-17.5],[-21,0.1],[0,19.6],[0,0],[-12.2,3.8],[0,0],[0,-19.6],[0,0],[19.6,-0.2],[-1.6,21.3],[-17.8,0.1]],"o":[[-17.6,-0.1],[-1.7,21.2],[19.6,-0.2],[0,0],[0,-12.8],[0,0],[18.7,-5.8],[0,0],[0,19.6],[-20.9,0.2],[1.4,-17.5],[0,0]],"v":[[-80.939,70.258],[-114.139,103.158],[-78.039,141.958],[-42.439,105.358],[-42.439,-82.442],[-21.939,-110.242],[76.661,-140.642],[114.261,-112.842],[114.261,69.358],[78.661,105.958],[42.561,67.158],[75.761,34.258]],"c":false},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"st","c":{"a":0,"k":[0.341611615349,0.893359853707,1,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":8,"ix":5},"lc":2,"lj":2,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[300,300],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Path","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false},{"ty":"tm","s":{"a":1,"k":[{"i":{"x":[0.4],"y":[1]},"o":{"x":[0.6],"y":[0]},"t":32,"s":[0]},{"t":102,"s":[100]}],"ix":1},"e":{"a":1,"k":[{"i":{"x":[0.4],"y":[1]},"o":{"x":[0.6],"y":[0]},"t":32,"s":[0]},{"t":110,"s":[100]}],"ix":2},"o":{"a":0,"k":0,"ix":3},"m":1,"ix":2,"nm":"Trim Paths 1","mn":"ADBE Vector Filter - Trim","hd":false},{"ty":"st","c":{"a":0,"k":[0.341611615349,0.893359853707,1,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":8,"ix":5},"lc":1,"lj":1,"ml":4,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false}],"ip":0,"op":300,"st":0,"bm":0},{"ddd":0,"ind":2,"ty":4,"nm":"Path 3","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[797.5,877.5,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[1.4,-17.5],[-21,0.1],[0,19.6],[0,0],[-12.2,3.8],[0,0],[0,-19.6],[0,0],[19.6,-0.2],[-1.6,21.3],[-17.8,0.1]],"o":[[-17.6,-0.1],[-1.7,21.2],[19.6,-0.2],[0,0],[0,-12.8],[0,0],[18.7,-5.8],[0,0],[0,19.6],[-20.9,0.2],[1.4,-17.5],[0,0]],"v":[[-80.939,70.258],[-114.139,103.158],[-78.039,141.958],[-42.439,105.358],[-42.439,-82.442],[-21.939,-110.242],[76.661,-140.642],[114.261,-112.842],[114.261,69.358],[78.661,105.958],[42.561,67.158],[75.761,34.258]],"c":false},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"st","c":{"a":0,"k":[0,0.608387008368,1,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":26,"ix":5},"lc":2,"lj":2,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[300,300],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Path","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false},{"ty":"tm","s":{"a":0,"k":0,"ix":1},"e":{"a":1,"k":[{"i":{"x":[0.4],"y":[1]},"o":{"x":[0.6],"y":[0]},"t":19,"s":[0]},{"t":79,"s":[100]}],"ix":2},"o":{"a":0,"k":0,"ix":3},"m":1,"ix":2,"nm":"Trim Paths 1","mn":"ADBE Vector Filter - Trim","hd":false},{"ty":"st","c":{"a":0,"k":[0,0.608387008368,1,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":2,"ix":5},"lc":1,"lj":1,"ml":4,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false}],"ip":0,"op":300,"st":0,"bm":0},{"ddd":0,"ind":3,"ty":4,"nm":"Path 2","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[797.5,877.5,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[1.4,-17.5],[-21,0.1],[0,19.6],[0,0],[-12.2,3.8],[0,0],[0,-19.6],[0,0],[19.6,-0.2],[-1.6,21.3],[-17.8,0.1]],"o":[[-17.6,-0.1],[-1.7,21.2],[19.6,-0.2],[0,0],[0,-12.8],[0,0],[18.7,-5.8],[0,0],[0,19.6],[-20.9,0.2],[1.4,-17.5],[0,0]],"v":[[-80.939,70.258],[-114.139,103.158],[-78.039,141.958],[-42.439,105.358],[-42.439,-82.442],[-21.939,-110.242],[76.661,-140.642],[114.261,-112.842],[114.261,69.358],[78.661,105.958],[42.561,67.158],[75.761,34.258]],"c":false},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"st","c":{"a":0,"k":[0.640268961589,0,1,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":26,"ix":5},"lc":2,"lj":2,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[300,300],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Path","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false},{"ty":"tm","s":{"a":0,"k":0,"ix":1},"e":{"a":1,"k":[{"i":{"x":[0.4],"y":[1]},"o":{"x":[0.6],"y":[0]},"t":11,"s":[0]},{"t":71,"s":[100]}],"ix":2},"o":{"a":0,"k":0,"ix":3},"m":1,"ix":2,"nm":"Trim Paths 1","mn":"ADBE Vector Filter - Trim","hd":false},{"ty":"st","c":{"a":0,"k":[0.640268961589,0,1,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":2,"ix":5},"lc":1,"lj":1,"ml":4,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false}],"ip":0,"op":300,"st":0,"bm":0},{"ddd":0,"ind":4,"ty":4,"nm":"Path","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[797.5,877.5,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[1.4,-17.5],[-21,0.1],[0,19.6],[0,0],[-12.2,3.8],[0,0],[0,-19.6],[0,0],[19.6,-0.2],[-1.6,21.3],[-17.8,0.1]],"o":[[-17.6,-0.1],[-1.7,21.2],[19.6,-0.2],[0,0],[0,-12.8],[0,0],[18.7,-5.8],[0,0],[0,19.6],[-20.9,0.2],[1.4,-17.5],[0,0]],"v":[[-80.939,70.258],[-114.139,103.158],[-78.039,141.958],[-42.439,105.358],[-42.439,-82.442],[-21.939,-110.242],[76.661,-140.642],[114.261,-112.842],[114.261,69.358],[78.661,105.958],[42.561,67.158],[75.761,34.258]],"c":false},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"st","c":{"a":0,"k":[1,1,1,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":26,"ix":5},"lc":2,"lj":2,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[300,300],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Path","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false},{"ty":"tm","s":{"a":0,"k":0,"ix":1},"e":{"a":1,"k":[{"i":{"x":[0.4],"y":[1]},"o":{"x":[0.6],"y":[0]},"t":4,"s":[0]},{"t":64,"s":[100]}],"ix":2},"o":{"a":0,"k":0,"ix":3},"m":1,"ix":2,"nm":"Trim Paths 1","mn":"ADBE Vector Filter - Trim","hd":false},{"ty":"st","c":{"a":0,"k":[1,1,1,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":2,"ix":5},"lc":1,"lj":1,"ml":4,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false}],"ip":0,"op":300,"st":0,"bm":0},{"ddd":0,"ind":5,"ty":4,"nm":"Path 8","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[857.5,957.5,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[1.4,-17.5],[-21,0.1],[0,19.6],[0,0],[-12.2,3.8],[0,0],[0,-19.6],[0,0],[19.6,-0.2],[-1.6,21.3],[-17.8,0.1]],"o":[[-17.6,-0.1],[-1.7,21.2],[19.6,-0.2],[0,0],[0,-12.8],[0,0],[18.7,-5.8],[0,0],[0,19.6],[-20.9,0.2],[1.4,-17.5],[0,0]],"v":[[-80.939,70.258],[-114.139,103.158],[-78.039,141.958],[-42.439,105.358],[-42.439,-82.442],[-21.939,-110.242],[76.661,-140.642],[114.261,-112.842],[114.261,69.358],[78.661,105.958],[42.561,67.158],[75.761,34.258]],"c":false},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"st","c":{"a":0,"k":[1,0.781768439798,0,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":1,"ix":5},"lc":2,"lj":2,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[300,300],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Path","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false},{"ty":"tm","s":{"a":1,"k":[{"i":{"x":[0.4],"y":[1]},"o":{"x":[0.6],"y":[0]},"t":4,"s":[0]},{"t":42,"s":[100]}],"ix":1},"e":{"a":1,"k":[{"i":{"x":[0.4],"y":[1]},"o":{"x":[0.6],"y":[0]},"t":4,"s":[0]},{"t":50,"s":[100]}],"ix":2},"o":{"a":0,"k":0,"ix":3},"m":1,"ix":2,"nm":"Trim Paths 1","mn":"ADBE Vector Filter - Trim","hd":false},{"ty":"st","c":{"a":0,"k":[1,0.781768439798,0,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":1,"ix":5},"lc":1,"lj":1,"ml":4,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false}],"ip":0,"op":300,"st":0,"bm":0},{"ddd":0,"ind":6,"ty":4,"nm":"Path 6","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[857.5,957.5,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0,0],[1.4,-17.5],[-21,0.1],[0,19.6],[0,0],[-12.2,3.8],[0,0],[0,-19.6],[0,0],[19.6,-0.2],[-1.6,21.3],[-17.8,0.1]],"o":[[-17.6,-0.1],[-1.7,21.2],[19.6,-0.2],[0,0],[0,-12.8],[0,0],[18.7,-5.8],[0,0],[0,19.6],[-20.9,0.2],[1.4,-17.5],[0,0]],"v":[[-80.939,70.258],[-114.139,103.158],[-78.039,141.958],[-42.439,105.358],[-42.439,-82.442],[-21.939,-110.242],[76.661,-140.642],[114.261,-112.842],[114.261,69.358],[78.661,105.958],[42.561,67.158],[75.761,34.258]],"c":false},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"st","c":{"a":0,"k":[0.508819041533,0,1,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":1,"ix":5},"lc":2,"lj":2,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[300,300],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Path","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false},{"ty":"tm","s":{"a":1,"k":[{"i":{"x":[0.4],"y":[1]},"o":{"x":[0.6],"y":[0]},"t":0,"s":[0]},{"t":38,"s":[100]}],"ix":1},"e":{"a":1,"k":[{"i":{"x":[0.4],"y":[1]},"o":{"x":[0.6],"y":[0]},"t":0,"s":[0]},{"t":46,"s":[100]}],"ix":2},"o":{"a":0,"k":0,"ix":3},"m":1,"ix":2,"nm":"Trim Paths 1","mn":"ADBE Vector Filter - Trim","hd":false},{"ty":"st","c":{"a":0,"k":[0.508819041533,0,1,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":1,"ix":5},"lc":1,"lj":1,"ml":4,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false}],"ip":0,"op":300,"st":0,"bm":0}]}],"layers":[{"ddd":0,"ind":1,"ty":0,"nm":"Loader","refId":"comp_0","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[504,500,0],"ix":2},"a":{"a":0,"k":[877.5,877.5,0],"ix":1},"s":{"a":1,"k":[{"i":{"x":[0.4,0.4,0.4],"y":[1,1,1]},"o":{"x":[0.6,0.6,0.6],"y":[0,0,0]},"t":112,"s":[49,49,100]},{"i":{"x":[0.4,0.4,0.4],"y":[1,1,1]},"o":{"x":[0.6,0.6,0.6],"y":[0,0,0]},"t":122,"s":[40,40,100]},{"i":{"x":[0.4,0.4,0.4],"y":[1,1,1]},"o":{"x":[0.6,0.6,0.6],"y":[0,0,0]},"t":132,"s":[40,40,100]},{"i":{"x":[0.833,0.833,0.833],"y":[1,1,1]},"o":{"x":[0.6,0.6,0.6],"y":[0,0,0]},"t":142,"s":[30,30,100]},{"i":{"x":[0.833,0.833,0.833],"y":[1,1,1]},"o":{"x":[0.167,0.167,0.167],"y":[0,0,0]},"t":162,"s":[30,30,100]},{"t":172,"s":[49,49,100]}],"ix":6}},"ao":0,"w":1755,"h":1755,"ip":0,"op":300,"st":0,"bm":0}],"markers":[]}'),function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).handleNext=function(){r.setState({activeStep:r.state.activeStep+1})},r.handleBack=function(){r.setState({activeStep:r.state.activeStep-1})},r.handleReset=function(){r.setState({activeStep:0})},r.processFile=function(){var e=_(x().mark((function e(t){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.setState({processing:!0}),setTimeout((function(){requestAnimationFrame((function(){return requestAnimationFrame((function(){r.state.model.transcribeFromAudioFile(t.target.files[0]).then((function(e){r.setState({convertedFile:new File([iJ(e)],"transcription.mid")}),r.setState({processing:!1}),r.handleNext()}))}))}))}),250);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.download=function(e){(0,HJ.saveAs)(r.state.convertedFile)},r.state={processing:!1,model:e.model,activeStep:0},r}return c(n,[{key:"render",value:function(){return(0,y.jsx)(Br,{children:(0,y.jsxs)(Sa,{activeStep:this.state.activeStep,orientation:"vertical",children:[(0,y.jsxs)(Aa,{children:[(0,y.jsx)(Za,{co:!0,children:(0,y.jsx)(Lo,{color:"white"})}),(0,y.jsxs)(Ei,{children:[(0,y.jsx)(Lo,{fontWeight:"bold",color:"white",children:this.state.processing?"Processing the file. Please Wait...":"Upload a file to get started."}),(0,y.jsx)(Br,{sx:{mb:2},children:(0,y.jsx)("div",{children:(0,y.jsxs)("section",{className:"container",children:[(0,y.jsxs)(No,{className:"uploadButton",variant:"contained",component:"label",color:"primary",onChange:this.processFile,disabled:this.state.processing,children:[" ",this.state.processing?"uploading:)":"Upload",(0,y.jsx)("input",{type:"file",hidden:!0})]}),(0,y.jsx)(Lo,{className:"note-text",fontStyle:"italic",color:"white",children:this.state.processing?"Please wait :)":""})]})})})]})]}),(0,y.jsxs)(Aa,{children:[(0,y.jsx)(Za,{children:(0,y.jsx)(Lo,{color:"white"})}),(0,y.jsxs)(Ei,{children:[(0,y.jsx)(Lo,{color:"white",children:"MIDI is ready:)."}),(0,y.jsxs)("section",{className:"container",children:[(0,y.jsx)(No,{variant:"contained",component:"label",color:"primary",onClick:this.download,children:"Download"}),(0,y.jsx)(Lo,{color:"white",children:"convert again??"}),(0,y.jsx)(No,{onClick:this.handleReset,sx:{mt:1,mr:1},children:"Start"})]}),(0,y.jsx)(Br,{sx:{mb:2},children:(0,y.jsx)("div",{})})]})]})]})})}}]),n}(a.Component)),XJ=function(e){h(n,e);var t=g(n);function n(){return s(this,n),t.apply(this,arguments)}return c(n,[{key:"render",value:function(){return(0,y.jsxs)("div",{className:"loader",children:[(0,y.jsx)("video",{src:"loader.mp4",muted:!0,loop:!0,autoPlay:!0}),(0,y.jsx)("p",{className:"loader-text",children:"LOADING:)"})]})}}]),n}(a.Component),YJ=XJ,QJ=function(e){h(n,e);var t=g(n);function n(e){var r;return s(this,n),(r=t.call(this,e)).state={model:null,modelLoaded:!1},r.loader=a.createRef(null),r}return c(n,[{key:"componentDidMount",value:function(){var e=this;this.model=new GJ("https://storage.googleapis.com/magentadata/js/checkpoints/transcription/onsets_frames_uni"),this.model.initialize().then((function(t){e.setState({modelLoaded:!0}),e.setState({model:e.model}),console.log("loaded")}))}},{key:"render",value:function(){return(0,y.jsxs)("div",{className:"App",children:[(0,y.jsx)(k,{}),this.state.modelLoaded?(0,y.jsx)(KJ,{model:this.state.model}):(0,y.jsx)(YJ,{ref:this.loader})]})}}]),n}(a.Component),$J=QJ,JJ=function(e){e&&e instanceof Function&&__webpack_require__.e(787).then(__webpack_require__.bind(__webpack_require__,787)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),i(e),o(e)}))};o.createRoot(document.getElementById("root")).render((0,y.jsx)(a.StrictMode,{children:(0,y.jsx)($J,{})})),JJ()}()})();
//# sourceMappingURL=main.866b3da9.js.map